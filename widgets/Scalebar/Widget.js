//>>built
require({cache:{"esri/dijit/Scalebar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/query ../kernel ../lang ../domUtils ../units ../SpatialReference ../WKIDUnitConversion ../geometry/Point ../geometry/ScreenPoint ../geometry/Polyline ../geometry/geodesicUtils ../geometry/webMercatorUtils ../geometry/screenUtils ../geometry/normalizeUtils dojo/i18n!../nls/jsapi".split(" "),function(l,
k,m,b,p,n,u,q,v,h,w,y,g,z,A,r,B,C,D,x,t,E,F,G){l=l(null,{declaredClass:"esri.dijit.Scalebar",map:null,mapUnit:null,scalebarUnit:null,unitsDictionary:[],domNode:null,screenPt1:null,screenPt2:null,localStrings:G.widgets.scalebar,constructor:function(a,c){if(this.metricScalebar=n.create("div",{innerHTML:"\x3cdiv class\x3d'esriScaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLine esriScalebarMetricLine'\x3e\x3c/div\x3e"}),
this.englishScalebar=n.create("div",{innerHTML:"\x3cdiv class\x3d'esriScalebarLine esriScalebarEnglishLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e"}),this.domNode=n.create("div"),a=a||{},!a.map)return void console.error("scalebar: unable to find the 'map' property in parameters");if(a.scalebarUnit){if("english"!==a.scalebarUnit&&"metric"!==a.scalebarUnit&&"dual"!==a.scalebarUnit)return void console.error("scalebar unit only accepts english or metric or dual");
this.scalebarUnit=a.scalebarUnit}else this.scalebarUnit="english";if(a.scalebarStyle){if("ruler"!==a.scalebarStyle&&"line"!==a.scalebarStyle)return void console.error("scalebar style must be ruler or line");this.scalebarStyle=a.scalebarStyle}else this.scalebarStyle="ruler";switch(this.background=a.background,this.scalebarUnit){case "english":"ruler"===this.scalebarStyle&&(this.englishScalebar.innerHTML="\x3cdiv class\x3d'esriScalebarRuler'\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_secondpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_secondpiece'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'scaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel' style\x3d'left: -3%'\x3e0\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarFirstNumber'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e");
this.domNode.appendChild(this.englishScalebar);break;case "metric":"ruler"===this.scalebarStyle&&(this.metricScalebar.innerHTML="\x3cdiv class\x3d'esriScalebarRuler'\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_secondpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_secondpiece'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'scaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel' style\x3d'left: -3%'\x3e0\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarFirstNumber'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e");
this.domNode.appendChild(this.metricScalebar);break;case "dual":this.domNode.appendChild(this.metricScalebar),this.domNode.appendChild(this.englishScalebar)}if(this.map=a.map,c?c.appendChild(this.domNode):(this.map.container.appendChild(this.domNode),a.attachTo?p.add(this.domNode,"scalebar_"+a.attachTo):p.add(this.domNode,"scalebar_bottom-left")),p.add(this.domNode,"esriScalebar"),this.map.loaded)this._getDistance(this.map.extent),this._checkBingMaps();else var d=b.connect(this.map,"onLoad",this,
function(){b.disconnect(d);d=null;this._getDistance(this.map.extent);this._checkBingMaps()});this._mapOnPan=b.connect(this.map,"onPan",this,this._getDistance);this._mapOnExtentChange=b.connect(this.map,"onExtentChange",this,this._getDistance);m.forEach(this.map.layerIds,function(a,c){"esri.virtualearth.VETiledLayer"===this.map.getLayer(a).declaredClass&&b.connect(this.map.getLayer(a),"onVisibilityChange",k.hitch(this,function(a){this._checkBingMaps()}))},this);this._mapOnLayerAdd=b.connect(this.map,
"onLayerAdd",k.hitch(this,function(a){"esri.virtualearth.VETiledLayer"===a.declaredClass&&b.connect(a,"onVisibilityChange",k.hitch(this,function(a){this._checkBingMaps()}));this._checkBingMaps()}));this._mapOnLayerRemove=b.connect(this.map,"onLayerRemove",k.hitch(this,this._checkBingMaps))},hide:function(){this._hidden=!0;g.hide(this.domNode)},show:function(){this._hidden=!1;g.show(this.domNode)},destroy:function(){b.disconnect(this._mapOnPan);b.disconnect(this._mapOnExtentChange);b.disconnect(this._mapOnLayerAdd);
b.disconnect(this._mapOnLayerRemove);this.hide();this.map=null;n.destroy(this.domNode)},_checkBingMaps:function(){p.contains(this.domNode,"scalebar_bottom-left")&&(q.set(this.domNode,"left","25px"),m.forEach(this.map.layerIds,function(a,c){"esri.virtualearth.VETiledLayer"===this.map.getLayer(a).declaredClass&&this.map.getLayer(a).visible&&(a="95px",this.map._mapParams.nav&&(a="115px"),q.set(this.domNode,"left",a))},this))},_getDistance:function(a){var c=u.position(this.domNode,!0).y-this.map.position.y,
c=c>this.map.height?this.map.height:c,c=0>c?0:c,d,b,f=new C(0,c),c=new C(this.map.width,c);this.mapUnit="esriDecimalDegrees";var e=E.toMapPoint(a,this.map.width,this.map.height,f),g=E.toMapPoint(a,this.map.width,this.map.height,c),f=new B(a.xmin,(a.ymin+a.ymax)/2,this.map.spatialReference),c=new B(a.xmax,(a.ymin+a.ymax)/2,this.map.spatialReference);if(3857===this.map.spatialReference.wkid||102100===this.map.spatialReference.wkid||102113===this.map.spatialReference.wkid||this.map.spatialReference.wkt&&
-1!=this.map.spatialReference.wkt.indexOf("WGS_1984_Web_Mercator"))e=t.webMercatorToGeographic(e,!0),g=t.webMercatorToGeographic(g,!0),f=t.webMercatorToGeographic(f,!0),c=t.webMercatorToGeographic(c,!0);else if(y.isDefined(r[this.map.spatialReference.wkid])||this.map.spatialReference.wkt&&0===this.map.spatialReference.wkt.indexOf("PROJCS")){this.mapUnit="linearUnit";a=Math.abs(a.xmax-a.xmin);if(y.isDefined(r[this.map.spatialReference.wkid]))d=r.values[r[this.map.spatialReference.wkid]];else{d=this.map.spatialReference.wkt;
b=d.lastIndexOf(",")+1;var k=d.lastIndexOf("]]");d=parseFloat(d.substring(b,k))}a*=d;b=a/1609;d=a/1E3;a/=1E3}"esriDecimalDegrees"===this.mapUnit&&(d=x.isSupported(this.map.spatialReference)?this.map.spatialReference.wkid:4326,a=new D(new A({wkid:d})),a.addPath([e,g]),e=F._straightLineDensify(a,10),a=x.geodesicLengths([e],z.KILOMETERS)[0],e=new D(new A({wkid:d})),e.addPath([f,c]),f=F._straightLineDensify(e,10),x.geodesicLengths([f],z.KILOMETERS),b=a/1.609,d=a);"english"===this.scalebarUnit?this._getScaleBarLength(b,
"mi"):"metric"===this.scalebarUnit?this._getScaleBarLength(d,"km"):"dual"===this.scalebarUnit&&(this._getScaleBarLength(b,"mi"),this._getScaleBarLength(d,"km"))},_getScaleBarLength:function(a,c){a=50*a/this.map.width;var d=0,b=c;for(.1>a&&("mi"===c?(a*=5280,b="ft"):"km"===c&&(a*=1E3,b="m"));1<=a;)a/=10,d++;var f,e;.5<a?(f=1,e=.5):.3<a?(f=.5,e=.3):.2<a?(f=.3,e=.2):.15<a?(f=.2,e=.15):.1<=a&&(f=.15,e=.1);c=f/a>=a/e?e:f;this._drawScaleBar(c/a*50,Math.pow(10,d)*c,b)},_drawScaleBar:function(a,c,b){var d,
f,e,g=2*Math.round(a);"mi"===b||"ft"===b?(this.englishScalebar.style.width=g+"px",d=h(".esriScalebarFirstNumber",this.englishScalebar),f=h(".esriScalebarSecondNumber",this.englishScalebar),e=h(".esriScalebarMetricLineBackground",this.englishScalebar)):(this.metricScalebar.style.width=g+"px",d=h(".esriScalebarFirstNumber",this.metricScalebar),f=h(".esriScalebarSecondNumber",this.metricScalebar),e=h(".esriScalebarMetricLineBackground",this.metricScalebar));m.forEach(e,function(a,c){a.style.width=g-
2+"px"},this);m.forEach(d,function(a,b){a.innerHTML=c},this);m.forEach(f,function(a,d){"esriUnknown"!==this.mapUnit?a.innerHTML=2*c+this.localStrings[b]:a.innerHTML=2*c+"Unknown Unit"},this)}});return v("extend-esri")&&k.setObject("dijit.Scalebar",l,w),l})},"widgets/Scalebar/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/Scalebar/css/style.css":".jimu-rtl .jimu-widget-scalebar .scaleLabelDiv .esriScalebarLabel:first-child{right: -3% !important; left: auto !important;};.jimu-rtl .jimu-widget-scalebar .scaleLabelDiv .esriScalebarFirstNumber{right: 45% !important; left: auto;}.jimu-rtl .jimu-widget-scalebar .scaleLabelDiv .esriScalebarSecondNumber{right: 95%; left: auto;}.jimu-widget-scalebar .ruler-style {position: relative; top: -5px !important; left: 0 !important;}.jimu-widget-scalebar .esriScalebarLine.esriScalebarEnglishLine{box-shadow: inset 1px 1px #fff, inset -1px 1px #fff, 0px -1px 0px 0px #fff, -1px -1px 0px 0px #fff, 1px -1px 0px 0px #fff;}.jimu-widget-scalebar .esriScalebarLine.esriScalebarMetricLine {box-shadow: inset 1px 0px #fff, inset -1px -1px #fff, 0px 1px 0px 0px #fff, 1px 0px 0px 0px #fff, -1px 0px 0px 0px #fff;}.jimu-widget-scalebar .esriScaleLabelDiv,.jimu-widget-scalebar .scaleLabelDiv{text-shadow: -1px -1px 0px #fff, 1px -1px 0px #fff, -1px 1px 0px #fff, 1px 1px 0px #fff;}.jimu-widget-scalebar .esriScalebarRuler {box-shadow: 0px -1px 0px #fff, 1px 0px 0px #fff, 0px 1px 0px #fff, -1px 0px 0px #fff;}",
"url:widgets/Scalebar/config.json":'{\r\n  "scalebar": {\r\n    "scalebarStyle": "",\r\n    "scalebarUnit": ""\r\n  }\r\n}',"*now":function(l){l(['dojo/i18n!*preload*widgets/Scalebar/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred jimu/BaseWidget jimu/utils jimu/portalUtils jimu/dijit/Message esri/dijit/Scalebar dojo/dom-style dojo/query dojo/NodeList-dom".split(" "),function(l,k,m,b,p,n,u,q,v,h,w){return l([p],{baseClass:"jimu-widget-scalebar",name:"Scalebar",scalebar:null,moveTopOnActive:!1,startup:function(){this.inherited(arguments);var b=this.config.scalebar;b.map=this.map;this.position&&(void 0!==this.position.top&&void 0!==this.position.left?b.attachTo=
"top-left":void 0!==this.position.top&&void 0!==this.position.right?b.attachTo="top-right":void 0!==this.position.bottom&&void 0!==this.position.left?b.attachTo="bottom-left":void 0!==this.position.bottom&&void 0!==this.position.right&&(b.attachTo="bottom-right"));this._processConfig(b).then(k.hitch(this,function(b){b.scalebarStyle||(b.scalebarStyle="line");this.scalebar=new v(b);this.scalebar.show();this.domNode.appendChild(this.scalebar.domNode);this._hackForhighlight();"ruler"===b.scalebarStyle?
m.addClass(this.scalebar.domNode,"ruler-style"):m.removeClass(this.scalebar.domNode,"ruler-style");var g={left:"auto",right:"auto",top:"auto",bottom:"auto",width:"auto"};k.mixin(g,this.position);h.set(this.domNode,n.getPositionStyle(g));setTimeout(k.hitch(this,function(){this.domNode&&h.set(this.domNode,n.getPositionStyle(g))}),1E3)}),k.hitch(this,function(b){new q({message:b.message||b})}))},_processConfig:function(h){var g=new b;h.scalebarUnit?g.resolve(h):u.getUnits(this.appConfig.portalUrl).then(k.hitch(this,
function(b){h.scalebarUnit="english"===b?"english":"metric";g.resolve(h)}));return g.promise},_hackForhighlight:function(){w(".esriScalebar",this.domNode).removeClass("esriScalebar")},onClose:function(){this.scalebar.destroy()}})});