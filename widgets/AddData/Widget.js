//>>built
require({cache:{"widgets/AddData/search/SearchContext":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(p,g){return p(null,{allowArcGISOnline:!0,arcgisOnlinePortal:null,orgId:null,portal:null,username:null,constructor:function(h){g.mixin(this,h)}})})},"widgets/AddData/search/util":function(){define(["dojo/_base/array"],function(p){return{checkMixedContent:function(g){"string"===typeof window.location.href&&0===window.location.href.indexOf("https://")&&"string"===typeof g&&0===g.indexOf("http://")&&
(g="https:"+g.substring("5"));return g},endsWith:function(g,h){return-1!==g.indexOf(h,g.length-h.length)},escapeForLucene:function(g){return g.replace(/(\+|\-|\&|\!|\(|\)|\{|\}|\[|\]|\^|\"|\~|\*|\?|\:|\\)/g,"\\$1")},findLayersAdded:function(g,h){var m=[],d=[],u=[],a={itemIds:d,layers:u};if(!g)return a;var l="string"===typeof h&&0<h.length;p.forEach(g.layerIds,function(a){m.push(a)});p.forEach(g.graphicsLayerIds,function(a){m.push(a)});p.forEach(m,function(a){(a=g.getLayer(a))&&"string"===typeof a.xtnItemId&&
0<a.xtnItemId.length&&(!l||a.xtnItemId===h)&&(u.push(a),-1===d.indexOf(a.xtnItemId)&&d.push(a.xtnItemId))});return a},setNodeText:function(g,h){g.innerHTML="";h&&g.appendChild(document.createTextNode(h))},setNodeTitle:function(g,h){g.title="";h&&g.setAttribute("title",h)},setNodeHTML:function(g,h){g.innerHTML="";h&&(g.innerHTML=h)}}})},"widgets/AddData/search/SearchPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SearchPane.html dojo/i18n!../nls/strings ./SearchBox ./BBoxOption ./ScopeOptions ./TypeOptions ./SortOptions ./ResultsPane ./Paging ./ResultCount".split(" "),
function(p,g,h,m,d,u,a,l,r,w){return p([u,a,l],{i18n:w,templateString:r,qDefaultFilter:null,qRequiredFilter:null,searchOnStart:!0,searchContext:null,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);h.forEach(this.getComponents(),function(a){a.searchPane=this},this)},startup:function(){this._started||(this.inherited(arguments),this.bindEvents(),this.searchOnStart&&this.search())},_onFilterPlaceholderChanged:function(){d.contains(this.filterPlaceholder,"opened")?(d.remove(this.filterPlaceholder,
"opened"),d.remove(this.filterWrapper,"show")):(this.filterWrapper.style.top=this.headerNode.clientHeight+"px",d.add(this.filterPlaceholder,"opened"),d.add(this.filterWrapper,"show"))},_onSearchBoxPlaceholderChanged:function(){},bindEvents:function(){this.own(m(this.filterPlaceholder,"click",g.hitch(this,this._onFilterPlaceholderChanged)))},buildQueryParams:function(a){var l=null;"string"===typeof this.qRequiredFilter&&0<this.qRequiredFilter.length&&(l=this.qRequiredFilter);var r={q:l,canSortByRelevance:!1};
h.forEach(this.getComponents(),function(l){l.appendQueryParams(r,a)});delete r.canSortByRelevance;null===r.q&&"string"===typeof this.qDefaultFilter&&0<this.qDefaultFilter.length&&(r.q=this.qDefaultFilter);return r},getComponents:function(){return[this.searchBox,this.bboxOption,this.scopeOptions,this.typeOptions,this.sortOptions,this.resultsPane,this.paging,this.resultCount]},resize:function(){this.contentNode.style.top=this.headerNode.clientHeight+1+"px"},search:function(){var a=this,l={},r=this.buildQueryParams(l);
if(null!==r&&null!==r.q){r&&null===r.sortField&&(r.sortOrder="desc");var d=this.searchContext.portal;l.scopeIsArcGISOnline&&this.searchContext.arcgisOnlinePortal&&(d=this.searchContext.arcgisOnlinePortal);null!==this._dfd&&this._dfd.cancel("Search aborted.",!1);var g=null;this._dfd=g=d.queryItems(r).then(function(l){g.isCanceled()||(l.queryParams||(l.queryParams={start:l.start,num:l.num},l.nextQueryParams||"undefined"===typeof l.nextStart||-1===l.nextStart||(l.nextQueryParams={start:l.nextStart})),
h.forEach(a.getComponents(),function(a){a.processResults(l)}))}).otherwise(function(a){console.warn("searchError",a)})}},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()}})})},"widgets/AddData/search/SearchBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys ./SearchComponent dojo/text!./templates/SearchBox.html dojo/i18n!../nls/strings".split(" "),function(p,g,h,m,d,u,a){return p([d],{i18n:a,templateString:u,postCreate:function(){this.inherited(arguments);
this._checkClearButton();this.own(h(this.searchTextBox,"keyup",g.hitch(this,function(a){this._checkClearButton();a.keyCode===m.ENTER&&this.search()})))},_checkClearButton:function(){},clearButtonClicked:function(){this.searchTextBox.value="";this._checkClearButton();this.search()},searchButtonClicked:function(){this.search()},appendQueryParams:function(a){var l=this.searchTextBox.value;null!==l&&(l=g.trim(l));null!==l&&0<l.length&&(a.canSortByRelevance=!0,l="("+l+")",a.q=null!==a.q&&0<a.q.length?
a.q+(" AND "+l):l)}})})},"widgets/AddData/search/SearchComponent":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin"],function(p,g,h,m){return p([g,h,m],{isSearchComponent:!0,searchPane:null,template:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments)},appendQueryParams:function(d,g){},processResults:function(d){},getConfig:function(){return this.searchPane&&this.searchPane.wabWidget&&this.searchPane.wabWidget.config?
this.searchPane.wabWidget.config:{}},getMap:function(){return this.searchPane&&this.searchPane.wabWidget?this.searchPane.wabWidget.map:null},search:function(){this.searchPane&&this.searchPane.search()}})})},"widgets/AddData/search/BBoxOption":function(){define(["dojo/_base/declare","./SearchComponent","dojo/text!./templates/BBoxOption.html","dojo/i18n!../nls/strings","dijit/form/CheckBox"],function(p,g,h,m){return p([g],{i18n:m,templateString:h,postCreate:function(){this.inherited(arguments);this.bboxToggle.set("checked",
!0)},bboxClicked:function(){this.search()},_getBBox:function(){var d;if(d=this.getMap())if(d=d.geographicExtent)return d.xmin+","+d.ymin+","+d.xmax+","+d.ymax;return null},appendQueryParams:function(d){if(this.bboxToggle.get("checked")){var g=this._getBBox();null!==g&&(d.canSortByRelevance=!0,d.bbox=g)}}})})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),
function(p,g,h,m,d,u,a,l,r){m("dijit-legacy-requires")&&u(0,function(){p(["dijit/form/RadioButton"])});return g("dijit.form.CheckBox",[a,l],{templateString:r,baseClass:"dijitCheckBox",_setValueAttr:function(a,l){"string"==typeof a&&(this.inherited(arguments),a=!0);this._created&&this.set("checked",a,l)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},
_fillContent:function(){},_onFocus:function(){this.id&&d("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&d("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(p,g){return p("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(h){this._set("readOnly",
h);g.set(this.focusNode,"readOnly",h)},_setLabelAttr:void 0,_getSubmitValue:function(g){return null==g||""===g?"on":g},_setValueAttr:function(h){h=this._getSubmitValue(h);this._set("value",h);g.set(this.focusNode,"value",h)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));g.set(this.focusNode,"value",this.value)},_onClick:function(g){return this.readOnly?(g.stopPropagation(),g.preventDefault(),!1):this.inherited(arguments)}})})},"widgets/AddData/search/ScopeOptions":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-class ./SearchComponent dojo/text!./templates/ScopeOptions.html dojo/i18n!../nls/strings ./util".split(" "),
function(p,g,h,m,d,u,a,l){return p([d],{i18n:a,templateString:u,curatedFilter:null,postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this.inherited(arguments),this.initOptions())},hideDropdown:function(){m.remove(this.scopePlaceholder,"opened");m.remove(this.btnGroup,"show")},initOptions:function(){var r=this.searchPane.searchContext,d="string"===typeof r.username&&0<r.username.length,h=this.getConfig().scopeOptions;this.curatedFilter=h.Curated.filter;var B=null,
r=function(r,w){var m=h[r];m&&m.allow?("string"===typeof m.label&&0<g.trim(m.label).length?l.setNodeText(w,g.trim(m.label)):d||"MyOrganization"!==r||l.setNodeText(w,a.search.scopeOptions.anonymousContent),h.defaultScope===r&&(B=w)):w.style.display="none"};r("MyContent",this.MyContentToggle);r("MyOrganization",this.MyOrganizationToggle);r("Curated",this.CuratedToggle);r("ArcGISOnline",this.ArcGISOnlineToggle);B||(h.MyOrganization.allow?B=this.MyOrganizationToggle:h.ArcGISOnline.allow?B=this.ArcGISOnlineToggle:
h.Curated.allow?B=this.CuratedToggle:h.MyContent.allow&&(B=this.MyContentToggle));B&&(m.add(B,"active"),this.scopePlaceholderText.innerHTML=B.innerHTML)},optionClicked:function(a){this.toggleClassName(a);this.hideDropdown();this.search()},scopePlaceholderClicked:function(a){a.preventDefault();m.contains(this.scopePlaceholder,"opened")?this.hideDropdown():this.showDropdown()},showDropdown:function(){m.add(this.scopePlaceholder,"opened");m.add(this.btnGroup,"show")},toggleClassName:function(a){h.forEach(this.btnGroup.children,
function(a){m.remove(a,"active")});m.add(a.target,"active");this.scopePlaceholderText.innerHTML=a.target.innerHTML},appendQueryParams:function(a,g){var d=null;h.some(this.btnGroup.children,function(a){if(m.contains(a,"active"))return d=a.getAttribute("data-option-name"),!0});"undefined"===typeof d&&(d=null);var r=null,w=this.curatedFilter,p=this.searchPane.searchContext,u=p.username,A=p.orgId,E=!0;p.portal&&p.portal.isPortal&&(E=!1);"MyContent"===d?"string"===typeof u&&0<u.length&&(r="(owner:"+l.escapeForLucene(u)+
")"):"MyOrganization"===d?E&&"string"===typeof A&&0<A.length&&(r="(orgid:"+l.escapeForLucene(A)+")"):"Curated"===d?"string"===typeof w&&0<w.length&&(r=w):"ArcGISOnline"===d&&p.allowArcGISOnline&&(g.scopeIsArcGISOnline=!0);null!==r&&0<r.length&&(r="("+r+")",a.q=null!==a.q&&0<a.q.length?a.q+(" AND "+r):r)}})})},"widgets/AddData/search/TypeOptions":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on ./SearchComponent dojo/text!./templates/TypeOptions.html dojo/i18n!../nls/strings esri/layers/VectorTileLayer dijit/TooltipDialog dijit/form/DropDownButton jimu/dijit/CheckBox".split(" "),
function(p,g,h,m,d,u,a,l){return p([d],{i18n:a,templateString:u,postCreate:function(){this.inherited(arguments);l&&l.supported()||(console.warn("AddData: Vector Tile is not supported."),this.vectorTileNode.style.display="none");this.own(m(this.tooltipDialog,"open",h.hitch(this,function(){this.tooltipDialog.domNode.className+=" "+this.searchPane.wabWidget.appConfig.theme.name})));this.own(m(this.mapServiceToggle,"change",h.hitch(this,function(){this.search()})));this.own(m(this.featureServiceToggle,
"change",h.hitch(this,function(){this.search()})));this.own(m(this.imageServiceToggle,"change",h.hitch(this,function(){this.search()})));this.own(m(this.vectorTileServiceToggle,"change",h.hitch(this,function(){this.search()})));this.own(m(this.kmlToggle,"change",h.hitch(this,function(){this.search()})));this.own(m(this.wmsToggle,"change",h.hitch(this,function(){this.search()})))},getOptionWidgets:function(){return[this.mapServiceToggle,this.featureServiceToggle,this.imageServiceToggle,this.vectorTileServiceToggle,
this.kmlToggle,this.wmsToggle]},optionClicked:function(){},appendQueryParams:function(a){var l=function(a,l){0<a.length&&(a+=" OR ");return a+l},d="",r="",h=!1;g.forEach(this.getOptionWidgets(),function(a){var g=a.domNode.getAttribute("data-option-q");r=l(r,g);a.getValue()&&(d=l(d,g),h=!0)});h||(d=r);null!==d&&0<d.length&&(d="("+d+")",a.q=null!==a.q&&0<a.q.length?a.q+(" AND "+d):d)}})})},"widgets/AddData/search/SortOptions":function(){define("dojo/_base/declare dojo/on dojo/dom-class ./SearchComponent dojo/text!./templates/SortOptions.html dojo/i18n!../nls/strings dijit/form/Select".split(" "),
function(p,g,h,m,d,u){return p([m],{i18n:u,templateString:d,sortField:null,sortOrder:null,postCreate:function(){this.inherited(arguments);this.updateSortOrderButton();var a=this;this.own(this.sortSelect.on("change",function(){var l=a.sortField=a.sortSelect.get("value");if(""===l)a.sortOrder=null;else if("title"===l||"owner"===l)a.sortOrder="asc";else if("avgrating"===l||"numviews"===l||"modified"===l)a.sortOrder="desc";a.updateSortOrderButton();a.search()}));this.own(g(this.sortSelect.dropDown,"open",
function(){var a=this.domNode.parentElement;a&&h.add(a,"add-data-widget-popup")}))},sortOrderClicked:function(){"asc"===this.sortOrder?(this.sortOrder="desc",this.updateSortOrderButton(),this.search()):"desc"===this.sortOrder&&(this.sortOrder="asc",this.updateSortOrderButton(),this.search())},updateSortOrderButton:function(){var a=this.sortOrderBtn;a.style.visibility=null!==this.sortField&&0<this.sortField.length?"visible":"hidden";"desc"===this.sortOrder?h.add(a,"descending"):h.remove(a,"descending")},
appendQueryParams:function(a){a.sortField=null;a.sortOrder=null;var l=this.sortField,d=this.sortOrder;null!==l&&0<l.length?(a.sortField=l,null!==d&&0<d.length&&(a.sortOrder=d)):a.canSortByRelevance||(a.sortField="numviews",a.sortOrder="desc")}})})},"widgets/AddData/search/ResultsPane":function(){define("dojo/_base/declare dojo/_base/array ./SearchComponent dojo/text!./templates/ResultsPane.html dojo/i18n!../nls/strings ./ItemCard ./util".split(" "),function(p,g,h,m,d,u,a){return p([h],{i18n:d,templateString:m,
postCreate:function(){this.inherited(arguments)},addItem:function(a){a.placeAt(this.itemsNode)},destroyItems:function(){this.noMatchNode.style.display="none";this.noMatchNode.innerHTML="";this.destroyDescendants(!1)},showNoMatch:function(){a.setNodeText(this.noMatchNode,d.search.resultsPane.noMatch);this.noMatchNode.style.display="block"},processResults:function(l){this.destroyItems();var d=l.results;if(d&&0<d.length){var h=a.findLayersAdded(this.getMap(),null).itemIds;g.forEach(l.results,function(a){this.addItem(new u({item:a,
canRemove:-1!==h.indexOf(a.id),resultsPane:this}))},this)}else this.showNoMatch()}})})},"widgets/AddData/search/ItemCard":function(){define("dojo/_base/declare dojo/_base/array dojo/date/locale dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemCard.html dojo/i18n!../nls/strings ./util ./LayerLoader".split(" "),function(p,g,h,m,d,u,a,l,r,w,D){return p([d,u,a],{i18n:r,templateString:l,canRemove:!1,item:null,resultsPane:null,_dfd:null,postCreate:function(){this.inherited(arguments)},
startup:function(){this._started||(this.inherited(arguments),this.render())},addClicked:function(){var a=this,l=this.addButton;if(!m.contains(l,"disabled"))if(m.add(l,"disabled"),this.canRemove){var d=this.resultsPane.getMap();w.setNodeText(a.messageNode,r.search.item.messages.removing);var h=w.findLayersAdded(d,this.item.id).layers;g.forEach(h,function(a){d.removeLayer(a)});this.canRemove=!1;w.setNodeText(a.messageNode,"");w.setNodeText(this.addButton,r.search.item.actions.add);m.remove(l,"disabled")}else w.setNodeText(a.messageNode,
r.search.item.messages.adding),(new D).addItem(this.item,this.resultsPane.getMap()).then(function(d){d?(a.canRemove=!0,w.setNodeText(a.messageNode,""),w.setNodeText(a.addButton,r.search.item.actions.remove)):w.setNodeText(a.messageNode,r.search.item.messages.addFailed);m.remove(l,"disabled")}).otherwise(function(d){console.warn("Add layer failed.");console.warn(d);w.setNodeText(a.messageNode,r.search.item.messages.addFailed);m.remove(l,"disabled");d&&"string"===typeof d.message&&0<d.message.length&&
console.log("")})},detailsClicked:function(){var a=this.item,a=w.checkMixedContent(a.portalUrl)+"/home/item.html?id\x3d"+encodeURIComponent(a.id);window.open(a)},formatDate:function(a){"number"===typeof a&&(a=new Date(a));return h.format(a,{selector:"date",datePattern:r.search.item.dateFormat})},render:function(){w.setNodeText(this.titleNode,this.item.title);w.setNodeTitle(this.titleNode,this.item.title);this._renderThumbnail();this._renderTypeOwnerDate();this.canRemove&&w.setNodeText(this.addButton,
r.search.item.actions.remove)},_renderThumbnail:function(){var a=this.thumbnailNode,l=this.item.thumbnailUrl;a.innerHTML="";var l=w.checkMixedContent(l),d=document.createElement("IMG");d.src=l||"widgets/AddData/images/placeholder_120x80.png";a.appendChild(d)},_renderTypeOwnerDate:function(){var a,l=this.item;a=r.search.item.types[l.type];if("undefined"===typeof a||null===a)a=l.type;a=r.search.item.typeByOwnerPattern.replace("{type}",a);a=a.replace("{owner}",l.owner);w.setNodeText(this.typeByOwnerNode,
a)}})})},"widgets/AddData/search/LayerLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/json dojo/i18n!../nls/strings ./util esri/lang esri/request esri/arcgis/utils esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/DynamicLayerInfo esri/layers/FeatureLayer esri/layers/ImageParameters esri/layers/ImageServiceParameters esri/layers/KMLLayer esri/layers/LayerDrawingOptions esri/layers/MosaicRule esri/layers/RasterFunction esri/layers/VectorTileLayer esri/layers/WMSLayer esri/layers/WMSLayerInfo esri/dijit/PopupTemplate esri/InfoTemplate esri/renderers/jsonUtils esri/geometry/Extent esri/SpatialReference jimu/utils".split(" "),
function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,C,A,E,H,f,e,t,v,x,F,z,b,c,n,k,q,K){return p(null,{item:null,itemUrl:null,map:null,serviceUrl:null,constructor:function(b){g.mixin(this,b)},addItem:function(b,c){var k=new d;this.map=c;this.item=b;this.itemUrl=this._checkMixedContent(b.itemUrl);this.serviceUrl=this._checkMixedContent(b.url);if("Feature Service"===b.type)return this._addFeatureService();if("Image Service"===b.type)return this._addImageService();if("KML"===b.type)return this._addKML();if("Map Service"===
b.type)return this._addMapService();if("Vector Tile Service"===b.type)return this._addVectorTileService();if("WMS"===b.type)return this._addWMS();console.warn("Unsupported item type: ",b.type);k.resolve(null);return k},_addFeatureService:function(){var b=this,c=new d,k=this.serviceUrl,q=this.item,n={},e=null,z=[],a=[];b._readItemJsonData().then(function(c){(n=c||{},n.layers)&&0<n.layers.length&&h.forEach(n.layers,function(b){"undefined"!==typeof b.id&&null!==b.id&&(null===e&&(e=[]),e.push(b.id))});
return b._readRestInfo(k)}).then(function(c){if(!c||"string"!==typeof c.type||"Feature Layer"!==c.type&&"Table"!==c.type){var q=[];c&&c.layers&&0<c.layers.length&&h.forEach(c.layers,function(b){q.push(b)});c&&c.tables&&0<c.tables.length&&h.forEach(c.tables,function(b){q.push(b)});0<q.length?h.forEach(q,function(c){var q=!0;null!==e&&0<e.length&&(q=h.some(e,function(b){return b===c.id}));q&&(q=new A(k+"/"+c.id,{id:b._generateLayerId(),outFields:["*"]}),z.push(b._waitForLayer(q)))}):console.warn("No layers or tables...")}else c=
new A(k,{id:b._generateLayerId(),outFields:["*"]}),z.push(b._waitForLayer(c));return m(z)}).then(function(b){h.forEach(b,function(b){a.push(b)});a.reverse();return a}).then(function(){h.forEach(a,function(c){var k=b._processFeatureLayer(c,q,n);c.arcgisProps={title:k.title};c._titleForLegend=k.title;r.isDefined(c.title)||(c.title=k.title);b._addLayer(c)})}).then(function(){c.resolve(a)}).otherwise(function(b){c.reject(b)});return c},_addImageService:function(){var b=this,c=new d;b._readItemJsonData().then(function(c){return b._newImageServiceLayer(c||
{})}).then(function(k){b._addLayer(k);c.resolve(k)}).otherwise(function(b){c.reject(b)});return c},_addKML:function(){var b=this,c=new d;b._newKMLLayer().then(function(k){k&&(k.title=b.item.title);b._addLayer(k);c.resolve(k)}).otherwise(function(b){c.reject(b)});return c},_addMapService:function(){var b=this,c=new d;b._readItemJsonData().then(function(c){return b._newMapServiceLayer(c||{})}).then(function(k){b._addLayer(k);c.resolve(k)}).otherwise(function(b){c.reject(b)});return c},_addVectorTileService:function(){var b=
this,c=new d;b._newVectorTileLayer().then(function(k){b._addLayer(k);c.resolve(k)}).otherwise(function(b){c.reject(b)});return c},_addWMS:function(){var b=this,c=new d;b._readItemJsonData().then(function(c){return b._newWMSLayer(c||{})}).then(function(k){k&&(k.title=b.item.title);b._addLayer(k);c.resolve(k)}).otherwise(function(b){c.reject(b)});return c},_addLayer:function(b){var c=this.item;b&&(b.xtnItemId=c.id,b.xtnAddData=!0,!b.arcgisProps&&c&&(b.arcgisProps={title:c.title},b._titleForLegend=c.title),
r.isDefined(b.title)||(b.title=c.title),b._wabProperties={itemLayerInfo:{itemId:c.id,itemUrl:this.itemUrl,portalUrl:c.portalUrl}},this.map.addLayer(b))},_checkMixedContent:function(b){return l.checkMixedContent(b)},_checkUrl:function(b){return D._checkUrl(b)},_checkVectorTileUrl:function(b,c){var k=new d;if(function(b,c){return-1!==b.indexOf(c,b.length-c.length)}(b,".json"))return c.styleUrl=b,k.resolve(b),k;var q={url:null,content:{},handleAs:"json",callbackParamName:"callback"};this.itemUrl?(q.url=
this.itemUrl+"/resources/styles/root.json",w(q,{}).then(function(){c.styleUrl=q.url;k.resolve(q.url)}).otherwise(function(){q.url=b+"/resources/styles/root.json";w(q,{}).then(function(){c.styleUrl=q.url;k.resolve(q.url)}).otherwise(function(){c.url=b;k.resolve(b)})})):(q.url=b+"/resources/styles/root.json",w(q,{}).then(function(){c.styleUrl=q.url;k.resolve(q.url)}).otherwise(function(){c.url=b;k.resolve(b)}));return k},_generateLayerId:function(){return this._generateLayerIds(1)[0]},_generateLayerIds:function(b){var c,
k=[];for(c=0;c<b;c++)k.push(this._generateRandomId());return k},_generateRandomId:function(){var b=null,b="function"===typeof Date.now?Date.now():(new Date).getTime(),c=(""+Math.random()).replace("0.","r");return(b+""+c).replace(/-/g,"")},_makeFeatureLayerTitle:function(b,c,k){var q,n,I;try{if(c&&k&&c===k||c&&k&&(q=k.indexOf(c),0===q&&(n=k.substring(q+c.length+1),13<=n.length&&(I=/^\d+$/,I.test(n)))))return c}catch(P){}return b.replace("{serviceName}",c).replace("{layerName}",k)},_newImageServiceLayer:function(c){var k=
new d,q=this._generateLayerId(),n=this.serviceUrl,e={mapLayerId:q,bandIds:null,format:null,compressionQuality:null,opacity:1,visibility:!0};r.isDefined(c.visibility)&&!1===c.visibility&&(e.visibility=!1);r.isDefined(c.opacity)&&(e.opacity=c.opacity);r.isDefined(c.minScale)&&!r.isDefined(e.minScale)&&(e.minScale=c.minScale);r.isDefined(c.maxScale)&&!r.isDefined(e.maxScale)&&(e.maxScale=c.maxScale);r.isDefined(c.refreshInterval)&&!r.isDefined(e.refreshInterval)&&(e.refreshInterval=c.refreshInterval);
!c.popupInfo||e.popupInfo||e.disablePopup||(e.popupInfo=c.popupInfo);c.renderingRule&&!e.renderingRule&&(e.renderingRule=c.renderingRule,c.renderingRule.functionName&&(e.renderingRule.rasterFunction=c.renderingRule.functionName));c.bandIds&&!e.bandIds&&(e.bandIds=c.bandIds);c.mosaicRule&&!e.mosaicRule&&(e.mosaicRule=c.mosaicRule);c.format&&!e.format&&(e.format=c.format);r.isDefined(c.compressionQuality)&&!r.isDefined(e.compressionQuality)&&(e.compressionQuality=c.compressionQuality);!c.layerDefinition||
!c.layerDefinition.definitionExpression||r.isDefined(e.layerDefinition)&&r.isDefined(e.layerDefinition.definitionExpression)||(e.layerDefinition=e.layerDefinition||{},e.layerDefinition.definitionExpression=c.layerDefinition.definitionExpression);c=new H;null!==e.bandIds&&(c.bandIds=e.bandIds);null!==e.format&&(c.format=e.format,null!==e.compressionQuality&&(c.compressionQuality=e.compressionQuality));e.renderingRule&&e.renderingRule.rasterFunction&&(q=new v(e.renderingRule),c.renderingRule=q);e.mosaicRule&&
(q=new t(e.mosaicRule),c.mosaicRule=q);r.isDefined(e.noData)&&(c.noData=e.noData);r.isDefined(e.noDataInterpretation)&&(c.noDataInterpretation=e.noDataInterpretation);r.isDefined(e.interpolation)&&(c.interpolation=e.interpolation);c={imageServiceParameters:c,opacity:e.opacity,visible:e.visibility};r.isDefined(e.mapLayerId)&&(c.id=e.mapLayerId);r.isDefined(e.minScale)&&(c.minScale=e.minScale);r.isDefined(e.maxScale)&&(c.maxScale=e.maxScale);r.isDefined(e.refreshInterval)&&(c.refreshInterval=e.refreshInterval);
r.isDefined(e.resourceInfo)&&(c.resourceInfo=e.resourceInfo);n=new G(this._checkUrl(n),c);this._waitForLayer(n).then(function(c){e.layerDefinition&&e.layerDefinition.definitionExpression&&c.setDefinitionExpression(e.layerDefinition.definitionExpression,!0);!e.disablePopup&&e.popupInfo&&c.setInfoTemplate(new b(e.popupInfo));k.resolve(c)},function(b){k.reject(b)});return k},_newInfoTemplate:function(k,q){if(k)try{return new b({description:k.description,title:k.title,showAttachments:k.showAttachments,
fieldInfos:k.fieldInfos,mediaInfos:k.mediaInfos})}catch(L){console.error(L)}k=new c;r.isDefined(q)&&k.setTitle(q);return k},_newKMLLayer:function(){var b={id:this._generateLayerId()},b=new f(this.serviceUrl,b);return this._waitForLayer(b)},_newMapServiceLayer:function(b){var c=this,k=new d,q=this.serviceUrl,n=this._generateLayerId();w({url:q,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{}).then(function(a){var z=null,z={id:n};if(a.tileInfo)z=new y(q,z);else if(a&&a.supportedImageFormatTypes&&
-1!==a.supportedImageFormatTypes.indexOf("PNG32")&&(z.imageParameters=new E,z.imageParameters.format="png32"),z=new B(q,z),b&&b.layers&&0<b.layers.length){var I=[],f,K=[],x,v=[],H;h.forEach(b.layers,function(c){c.layerDefinition&&c.layerDefinition.definitionExpression&&(I[c.id]=c.layerDefinition.definitionExpression);if(c.layerDefinition&&c.layerDefinition.source){f=null;H=c.layerDefinition.source;if("mapLayer"===H.type){var k=h.filter(a.layers,function(b){return b.id===H.mapLayerId});k.length&&(f=
g.mixin(k[0],c))}else f=g.mixin({},c);f&&(f.source=H,delete f.popupInfo,f=new C(f),b.visibleLayers&&(k="string"===typeof b.visibleLayers?b.visibleLayers.split(","):b.visibleLayers,-1<h.indexOf(k,c.id)?f.defaultVisibility=!0:f.defaultVisibility=!1),K.push(f))}c.layerDefinition&&c.layerDefinition.source&&c.layerDefinition.drawingInfo&&(x=new e(c.layerDefinition.drawingInfo),v[c.id]=x)});0<I.length&&z.setLayerDefinitions(I);0<K.length&&(z.setDynamicLayerInfos(K,!0),0<v.length&&z.setLayerDrawingOptions(v,
!0))}c._waitForLayer(z).then(function(q){var n=null;h.forEach(q.layerInfos,function(k){var q=null;b&&h.some(b.layers,function(b){if(k.id===b.id)return q=b,!0});var e=null;q&&q.popupInfo&&(e=q.popupInfo);e&&(null===n&&(n={}),n[k.id]={infoTemplate:c._newInfoTemplate(e,k.name)})});null===q.infoTemplates&&(n?q.infoTemplates=n:c._setDynamicLayerInfoTemplates(q));k.resolve(q)},function(b){k.reject(b)})},function(b){k.reject(b)});return k},_getVisibleFeatureLayers:function(b,c){if(!b||!c||0===c.length)return[];
c=","+c+",";var k=[],q,n=",";for(q=0;q<b.length;q++)if(null!==b[q].subLayerIds){if(-1===c.indexOf(","+b[q].id+",")||-1<n.indexOf(","+b[q].id+","))n+=b[q].subLayerIds.toString()+","}else-1<c.indexOf(","+b[q].id+",")&&-1===n.indexOf(","+b[q].id+",")&&k.push(b[q].id);return k},_newPopupInfo:function(b,c){if(b&&b.fields){var k={title:b.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]};"string"===typeof c&&0<c.length&&(k.title=c);h.forEach(b.fields,function(b){var c=K.getDefaultPortalFieldInfo(b);
c.visible=!0;c.isEditable=b.editable;k.fieldInfos.push(c)});return k}return null},_newVectorTileLayer:function(){var b=this,c=new d,k={},q=this.serviceUrl,n=this._generateLayerId();"string"===typeof q&&0<q.length?this._checkVectorTileUrl(q,k).then(function(k){"string"===typeof k&&0<k.length?(k=b._checkMixedContent(k),k=new x(k,{id:n,opacity:1,visible:!0}),b._waitForLayer(k).then(function(b){c.resolve(b)},function(b){c.reject(b)})):c.resolve(null)},function(b){c.reject(b)}):c.resolve(null);return c},
_newWMSLayer:function(b){var c=this,n=this.item,e=!1,a=null,f={id:this._generateLayerId()};if(b){var I=[],K=[];h.forEach(b.layers,function(b){e=!0;K.push(new z({name:b.name,title:b.title,legendURL:b.legendURL,queryable:b.queryable,showPopup:b.showPopup}));I.push(b.name)},this);b.visibleLayers&&(I=b.visibleLayers);f={customLayerParameters:b.customLayerParameters,customParameters:b.customParameters,layerInfos:K,version:b.version,maxWidth:b.maxWidth,maxHeight:b.maxHeight,featureInfoFormat:b.featureInfoFormat,
getFeatureInfoURL:b.featureInfoUrl,getMapURL:b.mapUrl,spatialReferences:b.spatialReferences,title:b.title,copyright:b.copyright,minScale:b.minScale||0,maxScale:b.maxScale||0,format:b.format};n&&n.extent&&(n=new k(n.extent[0][0],n.extent[0][1],n.extent[1][0],n.extent[1][1],new q({wkid:4326})),f.extent=n);b.spatialReferences&&0<b.spatialReferences.length&&(a=b.spatialReferences[0]);f={id:this._generateLayerId(),visibleLayers:I,format:"png",transparent:b.firstLayer?!1:!0,opacity:b.opacity,visible:null!==
b.visibility?b.visibility:!0,resourceInfo:f,refreshInterval:b.refreshInterval}}b=new F(this.serviceUrl,f);b=this._waitForLayer(b);b.then(function(b){e||c._setWMSVisibleLayers(b);a&&b.spatialReference&&(b.spatialReference.wkid=a)});return b},_processFeatureLayer:function(c,k,q){var e=this,z=a.search.featureLayerTitlePattern,f=null;q&&q.layers&&0<q.layers.length?h.some(q.layers,function(q){var a,K,v,x=!1;if(q.id===c.layerId){q.popupInfo&&(a=q.popupInfo,a=u.parse(u.stringify(a)),a=new b(a),c.setInfoTemplate(a),
x=!0);r.isDefined(q.showLabels)&&c.setShowLabels(q.showLabels);r.isDefined(q.refreshInterval)&&c.setRefreshInterval(q.refreshInterval);r.isDefined(q.showLegend)&&console.log("");r.isDefined(q.timeAnimation)&&!1===q.timeAnimation&&console.log("");if(a=q.layerDefinition)a.definitionExpression&&c.setDefinitionExpression(a.definitionExpression),a.displayField&&c.displayField(a.displayField),a.drawingInfo&&(a.drawingInfo.renderer&&(K=u.parse(u.stringify(a.drawingInfo.renderer)),v=n.fromJson(K),K.type&&
"classBreaks"===K.type&&(v.isMaxInclusive=!0),c.setRenderer(v)),r.isDefined(a.drawingInfo.transparency)&&c.setOpacity(1-a.drawingInfo.transparency/100)),r.isDefined(a.minScale)&&c.setMinScale(a.minScale),r.isDefined(a.maxScale)&&c.setMaxScale(a.maxScale),r.isDefined(a.defaultVisibility)&&!1===a.defaultVisibility&&c.setVisibility(!1);x||e._setFeatureLayerInfoTemplate(c,q.popupInfo);f={url:c.url,id:c.id,itemId:k.id,title:e._makeFeatureLayerTitle(z,k.title,c.name)};return!0}}):(f={url:c.url,id:c.id,
itemId:k.id,title:e._makeFeatureLayerTitle(z,k.title,c.name)},e._setFeatureLayerInfoTemplate(c,null,f.title));return f},_readItemJsonData:function(){return w({url:this.itemUrl+"/data",content:{f:"json"},handleAs:"json"},{})},_readRestInfo:function(b){return w({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{})},_setDynamicLayerInfoTemplates:function(b){var c=this,k=null,q=[],n=function(q){var n=c._readRestInfo(b.url+"/"+q.id);n.then(function(b){try{var n=c._newPopupInfo(b);
n&&(k[q.id]={infoTemplate:c._newInfoTemplate(n)})}catch(M){console.warn("Error setting popup."),console.error(M)}});return n};null===b.infoTemplates&&h.forEach(b.layerInfos,function(b){null===k&&(k={});b.subLayerIds||q.push(n(b))});0<q.length&&m(q).then(function(){k&&(b.infoTemplates=k)}).otherwise(function(b){console.warn("Error reading sublayers.");console.error(b)})},_setFeatureLayerInfoTemplate:function(b,c,k){c||(c=this._newPopupInfo(b,k));c=this._newInfoTemplate(c,k);b.setInfoTemplate(c)},_setWMSVisibleLayers:function(b){var c=
[];b&&(h.some(b.layerInfos,function(b){if("string"===typeof b.name&&0<b.name.length)if(10>c.length)c.push(b.name);else return!0}),10>=c.length&&b.setVisibleLayers(c))},_waitForLayer:function(b){var c=new d,k=[];if(b.loaded)return c.resolve(b),c;if(b.loadError)return c.reject(b.loadError),c;var q=function(){h.forEach(k,function(b){b.remove()})};k.push(b.on("load",function(b){q();c.resolve(b.layer)}));k.push(b.on("error",function(b){q();b=b.error;try{b.message&&-1!==b.message.indexOf("Unable to complete")?
(console.warn("layerAccessError",b),c.reject(Error(a.search.layerInaccessible))):c.reject(b)}catch(O){c.reject(b)}}));return c}})})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(p,g,h,m,d,u){p=p(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,compressionQuality:null,bandIds:null,timeExtent:null,
mosaicRule:null,renderingRule:null,renderer:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,lercVersion:null,toJson:function(a){var l=this.bbox||this.extent;a=(l=l&&a&&l._normalize(!0))?l.spatialReference.wkid||h.toJson(l.spatialReference.toJson()):null;var d=this.imageSpatialReference,l={bbox:l?l.xmin+","+l.ymin+","+l.xmax+","+l.ymax:null,bboxSR:a,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:d?d.wkid||h.toJson(d.toJson()):a,format:this.format,
interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?h.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?h.toJson(this.renderingRule.toJson()):null,renderer:this.renderer?h.toJson(this.renderer.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio,lercVersion:this.lercVersion};
a=this.timeExtent;return l.time=a?a.toJson().join(","):null,u.filter(l,function(a){if(null!==a&&void 0!==a)return!0})}});return g.mixin(p,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"}),m("extend-esri")&&g.setObject("layers.ImageServiceParameters",p,d),p})},"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../urlUtils ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),
function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,C,A,E,H,f,e,t,v,x){var F=g([f],{declaredClass:"esri.layers.KMLLayer",serviceUrl:C.getProtocolForWebResource()+"//utility.arcgis.com/sharing/kml",constructor:function(e,b){e||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new A({wkid:4326});this._options=m.mixin({},b);B.defaults.kmlService&&(this.serviceUrl=B.defaults.kmlService);(e=this.linkInfo=b&&b.linkInfo)&&(this.visible=!!e.visibility,this._waitingForMap=
!!e.viewFormat);(!e||e&&e.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=m.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(e){if(e){var b,c;c=e.type;var n=e.id;switch(c){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(e=this["_"+c])&&(b=m.getObject("_mode._featureMap."+n,!1,e));break;case "GroundOverlay":if(e=this._groundLyr){var k=e.getImages();c=k.length;for(e=0;e<c;e++)if(k[e].id===n){b=k[e];
break}}break;case "ScreenOverlay":break;case "NetworkLink":d.some(this._links,function(c){return!(!c.linkInfo||c.linkInfo.id!==n)&&(b=c,!0)});break;case "Folder":c=(k=this.folders)?k.length:0;for(e=0;e<c;e++)if(k[e].id===n){b=k[e];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return b}},getLayers:function(){var e=[];return this._groundLyr&&e.push(this._groundLyr),this._fLayers&&(e=e.concat(this._fLayers)),this._links&&d.forEach(this._links,function(b){b.declaredClass&&
e.push(b)}),e},setFolderVisibility:function(e,b){e&&(this._fireUpdateStart(),e.visible=b,b&&(b=this._areLocalAncestorsVisible(e)),this._setState(e,b),this._fireUpdateEnd())},_eventMap:{"network-link-error":["error"]},onRefresh:function(){},onOpacityChange:function(){},onNetworkLinkError:function(){},_parseKml:function(e){var b=this;this._fireUpdateStart();this._io=y({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(e),model:"simple",folders:"",refresh:!!this.loaded||void 0,
outSR:u.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(c){b._io=null;b._initLayer(c)},error:function(c){b._io=null;c=m.mixin(Error(),c);c.message="Unable to load KML: "+(c.message||"");b._fireUpdateEnd(c);b._errorHandler(c)}})},_initLayer:function(a){var b;this.loaded&&(b=[],d.forEach(this.folders,function(c){c.visible&&b.push(c.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());
this.name=a.name;this.description=a.description;this.snippet=a.snippet;this.visibility=a.visibility;this.featureInfos=a.featureInfos;var c,n,k,q=this.folders=a.folders,z=[];if(q)for(n=q.length,c=0;c<n;c++)k=q[c]=new e(q[c]),-1===k.parentFolderId&&z.push(k);var f;n=(k=this._links=a.networkLinks)?k.length:0;for(c=0;c<n;c++)k[c].viewRefreshMode&&-1!==k[c].viewRefreshMode.toLowerCase().indexOf("onregion")||(f=m.mixin({},this._options),f.linkInfo=k[c],f.id&&(f.id=f.id+"_"+c),q=k[c]=new F(k[c].href,f),
q._parentLayer=this,q._parentFolderId=this._getLinkParentId(q.linkInfo.id),q._linkErrorHandle=q.on("error,network-link-error",m.hitch(q,function(b){this._parentLayer.onNetworkLinkError(b.error)})));if((k=a.groundOverlays)&&0<k.length)for(f=m.mixin({},this._options),f.id&&(f.id+="_mapImage"),q=this._groundLyr=new v(f),n=k.length,c=0;c<n;c++)q.addImage(new t(k[c]));a=m.getObject("featureCollection.layers",!1,a);if(a&&0<a.length&&(this._fLayers=[],d.forEach(a,function(b,c){var k,q=m.getObject("featureSet.features",
!1,b);q&&0<q.length&&(f=m.mixin({outFields:["*"],infoTemplate:b.popupInfo?new H(b.popupInfo):null,editable:!1},this._options),f.id&&(f.id=f.id+"_"+c),f.webgl=!1,b.layerDefinition.capabilities="Query,Data",k=new x(b,f),k.geometryType&&(this["_"+k.geometryType]=k),this._fLayers.push(k))},this),0===this._fLayers.length&&delete this._fLayers),!this.loaded)for(n=z.length,c=0;c<n;c++)k=z[c],this._setState(k,k.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),d.forEach(this.folders,function(c){-1<
d.indexOf(b,c.id)?this.setFolderVisibility(c,!0):this.setFolderVisibility(c,!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var e=this._map;this._fireUpdateStart();this._links&&d.forEach(this._links,function(b){b.declaredClass&&(e.addLayer(b),b._waitingForMap&&(b._waitingForMap=null,b.visible?b._parseKml(e):b._wMap=e))});var b,c=e.spatialReference,n=this._outSR;if(!c.equals(n))if(c.isWebMercator()&&4326===n.wkid)b=E.geographicToWebMercator;else{if(!n.isWebMercator()||
4326!==c.wkid)return void console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");b=E.webMercatorToGeographic}this._groundLyr&&(b&&d.forEach(this._groundLyr.getImages(),function(c){c.extent=b(c.extent)}),e.addLayer(this._groundLyr));(c=this._fLayers)&&0<c.length&&d.forEach(c,function(c){if(b){var k,n,a=c.graphics,f=a?a.length:0;for(k=0;k<f;k++)(n=a[k].geometry)&&a[k].setGeometry(b(n))}e.addLayer(c)});
this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var e=this._map;this._links&&d.forEach(this._links,function(b){b.declaredClass&&b._io&&b._io.cancel();b._linkErrorHandle&&(b._linkErrorHandle.remove(),b._linkErrorHandle=null)});e&&d.forEach(this.getLayers(),e.removeLayer,e)},_setState:function(e,b){var c,n,k=e.featureInfos,q=k?k.length:0,a=b?"show":"hide";for(n=0;n<q;n++)e=k[n],(c=this.getFeature(e))&&("Folder"===e.type?this._setState(c,b&&c.visible):"NetworkLink"===e.type?this._setInternalVisibility(c,
b):c[a]())},_areLocalAncestorsVisible:function(e){var b=e.parentFolderId;for(e=e.visible;e&&-1!==b;)b=this.getFeature({type:"Folder",id:b}),e=e&&b.visible,b=b.parentFolderId;return e},_setInternalVisibility:function(e,b){var c=e._parentLayer,n=e._parentFolderId;for(b=b&&e.visible;b&&c;)b=b&&c.visible,-1<n&&(b=b&&c._areLocalAncestorsVisible(c.getFeature({type:"Folder",id:n}))),n=c._parentFolderId,c=c._parentLayer;this._setIntState(e,b)},_setIntState:function(e,b){e&&d.forEach(e.getLayers(),function(c){c.linkInfo?
e._setIntState(c,b&&c.visible&&e._areLocalAncestorsVisible(e.getFeature({type:"Folder",id:c._parentFolderId}))):c.setVisibility(b)})},_getLinkParentId:function(e){var b=-1;return this.folders&&d.some(this.folders,function(c){return!(!c.networkLinkIds||-1===d.indexOf(c.networkLinkIds,e))&&(b=c.id,!0)}),b},_checkAutoRefresh:function(){var e=this.linkInfo;if(e)if(this.visible){if(this.loaded&&this._map){var b=e.refreshMode,c=e.refreshInterval,n=e.viewRefreshMode,e=e.viewRefreshTime;b&&-1!==b.toLowerCase().indexOf("oninterval")&&
0<c&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*c));n&&-1!==n.toLowerCase().indexOf("onstop")&&0<e&&(this._extChgHandle||(this._extChgHandle=h.connect(this._map,"onExtentChange",this,this._extentChanged)))}}else this._stopAutoRefresh(),h.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(e){e=e||this._map;var b,c={},n=this.linkInfo,k=e&&e.extent;
(this._url.query&&(m.mixin(c,this._url.query),b=!!this._url.query.token),D.id&&!b)&&(b=D.id.findCredential(this._url.path))&&(c.token=b.token);if(n){b=n.viewFormat;var q=n.httpQuery,n=n.viewBoundScale;if(k&&b){var a=k,f=k,v=k.spatialReference;v&&(v.isWebMercator()?a=E.webMercatorToGeographic(k):4326===v.wkid&&(f=E.geographicToWebMercator(k)));k=a.getCenter();f=Math.max(f.getWidth(),f.getHeight());n&&(a=a.expand(n));b=b.replace(/\[bboxWest\]/gi,a.xmin).replace(/\[bboxEast\]/gi,a.xmax).replace(/\[bboxSouth\]/gi,
a.ymin).replace(/\[bboxNorth\]/gi,a.ymax).replace(/\[lookatLon\]/gi,k.x).replace(/\[lookatLat\]/gi,k.y).replace(/\[lookatRange\]/gi,f).replace(/\[lookatTilt\]/gi,0).replace(/\[lookatHeading\]/gi,0).replace(/\[lookatTerrainLon\]/gi,k.x).replace(/\[lookatTerrainLat\]/gi,k.y).replace(/\[lookatTerrainAlt\]/gi,0).replace(/\[cameraLon\]/gi,k.x).replace(/\[cameraLat\]/gi,k.y).replace(/\[cameraAlt\]/gi,f).replace(/\[horizFov\]/gi,60).replace(/\[vertFov\]/gi,60).replace(/\[horizPixels\]/gi,e.width).replace(/\[vertPixels\]/gi,
e.height).replace(/\[terrainEnabled\]/gi,0);m.mixin(c,l.queryToObject(b))}q&&(q=q.replace(/\[clientVersion\]/gi,D.version).replace(/\[kmlVersion\]/gi,2.2).replace(/\[clientName\]/gi,"ArcGIS API for JavaScript").replace(/\[language\]/gi,p.locale),m.mixin(c,l.queryToObject(q)))}var x;e=[];for(x in c)G.isDefined(c[x])&&e.push(x+"\x3d"+c[x]);return e=e.join("\x26"),e?"?"+e:""},setScaleRange:function(e,b){this.inherited(arguments);d.forEach(this.getLayers(),function(c){c.setScaleRange(e,b)})},setOpacity:function(e){this.opacity!=
e&&(d.forEach(this.getLayers(),function(b){b.setOpacity(e)}),this.opacity=e,this.onOpacityChange(e))},_setMap:function(e,b){this.inherited(arguments);this._map=e;var c=this._div=r.create("div",null,b);return w.set(c,"position","absolute"),this._addInternalLayers(),this.evaluateSuspension(),c},_unsetMap:function(e,b){this._io&&this._io.cancel();this._stopAutoRefresh();h.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var c=this._div;c&&(b.removeChild(c),r.destroy(c));
this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(e){if(!this.loaded)return void(this.linkInfo&&e&&(this._waitingForMap||this._parseKml(this._wMap)));this._fireUpdateStart();this._setInternalVisibility(this,e);this._checkAutoRefresh();this._fireUpdateEnd()},refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._parseKml()},getFeatureCollection:function(e){var b,c=[];e=this.getFeature({type:"Folder",id:e});return e&&(b=d.map(e.featureInfos,function(b){if("esriGeometryPoint"===
b.type||"esriGeometryPolyline"===b.type||"esriGeometryPolygon"===b.type)return b.id},this))&&0<b.length&&d.forEach(this._fLayers,function(e){var k,q;k=e.toJson();k.featureSet.features&&0<k.featureSet.features.length&&(q=d.filter(k.featureSet.features,function(c){if(-1!==d.indexOf(b,c.attributes[e.objectIdField]))return c},this));q&&0<q.length&&(k.featureSet.features=q,c.push(k))},this),c},getFeatureCount:function(e){e=this.getFeature({type:"Folder",id:e});var b={points:0,polylines:0,polygons:0};return e&&
d.forEach(e.featureInfos,function(c){"esriGeometryPoint"===c.type&&(b.points+=1);"esriGeometryPolyline"===c.type&&(b.polylines+=1);"esriGeometryPolygon"===c.type&&(b.polygons+=1)}),b},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});return a("extend-esri")&&m.setObject("layers.KMLLayer",F,D),F})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,
g,h,m,d){p=p(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(h){g.mixin(this,h);d.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});return h("extend-esri")&&g.setObject("layers.KMLFolder",p,m),p})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(p,g,h,m,d,u){p=p([u],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(a){d.isDefined(this.visibility)&&(this.visible=
!!this.visibility)}});return h("extend-esri")&&g.setObject("layers.KMLGroundOverlay",p,m),p})},"esri/layers/WMSLayer":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff ../config ../graphic ../kernel ../request ../urlUtils ../dijit/PopupTemplate ../SpatialReference ../geometry/Extent ../geometry/Point ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,C,A,E){h=h([A],{declaredClass:"esri.layers.WMSLayer",
_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,
21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(a,f){var e=D.urlToObject(a);e.query&&(e.query.version||e.query.Version||e.query.VERSION)&&(this.version=e.query.version||e.query.Version||e.query.VERSION);this.url=
a=this._stripParameters(a,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));this._url=D.urlToObject(a);this._getCapabilitiesURL=a;this._initLayer=m.hitch(this,this._initLayer);this._parseCapabilities=m.hitch(this,this._parseCapabilities);this._getCapabilitiesError=m.hitch(this,this._getCapabilitiesError);f?(this.customParameters=f.customParameters,this.customLayerParameters=f.customLayerParameters,this.imageFormat=
this._getImageFormat(f.format),this.imageTransparency=!1!==f.transparent,this.visibleLayers=f.visibleLayers?f.visibleLayers:[],this.version=f.version||this.version,f.resourceInfo?this._readResourceInfo(f.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=p.toUrl("../images/pixel.png");this.extentProcessor=this._createExtentProcessor(0);this._createChildLayer()},setVisibleLayers:function(a){this.visibleLayers=
(a=this._checkVisibleLayersList(a))||[];this.refresh(!0)},setImageFormat:function(a){this.imageFormat=this._getImageFormat(a);this.refresh(!0)},setImageTransparency:function(a){this.imageTransparency=a;this.refresh(!0)},setCustomParameters:function(a,f){this.customParameters=a;this.customLayerParameters=f;this.refresh(!0)},refresh:function(){this.inherited(arguments);this._childLayer&&this._childLayer.refresh.apply(this._childLayer,arguments)},getImageUrl:function(a,f,e,t){if(!this.visibleLayers||
0===this.visibleLayers.length)return void t(this._blankImageURL);a=this._getImageParams(a,f,e);a=this._mixinCustomLayerParameters(a);var v;f=this.getMapURL;f+=-1===f.indexOf("?")?"?":"";for(v in a)a.hasOwnProperty(v)&&(f+="?"===f.substring(f.length-1,f.length)?"":"\x26",f+=v+"\x3d"+a[v]);t(D.addProxy(f))},_setMap:function(a,f,e){var t=this.inherited(arguments);return a.wrapAround180?this._childLayer&&(this.suspended&&this._childLayer.suspend(),this._childLayer._setMap(a,t)):(this.extentProcessor=
null,this._childLayer=null),t},_unsetMap:function(a,f){this._childLayer&&this._childLayer._unsetMap(a,this._div);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._childLayer&&this._childLayer.suspend()},onResume:function(){this.inherited(arguments);this._childLayer&&this._childLayer.resume()},_createChildLayer:function(){this._childLayer=new A(null,{extentProcessor:this._createExtentProcessor(1)});this._childLayer._isChildLayer=!0;this._childLayer.getImageUrl=m.hitch(this,
this.getImageUrl);this._childLayer.loaded=!0},_createExtentProcessor:function(a){return m.hitch(this,this._extentProcessor,a)},_extentProcessor:function(a,f){var e=f.extent,t=f.width,v=0;if(e){f=e.getWidth()/t;var x=e.bisect(),e=x.extents,F=e[a];F&&(t=x.marginLeft/f,v=0===a?t:t+e[0].getWidth()/f,t=Math.ceil(F.getWidth()/f),v=Math.ceil(v));e=F}return{extent:e,width:t,marginLeft:v}},_getImageParams:function(a,f,e){var t=a.spatialReference.wkid;if(-1===d.indexOf(this.spatialReferences,t)&&a.spatialReference.latestWkid&&
(t=a.spatialReference.latestWkid),d.some(this._WEB_MERCATOR,function(b){return b==t})){var v=d.filter(this.spatialReferences,function(b){return d.some(this._WEB_MERCATOR,function(c){return c==b})},this);0===v.length&&(v=d.filter(this.spatialReferences,function(b){return d.some(this._WORLD_MERCATOR,function(c){return c==b})},this));t=0<v.length?v[0]:this._WEB_MERCATOR[1]}this.spatialReferences=d.filter(this.spatialReferences,function(b){return b!==t});this.spatialReferences.unshift(t);var v=a.xmin,
x=a.xmax,F=a.ymin;a=a.ymax;var z={SERVICE:"WMS",REQUEST:"GetMap"};z.FORMAT=this.imageFormat;z.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";z.STYLES="";z.VERSION=this.version;z.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;z.WIDTH=f;z.HEIGHT=e;this.maxWidth<f&&(z.WIDTH=this.maxWidth);this.maxHeight<e&&(z.HEIGHT=this.maxHeight);f=t||NaN;return isNaN(f)||("1.3.0"==this.version?z.CRS="EPSG:"+f:z.SRS="EPSG:"+f),"1.3.0"==this.version&&this._useLatLong(f)?z.BBOX=F+","+v+","+a+","+x:z.BBOX=
v+","+F+","+x+","+a,z},_initLayer:function(l,f){this.spatialReference=new G(this.extent.spatialReference);this.initialExtent=new y(this.extent);this.fullExtent=new y(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);var e=m.hitch(this,function(){this.loaded=!0;this.onLoad(this);var e=this._loadCallback;e&&(delete this._loadCallback,e(this))});u("chrome")?(l=a.defaults.io,f="with-credentials"===l.useCors?D.canUseXhr(this.getMapURL,!0):-1,(l=-1<f?l.corsEnabledServers[f]:
null)&&l.withCredentials?w({url:this.getMapURL,handleAs:"text",content:{SERVICE:"WMS",REQUEST:"GetMap"}}).addBoth(function(){e()}):e()):e()},_readResourceInfo:function(a){return a.extent?a.layerInfos?(this.extent=a.extent,this.allExtents[0]=a.extent,this.layerInfos=a.layerInfos,this.description=a.description?a.description:"",this.copyright=a.copyright?a.copyright:"",this.title=a.title?a.title:"",this.getMapURL=a.getMapURL?a.getMapURL:this._getCapabilitiesURL,this.getFeatureInfoURL=a.getFeatureInfoURL,
this.featureInfoFormat=a.featureInfoFormat,this.version=a.version?a.version:"1.3.0",this.maxWidth=a.maxWidth?a.maxWidth:5E3,this.maxHeight=a.maxHeight?a.maxHeight:5E3,this.spatialReferences=a.spatialReferences?a.spatialReferences:[],this.imageFormat=this._getImageFormat(a.format),this.setScaleRange(a.minScale,a.maxScale),this.customLayerParameters=a.customLayerParameters||this.customLayerParameters,this.customParameters=a.customParameters||this.customParameters,void this._initLayer()):void this._errorHandler(Error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo")):
void this._errorHandler(Error("esri.layers.WMSLayer: Unable to find the 'extent' property in resourceInfo."))},_getCapabilities:function(){var a=this._url.query?this._url.query:{};a.SERVICE="WMS";a.REQUEST="GetCapabilities";this.version&&(a.VERSION=this.version);var a=this._mixinCustomParameters(a),f,e=this._url.path+"?";for(f in a)a.hasOwnProperty(f)&&(e+="?"==e.substring(e.length-1,e.length)?"":"\x26",e+=f+"\x3d"+a[f]);w({url:e,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,
error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(a){if(!a)return void this._errorHandler(Error("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)"));var f=this;(this.version=this._getAttributeValue("WMS_Capabilities","version",a,null))||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",a,"1.3.0"));var e=this._getTag("Service",a);(this.title=this._getTagValue("Title",e,""))||(this.title=this._getTagValue("Name",e,""));
this.copyright=this._getTagValue("AccessConstraints",e,"");this.description=this._getTagValue("Abstract",e,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",e,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",e,5E3),10);e=this._getTag("Layer",a);if(!e)return void this._errorHandler(Error("esri.layers.WMSLayer: Response does not contain any layers."));var t=this._getLayerInfo(e),v=0,x=null,e=this._getTag("Capability",a);if(d.forEach(e.childNodes,function(b){"Layer"==b.nodeName&&
(0===v?x=b:1===v?(t.name&&(t.name="",t.subLayers=[],t.subLayers.push(this._getLayerInfo(x))),t.subLayers.push(this._getLayerInfo(b))):t.subLayers.push(this._getLayerInfo(b)),v++)},this),t&&(this.layerInfos=t.subLayers,this.layerInfos&&0!==this.layerInfos.length||(this.layerInfos=[t]),this.extent=t.extent,this.extent||(t.extent=new y(this.layerInfos[0].extent.toJson()),this.extent=t.extent),this.allExtents=t.allExtents,this.allExtents&&this.allExtents.length||(t.allExtents=[],d.forEach(this.layerInfos[0].allExtents,
function(b,e){b&&(t.allExtents[e]=new y(b.toJson()))}),this.allExtents=t.allExtents),this.spatialReferences=t.spatialReferences,!this.spatialReferences.length&&0<this.layerInfos.length))for(var F=function(b){var c;for(c=0;c<b.subLayers.length;c++){var k=b.subLayers[c],q=k.spatialReferences;if(!q.length&&k.subLayers&&0<k.subLayers.length&&(q=F(k)),q.length)return q}return[]},e=0;e<this.layerInfos.length;e++){var z=this.layerInfos[e];if(this.spatialReferences=this.layerInfos[0].spatialReferences,!this.spatialReferences.length&&
z.subLayers&&0<z.subLayers.length&&(this.spatialReferences=F(z)),this.spatialReferences.length)break}e=function(b){return(b=g.query("DCPType",f._getTag(b,a)))&&0<b.length&&(b=g.query("HTTP",b[0]))&&0<b.length&&(b=g.query("Get",b[0]))&&0<b.length&&(b=f._getAttributeValue("OnlineResource","xlink:href",b[0],null))?(b.indexOf("\x26")===b.length-1&&(b=b.substring(0,b.length-1)),f._stripParameters(b,["service","request"])):null};z=function(b){var c=[];return 0===g.query("Operation",a).length?d.forEach(g.query("Format",
f._getTag(b,a)),function(b){c.push(b.text?b.text:b.textContent)}):d.forEach(g.query("Operation",a),function(k){k.getAttribute("name")===b&&d.forEach(g.query("Format",k),function(b){c.push(b.text?b.text:b.textContent)})}),c};if(this.getMapURL=e("GetMap")||this._getCapabilitiesURL,this.getMapFormats=z("GetMap"),d.some(this.getMapFormats,function(b){return-1<b.indexOf(this.imageFormat)},this)||(this.imageFormat=this.getMapFormats[0]),this.getFeatureInfoURL=e("GetFeatureInfo"),this.getFeatureInfoURL&&
(this.getFeatureInfoFormats=z("GetFeatureInfo"),-1<d.indexOf(this.getFeatureInfoFormats,"text/html")?this.featureInfoFormat="text/html":-1<d.indexOf(this.getFeatureInfoFormats,"text/plain")&&(this.featureInfoFormat="text/plain")),!this.featureInfoFormat){var b=function(c){if(c&&(c.queryable=!1,c.subLayers))for(var e=0;e<c.subLayers.length;e++)b(c.subLayers[e])};b(t)}this._initLayer()},_getCapabilitiesError:function(a){a&&a.message&&(a.message="GetCapabilities request for "+this._getCapabilitiesURL+
" failed. ("+a.message+")");this._errorHandler(a)},_getLayerInfo:function(a){if(!a)return null;var f=new E;f.name="";f.title="";f.description="";f.allExtents=[];f.spatialReferences=[];f.queryable="1"===a.getAttribute("queryable");f.subLayers=[];var e=this._getTag("LatLonBoundingBox",a);e&&(f.allExtents[0]=this._getExtent(e,4326));var t,v=this._getTag("EX_GeographicBoundingBox",a);v&&(t=new y(0,0,0,0,new G({wkid:4326})),t.xmin=parseFloat(this._getTagValue("westBoundLongitude",v,0)),t.ymin=parseFloat(this._getTagValue("southBoundLatitude",
v,0)),t.xmax=parseFloat(this._getTagValue("eastBoundLongitude",v,0)),t.ymax=parseFloat(this._getTagValue("northBoundLatitude",v,0)),f.allExtents[0]=t);e||v||(t=new y(-180,-90,180,90,new G({wkid:4326})),f.allExtents[0]=t);f.extent=f.allExtents[0];var x=-1<d.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";return d.forEach(a.childNodes,function(e){if("Name"==e.nodeName)f.name=(e.text?e.text:e.textContent)||"";else if("Title"==e.nodeName)f.title=(e.text?e.text:e.textContent)||"";else if("Abstract"==
e.nodeName)f.description=(e.text?e.text:e.textContent)||"";else if("BoundingBox"==e.nodeName){var a,b=e.getAttribute(x);b&&0===b.indexOf("EPSG:")?0===(a=parseInt(b.substring(5),10))||isNaN(a)||(e="1.3.0"==this.version?this._getExtent(e,a,this._useLatLong(a)):this._getExtent(e,a),f.allExtents[a]=e,f.extent||(f.extent=e)):b&&0===b.indexOf("CRS:")?0===(a=parseInt(b.substring(4),10))||isNaN(a)||(this._CRS_TO_EPSG[a]&&(a=this._CRS_TO_EPSG[a]),f.allExtents[a]=this._getExtent(e,a)):0===(a=parseInt(b,10))||
isNaN(a)||(f.allExtents[a]=this._getExtent(e,a))}else e.nodeName==x?(a=(e.text?e.text:e.textContent).split(" "),d.forEach(a,function(b){0===(b=-1<b.indexOf(":")?parseInt(b.split(":")[1],10):parseInt(b,10))||isNaN(b)||(this._CRS_TO_EPSG[b]&&(b=this._CRS_TO_EPSG[b]),-1==d.indexOf(f.spatialReferences,b)&&f.spatialReferences.push(b))},this)):"Style"!=e.nodeName||f.legendURL?"Layer"===e.nodeName&&f.subLayers.push(this._getLayerInfo(e)):(a=this._getTag("LegendURL",e))&&(a=this._getTag("OnlineResource",
a))&&(f.legendURL=a.getAttribute("xlink:href"))},this),f.title=f.title||f.name,f},_getImageFormat:function(a){switch(a?a.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},
_getExtent:function(a,f,e){var t;if(a){t=new y;var v=parseFloat(a.getAttribute("minx")),x=parseFloat(a.getAttribute("miny")),l=parseFloat(a.getAttribute("maxx"));a=parseFloat(a.getAttribute("maxy"));e?(t.xmin=isNaN(x)?-1*Number.MAX_VALUE:x,t.ymin=isNaN(v)?-1*Number.MAX_VALUE:v,t.xmax=isNaN(a)?Number.MAX_VALUE:a,t.ymax=isNaN(l)?Number.MAX_VALUE:l):(t.xmin=isNaN(v)?-1*Number.MAX_VALUE:v,t.ymin=isNaN(x)?-1*Number.MAX_VALUE:x,t.xmax=isNaN(l)?Number.MAX_VALUE:l,t.ymax=isNaN(a)?Number.MAX_VALUE:a);t.spatialReference=
new G({wkid:f})}return t},_useLatLong:function(a){var f,e;for(e=0;e<this._REVERSED_LAT_LONG_RANGES.length;e++){var t=this._REVERSED_LAT_LONG_RANGES[e];if(a>=t[0]&&a<=t[1]){f=!0;break}}return f},_getTag:function(a,f){return(a=g.query(a,f))&&0<a.length?a[0]:null},_getTagValue:function(a,f,e){return(a=g.query(a,f))&&0<a.length?a[0].text?a[0].text:a[0].textContent:e},_getAttributeValue:function(a,f,e,t){return(a=g.query(a,e))&&0<a.length?a[0].getAttribute(f):t},_checkVisibleLayersList:function(a){if(a&&
0<a.length&&this.layerInfos&&0<this.layerInfos.length&&"number"==typeof a[0]){var f=[];d.forEach(a,function(e){e<this.layerInfos.length&&f.push(this.layerInfos[e].name)},this);a=f}return a},_stripParameters:function(a,f){var e;a=D.urlToObject(a);var t=[];for(e in a.query)a.query.hasOwnProperty(e)&&-1===d.indexOf(f,e.toLowerCase())&&t.push(e+"\x3d"+a.query[e]);return a.path+(t.length?"?"+t.join("\x26"):"")},_getPopupGraphic:function(a,f){var e=this.visibleLayers;if(!e||0===e.length)return null;var t=
this._popupGraphic;t||(t=new B({title:this.title||"",description:'\x3cdiv style\x3d"position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%;"\x3e\x3ciframe src\x3d"{QUERY_URL}" width\x3d"250" height\x3d"147" frameborder\x3d"0" marginwidth\x3d"0" marginheight\x3d"0" style\x3d"position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:url(\''+p.toUrl("../dijit/images/loading-throb.gif")+"') transparent center no-repeat;\" onload\x3d\"(event.target || event.srcElement).style.background \x3d 'none';\"\x3e\x3c/iframe\x3e\x3c/div\x3e"}),
t=this._popupGraphic=new l(null,null,{},t),t._layer=this);var v=function(b){var c=[];if(b&&(b.queryable&&b.showPopup&&b.name&&c.push(b.name),b.subLayers))for(var a=0;a<b.subLayers.length;a++){var k=v(b.subLayers[a]);k.length&&(c=c.concat(k))}return c},x=v({subLayers:this.layerInfos});if(x=d.filter(x,function(b){return-1<d.indexOf(e,b)}),x.length){var F=this.getFeatureInfoURL;a=this._getImageParams(a.extent,a.width,a.height);a=this._mixinCustomLayerParameters(a);a.REQUEST="GetFeatureInfo";a.INFO_FORMAT=
this.featureInfoFormat;a.QUERY_LAYERS=x.join();a.FEATURE_COUNT=25;"1.3.0"===this.version?(a.I=Math.round(f.x),a.J=Math.round(f.y)):(a.X=Math.round(f.x),a.Y=Math.round(f.y));var F=F+(-1===F.indexOf("?")?"?":""),z;for(z in a)a.hasOwnProperty(z)&&(F+="?"===F.substring(F.length-1,F.length)?"":"\x26",F+=z+"\x3d"+a[z]);return t.attributes.QUERY_URL=F,t}return null},_mixinCustomParameters:function(a){if(this.customParameters)for(var f in this.customParameters)a[f]=encodeURIComponent(this.customParameters[f]);
return a},_mixinCustomLayerParameters:function(a){if(this.customLayerParameters||this.customParameters){var f=m.clone(this.customParameters||{});m.mixin(f,this.customLayerParameters||{});for(var e in f)"styles"===e.toLowerCase()&&delete a.STYLES,a[e]=encodeURIComponent(f[e])}return a}});return u("extend-esri")&&m.setObject("layers.WMSLayer",h,r),h})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(p,g,h,m,d){p=
p(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],queryable:!1,showPopup:!1,constructor:function(d){d&&(this.name=d.name,this.title=d.title,this.description=d.description,this.extent=d.extent,this.legendURL=d.legendURL,this.subLayers=d.subLayers?d.subLayers:[],this.allExtents=d.allExtents?d.allExtents:[],this.spatialReferences=d.spatialReferences?d.spatialReferences:[],this.queryable=!!d.queryable,
this.showPopup=!!d.showPopup)},clone:function(){var d,a={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL};this.extent&&(a.extent=this.extent.getExtent());a.subLayers=[];h.forEach(this.subLayers,function(d){a.subLayers.push(d.clone())});a.allExtents=[];for(d in this.allExtents)d=parseInt(d,10),isNaN(d)||(a.allExtents[d]=this.allExtents[d].getExtent());return a.spatialReferences=[],h.forEach(this.spatialReferences,function(d){a.spatialReferences.push(d)}),a.queryable=
this.queryable,a.showPopup=this.showPopup,a}});return m("extend-esri")&&g.setObject("layers.WMSLayerInfo",p,d),p})},"widgets/AddData/search/Paging":function(){define("dojo/_base/declare dojo/dom-class ./SearchComponent dojo/text!./templates/Paging.html dojo/i18n!../nls/strings ./util".split(" "),function(p,g,h,m,d,u){return p([h],{i18n:d,templateString:m,hasLess:!1,hasMore:!1,nextStart:-1,numPerPage:null,previousStart:-1,start:1,postCreate:function(){this.inherited(arguments);null===this.numPerPage&&
(this.numPerPage=30);this.enableOrDisable()},startup:function(){if(!this._started){this.inherited(arguments);try{var a=this.getConfig().numPerPage,d=Number(a);"number"!==typeof d||isNaN(d)||(d=Math.floor(d),1<=d&&100>=d&&(this.numPerPage=d))}catch(r){console.warn("Error setting numPerPage:"),console.warn(r)}null===this.numPerPage&&(this.numPerPage=30)}},enableOrDisable:function(){this.hasLess?(g.remove(this.firstButton.parentNode,"disabled"),g.remove(this.previousButton.parentNode,"disabled")):(g.add(this.firstButton.parentNode,
"disabled"),g.add(this.previousButton.parentNode,"disabled"));this.hasMore?g.remove(this.nextButton.parentNode,"disabled"):g.add(this.nextButton.parentNode,"disabled")},firstButtonClicked:function(){this.hasLess&&(this.start=1,this.search())},previousButtonClicked:function(){this.hasLess&&(this.start=this.previousStart,this.search())},nextButtonClicked:function(){this.hasMore&&(this.start=this.nextStart,this.search())},appendQueryParams:function(a){a.start=this.start;a.num=this.numPerPage},processResults:function(a){this.start=
1;var d=this.numPerPage,g=a.total,h=a.queryParams.start;1>h&&(h=1);this.hasLess=!1;this.previousStart=-1;1<h&&(this.hasLess=!0,this.previousStart=h-a.queryParams.num,1>this.previousStart&&(this.previousStart=1));this.hasMore=!1;this.nextStart=-1;a.nextQueryParams&&1<a.nextQueryParams.start&&(this.hasMore=!0,this.nextStart=a.nextQueryParams.start);a="";g>d?(g=1,1<h&&(g=Math.floor(h/d)+1),a=this.i18n.search.paging.pagePattern,a=a.replace("{page}",""+g)):(a=this.i18n.search.paging.pagePattern,a=a.replace("{page}",
"1"));u.setNodeText(this.pageNode,a);this.enableOrDisable()}})})},"widgets/AddData/search/ResultCount":function(){define("dojo/_base/declare dojo/number ./SearchComponent dojo/text!./templates/ResultCount.html dojo/i18n!../nls/strings ./util".split(" "),function(p,g,h,m,d,u){return p([h],{i18n:d,templateString:m,typePlural:d.search.resultCount.itemPlural,typeSingular:d.search.resultCount.itemSingular,postCreate:function(){this.inherited(arguments)},processResults:function(a){a=a.total;var d=this.typePlural;
1===a&&(d=this.typeSingular);var h=this.i18n.search.resultCount.countPattern,h=h.replace("{count}",g.format(a)),h=h.replace("{type}",d);u.setNodeText(this.messageNode,h)}})})},"widgets/AddData/search/AddFromUrlPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/Deferred dojo/promise/all dojo/dom-class dojo/window dijit/Viewport dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromUrlPane.html dojo/i18n!../nls/strings ./LayerLoader ./util esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/CSVLayer esri/layers/FeatureLayer esri/layers/GeoRSSLayer esri/layers/ImageParameters esri/layers/KMLLayer esri/layers/StreamLayer esri/layers/VectorTileLayer esri/layers/WFSLayer esri/layers/WMSLayer esri/layers/WMTSLayer esri/InfoTemplate jimu/dijit/Message dijit/form/Select".split(" "),
function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,C,A,E,H,f,e,t,v,x,F,z,b,c,n,k,q,K,I){return p([D,B,G],{i18n:C,templateString:y,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);this._updateExamples("ArcGIS");var b=this;this.own(m(this.urlTextBox,"keyup",function(c){c.keyCode===d.ENTER?b.addClicked():l.contains(b.addButton,"disabled")||b._setStatus("")}));this.own(m(this.urlTextBox,"focus",function(){try{b.urlTextBox.select()}catch(L){}}));this.own(m(this.typeSelect,"change",function(c){b._updateExamples(c)}));
this.own(m(this.typeSelect.dropDown,"open",function(){var b=this.domNode.parentElement;b&&l.add(b,"add-data-widget-popup")}));this.own(w.on("resize",b.resize()))},destroy:function(){this.inherited(arguments)},addClicked:function(){var b=this,c=!1,k=this.addButton;if(!l.contains(k,"disabled")){var a=this.typeSelect.get("value"),e=g.trim(this.urlTextBox.value);0<e.length&&(0===e.indexOf("http://")||0===e.indexOf("https://"))&&(c=!0);c&&(l.add(k,"disabled"),b._setStatus(C.search.item.messages.adding),
c=new u,this._handleAdd(c,this.wabWidget.map,a,e),c.then(function(c){c?b._setStatus(""):b._setStatus(C.search.item.messages.addFailed);l.remove(k,"disabled")}).otherwise(function(c){"string"===typeof c&&"Unsupported"===c?(b._setStatus(C.search.item.messages.unsupported),l.remove(k,"disabled")):(console.warn("Add layer failed."),console.warn(c),b._setStatus(C.search.item.messages.addFailed),l.remove(k,"disabled"),c&&"string"===typeof c.message&&0<c.message.length&&(b._setStatus(c.message),console.log("")))}))}},
examplesExpanderClicked:function(){l.toggle(this.examplesNode,"show")},preHide:function(){},resize:function(){var b=r.getBox(this.ownerDocument);b&&"undefined"!==typeof b.w&&(600<b.w?l.add(this.urlTextBox,"url-textbox-wide"):l.remove(this.urlTextBox,"url-textbox-wide"))},_handleAdd:function(d,I,l,g){g=E.checkMixedContent(g);var r=g.toLowerCase(),m=new A,p=m._generateLayerId(),w=this,J=null;"ArcGIS"===l?0<r.indexOf("/featureserver")||0<r.indexOf("/mapserver")?m._readRestInfo(g).then(function(b){if(b&&
"string"===typeof b.type&&("Feature Layer"===b.type||"Table"===b.type))J=new v(g,{id:p,outFields:["*"],infoTemplate:new K}),w._waitThenAdd(d,I,l,m,J);else if(0<r.indexOf("/featureserver")){var c=[];h.forEach(b.layers,function(b){b=new v(g+"/"+b.id,{id:m._generateLayerId(),outFields:["*"],infoTemplate:new K});c.push(m._waitForLayer(b))});h.forEach(b.tables,function(b){b=new v(g+"/"+b.id,{id:m._generateLayerId(),outFields:["*"]});c.push(m._waitForLayer(b))});a(c).then(function(b){var c=[];h.forEach(b,
function(b){c.push(b)});c.reverse();h.forEach(c,function(b){m._setFeatureLayerInfoTemplate(b);b.xtnAddData=!0;I.addLayer(b)});d.resolve(c)}).otherwise(function(b){d.reject(b)})}else if(0<r.indexOf("/mapserver")){if(b.tileInfo)J=new e(g,{id:p});else{var k={id:p};b&&b.supportedImageFormatTypes&&-1!==b.supportedImageFormatTypes.indexOf("PNG32")&&(k.imageParameters=new F,k.imageParameters.format="png32");J=new H(g,k)}w._waitThenAdd(d,I,l,m,J)}}).otherwise(function(b){d.reject(b)}):0<r.indexOf("/imageserver")?
(J=new f(g,{id:p}),this._waitThenAdd(d,I,l,m,J)):0<r.indexOf("/vectortileserver")||0<r.indexOf("/resources/styles/root.json")?c&&c.supported()?m._checkVectorTileUrl(g,{}).then(function(b){J=new c(b,{id:p});w._waitThenAdd(d,I,l,m,J)}).otherwise(function(b){d.reject(b)}):d.reject("Unsupported"):0<r.indexOf("/streamserver")?(J=new b(g,{id:p,purgeOptions:{displayCount:1E4},infoTemplate:new K}),this._waitThenAdd(d,I,l,m,J)):d.reject("Unsupported"):"WMS"===l?(J=new k(g,{id:p}),this._waitThenAdd(d,I,l,m,
J)):"WMTS"===l?J=new q(g,{id:p}):"WFS"===l?(J=new n({id:p,url:g,infoTemplate:new K}),this._waitThenAdd(d,I,l,m,J),console.warn("WFSLayer",J)):"KML"===l?(J=new z(g,{id:p}),this._waitThenAdd(d,I,l,m,J)):"GeoRSS"===l?(J=new x(g,{id:p}),this._waitThenAdd(d,I,l,m,J)):"CSV"===l&&(J=new t(g,{id:p}),J.setInfoTemplate(m._newInfoTemplate()),this._waitThenAdd(d,I,l,m,J))},_persist:function(){try{var b=this.typeSelect.get("value"),c=g.trim(this.urlTextBox.value);this.wabWidget.xtnAddFromUrlPane={type:b,url:c}}catch(N){}},
_restore:function(){try{var b=this.wabWidget.xtnAddFromUrlPane;b&&"string"===typeof b.type&&0<b.type.length&&this.typeSelect.set("value",b.type);b&&"string"===typeof b.url&&0<b.url.length&&(this.urlTextBox.value=b.url)}catch(L){}},_setStatus:function(b){this.wabWidget&&this.wabWidget._setStatus(b)},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()},_updateExamples:function(b){h.forEach(this.examplesNode.children,function(c){var k=c.getAttribute("data-examples-type");"string"===typeof k&&
0<k.length&&(c.style.display=k===b?"":"none")})},_waitThenAdd:function(b,c,k,a,e){a._waitForLayer(e).then(function(e){"WMS"===k?a._setWMSVisibleLayers(e):e&&"esri.layers.ArcGISDynamicMapServiceLayer"===e.declaredClass?a._setDynamicLayerInfoTemplates(e):e&&"esri.layers.FeatureLayer"===e.declaredClass?a._setFeatureLayerInfoTemplate(e):e&&"esri.layers.CSVLayer"===e.declaredClass&&a._setFeatureLayerInfoTemplate(e);e.xtnAddData=!0;if("KML"===k){var q=c.spatialReference,n=e._outSR;q&&n&&(q.equals(n)||q.isWebMercator()&&
4326===n.wkid||n.isWebMercator()&&4326===q.wkid)?c.addLayer(e):new I({titleLabel:C._widgetLabel,message:C.addFromFile.kmlProjectionMismatch})}else c.addLayer(e);b.resolve(e)}).otherwise(function(c){b.reject(c)})}})})},"esri/layers/CSVLayer":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../arcgis/csv ./FeatureLayer ../geometry/Extent ../tasks/FeatureSet".split(" "),function(p,g,h,m,d,u,a,l,r){g=g(a,{declaredClass:"esri.layers.CSVLayer",_preventInit:!0,_fieldTypeMap:{Date:"esriFieldTypeDate",
Number:"esriFieldTypeDouble",String:"esriFieldTypeString"},constructor:function(a,d){this.url=a;d=h.mixin({},d);this.columnDelimiter=d.columnDelimiter;this.latitudeFieldName=d.latitudeFieldName;this.longitudeFieldName=d.longitudeFieldName;(a=d.layerDefinition)||(a={fields:d.fields||[],geometryType:"esriGeometryPoint",copyrightText:d.copyright},d.fields&&p.forEach(d.fields,function(a){a.type=this._fieldTypeMap[a.type||"String"];a.alias||(a.alias=a.name)},this));this._buildCsvFcParam={url:this.url,
columnDelimiter:this.columnDelimiter,layerDefinition:a,outFields:d.outFields};this.latitudeFieldName&&this.longitudeFieldName&&(this._buildCsvFcParam.locationInfo={locationType:"coordinates",latitudeFieldName:this.latitudeFieldName,longitudeFieldName:this.longitudeFieldName});this._projectFeatures=h.hitch(this,this._projectFeatures);this._addFeatures=h.hitch(this,this._addFeatures);this._initCSVLayer(d)},refresh:function(){this._fireUpdateStart();this.applyEdits(null,null,this.graphics);this._loadFeatures()},
_isWebGLCompatible:function(){return!1},_setMap:function(a){var d=this.inherited(arguments);return this._fireUpdateStart(),this._projectFeatures(this._csvFC).then(this._addFeatures).otherwise(this._errorHandler),this._csvFC=null,d},_initCSVLayer:function(a){var d=this;u.buildCSVFeatureCollection(this._buildCsvFcParam).then(function(l){!d._buildCsvFcParam.locationInfo||d.latitudeFieldName&&d.longitudeFieldName||(d.latitudeFieldName=d._buildCsvFcParam.locationInfo.latitudeFieldName,d.longitudeFieldName=
d._buildCsvFcParam.locationInfo.longitudeFieldName);d._csvFC=l;var g=l.layerDefinition;g.extent=d._getFCExtent(l);a.outFields||(a.outFields=["*"]);a.timeInfo&&(g.timeInfo=a.timeInfo);d._initFeatureLayer({layerDefinition:g},a)}).otherwise(this._errorHandler)},_loadFeatures:function(){u.buildCSVFeatureCollection(this._buildCsvFcParam).then(this._projectFeatures).then(this._addFeatures).otherwise(this._errorHandler)},_projectFeatures:function(a){return u.projectFeatureCollection(a,this._map.spatialReference)},
_addFeatures:function(a){a=new r(a.featureSet);this.applyEdits(a.features,null,null);this._fireUpdateEnd()},_getFCExtent:function(a){var d;if(a&&a.featureSet&&a.featureSet.features){a=a.featureSet.features;var g=a.length;if(1<g){var h=a[0].geometry;d=new l(h.x,h.y,h.x,h.y);for(--g;0<g;g--)h=a[g].geometry,d.xmin=Math.min(d.xmin,h.x),d.ymin=Math.min(d.ymin,h.y),d.xmax=Math.max(d.xmax,h.x),d.ymax=Math.max(d.ymax,h.y);0>=d.getWidth()&&0>=d.getHeight()&&(d=null)}}return d}});return m("extend-esri")&&h.setObject("layers.CSVLayer",
g,d),g})},"esri/arcgis/csv":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/sniff dojo/number dojox/data/CsvStore ../kernel ../config ../request ../SpatialReference ../geometry/jsonUtils ../geometry/webMercatorUtils".split(" "),function(p,g,h,m,d,u,a,l,r,w,D,B){function G(a){var e=0,f="";return g.forEach([","," ",";","|","\t"],function(d){var b=a.split(d).length;b>e&&(e=b,f=d)}),f}function y(a,e){if(!a||"[object Date]"!==Object.prototype.toString.call(a)||isNaN(a.getTime()))return!1;
a=!0;if(m("chrome")&&/\d+\W*$/.test(e)){if(e.match(/[^0-9a-zA-Z\s]/))return!1;if(e=e.match(/[a-zA-Z]{2,}/)){a=!1;for(var f=0,d=e.length,b=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i;!a&&f<=d&&!(a=!b.test(e[f]));)f++;a=!a}}return a}function C(a,x,t){var v=a.indexOf("\n"),v=p.trim(a.substr(0,v)),b=x.columnDelimiter;b||(b=G(v));var c=new u({data:a,separator:b});return c.fetch({onComplete:function(b,
k){k=0;var a={layerDefinition:x.layerDefinition,featureSet:{features:[],geometryType:"esriGeometryPoint"}},n=a.layerDefinition.objectIdField,v=a.layerDefinition.fields;n||g.some(v,function(b){return"esriFieldTypeOID"===b.type&&(n=b.name,!0)})||(v.push({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1}),n="__OBJECTID");var l,z,h=c._attributes,F=[],m=[];if(g.forEach(v,function(b){"esriFieldTypeDate"===b.type?F.push(b.name):"esriFieldTypeDouble"!==b.type&&"esriFieldTypeInteger"!==
b.type||m.push(b.name)}),x.locationInfo&&"coordinates"===x.locationInfo.locationType?(l=x.locationInfo.latitudeFieldName,z=x.locationInfo.longitudeFieldName):(g.forEach(h,function(b){var c;c=g.indexOf(f,b.toLowerCase());-1!==c&&(l=b);-1!==(c=g.indexOf(e,b.toLowerCase()))&&(z=b)}),l&&z&&(x.locationInfo={locationType:"coordinates",latitudeFieldName:l,longitudeFieldName:z})),!l||!z)return setTimeout(function(){console.error("File does not seem to contain fields with point coordinates.")},1),void(t&&
t(null,Error("File does not seem to contain fields with point coordinates.")));-1===g.indexOf(m,l)&&m.push(l);-1===g.indexOf(m,z)&&m.push(z);var r;p.isArray(x.outFields)&&-1===g.indexOf(x.outFields,"*")&&(r=x.outFields);g.forEach(h,function(b){g.some(v,function(c){return b===c.name})||v.push({name:b,alias:b,type:b===l||b===z?"esriFieldTypeDouble":"esriFieldTypeString"})});var h=0,w=b.length;for(h;h<w;h++){var A=b[h],E=c.getAttributes(A),B={};g.forEach(E,function(b){if(b&&(b===l||b===z||!r||-1<g.indexOf(r,
b))){var k=b;if(0===b.length&&g.forEach(v,function(c,k){c.name==="attribute_"+(k-1)&&(b="attribute_"+(k-1))}),-1<g.indexOf(F,b)){var k=c.getValue(A,k),a=new Date(k);B[b]=y(a,k)?a.getTime():null}else-1<g.indexOf(m,b)?(a=d.parse(c.getValue(A,k)),b!==l&&b!==z||!(isNaN(a)||181<Math.abs(a))?isNaN(a)?B[b]=null:B[b]=a:(a=parseFloat(c.getValue(A,k)),isNaN(a)?B[b]=null:B[b]=a)):B[b]=c.getValue(A,k)}});B[n]=k;k++;var E=B[l],u=B[z];null==u||null==E||isNaN(E)||isNaN(u)||(r&&-1===g.indexOf(r,l)&&delete B[l],r&&
-1===g.indexOf(r,z)&&delete B[z],a.featureSet.features.push({geometry:{x:u,y:E,spatialReference:{wkid:4326}},attributes:B}))}a.layerDefinition.name="csv";t&&t(a)},onError:function(b){console.error("Error fetching items from CSV store: ",b);t&&t(null,b)}}),!0}function A(a,e,f,d,b,c){0===a.length&&b(null);var n=D.getGeometryType(e),k=[];g.forEach(a,function(b){b=new n(b);b.spatialReference=f;k.push(b)},this);e=[102113,102100,3857];f.wkid&&4326===f.wkid&&d.wkid&&-1<g.indexOf(e,d.wkid)?(g.forEach(k,function(b){b.xmin?
(b.xmin=Math.max(b.xmin,-180),b.xmax=Math.min(b.xmax,180),b.ymin=Math.max(b.ymin,-89.99),b.ymax=Math.min(b.ymax,89.99)):b.rings?g.forEach(b.rings,function(b){g.forEach(b,function(b){b[0]=Math.min(Math.max(b[0],-180),180);b[1]=Math.min(Math.max(b[1],-89.99),89.99)},this)},this):b.paths?g.forEach(b.paths,function(b){g.forEach(b,function(b){b[0]=Math.min(Math.max(b[0],-180),180);b[1]=Math.min(Math.max(b[1],-89.99),89.99)},this)},this):b.x&&(b.x=Math.min(Math.max(b.x,-180),180),b.y=Math.min(Math.max(b.y,
-89.99),89.99))},this),a=[],g.forEach(k,function(b){b=B.geographicToWebMercator(b);102100!==d.wkid&&(b.spatialReference=d);a.push(b.toJson())},this),b(a)):null!==f.wkid&&-1<g.indexOf(e,f.wkid)&&null!==d.wkid&&4326===d.wkid?(a=[],g.forEach(k,function(b){a.push(B.webMercatorToGeographic(b).toJson())},this),b(a)):(e=function(k,e){k&&k.length===a.length?(a=[],g.forEach(k,function(b){b&&(b.rings&&0<b.rings.length&&0<b.rings[0].length&&0<b.rings[0][0].length&&!isNaN(b.rings[0][0][0])&&!isNaN(b.rings[0][0][1])||
b.paths&&0<b.paths.length&&0<b.paths[0].length&&0<b.paths[0][0].length&&!isNaN(b.paths[0][0][0])&&!isNaN(b.paths[0][0][1])||b.xmin&&!isNaN(b.xmin)&&b.ymin&&!isNaN(b.ymin)||b.x&&!isNaN(b.x)&&b.y&&!isNaN(b.y))?a.push(b.toJson()):a.push(null)},this),b(a)):c(k,e)},l.defaults.geometryService?l.defaults.geometryService.project(k,d,p.hitch(this,e),c):b(null))}function E(a,e){var f=[102113,102100,3857];return!(!a||!e||a.wkid!==e.wkid||a.wkt!==e.wkt)||!!(a&&e&&a.wkid&&e.wkid&&-1<g.indexOf(f,a.wkid)&&-1<g.indexOf(f,
e.wkid))}function H(a,e,f,d){if(a.featureSet&&0!==a.featureSet.features.length){if(E(f,e))return void d(a);var b,c=function(b){var c=[];g.forEach(a.featureSet.features,function(a,k){b[k]&&(a.geometry=b[k],c.push(a))},this);d(a)},n=function(b,c){console.error("error projecting featureSet ("+a.layerDefinition.name+"). Final try.");d(a)},k=function(k,d){console.error("error projecting featureSet ("+a.layerDefinition.name+"). Try one more time.");A(b,a.featureSet.geometryType,e,f,p.hitch(this,c),p.hitch(this,
n))};a.featureSet.features&&0<a.featureSet.features.length?(b=[],g.forEach(a.featureSet.features,function(c){if(c.geometry.toJson)b.push(c.geometry);else{var k=D.getGeometryType(a.featureSet.geometryType);b.push(new k(c.geometry))}}),e.toJson||(e=new w(e)),f.toJson||(f=new w(f)),A(b,a.featureSet.geometryType,e,f,p.hitch(this,c),p.hitch(this,k))):d(a)}}var f="lat latitude y ycenter latitude83 latdecdeg point-y lat_dd".split(" "),e="lon lng long longitude x xcenter longitude83 longdecdeg point-x long_dd".split(" "),
t={latFieldStrings:f,longFieldStrings:e,buildCSVFeatureCollection:function(a){var e=new h,f=function(b,c){c?e.errback(c):e.callback(b)},d={url:a.url,handleAs:"text",load:function(b){C(b,a,p.hitch(this,f))},error:function(b){e.errback(b);console.error("error: "+b)}};return-1<a.url.indexOf("arcgis.com")&&-1<a.url.indexOf("/content/items")&&-1<a.url.indexOf("/data")&&(d.headers={"Content-Type":""}),r(d,{usePost:!1}),e},projectFeatureCollection:function(a,e,f){var d=new h;return f||(f=new w({wkid:4326})),
H(a,f,e,p.hitch(this,function(b){d.callback(b)})),d},generateDefaultPopupInfo:function(a){var e={esriFieldTypeDouble:1,esriFieldTypeSingle:1},f={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},d={esriFieldTypeDate:1},b=null;a=g.map(a.layerDefinition.fields,p.hitch(this,function(c){"NAME"===c.name.toUpperCase()&&(b=c.name);var a="esriFieldTypeOID"!==c.type&&"esriFieldTypeGlobalID"!==c.type&&"esriFieldTypeGeometry"!==c.type,k=null;if(a){var q=c.name.toLowerCase();(-1<",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,".indexOf(","+
q+",")||-1<q.indexOf("area")||-1<q.indexOf("length")||-1<q.indexOf("shape")||-1<q.indexOf("perimeter")||-1<q.indexOf("objectid")||q.indexOf("_")===q.length-1||q.indexOf("_i")===q.length-2&&1<q.length)&&(a=!1);c.type in f?k={places:0,digitSeparator:!0}:c.type in e?k={places:2,digitSeparator:!0}:c.type in d&&(k={dateFormat:"shortDateShortTime"})}return p.mixin({},{fieldName:c.name,label:c.alias,isEditable:!0,tooltip:"",visible:a,format:k,stringFieldOption:"textbox"})}));return{title:b?"{"+b+"}":"",
fieldInfos:a,description:null,showAttachments:!1,mediaInfos:[]}},_getSeparator:G,_isValidDate:y,_processCsvData:C,_projectGeometries:A,_sameSpatialReference:E,_projectFeatureSet:H};return m("extend-esri")&&p.setObject("arcgis.csv",t,a),t})},"dojox/data/CsvStore":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/xhr dojo/_base/kernel dojo/data/util/filter dojo/data/util/simpleFetch".split(" "),function(p,g,h,m,d,u){g=g("dojox.data.CsvStore",null,{constructor:function(a){this._attributes=
[];this._attributeIndexes={};this._dataArray=[];this._arrayOfAllItems=[];this._loadFinished=!1;a.url&&(this.url=a.url);this._csvData=a.data;a.label?this.label=a.label:""===this.label&&(this.label=void 0);this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._loadInProgress=!1;this._queuedFetches=[];this.identifier=a.identifier;""===this.identifier?delete this.identifier:this._idMap={};"separator"in a&&(this.separator=a.separator);
"urlPreventCache"in a&&(this.urlPreventCache=a.urlPreventCache?!0:!1)},url:"",label:"",identifier:"",separator:",",urlPreventCache:!1,_assertIsItem:function(a){if(!this.isItem(a))throw Error(this.declaredClass+": a function was passed an item argument that was not an item");},_getIndex:function(a){a=this.getIdentity(a);this.identifier&&(a=this._idMap[a]);return a},getValue:function(a,d,g){this._assertIsItem(a);var l=g;if("string"===typeof d)d=this._attributeIndexes[d],null!=d&&(l=this._dataArray[this._getIndex(a)][d]||
g);else throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");return l},getValues:function(a,d){return(a=this.getValue(a,d))?[a]:[]},getAttributes:function(a){this._assertIsItem(a);var d=[];a=this._dataArray[this._getIndex(a)];for(var g=0;g<a.length;g++)""!==a[g]&&d.push(this._attributes[g]);return d},hasAttribute:function(a,d){this._assertIsItem(a);if("string"===typeof d)return d=this._attributeIndexes[d],a=this._dataArray[this._getIndex(a)],"undefined"!==
typeof d&&d<a.length&&""!==a[d];throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");},containsValue:function(a,l,g){var h=void 0;"string"===typeof g&&(h=d.patternToRegExp(g,!1));return this._containsValue(a,l,g,h)},_containsValue:function(a,d,g,h){a=this.getValues(a,d);for(d=0;d<a.length;++d){var l=a[d];if("string"===typeof l&&h)return null!==l.match(h);if(g===l)return!0}return!1},isItem:function(a){if(a&&a[this._storeProp]===this)if(a=a[this._idProp],
this.identifier){if(this._dataArray[this._idMap[a]])return!0}else if(0<=a&&a<this._dataArray.length)return!0;return!1},isItemLoaded:function(a){return this.isItem(a)},loadItem:function(a){},getFeatures:function(){return this._features},getLabel:function(a){if(this.label&&this.isItem(a))return this.getValue(a,this.label)},getLabelAttributes:function(a){return this.label?[this.label]:null},_fetchItems:function(a,g,m){var l=this,p=function(a,h){var m=null;if(a.query){var p,f,m=[],e=a.queryOptions?a.queryOptions.ignoreCase:
!1,t={};for(p in a.query)f=a.query[p],"string"===typeof f&&(t[p]=d.patternToRegExp(f,e));for(e=0;e<h.length;++e){var v=!0,x=h[e];for(p in a.query)f=a.query[p],l._containsValue(x,p,f,t[p])||(v=!1);v&&m.push(x)}}else m=h.slice(0,h.length);g(m,a)};if(this._loadFinished)p(a,this._arrayOfAllItems);else if(""!==this.url)if(this._loadInProgress)this._queuedFetches.push({args:a,filter:p});else{this._loadInProgress=!0;var r=h.get({url:l.url,handleAs:"text",preventCache:l.urlPreventCache});r.addCallback(function(d){try{l._processData(d),
p(a,l._arrayOfAllItems),l._handleQueuedFetches()}catch(A){m(A,a)}});r.addErrback(function(d){l._loadInProgress=!1;if(m)m(d,a);else throw d;});var u=null;a.abort&&(u=a.abort);a.abort=function(){var d=r;d&&-1===d.fired&&(d.cancel(),d=null);u&&u.call(a)}}else if(this._csvData)try{this._processData(this._csvData),this._csvData=null,p(a,this._arrayOfAllItems)}catch(C){m(C,a)}else{var y=Error(this.declaredClass+": No CSV source data was provided as either URL or String data input.");if(m)m(y,a);else throw y;
}},close:function(a){},_getArrayOfArraysFromCsvFileContents:function(a){if(p.isString(a)){var d=/^\s+/g,g=/\s+$/g,h=/""/g,m=[],B=this._splitLines(a);for(a=0;a<B.length;++a){var u=B[a];if(0<u.length){for(var u=u.split(this.separator),y=0;y<u.length;){var C=u[y].replace(d,""),A=C.replace(g,""),E=A.charAt(0),H=A.charAt(A.length-1),f=A.charAt(A.length-2),e=A.charAt(A.length-3);if(2===A.length&&'""'==A)u[y]="";else if('"'==E&&('"'!=H||'"'==H&&'"'==f&&'"'!=e)){if(y+1===u.length)return;u[y]=C+this.separator+
u[y+1];u.splice(y+1,1)}else'"'==E&&'"'==H&&(A=A.slice(1,A.length-1),A=A.replace(h,'"')),u[y]=A,y+=1}m.push(u)}}this._attributes=m.shift();for(a=0;a<this._attributes.length;a++)this._attributeIndexes[this._attributes[a]]=a;this._dataArray=m}},_splitLines:function(a){var d=[],g,h="",m=!1;for(g=0;g<a.length;g++){var p=a.charAt(g);switch(p){case '"':m=!m;h+=p;break;case "\r":m?h+=p:(d.push(h),h="",g<a.length-1&&"\n"==a.charAt(g+1)&&g++);break;case "\n":m?h+=p:(d.push(h),h="");break;default:h+=p}}""!==
h&&d.push(h);return d},_processData:function(a){this._getArrayOfArraysFromCsvFileContents(a);this._arrayOfAllItems=[];if(this.identifier&&void 0===this._attributeIndexes[this.identifier])throw Error(this.declaredClass+": Identity specified is not a column header in the data set.");for(a=0;a<this._dataArray.length;a++){var d=a;this.identifier&&(d=this._dataArray[a][this._attributeIndexes[this.identifier]],this._idMap[d]=a);this._arrayOfAllItems.push(this._createItemFromIdentity(d))}this._loadFinished=
!0;this._loadInProgress=!1},_createItemFromIdentity:function(a){var d={};d[this._storeProp]=this;d[this._idProp]=a;return d},getIdentity:function(a){return this.isItem(a)?a[this._idProp]:null},fetchItemByIdentity:function(a){var d,g=a.scope?a.scope:m.global;if(this._loadFinished)d=this._createItemFromIdentity(a.identity),this.isItem(d)||(d=null),a.onItem&&a.onItem.call(g,d);else{var p=this;if(""!==this.url)this._loadInProgress?this._queuedFetches.push({args:a}):(this._loadInProgress=!0,d=h.get({url:p.url,
handleAs:"text"}),d.addCallback(function(d){try{p._processData(d);var h=p._createItemFromIdentity(a.identity);p.isItem(h)||(h=null);a.onItem&&a.onItem.call(g,h);p._handleQueuedFetches()}catch(G){a.onError&&a.onError.call(g,G)}}),d.addErrback(function(d){this._loadInProgress=!1;a.onError&&a.onError.call(g,d)}));else if(this._csvData)try{p._processData(p._csvData),p._csvData=null,d=p._createItemFromIdentity(a.identity),p.isItem(d)||(d=null),a.onItem&&a.onItem.call(g,d)}catch(D){a.onError&&a.onError.call(g,
D)}}},getIdentityAttributes:function(a){return this.identifier?[this.identifier]:null},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var a=0;a<this._queuedFetches.length;a++){var d=this._queuedFetches[a],g=d.filter,h=d.args;g?g(h,this._arrayOfAllItems):this.fetchItemByIdentity(d.args)}this._queuedFetches=[]}}});p.extend(g,u);return g})},"esri/layers/GeoRSSLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../config ../request ../urlUtils ./ServiceGeneratedFeatureCollection".split(" "),
function(p,g,h,m,d,u,a,l,r){p=p([r],{declaredClass:"esri.layers.GeoRSSLayer",serviceUrl:l.getProtocolForWebResource()+"//utility.arcgis.com/sharing/rss",constructor:function(a,d){u.defaults.geoRSSService&&(this.serviceUrl=u.defaults.geoRSSService);this._createLayer()},parse:function(){return this._io=a({url:this.serviceUrl,content:{url:this.url,refresh:!!this.loaded||void 0,outSR:this._outSR?h.toJson(this._outSR.toJson()):void 0},callbackParamName:"callback"}),this._io},_initLayer:function(a){this.inherited(arguments);
this.loaded||(this.loaded=!0,this.onLoad(this))}});return m("extend-esri")&&g.setObject("layers.GeoRSSLayer",p,d),p})},"esri/layers/ServiceGeneratedFeatureCollection":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/webMercatorUtils ../renderers/SimpleRenderer ./layer ./FeatureLayer ../dijit/PopupTemplate".split(" "),function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,
C){p=p([G],{declaredClass:"esri.layers._ServiceGeneratedFeatureCollection",constructor:function(a,d){this.pointSymbol=d&&d.pointSymbol;this.polylineSymbol=d&&d.polylineSymbol;this.polygonSymbol=d&&d.polygonSymbol;this._outSR=d&&(d.outSpatialReference||d.outSR)||new r({wkid:4326});this._options=h.mixin({},d)},parse:function(){console.error("parse function has not been implemented")},getFeatureLayers:function(){var a=[];return this._fLayers&&(a=a.concat(this._fLayers)),a},onRefresh:function(){},onOpacityChange:function(){},
refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._createLayer()},_createLayer:function(a){var d=this;this._fireUpdateStart();a=this.parse(a);a.addCallback(function(a){d._io=null;d._initLayer(a)});a.addErrback(function(a){d._io=null;a=h.mixin(Error(),a);a.message="Unable to load resource: "+d.url+" "+(a.message||"");d._fireUpdateEnd(a);d.onError(a)})},_initLayer:function(a){this.loaded&&this._removeInternalLayers();this.name=a.name;this.description=a.description;this.snippet=
a.snippet;this.featureInfos=a.featureInfos;this.fullExtent=this.initialExtent=new w(a.lookAtExtent);this.copyright=a.author||a.copyright;var d;a=h.getObject("featureCollection.layers",!1,a);if(a&&0<a.length&&(this._fLayers=[],m.forEach(a,function(a,f){var e,g=h.getObject("featureSet.features",!1,a);g&&0<g.length&&(d=h.mixin({outFields:["*"],infoTemplate:a.popupInfo?new C(a.popupInfo):null,editable:!1},this._options),d.id&&(d.id=d.id+"_"+f),d.webgl=!1,a.layerDefinition.capabilities="Query,Data",e=
new y(a,d),e.geometryType&&(this["_"+e.geometryType]=e),this._fLayers.push(e))},this),0===this._fLayers.length&&delete this._fLayers),this.items=[],this._esriGeometryPoint&&(this.items=this.items.concat(this._esriGeometryPoint.graphics),this.pointSymbol))a=new B(this.pointSymbol),this._esriGeometryPoint.setRenderer(a);this._esriGeometryPolyline&&(this.items=this.items.concat(this._esriGeometryPolyline.graphics),this.polylineSymbol)&&(a=new B(this.polylineSymbol),this._esriGeometryPolyline.setRenderer(a));
this._esriGeometryPolygon&&(this.items=this.items.concat(this._esriGeometryPolygon.graphics),this.polygonSymbol)&&(a=new B(this.polygonSymbol),this._esriGeometryPolygon.setRenderer(a));this._fireUpdateEnd();this.loaded&&(this._addInternalLayers(),this.onRefresh())},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();var d,g=a.spatialReference,f=this._outSR;if(g.wkid)d=g._isWebMercator()&&f._isWebMercator()||g.wkid===f.wkid;else{if(!g.wkt)return void console.log("_setMap - map has invalid spatial reference");
d=g.wkt===f.wkt}if(!d)if(g._isWebMercator()&&4326===f.wkid)this._converter=D.geographicToWebMercator;else{if(!f._isWebMercator()||4326!==g.wkid)return void console.log("_setMap - unsupported workflow. Spatial reference of the map and layer do not match, and the conversion cannot be done on the client.");this._converter=D.webMercatorToGeographic}(d=this._fLayers)&&0<d.length&&m.forEach(d,function(e){if(this._converter){var d,f,g=e.graphics,h=g?g.length:0;for(d=0;d<h;d++)(f=g[d].geometry)&&g[d].setGeometry(this._converter(f))}a.addLayer(e)},
this);this.setVisibility(this.visible);this._fireUpdateEnd()},_removeInternalLayers:function(){var a=this._map;a&&m.forEach(this.getFeatureLayers(),a.removeLayer,a)},setScaleRange:function(a,d){this.inherited(arguments);m.forEach(this.getFeatureLayers(),function(g){g.setScaleRange(a,d)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(a){this.opacity!=a&&(m.forEach(this.getFeatureLayers(),function(d){d.setOpacity(a)}),this._options.opacity=a,this.opacity=
a,this.onOpacityChange(a))},onVisibilityChange:function(a){this._fireUpdateStart();m.forEach(this.getFeatureLayers(),function(d){d.setVisibility(a)});this._fireUpdateEnd()},_setMap:function(a,g){this.inherited(arguments);this._map=a;var h=this._div=d.create("div",null,g);return u.set(h,"position","absolute"),this._addInternalLayers(),this.evaluateSuspension(),h},_unsetMap:function(a,h){this._io&&this._io.cancel();g.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();
var l=this._div;l&&(h.removeChild(l),d.destroy(l));this._div=null;this.inherited(arguments)}});return a("extend-esri")&&h.setObject("layers._ServiceGeneratedFeatureCollection",p,l),p})},"esri/layers/WFSLayer":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/on ../request ../kernel ../graphic ../renderers/jsonUtils ../symbols/jsonUtils ../Color ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent ../geometry/Point ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ./LabelClass ./GraphicsLayer".split(" "),
function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,C,A,E,H,f,e,t,v,x,F,z){p=p([z],{declaredClass:"esri.layers.WFSLayer",constructor:function(b){this.geometryType=this.describeFeatureTypeUrl=this.getFeatureUrl=this.layerNamespace="";this.fields=[];this.spatialReferences=[];this.fullExtent=null;this.visible=!0;this.renderer=null;this.id="WFSLayer";this._url="";this._version="1.1.0";this._layerName="";this._nsLayerNames={};this._layerDefinedGeometryType="esriGeometryComplex";this._wkid=3857;this._mode="snapshot";
this._maxFeatures=100;this._inverseResponse=this._inverseFilter=!1;this._nsGeometryFieldName=this._getFeatureRequest=this._nsFields="";this._graphicArray=[];this._gmlNS="http://www.opengis.net/gml";this._layerEventHandlers=[];this.customParameters=this._describeFeatureTypeCallback=this._getCapabilitiesCallback=null;this.showLabels=!0;this.labelingInfo=null;b&&(b.id&&(this.id=b.id),this.showLabels=null===b.showLabels||b.showLabels);this.onError=h.hitch(this,this.onError);this._errorSupport=h.hitch(this,
this._errorSupport);this._parseGml=h.hitch(this,this._parseGml);this._getCapabilities=h.hitch(this,this._getCapabilities);this._getCapabilitiesResponse=h.hitch(this,this._getCapabilitiesResponse);this._describeFeatureTypeResponse=h.hitch(this,this._describeFeatureTypeResponse);this._pointSymbol=new y(y.STYLE_CIRCLE,6,new C(C.STYLE_SOLID,new G([0,255,0]),1),new G([255,0,0]));this._lineSymbol=new C(C.STYLE_SOLID,new G([0,255,0]),3);this._polygonSymbol=new A(A.STYLE_SOLID,new C(C.STYLE_SOLID,new G([255,
0,0]),2),new G([255,255,0,.25]));this.loaded=!1;this._isProjectedOk=!0},initialize:function(b,c){b.id&&(this.id=b.id);b.url&&(this._url=b.url);b.version&&(this._version=b.version);this.customParameters=b.customParameters;this._getCapabilities(c)},selectLayer:function(b,c){this._layerName=b.layerName;this._wkid=b.wkid;this._mode=b.mode;this._maxFeatures=b.maxFeatures;this._inverseResponse=b.swapXY;this._inverseFilter=b.swapXYFilter;this.geometryType=b.geometryType;this._describeFeatureType(c);this.loaded=
!0},toJson:function(){var b={};return b.id=this.id,b.url=this._url,b.version=this._version,b.mode="snapshot"===this._mode?0:1,b.name=this._layerName,b.geometryType=this.geometryType,b.wkid=this._wkid,b.maxFeatures=this._maxFeatures,b.swapXY=this._inverseResponse,b.swapXYFilter=this._inverseFilter,b.pointSymbol=this._pointSymbol.toJson(),b.lineSymbol=this._lineSymbol.toJson(),b.polygonSymbol=this._polygonSymbol.toJson(),b.showLabels=this.showLabels,this.labelingInfo&&(b.labelingInfo=m.map(this.labelingInfo,
function(b){return b.toJson()})),this.customParameters&&(b.customParameters=this.customParameters),b},fromJson:function(b,c){b.id&&(this.id=b.id);b.url&&(this._url=b.url);b.version&&(this._version=b.version);b.mode&&(this._mode=0===b.mode?"snapshot":"onDemand");b.name&&(this._layerName=b.name);b.geometryType&&(this.geometryType=b.geometryType);b.wkid&&(this._wkid=b.wkid);b.maxFeatures&&(this._maxFeatures=b.maxFeatures);b.swapXY&&(this._inverseResponse=b.swapXY);b.swapXYFilter&&(this._inverseFilter=
b.swapXYFilter);b.pointSymbol&&(this._pointSymbol=B.fromJson(b.pointSymbol));b.lineSymbol&&(this._lineSymbol=B.fromJson(b.lineSymbol));b.polygonSymbol&&(this._polygonSymbol=B.fromJson(b.polygonSymbol));this.showLabels=null==b.showLabels||b.showLabels;b.labelingInfo&&(this.labelingInfo=m.map(b.labelingInfo,function(b){return new F(b)}));this.customParameters=b.customParameters;this._getCapabilities(c);this.loaded=!0},setPointSymbol:function(b){this._pointSymbol=b},setLineSymbol:function(b){this._lineSymbol=
b},setPolygonSymbol:function(b){this._polygonSymbol=b},_setMap:function(b){this._map=b;var c=this.inherited(arguments);return this._map&&(this._layerEventHandlers.push(this._map.on("extent-change",h.hitch(this,"refresh"))),this._layerEventHandlers.push(this.on("visibility-change",h.hitch(this,"_visibilityChange")))),this._getFeature(),this.refresh(),c},_unsetMap:function(){for(var b=0;b<this._layerEventHandlers.length;b++)d.disconnect(this._layerEventHandlers[b]);this.refresh();this.inherited(arguments)},
refresh:function(b){this.clear();this.redraw();"ondemand"===this._mode.toLowerCase()&&this._fireUpdateStart()},redraw:function(){if(this.visible)for(var b=0;b<this._graphicArray.length;b++){var c=this._graphicArray[b],a=c.geometry,k=null;"point"===a.type?k=this.renderer?this.renderer.getSymbol(c):this._pointSymbol:"multipoint"===a.type?k=this.renderer?this.renderer.getSymbol(c):this._pointSymbol:"polyline"===a.type?k=this.renderer?this.renderer.getSymbol(c):this._lineSymbol:"polygon"===a.type&&(k=
this.renderer?this.renderer.getSymbol(c):this._polygonSymbol);c.setSymbol(k);this.add(c)}},_visibilityChange:function(b){this.visible=b.visible;this.redraw()},onUpdateStart:function(){this._getFeature()},onUpdateEnd:function(){this.clear();this.redraw()},setLabelingInfo:function(b){b?(this.labelingInfo=b,this._fixLabelExpr()):delete this.labelingInfo;this.onLabelingInfoChange()},onLabelingInfoChange:function(){},_fixLabelExpr:function(){var b,c=/\[([^\[\]]+)\]/gi,a=this,k=function(b,c){b=a._getField(c,
!0);return"["+(b&&b.name||c)+"]"};m.forEach(this.labelingInfo,function(a){(b=a.labelExpression)&&(a.labelExpression=b.replace(c,k))})},_getField:function(b,c){var a=this.fields;if(!a||0===a.length)return null;var k;return c&&(b=b.toLowerCase()),m.some(a,function(a){var e=!1;return e=c?!(!a||a.name.toLowerCase()!==b):!(!a||a.name!==b),e&&(k=a),e}),k},setCustomParameters:function(b){this.customParameters=b;this._getFeature();this.refresh()},_getCapabilities:function(b){this._getCapabilitiesCallback=
b;b=h.trim(this._url);if(""===b)return void this.onError("WFSLayer: url is invalid");if("1.0.0"!==this._version&&"1.1.0"!==this._version&&"2.0.0"!==this._version)return void this.onError("WFSLayer: version is invalid");if(""!==b){var c=b.indexOf("?");b=b+(-1===c?"?":"\x26")+"service\x3dWFS\x26request\x3dGetCapabilities\x26version\x3d"+this._version;b=this._appendCustomParameters(b);l({url:b,handleAs:"text",headers:{"Content-Type":null}},{usePost:!1}).then(this._getCapabilitiesResponse,this._errorSupport)}},
_errorSupport:function(b){this.onError(b)},_getCapabilitiesResponse:function(b){var c,a,k,e,d,f=new DOMParser;try{var g=f.parseFromString(b,"text/xml"),h=this._readExceptionReport(g,b);if(h)return void this.onError("WFSLayer: getCapabilities - returns exception: "+h);var t=g.documentElement.attributes.getNamedItem("version");if(!t)return void this.onError("WFSLayer: getCapabilities - document not recognized.");this._version=t.value;var x,v="2.0.0"===this._version?"http://www.opengis.net/wfs/2.0":
"http://www.opengis.net/wfs";if("2.0.0"===this._version)for(c=g.getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Operation"),a=0;a<c.length;a++)(e=c[a].attributes.getNamedItem("name"))&&"DescribeFeatureType"===e.value&&(x=c[a].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Get"),this.describeFeatureTypeUrl=x[0].attributes.getNamedItem("xlink:href").value),e&&"GetFeature"===e.value&&(d=c[a].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Post"),this.getFeatureUrl=d[0].attributes.getNamedItem("xlink:href").value);
else if("1.1.0"===this._version)for(c=g.getElementsByTagNameNS("http://www.opengis.net/ows","Operation"),a=0;a<c.length;a++)(e=c[a].attributes.getNamedItem("name"))&&"DescribeFeatureType"===e.value&&(x=c[a].getElementsByTagNameNS("http://www.opengis.net/ows","Get"),this.describeFeatureTypeUrl=x[0].attributes.getNamedItem("xlink:href").value),e&&"GetFeature"===e.value&&(d=c[a].getElementsByTagNameNS("http://www.opengis.net/ows","Post"))&&d.length&&(this.getFeatureUrl=d[0].attributes.getNamedItem("xlink:href").value);
else if("1.0.0"===this._version){var l=g.getElementsByTagNameNS(v,"DescribeFeatureType");if(!l||!l.length)return void this.onError("WFSLayer: getCapabilities - no describeFeatureType info");x=l[0].getElementsByTagNameNS(v,"Get");this.describeFeatureTypeUrl=x[0].attributes.getNamedItem("onlineResource").value;var z=g.getElementsByTagNameNS(v,"GetFeature");if(!z||!z.length)return void this.onError("WFSLayer: getCapabilities - no GetFeature info");(d=z[0].getElementsByTagNameNS(v,"Post"))&&d.length&&
(this.getFeatureUrl=d[0].attributes.getNamedItem("onlineResource").value)}this._nsLayerNames={};b=[];var m=g.getElementsByTagNameNS(v,"FeatureTypeList");for(a=0;a<m.length;a++){var p=m[a].getElementsByTagNameNS(v,"FeatureType");for(k=0;k<p.length;k++){var F=p[k],r=F.getElementsByTagNameNS(v,"Name")[0],u=r.textContent,y=u.indexOf(":"),B=u.substring(0,y),w=u.substring(y+1),A=r.lookupNamespaceURI(B);null===A&&(A=r.lookupNamespaceURI(null));this._nsLayerNames[w]={prefix:B,namespace:A};var E=F.getElementsByTagNameNS(v,
"Title"),G=0<E.length?E[0].textContent:"";""===G&&(G=w);this.spatialReferences=this._readFactoryCodes(this._version,F);var C=this._readDefaultBBOX(this._version,F);b.push({name:w,title:G,spatialReferences:this.spatialReferences,extent:C})}}this._describeFeatureType();var D=this._getCapabilitiesCallback;D&&D(b)}catch(Q){this.onError("WFSLayer: getCapabilities - parsing error")}},_readFactoryCodes:function(b,c){var a,k=[];if("2.0.0"===b||"1.1.0"===b){a=c.getElementsByTagNameNS("*","DefaultSRS");this._addCodeList(k,
a[0]);a=c.getElementsByTagNameNS("*","DefaultCRS");this._addCodeList(k,a[0]);a=c.getElementsByTagNameNS("*","OtherSRS");for(b=0;b<a.length;b++)this._addCodeList(k,a[b]);a=c.getElementsByTagNameNS("*","OtherCRS");for(b=0;b<a.length;b++)this._addCodeList(k,a[b])}else"1.0.0"===b&&(a=c.getElementsByTagNameNS("*","SRS"),this._addCodeList(k,a[0]));for(c=!1;0<k.length;){4326===k[0]&&(c=!0);break}return c||k.push(4326),k},_addCodeList:function(b,c){c&&(c=c.textContent.match(/\d+/g),0<c.length&&(c=parseInt(c[c.length-
1],10),84===c&&(c=4326),b.push(c)))},_readDefaultBBOX:function(b,c){var a,k,e,d,f;if("2.0.0"===b||"1.1.0"===b){if(a=c.getElementsByTagNameNS("*","WGS84BoundingBox"),!a[0]||!a[0].attributes)return[];k=a[0].getElementsByTagNameNS("*","LowerCorner");d=a[0].getElementsByTagNameNS("*","UpperCorner");if(0>=k.length||0>=d.length)return[];e=k[0].textContent;a=e.indexOf(" ");k=e.substring(0,a);e=e.substring(a+1);a=d[0].textContent;b=a.indexOf(" ");d=a.substring(0,b);f=a.substring(b+1)}else if("1.0.0"===b){if(a=
c.getElementsByTagNameNS("*","LatLongBoundingBox"),!a[0]||!a[0].attributes)return[];k=a[0].attributes.getNamedItem("minx").value;e=a[0].attributes.getNamedItem("miny").value;d=a[0].attributes.getNamedItem("maxx").value;f=a[0].attributes.getNamedItem("maxy").value}return[parseFloat(k,10),parseFloat(e,10),parseFloat(d,10),parseFloat(f,10)]},_describeFeatureType:function(b){if(""!==this._layerName){if(""===this.describeFeatureTypeUrl)return void this.onError("WFSLayer: invalid describeFeatureType url");
if(""===this._wkid)return void this.onError("WFSLayer: invalid wkid");if("snapshot"!==this._mode&&"onDemand"!==this._mode)return void this.onError("WFSLayer: invalid mode");if(""===this._maxFeatures||0>this._maxFeatures||1E6<this._maxFeatures)return void this.onError("WFSLayer: invalid maxFeatures");this._describeFeatureTypeCallback=b;var a=h.trim(this.describeFeatureTypeUrl);if(""!==a){var e=-1===a.indexOf("?")?"?":"\x26",k=this._nsLayerNames[this._layerName];if(void 0===k)return void this.onError("WFSLayer: invalid layerName");
b=k.prefix;k=k.namespace;a=a+e+"service\x3dWFS\x26request\x3dDescribeFeatureType\x26version\x3d"+this._version;a+="\x26typeName\x3d";""!==b&&(a+=b+":");a+=encodeURIComponent(this._layerName);""!==b&&(a+="\x26namespace\x3dxmlns("+b+"\x3d"+encodeURIComponent(k)+")");a=this._appendCustomParameters(a);l({url:a,handleAs:"text",headers:{"Content-Type":null}},{usePost:!1}).then(this._describeFeatureTypeResponse,this._errorSupport)}}},_describeFeatureTypeResponse:function(b){var a;a=(new DOMParser).parseFromString(b,
"text/xml");if(b=this._readExceptionReport(a,b))return void this.onError("WFSLayer: DescribeFeatureType - returns exception: "+b);this.fields=[];b=a.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","schema");for(a=0;a<b.length;a++){var e=this._readAllFields(b[a]);null!==e&&(this._layerDefinedGeometryType=e[0],this.fields=e[1])}this.geometryType&&""!==this.geometryType||(this.geometryType=this._layerDefinedGeometryType);for(a=0;a<this.fields.length;a++)b=this.fields[a],"esriFieldTypeGeometry"===
b.type&&(this._nsGeometryFieldName=b.name);if(this.layerNamespace=this._nsLayerNames[this._layerName].namespace,0===this.fields.length)return void this.onError("WFSLayer: DescribeFeatureType - can't get fields");this._getFeature();(a=this._describeFeatureTypeCallback)&&a(this.fields)},_readAllFields:function(b){for(var a=b.childNodes,e=0;e<a.length;e++){var k=a[e];if("element"===k.localName){var q=k.attributes;if(q.name.value===this._layerName)return(a=q.type)?(k=a.value,a=k.indexOf(":"),k=k.substring(a+
1),this._readFieldsFromGlobalComplextType(b,k)):this._readFieldsFromLocalComplextType(k)}}return null},_readFieldsFromGlobalComplextType:function(b,a){b=b.childNodes;for(var c=0;c<b.length;c++){var k=b[c];if("complexType"===k.localName&&k.attributes.name.value===a)return this._readFieldsFromLocalComplextType(k)}return null},_readFieldsFromLocalComplextType:function(b){for(var a=[],e="esriGeometryComplex",k=b.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","element"),q=0;q<k.length;q++){var d=
k[q],f="",g=d.attributes.getNamedItem("name");if(g&&(f=g.value),""!==f){var h=b="",t=d.attributes.getNamedItem("type"),g="unknown";if(null!==t){var h=t.value,x=h.indexOf(":");b=h.substring(0,x);h=h.substring(x+1);g=t.lookupNamespaceURI(b);null===g&&(g=t.lookupNamespaceURI(null))}if(""===h)for(var d=d.childNodes,v=0;v<d.length;v++)if(b=d[v],"simpleType"===b.localName){b=b.childNodes;for(v=0;v<b.length;v++)if(node2=b[v],"restriction"===node2.localName){t=node2.attributes.getNamedItem("base");h=t.value;
x=h.indexOf(":");b=h.substring(0,x);h=h.substring(x+1);break}if(""!==h)break}d="Unknown";switch(h){case "integer":case "nonPositiveInteger":case "negativeInteger":case "long":case "int":case "short":case "byte":case "nonNegativeInteger":case "unsignedLong":case "unsignedInt":case "unsignedShort":case "unsignedByte":case "positiveInteger":d="esriFieldTypeInteger";a.push({name:f,alias:f,type:d,wfsNamespace:g});break;case "float":case "double":case "decimal":d="esriFieldTypeDouble";a.push({name:f,alias:f,
type:d,wfsNamespace:g});break;case "boolean":case "string":case "gYearMonth":case "gYear":case "gMonthDay":case "gDay":case "gMonth":case "anyURI":case "QName":case "NOTATION":case "normalizedString":case "token":case "language":case "IDREFS":case "ENTITIES":case "NMTOKEN":case "NMTOKENS":case "Name":case "NCName":case "ID":case "IDREF":case "ENTITY":d="esriFieldTypeString";a.push({name:f,alias:f,type:d,wfsNamespace:g});break;case "duration":case "dateTime":case "time":case "date":d="esriFieldTypeDate";
a.push({name:f,alias:f,type:d,wfsNamespace:g});break;case "PointPropertyType":case "MultiPointPropertyType":d="esriFieldTypeGeometry";e="esriGeometryPoint";a.push({name:f,alias:f,type:d,wfsNamespace:g});break;case "MultiCurvePropertyType":case "MultiLineStringPropertyType":d="esriFieldTypeGeometry";e="esriGeometryPolyline";a.push({name:f,alias:f,type:d,wfsNamespace:g});break;case "MultiSurfacePropertyType":case "MultiPolygonPropertyType":d="esriFieldTypeGeometry";e="esriGeometryPolygon";a.push({name:f,
alias:f,type:d,wfsNamespace:g});break;case "GeometryPropertyType":case "MultiGeometryPropertyType":d="esriFieldTypeGeometry",e="esriGeometryComplex",a.push({name:f,alias:f,type:d,wfsNamespace:g})}}}return[e,a]},_getFeature:function(){var b;b="\x3c?xml version\x3d'1.0' encoding\x3d'utf-8'?\x3e\n\x3cGetFeature \n xmlns:xsi\x3d'http://www.w3.org/2001/XMLSchema-instance'\n xmlns:gml\x3d'http://www.opengis.net/gml'\n xmlns:ogc\x3d'http://www.opengis.net/ogc'\n xmlns:wfs\x3d'http://www.opengis.net/wfs'\n";
"2.0.0"===this._version?b+=" xmlns\x3d'http://www.opengis.net/wfs/2.0'\n":b+=" xmlns\x3d'http://www.opengis.net/wfs'\n";var a=this._nsLayerNames[this._layerName];if(void 0===a)return void this.onError("WFSLayer: invalid layerName");var e=a.prefix,a=a.namespace;if("ondemand"===this._mode.toLowerCase()&&""===this._nsGeometryFieldName)return void this.onError("WFSLayer: GetFeature - can't use 'onDemand' mode as geometryFieldName is unknown.");if(b+=" xmlns:"+e+"\x3d'"+a+"'\n","2.0.0"===this._version?
b+=" version\x3d'"+this._version+"' service\x3d'WFS' count\x3d'"+this._maxFeatures+"'\x3e\n":b+=" version\x3d'"+this._version+"' service\x3d'WFS' maxFeatures\x3d'"+this._maxFeatures+"'\x3e\n","2.0.0"===this._version?b+=" \x3cQuery typeNames\x3d'"+e+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n":b+=" \x3cwfs:Query typeName\x3d'"+e+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n","ondemand"===this._mode.toLowerCase()&&(b+="  \x3cogc:Filter xmlns:ogc\x3d'http://www.opengis.net/ogc'\x3e\n",
b+="   \x3cogc:BBOX\x3e\n",b+="    \x3cogc:PropertyName\x3e"+e+":"+this._nsGeometryFieldName+"\x3c/ogc:PropertyName\x3e\n",b+="    \x3cgml:Box srsName\x3d'EPSG:"+this._wkid+"'\x3e\n",this._inverseFilter?b+="      \x3cgml:coordinates\x3e{ymin},{xmin} {ymax},{xmax}\x3c/gml:coordinates\x3e\n":b+="      \x3cgml:coordinates\x3e{xmin},{ymin} {xmax},{ymax}\x3c/gml:coordinates\x3e\n",b+="    \x3c/gml:Box\x3e\n",b+="   \x3c/ogc:BBOX\x3e\n",b+="  \x3c/ogc:Filter\x3e\n"),"2.0.0"===this._version?b+=" \x3c/Query\x3e\n":
b+=" \x3c/wfs:Query\x3e\n",b+="\x3c/GetFeature\x3e\n",this._getFeatureRequest=b,""===this.getFeatureUrl)return void this.onError("WFSLayer: getFeature - server doesn't support POST method.");if(""!==this._getFeatureRequest&&this._map&&null!==this._map.spatialReference.wkid){b=this._getFeatureRequest;if("ondemand"===this._mode.toLowerCase()){b=this._map.extent.xmin;var e=this._map.extent.ymin,a=this._map.extent.xmax,k=this._map.extent.ymax,q={},d=this._map.spatialReference,f=new E(this._wkid);this._projectFromSRToSR(d,
f,b,e,q)&&(b=q.x,e=q.y);this._projectFromSRToSR(d,f,a,k,q)&&(a=q.x,k=q.y);b=this._getFeatureRequest.replace(/{xmin}/,b).replace(/{ymin}/,e).replace(/{xmax}/,a).replace(/{ymax}/,k)}e=this._appendCustomParameters(this.getFeatureUrl);l({url:e,handleAs:"text",headers:{"Content-Type":"text/xml"},postData:b},{usePost:!0}).then(this._parseGml,this._errorSupport)}},_parseGml:function(b){if(this._map&&this._map.spatialReference&&this._map.spatialReference.wkid){var a=(new DOMParser).parseFromString(b,"text/xml");
if(b=this._readExceptionReport(a,b))return void this.onError("WFSLayer: GetFeature - returns exception: "+b);this._gmlNS="2.0.0"===this._version?"http://www.opengis.net/gml/3.2":"http://www.opengis.net/gml";""===this._wkid&&(this._wkid=this._map.spatialReference.wkid);this._graphicArray=this._readFeatureMembers(a,this._wkid,2,this._nsLayerNames[this._layerName].namespace,this._layerName);this.fullExtent=this._createFullExtent(this._graphicArray);this.onLabelingInfoChange();"ondemand"===this._mode.toLowerCase()?
this._fireUpdateEnd():this.refresh()}},_limit4326:function(b){for(var a=0;a<b.length;a++){var e=b[a].geometry;4326===e.spatialReference.wkid&&(e.x=this._limit4326X(e.x),e.y=this._limit4326Y(e.y))}},_limit4326X:function(b){return 180<=b&&(b=179.99),-180>=b&&(b=-179.99),b},_limit4326Y:function(b){return 90<=b&&(b=89.99),-90>=b&&(b=-89.99),b},_createFullExtent:function(b){for(var a=null,e=0;e<b.length;e++){var k=b[e].geometry,q=null;(q="point"===k.geometryType?new f(k.x,k.y,k.x,k.y,k.spatialReference):
k.getExtent())&&(a=null===a?q:a.union(q))}return a},_readExceptionReport:function(b,a){return 0<b.getElementsByTagNameNS("*","ExceptionReport").length?a:0<b.getElementsByTagNameNS("*","ServiceExceptionReport").length?a:""},_readFeatureMembers:function(b,a,e,k,q){var c,d,f,n;d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);var g=[];f=b.getElementsByTagNameNS("*","featureMembers");for(d=0;d<f.length;d++)for(c=f[d],n=c.getElementsByTagNameNS(k,q),0===n.length&&(n=c.getElementsByTagNameNS(null,
q)),0===n.length&&(n=c.getElementsByTagNameNS("*",q)),c=0;c<n.length;c++)this._readLayer(g,n[c],a,e);f=b.getElementsByTagNameNS("*","featureMember");for(d=0;d<f.length;d++)for(c=f[d],n=c.getElementsByTagNameNS(k,q),0===n.length&&(n=c.getElementsByTagNameNS(null,q)),0===n.length&&(n=c.getElementsByTagNameNS("*",q)),c=0;c<n.length;c++)this._readLayer(g,n[c],a,e);f=b.getElementsByTagNameNS("*","member");for(d=0;d<f.length;d++)for(c=f[d],n=c.getElementsByTagNameNS(k,q),0===n.length&&(n=c.getElementsByTagNameNS(null,
q)),0===n.length&&(n=c.getElementsByTagNameNS("*",q)),c=0;c<n.length;c++)this._readLayer(g,n[c],a,e);return g},_readLayer:function(b,a,e,k){var c,d,f=this._readSrsDimension(a);0!==f&&(k=f);var f=a.childNodes,n="",g=null;for(a=0;a<f.length;a++)if(c=f[a],1==c.nodeType&&"boundedBy"!==(d=c.localName)){var h=this._readGeometry(c,e,k);if(!this._isProjectedOk){this._isProjectedOk=!0;console.error("WFSLayer: could not project geometry.");break}if(null!==h){g=h;n=d;break}}if(g){e={};for(a=0;a<f.length;a++)if(c=
f[a],d=c.localName,c=c.textContent,d!==n)for(k=0;k<this.fields.length;k++)h=this.fields[k],h.name==d&&("esriFieldTypeDouble"===h.type?e[d]=parseFloat(c,10):"esriFieldTypeInteger"===h.type?e[d]=parseInt(c,10):e[d]=c.trim());this._convertWFSGeometryToGraphicObjects(b,g,e)}},_convertWFSGeometryToGraphicObjects:function(b,a,d){var c;if("point"!==a.geometryType||"esriGeometryPoint"!==this.geometryType&&"esriGeometryComplex"!==this.geometryType)if("multipoint"!==a.geometryType||"esriGeometryPoint"!==this.geometryType&&
"esriGeometryComplex"!==this.geometryType)if("polyline"!==a.geometryType||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryComplex"!==this.geometryType)if("polygon"!==a.geometryType||"esriGeometryPolygon"!==this.geometryType&&"esriGeometryComplex"!==this.geometryType){if("multigeometry"===a.geometryType)for(c=0;c<a.length;c++)this._convertWFSGeometryToGraphicObjects(b,a[c],d)}else c=new w,a=new x(a),c.setGeometry(a),c.setAttributes(d),b.push(c);else c=new w,a=new v(a),c.setGeometry(a),c.setAttributes(d),
b.push(c);else c=new w,a=new t(a),c.setGeometry(a),c.setAttributes(d),b.push(c);else c=new w,a=new e(a),c.setGeometry(a),c.setAttributes(d),b.push(c)},_readGeometry:function(b,a,e){var c,d;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);if(0!==c&&(e=c),d=b.getElementsByTagNameNS(this._gmlNS,"MultiSurface"),1<=d.length)for(c=0;c<d.length;)return this._readMultiSurface(d[c],a,e);if(d=b.getElementsByTagNameNS(this._gmlNS,"MultiCurve"),1<=d.length){var f=[];for(c=0;c<d.length;c++){var n=
this._readMultiCurve(d[c],a,e);for(b=0;b<n.length;b++)f.push(n[b])}return{geometryType:"polyline",paths:f,spatialReference:{wkid:this._map.spatialReference.wkid}}}d=b.getElementsByTagNameNS(this._gmlNS,"MultiGeometry");for(c=0;c<d.length;)return this._readMultiGeometry(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"Geometry");for(c=0;c<d.length;)return this._readGeometry(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"GeometryCollection");for(c=0;c<d.length;)return this._readGeometryCollection(d[c],
a,e);d=b.getElementsByTagNameNS(this._gmlNS,"Surface");for(c=0;c<d.length;)return this._readSurface(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"Curve");for(c=0;c<d.length;)return this._readCurve(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"MultiPolygon");for(c=0;c<d.length;)return this._readMultiPolygon(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(c=0;c<d.length;)return this._readPolygon(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"MultiLineString");for(c=0;c<d.length;)return this._readMultiLineString(d[c],
a,e);d=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(c=0;c<d.length;){a=this._readLineString(d[c],a,e);e={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};d=[];for(b=0;b<a.length;b++)d.push(a[b]);return e.paths.push(d),e}d=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");for(c=0;c<d.length;)return this._readLinearRing(d[c],a,e);if(d=b.getElementsByTagNameNS(this._gmlNS,"Box"),1<=d.length)for(c=0;c<d.length;)return this._readBox(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,
"Envelope");for(c=0;c<d.length;)return this._readEnvelope(d[c],a,e);if(d=b.getElementsByTagNameNS(this._gmlNS,"MultiPoint"),1<=d.length)for(c=0;c<d.length;)return this._readMultiPoint(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"Point");for(c=0;c<d.length;)return this._readPoint(d[c],a,e);return null},_readGeometryCollection:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d=[];d.geometryType="multigeometry";d.spatialReference={wkid:this._map.spatialReference.wkid};
c=b.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(b=0;b<c.length;b++){var f=this._readGeometryMember(c[b],a,e);d.push(f)}return d},_readMultiGeometry:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d=[];d.geometryType="multigeometry";d.spatialReference={wkid:this._map.spatialReference.wkid};c=b.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(b=0;b<c.length;b++){var f=this._readGeometryMember(c[b],a,e);d.push(f)}return d},
_readSurface:function(b,a,e){var c,d;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);var f=[];f.geometryType="multigeometry";f.spatialReference={wkid:this._map.spatialReference.wkid};d=b.getElementsByTagNameNS(this._gmlNS,"Point");for(c=0;c<d.length;c++)f.push(this._readPoint(d[c],a,e));d=b.getElementsByTagNameNS(this._gmlNS,"patches");for(c=0;c<d.length;c++){b=this._readPatches(d[c],a,e);for(var n=0;n<b.length;n++)f.push(b[n])}return f},_readMultiSurface:function(b,
a,e){var c,d,f;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);var n=[];n.geometryType="multigeometry";n.spatialReference={wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,"surfaceMember");for(c=0;c<f.length;c++){var g=this._readSurfaceMember(f[c],a,e);for(d=0;d<g.length;d++)n.push(g[d])}f=b.getElementsByTagNameNS(this._gmlNS,"surfaceMembers");for(c=0;c<f.length;c++)for(b=this._readSurfaceMembers(f[c],a,e),d=0;d<b.length;d++)n.push(b[d]);
return n},_readCurve:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};c=b.getElementsByTagNameNS(this._gmlNS,"segments");for(b=0;b<c.length;b++)for(var f=this._readSegments(c[b],a,e),n=0;n<f.length;n++)d.paths.push(f[n]);return d},_readSegments:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d=[];
d.geometryType="multigeometry";d.spatialReference={wkid:this._map.spatialReference.wkid};c=b.getElementsByTagNameNS(this._gmlNS,"LineStringSegment");for(b=0;b<c.length;b++){var f=this._readLineStringSegment(c[b],a,e);d.push(f)}return d},_readLineStringSegment:function(b,a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);for(b=b.getElementsByTagNameNS(this._gmlNS,"posList");0<b.length;)return this._readPosList(b[0],a,e)},_readMultiCurve:function(b,a,e){var c,
d,f,n;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);var g=[];g.spatialReference={wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,"curveMember");for(c=0;c<f.length;c++)for(n=this._readCurveMember(f[c],a,e),d=0;d<n.length;d++)g.push(n[d]);f=b.getElementsByTagNameNS(this._gmlNS,"curveMembers");for(c=0;c<f.length;c++)for(n=this._readCurveMembers(f[c],a,e),d=0;d<n.length;d++)g.push(n[d]);return g},_readGeometryMember:function(b,a,e){var c,
d;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);d=b.getElementsByTagNameNS(this._gmlNS,"Point");for(c=0;c<d.length;)return this._readPoint(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(c=0;c<d.length;){a=this._readLineString(d[c],a,e);e={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};c=[];for(b=0;b<a.length;b++)c.push(a[b]);return e.paths.push(c),e}d=b.getElementsByTagNameNS(this._gmlNS,"Polygon");
for(c=0;c<d.length;)return this._readPolygon(d[c],a,e);return null},_readSurfaceMember:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d=[];d.geometryType="multigeometry";d.spatialReference={wkid:this._map.spatialReference.wkid};c=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(b=0;b<c.length;b++){var f=this._readPolygon(c[b],a,e);d.push(f)}return d},_readSurfaceMembers:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);
0!==d&&(e=d);d=[];d.geometryType="multigeometry";d.spatialReference={wkid:this._map.spatialReference.wkid};c=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(b=0;b<c.length;b++){var f=this._readPolygon(c[b],a,e);d.push(f)}return d},_readCurveMember:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d=[];d.geometryType="multigeometry";d.spatialReference={wkid:this._map.spatialReference.wkid};c=b.getElementsByTagNameNS(this._gmlNS,"LineString");
for(b=0;b<c.length;b++){var f=this._readLineString(c[b],a,e);d.push(f)}return d},_readCurveMembers:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d=[];d.geometryType="multigeometry";d.spatialReference={wkid:this._map.spatialReference.wkid};c=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(b=0;b<c.length;b++){var f=this._readLineString(c[b],a,e);d.push(f)}return d},_readBox:function(b,a,e){var c,d,f,n,g,h,t,x=this._readWkidFromNode(b);
-1!=x&&(a=x);x=this._readSrsDimension(b);0!==x&&(e=x);x={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};d=b.getElementsByTagNameNS(this._gmlNS,"coordinates");for(c=0;c<d.length;c++)if(f=this._readCoordinates(d[c],a,e))return 1<=f.length&&(n=h=f[0][0],g=t=f[0][1]),1<=f.length&&(h=f[1][0],t=f[1][1]),x.rings.push([[n,g],[n,t],[h,t],[h,g],[n,g]]),x;return(d=b.getElementsByTagNameNS(this._gmlNS,"coord"),2<=d.length)?((b=this._readCoord(d[0],a,e))&&1<=b.length&&
(n=h=b[0][0],g=t=b[0][1]),a=this._readCoord(d[1],a,e),a&&1<=a.length&&(h=a[0][0],t=a[0][1]),x.rings.push([[n,g],[n,t],[h,t],[h,g],[n,g]]),x):null},_readEnvelope:function(b,a,e){var c,d,f,n;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);d=b.getElementsByTagNameNS(this._gmlNS,"lowerCorner");for(c=0;c<d.length;c++){var g=this._readCoordinates(d[c],a,e);g&&(f=g[0])}d=b.getElementsByTagNameNS(this._gmlNS,"upperCorner");for(c=0;c<d.length;c++)(b=this._readCoordinates(d[c],
a,e))&&(n=b[0]);return f&&n?{geometryType:"polygon",rings:[[[f[0],f[1]],[f[0],n[1]],[n[0],n[1]],[n[0],f[1]],[f[0],f[1]]]],spatialReference:{wkid:this._map.spatialReference.wkid}}:null},_readPolygon:function(b,a,e){var c,d,f;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);var n={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};d=b.getElementsByTagNameNS(this._gmlNS,"outerBoundaryIs");for(c=0;c<d.length;c++)f=this._readOuterBoundaryIs(d[c],
a,e),n.rings.push(f);d=b.getElementsByTagNameNS(this._gmlNS,"innerBoundaryIs");for(c=0;c<d.length;c++)f=this._readInnerBoundaryIs(d[c],a,e),n.rings.push(f);d=b.getElementsByTagNameNS(this._gmlNS,"exterior");for(c=0;c<d.length;c++)f=this._readExterior(d[c],a,e),n.rings.push(f);d=b.getElementsByTagNameNS(this._gmlNS,"interior");for(c=0;c<d.length;c++)f=this._readInterior(d[c],a,e),n.rings.push(f);return n},_readPolygonMember:function(b,a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);
0!==c&&(e=c);for(b=b.getElementsByTagNameNS(this._gmlNS,"Polygon");0<b.length;)return this._readPolygon(b[0],a,e);return null},_readMultiPolygon:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d=[];d.geometryType="multigeometry";d.spatialReference={wkid:this._map.spatialReference.wkid};c=b.getElementsByTagNameNS(this._gmlNS,"polygonMember");for(b=0;b<c.length;b++){var f=this._readPolygonMember(c[b],a,e);d.push(f)}return d},_readOuterBoundaryIs:function(b,
a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],a,e);return null},_readInnerBoundaryIs:function(b,a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],a,e);return null},_readExterior:function(b,a,e){var c=this._readWkidFromNode(b);
-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],a,e);return null},_readInterior:function(b,a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],a,e);return null},_readPatches:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);
0!==d&&(e=d);d=[];d.spatialReference={wkid:this._map.spatialReference.wkid};c=b.getElementsByTagNameNS(this._gmlNS,"PolygonPatch");for(b=0;b<c.length;b++)d.push(this._readPolygon(c[b],a,e));return d},_readLineString:function(b,a,e){var c,d,f,g,n;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);var h=[];h.spatialReference={wkid:this._map.spatialReference.wkid};f=b.getElementsByTagNameNS(this._gmlNS,"coordinates");for(c=0;c<f.length;c++)if(g=this._readCoordinates(f[c],
a,e))for(d=0;d<g.length;d++)n=g[d],h.push(n);f=b.getElementsByTagNameNS(this._gmlNS,"coord");for(c=0;c<f.length;c++)if(g=this._readCoord(f[c],a,e))for(d=0;d<g.length;d++)n=g[d],h.push(n);f=b.getElementsByTagNameNS(this._gmlNS,"posList");for(c=0;c<f.length;c++)if(g=this._readPosList(f[c],a,e))for(d=0;d<g.length;d++)n=g[d],h.push(n);return h},_readLineStringMember:function(b,a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);for(b=b.getElementsByTagNameNS(this._gmlNS,
"LineString");0<b.length;)return this._readLineString(b[0],a,e);return null},_readMultiLineString:function(b,a,e){var c,d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};c=b.getElementsByTagNameNS(this._gmlNS,"lineStringMember");for(b=0;b<c.length;b++){var f=this._readLineStringMember(c[b],a,e);f&&d.paths.push(f)}return 1<=d.paths.length?d:null},_readPoint:function(b,a,e){var c,
d,f;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);d=b.getElementsByTagNameNS(this._gmlNS,"coordinates");for(c=0;c<d.length;c++)if(f=this._readCoordinates(d[c],a,e))return{geometryType:"point",x:f[0][0],y:f[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};d=b.getElementsByTagNameNS(this._gmlNS,"pos");for(c=0;c<d.length;c++)if((f=this._readPos(d[c],a,e))&&0<f.length)return{geometryType:"point",x:f[0][0],y:f[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};
d=b.getElementsByTagNameNS(this._gmlNS,"coord");for(c=0;c<d.length;c++)if(b=this._readCoord(d[c],a,e))return{geometryType:"point",x:b[0][0],y:b[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};return null},_readPointMember:function(b,a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);for(b=b.getElementsByTagNameNS(this._gmlNS,"Point");0<b.length;)return this._readPoint(b[0],a,e);return null},_readMultiPoint:function(b,a,e){var c,d=this._readWkidFromNode(b);
-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(e=d);d={geometryType:"multipoint",points:[],spatialReference:{wkid:this._map.spatialReference.wkid}};c=b.getElementsByTagNameNS(this._gmlNS,"pointMember");for(b=0;b<c.length;b++){var f=this._readPointMember(c[b],a,e);f&&d.points.push([f.x,f.y])}return 1<=d.points.length?d:null},_readLinearRing:function(b,a,e){var c,d;c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);d=b.getElementsByTagNameNS(this._gmlNS,"coordinates");
for(c=0;c<d.length;)return this._readCoordinates(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"posList");for(c=0;c<d.length;)return this._readCoordinates(d[c],a,e);d=b.getElementsByTagNameNS(this._gmlNS,"pos");for(c=0;c<d.length;)return this._readPos(d[c],a,e)},_readCoordinatesBody:function(b,a,e){var c,d,f=new E(b);a=a.trim();var g,h=[];h.spatialReference={wkid:this._map.spatialReference.wkid};b=this._isReverse(b,this.version);if(a)if(2===e){if((c=a.match(/[0123456789.\-\+eE]+/g))&&2<=c.length)for(a=
0;a<c.length;a+=2){e=parseFloat(c[a]);g=parseFloat(c[a+1]);b&&(d=g,g=e,e=d);var n={};this._projectFromSRToSR(f,this._map.spatialReference,e,g,n)&&(e=n.x,g=n.y);h.push([e,g])}}else if(3===e&&(c=a.match(/[0123456789.\-\+eE]+/g))&&3<=c.length)for(a=0;a<c.length;a+=3)e=parseFloat(c[a]),g=parseFloat(c[a+1]),b&&(d=g,g=e,e=d),n={},this._projectFromSRToSR(f,this._map.spatialReference,e,g,n)&&(e=n.x,g=n.y),h.push([e,g]);return h},_readCoord:function(b,a,e){var c,d,f,g,h=this._readWkidFromNode(b);-1!=h&&(a=
h);h=new E(a);f=this._readSrsDimension(b);0!==f&&(e=f);var n=this._isReverse(a,this.version),t=[];t.spatialReference={wkid:this._map.spatialReference.wkid};f=0;d=b.getElementsByTagNameNS(this._gmlNS,"X");for(c=0;c<d.length;){f=this._readFloat(d[c],a,e);break}g=0;d=b.getElementsByTagNameNS(this._gmlNS,"Y");for(c=0;c<d.length;){g=this._readFloat(d[c],a,e);break}n&&(f=g=f);b={};return this._projectFromSRToSR(h,this._map.spatialReference,f,g,b)&&(f=b.x,g=b.y),t.push(n?[g,f]:[f,g]),t},_readCoordinates:function(b,
a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);return this._readCoordinatesBody(a,b.textContent,e)},_readPos:function(b,a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);return this._readCoordinatesBody(a,b.textContent,e)},_readPosList:function(b,a,e){var c=this._readWkidFromNode(b);-1!=c&&(a=c);c=this._readSrsDimension(b);0!==c&&(e=c);return this._readCoordinatesBody(a,b.textContent,e)},_projectFromSRToSR:function(b,
a,d,f,g){return H.canProject(b,a)?(b=new e(d,f,b),a=H.project(b,a),g.x=a.x,g.y=a.y,!0):(g.x=d,g.y=f,this._isProjectedOk=!1,!1)},_readFloat:function(b){return(b=b.textContent)?parseFloat(b):0},_readSrsDimension:function(b){return b.attributes&&(b=b.attributes.getNamedItem("srsDimension"))?parseInt(b.value,10):0},_readWkidFromNode:function(b){return b.attributes&&(b=b.attributes.getNamedItem("srsName"))&&(b=b.value.match(/\d+/g))&&0<b.length?(b=parseInt(b[b.length-1],10),84===b&&(b=4326),parseInt(b,
10)):-1},_isReverse:function(b,a){return this._inverseResponse},_appendCustomParameters:function(b){if(this.customParameters)for(var a in this.customParameters)b+=(-1===b.indexOf("?")?"?":"\x26")+a+"\x3d"+encodeURIComponent(this.customParameters[a]);return b}});return u("extend-esri")&&h.setObject("layers.WFSLayer",p,r),p})},"esri/layers/WMTSLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff dojox/xml/parser ../kernel ../lang ../request ../urlUtils ../WKIDUnitConversion ../SpatialReference ../geometry/Point ../geometry/Extent ../geometry/webMercatorUtils ./TiledMapServiceLayer ./TileInfo ./WMTSLayerInfo dojo/query".split(" "),
function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,C,A,E,H){g=g([A],{declaredClass:"esri.layers.WMTSLayer",copyright:null,extent:null,tileUrl:null,spatialReference:null,tileInfo:null,constructor:function(a,e){if(this.version="1.0.0",this.tileUr=this._url=a,this.serviceMode="RESTful",this._parseCapabilities=h.hitch(this,this._parseCapabilities),this._getCapabilitiesError=h.hitch(this,this._getCapabilitiesError),e||(e={}),e.serviceMode){if("KVP"!==e.serviceMode&&"RESTful"!==e.serviceMode)return void console.error("WMTS mode could only be 'KVP' or 'RESTful'");
this.serviceMode=e.serviceMode}this.customParameters=e.customParameters;this.customLayerParameters=e.customLayerParameters;this.layerInfo=new H;e.layerInfo&&(this.layerInfo=e.layerInfo,this._identifier=e.layerInfo.identifier,this._tileMatrixSetId=e.layerInfo.tileMatrixSet,e.layerInfo.format&&(this.format="image/"+e.layerInfo.format),this._style=e.layerInfo.style,this.title=e.layerInfo.title,this._dimension=e.layerInfo.dimension,this._dimension2=e.layerInfo.dimension2);e.resourceInfo?(this.version=
e.resourceInfo.version,e.resourceInfo.getTileUrl&&(this._url=this.tileUrl=e.resourceInfo.getTileUrl),this.copyright=e.resourceInfo.copyright,this.layerInfos=e.resourceInfo.layerInfos,this.customParameters=e.resourceInfo.customParameters||this.customParameters,this.customLayerParameters=e.resourceInfo.customLayerParameters||this.customLayerParameters,this._parseResourceInfo(),this.loaded=!0,this.onLoad(this)):this._getCapabilities();this._formatDictionary={"image/png":".png","image/png8":".png","image/png24":".png",
"image/png32":".png","image/jpg":".jpg","image/jpeg":".jpeg","image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"","image/jpegpng":"","image/unknown":""}},setActiveLayer:function(a){this.setVisibleLayer(a)},setVisibleLayer:function(a){this._setActiveLayer(a);this.refresh(!0)},setCustomParameters:function(a,e){this.customParameters=a;this.customLayerParameters=e;this.refresh(!0)},getTileUrl:function(a,e,d){a=this._levelToLevelValue[a];var f;return f=this.resourceUrls&&0<this.resourceUrls.length?
this.resourceUrls[e%this.resourceUrls.length].template.replace(/\{Style\}/gi,this._style).replace(/\{TileMatrixSet\}/gi,this._tileMatrixSetId).replace(/\{TileMatrix\}/gi,a).replace(/\{TileRow\}/gi,e).replace(/\{TileCol\}/gi,d).replace(/\{dimensionValue\}/gi,this._dimension).replace(/\{dimensionValue2\}/gi,this._dimension2):this.UrlTemplate.replace(/\{level\}/gi,a).replace(/\{row\}/gi,e).replace(/\{col\}/gi,d),f=this._appendCustomLayerParameters(f),f=this.addTimestampToURL(f),w.addProxy(f)},getTileUrlTemplate:function(a){var e,
d=a.identifier,f=a.tileMatrixSet,g=a.format,h=a.style,l=a.dimension;a=a.dimension2;if(d?e=m.filter(this.layers,function(b){return b.identifier===d})[0]:(e=this.layers[0],d=this.layers[0].identifier),!e)return console.error("couldn't find the layer "+d),void this.onError(Error("couldn't find the layer "+d));if(g){if(!(-1===g.indexOf("image/")&&-1<m.indexOf(e.formats,g))&&(-1===g.indexOf("image/")&&(g="image/"+g),-1===m.indexOf(e.formats,g)))return console.error("The layer doesn't support the format of "+
g),void this.onError(Error("The layer doesn't support the format of "+g))}else g=e.formats[0];if(h){if(-1===m.indexOf(e.styles,h))return console.error("The layer doesn't support the style of "+h),void this.onError(Error("The layer doesn't support the style of "+h))}else h=e.styles[0];if(!l&&e.dimensions)l=e.dimensions[0];else if(-1===m.indexOf(e.dimensions,l))return console.error("The layer doesn't support the dimension of "+l),void this.onError(Error("The layer doesn't support the dimension of "+
l));if(!a&&e.dimensions2)a=e.dimensions2[0];else if(-1===m.indexOf(e.dimensions2,a))return console.error("The layer doesn't support the dimension of "+a),void this.onError(Error("The layer doesn't support the dimension of "+a));var b;if(f){if(!(b=m.filter(e.tileMatrixSetInfos,function(b){return b.tileMatrixSet===f})[0]))return console.error("The tileMatrixSetId "+f+" is not supported by the layer of "+d),void this.onError(Error("The tileMatrixSetId "+f+" is not supported by the layer of "+d))}else(b=
m.filter(e.tileMatrixSetInfos,function(b){return"GoogleMapsCompatible"===b.tileMatrixSet})[0])||(b=e.tileMatrixSetInfos[0]),f=b.tileMatrixSet;return this._getTileUrlTemplate(d,f,g,h,l,a)},_getTileUrlTemplate:function(a,e,d,g,h,l){var f;if(a||(a=this._identifier),e||(e=this._tileMatrixSetId),d||(d=this.format),g||""===g||(g=this._style),this.resourceUrls&&0<this.resourceUrls.length)return f=this.resourceUrls[0].template,f.indexOf(".xxx")===f.length-4&&(f=f.slice(0,f.length-4)),f=f.replace(/\{Style\}/gi,
g),f=f.replace(/\{TileMatrixSet\}/gi,e),f=f.replace(/\{TileMatrix\}/gi,"{level}"),f=f.replace(/\{TileRow\}/gi,"{row}"),f=f.replace(/\{TileCol\}/gi,"{col}"),f=f.replace(/\{dimensionValue\}/gi,h),f=f.replace(/\{dimensionValue2\}/gi,l);"KVP"===this.serviceMode?f=this._url+"SERVICE\x3dWMTS\x26VERSION\x3d"+this.version+"\x26REQUEST\x3dGetTile\x26LAYER\x3d"+a+"\x26STYLE\x3d"+g+"\x26FORMAT\x3d"+d+"\x26TILEMATRIXSET\x3d"+e+"\x26TILEMATRIX\x3d{level}\x26TILEROW\x3d{row}\x26TILECOL\x3d{col}":"RESTful"===this.serviceMode&&
(h="",this._formatDictionary[d.toLowerCase()]&&(h=this._formatDictionary[d.toLowerCase()]),f=this._url+a+"/"+g+"/"+e+"/{level}/{row}/{col}"+h);return f},_parseResourceInfo:function(){var a,e,d=this.layerInfos;"KVP"===this.serviceMode&&(this._url+=-1<this._url.indexOf("?")?"":"?");for(e=0;e<d.length;e++)if(!(this._identifier&&d[e].identifier!==this._identifier||this.title&&d[e].title!==this.title||this._tileMatrixSetId&&d[e].tileMatrixSet!==this._tileMatrixSetId||this.format&&"image/"+d[e].format!==
this.format||this._style&&d[e].style!==this._style)){h.mixin(this,{description:d[e].description,tileInfo:d[e].tileInfo,spatialReference:d[e].tileInfo.spatialReference,fullExtent:d[e].fullExtent,initialExtent:d[e].initialExtent,_identifier:d[e].identifier,_tileMatrixSetId:d[e].tileMatrixSet,format:"image/"+d[e].format,_style:d[e].style});break}for(e=0;e<d.length;e++)a=d[e].tileInfo,96!==a.dpi&&(m.forEach(a.lods,function(e){e.scale=96*e.scale/a.dpi}),a.dpi=96),m.forEach(a.lods,function(f){f.resolution=
this._getResolution(a.spatialReference.wkid,90.71428571428571*f.scale/96,d[e].tileMatrixSet)},this);this._setActiveLayer();this.UrlTemplate=this._getTileUrlTemplate();this._levelToLevelValue=[];m.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=a.levelValue?a.levelValue:a.level},this)},_getCapabilities:function(){var a;"KVP"===this.serviceMode?a=-1<this._url.indexOf("?")?this._url+"\x26request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:this._url+"?request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+
this.version:"RESTful"===this.serviceMode&&(a=this._url+"/"+this.version+"/WMTSCapabilities.xml");a=this._appendCustomParameters(a);r({url:a,handleAs:"text",load:this._parseCapabilities,error:this._getCapabilitiesError})},_parseCapabilities:function(a){a=a.replace(/ows:/gi,"");a=u.parse(a);var e=p.query("Contents",a)[0];if(!e)return console.error("The WMTS capabilities XML is not valid"),void this.onError(Error("The WMTS capabilities XML is not valid"));var d,f,g,h=p.query("OperationsMetadata",a)[0];
d=p.query("[name\x3d'GetTile']",h)[0];var h=this._url,l=p.query("Get",d),b=!1;for(d=0;d<l.length;d++){var c=p.query("Constraint",l[d])[0];if(!c||this._getTagWithChildTagValue("AllowedValues","Value",this.serviceMode,c)){h=l[d].attributes[0].nodeValue;b=!0;break}!c||this._getTagWithChildTagValue("AllowedValues","Value","RESTful",c)?f=l[d].attributes[0].nodeValue:c&&!this._getTagWithChildTagValue("AllowedValues","Value","KVP",c)||(g=l[d].attributes[0].nodeValue)}b||("KVP"===this.serviceMode&&f?(h=f,
this.serviceMode="RESTful"):"RESTful"===this.serviceMode&&g&&(h=g,this.serviceMode="KVP"));-1===h.indexOf("/1.0.0/")&&"RESTful"===this.serviceMode&&(h+="/");"KVP"===this.serviceMode&&(h+=-1<h.indexOf("?")?"":"?");this._url=h;this.copyright=this._getTagValues("Capabilities\x3eServiceIdentification\x3eAccessConstraints",a)[0];var n;f=p.query("Layer",e);var k=[];this.layers=[];m.forEach(f,function(b){n=this._getTagValues("Identifier",b)[0];k.push(n);this.layers.push(this._getWMTSLayerInfo(n,b,e))},this);
this._setActiveLayer();this.loaded=!0;this.onLoad(this)},_setActiveLayer:function(a){if(a||(a={}),a.identifier&&(this._identifier=a.identifier),a.tileMatrixSet&&(this._tileMatrixSetId=a.tileMatrixSet),a.format&&(this.format=a.format),a.style&&(this._style=a.style),a.dimension&&(this._dimension=a.dimension),a.dimension2&&(this._dimension2=a.dimension2),this.layers){var e;if(this._identifier?e=m.filter(this.layers,function(a){return a.identifier===this._identifier},this)[0]:(e=this.layers[0],this._identifier=
this.layers[0].identifier),!e)return console.error("couldn't find the layer "+this._identifier),void this.onError(Error("couldn't find the layer "+this._identifier));if(this.format){if(-1===this.format.indexOf("image/")&&(this.format="image/"+this.format),-1===m.indexOf(e.formats,this.format))return console.error("The layer doesn't support the format of "+this.format),void this.onError(Error("The layer doesn't support the format of "+this.format))}else this.format=e.formats[0],-1===this.format.indexOf("image/")&&
(this.format="image/"+this.format);if(this._style){if(-1===m.indexOf(e.styles,this._style))return console.error("The layer doesn't support the style of "+this._style),void this.onError(Error("The layer doesn't support the style of "+this._style))}else this._style=e.styles[0];if(!this._dimension&&e.dimensions)this._dimension=e.dimensions[0];else if(-1===m.indexOf(e.dimensions,this._dimension))return console.error("The layer doesn't support the dimension of "+this._dimension),void this.onError(Error("The layer doesn't support the dimension of "+
this._dimension));if(!this._dimension2&&e.dimensions2)this._dimension2=e.dimensions2[0];else if(-1===m.indexOf(e.dimensions2,this._dimension2))return console.error("The layer doesn't support the dimension of "+this._dimension2),void this.onError(Error("The layer doesn't support the dimension of "+this._dimension2));if(this._tileMatrixSetId){if(!(a=m.filter(e.tileMatrixSetInfos,function(a){return a.tileMatrixSet===this._tileMatrixSetId},this)[0]))return console.error("The tileMatrixSetId "+this._tileMatrixSetId+
" is not supported by the layer of "+this._identifier),void this.onError(Error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier))}else(a=m.filter(e.tileMatrixSetInfos,function(a){return"GoogleMapsCompatible"===a.tileMatrixSet})[0])||(a=e.tileMatrixSetInfos[0]),this._tileMatrixSetId=a.tileMatrixSet;this.description=e.description;this.title=e.title;this.spatialReference=a.tileInfo.spatialReference;this.tileInfo=a.tileInfo;this._levelToLevelValue=[];
m.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=a.levelValue?a.levelValue:a.level},this);102100===this.spatialReference.wkid||102113===this.spatialReference.wkid?this.fullExtent=this.initialExtent=C.geographicToWebMercator(e.gcsExtent):4326===this.spatialReference.wkid?this.fullExtent=this.initialExtent=e.gcsExtent:(this.fullExtent=a.fullExtent,this.initialExtent=a.initialExtent);this.resourceUrls=e.resourceUrls;this.UrlTemplate=this._getTileUrlTemplate();this.layerInfo=
{identifier:this._identifier,tileMatrixSet:this._tileMatrixSetId,format:this.format,style:this._style,fullExtent:this.fullExtent,initialExtent:this.initialExtent,tileInfo:this.tileInfo,title:this.title,description:this.description}}},_getWMTSLayerInfo:function(a,e,d){var f,g=this._getTagValues("Abstract",e)[0],h=this._getTagValues("Title",e)[0],l=p.query("WGS84BoundingBox",e)[0],b=l?this._getTagValues("LowerCorner",l)[0].split(" "):["-180","-90"],c=l?this._getTagValues("UpperCorner",l)[0].split(" "):
["180","90"],l=parseFloat(b[0]),b=parseFloat(b[1]),n=parseFloat(c[0]),c=parseFloat(c[1]),l=new y(l,b,n,c,new B({wkid:4326})),c=this._getTagValues("Identifier",p.query("Style",e)[0]),k=this._getTagValues("Identifier",p.query("Dimension",e)[0]),q=this._getTagValues("Default",p.query("Dimension",e)[0])||this._getTagValues("Value",p.query("Dimension",e)[0]),t=1<p.query("Dimension",e).length?this._getTagValues("Identifier",p.query("Dimension",e)[1]):[],r=1<p.query("Dimension",e).length?this._getTagValues("Default",
p.query("Dimension",e)[1])||this._getTagValues("Value",p.query("Dimension",e)[1]):[],b=this._getTagValues("Format",e);d=this._getLayerMatrixInfos(e,d);a={identifier:a,tileMatrixSetInfos:d,formats:b,styles:c,title:h,description:g,gcsExtent:l,dimensions:q,dimensions2:r};e=p.query("ResourceURL",e);var u=[];return m.forEach(e,function(b){if(f=b.getAttribute("template"),k&&q&&k[0]&&q[0])if(-1<f.indexOf("{"+k+"}"))f=f.replace("{"+k+"}","{dimensionValue}");else{var a=f.toLowerCase().indexOf("{"+k[0].toLowerCase()+
"}");-1<a&&(f=f.substring(0,a)+"{dimensionValue}"+f.substring(a+k[0].length+2))}t&&r&&t[0]&&r[0]&&(-1<f.indexOf("{"+t+"}")?f=f.replace("{"+t+"}","{dimensionValue2}"):(a=f.toLowerCase().indexOf("{"+t[0].toLowerCase()+"}"),-1<a&&(f=f.substring(0,a)+"{dimensionValue2}"+f.substring(a+t[0].length+2))));u.push({template:f,format:b.getAttribute("format"),resourceType:b.getAttribute("resourceType")})}),u&&0<u.length&&(a.resourceUrls=u),a},_getLayerMatrixInfos:function(a,e){var d,f=[];this._allMatrixInfos||
(this._allMatrixInfos=[]);var g=this._getTagValues("TileMatrixSet",a);if(g&&0!==g.length)return m.forEach(g,function(g){var h;if(0<this._allMatrixInfos.length)for(d=0;d<this._allMatrixInfos.length;d++)if(this._allMatrixInfos[d].tileMatrixSet==g){h=this._allMatrixInfos[d];break}h||(h=this._getLayerMatrixInfo(g,a,e),this._allMatrixInfos.push(h));f.push(h)},this),f},_getLayerMatrixInfo:function(a,e,d){var f,g,h,l,b=[];e=this._getTagWithChildTagValue("TileMatrixSetLink","TileMatrixSet",a,e);var c=this._getTagValues("TileMatrix",
e),n=this._getTagWithChildTagValue("TileMatrixSet","Identifier",a,d),k=this._getTagValues("SupportedCRS",n)[0];900913!=(f=parseInt(k.split(":").pop(),10))&&3857!=f||(f=102100);-1<k.toLowerCase().indexOf("crs84")||-1<k.toLowerCase().indexOf("crs:84")?(f=4326,l=!0):-1<k.toLowerCase().indexOf("crs83")||-1<k.toLowerCase().indexOf("crs:83")?(f=4269,l=!0):(-1<k.toLowerCase().indexOf("crs27")||-1<k.toLowerCase().indexOf("crs:27"))&&(f=4267,l=!0);var q=new B({wkid:f}),m=p.query("TileMatrix",n)[0];d=parseInt(this._getTagValues("TileWidth",
m)[0],10);e=parseInt(this._getTagValues("TileHeight",m)[0],10);g=this._getTagValues("TopLeftCorner",m)[0].split(" ");var t=g[0],r=g[1];1<t.split("E").length&&(g=t.split("E"),t=g[0]*Math.pow(10,g[1]));1<r.split("E").length&&(g=r.split("E"),r=g[0]*Math.pow(10,g[1]));var t=parseFloat(t),r=parseFloat(r),u=l&&4326===f&&90===t&&-180===r;for(g=0;g<this._flippingAxisForWkids.length;g++)if(k.split(":").pop()>=this._flippingAxisForWkids[g][0]&&k.split(":").pop()<=this._flippingAxisForWkids[g][1]||4326===f&&
(!l||u)){4326===f&&90<t&&(t="90");h=new G(r,t,q);break}if(g===this._flippingAxisForWkids.length&&(h=new G(t,r,q)),0===c.length)for(c=p.query("TileMatrix",n),g=0;g<c.length;g++)l=this._getLodFromTileMatrix(c[g],f,g,a),b.push(l);else for(g=0;g<c.length;g++)l=this._getTagWithChildTagValue("TileMatrix","Identifier",c[g],n),l=this._getLodFromTileMatrix(l,f,g,a),b.push(l);var w,A,C;f=p.query("BoundingBox",n)[0];(f&&(w=this._getTagValues("LowerCorner",f)[0].split(" "),A=this._getTagValues("UpperCorner",
f)[0].split(" ")),w&&1<w.length&&A&&1<A.length)?(f=parseFloat(w[0]),m=parseFloat(w[1]),w=parseFloat(A[0]),A=parseFloat(A[1])):(w=this._getTagValues("MatrixWidth",m)[0],m=this._getTagValues("MatrixHeight",m)[0],f=h.x,A=h.y,w=f+w*e*b[0].resolution,m=A-m*d*b[0].resolution);return C=new y(f,m,w,A,q),{tileMatrixSet:a,fullExtent:C,initialExtent:C,tileInfo:new E({dpi:96,spatialReference:q,format:this.format,rows:d,cols:e,origin:h,lods:b})}},_getCapabilitiesError:function(a){console.error("Failed to get capabilities xml");
this.onError(a)},_getLodFromTileMatrix:function(a,e,d,g){var f=this._getTagValues("Identifier",a)[0];a=this._getTagValues("ScaleDenominator",a)[0];1<a.split("E").length?(a=a.split("E"),a=a[0]*Math.pow(10,a[1])):a=parseFloat(a);e=this._getResolution(e,a,g);return a*=1.058267716535433,{level:d,levelValue:f,scale:a,resolution:e}},_getResolution:function(a,e,d){var f;return f=l.isDefined(D[a])?D.values[D[a]]:"default028mm"===d?6370997*Math.PI/180:6378137*Math.PI/180,7*e/25E3/f},_getTag:function(a,e){return(a=
p.query(a,e))&&0<a.length?a[0]:null},_getTagValues:function(a,e){var f=[],g=a.split("\x3e");if(a=p.query(g[0],e)[0],1<g.length){for(e=1;e<g.length-1;e++)a=p.query(g[e],a)[0];e=p.query(g[g.length-1],a)}else e=p.query(g[0],e);return e&&0<e.length&&m.forEach(e,function(a){9>d("ie")?f.push(a.childNodes.length?a.childNodes[0].nodeValue:""):f.push(a.textContent)}),f},_getAttributeValues:function(a,e,d){a=p.query(a,d);var f=[];return a&&0<a.length&&m.forEach(a,function(a){f.push(a.getAttribute(e))}),f},
_getTagWithChildTagValue:function(a,e,g,h){var f,m=h.childNodes;for(h=0;h<m.length;h++)if(-1<m[h].nodeName.indexOf(a)&&(9>d("ie")?l.isDefined(p.query(e,m[h])[0])&&(f=p.query(e,m[h])[0].childNodes[0].nodeValue):l.isDefined(p.query(e,m[h])[0])&&(f=p.query(e,m[h])[0].textContent),f===g||g.split(":")&&f===g.split(":")[1]))return m[h]},_appendCustomParameters:function(a){var e;if(this.customParameters)for(e in this.customParameters)a+=(-1===a.indexOf("?")?"?":"\x26")+e+"\x3d"+encodeURIComponent(this.customParameters[e]);
return a},_appendCustomLayerParameters:function(a){var e,d;if(this.customLayerParameters||this.customParameters)for(e in d=h.clone(this.customParameters||{}),h.mixin(d,this.customLayerParameters||{}),d)a+=(-1===a.indexOf("?")?"?":"\x26")+e+"\x3d"+encodeURIComponent(d[e]);return a},_flippingAxisForWkids:[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,
4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,
2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,
5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]]});return d("extend-esri")&&h.setObject("layers.WMTSLayer",g,a),g})},"esri/layers/WMTSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,g,h,m){p=p(null,
{declaredClass:"esri.layers.WMTSLayerInfo",identifier:null,tileMatrixSet:null,format:null,style:null,tileInfo:null,title:null,fullExtent:null,initialExtent:null,description:null,dimension:null,constructor:function(d){d&&(this.title=d.title,this.tileMatrixSet=d.tileMatrixSet,this.format=d.format,this.style=d.style,this.tileInfo=d.tileInfo,this.fullExtent=d.fullExtent,this.initialExtent=d.initialExtent,this.identifier=d.identifier,this.description=d.description,this.dimension=d.dimension)}});return h("extend-esri")&&
g.setObject("layers.WMTSLayerInfo",p,m),p})},"widgets/AddData/search/AddFromFilePane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/on dojo/Deferred dojo/dom-class dijit/Viewport dojo/sniff dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromFilePane.html dojo/i18n!../nls/strings ./LayerLoader ./util dojo/_base/kernel esri/request esri/layers/FeatureLayer esri/layers/KMLLayer esri/geometry/scaleUtils jimu/dijit/Message jimu/dijit/CheckBox".split(" "),
function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,C,A,E,H,f,e,t,v){return p([w,D,B],{i18n:y,templateString:G,wabWidget:null,maxRecordCount:1E3,maxRecordThreshold:1E5,SHAPETYPE_ICONS:[{type:"shapefile",url:"images/filetypes/zip.svg"},{type:"csv",url:"images/filetypes/csv.svg"},{type:"kml",url:"images/filetypes/kml.svg"},{type:"gpx",url:"images/filetypes/gpx.svg"},{type:"geojson",url:"images/filetypes/geojson.svg"}],postCreate:function(){this.inherited(arguments);this.generalizeCheckBox.setLabel(y.addFromFile.generalizeOn);
this.own(l.on("resize",this.resize()))},destroy:function(){this.inherited(arguments)},startup:function(){if(!this._started){this.wabWidget.isPortal&&(this.SHAPETYPE_ICONS=[{type:"shapefile",url:"images/filetypes/zip.svg"},{type:"csv",url:"images/filetypes/csv.svg"},{type:"kml",url:"images/filetypes/kml.svg"}]);this.inherited(arguments);var e=this,f=this.dropArea,h,b=this.wabWidget.config;if(b.addFromFile)try{h=Number(b.addFromFile.maxRecordCount),"number"!==typeof h||isNaN(h)||(h=Math.floor(h),1<=
h&&h<=this.maxRecordThreshold&&(this.maxRecordCount=h))}catch(n){console.warn("Error setting AddFromFile.maxRecordCount:"),console.warn(n)}if(y.addFromFile.types)try{for(var c in y.addFromFile.types)this._createFileTypeImage(c)}catch(n){console.warn("Error reading support file types:"),console.warn(n)}this.own(d(this.fileNode,"change",function(){if(!e._getBusy()){e._setBusy(!0);var a=e._getFileInfo();a.ok&&e._execute(a)}}));this.own(d(this.uploadLabel,"click",function(a){e._getBusy()&&(a.preventDefault(),
a.stopPropagation())}));this.own(d(f,"dragenter",function(b){b.preventDefault();e._getBusy()||(a.add(f,"hit"),e._setStatus(""))}));this.own(d(f,"dragleave",function(b){b.preventDefault();a.remove(f,"hit")}));this.own(d(f,"dragover",function(a){a.preventDefault()}));this.own(d(f,"drop",function(a){a.preventDefault();a.stopPropagation();e._getBusy()||(e._setBusy(!0),a=e._getFileInfo(a),a.ok&&e._execute(a))}));h=this.wabWidget.domNode;this.own(d(h,"dragenter",function(a){a.preventDefault()}));this.own(d(h,
"dragleave",function(a){a.preventDefault()}));this.own(d(h,"dragover",function(a){a.preventDefault()}));this.own(d(h,"drop",function(a){a.preventDefault()}));this.own(d(this.hintButton,"click",g.hitch(this,function(a){a.preventDefault();a='\x3cdiv class\x3d"intro"\x3e\x3clabel\x3e'+y.addFromFile.intro+"\x3c/label\x3e\x3cul\x3e\x3cli\x3e"+y.addFromFile.types.Shapefile+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.CSV+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.KML+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.GPX+
"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.GeoJSON+'\x3c/li\x3e\x3cli\x3e\x3cspan class\x3d"note"\x3e'+y.addFromFile.maxFeaturesAllowedPattern.replace("{count}",this.maxRecordCount)+"\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e";this.wabWidget.isPortal&&(a='\x3cdiv class\x3d"intro"\x3e\x3clabel\x3e'+y.addFromFile.intro+"\x3c/label\x3e\x3cul\x3e\x3cli\x3e"+y.addFromFile.types.Shapefile+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.CSV+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.KML+'\x3c/li\x3e\x3cli\x3e\x3cspan class\x3d"note"\x3e'+
y.addFromFile.maxFeaturesAllowedPattern.replace("{count}",this.maxRecordCount)+"\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e");new v({message:a})})))}},_addFeatures:function(a,e){var d,b=[],c=a.map,g=0,k=new C;e.layers&&(g=e.layers.length);h.forEach(e.layers,function(c){c=new f(c,{id:k._generateLayerId(),outFields:["*"]});c.xtnAddData=!0;c.graphics&&(a.numFeatures+=c.graphics.length);0===g?c.name=a.baseFileName:"string"!==typeof c.name||0===c.name.length?c.name=a.baseFileName:0!==c.name.indexOf(a.baseFileName)&&
(c.name=y.addFromFile.layerNamePattern.replace("{filename}",a.baseFileName).replace("{name}",c.name));k._setFeatureLayerInfoTemplate(c,null,null);c.fullExtent&&(d=d?d.union(c.fullExtent):c.fullExtent);b.push(c)});0<b.length&&(c.addLayers(b),d&&c.setExtent(d.expand(1.25),!0))},_analyze:function(a,e){if("csv"!==a.fileType.toLowerCase())return e=new u,e.resolve(null),e;var d=null;this.wabWidget.batchGeocoderServers&&0<this.wabWidget.batchGeocoderServers.length&&(d=this.wabWidget.batchGeocoderServers[0]);
var b={enableGlobalGeocoding:!0,sourceLocale:E.locale};d&&(b.geocodeServiceUrl=d.url,d.isWorldGeocodeServer&&(b.sourceCountry="world",b.sourceCountryHint=""));d=a.sharingUrl+"/content/features/analyze";b={f:"json",filetype:a.fileType.toLowerCase(),analyzeParameters:window.JSON.stringify(b)};e=H({url:d,content:b,form:e,handleAs:"json"});e.then(function(b){b&&b.publishParameters&&(a.publishParameters=b.publishParameters)});return e},_createFileTypeImage:function(a){var e=window.isRTL;h.some(this.SHAPETYPE_ICONS,
g.hitch(this,function(d,b){if(a.toLowerCase()===d.type.toLowerCase()){var c=document.createElement("IMG");c.src=this.wabWidget.folderUrl+d.url;c.alt=a;0===b?c.className+=" "+(e?"last":"first")+"-type-icon":1===b?c.className+=" second-"+(e?"last":"first")+"-type-icon":b===this.SHAPETYPE_ICONS.length-2?c.className+=" second-"+(e?"first":"last")+"-type-icon":b===this.SHAPETYPE_ICONS.length-1&&(c.className+=" "+(e?"first":"last")+"-type-icon");this.supportedFileTypes.appendChild(c)}}))},_execute:function(a){var e=
{map:this.wabWidget.map,sharingUrl:this.wabWidget.getSharingUrl(),baseFileName:a.baseFileName,fileName:a.fileName,fileType:a.fileType,generalize:!!this.generalizeCheckBox.getValue(),publishParameters:{},numFeatures:0};this._setBusy(!0);this._setStatus(y.addFromFile.addingPattern.replace("{filename}",a.fileName));if("kml"===a.fileType.toLowerCase())return this._executeKml(a);var d=a.fileName,b=this,c=new FormData;c.append("file",a.file);b._analyze(e,c).then(function(){return b._generateFeatures(e,
c)}).then(function(a){b._addFeatures(e,a.featureCollection);b._setBusy(!1);b._setStatus(y.addFromFile.featureCountPattern.replace("{filename}",d).replace("{count}",e.numFeatures))}).otherwise(function(a){b._setBusy(!1);b._setStatus(y.addFromFile.addFailedPattern.replace("{filename}",d));console.warn("Error generating features.");console.warn(a);a&&"string"===typeof a.message&&0<a.message.length&&new v({titleLabel:y._widgetLabel,message:y.addFromFile.generalIssue+"\x3cbr\x3e\x3cbr\x3e"+a.message})})},
_executeKml:function(a){var d=this,f=new FileReader,b=this.wabWidget.map,c=function(b,c){d._setBusy(!1);d._setStatus(y.addFromFile.addFailedPattern.replace("{filename}",a.fileName));console.warn(b);console.error(c);c&&"string"===typeof c.message&&0<c.message.length&&new v({titleLabel:y._widgetLabel,message:y.addFromFile.generalIssue+"\x3cbr\x3e\x3cbr\x3e"+c.message})};f.onerror=function(a){c("FileReader::onerror",a)};f.onload=function(l){if(f.error)c("FileReader::error",f.error);else{var k=l.target.result,
n=new C;l=n._generateLayerId();var p=new e("",{id:l,name:a.fileName,linkInfo:{visibility:!1}});p.visible=!0;delete p.linkInfo;p._parseKml=function(){var e=this;this._fireUpdateStart();this._io=H({url:this.serviceUrl,content:{kmlString:encodeURIComponent(k),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:m.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(f){e._io=null;e._initLayer(f);n._waitForLayer(p).then(function(c){var e=0;c.name=a.fileName;c.xtnAddData=!0;
h.forEach(c.getLayers(),function(a){a&&a.graphics&&0<a.graphics.length&&(e+=a.graphics.length)});var f=b.spatialReference,g=c._outSR;f&&g&&(f.equals(g)||f.isWebMercator()&&4326===g.wkid||g.isWebMercator()&&4326===f.wkid)?b.addLayer(c):new v({titleLabel:y._widgetLabel,message:y.addFromFile.kmlProjectionMismatch});d._setBusy(!1);d._setStatus(y.addFromFile.featureCountPattern.replace("{filename}",a.fileName).replace("{count}",e))}).otherwise(function(a){c("kml-_waitForLayer.error",a)})},error:function(a){e._io=
null;a=g.mixin(Error(),a);a.message="Unable to load KML: "+(a.message||"");e._fireUpdateEnd(a);e._errorHandler(a);c("Unable to load KML",a)}},{usePost:!0})};p._parseKml()}};try{f.readAsText(a.file)}catch(n){c("FileReader::readAsText",n)}},_generateFeatures:function(a,e){var d=a.sharingUrl+"/content/features/generate";a.publishParameters=a.publishParameters||{};var b=g.mixin(a.publishParameters,{name:a.baseFileName,targetSR:a.map.spatialReference,maxRecordCount:this.maxRecordCount,enforceInputFileSizeLimit:!0,
enforceOutputJsonSizeLimit:!0});if(a.generalize){var c=t.getExtentForScale(a.map,4E4).getWidth()/a.map.width;b.generalize=!0;b.maxAllowableOffset=c;for(var c=c/10,f=0;1>c;)c*=10,f++;b.reducePrecision=!0;b.numberOfDigitsAfterDecimal=f}a={f:"json",filetype:a.fileType.toLowerCase(),publishParameters:window.JSON.stringify(b)};return H({url:d,content:a,form:e,handleAs:"json"})},_getBaseFileName:function(a){r("ie")&&(a=a.split("\\"),a=a[a.length-1]);a=a.split(".");return a=a[0].replace("c:\\fakepath\\",
"")},_getBusy:function(){return a.contains(this.uploadLabel,"disabled")},_getFileInfo:function(a){var e={ok:!1,file:null,fileName:null,fileType:null};if((a=a?a.dataTransfer.files:this.fileNode.files)&&1===a.length)if(e.file=a=a[0],e.fileName=a.name,A.endsWith(a.name,".zip"))e.ok=!0,e.fileType="Shapefile";else if(A.endsWith(a.name,".csv"))e.ok=!0,e.fileType="CSV";else if(A.endsWith(a.name,".kml"))e.ok=!0,e.fileType="KML";else if(A.endsWith(a.name,".gpx"))e.ok=!0,e.fileType="GPX";else if(A.endsWith(a.name,
".geojson")||A.endsWith(a.name,".geo.json"))e.ok=!0,e.fileType="GeoJSON";e.ok&&(e.ok=h.some(this.SHAPETYPE_ICONS,function(a){return a.type.toLowerCase()===e.fileType.toLowerCase()}));if(e.ok)e.baseFileName=this._getBaseFileName(e.fileName);else{a=y.addFromFile.invalidType;"string"===typeof e.fileName&&0<e.fileName.length&&(a=y.addFromFile.invalidTypePattern.replace("{filename}",e.fileName));this._setBusy(!1);this._setStatus(a);var d=document.createElement("div");d.appendChild(document.createTextNode(a));
new v({titleLabel:y._widgetLabel,message:d})}return e},resize:function(){},_setBusy:function(e){e?(a.add(this.uploadLabel,"disabled"),a.add(this.dropArea,["hit","disabled"])):(a.remove(this.uploadLabel,"disabled"),a.remove(this.dropArea,["hit","disabled"]))},_setStatus:function(a){this.wabWidget&&this.wabWidget._setStatus(a)}})})},"widgets/AddData/search/LayerListPane":function(){define("dojo/_base/declare dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/LayerListPane.html dojo/i18n!../nls/strings ./util".split(" "),
function(p,g,h,m,d,u,a,l,r,w,D){return p([u,a,l],{i18n:w,templateString:r,wabWidget:null,baseClass:"add-data-widget-layers",postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this._buildList(),this._initListeners(),this.inherited(arguments))},_addLayer:function(a,g){var h=this,l=this._getLayerTitle(g),m=d.create("div",{"class":"add-data-layerlist--listitem"},a);d.create("A",{"class":"remove-button",href:"#",innerHTML:"\x3cspan class\x3d'esri-icon-trash'\x3e\x3c/span\x3e",
title:w.layerList.removeLayer,onclick:function(a){a.preventDefault();try{h.wabWidget&&h.wabWidget.map&&(h.wabWidget.map.removeLayer(g),d.destroy(m))}catch(H){console.warn("Error removing layer."),console.warn(H)}}},m);a=d.create("label",{"class":"layer-name"},m);D.setNodeText(a,l)},_buildList:function(){var a=this,h=!1,l=[],m=this.wabWidget.map,p=d.create("div",{"class":"add-data-layerlist--list"});g.forEach(m.layerIds,function(a){l.push(a)});g.forEach(m.graphicsLayerIds,function(a){l.push(a)});l.reverse();
g.forEach(l,function(d){(d=m.getLayer(d))&&d.xtnAddData&&(h=!0,a._addLayer(p,d))});return h?p:d.create("div",{"class":"no-data-message",innerHTML:w.layerList.noLayersAdded})},_getLayerTitle:function(a){var d="...";if("string"===typeof a.label&&0<a.label.length)d=a.label;else if("string"===typeof a.title&&0<a.title.length)d=a.title;else if("string"===typeof a.name&&0<a.name.length)d=a.name;else if(a.url){var g=a.url.indexOf("/FeatureServer");-1===g&&(g=a.url.indexOf("/MapServer"));-1===g&&(g=a.url.indexOf("/ImageServer"));
-1===g&&(g=a.url.indexOf("/service"));-1<g&&(a=a.url.substring(0,g),d=a=a.substring(a.lastIndexOf("/")+1,a.length))}return d},_initListeners:function(){var a=this;this.own(h(this._backButton,"click",function(d){d.preventDefault();a.hide()}))},show:function(){var a=this._buildList();this._title.innerHTML=w.layerList.caption;this._layerlist.innerHTML="";a&&a.tagName&&this._layerlist.appendChild(a);this.wabWidget&&this.wabWidget.domNode&&m.add(this.wabWidget.domNode,"layerlist-show");m.add(this.domNode,
"show")},hide:function(){this.wabWidget&&this.wabWidget.domNode&&m.remove(this.wabWidget.domNode,"layerlist-show");m.remove(this.domNode,"show")}})})},"widgets/AddData/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/AddData/search/templates/SearchPane.html":'\x3cdiv class\x3d"search-pane"\x3e\r\n  \x3cdiv class\x3d"search-pane-header" data-dojo-attach-point\x3d"headerNode"\x3e\r\n    \x3cdiv class\x3d"search-bar main-search-bar"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ScopeOptions"\r\n        data-dojo-attach-point\x3d"scopeOptions"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\x3cspan class\x3d"search-box-placeholder" data-dojo-attach-point\x3d"searchBoxPlaceholder"\x3e\x3c/span\x3e--\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SearchBox"\r\n        data-dojo-attach-point\x3d"searchBox"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar-separator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar search-bar-secondary" data-dojo-attach-point\x3d"optionsNode"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/BBoxOption"\r\n        data-dojo-attach-point\x3d"bboxOption"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"filter-wrapper2"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n          data-dojo-attach-point\x3d"typeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n          data-dojo-attach-point\x3d"sortOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n      \x3cspan class\x3d"filter-placeholder" data-dojo-attach-point\x3d"filterPlaceholder"\x3e\x3c/span\x3e\r\n      \x3cdiv class\x3d"filter-wrapper" data-dojo-attach-point\x3d"filterWrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n          data-dojo-attach-point\x3d"typeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n          data-dojo-attach-point\x3d"sortOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane-content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultsPane"\r\n      data-dojo-attach-point\x3d"resultsPane"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane-footer jimu-float-leading" data-dojo-attach-point\x3d"footerNode"\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/Paging"\r\n      data-dojo-attach-point\x3d"paging"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultCount"\r\n      data-dojo-attach-point\x3d"resultCount"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SearchBox.html":'\x3cdiv class\x3d"search-box2"\x3e\r\n\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\tdata-dojo-attach-point\x3d"searchTextBox"\r\n\t\x3e\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\x3c/button\x3e\r\n\x3c!--\r\n\x3cdiv class\x3d"search-box"\x3e\r\n\t\x3cdiv class\x3d"input-group"\x3e\r\n\t\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\t\tdata-dojo-attach-point\x3d"searchTextBox"\x3e\r\n    \x3cspan class\x3d"search-btn"\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-clear hidden" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"clearButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: clearButtonClicked"\x3e\r\n\t\t\t\t\x3cspan class\x3d"esri-icon-close"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n--\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/BBoxOption.html":'\x3cdiv class\x3d"search-bbox-option"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"bboxSection" class\x3d"switch-toggle-group"\x3e\r\n    \x3clabel class\x3d"checkbox-inline"\x3e\r\n      \x3cinput id\x3d"${id}_bboxId"\r\n\t      data-dojo-type\x3d"dijit/form/CheckBox"\r\n\t      data-dojo-attach-point\x3d"bboxToggle"\r\n\t      data-dojo-attach-event\x3d"onClick: bboxClicked"\r\n\t      data-dojo-props\x3d"class: \'switch-toggle\'"\r\n        title\x3d"${i18n.search.bboxOption.bbox}"/\x3e\r\n      \x3cspan class\x3d"label-text"\x3e${i18n.search.bboxOption.bbox}\x3c/span\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\n\t\x3e\x3cinput\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\n\t\tdata-dojo-attach-point\x3d"focusNode"\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\n/\x3e\x3c/div\x3e\n',"url:widgets/AddData/search/templates/ScopeOptions.html":'\x3cdiv class\x3d"search-scope-options"\x3e\r\n  \x3ca href\x3d"#" class\x3d"scope-placeholder"\r\n    data-dojo-attach-point\x3d"scopePlaceholder"\r\n    data-dojo-attach-event\x3d"onClick: scopePlaceholderClicked"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"scopePlaceholderText"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"dropdown-arrow"\x3e\x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"btn-group" data-dojo-attach-point\x3d"btnGroup"\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyContentToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyContent"\x3e\r\n      ${i18n.search.scopeOptions.myContent}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyOrganizationToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyOrganization"\x3e\r\n      ${i18n.search.scopeOptions.myOrganization}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"CuratedToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"Curated"\x3e\r\n      ${i18n.search.scopeOptions.curated}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"ArcGISOnlineToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"ArcGISOnline"\x3e\r\n      ${i18n.search.scopeOptions.ArcGISOnline}\r\n    \x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/TypeOptions.html":'\x3cdiv class\x3d"search-data-type-options"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n    \x3cspan\x3e${i18n.search.typeOptions.prompt}\x3c/span\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\r\n         data-dojo-attach-point\x3d"tooltipDialog"\r\n         data-dojo-props\x3d"\'class\':\'add-data-widget-popup\'"\x3e\r\n      \x3clabel for\x3d"${id}_mapServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_mapServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"mapServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Map Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.mapService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_featureServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_featureServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"featureServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Feature Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.featureService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_imageServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_imageServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"imageServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Image Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.imageService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_vectorTileServiceId" class\x3d"search-type-option"\r\n        data-dojo-attach-point\x3d"vectorTileNode"\x3e\r\n        \x3cdiv id\x3d"${id}_vectorTileServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"vectorTileServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Vector Tile Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.vectorTileService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_kmlId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_kmlId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"kmlToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;KML\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.kml}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_wmsId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_wmsId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"wmsToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;WMS\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.wms}\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SortOptions.html":'\x3cdiv class\x3d"search-sort-options"\x3e\r\n  \x3clabel for\x3d"${id}_select" class\x3d"sort-prompt"\x3e${i18n.search.sortOptions.prompt}\x3c/label\x3e \r\n  \x3cselect id\x3d"${id}_select"\r\n    data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"sortSelect"\x3e\r\n    \x3coption value\x3d"" selected\x3d"selected"\x3e${i18n.search.sortOptions.relevance}\x3c/option\x3e\r\n    \x3coption value\x3d"title"\x3e${i18n.search.sortOptions.title}\x3c/option\x3e\r\n    \x3coption value\x3d"owner"\x3e${i18n.search.sortOptions.owner}\x3c/option\x3e\r\n    \x3coption value\x3d"avgrating"\x3e${i18n.search.sortOptions.rating}\x3c/option\x3e\r\n    \x3coption value\x3d"numviews"\x3e${i18n.search.sortOptions.views}\x3c/option\x3e\r\n    \x3coption value\x3d"modified"\x3e${i18n.search.sortOptions.date}\x3c/option\x3e\r\n  \x3c/select\x3e\r\n  \x3ca href\x3d"#" class\x3d"sort-order-icon"\r\n    title\x3d"${i18n.search.sortOptions.switchOrder}"\r\n    data-dojo-attach-point\x3d"sortOrderBtn"\r\n    data-dojo-attach-event\x3d"onclick: sortOrderClicked"\x3e\r\n  \x3c/a\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/ResultsPane.html":'\x3cdiv class\x3d"search-results-pane" data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"search-results-pane-no-match empty-data-label" data-dojo-attach-point\x3d"noMatchNode" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"itemsNode" class\x3d"search-results"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/ItemCard.html":'\x3cdiv class\x3d"item-card"\x3e\r\n  \x3cdiv class\x3d"item-card-inner"\x3e\r\n    \x3cdiv class\x3d"thumbnail" data-dojo-attach-point\x3d"thumbnailNode"\x3e\x3c/div\x3e\r\n    \x3ch3 class\x3d"title" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/h3\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"typeByOwnerNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"dateNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-bar"\x3e\r\n      \x3cspan class\x3d"message" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"addButton"\r\n        data-dojo-attach-event\x3d"onClick: addClicked"\r\n        \x3e${i18n.search.item.actions.add}\r\n      \x3c/a\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"detailsButton"\r\n        data-dojo-attach-event\x3d"onClick: detailsClicked"\r\n        \x3e${i18n.search.item.actions.details}\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/Paging.html":'\x3cdiv class\x3d"search-paging"\x3e\r\n\t\x3cul class\x3d"pagination pagination-sm"\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"First"\r\n\t\t\t\tdata-dojo-attach-point\x3d"firstButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: firstButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.firstTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-expand"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Previous"\r\n\t\t\t\tdata-dojo-attach-point\x3d"previousButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: previousButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.previousTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-left"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli class\x3d"current-page"\x3e\r\n\t\t  \x3cspan data-dojo-attach-point\x3d"pageNode"\x3e\x3c/span\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Next"\r\n\t\t\t\tdata-dojo-attach-point\x3d"nextButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: nextButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.nextTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-right"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\x3c/ul\x3e\r\n\x3c/div\x3e',
"url:widgets/AddData/search/templates/ResultCount.html":'\x3cdiv class\x3d"search-result-count"\x3e\r\n  \x3cspan class\x3d"search-count" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/AddFromUrlPane.html":'\x3cdiv class\x3d"secondary-pane add-url-pane"\x3e\r\n  \x3cdiv class\x3d"add-url-pane-container"\x3e\r\n    \x3cdiv class\x3d"add-url-pane-container--inner"\x3e\r\n      \x3clabel for\x3d"${id}_select"\x3e${i18n.addFromUrl.type}\x3c/label\x3e\r\n      \x3cselect id\x3d"${id}_select"\r\n        data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"typeSelect"\x3e\r\n        \x3coption value\x3d"ArcGIS" selected\x3d"selected"\x3e${i18n.addFromUrl.types.ArcGIS}\x3c/option\x3e\r\n        \x3coption value\x3d"WMS"\x3e${i18n.addFromUrl.types.WMS}\x3c/option\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WMTS"\x3e${i18n.addFromUrl.types.WMTS}\x3c/option\x3e --\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WFS"\x3e${i18n.addFromUrl.types.WFS}\x3c/option\x3e --\x3e\r\n        \x3coption value\x3d"KML"\x3e${i18n.addFromUrl.types.KML}\x3c/option\x3e\r\n        \x3coption value\x3d"GeoRSS"\x3e${i18n.addFromUrl.types.GeoRSS}\x3c/option\x3e\r\n        \x3coption value\x3d"CSV"\x3e${i18n.addFromUrl.types.CSV}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n      \x3clabel for\x3d"${id}_url"\x3e${i18n.addFromUrl.url}\x3c/label\x3e\r\n      \x3cinput id\x3d"${id}_url" type\x3d"text" class\x3d"url-textbox jimu-input"\r\n          data-dojo-attach-point\x3d"urlTextBox"\x3e\r\n      \x3cdiv class\x3d"action-bar"\x3e\r\n        \x3ca class\x3d"jimu-float-leading" href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"examplesExpander"\r\n          data-dojo-attach-event\x3d"onClick: examplesExpanderClicked"\r\n          \x3e${i18n.addFromUrl.samplesHint}\x3c/a\x3e\r\n        \x3ca class\x3d"jimu-btn"\r\n          href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"addButton"\r\n          data-dojo-attach-event\x3d"onClick: addClicked"\r\n          \x3e${i18n.search.item.actions.add}\r\n        \x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"examples" data-dojo-attach-point\x3d"examplesNode"\x3e\r\n        \x3cdiv data-examples-type\x3d"ArcGIS"\x3e\r\n          \x3cdiv\x3ehttp://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Cities/FeatureServer/0\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://services.arcgisonline.com/ArcGIS/rest/services/Demographics/USA_Tapestry/MapServer\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://imagery.arcgisonline.com/ArcGIS/rest/services/LandsatGLS/VegetationAnalysis/ImageServer\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"WMS"\x3e\r\n          \x3cdiv\x3ehttp://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service\x3dWMS\x26amp;request\x3dGetCapabilities\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"KML"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_month_age_animated.kml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"GeoRSS"\x3e\r\n          \x3cdiv\x3ehttp://www.gdacs.org/xml/rss.xml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"CSV"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.csv\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/AddFromFilePane.html":'\x3cdiv class\x3d"secondary-pane add-file-pane"\x3e\r\n\r\n  \x3cdiv class\x3d"generalize-options"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n      data-dojo-attach-point\x3d"generalizeCheckBox"\r\n      data-dojo-props\x3d"checked:true"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"browse-or-drop"\x3e\r\n    \x3cdiv class\x3d"drop-container" data-dojo-attach-point\x3d"dropContainer"\x3e\r\n      \x3cdiv class\x3d"drop-area" data-dojo-attach-point\x3d"dropArea"\x3e\r\n        \x3cdiv class\x3d"supported-file-types" data-dojo-attach-point\x3d"supportedFileTypes"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"or"\x3e${i18n.addFromFile.dropOrBrowse}\x3c/div\x3e\r\n        \x3cform class\x3d"file-form" enctype\x3d"multipart/form-data" method\x3d"post"\r\n          data-dojo-attach-point\x3d"fileForm"\x3e\r\n          \x3clabel for\x3d"${id}_file" class\x3d"jimu-btn"\r\n            data-dojo-attach-point\x3d"uploadLabel"\x3e${i18n.addFromFile.browse}\x3c/label\x3e\r\n          \x3cinput id\x3d"${id}_file" name\x3d"file" type\x3d"file" style\x3d"display:none"\r\n            data-dojo-attach-point\x3d"fileNode" /\x3e\r\n        \x3c/form\x3e\r\n        \x3ca href\x3d"#" class\x3d"drop-area-hint" data-dojo-attach-point\x3d"hintButton"\x3e\r\n          \x3ci class\x3d"esri-icon-question"\x3e\x3c/i\x3e\r\n        \x3c/a\x3e\r\n        \x3cspan class\x3d"upload-arrow"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/LayerListPane.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--container" data-dojo-attach-point\x3d"_container"\x3e\r\n    \x3ch2 data-dojo-attach-point\x3d"_title"\x3e\x3c/h2\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_layerlist"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--footer jimu-widget-add-data-footer" data-dojo-attach-point\x3d"_footer"\x3e\r\n    \x3ca href\x3d"#" class\x3d"back-button" data-dojo-attach-point\x3d"_backButton"\x3e\r\n      ${i18n.layerList.back}\x3ci class\x3d"esri-icon-collapse"\x3e\x3c/i\x3e\r\n    \x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tabsNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fileNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/AddData/css/style.css":'.jimu-widget-add-data .jimu-tab3 {height: 100%;}.jimu-widget-add-data .search-pane,.jimu-widget-add-data .secondary-pane {height: 100%; width: 100%; background-color: #f8f8f8; position: relative;}.jimu-widget-add-data .search-pane \x3e *,.jimu-widget-add-data .secondary-pane \x3e * {width: 100%;}.jimu-widget-add-data .search-pane-content {position: absolute; top: 140px; bottom: 0; overflow: auto; background-color: #efefef;}.jimu-widget-add-data .search-pane .search-bar {padding: 10px 15px; line-height: 20px;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn {min-width: 40px; padding-top: 10px; padding-bottom: 13px; background-color: transparent; border: 0; border-bottom: 2px solid transparent; margin-left: 5px; margin-right: 5px; color: #898989; font-size: 12px; font-weight: bold; font-family: inherit;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active,.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active,.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {background-color: transparent !important; color: #000 !important; border-bottom-color: #24b5cc; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none;}.jimu-widget-add-data .search-pane .search-bar.main-search-bar {background-color: #fff; padding-bottom: 0; position: relative;}.jimu-widget-add-data .search-pane .search-bar.search-scope-bar .search-sort-options {margin-top: 5px;}.jimu-widget-add-data .search-pane .search-bar-secondary {background-color: #f8f8f8; padding-top: 5px; padding-bottom: 5px; font-size: 11px;}.jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .search-pane .search-pane-header:before,.jimu-widget-add-data .search-pane .search-pane-header:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-pane-header:after {clear: both;}.jimu-widget-add-data .search-pane .search-bar:before,.jimu-widget-add-data .search-pane .search-bar:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-bar:after {clear: both;}.jimu-widget-add-data .search-pane .search-data-type-options {margin-right: 15px;}.jimu-widget-add-data .search-pane .search-curated-option {display: inline-block; margin-left: 30px;}.jimu-widget-add-data .search-pane .search-bar-separator {border-bottom: 1px solid #e7e7e7;}.jimu-widget-add-data .search-pane .search-pane-default .search-bar {text-align: right; margin-bottom: 24px;}.jimu-widget-add-data .search-pane .search-results-pane {padding: 10px 5px;}.jimu-widget-add-data .search-pane .search-results-pane:after {content: ""; display: table; clear: both;}.jimu-widget-add-data .search-pane .item-card {float: left; width: 100%; padding-left: 5px; padding-right: 5px; -webkit-transition: width 0.1s ease; -moz-transition: width 0.1s ease; -o-transition: width 0.1s ease; transition: width 0.1s ease;}.jimu-widget-add-data .search-pane .item-card .item-card-inner {height: 70px; background: #ffffff; border: 1px solid #e0e0e0; border-bottom-color: #cccccc; padding: 5px; margin-bottom: 10px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;}.jimu-widget-add-data .search-pane .item-card .thumbnail {float: left; margin-right: 10px;}.jimu-widget-add-data .search-pane .item-card .thumbnail img {height: 60px; width: 90px;}.jimu-widget-add-data .search-pane .item-card h3.title {margin: 0 5px; padding: 0; font-size: 12px; font-weight: bold; color: #4c4c4c; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .search-pane .item-card div.info {color: #898989; font-size: 10px; overflow: hidden; white-space: nowrap; padding-top: 3px;}.jimu-widget-add-data .search-pane .item-card .action-bar,.jimu-widget-add-data .secondary-pane .action-bar {text-align: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .action-bar,.jimu-rtl .jimu-widget-add-data .secondary-pane .action-bar {text-align: left;}.jimu-widget-add-data .secondary-pane {padding: 20px 15px; overflow: auto;}.jimu-widget-add-data .secondary-pane label {color: #898989; display: block; margin-bottom: 10px;}.jimu-widget-add-data .secondary-pane .dijit {margin-bottom: 10px;}.jimu-widget-add-data .secondary-pane div.action-bar {margin-top: 20px;}.jimu-widget-add-data .secondary-pane .jimu-btn {color: #fff; line-height: 20px; text-decoration: none;}.jimu-widget-add-data .secondary-pane .jimu-btn:active {}.jimu-widget-add-data .search-pane .item-card .action-bar a,.jimu-widget-add-data .add-url-pane .action-bar a,.jimu-widget-add-data .add-file-pane .file-form label {display: inline-block; font-size: 11px; text-transform: uppercase; padding: 5px; margin-right: 5px;}.jimu-widget-add-data .search-pane .item-card .action-bar a.disabled,.jimu-widget-add-data .add-url-pane .action-bar a.disabled,.jimu-widget-add-data .add-file-pane .file-form label.disabled,.jimu-widget-add-data .add-file-pane .drop-area.disabled {opacity: 0.3;}.jimu-widget-add-data .search-pane .item-card .action-bar .message {font-size: 10px; font-style: italic; margin-left: 4px; margin-right: 4px;}.jimu-widget-add-data .add-url-pane .action-bar .jimu-btn,.jimu-widget-add-data .add-file-pane .file-form label {margin-right: 0; min-width: 180px; white-space: normal;}.jimu-widget-add-data .add-url-pane {padding: 0;}.jimu-widget-add-data .add-url-pane-container {background-color: #fff; border-bottom: 1px solid #ccc; padding: 15px 15px 35px;}.jimu-widget-add-data .add-url-pane-container--inner {max-width: 960px; margin: 0 auto;}.jimu-widget-add-data .add-file-pane .intro ul {font-size: 10px; margin: 0; padding: 2px 0 2px 20px;}.jimu-widget-add-data .add-file-pane .intro ul .note {font-style: italic;}.jimu-rtl .jimu-widget-add-data .add-file-pane .intro ul {padding: 2px 20px 2px 0;}.jimu-widget-add-data .add-file-pane .generalize-options .jimu-checkbox .checkbox {margin-top: 0; vertical-align: middle;}.jimu-widget-add-data .add-file-pane .generalize-options .jimu-checkbox .label {font-size: 12px; vertical-align: middle; cursor: pointer;}.jimu-widget-add-data .add-file-pane .browse-or-drop {}.jimu-widget-add-data .add-file-pane .or {display: block; margin: 20px auto; font-size: 11px; color: #898989; width: 90%; max-width: 400px; line-height: 20px; position: relative;}.jimu-widget-add-data .add-file-pane .or:before,.jimu-widget-add-data .add-file-pane .or:after {content: ""; display: block; height: 1px; width: 35%; background: #eee; position: absolute; top: 9px; left: 0;}.jimu-widget-add-data .add-file-pane .or:after {right: 0; left: auto;}.jimu-widget-add-data .add-file-pane .or b {display: inline-block; padding-right: 5px;}.jimu-widget-add-data .add-file-pane .drop-area {width: 100%; background: #fff; margin: 10px auto 0; padding: 25px 50px 35px; border: 1px dashed #ccc; color: #898989; font-size: 12px; text-align: center; line-height: 1.75; text-transform: uppercase; position: relative; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; -webkit-transition: opacity ease-in-out 0.15s; -moz-transition: opacity ease-in-out 0.15s; -o-transition: opacity ease-in-out 0.15s; transition: opacity ease-in-out 0.15s;}.jimu-widget-add-data .add-file-pane .drop-area i {color: #485566; font-style: normal;}.jimu-widget-add-data .add-file-pane .drop-area a.drop-area-hint {position: absolute; top: 0; right: 0; margin: 5px; padding: 10px; font-size: 14px; line-height: 1;}.jimu-widget-add-data .add-file-pane .drop-area.hit {background: #f9f9f9; border-color: #24b5cc;}.jimu-widget-add-data .add-file-pane .drop-area.hit \x3e * {pointer-events: none; display: none;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types {display: block;}.jimu-widget-add-data .add-file-pane .drop-area.hit .upload-arrow {display: block; width: 48px; height: 48px; background: url(images/arrow_up.png) no-repeat; margin: 0 auto; -moz-animation: updload-arrow-animation 1s infinite; -webkit-animation: updload-arrow-animation 1s infinite; animation: updload-arrow-animation 1s infinite;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types {margin: 15px 0 35px; opacity: .5; pointer-events: none; -webkit-transition: opacity ease-in-out 0.15s; -moz-transition: opacity ease-in-out 0.15s; -o-transition: opacity ease-in-out 0.15s; transition: opacity ease-in-out 0.15s;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img {width: 45px; margin-left: -5px; position: relative; -webkit-transition: all ease-in-out 0.2s; -moz-transition: all ease-in-out 0.2s; -o-transition: all ease-in-out 0.2s; transition: all ease-in-out 0.2s;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.first-type-icon {-moz-transform: rotate(-8deg); -moz-transform-origin: right bottom; -webkit-transform: rotate(-8deg); -webkit-transform-origin: right bottom; -o-transform: rotate(-8deg); -o-transform-origin: right bottom; transform: rotate(-8deg); transform-origin: right bottom; bottom: -1px;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.second-first-type-icon {-moz-transform: rotate(-3deg); -moz-transform-origin: right bottom; -webkit-transform: rotate(-3deg); -webkit-transform-origin: right bottom; -o-transform: rotate(-3deg); -o-transform-origin: right bottom; transform: rotate(-3deg); transform-origin: right bottom;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.second-last-type-icon {-moz-transform: rotate(3deg); -moz-transform-origin: left bottom; -webkit-transform: rotate(3deg); -webkit-transform-origin: left bottom; -o-transform: rotate(3deg); -o-transform-origin: left bottom; transform: rotate(3deg); transform-origin: left bottom;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.last-type-icon {-moz-transform: rotate(8deg); -moz-transform-origin: left bottom; -webkit-transform: rotate(8deg); -webkit-transform-origin: left bottom; -o-transform: rotate(8deg); -o-transform-origin: left bottom; transform: rotate(8deg); transform-origin: left bottom; bottom: -1px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types {opacity: 1;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img {margin-left: 0px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.first-type-icon {-moz-transform: rotate(-12deg); -webkit-transform: rotate(-12deg); -o-transform: rotate(-12deg); transform: rotate(-12deg); bottom: -3px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.second-first-type-icon {-moz-transform: rotate(-5deg); -webkit-transform: rotate(-5deg); -o-transform: rotate(-5deg); transform: rotate(-5deg);}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.second-last-type-icon {-moz-transform: rotate(5deg); -webkit-transform: rotate(5deg); -o-transform: rotate(5deg); transform: rotate(5deg);}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.last-type-icon {-moz-transform: rotate(12deg); -webkit-transform: rotate(12deg); -o-transform: rotate(12deg); transform: rotate(12deg); bottom: -3px;}.jimu-widget-add-data .add-file-pane .file-form {display: inline-block;}.jimu-widget-add-data .search-box2 {display: inline-block;}.jimu-widget-add-data .search-box2 {float: right;}.jimu-widget-add-data .search-box2 .search-textbox {vertical-align: middle; height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-box2 .btn {display: inline-block; height: 30px; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data.width-small .search-box2 .search-textbox {width: 150px;}.jimu-widget-add-data.width-small .add-file-pane .or:before,.jimu-widget-add-data.width-small .add-file-pane .or:after {width: 25%;}.jimu-widget-add-data.width-medium .search-box2 .search-textbox {width: 140px;}.jimu-widget-add-data.width-medium .filter-wrapper .sort-prompt,.jimu-widget-add-data.width-small .filter-wrapper .sort-prompt {display: none;}.jimu-widget-add-data.width-medium .search-pane .search-results-pane {padding: 5px 0;}.jimu-widget-add-data.width-medium .search-pane .item-card .item-card-inner {margin-bottom: 5px;}.jimu-widget-add-data.height-small .add-file-pane {padding-top: 15px; padding-bottom: 15px;}.jimu-widget-add-data.height-small .add-file-pane .drop-area {padding-top: 15px; padding-bottom: 25px;}.jimu-widget-add-data.height-small .add-file-pane .drop-area .supported-file-types {margin-bottom: 20px;}.jimu-widget-add-data .search-bbox-option .checkbox-inline,.jimu-widget-add-data .search-bbox-option .checkbox-inline input,.jimu-widget-add-data .search-pane .filter-placeholder {cursor: pointer;}.jimu-widget-add-data.width-small .search-bbox-option {max-width: 120px; font-size: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-add-data.width-small .search-bbox-option .switch-toggle-group {overflow: hidden; text-overflow: ellipsis;}.jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: 38px; margin-right: 25px;}.jimu-widget-add-data .search-pane .search-box .input-group {position: relative; display: table; border-collapse: separate;}.jimu-widget-add-data .search-pane .search-box .input-group \x3e * {display: table-cell; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-box .search-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-pane .search-box .btn {display: inline-block; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data .search-pane .search-box .btn-clear {border-color: transparent; background: transparent; position: absolute; left: -32px;}.jimu-widget-add-data .search-pane .search-box-placeholder,.jimu-widget-add-data .search-pane .filter-placeholder,.jimu-widget-add-data .search-pane .scope-placeholder {display: none;}.jimu-widget-add-data .search-pane .search-sort-options \x3e * {vertical-align: middle;}.jimu-widget-add-data .search-pane .search-sort-options label {font-weight: normal; font-size: 11px; color: #898989;}.jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: right; width: 24px; height: 24px; margin: 3px 0;}.jimu-widget-add-data .search-pane .search-sort-options .dropdown-toggle .sort-order-icon {float: none; padding: 0 5px;}.jimu-widget-add-data .search-pane .sort-order-icon {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px; background-image: url("images/sort-down-arrow.png");}.jimu-widget-add-data .search-pane .sort-order-icon.descending {background-image: url("images/sort-up-arrow.png");}.jimu-widget-add-data .search-pane .scope-options \x3e * {display: inline-block;}.jimu-widget-add-data .search-pane .checkbox-inline,.jimu-widget-add-data .search-pane .radio-inline {position: relative; padding-left: 21px; margin-right: 10px;}.jimu-widget-add-data .search-pane .checkbox-inline .dijitCheckBox,.jimu-widget-add-data .search-pane .radio-inline .dijitCheckBox {}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views {display: block; padding: 5px;}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views [class*\x3d"gd-icon-"] {margin-right: 10px; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-paging .pagination {margin: 0;}.jimu-widget-add-data .search-pane .search-paging,.jimu-widget-add-data .search-pane .search-result-count {display: inline-block; vertical-align: middle; line-height: 1;}.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span,.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:focus,.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:hover {color: inherit; border-color: transparent; background-color: transparent;}.jimu-widget-add-data .search-pane .pagination \x3e li.current-page \x3e span {padding-left: 15px; padding-right: 15px;}.jimu-widget-add-data .search-pane .pagination [class*\x3d" esri-icon-"],.jimu-widget-add-data .search-pane .pagination [class^\x3d"esri-icon-"] {position: relative; top: 1px;}.jimu-widget-add-data .search-pane .search-result-count {margin: 0 10px;}.jimu-widget-add-data.width-768 .item-card {width: 50%;}.jimu-widget-add-data.width-1200 .item-card {width: 33.3333333333%;}.jimu-widget-add-data.width-medium .search-pane .search-bar,.jimu-widget-add-data.width-small .search-pane .search-bar {padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn,.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: 0;}.jimu-rtl .jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn,.jimu-rtl .jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: auto; margin-right: 0;}.jimu-widget-add-data.width-medium .search-box-placeholder,.jimu-widget-add-data.width-small .search-box-placeholder,.jimu-widget-add-data.filter-placeholder-on .filter-placeholder {display: block; height: 30px; width: 30px; background-image: url("images/search.png"); background-position: center center; background-repeat: no-repeat; background-size: 12px;}.jimu-widget-add-data.width-medium .search-box,.jimu-widget-add-data.width-small .search-box {display: none; padding: 10px; position: absolute; top: 0; left: 0; right: 40px; background: #ffffff;}.jimu-widget-add-data.width-small .search-box {padding-top: 8px; padding-bottom: 8px;}.jimu-widget-add-data.width-medium .search-box .input-group,.jimu-widget-add-data.width-small .search-box .input-group {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-textbox,.jimu-widget-add-data.width-small .search-box .search-textbox {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-btn,.jimu-widget-add-data.width-small .search-box .search-btn {width: 1%; position: relative;}.jimu-widget-add-data.width-medium .search-box.show,.jimu-widget-add-data.width-small .search-box.show {display: block;}.jimu-widget-add-data.width-medium .search-box-placeholder,.jimu-widget-add-data.width-small .search-box-placeholder {margin: 0 0 8px;}.jimu-widget-add-data.width-medium .search-box-placeholder.opened,.jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close.png");}.jimu-widget-add-data.width-medium .filter-placeholder,.jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu.png");}.jimu-widget-add-data.width-medium .scope-placeholder,.jimu-widget-add-data.width-small .scope-placeholder {display: block; padding: 5px 10px 15px; color: #196fa6; font-weight: bold;}.jimu-widget-add-data.width-medium .scope-placeholder:focus,.jimu-widget-add-data.width-small .scope-placeholder:focus {text-decoration: none;}.jimu-widget-add-data.width-medium .scope-placeholder \x3e *,.jimu-widget-add-data.width-small .scope-placeholder \x3e * {vertical-align: middle;}.jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow {display: inline-block; background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data.width-medium .btn-group,.jimu-widget-add-data.filter-placeholder-on .filter-wrapper,.jimu-widget-add-data.width-small .btn-group {display: none;}.jimu-widget-add-data.width-medium .filter-wrapper.show,.jimu-widget-add-data.width-medium .btn-group.show,.jimu-widget-add-data.width-small .filter-wrapper.show,.jimu-widget-add-data.width-small .btn-group.show {display: block; position: absolute; right: 0; top: 91px; z-index: 10; padding: 5px 10px; background: #ffffff; border: 1px solid #cccccc; -webkit-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); -moz-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2);}.jimu-rtl .jimu-widget-add-data.width-medium .filter-wrapper.show,.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show,.jimu-rtl .jimu-widget-add-data.width-small .filter-wrapper.show,.jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: 0; right: auto;}.jimu-widget-add-data.width-medium .btn-group.show,.jimu-widget-add-data.width-small .btn-group.show {top: 48px; left: 0; padding: 0; right: auto; min-width: 50%;}.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show,.jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: auto; right: 0;}.jimu-widget-add-data.width-medium .btn-group.show .btn,.jimu-widget-add-data.width-small .btn-group.show .btn {display: block; width: 100%; padding: 10px 15px; border: 0; font-weight: normal;}.jimu-widget-add-data.width-medium .btn-group.show .btn:hover,.jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #f4f4f4;}.jimu-widget-add-data.width-medium .btn-group.show .btn.active,.jimu-widget-add-data.width-medium .btn-group.show .btn.active:hover,.jimu-widget-add-data.width-small .btn-group.show .btn.active,.jimu-widget-add-data.width-small .btn-group.show .btn.active:hover {background-color: #196fa6 !important; color: #fff !important;}.jimu-widget-add-data.width-small .jimu-tab3 .tab-item-td {padding-left: 20px; padding-right: 20px;}.jimu-widget-add-data.width-small .search-pane .search-bar {padding-top: 5px; padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin: 0; padding-left: 5px; padding-right: 5px; font-size: 11px;}.jimu-widget-add-data.width-small .search-pane .search-results-pane {padding: 0; overflow: hidden;}.jimu-widget-add-data.width-small .search-pane .item-card {padding-left: 0; padding-right: 0;}.jimu-widget-add-data.width-small .search-pane .item-card .item-card-inner {margin-bottom: 0; border-top: 0; border-left: 0; border-right: 0; border-bottom-color: #e0e0e0;}.add-data-widget-popup .search-type-option {display: block; margin-bottom: 10px;}.add-data-widget-popup .search-type-option,.add-data-widget-popup .search-type-option input {cursor: pointer;}.jimu-widget-add-data {position: absolute; top: 0; bottom: 0; left: 0; right: 0; padding-top: 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option,.jimu-widget-add-data .search-box {display: inline-block;}.jimu-widget-add-data .search-box,.jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options,.jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper,.jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging,.jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-widget-add-data .search-paging li.disabled a,.jimu-widget-add-data .search-paging li.disabled a:hover,.jimu-widget-add-data .search-paging li.disabled a:active,.jimu-widget-add-data .search-paging li.disabled a:focus {cursor: default; opacity: 0.35;}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .dijitDropDownButton {margin: 0;}.jimu-widget-add-data .dijitSelect,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {background: transparent; border: 0; padding: 7px 5px; color: #196fa6; font-weight: bold; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0;}.jimu-widget-add-data .dijitSelect .dijitButtonContents,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitButtonContents {border-color: transparent;}.jimu-widget-add-data .dijitSelect .dijitInputField,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitInputField {padding: 0 5px;}.jimu-widget-add-data .dijitSelect .dijitArrowButton,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitArrowButton {background: transparent; border: 0;}.jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 0;}.jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data-dialog {background-color: #FFFFFF !important; border-color: #555555 !important; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important; -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important; box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important;}.jimu-widget-add-data-dialog .dijitDialogPaneContent {border-top: 1px solid #cccccc;}.jimu-widget-add-data-dialog .dijitDialogTitleBar {background: none repeat scroll 0 0 rgba(0, 0, 0, 0); background-color: #FFFFFF; -moz-border-radius: 3px 3px 0 0; -webkit-border-radius: 3px 3px 0 0; border-radius: 3px 3px 0 0;}.jimu-widget-add-data-dialog .dijitDialogTitle {background-color: #FFFFFF; color: #000000; font-size: 16px; font-weight: bold;}.jimu-widget-add-data-dialog div.gap {margin-top: 20px;}.jimu-widget-add-data-dialog div.small-gap {margin-top: 4px;}.jimu-widget-add-data-dialog div.action-bar {margin-top: 10px;}.jimu-widget-add-data-dialog .url-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data-dialog .url-textbox-wide {width: 500px;}.jimu-widget-add-data-dialog .examples {font-size: 9px; font-style: italic; margin-top: 4px; margin-left: 4px; opacity: 0.5;}.jimu-widget-add-data .btn-link {color: #196fa6 !important;}.jimu-widget-add-data .switch-toggle-group {padding: 5px;}.jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: 36px; vertical-align: top;}.jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: -36px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox {height: 16px; width: 28px; border: 0 none; background: #e04f1d; position: relative; display: inline-block; cursor: pointer; -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox:before {content: ""; background: #f8f8f8; position: absolute; padding: 0; height: 12px; width: 12px; left: auto; right: 2px; top: 2px; z-index: 1; -webkit-transition: right 0.3s; -moz-transition: right 0.3s; -o-transition: right 0.3s; transition: right 0.3s; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%;}.jimu-widget-add-data .switch-toggle.dijitCheckBox input {width: 100%; height: 100%; position: absolute; left: 0; z-index: 2;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked {background: #50ad4e;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked:before {right: 14px;}.jimu-widget-add-data .panel-default \x3e .panel-heading {background-color: transparent; border-color: #e0e0e0;}.jimu-widget-add-data .panel-title {font-size: 16px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .panel-footer .btn + .btn {margin-left: 10px;}.jimu-widget-add-data .gp-panel {width: 300px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading {background-color: transparent; border-left: 1px solid rgba(0, 0, 0, 0.35); color: #efefef; height: 40px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .panel-title {font-weight: normal; line-height: 1.5;}.jimu-widget-add-data .gp-panel \x3e .panel-heading [class^\x3d"esri-icon-"],.jimu-widget-add-data .gp-panel \x3e .panel-heading [class*\x3d" esri-icon-"] {display: inline-block; margin-right: 10px; position: relative; top: 1px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {width: 20px; padding: 0; color: #efefef; float: right; margin-right: 0; font-size: 16px; line-height: 1.25; line-height: 20px; text-align: center;}.jimu-widget-add-data .gp-panel \x3e .panel-body {background-color: #f8f8f8; border-left: 1px solid #cccccc; position: absolute; top: 40px; bottom: 0; width: 100%; overflow: auto; padding: 0;}.jimu-widget-add-data .gp-panel .panel-section {background-color: #ffffff;}.jimu-widget-add-data .panel-section {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .panel-section .section-header {display: block; font-size: 16px; line-height: 1.25; line-height: 20px; padding: 10px 15px;}.jimu-widget-add-data .panel-section .section-header:after {content: ""; display: block; clear: both;}.jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"],.jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"],.jimu-widget-add-data .panel-section .section-header .btn {margin: 0 5px; float: right;}.jimu-widget-add-data .panel-section .section-header .btn {margin: 0; min-width: 80px;}.jimu-widget-add-data .panel-section .btn.section-header {border: 0; text-align: left; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-transition: all 0.25s ease; -moz-transition: all 0.25s ease; -o-transition: all 0.25s ease; transition: all 0.25s ease;}.jimu-widget-add-data .panel-section .btn.section-header:hover {background-color: #e2f1fb; text-decoration: none;}.jimu-widget-add-data .panel-section .btn.section-header:active,.jimu-widget-add-data .panel-section .btn.section-header:focus {background-color: #aadbfa; text-decoration: none;}.jimu-widget-add-data .panel-section .section-body {padding: 10px 15px;}.jimu-widget-add-data a, .add-url-pane a {display: block; color: #196fa6; text-decoration: none; line-height: 20px; padding: 10px 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option, .search-box {display: inline-block;}.jimu-widget-add-data .search-box,.jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options,.jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper,.jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging,.jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-rtl .jimu-widget-add-data .search-paging li {-moz-transform: rotate(180deg); -webkit-transform: rotate(180deg); -o-transform: rotate(180deg); transform: rotate(180deg);}.jimu-rtl .jimu-widget-add-data .search-paging li.current-page {-moz-transform: rotate(0); -webkit-transform: rotate(0); -o-transform: rotate(0); transform: rotate(0);}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .add-url-pane .url-textbox {width: 100%; font-size: 12px; color: #000000;}.jimu-widget-add-data .add-url-pane .examples {display: none; margin: 15px -15px 0; padding: 15px; font-size: 12px; color: #898989; word-wrap: break-word;}.jimu-widget-add-data .add-url-pane .examples \x3e div \x3e div {margin-bottom: 15px;}.jimu-widget-add-data .add-url-pane .examples.show {display: block;}.jimu-widget-add-data .jimu-tab3 \x3e .jimu-viewstack {position: absolute; top: 39px; left: 0px; right: 0; bottom: 0; padding-bottom: 40px;}.jimu-widget-add-data-footer {height: 40px; overflow: hidden; background-color: #f8f8f8; border-top: 1px solid #ccc; padding: 0 15px; color: #898989; font-size: 11px;}.jimu-widget-add-data-footer [class^\x3d"esri-icon-"],.jimu-widget-add-data-footer [class*\x3d" esri-icon-"] {line-height: 20px;}.jimu-widget-add-data-footer .layerlist-button {text-transform: uppercase;}.jimu-widget-add-data-footer .layerlist-button .esri-icon-layers {margin: 0 5px; vertical-align: middle; display: inline-block;}.jimu-widget-add-data-footer .message {display: block; color: #898989; line-height: 20px; padding: 10px 10px 10px 0; text-overflow: ellipsis; overflow: hidden; word-break: break-all; white-space: nowrap;}.jimu-widget-add-data.layerlist-show {overflow: hidden;}.jimu-widget-add-data.layerlist-show .jimu-tab3 {-webkit-filter: blur(5px); filter: blur(5px);}.jimu-widget-add-data.layerlist-show .add-data-layerlist--container {-moz-animation: slide-from-right .4s; -webkit-animation: slide-from-right .4s; animation: slide-from-right .4s;}.add-data-widget-layers {width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); position: absolute; top: 0; right: 0; z-index: 1;}.add-data-widget-layers {display: none;}.add-data-widget-layers.show {display: block;}.add-data-widget-layers .add-data-layerlist--container {background: #fff; position: absolute; top: 0; right: 0; width: 320px; height: 100%; -webkit-transition: width 0.4s ease; -moz-transition: width 0.4s ease; -o-transition: width 0.4s ease; transition: width 0.4s ease;}.width-small .add-data-widget-layers .add-data-layerlist--container {width: 100%;}.add-data-widget-layers .add-data-layerlist--container h2 {margin: 0; padding: 7px 15px; border-bottom: 1px solid #ccc; color: #898989; font-size: 14px; font-weight: normal; line-height: 2;}.add-data-layerlist--list {width: 100%; padding: 10px 15px; line-height: 20px; position: absolute; top: 45px; bottom: 40px; overflow: auto;}.add-data-layerlist--listitem {margin-bottom: 5px;}.add-data-layerlist--listitem:after {content: ""; display: table; clear: both;}.add-data-layerlist--listitem .remove-button {float: right; padding: 5px 10px;}.add-data-layerlist--listitem .layer-name {display: block; padding-top: 5px;}.add-data-widget-layers .add-data-layerlist--footer {width: 100%; position: absolute; bottom: 0;}.add-data-widget-layers .back-button {float: right; text-transform: uppercase;}.add-data-widget-layers .back-button i {display: inline-block; margin-left: 5px;}.add-data-widget-layers .no-data-message {color: #898989; padding: 25px; text-align: center;}.add-data-widget-popup {padding: 0;}.add-data-widget-popup .dijitTooltipConnector {display: none;}.add-data-widget-popup .dijitTooltipContainer {padding: 10px; border-color: #ccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup.dijitMenuPopup {-webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup .dijitMenu {border-color: #ccc;}.add-data-widget-popup .dijitMenu .dijitMenuItem td {padding: 10px 15px; border: 0;}.add-data-widget-popup .dijitMenu .dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitMenuItemActive td,.add-data-widget-popup .dijitMenu .dijitMenuItemSelected td {background-color: #f4f4f4; background-image: none;}.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemSelected td {background-color: #196fa6; background-image: none; color: #fff; font-weight: normal;}.LaunchpadTheme .jimu-widget-add-data.jimu-widget {position: absolute;}.LaunchpadTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 5px;}.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {color: #196fa6; font-size: inherit; letter-spacing: 0;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect,.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {background-color: transparent; border: 0;}.LaunchpadTheme .jimu-widget-add-data .secondary-pane .jimu-btn {background-color: #3b8fc4; border: 0;}.LaunchpadTheme .jimu-widget-add-data .secondary-pane .jimu-btn:hover {background-color: #2c6b93;}.DartTheme .jimu-widget-add-data .search-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-secondary {background: #3a3a3a;}.DartTheme .jimu-widget-add-data .secondary-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane-content {background-color: #222;}.DartTheme .jimu-tab3 .tab-item-td.jimu-state-active {background: #4C4C4C;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-separator,.DartTheme .jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #262626;}.DartTheme .jimu-widget-add-data .search-box2 .search-textbox {background: #393939; border: 0; -moz-border-radius: 2px; -webkit-border-radius: 2px; border-radius: 2px;}.DartTheme .jimu-widget-add-data.width-small .search-box2 .search-textbox {width: 100px;}.DartTheme .jimu-widget-add-data .search-box2 .btn {background: #393939; border: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card .item-card-inner {background: #4c4c4c; border-color: #787878;}.DartTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.DartTheme .jimu-widget-add-data.width-medium .filter-wrapper.show,.DartTheme .jimu-widget-add-data.width-medium .btn-group.show,.DartTheme .jimu-widget-add-data.width-small .filter-wrapper.show,.DartTheme .jimu-widget-add-data.width-small .btn-group.show {background: #393939; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); -moz-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .jimu-widget-add-data.width-medium .btn-group.show .btn:hover,.DartTheme .jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #222;}.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active,.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active,.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {color: #f8f8f8 !important;}.DartTheme .jimu-widget-add-data .search-pane .search-sort-options label {color: #a7a7a7 !important;}.DartTheme .jimu-widget-add-data .secondary-pane {border-bottom: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card div.info {color: #ddd !important;}.DartTheme .jimu-widget-add-data .search-pane .item-card .action-bar a,.DartTheme .jimu-widget-add-data .add-url-pane .action-bar a,.DartTheme .jimu-widget-add-data .add-file-pane .file-form label {color: #15a4fa !important;}.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {padding: 7px;}.DartTheme .jimu-widget-add-data .dijitSelect {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/search_white.png");}.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder.opened,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close_white.png");}.DartTheme.add-data-widget-popup .dijitTooltipContainer {color: #f8f8f8; background: #4c4c4c; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); -moz-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .add-data-widget-layers .add-data-layerlist--container {background-color: #4c4c4c;}.DartTheme .add-data-widget-layers .add-data-layerlist--container h2 {border-color: #262626;}.DartTheme .jimu-widget-add-data-footer,.DartTheme .add-data-widget-layers .add-data-layerlist--footer {background-color: transparent; border-top-color: #262626;}.DartTheme .jimu-widget-add-data .add-url-pane-container {background-color: transparent; border-color: transparent;}.DartTheme .jimu-widget-add-data .add-url-pane .action-bar a {padding-top: 0; padding-bottom: 0;}.DartTheme .jimu-widget-add-data .add-url-pane .action-bar .jimu-btn {min-width: 140px;}.DartTheme .jimu-widget-add-data .add-file-pane .drop-area {background: transparent; border-color: #ccc;}.DartTheme .jimu-widget-add-data.height-small .add-file-pane .drop-area {padding-left: 15px; padding-right: 15px;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card {float: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .thumbnail {float: right; margin-left: 10px; margin-right: 0;}.jimu-rtl .jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: auto; padding-right: 38px; margin-right: auto; margin-left: 25px;}.jimu-rtl .jimu-widget-add-data .search-box2 {float: left;}.jimu-rtl .jimu-widget-add-data .search-box2 .btn {margin-left: auto; margin-right: -1px;}.jimu-rtl .jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: left;}.jimu-rtl .jimu-widget-add-data .search-box, .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper,.jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: auto; padding-right: 36px;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: auto; margin-right: -36px;}.jimu-rtl .jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {float: left;}.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"],.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"],.jimu-rtl .jimu-widget-add-data .panel-section .section-header .btn {float: left;}.jimu-rtl .jimu-widget-add-data .search-box,.jimu-rtl .jimu-widget-add-data .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper,.jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}.jimu-widget-add-data .add-file-pane .or b {padding-left: 5px; padding-right: 0;}.jimu-rtl .jimu-widget-add-data .add-file-pane .drop-area a.drop-area-hint {left: 0; right: auto;}.jimu-rtl .add-data-widget-layers .add-data-layerlist--container {left: 0; right: auto;}.jimu-rtl .jimu-widget-add-data.layerlist-show .add-data-layerlist--container {-moz-animation: slide-from-left .4s; -webkit-animation: slide-from-left .4s; animation: slide-from-left .4s;}.jimu-rtl .add-data-layerlist--listitem .remove-button {float: left;}.jimu-rtl .add-data-widget-layers .back-button {float: left;}.jimu-rtl .add-data-widget-layers .back-button i {margin-left: 0; margin-right: 5px;}.jimu-rtl .add-data-widget-layers .back-button i.esri-icon-collapse:before {content: "\\e631";}.ar .esri-icon-question {-webkit-transform: rotateY(180deg); transform: rotateY(180deg); display: inline-block;}@-moz-keyframes updload-arrow-animation {0% {-moz-transform: translateY(0px);} 50% {-moz-transform: translateY(-10px);} 100% {-moz-transform: translateY(0px);}}@-webkit-keyframes updload-arrow-animation {0% {-webkit-transform: translateY(0px);} 50% {-webkit-transform: translateY(-10px);} 100% {-webkit-transform: translateY(0px);}}@keyframes updload-arrow-animation {0% {transform: translateY(0px);} 50% {transform: translateY(-10px);} 100% {transform: translateY(0px);}}@-moz-keyframes slide-from-right {0% {-moz-transform: translateX(50%); opacity: 0.5;} 100% {-moz-transform: translateX(0%); opacity: 1;}}@-webkit-keyframes slide-from-right {0% {-webkit-transform: translateX(50%); opacity: 0.5;} 100% {-webkit-transform: translateX(0%); opacity: 1;}}@keyframes slide-from-right {0% {transform: translateX(50%); opacity: 0.5;} 100% {transform: translateX(0%); opacity: 1;}}@-moz-keyframes slide-from-left {0% {-moz-transform: translateX(-50%); opacity: 0.5;} 100% {-moz-transform: translateX(0%); opacity: 1;}}@-webkit-keyframes slide-from-left {0% {-webkit-transform: translateX(-50%); opacity: 0.5;} 100% {-webkit-transform: translateX(0%); opacity: 1;}}@keyframes slide-from-left {0% {transform: translateX(-50%); opacity: 0.5;} 100% {transform: translateX(0%); opacity: 1;}}',
"url:widgets/AddData/config.json":'{\r\n  "numPerPage": 30,\r\n  "scopeOptions": {\r\n    "MyContent": {\r\n      "allow": true,\r\n      "label": null\r\n    },\r\n    "MyOrganization": {\r\n      "allow": true,\r\n      "label": null\r\n    },\r\n    "Curated": {\r\n      "allow": true,\r\n      "label": null,\r\n      "filter": null\r\n    },\r\n    "ArcGISOnline": {\r\n      "allow": true,\r\n      "label": null\r\n    }\r\n  },\r\n  "addFromUrl": {\r\n    "allow": true\r\n  },\r\n  "addFromFile": {\r\n    "allow": true,\r\n    "maxRecordCount": 1000\r\n  }\r\n}\r\n',
"*now":function(p){p(['dojo/i18n!*preload*widgets/AddData/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/aspect dojo/Deferred dojo/dom-class jimu/portalUrlUtils jimu/portalUtils jimu/tokenUtils jimu/BaseWidget jimu/dijit/TabContainer3 dijit/_WidgetsInTemplateMixin ./search/SearchContext ./search/util ./search/SearchPane ./search/AddFromUrlPane ./search/AddFromFilePane ./search/LayerListPane dojo/_base/array".split(" "),function(p,g,h,m,d,u,a,l,r,w,D,B,G,y,C,A,E,H,f){return p([w,B],{name:"AddData",baseClass:"jimu-widget-add-data",batchGeocoderServers:null,
isPortal:!1,_isOpen:!1,_searchOnOpen:!1,tabContainer:null,searchPane:null,addFromUrlPane:null,addFromFilePane:null,postCreate:function(){this.inherited(arguments)},startup:function(){if(!this._started){var a=this,d=arguments;this._getUser().then(function(e){a._checkConfig();a._initTabs();return a._initContext(e)}).then(function(){a.inherited(d);a.tabContainer?a.tabContainer.startup():a.searchPane?a.searchPane.startup():a.addFromUrlPane?a.addFromUrlPane.startup():a.addFromFilePane&&a.addFromFilePane.startup();
a._initFooter(a.tabContainer,{searchWidget:a.searchPane,addFromUrlWidget:a.addFromUrlPane,addFromFileWidget:a.addFromFilePane});a._initListeners();a.resize()}).otherwise(function(e){console.warn("AddData.startup error:",e);a.inherited(d);a.resize()})}},_checkConfig:function(){this.config||(this.config={});var a=function(a,e){var d=a[e];d||(d=a[e]={allow:!0,label:null});"boolean"!==typeof d.allow&&(d.allow=!0);"Curated"!==e||"string"===typeof d.filter&&0!==g.trim(d.filter).length||(d.allow=!1)},d=
this.config;d.scopeOptions||(d.scopeOptions={});var f=d.scopeOptions;a(f,"MyContent");a(f,"MyOrganization");a(f,"Curated");a(f,"ArcGISOnline");a(d,"addFromUrl");a(d,"addFromFile")},getSharingUrl:function(){var e=l.getPortal(this.appConfig.portalUrl);return a.getSharingUrl(e.portalUrl)},_getUser:function(){var a=new d,f=this.appConfig.portalUrl;r.userHaveSignInPortal(f)?l.getPortal(f).getUser().then(function(d){a.resolve(d)}).otherwise(function(d){console.warn("AddData._getUser error:",d);a.resolve(null)}):
a.resolve(null);return a},_initBatchGeocoder:function(a,d){var e=!1,g=/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/ig,h=/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/ig,l=a&&a.helperServices&&a.helperServices.geocode||[],b,c,m=[];d&&d.privileges&&(e=-1<f.indexOf(d.privileges,"premium:user:geocode"));f.forEach(l,function(d){b=!!d.url.match(g);c=!!d.url.match(h);(b&&!a.isPortal&&e||c||d.batch)&&m.push({isWorldGeocodeServer:b||c,isWorldGeocodeServerProxy:c,label:d.name,
value:d.url,url:d.url,name:d.name})});this.batchGeocoderServers=m},_initContext:function(e){var f=new d,g=!0,h=y.checkMixedContent("http://www.arcgis.com"),m=this.config.scopeOptions,p=e&&"string"===typeof e.username&&0<e.username.length,b=new G,c=l.getPortal(this.appConfig.portalUrl);this.isPortal=c.isPortal;b.portal=c;e&&"string"===typeof e.orgId&&0<e.orgId.length&&(b.orgId=e.orgId);p?b.username=e.username:m.MyContent.allow=!1;this.searchPane&&(this.searchPane.searchContext=b,this.searchPane.portal=
c);this._initBatchGeocoder(c,e);if(c.isPortal)try{var n=a.getSharingUrl(c.portalUrl)+"/kml",n=n.replace("/sharing/rest/kml","/sharing/kml");window.esri.config.defaults.kmlService=n;window.esri.config.defaults.geoRSSService=n.replace("/kml","/rss")}catch(I){console.error(I)}var k=this.nls.search.loadError+h,q=m.ArcGISOnline;b.allowArcGISOnline=q.allow;if(c.isPortal&&b.allowArcGISOnline){var r=l.getPortal(h);r?r.helperServices||(g=!1,r.loadSelfInfo().then(function(){r.helperServices?b.arcgisOnlinePortal=
r:(console.warn(k),b.allowArcGISOnline=!1,q.allow=!1);f.resolve()}).otherwise(function(a){b.allowArcGISOnline=!1;q.allow=!1;console.warn(k);console.warn(a);f.resolve()})):(console.warn(k),b.allowArcGISOnline=!1,q.allow=!1)}else!p&&!c.isPortal&&m.MyOrganization.allow&&m.ArcGISOnline.allow&&(m.MyOrganization.allow=!1);g&&f.resolve();return f},_initFooter:function(a,d){if(a){var e=d.searchWidget,f=!1;e&&e.footerNode&&e.footerNode.nodeName&&(f=!0);d=this.footerContainer=document.createElement("DIV");
d.className=this.baseClass+"-footer";f&&d.appendChild(e.footerNode);var l=document.createElement("A");l.className="layerlist-button jimu-float-trailing";l.href="#";l.innerHTML="\x3cspan class\x3d'esri-icon-layers'\x3e\x3c/span\x3e"+this.nls.layerList.caption;this.own(h(l,"click",g.hitch(this,function(a){a.preventDefault();this.showLayers()})));d.appendChild(l);var m=this.messageNode=document.createElement("SPAN");m.className="message";d.appendChild(m);a=a.containerNode||a.domNode||a;a.nodeName&&a.appendChild(d);
this.own(h(this.tabContainer,"tabChanged",g.hitch(this,function(a){this._setStatus("");f&&(e.footerNode.style.display=a===this.nls.tabs.search?"":"none");this.nls.tabs.search===a?(f&&(e.footerNode.style.display=""),m.style.display="none"):(f&&(e.footerNode.style.display="none"),m.style.display="")})))}},_initListeners:function(){var a=this;this.map&&this.own(this.map.on("extent-change",function(){try{a.searchPane&&a.searchPane.bboxOption.bboxToggle.get("checked")&&(a._isOpen?a.searchPane.search():
a._searchOnOpen=!0)}catch(t){console.warn(t)}}))},_initTabs:function(){var a=this.config,d=[],f=!!(window.File&&window.FileReader&&window.FormData),g=!1,h=a.scopeOptions,l=function(a){g||h&&h[a]&&h[a].allow&&(g=!0)};l("MyContent");l("MyOrganization");l("Curated");l("ArcGISOnline");g&&(this.searchPane=new C({wabWidget:this},this.searchNode),d.push({title:this.nls.tabs.search,content:this.searchPane.domNode}));a.addFromUrl&&a.addFromUrl.allow&&(this.addFromUrlPane=new A({wabWidget:this},this.urlNode),
d.push({title:this.nls.tabs.url,content:this.addFromUrlPane.domNode}));f&&a.addFromFile&&a.addFromFile.allow&&(this.addFromFilePane=new E({wabWidget:this},this.fileNode),d.push({title:this.nls.tabs.file,content:this.addFromFilePane.domNode}));var b=this;if(0<d.length){this.tabContainer=new D({average:!0,tabs:d},this.tabsNode);try{1===d.length&&this.tabContainer.controlNode&&this.tabContainer.containerNode&&(this.tabContainer.controlNode.style.display="none",this.tabContainer.containerNode.style.top=
"0px")}catch(c){}this.own(m.after(this.tabContainer,"selectTab",function(a){b.searchPane&&a===b.nls.tabs.search&&b.searchPane.resize()},!0))}else 0===d.length&&this.tabsNode.appendChild(document.createTextNode(this.nls.noOptionsConfigured))},_setStatus:function(a){this.messageNode&&(y.setNodeText(this.messageNode,a),this.messageNode.title=a)},onClose:function(){this._isOpen=!1},onOpen:function(){var a=this.searchPane&&this._searchOnOpen;this._isOpen=!0;this._searchOnOpen=!1;this.resize();a&&this.searchPane.search()},
resize:function(){var a=this.domNode.clientWidth,d=this.domNode.clientHeight;1E3<a?(u.remove(this.domNode,"width-768"),u.add(this.domNode,"width-1200")):768<a?(u.remove(this.domNode,"width-1200"),u.add(this.domNode,"width-768")):u.remove(this.domNode,["width-768","width-1200"]);420>a?(u.remove(this.domNode,"width-medium"),u.add(this.domNode,"width-small")):750>a?(u.remove(this.domNode,"width-small"),u.add(this.domNode,"width-medium")):u.remove(this.domNode,["width-small","width-medium"]);340>a?u.add(this.domNode,
"filter-placeholder-on"):u.remove(this.domNode,"filter-placeholder-on");400>d?u.add(this.domNode,"height-small"):u.remove(this.domNode,"height-small");this.searchPane&&this.searchPane.resize()},showLayers:function(){this.layerListPane||(this.layerListPane=new H({wabWidget:this}),this.layerListPane.placeAt(this.domNode));this.layerListPane.show()}})});