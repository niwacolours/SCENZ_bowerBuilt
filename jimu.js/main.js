//>>built
require({cache:{"jimu/ConfigManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dojo/Deferred dojo/on ./utils ./WidgetManager ./shared/AppVersionManager ./ConfigLoader ./tokenUtils ./dijit/AGOLLoading ./portalUtils esri/config esri/tasks/GeometryService".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z){function M(a,k){var e=m.clone(a),p=r.widgetProperties;"undefined"===typeof k&&(k=!1);delete e.mode;delete e.configWabVersion;r.visitElement(e,
function(a,n){a.widgets?(delete a.isOnScreen,delete a.gid,"jimu.js/images/group_icon.png"===a.icon&&delete a.icon,delete a.openType,n.isOnScreen&&a.panel&&r.isEqual(a.panel,e.widgetOnScreen.panel)&&delete a.panel):(a.icon&&a.icon===a.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion&&delete a.icon,delete a.panel,delete a.folderUrl,delete a.amdFolder,delete a.thumbnail,delete a.configFile,delete a.gid,delete a.isOnScreen,delete a.isRemote,delete a.featureActions,p.forEach(function(e){delete a[e]}),
k?"undefined"===typeof a.openAtStart&&(a.openAtStart=!1):(a.visible&&delete a.visible,a.manifest&&a.label===a.manifest.label&&delete a.label,a.isDefaultConfig&&(delete a.config,delete a.isDefaultConfig)),delete a.manifest,a.itemId&&delete a.uri)});delete e.rawAppConfig;delete e._ssl;delete e.getConfigElementById;delete e.getConfigElementsByName;delete e.processNoUriWidgets;delete e.addElementId;delete e.getCleanConfig;delete e.visitElement;delete e.agolConfig;delete e._itemData;delete e.oldWabVersion;
delete e.titleColor;return e}var I=null,L;L=B(null,{urlParams:null,appConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(e){this.urlParams=e||{};this.listenBuilderEvents();this.versionManager=new A;this.widgetManager=n.getInstance();this.configLoader=a.getInstance(this.urlParams,{versionManager:this.versionManager});"config"===this.urlParams.mode&&window.parent.setConfigViewerTopic&&m.isFunction(window.parent.setConfigViewerTopic)&&window.parent.setConfigViewerTopic(g);
"preview"===this.urlParams.mode&&window.parent.setPreviewViewerTopic&&m.isFunction(window.parent.setPreviewViewerTopic)&&window.parent.setPreviewViewerTopic(g);r.isMobileUa()||t(window,"resize",m.hitch(this,this._onWindowResize));t(window,"orientationchange",m.hitch(this,this._onOrientationChange))},listenBuilderEvents:function(){g.subscribe("builder/widgetChanged",m.hitch(this,this._onWidgetChanged));g.subscribe("builder/groupChanged",m.hitch(this,this._onGroupChanged));g.subscribe("builder/layoutDefinitionChanged",
m.hitch(this,this._onLayoutDefinitionChanged));g.subscribe("builder/onScreenGroupsChanged",m.hitch(this,this._onOnScreenGroupsChanged));g.subscribe("builder/widgetPoolChanged",m.hitch(this,this._onWidgetPoolChanged));g.subscribe("builder/openAtStartChange",m.hitch(this,this._onOpenAtStartChanged));g.subscribe("builder/onScreenOrderChanged",m.hitch(this,this._onScreenOrderChanged));g.subscribe("builder/mapContentModified",m.hitch(this,this._onMapContentModified));g.subscribe("builder/mapChanged",m.hitch(this,
this._onMapChanged));g.subscribe("builder/mapOptionsChanged",m.hitch(this,this._onMapOptionsChanged));g.subscribe("builder/mapRefreshIntervalChanged",m.hitch(this,this._onMapRefreshIntervalChanged));g.subscribe("builder/appAttributeChanged",m.hitch(this,this._onAppAttributeChanged));g.subscribe("builder/dataSourceChanged",m.hitch(this,this._onDataSourceChanged));g.subscribe("builder/setAppConfig",m.hitch(this,this._onAppConfigSet));g.subscribe("builder/themeChanged",m.hitch(this,this._onThemeChanged));
g.subscribe("builder/layoutChanged",m.hitch(this,this._onLayoutChanged));g.subscribe("builder/styleChanged",m.hitch(this,this._onStyleChanged));g.subscribe("builder/syncExtent",m.hitch(this,this._onSyncExtent));g.subscribe("builder/loadingPageChanged",m.hitch(this,this._onLoadingPageChanged));g.subscribe("builder/templateConfigChanged",m.hitch(this,this._onTemplateConfigChanged));g.subscribe("builder/appProxyForMapChanged",m.hitch(this,this._onAppProxyForMapChanged));g.subscribe("builder/appProxyForUrlChanged",
m.hitch(this,this._onAppProxyForUrlChanged));g.subscribe("builder/sharedThemeChanged",m.hitch(this,this._onSharedThemeChanged))},loadConfig:function(){if("preview"!==this.urlParams.mode&&"config"!==this.urlParams.mode){var a=new e;a.placeAt(window.jimuConfig.layoutId);return this.configLoader.loadConfig().then(m.hitch(this,function(e){this.portalSelf=this.configLoader.portalSelf;this.appConfig=this._addDefaultValues(e);console.timeEnd("Load Config");window.appInfo.isRunInMobile=r.inMobileSize();e=
this.getAppConfig();a.destroy();g.publish("appConfigLoaded",e);return e}),m.hitch(this,function(e){a.destroy();console.error(e);e&&e.message&&"string"===typeof e.message&&this._showErrorMessage(e.message)}))}},_showErrorMessage:function(a){x.create("div",{"class":"app-error",innerHTML:r.sanitizeHTML(a)},document.body);x.setStyle(jimuConfig.loadingId,"display","none")},getAppConfig:function(){var a;window.appInfo.isRunInMobile?(a=m.clone(this._getMobileConfig(this.appConfig)),a._originConfig=m.clone(this.appConfig)):
a=m.clone(this.appConfig);a.getConfigElementById=function(a){return r.getConfigElementById(this,a)};a.getConfigElementsByName=function(a){return r.getConfigElementsByName(this,a)};a.getCleanConfig=function(a){return this._originConfig?M(this._originConfig,a):M(this,a)};a.visitElement=function(a){r.visitElement(this,a)};return a},_onOrientationChange:function(){this.appConfig&&g.publish("appConfigChanged",this.getAppConfig(),"layoutChange")},_onWindowResize:function(){var a=r.inMobileSize();window.appInfo.isRunInMobile!==
a&&(window.appInfo.isRunInMobile=a,this.appConfig&&g.publish("appConfigChanged",this.getAppConfig(),"layoutChange"))},_getMobileConfig:function(a){return r.mixinAppConfigPosition(a,a.mobileLayout)},_updateDataSourceForWidget:function(a){this._deleteDataSourcesFromWidget(a);this._addDataSourcesForWidget(a)},_deleteDataSourcesFromWidget:function(a){for(var e in this.appConfig.dataSource.dataSources)e.startWith("widget~"+a.id+"~")&&delete this.appConfig.dataSource.dataSources[e]},_addDataSourcesForWidget:function(a){y.forEach(a.provideDataSources,
function(e){var k="widget~"+a.id+"~"+e.id;e.id=k;this.appConfig.dataSource.dataSources[k]=e},this);delete a.provideDataSources},_addIdForWidgets:function(a){var e=0,k;this.getAppConfig().visitElement(function(a){if(a.id){a.id=a.id.replace(/\//g,"_");var p=a.id.lastIndexOf("_");-1<p&&(k=a.id.substr(p+1),e=Math.max(e,k))}});y.forEach(a,function(a){a.id||(e++,a.id=a.itemId?a.itemId+"_"+e:a.uri?a.uri.replace(/\//g,"_")+"_"+e:"_"+e)})},_onWidgetChanged:function(a){var e=r.reCreateObject(a);a=r.getConfigElementById(this.appConfig,
a.id);this._updateDataSourceForWidget(e);!1!==e.inPanel||a.uri||(e.closeable=!0);for(var k in e)a[k]=e[k];delete a.isDefaultConfig;this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);g.publish("appConfigChanged",this.getAppConfig(),"widgetChange",e)},_onGroupChanged:function(a){var e=r.reCreateObject(a);a=r.getConfigElementById(this.appConfig,a.id);this._handleDataSourceForWidgets(a,e);for(var k in e)a[k]=e[k];this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);
g.publish("appConfigChanged",this.getAppConfig(),"groupChange",e)},_handleDataSourceForWidgets:function(a,e){var k=y.filter(e.widgets,function(e){return e.id?0===y.filter(a.widgets,function(a){return e.id===a.id}).length:!0},this);this._addIdForWidgets(k);y.forEach(k,function(a){this._addDataSourcesForWidget(a)},this);k=y.filter(a.widgets,function(a){return 0===y.filter(e.widgets,function(e){return e.id===a.id}).length},this);y.forEach(k,function(a){this._deleteDataSourcesFromWidget(a)},this);y.forEach(e.widgets,
function(e){y.forEach(a.widgets,function(a){e.id===a.id&&e.provideDataSources&&this._updateDataSourceForWidget(e)},this)},this)},_onWidgetPoolChanged:function(a){var e=r.reCreateObject(a);this._handleDataSourceForWidgetsSection(this.appConfig.widgetPool,e);1===this.widgetManager.getControllerWidgets().length?(this.appConfig.widgetPool.widgets=e.widgets,this.appConfig.widgetPool.groups=e.groups):(a=r.getConfigElementById(this.appConfig,e.controllerId),y.forEach(a.controlledWidgets,function(a){this._removeWidgetOrGroupFromPoolById(this.appConfig,
a)},this),y.forEach(a.controlledGroups,function(a){this._removeWidgetOrGroupFromPoolById(this.appConfig,a)},this),this.appConfig.widgetPool.widgets="undefined"===typeof this.appConfig.widgetPool.widgets?e.widgets:this.appConfig.widgetPool.widgets.concat(e.widgets),this.appConfig.widgetPool.groups="undefined"===typeof this.appConfig.widgetPool.groups?e.groups:this.appConfig.widgetPool.groups.concat(e.groups),a.controlledWidgets=y.map(e.widgets,function(a){return a.id}),a.controlledGroups=y.map(e.groups,
function(a){return a.id}));this.configLoader.addNeedValues(this.appConfig);this.configLoader.loadAndUpgradeAllWidgetsConfig(this.appConfig).then(m.hitch(this,function(a){this.appConfig=a;this._addDefaultValues(this.appConfig);g.publish("appConfigChanged",this.getAppConfig(),"widgetPoolChange",e)}))},_handleDataSourceForWidgetsSection:function(a,e){var k=e.widgets;y.forEach(e.groups,function(a){k=k.concat(a.widgets)},this);var p=a.widgets;y.forEach(a.groups,function(a){p=p.concat(a.widgets)},this);
this._handleDataSourceForWidgets({widgets:p},{widgets:k})},_removeWidgetOrGroupFromPoolById:function(a,e){y.some(a.widgetPool.widgets,function(k,p){if(k.id===e)return a.widgetPool.widgets.splice(p,1),!0});y.some(a.widgetPool.groups,function(k,p){if(k.id===e)return a.widgetPool.groups.splice(p,1),!0})},_onOpenAtStartChanged:function(a){var e=r.reCreateObject(a),k=this.appConfig;a.isOnScreen?(k=k.widgetOnScreen&&k.widgetOnScreen.widgets)&&0<k.length&&y.forEach(k,m.hitch(this,function(e){e.id===a.id?
e.openAtStart=!e.openAtStart:delete e.openAtStart})):((k=k.widgetPool)&&k.groups&&0<k.groups.length&&y.forEach(k.groups,m.hitch(this,function(e){e.id===a.id?e.openAtStart=!e.openAtStart:delete e.openAtStart})),k&&k.widgets&&0<k.widgets.length&&y.forEach(k.widgets,m.hitch(this,function(e){e.id===a.id?e.openAtStart=!e.openAtStart:delete e.openAtStart})));g.publish("appConfigChanged",this.getAppConfig(),"openAtStartChange",e)},_onScreenOrderChanged:function(a){var e=r.reCreateObject(a);y.forEach(this.appConfig.widgetOnScreen.widgets,
function(a){a.isController||(!1!==a.inPanel||!0!==a.closeable)&&!0!==a.inPanel&&a.uri||y.some(e,function(e){if(a.id===e.id)return a.position=e.position,!0})},this);g.publish("appConfigChanged",this.getAppConfig(),"onScreenOrderChange",e)},_onAppAttributeChanged:function(a){a=r.reCreateObject(a);m.mixin(this.appConfig,a);this.configLoader.processProxy(this.appConfig);this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);g.publish("appConfigChanged",this.getAppConfig(),
"attributeChange",a)},_onDataSourceChanged:function(a){var e=r.reCreateObject(a);this.appConfig.dataSource=e;g.publish("appConfigChanged",this.getAppConfig(),"dataSourceChange",a)},_onLoadingPageChanged:function(a){a=r.reCreateObject(a);var e;"backgroundColor"in a?this.appConfig.loadingPage.backgroundColor=a.backgroundColor:"backgroundImage"in a?(e=this.appConfig.loadingPage.backgroundImage||{},this.appConfig.loadingPage.backgroundImage=m.mixin(e,a.backgroundImage)):"loadingGif"in a&&(e=this.appConfig.loadingPage.loadingGif||
{},this.appConfig.loadingPage.loadingGif=m.mixin(e,a.loadingGif));this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);g.publish("appConfigChanged",this.getAppConfig(),"loadingPageChange",a)},_onAppProxyForMapChanged:function(a){a=r.reCreateObject(a);"appProxy"in this.appConfig.map?this.appConfig.map.appProxy.mapItemId!==a.mapItemId?this.appConfig.map.appProxy=a:y.forEach(a.proxyItems,m.hitch(this,function(a){if(!y.some(this.appConfig.map.appProxy.proxyItems,function(e){if(e.sourceUrl===
a.sourceUrl)return e.useProxy=a.useProxy,e.proxyUrl=a.proxyUrl||"",e.proxyId=a.proxyId||"",isNaN(a.hitsPerInterval)||(e.hitsPerInterval=a.hitsPerInterval),isNaN(a.intervalSeconds)||(e.intervalSeconds=a.intervalSeconds),!0})&&a.useProxy&&a.proxyUrl){var e=this.appConfig.map.appProxy.proxyItems||[];e.push(a);this.appConfig.map.appProxy.proxyItems=e}})):this.appConfig.map.appProxy=a;g.publish("appConfigChanged",this.getAppConfig(),"appProxyChange",a)},_onAppProxyForUrlChanged:function(a){a=r.reCreateObject(a);
this.appConfig.appProxies=a;g.publish("appConfigChanged",this.getAppConfig(),"appProxyChange",a)},_onTemplateConfigChanged:function(a){a=r.reCreateObject(a);this.appConfig.templateConfig=a;this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);g.publish("appConfigChanged",this.getAppConfig(),"templateConfigChange",a)},_onMapContentModified:function(){g.publish("mapContentModified")},_onMapChanged:function(a){var e=r.reCreateObject(a);this.appConfig.map.mapOptions&&
r.deleteMapOptions(this.appConfig.map.mapOptions);this.appConfig.map.mapRefreshInterval={useWebMapRefreshInterval:!0};m.mixin(this.appConfig.map,e);this._deleteDataSourcesFromMap();this.configLoader.addNeedValues(this.appConfig);this.configLoader.loadAndUpgradeAllWidgetsConfig(this.appConfig).then(m.hitch(this,function(a){this.appConfig=a;this._addDefaultValues(this.appConfig);g.publish("appConfigChanged",this.getAppConfig(),"mapChange",e)}))},_deleteDataSourcesFromMap:function(){y.forEach(Object.keys(this.appConfig.dataSource.dataSources),
function(a){a.startWith("map")&&delete this.appConfig.dataSource.dataSources[a]},this)},_onMapOptionsChanged:function(a){a=r.reCreateObject(a);this.appConfig.map.mapOptions||(this.appConfig.map.mapOptions={});m.mixin(this.appConfig.map.mapOptions,a);g.publish("appConfigChanged",this.getAppConfig(),"mapOptionsChange",a)},_onMapRefreshIntervalChanged:function(a){a=r.reCreateObject(a);this.appConfig.map.mapRefreshInterval||(this.appConfig.map.mapRefreshInterval={});m.mixin(this.appConfig.map.mapRefreshInterval,
a);this.appConfig.map.mapRefreshInterval.useWebMapRefreshInterval&&delete this.appConfig.map.mapRefreshInterval.minutes;g.publish("appConfigChanged",this.getAppConfig(),"mapRefreshIntervalChange",a)},_onThemeChanged:function(a){this._getAppConfigFromTheme(a).then(m.hitch(this,function(e){var k=m.clone(this.appConfig.widgetOnScreen);this.appConfig=e;this._handleDataSourceForWidgetsSection(k,{});g.publish("appConfigChanged",this.getAppConfig(),"themeChange",a.getName())}))},_onLayoutChanged:function(a){this.appConfig=
r.mixinAppConfigPosition(this.appConfig,a.layoutConfig);this.appConfig.layoutDefinition=a.layoutConfig.layoutDefinition;this.configLoader.addNeedValues(this.appConfig);this._addDefaultValues(this.appConfig);g.publish("appConfigChanged",this.getAppConfig(),"layoutChange",a.name)},_onStyleChanged:function(a){this.appConfig.theme.styles=this._genStyles(this.appConfig.theme.styles,a.name);a.isCustom?this.appConfig.theme.customStyles={mainBackgroundColor:a.styleColor}:(delete this.appConfig.theme.customStyles,
delete this.appConfig.titleColor,this.appConfig.theme.sharedTheme={isPortalSupport:this.appConfig.theme.sharedTheme.isPortalSupport,useHeader:!1,useLogo:!1});g.publish("appConfigChanged",this.getAppConfig(),"styleChange",a.name)},_onOnScreenGroupsChanged:function(a){a=r.reCreateObject(a);this.appConfig.widgetOnScreen.groups=a.groups;g.publish("appConfigChanged",this.getAppConfig(),"onScreenGroupsChange",a.groups)},_onLayoutDefinitionChanged:function(a){a=r.reCreateObject(a);r.isEqual(this.appConfig.layoutDefinition,
a.layoutDefinition)||(this.appConfig.layoutDefinition=a.layoutDefinition,this.appConfig.widgetOnScreen.groups=r.handleGridLayoutOnScreenGroupChange(this.appConfig.widgetOnScreen.groups,a.groupIds),this.configLoader.addNeedValues(this.appConfig),this._addDefaultValues(this.appConfig),g.publish("appConfigChanged",this.getAppConfig(),"layoutDefinitionChange",a.layoutDefinition))},_onSharedThemeChanged:function(a){var e=this.appConfig.theme.sharedTheme;a=r.reCreateObject(a);a.useHeader&&!e.useHeader&&
(this.portalSelf.portalProperties&&this.portalSelf.portalProperties.sharedTheme?(this.appConfig.theme.customStyles={mainBackgroundColor:this.portalSelf.portalProperties.sharedTheme.header.background},this.appConfig.titleColor=this.portalSelf.portalProperties.sharedTheme.header.text,this._onAppAttributeChanged({titleColor:this.appConfig.titleColor})):console.error("Portal does not support sharedTheme."));!a.useHeader&&e.useHeader&&(delete this.appConfig.titleColor,this._onAppAttributeChanged({titleColor:this.appConfig.titleColor}));
a.useLogo&&!e.useLogo&&(this.portalSelf.portalProperties&&this.portalSelf.portalProperties.sharedTheme?(this.appConfig.logo=this.portalSelf.portalProperties.sharedTheme.logo.small?this.portalSelf.portalProperties.sharedTheme.logo.small:"images/app-logo.png",this.appConfig.logoLink=this.portalSelf.portalProperties.sharedTheme.logo.link,this._onAppAttributeChanged({logo:this.appConfig.logo,logoLink:this.appConfig.logoLink})):console.error("Portal does not support sharedTheme."));!a.useLogo&&e.useLogo&&
this._onAppAttributeChanged({logo:this.appConfig.logo});m.mixin(e,a);g.publish("appConfigChanged",this.getAppConfig(),"sharedThemeChange",a)},_onSyncExtent:function(a){g.publish("syncExtent",a)},_genStyles:function(a,e){var k=[];k.push(e);y.forEach(a,function(a){0>k.indexOf(a)&&k.push(a)});return k},_getAppConfigFromTheme:function(a){var e=new w,k,p=[],n=this.getAppConfig().getCleanConfig();n.mode=this.urlParams.mode;y.forEach(n.widgetPool.groups,function(a){delete a.panel},this);if(a.appConfig)k=
m.clone(a.appConfig),k.map=n.map,k.map.position=a.appConfig.map.position,this._copyPoolToThemePool(n,k),k.links=n.links,k.title=n.title,k.subtitle=n.subtitle,k.logo=n.logo;else{var g=a.getCurrentLayout(),p=a.getCurrentStyle();k=m.clone(n);g=m.clone(g.layoutConfig);k.widgetOnScreen=g.widgetOnScreen;g.widgetPool&&(y.forEach(g.widgetPool.widgets,function(a){a.isPreconfiguredInTheme=!0}),y.forEach(g.widgetPool.groups,function(a){a.isPreconfiguredInTheme=!0}));this._copyPoolToThemePool(n,g);k.widgetPool=
g.widgetPool;g.map&&g.map.position&&(k.map.position=g.map.position);k.mobileLayout=g.mobileLayout;k.layoutDefinition=g.layoutDefinition;p=this._genStyles(y.map(a.getStyles(),function(a){return a.name}),p.name);k.theme={name:a.getName(),styles:p,version:a.getVersion()};this.portalSelf.portalProperties&&this.portalSelf.portalProperties.sharedTheme?(k.theme.sharedTheme={useHeader:!0,useLogo:!0,isPortalSupport:!0},k.theme.customStyles={mainBackgroundColor:this.portalSelf.portalProperties.sharedTheme.header.background}):
(k.theme.sharedTheme={useHeader:!1,useLogo:!1,isPortalSupport:!1},k.theme.customStyles={mainBackgroundColor:""});k.titleColor=n.titleColor;k.logoLink=n.logoLink}this.configLoader.addNeedValues(k);this.configLoader.loadWidgetsManifest(k).then(m.hitch(this,function(a){return this.configLoader.loadAndUpgradeAllWidgetsConfig(a)})).then(m.hitch(this,function(){this._addDefaultValues(k);e.resolve(k)}));return e},_copyPoolToThemePool:function(a,e){var k=a.widgetPool;e.widgetPool||(e.widgetPool={});a=e.widgetPool;
var p=y.filter(a.widgets,function(a){if(a.isPreconfiguredInTheme||!y.some(k.widgets,function(e){return e.name===a.name}))return!0}),n=y.filter(a.groups,function(a){return a.isPreconfiguredInTheme}),g=y.filter(k.widgets,function(a){return!a.isPreconfiguredInTheme}),u=y.filter(k.groups,function(a){return!a.isPreconfiguredInTheme}),g=this._getPoolWidgetsWithoutDuplicated(g,e.widgetOnScreen.widgets||[]);a.widgets=g.concat(p);a.groups=u.concat(n)},_getPoolWidgetsWithoutDuplicated:function(a,e){for(var k=
m.clone(a),p=this.getAppConfig(),n=a.length-1;0<=n;n--)for(var g=e.length-1;0<=g;g--)if(e[g].uri){var u=e[g].name;u||(u=r.getWidgetNameFromUri(e[g].uri));var z=p.getConfigElementById(a[n].id);a[n]&&a[n].name===u&&!1===z.supportMultiInstance&&(console.log("Widget",a[n].name,"is not copied to new theme because this widget exists in new theme."),k.splice(n,1))}return k},_onAppConfigSet:function(a){a=r.reCreateObject(a);window.appInfo.isRunInMobile=r.inMobileSize();this.configLoader.processProxy(a);this.configLoader.addNeedValues(a);
this.configLoader.loadAndUpgradeAllWidgetsConfig(a).then(m.hitch(this,function(a){this._addDefaultValues(a);k.setPortalUrl(a.portalUrl);window.portalUrl=a.portalUrl;this.appConfig?(r.deleteMapOptions(a.map.mapOptions),this.appConfig=a,this._deleteDataSourcesFromMap(),g.publish("appConfigChanged",this.getAppConfig(),"resetConfig",a)):(this.appConfig=a,p.getPortal(a.portalUrl).loadSelfInfo().then(m.hitch(this,function(a){this.portalSelf=a;g.publish("appConfigLoaded",this.getAppConfig())})))}))},_addDefaultValues:function(a){this._addDefaultPortalUrl(a);
this._addDefaultGeometryService(a);this._addDefaultStyle(a);this._addDefaultMap(a);this._addDefaultVisible(a);this._addDefaultDataSource(a);this._addDefaultSharedTheme(a);"undefined"===typeof a.widgetOnScreen&&(a.widgetOnScreen={});"undefined"===typeof a.widgetPool&&(a.widgetPool={});this._addDefaultPanelAndPosition(a);this._addDefaultOfWidgetGroup(a);(a.widgetPool.widgets&&0<a.widgetPool.widgets.length&&void 0===a.widgetPool.widgets[0].index||a.widgetPool.groups&&0<a.widgetPool.groups.length&&void 0===
a.widgetPool.groups[0].index)&&this._addIndexForWidgetPool(a);return a},_addDefaultDataSource:function(a){a.dataSource?(a.dataSource.dataSources||(a.dataSource.dataSources={}),a.dataSource.settings||(a.dataSource.settings={})):a.dataSource={dataSources:{},settings:{}}},_addDefaultPortalUrl:function(a){"undefined"===typeof a.portalUrl&&(a.portalUrl="http://www.arcgis.com/");a.portalUrl&&"/"!==a.portalUrl.substr(a.portalUrl.length-1)&&(a.portalUrl+="/")},_addDefaultGeometryService:function(a){var e=
a&&a.geometryService,e=e&&"string"===typeof e&&m.trim(e)?m.trim(e):this.portalSelf.helperServices.geometry.url;a.geometryService=e;u.defaults.geometryService=new z(a.geometryService)},_addDefaultStyle:function(a){!a.theme||a.theme.styles&&0!==a.theme.styles.length||(a.theme.styles=["default"])},_addDefaultMap:function(a){a.map.id="map";"undefined"===typeof a.map["3D"]&&"undefined"===typeof a.map["2D"]&&(a.map["2D"]=!0);"undefined"===typeof a.map.position&&(a.map.position={left:0,right:0,top:0,bottom:0});
"undefined"===typeof a.map.portalUrl&&(a.map.portalUrl=a.portalUrl)},_addDefaultVisible:function(a){r.visitElement(a,function(a){void 0===a.visible&&(a.visible=!0)})},_addDefaultSharedTheme:function(a){a.theme.sharedTheme?("undefined"===typeof a.theme.sharedTheme.useHeader&&(a.theme.sharedTheme.useHeader=!1),"undefined"===typeof a.theme.sharedTheme.useLogo&&(a.theme.sharedTheme.useLogo=!1)):a.theme.sharedTheme={useHeader:!1,useLogo:!1}},_addDefaultPanelAndPosition:function(a){this._addOnScreenDefaultPanelAndPosition(a);
this._addPoolDefaultPanelAndPosition(a)},_addOnScreenDefaultPanelAndPosition:function(a){var e,k;if(a=a.widgetOnScreen){e=a.panel&&a.panel.positionRelativeTo?a.panel.positionRelativeTo:"map";"undefined"===typeof a.panel||"undefined"===typeof a.panel.uri?a.panel={uri:"jimu/OnScreenWidgetPanel",position:{relativeTo:e}}:"undefined"===typeof a.panel.position?a.panel.position={relativeTo:e}:"undefined"===typeof a.panel.position.relativeTo&&(a.panel.position.relativeTo=e);if(a.widgets)for(e=0;e<a.widgets.length;e++)a.widgets[e].position||
(a.widgets[e].position={}),a.widgets[e].position.relativeTo||(a.widgets[e].position.relativeTo=a.widgets[e]&&a.widgets[e].positionRelativeTo?a.widgets[e].positionRelativeTo:"map"),!0!==a.widgets[e].inPanel||a.widgets[e].panel||(a.widgets[e].panel=m.clone(a.panel),a.widgets[e].panel.position=a.widgets[e].position,a.widgets[e].panel.position.relativeTo=a.widgets[e].position.relativeTo);if(a.groups)for(e=0;e<a.groups.length;e++)for(a.groups[e].panel||(a.groups[e].panel=a.panel),a.groups[e].panel&&!a.groups[e].panel.position&&
(a.groups[e].panel.position={}),a.groups[e].panel.position.relativeTo||(a.groups[e].panel.position.relativeTo=a.groups[e].panel.positionRelativeTo?a.groups[e].panel.positionRelativeTo:"map"),a.groups[e].widgets||(a.groups[e].widgets=[]),k=0;k<a.groups[e].widgets.length;k++)a.groups[e].widgets[k].panel=a.groups[e].panel}},_addPoolDefaultPanelAndPosition:function(a){var e,k,p=a.widgetPool;if(p){e=p.panel&&p.panel.positionRelativeTo?p.panel.positionRelativeTo:"map";"undefined"===typeof p.panel||"undefined"===
typeof p.panel.uri?p.panel={uri:"jimu/OnScreenWidgetPanel",position:{relativeTo:e}}:"undefined"===typeof p.panel.position?p.panel.position={relativeTo:e}:"undefined"===typeof p.panel.position.relativeTo&&(p.panel.position.relativeTo=e);if(p.groups)for(e=0;e<p.groups.length;e++)for(p.groups[e].panel?p.groups[e].panel.position.relativeTo||(p.groups[e].panel.position.relativeTo=p.groups[e].panel.positionRelativeTo?p.groups[e].panel.positionRelativeTo:"map"):p.groups[e].panel=p.panel,p.groups[e].widgets||
(p.groups[e].widgets=[]),k=0;k<p.groups[e].widgets.length;k++)p.groups[e].widgets[k].panel=p.groups[e].panel;if(p.widgets)for(e=0;e<p.widgets.length;e++)!1===p.widgets[e].inPanel?(k=p.widgets[e].positionRelativeTo?p.widgets[e].positionRelativeTo:"map",p.widgets[e].position)?p.widgets[e].position.relativeTo||(p.widgets[e].position.relativeTo=k):p.widgets[e].position={relativeTo:k}:p.widgets[e].panel||(p.widgets[e].panel=a.widgetPool.panel)}},_addDefaultOfWidgetGroup:function(a){r.visitElement(a,m.hitch(this,
function(a,e){a.isOnScreen=e.isOnScreen;a.widgets?(a.gid=a.id,1===a.widgets.length?(a.label||(a.label=a.widgets[0].label?a.widgets[0].label:window.apiNls.common.groupLabel),a.icon||(a.icon=a.widgets[0].uri?this._getDefaultIconFromUri(a.widgets[0].uri):"jimu.js/images/group_icon.png")):(a.icon=a.icon?a.icon:"jimu.js/images/group_icon.png",a.label=a.label?a.label:window.apiNls.common.groupLabel+" "+e.index)):a.gid=e.groupId}))},_getDefaultIconFromUri:function(a){a=a.split("/");a.pop();return a.join("/")+
"/images/icon.png?wab_dv\x3d"+window.deployVersion},_addIndexForWidgetPool:function(a){var e=0,k,p;if(a.widgetPool.widgets)for(k=0;k<a.widgetPool.widgets.length;k++)a.widgetPool.widgets[k].index=e,e++;if(a.widgetPool.groups)for(k=0;k<a.widgetPool.groups.length;k++)for(a.widgetPool.groups[k].index=e,e++,p=0;p<a.widgetPool.groups[k].widgets.length;p++)a.widgetPool.groups[k].widgets[p].index=p}});L.getInstance=function(a){null===I?I=new L(a):a&&(I.urlParams=a,I.configLoader&&(I.configLoader.urlParams=
a));window.getAppConfig=m.hitch(I,I.getAppConfig);return I};return L})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/promise/all dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale dojo/i18n!dojo/cldr/nls/number dojox/encoding/base64 esri/lang esri/arcgis/utils esri/dijit/PopupTemplate esri/SpatialReference esri/geometry/Extent esri/geometry/geometryEngine esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters esri/tasks/FeatureSet esri/symbols/PictureMarkerSymbol esri/urlUtils esri/request esri/tasks/query esri/tasks/QueryTask esri/graphicsUtils esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils ./shared/utils ./accessibleUtils ./zoomToUtils".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C,J,O,R,Q,T,S,U,X,W,V,Y,Z,f,aa,E,c,b,d,h){function l(b,d){b=b||"";var h=0,c=[{test:window.File&&window.FileReader&&window.FileList&&window.Blob||!G.file.isEnabledFlash(),failure:[b+"libs/polyfills/fileAPI/FileAPI.js"],callback:function(){h++;h===c.length&&d()}}];for(b=0;b<c.length;b++)testLoad(c[b])}function q(b,d){var h=b.match(/url\([^)]+\)/gi),c,l;if(null===h||""===d)return b;for(c=0;c<h.length;c++)if(l=h[c].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),
4<=l.length){var q=l[2];/^data:image\/.*;/.test(q)||(d.endWith("/")||(d+="/"),b=b.replace(l[1]+q+l[3],l[1]+d+q+l[3]))}return b}function v(b,d){var h=Array.isArray(d),c=h&&[]||{};h?(b=b||[],c=c.concat(b),d.forEach(function(d,h){"undefined"===typeof b[h]?c[h]=d:"object"===typeof d?c[h]=v(b[h],d):-1===b.indexOf(d)&&c.push(d)})):(b&&"object"===typeof b&&Object.keys(b).forEach(function(d){c[d]=b[d]}),Object.keys(d).forEach(function(h){c[h]="object"===typeof d[h]&&d[h]?b[h]?v(b[h],d[h]):d[h]:d[h]}));return c}
function D(b,d){var h=b.map(function(b){return b.id});m.forEach(d,function(d){0>h.indexOf(d)&&b.push({id:d,widgets:[]})},this);var c=[];b=m.filter(b,function(b){return 0>d.indexOf(b.id)?(c.push(b),!1):!0},this);if(0===b.length)return[];var l=b[b.length-1];m.forEach(c,function(b){l.widgets=l.widgets.concat(b.widgets)},this);return b=b.sort(function(b,h){return d.indexOf(b.id)-d.indexOf(h.id)})}function H(b,d,h){function c(b,d){return B.isArray(b[d.key])?b[d.key][d.index]:b[d.key]}d=function(b){var d=
[];b.split("_").forEach(function(b){var h=!1,c;"--"===b.slice(b.length-2)&&(h=!0,b=b.slice(0,b.length-2));c=b.search(/\[[0-9]+\]/);-1===c&&(c=b.length);d.push({key:b.slice(0,c),index:Number(b.slice(c+1,-1)),deleteFlag:h})});return d}(d);for(var l=1;l<d.length-1;l++)if(b=c(b,d[l]),!b)return;if(d[d.length-1].deleteFlag)!0===h&&(B.isArray(b[d[d.length-1].key])?delete b[d[d.length-1].key][d[d.length-1].index]:delete b[d[d.length-1].key]);else if(B.isArray(b[d[d.length-1].key])){if(void 0===h)return b[d[d.length-
1].key][d[d.length-1].index];b[d[d.length-1].key][d[d.length-1].index]=h}else{if(void 0===h)return b[d[d.length-1].key];b[d[d.length-1].key]=h}}function F(b,d,h){function c(h){h=G.template.getSearchRange(d,h,"]");var c=d.slice(h.firstPos,h.lastPos);return-1!==h.firstPos?(c=d.slice(h.firstPos+c.indexOf("[")+1,h.lastPos-1),h=d.slice(h.lastPos+1),(c=G.getConfigElementById(b,c))?{object:c,key:"section_"+h,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}var l=b,q=d=d.replace(/\//g,"_"),f=
c("groups\\[.+\\]");if("deleted"!==f.state&&("isSection"===f.state&&(l=f.object,q=f.key),f=c("widgets\\[.+\\]"),"delete"!==f.state))return"isSection"===f.state&&(l=f.object,q=f.key),H(l,q,h)}var G={},ba={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"};B.mixin(G,b);B.mixin(G,d);B.mixin(G,h);window.atob||(window.atob=function(b){b=M.decode(b);for(var d="",h=0,c=b.length;h<c;h++)d+=String.fromCharCode(b[h]);return d});window.btob||(window.btob=function(b){for(var d=
[],h=0,c=b.length;h<c;h++)d.push(String.charCodeAt(b[h]));return M.encode(d)});var ea="unload",la=[];require.on("error",function(b){m.forEach(la,function(d){b.info[0]&&-1<b.info[0].indexOf(d.resKey)&&d.def.reject(b);for(var h in b.info)-1<h.indexOf(d.resKey)&&d.def.reject(b)})});G.checkError=function(b,d){la.push({resKey:b,def:d})};G.replacePlaceHolder=function(b,d){var h=k.stringify(b),c=h.match(/\$\{(\w)+\}/g);if(null===c)return b;for(b=0;b<c.length;b++){var l=c[b].match(/(\w)+/g)[0];d[l]&&(h=h.replace(c[b],
d[l]))}return k.parse(h)};G.changeUnit=function(b){var d=Math.abs(b),h;b=Math.floor(d);h=Math.floor(60*(d-b));d=(60*(60*(d-b)-h)).toFixed(2);return b+"\u00b0"+(10>h?"0"+h:h)+"'"+(10>d?"0"+d:d)+'"'};G.formatTime=function(b){var d=b/1E3;b=Math.floor(d/60);d=Number(d-60*b).toFixed(1);return(10>b?"0"+b:b)+":"+(10>d?"0"+d:d)};G.parseTime=function(b){var d=/(\d{2,})\:(\d{2})\.(\d{1})/;if(!d.test(b))return console.log("wrong time format."),-1;b=b.match(d);return 1E3*(60*parseInt(b[1],10)+parseInt(b[2],10)+
parseInt(b[3],10)/10)};G.preloadImg=function(b,d){var h=[],h="string"===typeof b?[b]:b;m.forEach(h,function(b){(new Image).src=d?d+b:b})};var da=null;G.getImagesSize=function(b){var d=new n;if(!b||0!==b.indexOf("http"))return d.reject(),d;null===da&&(da=y.create("img",{id:"__test-image-size",style:{position:"absolute",left:"-9999px",top:"-9999px"}},document.body));var h=a(da,"load",function(){clearTimeout(c);c=null;h.remove();var b=y.getContentBox(da);1===b.w&&1===b.h||0===b.w||0===b.h?d.reject():
d.resolve([b.w,b.h])},{}),c=setTimeout(function(){clearTimeout(c);c=null;d.reject()},5E3);y.setAttr(da,"src",b);return d};G.getPositionStyle=function(b){var d={};if(!b)return d;b=B.clone(b);if(window.isRTL){var h;"undefined"!==typeof b.left&&"undefined"!==typeof b.right?(h=b.left,b.left=b.right,b.right=h):"undefined"!==typeof b.left?(b.right=b.left,delete b.left):"undefined"!==typeof b.right&&(b.left=b.right,delete b.right);"undefined"!==typeof b.paddingLeft&&"undefined"!==typeof b.paddingRight?(h=
b.paddingLeft,b.paddingLeft=b.paddingRight,b.paddingRight=h):"undefined"!==typeof b.paddingLeft?(b.paddingRight=b.paddingLeft,delete b.paddingLeft):"undefined"!==typeof b.paddingRight&&(b.paddingLeft=b.paddingRight,delete b.paddingRight)}h="left top right bottom width height padding paddingLeft paddingRight paddingTop paddingBottom".split(" ");for(var c=0;c<h.length;c++){var l=h[c];"number"===typeof b[l]?d[l]=b[l]+"px":"undefined"!==typeof b[l]?d[l]=b[l]:"padding"===l.substr(0,7)?d[l]=0:d[l]="auto"}d.zIndex=
"undefined"===typeof b.zIndex?"auto":b.zIndex;return d};G.isEqual=function(b,d){function h(b,d){var q;if(null===b&&null===d||"undefined"===typeof b&&"undefined"===typeof d)return!0;if(null===b&&null!==d||null===d&&null!==b||"undefined"===typeof b&&"undefined"!==typeof d||"undefined"===typeof d&&"undefined"!==typeof b)return!1;if(isNaN(b)&&isNaN(d)&&"number"===typeof b&&"number"===typeof d||b===d)return!0;if("function"===typeof b&&"function"===typeof d||b instanceof Date&&d instanceof Date||b instanceof
RegExp&&d instanceof RegExp||b instanceof String&&d instanceof String||b instanceof Number&&d instanceof Number)return b.toString()===d.toString();if(-1<c.indexOf(b)||-1<l.indexOf(d))return!1;if(null!==d){for(q in d)if(d.hasOwnProperty(q)!==b.hasOwnProperty(q)||typeof d[q]!==typeof b[q])return!1;for(q in b){if(d.hasOwnProperty(q)!==b.hasOwnProperty(q)||typeof d[q]!==typeof b[q])return!1;switch(typeof b[q]){case "object":case "function":c.push(b);l.push(d);if(!h(b[q],d[q]))return!1;c.pop();l.pop();
break;default:if(!(isNaN(b[q])&&isNaN(d[q])&&"number"===typeof b[q]&&"number"===typeof d[q]||b[q]===d[q]))return!1}}}return!0}var c,l;c=[];l=[];return h(b,d)?!0:!1};G.file={loadFileAPI:function(){var b=new n;if("unload"===ea){var d=window.isBuilder?"stemapp/":"";window.FileAPI={debug:!1,flash:!0,staticPath:d+"libs/polyfills/fileAPI/",flashUrl:d+"libs/polyfills/fileAPI/FileAPI.flash.swf",flashImageUrl:d+"libs/polyfills/fileAPI/FileAPI.flash.image.swf"};l(d,B.hitch(this,function(){ea="loaded";b.resolve()}));
ea="loading"}else"loaded"===ea&&b.resolve();return b},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return x("safari")&&6>x("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var b=null;if(document.all)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(ca){b=null}else navigator.plugins&&0<navigator.plugins.length&&(b=navigator.plugins["Shockwave Flash"]);return!!b},containSeparator:function(b){return 0<=
b.indexOf("/")?!0:0<=b.indexOf("\\")?!0:!1},getNameFromPath:function(b){var d="",d=0<=b.indexOf("/")?"/":"\\";b=b.split(d);return 0<b.length?b[b.length-1]:null},getFolderFromPath:function(b){return b.substr(0,b.length-G.file.getNameFromPath(b).length)},readFile:function(b,d,h,c){if(this.supportHTML5()){var l=b.target.files[0];l&&(l.type.match(d)?l.size>=h?c({errCode:"exceed"}):(b=new FileReader,b.onload=function(b){c(null,l.name,b.target.result)},b.readAsDataURL(l)):c({errCode:"invalidType"}))}else if(this.supportFileAPI()){var q=
window.FileAPI.getFiles(b);q[0].type.match(d)?q[0].size>=h?c({errCode:"exceed"}):window.FileAPI.readAsDataURL(q[0],function(b){b&&b.result?c(null,q[0].name,b.result):c({errCode:"readError"})}):c({errCode:"invalidType"})}}};G.getUriInfo=function(b){var d,h={};d=b.indexOf("/");b.substring(0,d);d=b.substring(0,b.lastIndexOf("/")+1);h.folderUrl=require(G.getRequireConfig()).toUrl(d);h.amdFolder=d;h.url=h.folderUrl;if(/^http(s)?:\/\//.test(b)||/^\/\//.test(b))h.isRemote=!0;return h};G.widgetJson=function(){var b=
{addManifest2WidgetJson:function(b,d){B.mixin(b,d.properties);b.name=d.name;b.label||(b.label=d.label);b.manifest=d;b.isRemote=d.isRemote;b.isRemote&&(b.itemId=d.itemId);d.featureActions&&(b.featureActions=d.featureActions);b.icon||(b.icon=d.icon);b.thumbnail||(b.thumbnail=d.thumbnail);b.folderUrl=d.folderUrl;b.amdFolder=d.amdFolder},removeManifestFromWidgetJson:function(b){if(b.manifest){for(var d in b.manifest.properties)b[d]=void 0;b.name=void 0;b.label=void 0;b.featureActions=void 0;b.manifest=
void 0}},getUriFromItem:function(d){return d.url?b.getFolderUrlFromItem(d)+"Widget":null},getFolderUrlFromItem:function(b){if(!b.url)return null;b=/manifest\.json$/.test(b.url)?b.url.substring(0,b.url.length-13):/\/$/.test(b.url)?b.url:b.url+"/";"https:"===window.location.protocol&&(b=b.replace(/^http:\/\//,"https://"));return b}};return b}();G.getRequireConfig=function(){if(jimuConfig){var b=[];jimuConfig.widgetsPackage&&(b=b.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(b=b.concat(jimuConfig.themesPackage));
jimuConfig.configsPackage&&(b=b.concat(jimuConfig.configsPackage));return{packages:b}}return{}};G.getTypeByGeometryType=function(b){var d="",h="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),c=["esriGeometryRing","esriGeometryPolygon","esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(b)?d="point":0<=h.indexOf(b)?d="polyline":0<=c.indexOf(b)&&(d="polygon");return d};G.getSymbolTypeByGeometryType=
function(b){var d=null;b=G.getTypeByGeometryType(b);"point"===b?d="marker":"polyline"===b?d="line":"polygon"===b&&(d="fill");return d};G.getServices=function(){return ba};G.getArcGISDefaultGeometryService=function(){return new T(ba.geometryService)};G.restoreToDefaultWebMapExtent=function(b,d,h){var c=new n;if(!b||"esri.Map"!==b.declaredClass)return setTimeout(function(){c.reject("Invalid map.")},0),c;d=d&&d.itemInfo;if(!d)return setTimeout(function(){c.reject("Invalid itemInfo")},0),c;d=d.item&&
d.item.extent;if(!d)return setTimeout(function(){c.reject("Invalid itemInfo.item.extent")}),c;var l=new K({wkid:4326}),l=new N(d[0][0],d[0][1],d[1][0],d[1][1],l);if(4326===parseInt(b.spatialReference.wkid,10))return b.setExtent(l);if(b.spatialReference.isWebMercator())return l=Q.geographicToWebMercator(l),b.setExtent(l);d=new S;d.geometries=[l];d.outSR=b.spatialReference;l=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;l&&"esri.tasks.GeometryService"===l.declaredClass||(h&&"string"===
typeof h&&B.trim(h)?(h=B.trim(h),l=new T(h)):l=G.getArcGISDefaultGeometryService());l.project(d).then(function(d){if(d=d&&d[0])return b.setExtent(d);c.reject("Invalid projected geometry.");return c},function(b){console.error(b);c.reject(b);return c});return c};G.getAncestorWindow=function(){for(var b=window;b&&b.parent&&b!==b.parent;)b=b.parent;return b};G.getAncestorDom=function(b,d,h){if(b&&1===b.nodeType&&d&&"function"===typeof d){var c=100,l=document.body;h&&("number"===typeof h?(h=parseInt(h,
10),0<h&&(c=h)):1===h.nodeType&&(l=h));for(h=0;b.parentNode&&h<c&&y.isDescendant(b.parentNode,l);){if(d(b.parentNode))return b.parentNode;b=b.parentNode;h++}}return null};G.bindClickAndDblclickEvents=function(b,d,h,c){var l=null;if(b&&1===b.nodeType&&d&&"function"===typeof d&&h&&"function"===typeof h){var q=200;c&&"number"===typeof c&&(c=parseInt(c,10),0<c&&(q=c));var f=0,l=a(b,"click",function(b){f++;1===f?setTimeout(function(){1===f&&(f=0,d(b))},q):2===f&&(f=0,h(b))})}return l};G.isScrollToBottom=
function(b){var d=y.getContentBox(b);return 1>b.scrollHeight-(b.scrollTop+d.h)};G.getAllItemTypes=function(){var b=[],b=b.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service","Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In",
"Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return b=b.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer","Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};
G.getItemQueryStringByTypes=function(b){var d="",h=G.getAllItemTypes();if(b&&0<b.length&&0<b.length){var c="";m.forEach(b,function(d,h){c+=' type:"'+d+'" ';h!==b.length-1&&(c+=" OR ")});d=" ( "+c+" ) ";h=b.concat(h);h=m.filter(h,function(d){return m.every(b,function(b){return 0>b.toLowerCase().indexOf(d.toLowerCase())})});m.forEach(h,function(b){d+=' -type:"'+b+'" '})}return d};G.getItemQueryStringByTypeKeywords=function(b){var d="";b&&0<b.length&&(d=' typekeywords:"'+b.join(",")+'" ');return d};
G.isNotEmptyString=function(b,d){var h=b&&"string"===typeof b;return h?d?h&&B.trim(b):!0:!1};G.isNotEmptyStringArray=function(b,d){for(var h=0;h<b.length;h++){var c=b[h];if(!G.isNotEmptyString(c.value?c.value:c,d))return!1}return!0};G.isValidNumber=function(b){return"number"===typeof b&&!isNaN(b)};G.isValidNumberArray=function(b){for(var d=0;d<b.length;d++){var h=b[d],h=h.value||0===h.value?h.value:h;if(!G.isValidNumber(h))return!1}return!0};G.isValidDate=function(b){if(b)try{return!isNaN((new Date(b)).getTime())}catch(ca){return console.error(ca),
!1}else return!1};G.isObject=function(b){return b&&"object"===typeof b};G.createWebMap=function(b,d,h,l){b=c.getStandardPortalUrl(b);b=c.getBaseItemUrl(b);L.arcgisUrl=b;return L.createMap(d,h,l)};G.getRandomString=function(){var b=Math.random().toString();return b=b.slice(2,b.length)};G._getDomainsByServerName=function(b){var d=b.split("."),h=d.length;return m.map(d,B.hitch(this,function(b,c){b=d.slice(c,h);var l="",q=b.length-1;m.forEach(b,B.hitch(this,function(b,d){l+=b;d!==q&&(l+=".")}));return l}))};
G.removeCookie=function(b,d){var h=this._getDomainsByServerName(window.location.hostname);m.forEach(h,B.hitch(this,function(h){e(b,null,{expires:-1,path:d});e(b,null,{expires:-1,path:d,domain:h});e(b,null,{expires:-1,path:d,domain:"."+h})}))};G.isLocaleChanged=function(b,d){return!b.startWith(d)};G.hashToObject=function(b){b=b.replace("#","");b=w.queryToObject(b);for(var d in b)if(b.hasOwnProperty(d))try{b[d]=k.parse(b[d])}catch(ka){}return b};G.reCreateObject=function(b){function d(b){var c=[];b.forEach(function(b){Array.isArray(b)?
c.push(d(b)):"object"===typeof b?c.push(h(b)):c.push(b)});return c}function h(b){var c={},l;for(l in b)b.hasOwnProperty(l)&&(null===b[l]?c[l]=null:Array.isArray(b[l])?c[l]=d(b[l]):c[l]="object"===typeof b[l]?h(b[l]):b[l]);return c}return Array.isArray(b)?d(b):h(b)};G.setVerticalCenter=function(b){setTimeout(function(){var d=t(".jimu-vcenter-text",b),h,c;m.forEach(d,function(b){h=y.getContentBox(b).h;y.setStyle(b,{lineHeight:h+"px"})},this);d=t(".jimu-vcenter",b);m.forEach(d,function(b){h=y.getContentBox(b).h;
c=y.getContentBox(t(b).parent()[0]).h;y.setStyle(b,{marginTop:(c-h)/2+"px"})},this)},10)};G.merge=v;G.loadStyleLink=function(b,d,h){var c=new n,l,f=require(G.getRequireConfig()).toUrl(d);if(require.cache["url:"+f]){l=require.cache["url:"+f];var v=f.split("/").pop(),f=f.substr(0,f.length-v.length);l=q(l,f);b=h?y.create("style",{id:b,type:"text/css"},y.byId(h),"before"):y.create("style",{id:b,type:"text/css"},document.getElementsByTagName("head")[0]);b.styleSheet&&!b.sheet?b.styleSheet.cssText=l:b.appendChild(y.toDom(l));
c.resolve("load");return c}l=h?y.create("link",{id:b,rel:"stylesheet",type:"text/css",href:f+"?wab_dv\x3d"+window.deployVersion},y.byId(h),"before"):y.create("link",{id:b,rel:"stylesheet",type:"text/css",href:f+"?wab_dv\x3d"+window.deployVersion},document.getElementsByTagName("head")[0]);a(l,"load",function(){c.resolve("load")});var D=setInterval(function(){var b;if(m.some(document.styleSheets,function(h){if(h.href&&h.href.substr(h.href.indexOf(d),h.href.length)===d)return b=h,!0}))try{!c.isFulfilled()&&
(b.cssRules&&b.cssRules.length||b.rules&&b.rules.length)&&c.resolve("load"),clearInterval(D)}catch(qa){}},50);return c};G.changeLocation=function(b){window.history.pushState&&window.history.pushState({path:b},"",encodeURI(b))};G.urlToObject=function(b){var d=null;-1===b.indexOf("#")?(d=W.urlToObject(b),d.hash=null):(b=b.split("#"),d=W.urlToObject(b[0]),d.hash=b[1]?-1<b[1].indexOf("\x3d")?w.queryToObject(b[1]):b[1]:null);return d};G.manifest=function(){function d(b){b.panels.forEach(function(b){b.uri=
"panels/"+b.name+"/Panel.js"});b.styles.forEach(function(b){b.uri="styles/"+b.name+"/style.css"});b.layouts.forEach(function(b){b.uri="layouts/"+b.name+"/config.json";b.icon="layouts/"+b.name+"/icon.png";b.RTLIcon="layouts/"+b.name+"/icon_rtl.png"})}return{addManifestProperies:function(h){h.icon||(h.icon=h.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion);h.thumbnail||(h.thumbnail=h.folderUrl+"images/thumbnail.png");"theme"===h.category?d(h):("undefined"!==typeof h["2D"]&&(h.support2D=
h["2D"]),"undefined"!==typeof h["3D"]&&(h.support3D=h["3D"]),"undefined"===typeof h["2D"]&&"undefined"===typeof h["3D"]&&(h.support2D=!0),delete h["2D"],delete h["3D"],"undefined"===typeof h.properties&&(h.properties={}),b.processWidgetProperties(h))},processManifestLabel:function(b,d){var h=d.split("-")[0];b.label=b.i18nLabels&&(b.i18nLabels[d]||b.i18nLabels[h]||b.i18nLabels.defaultLabel)||b.label||b.name;b.layouts&&m.forEach(b.layouts,function(h){var c="i18nLabels_layout_"+h.name;h.label=b[c]&&
(b[c][d]||b[c].defaultLabel)||h.label||h.name});b.styles&&m.forEach(b.styles,function(h){var c="i18nLabels_style_"+h.name;h.label=b[c]&&(b[c][d]||b[c].defaultLabel)||h.label||h.name})},addI18NLabel:function(d){var h=new n;if(d.i18nLabels)return h.resolve(d),h;d.i18nLabels={};if(d.properties&&!1===d.properties.hasLocale)return h.resolve(d),h;var c;c=d.isRemote?d.amdFolder+"nls/strings.js":d.amdFolder+"nls/strings";require(G.getRequireConfig(),["dojo/i18n!"+c],function(c){var l={};l[dojoConfig.locale]=
c;b.addI18NLabelToManifest(d,null,l);h.resolve(d)});return h}}}();G.isNumberField=function(b){return 0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(b)};G.getTime=function(b){var d=b.getTimezoneOffset(),d=0>d?"+"+Math.abs(d)/60:"-"+d/60;return b.getTime()+36E5*d};G.getUniqueValues=function(b,d,h,c,l){return function(){var d=new n,h={};c?(h.layerDefinition=c,l&&(h.fieldPopupInfo=l),d.resolve(h)):d=V({url:b,content:{f:"json"},
handleAs:"json",callbackParamName:"callback"}).then(function(b){h.layerDefinition=b;return h},function(b){console.log("Error: ",b.message)});return d}().then(function(c){return G._getUniqueValues(b,d,h,c.layerDefinition).then(function(b){return G._getValues(c.layerDefinition,c.fieldPopupInfo,d,b)})})};G._getValues=function(b,d,h,c){var l=[],l=G.getFieldInfoByFieldName(b.fields,h),q=null,f=G.isNumberField(l.type),v="esriFieldTypeDate"===l.type?!0:!1;if(l&&(f?c=m.map(c,function(b){b=parseFloat(b);isNaN(b)&&
(b=null);return b}):v&&(c=m.map(c,B.hitch(this,function(b){return G.isValidDate(b)?(b=0>(d?d.format.dateFormat:"").indexOf("Time")?b:G.getTime(new Date(b)),G.localizeDateByFieldInfo(new Date(b),d)):b}))),b=G.getCodedValueListForCodedValueOrSubTypes(b,h),null!==b))for(q={},h=0;h<b.length;h++)q[b[h].value]=b[h].label;return l=m.map(c,function(b){var h=null,h=null===b||void 0===b?"\x3cNull\x3e":q&&q.hasOwnProperty(b)?q[b]:f?d?G.localizeNumberByFieldInfo(b,d):G.localizeNumber(b):b;return{value:b,label:h}})};
G._getUniqueValues=function(b,d,h,c){var l=new n;b=b.replace(/\/*$/g,"");h||(h="1\x3d1");var l=/\/ImageServer$/gi.test(b),q=-1<b.indexOf("MapServer/dynamicLayer");l||q?l=G._getUniqueValuesByQueryTask(b,d,h):(l=G.getFieldInfoByFieldName(c.fields,d),l=0<G.getCodedValuesOrTypesCount(l,c)?G._getUniqueValuesByQueryTask(b,d,h):G._getUniqueValuesByGenerateRenderer(b,d,h));return l};G.getCodedValuesOrTypesCount=function(b,d){return b?d.typeIdField&&d.typeIdField.toUpperCase()===b.name.toUpperCase()&&d.types?
d.types.length:(b=G._getAllCodedValue(d,b))?b.length:0:0};G._getUniqueValuesByQueryTask=function(b,d,h){var c=new Y;c.where=h;c.returnDistinctValues=!0;c.returnGeometry=!1;c.outFields=[d];return(new Z(b)).execute(c).then(function(b){var h=[];b.features&&0<b.features.length&&m.forEach(b.features,function(b){b&&b.attributes&&h.push(b.attributes[d])});return h})};G._getUniqueValuesByGenerateRenderer=function(b,d,h){var c=new n,l=b.split("?");b=1<l.length?l[0].replace(/\/*$/g,"")+"/generateRenderer?"+
l[1]:b.replace(/\/*$/g,"")+"/generateRenderer";d=k.stringify({type:"uniqueValueDef",uniqueValueFields:[d]});V({url:b,content:{classificationDef:d,f:"json",where:h},handleAs:"json",callbackParamName:"callback"}).then(B.hitch(this,function(b){var d=[];(b=b&&b.uniqueValueInfos)&&0<b.length&&(d=m.map(b,B.hitch(this,function(b){return b.value})));c.resolve(d)}),B.hitch(this,function(b){c.reject(b)}));return c};G.isCodedValuesSupportFilter=function(b,d){b=b.currentVersion?b:b.toJson().layerDefinition;var h=
parseFloat(b.currentVersion);return d<=parseFloat(b.maxRecordCount)&&10.1<h};G.combineRadioCheckBoxWithLabel=function(b,d){var h=!1;if(b&&1===b.nodeType&&"input"===b.tagName.toLowerCase()){var c=b.getAttribute("type")||"",c=c.toLowerCase();if("radio"===c||"checkbox"===c)h=!0}c=!1;d&&1===d.nodeType&&"label"===d.tagName.toLowerCase()&&(c=!0);h&&c&&(h=b.getAttribute("id"),h||(h="input_"+G.getRandomString(),b.setAttribute("id",h)),d.setAttribute("for",h),y.setStyle(d,"cursor","pointer"))};G.groupRadios=
function(b,d){var h=[],c="radiogroup_"+G.getRandomString();m.forEach(b,function(b){b.name=c;d&&(b=a(b,"change",d),h.push(b))});return h};G.convertExtentToPolygon=function(b){var d=b.xmin,h=b.xmax,c=b.ymin,l=b.ymax;return new R({rings:[[[d,l],[h,l],[h,c],[d,c],[d,l]]],spatialReference:b.toJson()})};G.combineGeometries=function(b){function d(b){var d={points:[],spatialReference:b[0].spatialReference.toJson()};m.forEach(b,function(b){"point"===b.type?d.points=d.points.concat([[b.x,b.y]]):"multipoint"===
b.type&&(d.points=d.points.concat(b.points))});return new J(d)}function h(b){var d={paths:[],spatialReference:b[0].spatialReference.toJson()};m.forEach(b,function(b){d.paths=d.paths.concat(b.paths)});return new O(d)}function c(b){var d={rings:[],spatialReference:b[0].spatialReference.toJson()};m.forEach(b,function(b){"polygon"===b.type?d.rings=d.rings.concat(b.rings):"extent"===b.type&&(b=G.convertExtentToPolygon(b),d.rings=d.rings.concat(b.rings))});return new R(d)}var l=null;if(b&&0<b.length)if(1===
b.length)l=b[0];else{for(var q=null,f=null,v=null,D=null,H=0;H<b.length;H++){q=b[H];switch(q.type){case "point":case "multipoint":D="point";break;case "polyline":D="polyline";break;case "polygon":case "extent":D="polygon";break;default:return null}if(0===H)v=D;else if(v!==D)return null;if(H!==b.length-1&&(f=b[H+1],!q.spatialReference.equals(f.spatialReference)))return null}"point"===D?l=d(b):"polyline"===D?l=h(b):"polygon"===D&&(l=c(b))}return l};G.combineGeometriesByGraphics=function(b){var d=null;
b&&0<b.length&&(b=m.map(b,function(b){return b.geometry}),d=G.combineGeometries(b));return d};G.isFeaturelayerUrlSupportQuery=function(b,d){var h=!1,c=/\/featureserver\//gi.test(b);b=/\/mapserver\//gi.test(b);d=(d||"").toLowerCase();c?h=0<=d.indexOf("query"):b&&(h=0<=d.indexOf("data"));return h};G.isImageServiceSupportQuery=function(b){return 0<=(b||"").toLowerCase().indexOf("catalog")};G.isStringEndWith=function(b,d){return b.lastIndexOf(d)+d.length===b.length};G.localizeNumber=function(b,d){var h=
(b.toString().split(".")[1]||"").length,c="",c=d&&isFinite(d.places)&&d.places,c=0<c||0<h?"#,###,###,##0.0"+Array.prototype.join.call({length:0<c?c+1:h},"0"):"#,###,###,##0",h={locale:g.locale,pattern:c};B.mixin(h,d||{});try{return p.format(b,h)}catch(na){return console.error(na),b.toLocaleString()}};G.parseNumber=function(b,d){var h={locale:g.locale};B.mixin(h,d||{});try{return p.parse(b,h)}catch(ha){return console.error(ha),b}};G.localizeDate=function(b,d){var h={locale:g.locale,fullYear:!0};B.mixin(h,
d||{});"ar"===g.locale&&"long"!==h.formatLength&&"full"!==h.formatLength&&(h.formatLength="long");try{return u.format(b,h)}catch(ha){return console.error(ha),"date"===h.selector?b.toLocaleDateString():"time"===h.selector?b.toLocaleTimeString():b.toLocaleString()}};G.localizeNumberByFieldInfo=function(b,d){var h=null,h=B.exists("format.places",d)&&d.format.places,h=G.localizeNumber(b,{places:h});return B.exists("format.digitSeparator",d)&&!d.format.digitSeparator?h.toString().replace(new RegExp("\\"+
z.group,"g"),""):h};G.localizeDateByFieldInfo=function(b,d){var h=null;try{var c={date:b instanceof Date?b.getTime():b},l=B.exists("format.dateFormat",d)?d.format.dateFormat:"longMonthDayYear",h=I.substitute(c,"${date}",{dateFormat:{properties:["date"],formatter:"DateFormat"+P.prototype._dateFormats[l]}})}catch(ia){console.error(ia),h=b}return h};G.fieldFormatter={getFormattedUrl:function(b){if(b&&"string"===typeof b){var d=b.indexOf("http:");-1===d&&(d=b.indexOf("https:"));if(-1<d&&-1===b.indexOf("href\x3d")){var h=
b.indexOf(" ",d);-1===h&&(h=b.length);var c=-1<b.indexOf("\r\n",d)?b.indexOf("\r\n",d):-1<b.indexOf("\n",d)?b.indexOf("\n",d):h,h=c<h?c:h,c=b.substring(d,h);b=b.substring(0,d)+'\x3cA href\x3d"'+c+'" target\x3d"_blank"\x3e'+c+"\x3c/A\x3e"+b.substring(h,b.length)}}return null===b?"":b},getFormattedNumber:function(b,d){if("number"===typeof b){var h=(b.toString().split(".")[1]||"").length;b=G.localizeNumberByFieldInfo(b,{format:{places:d&&"number"===typeof d.places?parseInt(d.places,10):h,digitSeparator:d&&
d.digitSeparator}});return'\x3cspan class\x3d"jimu-numeric-value"\x3e'+(b||"")+"\x3c/span\x3e"}return b},getFormattedDate:function(b,d){if("number"===typeof b||b instanceof Date)b=G.localizeDateByFieldInfo(b,{format:d});return b||""},getCodedValue:function(b,d){if(b&&b.codedValues){for(var h=0,c=b.codedValues.length;h<c;h++){var l=b.codedValues[h];if(I.isDefined(d)&&B.exists("code",l)&&d.toString()===l.code.toString())return l.name}return d}return d||null},getTypeName:function(b,d){for(var h=d.length,
c=0;c<h;c++)if(b===d[c].id)return d[c].name;return b}};G.addRelativePathInCss=q;G.url={isAbsolute:function(b){return b?b.startWith("http")||b.startWith("/"):!1},removeQueryParamFromUrl:function(b,d){b=W.urlToObject(b);b.query&&delete b.query[d];d=b.path;for(var h in b.query)d=d===b.path?d+"?"+h+"\x3d"+b.query[h]:d+"\x26"+h+"\x3d"+b.query[h];return d},addQueryParamToUrl:function(b,d,h){b=W.urlToObject(b);b.query||(b.query={});b.query[d]=h;d=b.path;for(var c in b.query)d=d===b.path?d+"?"+c+"\x3d"+b.query[c]:
d+"\x26"+c+"\x3d"+b.query[c];return d},compareUrl:function(b,d){b=this.getUrlPath(b);d=this.getUrlPath(d);b=c.removeProtocol(b.toString().toLowerCase()).replace(/\/+/g,"/");d=c.removeProtocol(d.toString().toLowerCase()).replace(/\/+/g,"/");return b===d},getUrlPath:function(b){return W.urlToObject(b).path}};G.processUrlInWidgetConfig=function(b,d){if(b)return b.startWith("data:")||b.startWith("http")||b.startWith("/")?b:b.startWith("${appPath}")?b.replace("${appPath}",window.appInfo.appPath):d+b};
G.processUrlInAppConfig=function(b){if(b)return b.startWith("data:")||b.startWith("http")||b.startWith("/")?b:window.appInfo.appPath+b};G.getLocationUrlWithoutHashAndQueryParams=function(){var b=window.location,d=b.protocol+"//"+b.host+b.pathname,b=W.urlToObject(b.href);b.query&&b.query.apiurl&&(d=G.url.addQueryParamToUrl(d,"apiurl",b.query.apiurl));return d};G.getDefaultWebMapThumbnail=function(){return require.toUrl("jimu/images/webmap.png")};G.invertColor=function(b){b=b.substring(1);3===b.length&&
(b=b.slice(0,1)+b.slice(0,1)+b.slice(1,1)+b.slice(1,1)+b.slice(2,1)+b.slice(2,1));b=parseInt(b,16);return 7829367<b?"#000000":"#ffffff"};G.isLightColor=function(b){b=b.substring(1);3===b.length&&(b=b.slice(0,1)+b.slice(0,1)+b.slice(1,1)+b.slice(1,1)+b.slice(2,1)+b.slice(2,1));b=parseInt(b,16);return 7829367<b?!0:!1};G.mixinAppConfigPosition=function(b,d){var h=B.clone(b);if(!d)return h;d=B.clone(d);var c=h.widgetOnScreen,l=d.widgetOnScreen;l&&l.widgets&&("[object Object]"===Object.prototype.toString.call(l.widgets)?
m.forEach(c.widgets,function(b,d){d=b.uri?b.uri:"ph_"+d;l.widgets[d]&&l.widgets[d].position&&(l.widgets[d].position.relativeTo||(l.widgets[d].position.relativeTo="map"),b.position=l.widgets[d].position)},this):m.forEach(l.widgets,function(b,d){b.position&&!b.position.relativeTo&&(b.position.relativeTo="map");c.widgets[d]&&b.position&&(c.widgets[d].position=b.position)}));l&&l.groups&&("[object Object]"===Object.prototype.toString.call(l.groups)?m.forEach(c.groups,function(b,d){d=b.label?b.label:"g_"+
d;l.groups[d]&&l.groups[d].panel&&l.groups[d].panel.position&&(l.groups[d].panel.position.relativeTo||(l.groups[d].panel.position.relativeTo="map"),b.panel.position=l.groups[d].panel.position)},this):(b=b.layoutDefinition?b.layoutDefinition.manager:"jimu/layoutManagers/AbsolutePositionLayoutManager","jimu/layoutManagers/AbsolutePositionLayoutManager"===b?m.forEach(l.groups,function(b,d){b.panel&&b.panel.position&&!b.panel.position.relativeTo&&(b.panel.position.relativeTo="map");c.groups[d]&&b.panel&&
b.panel.position&&(c.groups[d].panel.position=b.panel.position)}):"jimu/layoutManagers/GridLayoutManager"===b&&(c.groups=D(c.groups,l.groups.map(function(b){return b.id})))));d.map&&d.map.position&&(h.map?h.map.position=d.map.position:h.map={position:d.map.position});d.widgetPool&&d.widgetPool.panel&&(d.widgetPool.panel.position&&!d.widgetPool.panel.position.relativeTo&&(d.widgetPool.panel.position.relativeTo="map"),h.widgetPool.panel.position=d.widgetPool.panel.position);d.mobileLayout&&(h.mobileLayout=
d.mobileLayout);return h};G.handleGridLayoutOnScreenGroupChange=D;G.template={groupIdentification:"groups\\[.+\\]",widgetIdentification:"widgets\\[.+\\]",getSearchRange:function(b,d,h){var c=-1;d=b.search(new RegExp(d));0<=d&&(b=b.slice(d,b.length),b=b.indexOf(h),c=d+b+h.length);return{firstPos:d,lastPos:c}},setConfigValue:function(b,d,h){H(b,d,h)},getConfigValue:function(b,d){return H(b,d)},setConfigValueWithId:function(b,d,h){F(b,d,h)},getConfigValueWithId:function(b,d){return F(b,d)},getKeyInfo:function(b){var d=
this.getWidgetIdByKey(b);if(null!==d)return{type:"widget",id:d};b=this.getGroupIdByKey(b);return null!==b?{type:"group",id:b}:{type:"unknow",id:null}},getWidgetIdByKey:function(b){var d=G.template.getSearchRange(b,G.template.widgetIdentification,"]");if(-1===d.firstPos)b=null;else{var h=b.slice(d.firstPos,d.lastPos);b=b.slice(d.firstPos+h.indexOf("[")+1,d.lastPos-1)}return b},getGroupIdByKey:function(b){var d=G.template.getSearchRange(b,G.template.groupIdentification,"]");if(-1===d.firstPos)b=null;
else{var h=b.slice(d.firstPos,d.lastPos);b=b.slice(d.firstPos+h.indexOf("[")+1,d.lastPos-1)}return b},getConfigedWidgetsByTemplateConfig:function(b){var d=[],h=G.template.widgetIdentification+"_config",c;m.forEach(b.configurationSettings,function(b){m.forEach(b.fields,function(b){b.fieldName&&(c=G.template.getSearchRange(b.fieldName,h,"]"),0<=c.firstPos&&(b=G.template.getWidgetIdByKey(b.fieldName),-1===d.indexOf(b)&&d.push(b)))},this)},this);return d},mergeTemplateAppConfigToAppConfig:function(b,
d,h){function c(b){var d=[];m.forEach(b,function(b){b&&d.push(b)},this);return d}var l=b.widgetOnScreen,q=b.portalUrl;d.values.webmap&&(b.map.itemId=d.values.webmap);h&&(b.map.mapOptions&&G.deleteMapOptions(b.map.mapOptions),b.map.portalUrl=q,d.values.app_title||(d.values.app_title=h.title),d.values.app_subtitle||(d.values.app_subtitle=h.snippet));for(var f in d.values)"webmap"!==f&&G.template.setConfigValueWithId(b,f,d.values[f]);b.widgetPool.widgets=c(b.widgetPool.widgets);l.widgets=c(l.widgets);
if(b.widgetPool.groups)for(d=0;d<b.widgetPool.groups.length;d++)b.widgetPool.groups[d].widgets=c(b.widgetPool.groups[d].widgets);if(l.groups)for(d=0;d<l.groups.length;d++)l.groups[d].widgets=c(l.groups[d].widgets);return b}};G.deleteMapOptions=function(b){b&&(delete b.extent,delete b.lods,delete b.center,delete b.scale,delete b.zoom,delete b.maxScale,delete b.maxZoom,delete b.minScale,delete b.minZoom)};G.sanitizeHTML=function(b){return html_sanitize(b,function(b){return b},function(b){return b})};
G.stripHTML=function(b){return b?-1<b.indexOf("\x3c")&&-1<b.indexOf("\x3e")?b.replace(/<(?:.|\s)*?>/g,""):b:b};G.encodeHTML=function(b){return String(b).replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")};G.removeSuffixSlashes=function(b){return b.replace(/\/*$/g,"")};G.getBestDisplayAttributes=function(b,d){var h={},c=null,l;for(l in b)c=G.getBestDisplayValue(l,b,d),h[l]=c;return h};G.getBestDisplayValue=function(b,d,h){var c=
"",l=null;B.isArrayLike(h)?l=G.getFieldInfoByFieldName(h,b):"object"===typeof h&&h.name===b&&(l=h);l&&(c=d[b],"esriFieldTypeDate"===l.type?c&&(b=new Date(parseInt(c,10)),c=G._tryLocaleDate(b)):"number"===typeof c&&(l.domain&&"codedValue"===l.domain.type?m.some(l.domain.codedValues,function(b){if(b.code===c)return c=b.name,!0}):c=G._tryLocaleNumber(c)));if(null===c||void 0===c)c="";return c};G._getCodedValues=function(b){var d=null;(b=b.domain)&&"codedValue"===b.type&&b.codedValues&&0<b.codedValues.length&&
(d=b.codedValues,d=m.map(d,B.hitch(this,function(b){return{value:b.code,label:b.name}})));return d};G._getSubTypes=function(b){var d=null;b.subtypeField&&b.subtypes&&0<b.subtypes.length&&(d=m.map(b.subtypes,B.hitch(this,function(b){return{value:b.id,label:b.name}})));return d};G._getRenderTypes=function(b){var d=null;b.typeIdField&&b.types&&0<b.types.length&&(d=m.map(b.types,B.hitch(this,function(b){return{value:b.id,label:b.name}})));return d};G._getCodedValueOrSubtypes=function(b,d,h){var c=G.getFieldInfoByFieldName(b.fields,
d);return void 0!==h&&null!==h?G._getCodedValueBySubTypeId(b,d,h,c):G._getAllCodedValue(b,c)};G._getDisplayValueForCodedValueOrSubtype=function(b,d,h,c){var l={isCodedValueOrSubtype:!1,displayValue:h+""};(b=G._getCodedValueOrSubtypes(b,d,c))&&0<b.length&&m.some(b,B.hitch(this,function(b){return b.value===h?(l={isCodedValueOrSubtype:!0,displayValue:b.label},!0):!1}));return l};G._deleteSubtypePropertiesTemp=function(b){delete b.subtypeField;delete b.subtypes};G.getDisplayValueForCodedValueOrSubtype=
function(b,d,h){G._deleteSubtypePropertiesTemp(b);var c=h[d],l,q=b.typeIdField;h.hasOwnProperty(q)&&(l=h[q]);(q=b.subtypeField)&&b.subtypes&&0<b.subtypes.length&&h.hasOwnProperty(q)&&(l=h[q]);c=G._getDisplayValueForCodedValueOrSubtype(b,d,c,l);b.typeIdField===d&&(c.displayValue=G._updateCodedValueListFromRender(b,[{value:h[d],label:c.displayValue}])[0].label);return c};G._getDisplayValueFromCodedValues=function(b,d){var h={isCodedValueOrSubtype:!1,displayValue:b+""};d&&0<d.length&&m.some(d,B.hitch(this,
function(d){return d.value===b?(h={isCodedValueOrSubtype:!0,displayValue:d.label},!0):!1}));h.value=b;return h};G.getDisplayValueForCodedValueOrSubtypeBatch=function(b,d,h){G._deleteSubtypePropertiesTemp(b);var c={},l=b.typeIdField,q=b.subtypeField,f=G.getFieldInfoByFieldName(b.fields,d);q&&b.subtypes&&0<b.subtypes.length?(c.subType=G._getSubTypes(b),l=q,c.all=G._getAllCodedValueNew(b,f)):(c.all=G._getAllCodedValue(b,f),c.subType=G._getRenderTypes(b));if(c.subType&&0<c.subType.length){var q=c.subType,
v;for(v in q){var D=q[v].value,H=G._getCodedValueBySubTypeId(b,d,D,f);c[D]=b.typeIdField===d?G._updateCodedValueListFromRender(b,H):H}}b.typeIdField===d&&(c.subType=G._updateCodedValueListFromRender(b,c.subType),c.all=G._updateCodedValueListFromRender(b,c.all));D=[];v=[];for(var F in h)D=h[F],q=D[d],l===d?D=c.subType:D.hasOwnProperty(l)?(D=D[l],D=c[D],D||(D=G._getCodedValues(f),b.typeIdField===d&&(D=G._updateCodedValueListFromRender(b,D)))):D=c.all,q=G._getDisplayValueFromCodedValues(q,D),v.push(q);
return v};G._getUniquCodedValue=function(b,d,h){b[d]?h!==b[d]&&(b[d]=b[d]+", "+h):b[d]=h;return b};G._getAllCodedValue=function(b,d){var h=d.name,c={},l=null,q=!0;if(b.typeIdField&&b.types&&0<b.types.length)m.map(b.types,B.hitch(this,function(b){b.domains&&b.domains[h]&&(b=b.domains[h],"inherited"===b.type?q&&(q=!1,b=G._getCodedValues(d),m.map(b,B.hitch(this,function(b){c=G._getUniquCodedValue(c,b.value,b.label)}))):b.codedValues&&0<b.codedValues.length&&m.map(b.codedValues,B.hitch(this,function(b){c=
G._getUniquCodedValue(c,b.code,b.name)})))})),l||(l=G._getCodedValues(d));else return this._getCodedValues(d);b=[];var f=G.isNumberField(d.type),v;for(v in c){var D=f?parseFloat(v):v;b.push({value:D,label:c[v]})}0<b.length&&(l=b);return l};G._getAllCodedValueNew=function(b,d){var h=d.name,c={},l=null,q=!0;if(b.subtypeField&&b.subtypes&&0<b.subtypes.length)m.map(b.subtypes,B.hitch(this,function(b){b.domains&&b.domains[h]&&(b=b.domains[h],"inherited"===b.type?q&&(q=!1,b=G._getCodedValues(d),m.map(b,
B.hitch(this,function(b){c=G._getUniquCodedValue(c,b.value,b.label)}))):b.codedValues&&0<b.codedValues.length&&m.map(b.codedValues,B.hitch(this,function(b){c=G._getUniquCodedValue(c,b.code,b.name)})))})),l||(l=G._getCodedValues(d));else return this._getCodedValues(d);b=[];var f=G.isNumberField(d.type),v;for(v in c){var D=f?parseFloat(v):v;b.push({value:D,label:c[v]})}0<b.length&&(l=b);return l};G._getCodedValueBySubTypeId=function(b,d,h,c){var l="typeIdField",q="types";b.subtypeField&&b.subtypes&&
0<b.subtypes.length&&(l="subtypeField",q="subtypes");var f=null;c=c?c:G.getFieldInfoByFieldName(b.fields,d);b[l]&&b[q]&&0<b[q].length?(m.map(b[q],B.hitch(this,function(q){if(q.id===h){if(d===b[l])return f=[{value:q.id,label:q.name}],!0;q.domains&&q.domains[d]?(q=q.domains[d],"inherited"===q.type?f=G._getCodedValues(c):q.codedValues&&0<q.codedValues.length&&(f=m.map(q.codedValues,B.hitch(this,function(b){return{value:b.code,label:b.name}})))):q.domains&&(f=G._getCodedValues(c))}})),f||(f=G._getCodedValues(c))):
f=G._getCodedValues(c);return f};G.getCodedValueListForCodedValueOrSubTypes=function(b,d,h){G._deleteSubtypePropertiesTemp(b);var c=null,c=G.getFieldInfoByFieldName(b.fields,d),l,q;h&&(l=h[b.typeIdField],q=h[b.subtypeField]);if(b.subtypeField&&b.subtypes&&0<b.subtypes.length)return d===b.subtypeField?(c=G._getSubTypes(b),void 0!==q&&(h=G._getDisplayValueFromCodedValues(q,c),c=[{value:h.value,label:h.displayValue}])):c=void 0===q?G._getAllCodedValueNew(b,c):G._getCodedValueBySubTypeId(b,d,q,c),d===
b.typeIdField&&(c=G._updateCodedValueListFromRender(b,c)),c;b.subtypeField="";b.subtypes=[];b.typeIdField&&b.typeIdField.toUpperCase()===d.toUpperCase()?(c=G._getRenderTypes(b),h&&void 0!==l&&null!==l&&(h=G._getDisplayValueFromCodedValues(l,c),c=[{value:h.value,label:h.displayValue}])):c=h&&void 0!==l&&null!==l?G._getCodedValueBySubTypeId(b,d,l,c):G._getAllCodedValue(b,c);d===b.typeIdField&&(c=G._updateCodedValueListFromRender(b,c));return c};G._verifyIfFieldIsSubtypeField=function(b,d){var h={isSubtypeField:!1,
subtypeField:""};if(b.subtypeField)return h={isSubtypeField:b.subtypeField===d.name,subtypeField:b.subtypeField};["esriFieldTypeSmallInteger","esriFieldTypeInteger"].indexOf(d.type)&&b.typeIdField===d.name&&b.types&&0<b.types.length&&(void 0===b.types[0].domains[d.name]?h={isSubtypeField:!0,subtypeField:d.name}:h.isSubtypeField=!1);return!1};G._getRendererFromLayerDef=function(b){var d=null;b.drawingInfo&&b.drawingInfo.renderer&&"uniqueValue"===b.drawingInfo.renderer.type&&(d=b.drawingInfo.renderer);
return d};G._getRenderValueLabelsForUnique=function(b){var d=null,h=null,c=G._getRendererFromLayerDef(b);c?(d={},h=c.uniqueValueInfos):b.renderer&&(c=b.toJson().layerDefinition,c=G._getRendererFromLayerDef(c),b=b.renderer.toJson(),"uniqueValue"===b.type&&c&&c.field1===b.field1?(d={},h=b.uniqueValueInfos):c&&(d={},h=c.uniqueValueInfos));if(h)for(b=0;b<h.length;b++)c=h[b],d[c.value]=c.label;return d};G._updateCodedValueListFromRender=function(b,d){if((b=G._getRenderValueLabelsForUnique(b))&&d)for(var h=
0;h<d.length;h++){var c=d[h];b[c.value]&&(c.label=b[c.value])}return d};G.getDefaultPortalFieldInfo=function(b){var d=b.name,d={fieldName:d,label:b.alias||d,tooltip:"",visible:!1,format:null,stringFieldOption:"textbox"};switch(b.type){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":d.format={places:0,digitSeparator:!0};break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":d.format={places:2,digitSeparator:!0};break;case "esriFieldTypeDate":d.format={dateFormat:"longMonthDayYear"}}return d};
G.getDefaultPopupInfo=function(b,d,h){var c=null;b&&b.fields&&(c={title:d,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]},m.forEach(b.fields,function(b){var d=!1;h?m.some(h,B.hitch(this,function(d){return d&&b.name.toLowerCase()===d.toLowerCase()}))&&(d=!0):d=!0;d&&(d=this.getDefaultPortalFieldInfo(b),d.visible=!0,d.isEditable=b.editable,c.fieldInfos.push(d))},this));return c};G._tryLocaleNumber=function(b){var d=G.localizeNumber(b);if(null===d||void 0===d)d=b;return d};G._tryLocaleDate=
function(b){var d=G.localizeDate(b);d||(d=b.toLocaleDateString());return d};G.getFieldInfoByFieldName=function(b,d){var h=null;b&&0<b.length&&m.some(b,B.hitch(this,function(b){return b.name===d?(h=b,!0):!1}));return h};G.getDateFieldFormatByFieldName=function(b,d){if(b&&0<b.length)for(var h=0;h<b.length;h++){var c=b[h];if(c.fieldName===d){if(c.format&&c.format.dateFormat)return c.format.dateFormat;break}}return""};G.completePopupFieldFromLayerField=function(b,d){for(var h in b){var c=b[h].name,l=
!1,q;for(q in d)if(d[q].fieldName===c){l=!0;break}l||(c=G.getPopupFieldFromLayerField(b[h]),d.push(c))}return d};G.getPopupFieldFromLayerField=function(b){return{fieldName:b.name,isEditable:b.editable,label:b.alias,visible:b.visible?b.visible:!1,stringFieldOption:"esriFieldTypeString"===b.type?"textbox":null,tooltips:"",domain:b.domain?b.domain:null}};G.containsNonLatinCharacter=function(b){for(var d=0;d<b.length;d++)if(255<b.charCodeAt(d))return!0;return!1};G.has=function(b){var d=x(b);if(d)return d;
if("ie"===b.toLowerCase()){b=0;var h=/MSIE (\d+\.\d+);/.test(navigator.userAgent),c=!!navigator.userAgent.match(/Trident\/7.0/),l=navigator.userAgent.indexOf("rv:11.0");h&&(b=Number(RegExp.$1));-1!==navigator.appVersion.indexOf("MSIE 10")&&(b=10);c&&-1!==l&&(b=11);return 11===b&&11||d}if("edge"===b.toLowerCase())return navigator.userAgent.split("Edge/")[1]||d};G.detectUserAgent=function(){var b={},d={},h=navigator.userAgent,c=navigator.platform,l=h.match(/Web[kK]it[\/]{0,1}([\d.]+)/),q=h.match(/(Android);?[\s\/]+([\d.]+)?/),
f=!!h.match(/\(Macintosh\; Intel /),v=h.match(/(iPad).*OS\s([\d_]+)/),D=h.match(/(iPod)(.*OS\s([\d_]+))?/),H=!v&&h.match(/(iPhone\sOS)\s([\d_]+)/),F=h.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),c=/Win\d{2}|Windows/.test(c),a=h.match(/Windows Phone ([\d.]+)/),E=F&&h.match(/TouchPad/),G=h.match(/Kindle\/([\d.]+)/),e=h.match(/Silk\/([\d._]+)/),k=h.match(/(BlackBerry).*Version\/([\d.]+)/),p=h.match(/(BB10).*Version\/([\d.]+)/),n=h.match(/(RIM\sTablet\sOS)\s([\d.]+)/),g=h.match(/PlayBook/),u=h.match(/Chrome\/([\d.]+)/)||
h.match(/CriOS\/([\d.]+)/),ba=h.match(/Firefox\/([\d.]+)/),z=h.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),t=h.match(/MSIE\s([\d.]+)/)||h.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),r=!u&&h.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),A=r||h.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);d.webkit=!!l;d.webkit&&(d.version=l[1]);q&&(b.android=!0,b.version=q[2]);H&&!D&&(b.ios=b.iphone=!0,b.version=H[2].replace(/_/g,"."));v&&(b.ios=b.ipad=!0,b.version=
v[2].replace(/_/g,"."));D&&(b.ios=b.ipod=!0,b.version=D[3]?D[3].replace(/_/g,"."):null);a&&(b.wp=!0,b.version=a[1]);F&&(b.webos=!0,b.version=F[2]);E&&(b.touchpad=!0);k&&(b.blackberry=!0,b.version=k[2]);p&&(b.bb10=!0,b.version=p[2]);n&&(b.rimtabletos=!0,b.version=n[2]);g&&(d.playbook=!0);G&&(b.kindle=!0,b.version=G[1]);e&&(d.silk=!0,d.version=e[1]);!e&&b.android&&h.match(/Kindle Fire/)&&(d.silk=!0);u&&(d.chrome=!0,d.version=u[1]);ba&&(d.firefox=!0,d.version=ba[1]);z&&(b.firefoxos=!0,b.version=z[1]);
t&&(d.ie=!0,d.version=t[1]);A&&(f||b.ios||c)&&(d.safari=!0,b.ios||(d.version=A[1]));r&&(d.webview=!0);b.tablet=!!(v||g||q&&!h.match(/Mobile/)||ba&&h.match(/Tablet/)||t&&!h.match(/Phone/)&&h.match(/Touch/));b.phone=!(b.tablet||b.ipod||!(q||H||F||k||p||u&&h.match(/Android/)||u&&h.match(/CriOS\/([\d.]+)/)||ba&&h.match(/Mobile/)||t&&h.match(/Touch/)));return{os:b,browser:d}};G.isMobileUa=function(){var b=G.detectUserAgent();return!0===b.os.phone||!0===b.os.tablet?!0:!1};G.inMobileSize=function(){var b=
y.getMarginBox(document.body);if(b.w<=window.jimuConfig.breakPoints[0]||b.h<=window.jimuConfig.breakPoints[0])return y.addClass(window.jimuConfig.layoutId,"jimu-ismobile"),!0;y.removeClass(window.jimuConfig.layoutId,"jimu-ismobile");return!1};G.getObjectIdField=function(b){if(b.objectIdField)return b.objectIdField;b=b.fields;for(var d=0;d<b.length;d++){var h=b[d];if("esriFieldTypeOID"===h.type)return h.name}return null};G.isNeedHttpsButNot=function(){var b=navigator.geolocation,d=window.hasOwnProperty("isSecureContext");
return(d&&window.isSecureContext||!d&&"https:"===window.location.protocol)&&b?!1:!0};G.toFeatureSet=function(b){var d=new U;"[object Object]"===Object.prototype.toString.call(b)&&(b=[b]);d.features=b;if(0<b.length){var h;m.some(b,function(b){if(b.geometry)return h=b,!0});if(h){b=h.getLayer();var c={};b&&(d.displayFieldName=b.displayField,m.forEach(b.fields,B.hitch(this,function(b){var d=b.name;c[d]=b.alias||d})),d.fieldAliases=c);d.geometryType=h.geometry.type;d.spatialReference=h.geometry.spatialReference}}return d};
G.showValidationErrorTipForFormDijit=function(b){try{!b.validate()&&b.domNode&&b.focusNode&&(b.focusNode.focus(),setTimeout(B.hitch(this,function(){b.focusNode.blur()}),100))}catch(ca){console.error(ca)}};G.getFeatureLayerDefinition=function(b){var d=null,h=b.graphics;b.graphics=[];var c=b.toJson();b.graphics=h;c&&(d=c.layerDefinition);return d};G.simulateClickEvent=function(b){if(x("safari")){var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);b.dispatchEvent(d)}else b.click()};
G.getFeatureSetByLayerAndFeatures=function(b,d){var h=new U;h.fields=B.clone(b.fields);h.features=d;h.geometryType=b.geometryType;h.fieldAliases={};m.forEach(h.fields,B.hitch(this,function(b){var d=b.name;h.fieldAliases[d]=b.alias||d}));return h};G.featureAction=function(){return{zoomTo:function(b,d,h){h||(h={});if(b&&d&&0<d.length){var c=m.every(d,function(b){return b&&b.spatialReference&&b.type});if(m.every(d,function(b){return b&&b.geometry&&b.geometry.spatialReference&&b.geometry.type})||c)c&&
(d=m.map(d,function(b){return{geometry:b}})),G.zoomToFeatureSet(b,{features:d},h.extentFactor)}},flash:function(b,d){function h(b,d){m.forEach(l,function(h,c){h.setSymbol(d?b:q[c]||f)})}function c(b){return function(){setTimeout(function(){h(v,!0);l[0]&&d&&d.redraw();setTimeout(function(){h(null,!1);l[0]&&d&&d.redraw();b()},200)},200)}}if(m.every(b||[],function(b){return b&&b.geometry})){var l=b;b=l[0];var q=m.map(l,function(b){return b.symbol}),f=b.symbol||B.getObject("renderer.symbol",!1,d),v=null;
d&&"esriGeometryPoint"===d.geometryType?v=new X(require.toUrl("jimu")+"/images/flash.gif",20,20):(v=B.clone(f))&&(v.outline?v.outline.setColor("#ffc500"):v.setColor("#ffc500"));b&&f&&v&&d&&("esriGeometryPoint"===d.geometryType?(h(v,!0),d.redraw(),setTimeout(function(){h(null,!1);d.redraw()},2E3)):c(c(c(function(){})))())}},panTo:function(b,d){m.every(d||[],function(b){return b&&b.geometry})&&(0<d.length?d=f.graphicsExtent(d).getCenter():(d=d[0].geometry,d="polyline"===d.type||"polygon"===d.type?d.getExtent().getCenter():
"extent"===d.type?d.getCenter():"multipoint"===d.type?1<d.points.length?d.getExtent().getCenter():d.getPoint(0):d),b.centerAt(d))},showPopup:function(b,d){m.every(d||[],function(b){return b&&b.geometry})&&(b=b.infoWindow,b.setFeatures(d),d=d[0],"point"===d.geometry.type?b.show(d.geometry,{closetFirst:!0}):b.show(d.geometry.getExtent().getCenter(),{closetFirst:!0}))}}}();G.isInConfigOrPreviewWindow=function(){var b=!1;try{b=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(ca){b=
!1}return!!b};G.getAppHref=function(){var b="";return b=G.isInConfigOrPreviewWindow()?window.parent.location.href:window.location.href};G.getAppIdFromUrl=function(){var b=!0,d=G.getAppHref();if(-1!==d.indexOf("id\x3d")||-1!==d.indexOf("appid\x3d")||-1!==d.indexOf("apps"))b=!1;if(!0===b)return d;b=this.urlToObject(window.location.href);if(b.query&&(b.query.id||b.query.appid))return b.query.id||b.query.appid;if(window.appInfo){if(window.appInfo.id)return window.appInfo.id;if(window.appInfo.appPath){if(b=
window.appInfo.appPath.split("/"),b.length&&2<b.length)return b[b.length-2]}else console.error("CAN NOT getAppIdFromUrl")}};G.getEditorContentHeight=function(b,d,h){var c=new n;this._content=b;this._dom=d;this._domParam=h;var l=setTimeout(B.hitch(this,function(){clearTimeout(l);l=null;var b=0,d=this._domParam.contentWidth;try{var h=document.createElement("div");h.setAttribute("id","fakeContent");y.setStyle(h,"background-size","contain");h.innerHTML=this._content;this._dom.appendChild(h);if(h){var q=
t("img",h);q&&q.length&&q.style({maxWidth:d-20+"px"});y.setStyle(h,"position","absolute");y.setStyle(h,"width",d+"px");y.setStyle(h,"left","-99999px");y.setStyle(h,"top","-99999px");y.setStyle(h,"visibility","hidden");var f=y.getContentBox(h);f.h&&(b=f.h,b+=this._domParam.contentMarginTop+this._domParam.footerHeight+8)}}catch(ma){console.error("can't getEditorContentHeight"+ma),b=200}c.resolve(b)}),1500);return c};G.getBase64Data=function(b){var d=new n;if(b&&b.startWith("data:image"))d.resolve(b);
else try{V({url:b,handleAs:"arraybuffer"}).then(function(b){var h=new FileReader;h.onloadend=function(){d.resolve(h.result)};h.onerror=function(){d.resolve(null)};h.readAsDataURL(new Blob([b],{type:"image/png"}))},function(){d.resolve(null)})}catch(ka){console.warn(ka),d.resolve(null)}return d};G.getEditorTextColor=function(b,d){return{name:"dijit.editor.plugins.EditorTextColor",custom:{recordUID:G.getColorRecordName(b),forceAttr:d}}};G.getEditorBackgroundColor=function(b){return{name:"dijit.editor.plugins.EditorBackgroundColor",
custom:{recordUID:G.getColorRecordName(b)}}};G.getColorRecordName=function(b){return"wab_cr_"+(b||"")};G.b64toBlob=function(b,d,h){d=d||"";h=h||512;b=window.atob(b.replace(/^data:image\/(png|jpg|jpeg|gif);base64,/,""));for(var c=[],l=0;l<b.length;l+=h){for(var q=b.slice(l,l+h),f=Array(q.length),v=0;v<q.length;v++)f[v]=q.charCodeAt(v);q=new Uint8Array(f);c.push(q)}return new Blob(c,{type:d})};G.subtractionArray=function(b,d){for(var h=b.length-1;0<=h;h--)for(var c=b[h],l=d.length-1;0<=l;l--)if(c===
d[l]){b.splice(h,1);d.splice(l,1);break}return b};G.resourcesUrlToBlob=function(b){return V({url:b,handleAs:"blob"})};G.processItemResourceOfAppConfig=function(b,d){function h(b){var d=b.obj,h=b.key,c={obj:d,key:h};"number"===typeof b.i?(c.i=b.i,c.value=d[h][b.i]):c.value=d[h];return c}function c(b){for(var d in b)if("object"===typeof b[d])if(Array.isArray(b[d]))for(var h=b,q=d,f=0;f<h[q].length;f++)"string"===typeof h[q][f]?l(h,q,f):"object"===typeof h[q][f]&&c(h[q][f]);else c(b[d]);else"string"===
typeof b[d]&&l(b,d)}function l(b,c,l){"number"===typeof l?d.test(b[c][l])&&(v=d.func(h({obj:b,key:c,i:l})),"function"===typeof v.then?f.push(v):q.push(v)):d.test(b[c])&&(v=d.func(h({obj:b,key:c})),"function"===typeof v.then?f.push(v):q.push(v))}var q=[],f=[],v;c(b);return 0<f.length?A(f).then(function(d){0<q.length&&(d=d.concat(q));return{appConfig:b,result:d}}):{appConfig:b,result:q}};G.isEsriDomain=function(b){return/^https?:\/\/(?:[\w\-\_]+\.)+(?:esri|arcgis)\.com/.test(b)};G.uniqueArray=function(b){for(var d=
[],h=0;h<b.length;h++)-1===d.indexOf(b[h])&&d.push(b[h]);return d};G.isNotEmptyObject=function(b,d){return d?G.isObject(b)&&0<Object.keys(b).length&&Array.isArray(b):G.isObject(b)&&0<Object.keys(b).length};G.getMinOfArray=function(b){return Number(Math.min.apply(Math,b))};G.getDataSchemaFromLayerDefinition=function(b){var d=b.fields.filter(function(b){return"esriFieldTypeOID"===b.type}),d=0<d.length?d[0]:null;return{geometryType:b.geometryType,fields:b.fields,displayField:b.displayField,objectIdField:d,
typeIdField:b.typeIdField}};G.isValidPointGeometry=function(b){return b&&"point"===b.type&&G.isTrueOrZero(b.x)&&G.isTrueOrZero(b.y)};G.isVaildPointGeometry=G.isValidPointGeometry;G.isNumberOrNumberString=function(b){return/^-?[1-9]\d*$/.test(b)||/^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/.test(b)};G.convertNumberToPercentage=function(b,d,h){if(!G.isNumberOrNumberString(b))return b;"undefined"===typeof h&&(h=!0);"undefined"===typeof d&&(d=2);d={format:{places:d,digitSeparator:h}};var c=g.locale;
h="ar"===c||"tr"===c;c="ar"===c||"he"===c;b=Number(b);var l=!1;0>b&&(l=!0,b=Math.abs(b));b=G.localizeNumberByFieldInfo(100*b,d);b=h?"%"+b:b+"%";l&&(b=c?b+"-":"-"+b);return b};G.getClientFeaturesFromMap=function(b,d,h,c){var l=[],q=!1;if(d){h?0<d.getSelectedFeatures().length?(l=d.getSelectedFeatures(),q=!0):l=d.graphics:l=d.graphics;c&&(l=G.filterFeaturesByExtent(b.extent,l));if(l&&0<l.length){var f=G.getObjectIdField(d);f&&(b=l[0])&&b.attributes&&b.attributes.hasOwnProperty(f)&&l.sort(function(b,
d){b.attributes||(b.attributes={});d.attributes||(d.attributes={});b=b.attributes[f];d=d.attributes[f];return b<d?-1:b>d?1:0})}l.isSelectedFeatures=q;return l}};G.filterFeaturesByExtent=function(b,d){var h=b.normalize();return d=m.filter(d,B.hitch(this,function(b){try{if(b.geometry){var d="point"===b.geometry.type||"multipoint"===b.geometry;return m.some(h,B.hitch(this,function(h){return d?h.contains(b.geometry):C.intersects(h,b.geometry)}))}}catch(ia){console.error(ia)}return!1}))};G.upperCaseString=
function(b){return b&&"string"===typeof b?b.toUpperCase():b};G.lowerCaseString=function(b){return b&&"string"===typeof b?b.toLowerCase():b};G.checkEssentialAppsLicense=function(b,d,h){var l=c.getStandardPortalUrl(window.portalUrl),q=c.getSharingUrl(l),l=new E({appId:"arcgisWebApps",portalUrl:l});aa.registerOAuthInfos([l]);return h?aa.checkAppAccess(q,"arcgisWebApps"):d.getItemById(b).then(function(b){if("public"!==b.access)return aa.checkAppAccess(q,"arcgisWebApps")})};return G})},"dojo/NodeList-traverse":function(){define(["./query",
"./_base/lang","./_base/array"],function(B,m,y){var x=B.NodeList;m.extend(x,{_buildArrayFromCallback:function(g){for(var w=[],t=0;t<this.length;t++){var r=g.call(this[t],this[t],w);r&&(w=w.concat(r))}return w},_getUniqueAsNodeList:function(g){for(var w=[],t=0,r;r=g[t];t++)1==r.nodeType&&-1==y.indexOf(w,r)&&w.push(r);return this._wrap(w,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(g,w){g=this._getUniqueAsNodeList(g);g=w?B._filterResult(g,w):g;return g._stash(this)},_getRelatedUniqueNodes:function(g,
w){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(w),g)},children:function(g){return this._getRelatedUniqueNodes(g,function(g,t){return m._toArray(g.childNodes)})},closest:function(g,w){return this._getRelatedUniqueNodes(null,function(t,r){do if(B._filterResult([t],g,w).length)return t;while(t!=w&&(t=t.parentNode)&&1==t.nodeType);return null})},parent:function(g){return this._getRelatedUniqueNodes(g,function(g,t){return g.parentNode})},parents:function(g){return this._getRelatedUniqueNodes(g,
function(g,t){for(t=[];g.parentNode;)g=g.parentNode,t.push(g);return t})},siblings:function(g){return this._getRelatedUniqueNodes(g,function(g,t){t=[];for(var r=g.parentNode&&g.parentNode.childNodes,n=0;n<r.length;n++)r[n]!=g&&t.push(r[n]);return t})},next:function(g){return this._getRelatedUniqueNodes(g,function(g,t){for(g=g.nextSibling;g&&1!=g.nodeType;)g=g.nextSibling;return g})},nextAll:function(g){return this._getRelatedUniqueNodes(g,function(g,t){for(t=[];g=g.nextSibling;)1==g.nodeType&&t.push(g);
return t})},prev:function(g){return this._getRelatedUniqueNodes(g,function(g,t){for(g=g.previousSibling;g&&1!=g.nodeType;)g=g.previousSibling;return g})},prevAll:function(g){return this._getRelatedUniqueNodes(g,function(g,t){for(t=[];g=g.previousSibling;)1==g.nodeType&&t.push(g);return t})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(g,
m){return 0!=m%2})},odd:function(){return this.filter(function(g,m){return 0==m%2})}});return x})},"dojox/encoding/base64":function(){define(["dojo/_base/lang"],function(B){B=B.getObject("dojox.encoding.base64",!0);B.encode=function(m){for(var y=[],x=m.length,g=x%3,x=x-g,w=0;w<x;){var t=m[w++]<<16|m[w++]<<8|m[w++];y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>18&63));y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>12&63));
y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>6&63));y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t&63))}switch(g){case 2:t=m[w++]<<16|m[w++]<<8;y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>18&63));y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>12&63));y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>6&63));y.push("\x3d");
break;case 1:t=m[w++]<<16,y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>18&63)),y.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>>12&63)),y.push("\x3d"),y.push("\x3d")}return y.join("")};B.decode=function(m){m=m.split("");for(var y=[],x=m.length;"\x3d"==m[--x];);for(var g=0;g<x;){var w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(m[g++])<<18;g<=x&&(w|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(m[g++])<<
12);g<=x&&(w|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(m[g++])<<6);g<=x&&(w|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(m[g++]));y.push(w>>>16&255);y.push(w>>>8&255);y.push(w&255)}for(;0==y[y.length-1];)y.pop();return y};return B})},"esri/geometry/geometryEngine":function(){define("require exports ../kernel ./Geometry ./Polygon ./Polyline ./Point ./Extent ./Multipoint dojo/_base/lang".split(" "),function(B,m,y,x,g,w,t,r,n,A){function a(f){if(void 0===
t.fromJson){if(void 0!==f.x&&void 0!==f.y)return new t(f);if(void 0!==f.paths)return new w(f);if(void 0!==f.rings)return new g(f);if(void 0!==f.points)return new n(f);if(void 0!==f.xmin&&void 0!==f.ymin&&void 0!==f.xmax&&void 0!==f.ymax)return new r(f)}else{if(void 0!==f.x&&void 0!==f.y)return t.fromJson(f);if(void 0!==f.paths)return w.fromJson(f);if(void 0!==f.rings)return g.fromJson(f);if(void 0!==f.points)return n.fromJson(f);if(void 0!==f.xmin&&void 0!==f.ymin&&void 0!==f.xmax&&void 0!==f.ymax)return r.fromJson(f)}}
function k(f){if(void 0===t.fromJson){if(void 0!==f.x&&void 0!==f.y)return new t(f);if(void 0!==f.paths)return new w(f);if(void 0!==f.rings)return new g(f);if(void 0!==f.points)return new n(f);if(void 0!==f.xmin&&void 0!==f.ymin&&void 0!==f.xmax&&void 0!==f.ymax)return new r(f)}else{if(void 0!==f.x&&void 0!==f.y)return t.fromJSON(f);if(void 0!==f.paths)return w.fromJSON(f);if(void 0!==f.rings)return g.fromJSON(f);if(void 0!==f.points)return n.fromJSON(f);if(void 0!==f.xmin&&void 0!==f.ymin&&void 0!==
f.xmax&&void 0!==f.ymax)return r.fromJSON(f)}}function e(f,a){var E;if(null==f||void 0===f||"number"===typeof f)return f;var c=f.toString();if(""===c)return null;if(2==a){if(E=W[c],void 0!==E)return E}else if(0==a){E=X[c];if(void 0!==E)return E;E=V[f];if(void 0!==E)return E}else if(3==a&&(E=X[c],void 0!==E))return E;if(1==a&&(E=V[f],void 0!==E))return E;if(!0===/^\d+$/.test(c))return parseInt(c);throw Error("Unrecognised Unit Type");}function p(f){if(void 0!==f&&null!==f)switch(f){case "loxodrome":return 1;
case "great-elliptic":return 2;case "normal-section":return 3;case "shape-preserving":return 4}return 0}function u(f,a){if(null===f||void 0===f||f.u())return null;switch(f.G()){case C.Fj.Point:var E=new t(f.Be(),f.nf(),a);if(S){var c=f.hasAttribute(C.Wc.M);f.hasAttribute(C.Wc.Z)&&E.set("z",f.qH());c&&E.set("m",f.$G())}return E;case C.Fj.Polygon:var E=f.hasAttribute(C.Wc.Z),c=f.hasAttribute(C.Wc.M),b=z(f,E,c),E=new g({rings:b,hasZ:E,hasM:c});S?E.set("spatialReference",a):E.setSpatialReference(a);E.setCacheValue("_geVersion",
f);return E;case C.Fj.Polyline:return E=f.hasAttribute(C.Wc.Z),c=f.hasAttribute(C.Wc.M),b=z(f,E,c),E=new w({paths:b,hasZ:E,hasM:c}),S?E.set("spatialReference",a):E.setSpatialReference(a),E.setCacheValue("_geVersion",f),E;case C.Fj.MultiPoint:var E=f.hasAttribute(C.Wc.Z),c=f.hasAttribute(C.Wc.M),d=b=null;E&&(b=f.Pa(C.Wc.Z));c&&(d=f.Pa(C.Wc.M));var h=new C.b,l=f.D();a=new n(a);S&&(a.set("hasZ",E),a.set("hasM",c));for(var q=0;q<l;q++){f.w(q,h);var v=[h.x,h.y];E&&v.push(b.get(q));c&&v.push(d.get(q));
a.addPoint(v)}a.setCacheValue("_geVersion",f);return a;case C.Fj.Envelope:return b=f.hasAttribute(C.Wc.Z),E=f.hasAttribute(C.Wc.M),c=new r(f.R.o,f.R.A,f.R.v,f.R.B,a),S&&(b&&(b=f.xf(C.Wc.Z,0),c.set("zmin",b.ca),c.set("zmax",b.ha)),E&&(b=f.xf(C.Wc.M,0),c.set("mmin",b.ca),c.set("mmax",b.ha))),c.setCacheValue("_geVersion",f),c}return null}function z(f,a,E){var c=[],b=f.aa(),d=null,h=null;a&&(d=f.Pa(C.Wc.Z));E&&(h=f.Pa(C.Wc.M));for(var l=new C.b,q=0;q<b;q++){for(var v=f.wa(q),D=f.Ka(q),H=0,F=0,G=NaN,e=
NaN,k=NaN,p=NaN,n=f.Qb(q),g=[],u=v;u<v+D;u++){f.w(u,l);var p=k=NaN,z=[l.x,l.y];a&&(k=d.get(u),z.push(k));E&&(p=h.get(u),z.push(p));u==v&&n&&(H=l.x,F=l.y,G=k,e=p);g.push(z)}!n||H==l.x&&F==l.y&&(!a||isNaN(G)&&isNaN(k)||G==k)&&(!E||isNaN(e)&&isNaN(p)||e==p)||g.push(g[0].slice(0));c.push(g)}return c}function M(f){var a=f._geVersion;if(null==a||void 0==a){if(Object.freeze&&Object.isFrozen(f))return 102100===f.wkid?Z:4326===f.wkid?Y:a=C.Td.create(f.wkid);-1!=f.wkid&&null!==f.wkid&&void 0!==f.wkid?(a=C.Td.create(f.wkid),
f._geVersion=a):""!==f.wkt&&void 0!==f.wkt&&null!==f.wkt&&(a=C.Td.nR(f.wkt),f._geVersion=a)}return a}function I(f){if(null==f)return null;if(void 0===f.getCacheValue){var a=f._geVersion;if(null==a||void 0==a)a=C.cc.bG(f),f._geVersion=a}else if(a=f.getCacheValue("_geVersion"),null==a||void 0==a)a=C.cc.bG(f),f.setCacheValue("_geVersion",a);return a}function L(f){return null===f.spatialReference?null:M(f.spatialReference)}function P(f){return"[object Array]"===Object.prototype.toString.call(f)}function K(f){if(null===
f||void 0===f||f.u())return null;switch(f.G()){case C.Fj.Point:var a={};a.x=f.Be();a.y=f.nf();if(S){var E=f.hasAttribute(C.Wc.M);f.hasAttribute(C.Wc.Z)&&(a.z=f.qH());E&&(a.m=f.$G())}return a;case C.Fj.Polygon:return a=f.hasAttribute(C.Wc.Z),E=f.hasAttribute(C.Wc.M),{rings:z(f,a,E),hasZ:a,hasM:E};case C.Fj.Polyline:return a=f.hasAttribute(C.Wc.Z),E=f.hasAttribute(C.Wc.M),{paths:z(f,a,E),hasZ:a,hasM:E};case C.Fj.MultiPoint:var a=f.hasAttribute(C.Wc.Z),E=f.hasAttribute(C.Wc.M),c=null,b=null;a&&(c=f.Pa(C.Wc.Z));
E&&(b=f.Pa(C.Wc.M));var d=new C.b,h=f.D(),l={L_:[]};S&&(l.hasZ=a,l.hasM=E);for(var q=0;q<h;q++){f.w(q,d);var v=[d.x,d.y];a&&v.push(c.get(q));E&&v.push(b.get(q));l.points.push(v)}return l;case C.Fj.Envelope:return c=f.hasAttribute(C.Wc.Z),a=f.hasAttribute(C.Wc.M),E={},E.xmin=f.R.o,E.ymin=f.R.A,E.xmax=f.R.v,E.ymax=f.R.B,S&&(c&&(c=f.xf(C.Wc.Z,0),E.zmin=c.ca,E.zmax=c.ha),a&&(c=f.xf(C.Wc.M,0),E.mmin=c.ca,E.mmax=c.ha)),E}return null}var N=this&&this.__extends||function(f,a){function E(){this.constructor=
f}for(var c in a)a.hasOwnProperty(c)&&(f[c]=a[c]);f.prototype=null===a?Object.create(a):(E.prototype=a.prototype,new E)},C;(function(f){var a=function(){function c(){}c.Bm=!1;c.iw=!1;c.xz="";return c}();f.Xh=a;if("undefined"!==typeof window)f.Xh.xz="browser","Float64Array"in window&&(f.Xh.iw=!0),"ArrayBuffer"in window&&(f.Xh.Bm=!0);else if("undefined"!==typeof process)a.xz="node",f.Xh.Bm=!0,f.Xh.iw=!0;else{a.xz="browser";try{var E=new ArrayBuffer(0);new Uint8Array(E);f.Xh.Bm=!0;f.Xh.iw=!0}catch(c){f.Xh.Bm=
!1}}})(C||(C={}));(function(f){(function(f){f[f.Unknown=0]="Unknown";f[f.Point=33]="Point";f[f.Line=322]="Line";f[f.Envelope=197]="Envelope";f[f.MultiPoint=550]="MultiPoint";f[f.Polyline=1607]="Polyline";f[f.Polygon=1736]="Polygon"})(f.Fj||(f.Fj={}));(function(f){f[f.enumMild=0]="enumMild";f[f.enumMedium=1]="enumMedium";f[f.enumHot=2]="enumHot"})(f.sM||(f.sM={}));var a=function(){function a(){this.description=null;this.AB=0}a.prototype.G=function(){return 0};a.prototype.tb=function(){return-1};a.prototype.Fg=
function(c){this.Bc();c!=this.description&&this.mo(c)};a.prototype.mo=function(){};a.prototype.om=function(c){this.Bc();c!=this.description&&(c=f.ye.uT(this.description,c),c!=this.description&&this.mo(c))};a.prototype.hasAttribute=function(c){return this.description.hasAttribute(c)};a.prototype.Ud=function(c){this.Bc();this.description.hasAttribute(c)||(c=f.ye.tT(this.description,c),this.mo(c))};a.prototype.xf=function(){return null};a.prototype.Rn=function(){};a.prototype.s=function(){};a.prototype.Cp=
function(){};a.prototype.ac=function(c){this.s(c)};a.prototype.u=function(){return!0};a.prototype.Oa=function(){};a.prototype.Xc=function(){};a.prototype.Ja=function(){return null};a.prototype.copyTo=function(){};a.prototype.hf=function(){return 0};a.prototype.Rb=function(){return 0};a.prototype.tH=function(){return this.hasAttribute(1)};a.lf=function(c){return((c&192)>>6)+1>>1};a.Jo=function(c){return 0!=(c&32)};a.k_=function(c){return 0!=(c&64)};a.NU=function(c){return 0!=(c&128)};a.Oc=function(c){return 0!=
(c&256)};a.gh=function(c){return 0!=(c&512)};a.Ic=function(c){return 0!=(c&1024)};a.prototype.Vf=function(){var c=this.Ja();this.copyTo(c);return c};a.prototype.Gg=function(){return null};a.ne=function(c){var b=c.Ja();c.copyTo(b);return b};a.prototype.Bc=function(){0<=this.AB&&(this.AB+=2147483649)};a.fy=function(c){var b=c.G();if(a.gh(b))return c.D();if(c.u())return 0;if(197==b)return 4;if(33==b)return 1;if(a.Oc(b))return 2;throw f.f.X("missing type");};return a}();f.T=a})(C||(C={}));(function(f){var a=
function(){function a(){this.y=this.x=0}a.pa=function(c,b){var d=new a;d.x=c;d.y=b;return d};a.El=function(c){var b=new a;b.x=c.x;b.y=c.y;return b};a.prototype.ka=function(c,b){this.x=c;this.y=b};a.prototype.L=function(c){this.x=c.x;this.y=c.y};a.prototype.Tq=function(c,b){return this.x===c&&this.y===b};a.prototype.vA=function(c){return 2.220446049250313E-16>=Math.abs(this.x-c.x)&&2.220446049250313E-16>=Math.abs(this.y-c.y)};a.prototype.ub=function(c){return this.x===c.x&&this.y===c.y};a.prototype.Eb=
function(c){return c==this?!0:c instanceof a?this.x==c.x&&this.y==c.y:!1};a.prototype.sub=function(c){this.x-=c.x;this.y-=c.y};a.prototype.zc=function(c,b){this.x=c.x-b.x;this.y=c.y-b.y};a.prototype.add=function(c,b){void 0!==b?(this.x=c.x+b.x,this.y=c.y+b.y):(this.x+=c.x,this.y+=c.y)};a.prototype.Kr=function(){this.x=-this.x;this.y=-this.y};a.prototype.au=function(c){this.x=-c.x;this.y=-c.y};a.prototype.HU=function(c,b,d){this.x=c.x*(1-d)+b.x*d;this.y=c.y*(1-d)+b.y*d};a.prototype.qu=function(c,b){this.x=
this.x*c+b.x;this.y=this.y*c+b.y};a.prototype.DX=function(c,b,d){this.x=b.x*c+d.x;this.y=b.y*c+d.y};a.prototype.scale=function(c){this.x*=c;this.y*=c};a.prototype.compare=function(c){return this.y<c.y?-1:this.y>c.y?1:this.x<c.x?-1:this.x>c.x?1:0};a.prototype.normalize=function(){var c=this.length();0==c&&(this.x=1,this.y=0);this.x/=c;this.y/=c};a.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.prototype.pk=function(){return this.x*this.x+this.y*this.y};a.Cb=function(c,
b){return Math.sqrt(this.sc(c,b))};a.wz=function(c,b,d,h){c-=d;b-=h;return Math.sqrt(c*c+b*b)};a.prototype.oi=function(c){return this.x*c.x+this.y*c.y};a.prototype.xE=function(c){return Math.abs(this.x*c.x)+Math.abs(this.y*c.y)};a.prototype.Ui=function(c){return this.x*c.y-this.y*c.x};a.prototype.pu=function(c,b){var d=-this.x*b+this.y*c;this.x=this.x*c+this.y*b;this.y=d};a.prototype.tw=function(){var c=this.x;this.x=-this.y;this.y=c};a.prototype.$H=function(c){this.x=-c.y;this.y=c.x};a.prototype.Tr=
function(){var c=this.x;this.x=this.y;this.y=-c};a.prototype.cv=function(){this.y=this.x=NaN};a.prototype.Gy=function(){return isNaN(this.x)};a.prototype.Zu=function(){return 0<this.x?0<=this.y?1:4:0<this.y?2:0==this.x?4:3};a.us=function(c,b){var d=c.Zu(),h=b.Zu();return h==d?(d=c.Ui(b),0>d?1:0<d?-1:0):d<h?-1:1};a.zZ=function(c,b){return a.us(c,b)};a.sc=function(c,b){var d=c.x-b.x;c=c.y-b.y;return d*d+c*c};a.prototype.toString=function(){return"("+this.x+" , "+this.y+")"};a.prototype.$c=function(){this.y=
this.x=NaN};a.prototype.isNaN=function(){return isNaN(this.x)||isNaN(this.y)};a.prototype.QO=function(){return this.Gy()?NaN:Math.abs(this.x)>=Math.abs(this.y)?Math.abs(this.x):Math.abs(this.y)};a.prototype.offset=function(c,b){var d=a.Cb(c,b),h=a.pa(this.x,this.y);if(0==d)return a.Cb(h,c);var l=new a;l.L(b);l.sub(c);h.sub(c);return h.Ui(l)/d};a.zp=function(c,b,d){var h=new f.Xb;h.set(b.x);h.sub(c.x);var l=new f.Xb;l.set(d.y);l.sub(c.y);var q=new f.Xb;q.set(b.y);q.sub(c.y);var v=new f.Xb;v.set(d.x);
v.sub(c.x);h.Vg(l);q.Vg(v);h.sub(q);if(!h.kt())return d=h.value(),0>d?-1:0<d?1:0;h=new f.Tp(b.x);l=new f.Tp(c.x);q=new f.Tp(c.y);h=h.Yt(l);c=new f.Tp(d.y);c=c.Yt(q);b=new f.Tp(b.y);b=b.Yt(q);d=new f.Tp(d.x);d=d.Yt(l);h=h.cs(c);b=b.cs(d);h=h.cs(b);return h.nV()?-1:h.ZT()?1:0};a.prototype.jc=function(){return f.J.Zi(f.J.Zi())};return a}();f.b=a})(C||(C={}));(function(f){var a=function(){function f(c){this.jz=this.zu=0;this.GY=c}f.prototype.reset=function(){this.jz=this.zu=0};f.prototype.add=function(c){c-=
this.jz;var b=this.zu+c;this.jz=b-this.zu-c;this.zu=b};f.prototype.sub=function(c){this.add(-c)};f.prototype.fn=function(){return this.GY+this.zu};return f}();f.qy=a;a=function(){function f(){}f.Fl=function(c,b){return 0<=b?Math.abs(c):-Math.abs(c)};f.sign=function(c){return 0>c?-1:0<c?1:0};f.fM=function(c){return c-360*Math.floor(c/360)};f.round=function(c){return Math.floor(c+.5)};f.Xx=function(c){return c*c};f.Wq=function(c,b,d){var h;.5>=d?h=c+(b-c)*d:h=b-(b-c)*(1-d);return h};f.bI=function(c,
b,d,h){.5>=d?(h.x=c.x+(b.x-c.x)*d,h.y=c.y+(b.y-c.y)*d):(h.x=b.x-(b.x-c.x)*(1-d),h.y=b.y-(b.y-c.y)*(1-d))};f.lV=function(c,b,d,h,l,q){.5>=l?(q.x=c+(d-c)*l,q.y=b+(h-b)*l):(q.x=d-(d-c)*(1-l),q.y=h-(h-b)*(1-l))};return f}();f.Ub=a})(C||(C={}));(function(f){var a=function(a){function c(){a.call(this);this.oa=this.sa=this.ra=this.ua=0;this.la=null}N(c,a);c.prototype.ec=function(){return f.b.pa(this.ua,this.ra)};c.prototype.Oq=function(b){b.x=this.ua;b.y=this.ra};c.prototype.Mc=function(b){this.Rm(0,b)};
c.prototype.vC=function(b,d){this.Rm(0,f.b.pa(b,d))};c.prototype.Dp=function(b){this.zE(0,b)};c.prototype.setStart=function(b){this.JE(0,b)};c.prototype.ct=function(b,d){return this.ae(0,b,d)};c.prototype.Sx=function(b,d,h){this.oo(0,b,d,h)};c.prototype.Cc=function(){return f.b.pa(this.sa,this.oa)};c.prototype.Os=function(b){b.x=this.sa;b.y=this.oa};c.prototype.Zc=function(b){this.Rm(1,b)};c.prototype.vm=function(b,d){this.Rm(1,f.b.pa(b,d))};c.prototype.Bp=function(b){this.zE(1,b)};c.prototype.setEnd=
function(b){this.JE(1,b)};c.prototype.Ns=function(b,d){return this.ae(1,b,d)};c.prototype.Kx=function(b,d,h){this.oo(1,b,d,h)};c.prototype.tb=function(){return 1};c.prototype.u=function(){return this.Hc()};c.prototype.Oa=function(){};c.prototype.hf=function(){return 0};c.prototype.Ma=function(b,d,h,c,q){return this.OO(b,d,h,c,q)};c.prototype.Yb=function(b,d){return 0!=this.xs(b,d,!1)};c.prototype.lt=function(b,d){return this.$u(b,d,!1)};c.prototype.$u=function(){return null};c.prototype.Hc=function(){return!1};
c.prototype.Iy=function(b){this.Bc();if(null==this.la&&0<b)this.la=f.J.gf(2*b);else if(null!=this.la&&this.la.length<2*b){for(var d=this.la.slice(0),h=this.la.length;h<2*b;h++)d[h]=0;this.la=d}};c.aX=function(b,d,h){if(0<h)var c=0;for(var q=0;q<h;q++)d[0+c]=b[0],c++};c.prototype.Rm=function(b,d){0!=b?(this.sa=d.x,this.oa=d.y):(this.ua=d.x,this.ra=d.y)};c.prototype.mo=function(b){if(null!=this.la){for(var d=f.ye.ux(b,this.description),h=[],l=c.vl(this.description,0),q=c.vl(this.description,1),v=c.vl(b,
0),D=c.vl(b,1),H=0,a=1,G=b.Ea;a<G;a++){var E=b.zd(a),e=f.na.Xa(E);if(-1==d[a])for(var k=f.na.pe(E),E=0;E<e;E++)h[v+H]=k,h[D+H]=k,H++;else for(k=this.description.wk(d[a])-2,E=0;E<e;E++)h[v+H]=this.la[l+k],h[D+H]=this.la[q+k],H++,k++}this.la=h}this.description=b};c.prototype.zE=function(b,d){if(this.Hc())throw f.f.X("empty geometry");d.Fg(this.description);d.Hc()&&d.nq();for(var h=0;h<this.description.Ea;h++)for(var c=this.description.Id(h),q=0,v=f.na.Xa(c);q<v;q++){var D=this.ae(b,c,q);d.setAttribute(c,
q,D)}};c.prototype.JE=function(b,d){this.Bc();if(d.Hc())throw f.f.X("empty geometry");for(var h=d.description,c=0,q=h.Ea;c<q;c++)for(var v=h.Id(c),D=f.na.Xa(v),H=0;H<D;H++){var a=d.Yc(v,H);this.oo(b,v,H,a)}};c.prototype.ae=function(b,d,h){if(this.Hc())throw f.f.X("This operation was performed on an Empty Geometry.");if(0==d)return 0!=b?0!=h?this.oa:this.sa:0!=h?this.ra:this.ua;if(h>=f.na.Xa(d))throw f.f.vd();var l=this.description.mg(d);return 0<=l?(null!=this.la&&this.Iy(this.description.af.length-
2),this.la[c.vl(this.description,b)+this.description.wk(l)-2+h]):f.na.pe(d)};c.prototype.oo=function(b,d,h,l){this.Bc();if(h>=f.na.Xa(d))throw f.f.vd();var q=this.description.mg(d);0>q&&(this.Ud(d),q=this.description.mg(d));0==d?0!=b?0!=h?this.oa=l:this.sa=l:0!=h?this.ra=l:this.ua=l:(null==this.la&&this.Iy(this.description.af.length-2),this.la[c.vl(this.description,b)+this.description.wk(q)-2+h]=l)};c.prototype.copyTo=function(b){if(b.G()!=this.G())throw f.f.F();b.description=this.description;b.Iy(this.description.af.length-
2);c.aX(this.la,b.la,2*(this.description.af.length-2));b.ua=this.ua;b.ra=this.ra;b.sa=this.sa;b.oa=this.oa;b.Bc();this.iq(b)};c.prototype.xf=function(b,d){var h=new f.Ac;if(this.Hc())return h.Oa(),h;h.ca=this.ae(0,b,d);h.ha=h.ca;h.ml(this.ae(1,b,d));return h};c.prototype.RJ=function(b){this.Hc()?b.Oa():(b.ca=this.ae(0,0,0),b.ha=b.ca,b.ml(this.ae(1,0,0)))};c.prototype.Ex=function(b,d){d.Fg(this.description);d.rb(this.gc(b));for(var h=1,c=this.description.Ea;h<c;h++)for(var q=this.description.Id(h),
v=f.na.Xa(q),D=0;D<v;D++){var H=this.Yc(b,q,D);d.setAttribute(q,D,H)}};c.prototype.LO=function(b){if(this.description!=b.description||this.ua!=b.ua||this.sa!=b.sa||this.ra!=b.ra||this.oa!=b.oa)return!1;for(var d=0;d<2*(this.description.af.length-2);d++)if(this.la[d]!=b.la[d])return!1;return!0};c.prototype.NH=function(){return this.ua==this.sa&&this.ra==this.oa};c.prototype.reverse=function(){var b=this.ua;this.ua=this.sa;this.sa=b;b=this.ra;this.ra=this.oa;this.oa=b;for(var b=1,d=this.description.Ea;b<
d;b++)for(var h=this.description.zd(b),c=0,q=f.na.Xa(h);c<q;c++){var v=this.ae(0,h,c),D=this.ae(1,h,c);this.oo(0,h,c,D);this.oo(1,h,c,v)}};c.prototype.xs=function(b,d,h){var c=b.G();switch(this.G()){case 322:if(322==c)return f.Hb.PO(this,b,d,h);throw f.f.ya();default:throw f.f.ya();}};c.prototype.OO=function(b,d,h,c,q){var l=b.G();switch(this.G()){case 322:if(322==l)return f.Hb.Fy(this,b,d,h,c,q);throw f.f.ya();default:throw f.f.ya();}};c.prototype.By=function(){return null};c.vl=function(b,d){return d*
(b.af.length-2)};c.prototype.gc=function(b,d){if(void 0===d)return d=new f.b,this.gc(b,d),d;f.Ub.lV(this.ua,this.ra,this.sa,this.oa,b,d)};c.prototype.oe=function(){return null};c.prototype.pH=function(){return null};c.prototype.Sq=function(){return null};c.prototype.fh=function(){return null};c.prototype.Go=function(){return null};c.prototype.Eg=function(){return null};c.prototype.Cy=function(b,d){return void 0!==d?this.by(d)-this.by(b):this.by(b)};c.prototype.iq=function(){};c.prototype.Hl=function(){return null};
c.prototype.yh=function(){};c.prototype.Yc=function(){return null};c.prototype.pf=function(){return null};c.prototype.by=function(){return null};c.prototype.aI=function(){return null};c.prototype.Cb=function(b,d){if(!d&&0!=this.xs(b,0,!1))return 0;d=1.7976931348623157E308;var h,c;h=this.ec();c=b.oe(h,!1);h.sub(b.gc(c));h=h.length();h<d&&(d=h);h=this.Cc();c=b.oe(h,!1);h.sub(b.gc(c));h=h.length();h<d&&(d=h);h=b.ec();c=this.oe(h,!1);h.sub(this.gc(c));h=h.length();h<d&&(d=h);h=b.Cc();c=this.oe(h,!1);
h.sub(this.gc(c));h=h.length();h<d&&(d=h);return d};c.prototype.Gg=function(){return f.Pi.Sm(this,null)};return c}(f.T);f.bE=a})(C||(C={}));new C.b;(function(f){(function(f){f[f.Unknown=-1]="Unknown";f[f.Not=0]="Not";f[f.Weak=1]="Weak";f[f.Strong=2]="Strong"})(f.uM||(f.uM={}));(function(f){f[f.DirtyIsKnownSimple=1]="DirtyIsKnownSimple";f[f.IsWeakSimple=2]="IsWeakSimple";f[f.IsStrongSimple=4]="IsStrongSimple";f[f.DirtyOGCFlags=8]="DirtyOGCFlags";f[f.DirtyVerifiedStreams=32]="DirtyVerifiedStreams";
f[f.DirtyExactIntervals=64]="DirtyExactIntervals";f[f.DirtyLooseIntervals=128]="DirtyLooseIntervals";f[f.DirtyIntervals=192]="DirtyIntervals";f[f.DirtyIsEnvelope=256]="DirtyIsEnvelope";f[f.DirtyLength2D=512]="DirtyLength2D";f[f.DirtyRingAreas2D=1024]="DirtyRingAreas2D";f[f.DirtyCoordinates=1993]="DirtyCoordinates";f[f.DirtyAllInternal=65535]="DirtyAllInternal";f[f.DirtyAll=16777215]="DirtyAll"})(f.ZL||(f.ZL={}));var a=function(a){function c(){a.call(this);this.un=65535;this.qa=0;this.lh=-1;this.ob=
null}N(c,a);c.prototype.iq=function(){};c.prototype.Hy=function(){};c.prototype.Oy=function(){};c.prototype.D=function(){return this.qa};c.prototype.u=function(){return this.Hc()};c.prototype.Hc=function(){return 0==this.qa};c.prototype.xk=function(b){return 0!=(this.un&b)};c.prototype.lg=function(b,d){this.un=d?this.un|b:this.un&~b};c.prototype.tc=function(){this.xk(32)&&this.YO()};c.prototype.Bu=function(){if(this.Hc())throw f.f.X("This operation was performed on an Empty Geometry.");};c.prototype.Ae=
function(b,d){if(0>b||b>=this.qa)throw f.f.X("index out of bounds");this.tc();d.Fg(this.description);d.u()&&d.nq();for(var h=0;h<this.description.Ea;h++)for(var c=this.description.Id(h),q=0,v=f.na.Xa(c);q<v;q++){var D=this.xa[h].Of(v*b+q);d.setAttribute(c,q,D)}};c.prototype.uu=function(b,d){this.tc();for(var h=d.description,c=0;c<h.Ea;c++)for(var q=h.Id(c),v=f.na.Xa(q),D=0;D<v;D++){var H=d.Yc(q,D);this.setAttribute(q,b,D,H)}};c.prototype.w=function(b,d){if(0>b||b>=this.D())throw f.f.vd();this.tc();
this.xa[0].fc(2*b,d)};c.prototype.Aa=function(b){var d=new f.b;this.w(b,d);return d};c.prototype.Nc=function(b,d){this.xa[0].fc(2*b,d)};c.prototype.rb=function(b,d,h){if(0>b||b>=this.qa)throw f.f.vd();this.tc();var c=this.xa[0];void 0!==h?(c.write(2*b,d),c.write(2*b+1,h)):c.ho(2*b,d);this.Dc(1993)};c.prototype.kA=function(b){if(0>b||b>=this.D())throw f.f.vd();this.tc();var d=this.xa[0],h=new f.qd;h.x=d.read(2*b);h.y=d.read(2*b+1);h.z=this.hasAttribute(1)?this.xa[1].Of(b):f.na.pe(1);return h};c.prototype.AC=
function(b,d){if(0>b||b>=this.D())throw f.f.vd();this.Ud(1);this.tc();this.Dc(1993);var h=this.xa[0];h.write(2*b,d.x);h.write(2*b+1,d.y);this.xa[1].Dm(b,d.z)};c.prototype.Yc=function(b,d,h){if(0>d||d>=this.qa)throw f.f.vd();var c=f.na.Xa(b);if(h>=c)throw f.f.vd();this.tc();var q=this.description.mg(b);return 0<=q?this.xa[q].Of(d*c+h):f.na.pe(b)};c.prototype.JG=function(b,d,h){return this.Yc(b,d,h)};c.prototype.setAttribute=function(b,d,h,c){if(0>d||d>=this.qa)throw f.f.vd();var l=f.na.Xa(b);if(h>=
l)throw f.f.vd();this.Ud(b);this.tc();b=this.description.mg(b);this.Dc(1993);this.xa[b].Dm(d*l+h,c)};c.prototype.Pa=function(b){this.Bu();this.Ud(b);this.tc();return this.xa[this.description.mg(b)]};c.prototype.Zn=function(b,d){if(null!=d&&f.na.si(b)!=d.si())throw f.f.F();this.Ud(b);b=this.description.mg(b);null==this.xa&&(this.xa=f.Uc.HB(this.description.Ea));this.xa[b]=d;this.Dc(16777215)};c.prototype.mo=function(b){var d=null;if(null!=this.xa)for(var h=f.ye.ux(b,this.description),d=[],c=0,q=b.Ea;c<
q;c++)-1!=h[c]&&(d[c]=this.xa[h[c]]);this.description=b;this.xa=d;this.lh=-1;this.Dc(16777215)};c.prototype.OE=function(b){this.ev(!0);b instanceof f.h?this.R.s(b):this.R.Cp(b)};c.prototype.XO=function(b){this.ev(!1);b instanceof f.h?this.R.s(b):this.R.Cp(b)};c.prototype.Rn=function(b){this.ev(!0);this.R.copyTo(b)};c.prototype.s=function(b){this.OE(b)};c.prototype.Cp=function(b){this.OE(b)};c.prototype.ac=function(b){this.XO(b)};c.prototype.xf=function(b,d){var h=new f.Ac;if(this.Hc())return h.Oa(),
h;this.ev(!0);return this.R.xf(b,d)};c.prototype.jc=function(){var b=this.description.jc();if(!this.Hc())for(var d=this.D(),h=0,c=this.description.Ea;h<c;h++)b=this.xa[h].zk(b,0,d*f.na.Xa(this.description.Id(h)));return b};c.prototype.Eb=function(b){if(b==this)return!0;if(!(b instanceof c&&this.description.Eb(b.description))||this.Hc()!=b.Hc())return!1;if(this.Hc())return!0;var d=this.D();if(d!=b.D())return!1;for(var h=0;h<this.description.Ea;h++){var l=this.description.zd(h),q=this.Pa(l),v=b.Pa(l);
if(!q.Eb(v,0,d*f.na.Xa(l)))return!1}return!0};c.prototype.copyTo=function(b){if(b.G()!=this.G())throw f.f.F();this.wE(b)};c.prototype.wE=function(b){this.tc();b.description=this.description;b.xa=null;var d=this.description.Ea,h=null;if(null!=this.xa)for(var h=[],c=0;c<d;c++)null!=this.xa[c]&&(h[c]=this.xa[c].Sr(this.D()*f.na.Xa(this.description.Id(c))));null!=this.R?(b.R=this.R.Ja(),this.R.copyTo(b.R)):b.R=null;b.qa=this.qa;b.un=this.un;b.xa=h;try{this.iq(b)}catch(q){throw b.Oa(),f.f.SN();}};c.prototype.LE=
function(){this.qa=0;this.lh=-1;this.xa=null;this.Dc(16777215)};c.prototype.Dc=function(b){16777215==b&&(this.lh=-1,this.Hy());this.un|=b;this.CO();this.Bc()};c.prototype.ev=function(b){this.tc();if(this.xk(192))if(null==this.R?this.R=new f.ci(this.description):this.R.Fg(this.description),this.u())this.R.Oa();else{this.Ny(b);for(var d=1;d<this.description.Ea;d++)for(var h=this.description.Id(d),c=f.na.Xa(h),q=this.xa[d],v=0;v<c;v++){var D=new f.Ac;D.Oa();for(var H=0;H<this.qa;H++){var a=q.Of(H*c+
v);D.Nb(a)}this.R.setInterval(h,v,D)}b&&this.lg(192,!1)}};c.prototype.Ny=function(){this.R.Oa();for(var b=this.xa[0],d=new f.b,h=0;h<this.qa;h++)b.fc(2*h,d),this.R.Nb(d)};c.prototype.uo=function(b){b.Oa();for(var d=this.xa[0],h=new f.b,c=0;c<this.qa;c++)d.fc(2*c,h),b.Nb(h)};c.prototype.YO=function(){if(this.lh<this.qa){null==this.xa&&(this.xa=f.Uc.HB(this.description.Ea));this.lh=2147483647;for(var b=0;b<this.description.Ea;b++){var d=this.description.Id(b);if(null!=this.xa[b]){var h=f.na.Xa(d),c=
f.J.truncate(this.xa[b].size/h);c<this.qa&&(c=f.J.truncate(this.lh>this.qa+5?(5*this.qa+3)/4:this.qa),this.xa[b].resize(c*h,f.na.pe(d)));c<this.lh&&(this.lh=c)}else this.xa[b]=f.Uc.pz(d,this.qa),this.lh=this.qa}}this.Oy();this.lg(32,!1)};c.prototype.zl=function(b){if(0>b)throw f.f.F();b!=this.qa&&(this.qa=b,this.Dc(65535))};c.prototype.Kk=function(b){if(!this.xk(1)){if(!this.xk(2))return 0;if(this.NV>=b)return this.xk(8)?1:2}return-1};c.prototype.Zg=function(b,d){this.NV=d;if(-1==b)this.lg(1,!0),
this.lg(8,!0);else if(this.lg(1,!1),this.lg(8,!0),0==b)this.lg(2,!1),this.lg(4,!1);else if(1==b)this.lg(2,!0),this.lg(4,!1);else if(2==b)this.lg(2,!0),this.lg(4,!0);else throw f.f.X("internal error.");};c.prototype.CO=function(){null!=this.ob&&(this.ob=null)};c.prototype.CE=function(b,d,h,c){if(0>b||b>=this.qa)throw f.f.X("index out of bounds");if(0>d||d>=this.qa)throw f.f.X("index out of bounds");this.tc();c.Fg(this.description);c.u()&&c.nq();for(var l=0;l<this.description.Ea;l++)for(var v=this.description.Id(l),
D=0,H=f.na.Xa(v);D<H;D++){var a=this.xa[l].Of(H*b+D),G=this.xa[l].Of(H*d+D);c.setAttribute(v,D,f.Ub.Wq(a,G,h))}};c.prototype.ws=function(b,d){var h=this.xa[0].g,c=h[2*b]-h[2*d],h=h[2*b+1]-h[2*d+1];return Math.sqrt(c*c+h*h)};c.prototype.Yh=function(b,d){if(0>b||b>=this.qa)throw f.f.vd();if(d.u())throw f.f.F();this.tc();for(var h=d.description,c=0;c<h.Ea;c++)for(var q=h.zd(c),v=f.na.Xa(q),D=0;D<v;D++){var H=d.Yc(q,D);this.setAttribute(q,b,D,H)}};c.prototype.Wu=function(){return null};c.prototype.Hj=
function(){return null};return c}(f.T);f.Lu=a})(C||(C={}));(function(f){var a=function(){function a(){this.pb=this.Oo=null;this.Hn=124234251;this.Cw=!0;this.qf=-1;this.pb=new f.ad(7);this.Oo=null}a.prototype.Ep=function(c){this.Oo=c};a.prototype.NR=function(){this.Cw=!1};a.prototype.Qe=function(c){this.pb.Qe(c)};a.prototype.Js=function(c){var b=this.pb.Pe();this.lY(b);this.oY(c,b);return b};a.prototype.HR=function(c){this.pb.kd(c)};a.prototype.addElement=function(c,b){var d;-1==b?(-1==this.qf&&(this.qf=
this.Js(-1)),d=this.qf):d=b;return this.VE(c,0,d)};a.prototype.ZE=function(c){-1==this.qf&&(this.qf=this.Js(-1));return this.VE(c,1,this.qf)};a.prototype.ro=function(c){var b;-1==this.qf&&(this.qf=this.Js(-1));b=this.qf;var d=this.pb.g;if(-1==b||-1==d[7*b])return c=this.pb.nl([-1,-1,-1,c,this.Ll(),-1,-1]),d=this.pb.g,d[7*b]=c,this.pq(-1,c,b,d),c;var h=-1==b?-1:d[7*b+2];c=this.pb.nl([-1,-1,h,c,this.Ll(),-1,-1]);d=this.pb.g;d[7*h+1]=c;this.Uy(c,d);-1===d[7*c+2]&&(d[7*b]=c);this.pq(-1,c,b,d);return c};
a.prototype.iv=function(c,b,d,h){var l=-1;-1==l&&(-1==this.qf&&(this.qf=this.Js(-1)),l=this.qf);var q=this.pb.g;if(-1==l||-1==q[7*l])return d=this.pb.nl([-1,-1,-1,d,this.Ll(),-1,-1]),q=this.pb.g,q[7*l]=d,this.pq(-1,d,l,q),d;var v;h?(h=-1!=b?this.Oo.compare(this,d,b):-1,v=-1!=c?this.Oo.compare(this,d,c):1):(h=-1,v=1);if(0==h||0==v)return q[7*l+3]=0==h?b:c,-1;(-1!=b&&-1!=c?this.Hn>f.J.GB(this.Hn)>>1:-1!=b)?c=b:h=v;for(b=!0;;){if(0>h)if(v=q[7*c],-1!=v)c=v;else{h=c;d=this.pb.nl([-1,-1,c,d,this.Ll(),-1,
-1]);q=this.pb.g;q[7*c]=d;break}else if(v=q[7*c+1],-1!=v)c=v;else{h=q[7*c+6];d=this.pb.nl([-1,-1,c,d,this.Ll(),-1,-1]);q=this.pb.g;q[7*c+1]=d;break}b&&(h*=-1,b=!1)}this.Uy(d,q);-1===q[7*d+2]&&(q[7*l]=d);this.pq(h,d,l,q);return d};a.prototype.PG=function(){return this.ZS(this.qf)};a.prototype.Ld=function(c,b){b=-1==b?this.qf:b;this.Cw?this.GR(c,b):this.eZ(c,b)};a.prototype.search=function(c,b){for(b=this.ew(b);-1!=b;){var d=this.Oo.compare(this,c,b);if(0==d)return b;b=0>d?this.Pl(b):this.Nq(b)}return-1};
a.prototype.GX=function(c){for(var b=this.ew(-1),d=-1;-1!=b;){var h=c.compare(this,b);if(0==h)return b;0>h?b=this.Pl(b):(d=b,b=this.Nq(b))}return d};a.prototype.kK=function(c){for(var b=this.ew(-1),d=-1;-1!=b;){var h=c.compare(this,b);if(0==h)return b;0>h?(d=b,b=this.Pl(b)):b=this.Nq(b)}return d};a.prototype.ja=function(c){return this.pb.S(c,3)};a.prototype.Pl=function(c){return this.pb.S(c,0)};a.prototype.Nq=function(c){return this.pb.S(c,1)};a.prototype.getParent=function(c){return this.pb.S(c,
2)};a.prototype.nb=function(c){return this.pb.S(c,6)};a.prototype.Ve=function(c){return this.pb.S(c,5)};a.prototype.xc=function(c){return-1==c?this.Ol(this.qf):this.Ol(c)};a.prototype.Fc=function(c){return-1==c?this.Ys(this.qf):this.Ys(c)};a.prototype.RT=function(c){return-1==c?this.mH(this.qf):this.mH(c)};a.prototype.jk=function(c,b){this.mC(c,b)};a.prototype.ew=function(c){return-1==c?this.hH(this.qf):this.hH(c)};a.prototype.clear=function(){this.pb.Vi(!1);this.qf=-1};a.prototype.size=function(c){return-1==
c?this.jH(this.qf):this.jH(c)};a.prototype.NP=function(c,b){for(var d=b[7*c],h=b[7*c+1],l=b[7*c+4];-1!=d||-1!=h;){var q=-1!=d?b[7*d+4]:2147483647,h=-1!=h?b[7*h+4]:2147483647;if(l<=Math.min(q,h))break;q<=h?this.hK(d,b):this.gK(c,b);d=b[7*c];h=b[7*c+1]}};a.prototype.Uy=function(c,b){if(this.Cw)for(var d=b[7*c+4],h=b[7*c+2];-1!=h&&b[7*h+4]>d;)b[7*h]==c?this.hK(c,b):this.gK(h,b),h=b[7*c+2]};a.prototype.gK=function(c,b){var d=b[7*c+1],h;b[7*d+2]=b[7*c+2];b[7*c+2]=d;h=b[7*d];b[7*c+1]=h;-1!=h&&(b[7*h+2]=
c);b[7*d]=c;h=b[7*d+2];-1!=h&&(b[7*h]==c?b[7*h]=d:b[7*h+1]=d)};a.prototype.hK=function(c,b){var d=b[7*c+2],h;b[7*c+2]=b[7*d+2];b[7*d+2]=c;h=b[7*c+1];b[7*d]=h;-1!=h&&(b[7*h+2]=d);b[7*c+1]=d;h=b[7*c+2];-1!=h&&(b[7*h]===d?b[7*h]=c:b[7*h+1]=c)};a.prototype.sl=function(c,b){this.pb.P(c,2,b)};a.prototype.qC=function(c,b){this.pb.P(c,0,b)};a.prototype.uC=function(c,b){this.pb.P(c,1,b)};a.prototype.tC=function(c,b){this.pb.P(c,5,b)};a.prototype.Px=function(c,b){this.pb.P(c,6,b)};a.prototype.NK=function(c,
b){this.pb.P(b,0,c)};a.prototype.lY=function(c){this.pb.P(c,4,0)};a.prototype.oY=function(c,b){this.pb.P(b,5,c)};a.prototype.hH=function(c){return-1==c?-1:this.pb.S(c,0)};a.prototype.Ol=function(c){return-1==c?-1:this.pb.S(c,1)};a.prototype.Ys=function(c){return-1==c?-1:this.pb.S(c,2)};a.prototype.ZS=function(c){return-1==c?-1:this.pb.S(c,3)};a.prototype.jH=function(c){return-1==c?0:this.pb.S(c,4)};a.prototype.mH=function(c){return this.pb.S(c,5)};a.prototype.Ax=function(c){return this.pb.nl([-1,
-1,-1,c,this.Ll(),-1,-1])};a.prototype.Kl=function(c){-1!=c&&this.pb.kd(c)};a.prototype.Ll=function(){this.Hn=f.J.GB(this.Hn);return this.Hn&1073741823};a.prototype.VE=function(c,b,d){var h=this.pb.g;if(-1==d||-1==h[7*d])return c=this.pb.nl([-1,-1,-1,c,this.Ll(),-1,-1]),h=this.pb.g,h[7*d]=c,this.pq(-1,c,d,h),c;for(var l=-1==d?-1:h[7*d];;){var q=-1==b?1:this.Oo.compare(this,c,l);if(0>q)if(q=this.Pl(l),-1!=q)l=q;else{b=l;c=this.pb.nl([-1,-1,l,c,this.Ll(),-1,-1]);h=this.pb.g;h[7*l]=c;break}else{if(1==
b&&0==q)return h[7*d+3]=l,-1;q=h[7*l+1];if(-1!=q)l=q;else{b=h[7*l+6];c=this.pb.nl([-1,-1,l,c,this.Ll(),-1,-1]);h=this.pb.g;h[7*l+1]=c;break}}}this.Uy(c,h);-1===h[7*c+2]&&(h[7*d]=c);this.pq(b,c,d,h);return c};a.prototype.pq=function(c,b,d,h){var l;-1!=c?(l=h[7*c+5],h[7*c+5]=b):l=-1==d?-1:h[7*d+2];h[7*b+5]=l;-1!=l&&(h[7*l+6]=b);h[7*b+6]=c;c==(-1==d?-1:h[7*d+1])&&(h[7*d+1]=b);-1==c&&(h[7*d+2]=b);h[7*d+4]=(-1==d?0:h[7*d+4])+1};a.prototype.ZB=function(c,b){var d=this.pb.g,h=d[7*c+5];c=d[7*c+6];-1!=h?d[7*
h+6]=c:d[7*b+1]=c;-1!=c?d[7*c+5]=h:d[7*b+2]=h;d[7*b+4]=-1===b?-1:d[7*b+4]-1};a.prototype.eZ=function(c,b){this.ZB(c,b);var d=this.Pl(c),h=this.Nq(c),l=this.getParent(c),q=c;if(-1!=d&&-1!=h){this.Hn=f.J.GB(this.Hn);var v;v=1073741823<this.Hn?this.nb(c):this.Ve(c);var D=this.getParent(v)==c;this.pb.$x(c,v,0);this.pb.$x(c,v,1);this.pb.$x(c,v,2);-1!=l?this.Pl(l)==c?this.qC(l,v):this.uC(l,v):this.NK(v,b);D?(d==v?(this.qC(v,c),this.sl(h,v)):h==v&&(this.uC(v,c),this.sl(d,v)),this.sl(c,v),l=v):(this.sl(d,
v),this.sl(h,v),l=this.getParent(c),q=v);d=this.Pl(c);h=this.Nq(c);-1!=d&&this.sl(d,c);-1!=h&&this.sl(h,c)}d=-1!=d?d:h;-1==l?this.NK(d,b):this.Pl(l)==q?this.qC(l,d):this.uC(l,d);-1!=d&&this.sl(d,l);this.Kl(c,b)};a.prototype.GR=function(c,b){var d=this.pb.g;d[7*c+4]=2147483647;var h=-1,l=-1,q=-1===b?-1:d[7*b],f=q==c;f&&(h=d[7*q],l=d[7*q+1],-1==h&&-1==l)?(this.ZB(q,b),this.Kl(q,b),d[7*b]=-1):(this.NP(c,d),q=d[7*c+2],-1!=q&&(d[7*q]==c?d[7*q]=-1:d[7*q+1]=-1),this.ZB(c,b),this.Kl(c,b),f&&(d[7*b]=-1==h||
-1!=d[7*h+2]?l:h))};a.prototype.mC=function(c,b){this.pb.P(c,3,b)};return a}();f.tk=a})(C||(C={}));(function(f){var a=function(){function a(c,b){void 0!==c&&this.I(c,b)}a.prototype.I=function(c,b){this.ca=c;this.ha=b;this.normalize()};a.prototype.Yb=function(c){return this.ca<=c.ca?this.ha>=c.ca:c.ha>=this.ca};a.prototype.move=function(c){this.u()||(this.ca+=c,this.ha+=c)};a.prototype.normalize=function(){if(!isNaN(this.ca)){if(this.ca>this.ha){var c=this.ca;this.ca=this.ha;this.ha=c}isNaN(this.ha)&&
this.Oa()}};a.prototype.Oa=function(){this.ha=this.ca=NaN};a.prototype.u=function(){return isNaN(this.ca)};a.prototype.Nb=function(c){"number"===typeof c?this.u()?this.ha=this.ca=c:this.ml(c):c.u()||(this.u()?(this.ca=c.ca,this.ha=c.ha):(this.ca>c.ca&&(this.ca=c.ca),this.ha<c.ha&&(this.ha=c.ha),this.ca>this.ha&&this.Oa()))};a.prototype.ml=function(c){c<this.ca?this.ca=c:c>this.ha&&(this.ha=c)};a.prototype.contains=function(c){return"number"===typeof c?c>=this.ca&&c<=this.ha:c.ca>=this.ca&&c.ha<=this.ha};
a.prototype.Ma=function(c){this.u()||c.u()?this.Oa():(this.ca<c.ca&&(this.ca=c.ca),this.ha>c.ha&&(this.ha=c.ha),this.ca>this.ha&&this.Oa())};a.prototype.O=function(c){this.u()||(this.ca-=c,this.ha+=c,this.ha<this.ca&&this.Oa())};a.prototype.no=function(){return this.u()?2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.ca)+Math.abs(this.ha)+1)};a.prototype.jC=function(c,b){c>b?(this.ca=b,this.ha=c):(this.ca=c,this.ha=b)};a.prototype.vu=function(c){return f.J.nk(c,this.ca,this.ha)};a.prototype.N=
function(){return this.ha-this.ca};a.prototype.Wf=function(){return.5*(this.ca+this.ha)};a.prototype.Eb=function(c){return c==this?!0:c instanceof a?this.u()&&c.u()?!0:this.ca!=c.ca||this.ha!=c.ha?!1:!0:!1};a.prototype.jc=function(){return f.J.Zi(f.J.Zi())};return a}();f.Ac=a})(C||(C={}));(function(f){var a=new f.Ac,e=new f.Ac,c=function(){return function(){this.Le=null;this.qb=-1;this.wb=new f.Hb;this.XA=55555555;this.Ew=this.Hw=!1;this.rg=new f.Ac;this.rg.jC(0,0)}}();f.j_=c;var b=function(){function b(b,
d,q){this.a=b;this.il=NaN;this.$I=this.zr=0;this.aJ=NaN;this.ta=d;this.Cr=10*d;this.bJ=this.cJ=NaN;this.Ng=!1;this.sn=this.Xt=this.vp=this.Rt=this.Qt=-1;this.OA=q;this.yB=new c;this.jJ=new c;f.J.truncate(3*b.ud/2)}b.prototype.zH=function(b,d,c,f){b.Le=null===f?null:f[c[5*d]];b.Ew=null!=b.Le;b.Ew||(f=c[5*d+2],-1!==f&&this.a.fX(c[5*d],c[5*f],b.wb),b.Le=b.wb,b.rg.jC(b.wb.ua,b.wb.sa),b.rg.ha+=this.ta,b.wb.AJ(),b.Hw=b.wb.oa==b.wb.ra,b.Hw||(b.XA=(b.wb.sa-b.wb.ua)/(b.wb.oa-b.wb.ra)))};b.prototype.QQ=function(b,
d){var h=b.xs(d,this.ta,!0);if(0!=h)return 2==h?this.zz():this.Wi();b.Oq(O);b.Os(R);d.Oq(Q);d.Os(T);J.ka(this.zr,this.il);O.ub(Q)&&this.il==O.y?0>R.compare(T)?J.L(R):J.L(T):O.ub(T)&&this.il==O.y?0>R.compare(Q)?J.L(R):J.L(Q):Q.ub(R)&&this.il==Q.y?0>O.compare(T)?J.L(O):J.L(T):R.ub(T)&&this.il==R.y&&(0>O.compare(Q)?J.L(O):J.L(Q));return b.pf(J.y,J.x)<d.pf(J.y,J.x)?-1:1};b.prototype.OQ=function(b,d){if(b.wb.ra==d.wb.ra&&b.wb.ua==d.wb.ua)return b.wb.oa==d.wb.oa&&b.wb.sa==d.wb.sa?this.OA?this.zz():0:this.UF(b,
d);if(b.wb.oa==d.wb.oa&&b.wb.sa==d.wb.sa)return this.TF(b,d);var h=this.TF(b,d);b=this.UF(b,d);return 0>h&&0>b?-1:0<h&&0<b?1:this.Wi()};b.prototype.KQ=function(b,d){if(b.sa>d.sa){if(d.sa>d.ua&&d.oa-d.ra<2*this.ta&&b.Si(d.sa,d.oa,this.ta))return this.Wi()}else if((d.oa-d.ra)/(d.sa-d.ua)*(b.sa-b.ua)<this.Cr&&d.Si(b.sa,b.oa,this.ta))return this.Wi();return 1};b.prototype.LQ=function(b,d){if(b.ua<d.ua){if(d.sa>d.ua&&d.oa-d.ra<2*this.ta&&b.Si(d.sa,d.oa,this.ta))return this.Wi()}else if((d.oa-d.ra)/(d.sa-
d.ua)*(b.ua-b.sa)<this.Cr&&d.Si(b.ua,b.ra,this.ta))return this.Wi();return-1};b.prototype.MQ=function(b,d){var h=new f.b;h.zc(d.Cc(),d.ec());h.Tr();h.normalize();var c=new f.b;c.zc(b.ec(),d.ec());var l=new f.b;l.zc(b.Cc(),d.ec());var c=c.oi(h),h=l.oi(h),l=Math.abs(c),H=Math.abs(h);if(l<H){if(l<this.Cr&&d.Si(b.ua,b.ra,this.ta))return this.Wi()}else if(H<this.Cr&&d.Si(b.sa,b.oa,this.ta))return this.Wi();return 0>c&&0>h?-1:0<c&&0<h?1:this.Wi()};b.prototype.SF=function(b,d){return b.ra==d.ra&&b.ua==d.ua?
this.KQ(b,d):b.oa==d.oa&&b.sa==d.sa?this.LQ(b,d):this.MQ(b,d)};b.prototype.NQ=function(b,d){return b.oa==d.oa&&b.sa==d.sa&&b.ra==d.ra&&b.ua==d.ua?this.OA?this.zz():0:this.Wi()};b.prototype.TF=function(b,d){var h=1;if(b.wb.ra<d.wb.ra){var h=-1,c=b;b=d;d=c}c=b.wb;b=d.wb;var l=c.ua-b.ua;d=d.XA*(c.ra-b.ra);var f=this.Cr;return l<d-f?-h:l>d+f?h:b.Si(c.ua,c.ra,this.ta)?this.Wi():l<d?-h:h};b.prototype.UF=function(b,d){var h=1;if(d.wb.oa<b.wb.oa){var h=-1,c=b;b=d;d=c}c=b.wb;b=d.wb;var l=c.sa-b.ua;d=d.XA*
(c.oa-b.ra);var f=this.Cr;return l<d-f?-h:l>d+f?h:b.Si(c.sa,c.oa,this.ta)?this.Wi():l<d?-h:h};b.prototype.zz=function(){this.Ng=!0;this.mj=new f.$d(5,this.vp,this.Xt);return-1};b.prototype.Wi=function(){this.Ng=!0;this.OA?this.mj=new f.$d(4,this.vp,this.Xt):this.Xt=this.vp=this.Rt=this.Qt=-1;return-1};b.prototype.PQ=function(b,d,c,f){if(this.Ng)return-1;var h=this.aJ==this.il&&this.$I==this.zr,l;h&&b==this.Qt?l=this.bJ:(l=NaN,this.Qt=-1);h&&d==this.Rt?h=this.cJ:(h=NaN,this.Rt=-1);c.Le.RJ(a);f.Le.RJ(e);
if(a.ha<e.ca)return-1;if(e.ha<a.ca)return 1;this.aJ=this.il;this.$I=this.zr;isNaN(l)&&(this.Qt=b,this.bJ=l=b=c.Le.pf(this.il,this.zr));isNaN(h)&&(this.Rt=d,this.cJ=h=b=f.Le.pf(this.il,this.zr));return Math.abs(l-h)<=this.ta?this.QQ(c.Le,f.Le):l<h?-1:l>h?1:0};b.prototype.Fs=function(){this.Ng=!1};b.prototype.fn=function(){return this.mj};b.prototype.PK=function(b,d){this.il=b;this.zr=d;this.Xt=this.vp=this.Rt=this.Qt=-1};b.prototype.compare=function(b,d,c){if(this.Ng)return-1;b=b.ja(c);this.sn=c;return this.WF(d,
d,b,b)};b.prototype.WF=function(b,d,c,f){var h;this.vp==d?h=this.yB:(this.vp=d,h=this.yB,this.yB.qb=b,this.zH(h,d,this.a.Dd.g,this.a.wf));var l;null==l&&(this.Xt=f,l=this.jJ,this.jJ.qb=c,this.zH(l,f,this.a.Dd.g,this.a.wf));if(h.Ew||l.Ew)return this.PQ(d,f,h,l);if(h.rg.ha<l.rg.ca)return-1;if(l.rg.ha<h.rg.ca)return 1;b=h.Hw?1:0;b|=l.Hw?2:0;return 0==b?this.OQ(h,l):1==b?this.SF(h.wb,l.wb):2==b?-1*this.SF(l.wb,h.wb):this.NQ(h.wb,l.wb)};return b}();f.eE=b})(C||(C={}));(function(f){var a=function(){function a(c,
b){this.a=c;this.ta=b;this.Ng=!1;this.vp=-1;this.rg=new f.Ac;this.vr=new f.b;this.vr.$c();this.Fe=new f.Hb;this.sn=-1;this.gB=1.7976931348623157E308}a.prototype.Fs=function(){this.Ng=!1;this.gB=1.7976931348623157E308};a.prototype.Yh=function(c){this.vr.L(c)};a.prototype.compare=function(c,b){return this.XF(b,c.ja(b))};a.prototype.XF=function(c,b){var d=null!=this.a.ic(b);d||(this.a.pd(b,this.Fe),this.rg.jC(this.Fe.ua,this.Fe.sa));if(d)throw f.f.X("not implemented");if(this.vr.x+this.ta<this.rg.ca)return-1;
if(this.vr.x-this.ta>this.rg.ha)return 1;if(this.Fe.ra==this.Fe.oa)return this.sn=c,this.Ng=!0,0;this.Fe.AJ();b=this.Fe.ec();d=new f.b;d.zc(this.Fe.Cc(),b);d.Tr();var h=new f.b;h.zc(this.vr,b);b=d.oi(h);b/=d.length();return b<10*-this.ta?-1:b>10*this.ta?1:this.Fe.lt(this.vr,this.ta)&&(d=Math.abs(b),d<this.gB&&(this.sn=c,this.gB=d),this.Ng=!0,d<.25*this.ta)?0:0>b?-1:1};return a}();f.$N=a})(C||(C={}));(function(f){function a(c,b,d,h){d=new Float64Array(c.subarray(d,h));c.set(d,b)}var e=function(){function c(b){this.Fa=
this.Ce=!1;this.g=[];var d=b;2>d&&(d=2);this.g=f.J.gf(d,c.Bb);this.size=b}c.prototype.rotate=function(b,d,h){if(this.Fa)throw f.f.X("invalid_call");if(d<b||d>h||b>h)throw f.f.F();b!=d&&h!=d&&(this.Zd(b,d-b,1),this.Zd(d,h-d,1),this.Zd(b,h-b,1))};c.yd=function(b,d){c.Bb=d;b=new c(b);c.Bb=0;return b};c.Ak=function(b){var d=new c(0);d.g=b.g.slice(0);d.size=b.size;return d};c.$=function(b,d){var h=new c(0);h.size=b.size;h.size>d&&(h.size=d);h.g=b.g.slice(0,h.size);return h};c.prototype.yb=function(){};
c.prototype.read=function(b){return this.g[b]};c.prototype.fc=function(b,d){d.x=this.g[b];d.y=this.g[b+1]};c.prototype.nX=function(b,d){d.x=this.g[b];d.y=this.g[b+1]};c.prototype.get=function(b){return this.g[b]};c.prototype.write=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.set=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.ho=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.add=function(b){this.resize(this.size+1);this.g[this.size-
1]=b};c.prototype.Sr=function(b){return c.$(this,b)};c.prototype.Of=function(b){return this.read(b)};c.prototype.resize=function(b,d){void 0===d&&(d=0);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(f.J.truncate(5*b/4)<this.g.length){var h=this.g.slice(0,b);this.g=h}}else if(b>this.g.length){f.J.truncate(64>b?Math.max(2*b,4):5*b/4);for(var h=this.g.slice(0),c=this.g.length;c<b;c++)h[c]=d;this.g=h}this.size=b};c.prototype.yf=function(b){(null==
this.g||b>this.g.length)&&this.resize(b);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Dm=function(b,d){this.write(b,d)};c.prototype.zk=function(b,d,h){for(var c=this.size;d<c&&d<h;d++)b=f.J.Zi(this.read(d));return b};c.prototype.Eb=function(b,d,h){if(null==b||!(b instanceof c))return!1;var l=this.size,q=b.size;if(h>l||h>q&&l!=q)return!1;for(h>l&&(h=l);d<h;d++)if(this.read(d)!=b.read(d))return!1;return!0};c.prototype.Rk=function(b,
d,h,c,q,v,D){if(this.Fa)throw f.f.La();if(!q&&(1>v||0!=c%v))throw f.f.F();var l=this.size-D;l<c&&this.resize(this.size+c-l);for(l=0;l<D-b;l++)this.g[b+c+l]=this.g[b+l];this.g==d.g&&b<h&&(h+=c);if(q)for(l=0;l<c;l++)this.g[l+b]=d.g[h+l];else for(q=c,D=0;D<c;D+=v)for(q-=v,l=0;l<v;l++)this.g[b+D+l]=d.g[h+q+l]};c.prototype.Qk=function(b,d,h,c){if(this.Fa)throw f.f.La();c-=b;for(var l=this.g.slice(b,b+c),v=0;v<c;v++)this.g[b+h+v]=l[v];for(c=0;c<h;c++)this.g[b+c]=d};c.prototype.eh=function(b,d,h){if(this.Fa)throw f.f.La();
for(var c=this.g.slice(b,b+(h-b)),q=0;q<h-b;q++)this.g[q+b+2]=c[q];this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.hs=function(b,d,h,c,q){if(0>b||0>d||0>c)throw f.f.F();if(h.length<c+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),q)for(q=0;q<d;q++)this.g[b+q]=h[c+q];else for(q||(b+=d-1),d=c+d;c<d;c++)this.g[b]=h[c],b--};c.prototype.Em=function(b,d,h,c,q,v){if(0>b||0>d||0>c)throw f.f.F();if(!q&&(0>=v||0!=d%v))throw f.f.F();if(h.size<c+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+
b),h==this)this.Ij(b,d,c,q,v);else if(q)for(q=0;q<d;q++)this.g[b]=h.g[c],b++,c++;else if(c=c+d-v,1==v)for(q=0;q<d;q++)this.g[b]=h.g[c],b++,c--;else for(q=0,d=f.J.truncate(d/v);q<d;q++){for(var l=0;l<v;l++)this.g[b+l]=h.g[c+l];b+=v;c-=v}};c.prototype.Ek=function(b,d,h){if(this.Fa)throw f.f.La();if(b+d>this.size)throw f.f.La();if(0<h-(b+d)){h-=b+d;for(var c=this.g.slice(b+d,b+h+d),q=0;q<h;q++)this.g[b+q]=c[q]}this.size-=d};c.prototype.Zd=function(b,d,h){if(this.Fa)throw f.f.La();if(1>h||0!=d%h)throw f.f.La();
for(var c=d>>1,q=0;q<c;q+=h){d-=h;for(var v=0;v<h;v++){var D=this.g[b+q+v];this.g[b+q+v]=this.g[b+d+v];this.g[b+d+v]=D}}};c.prototype.Zh=function(b,d,h){if(0>d||0>h||0>d||h+d>this.size)throw f.f.F();for(var c=d;c<d+h;c++)this.g[c]=b};c.prototype.Ij=function(b,d,h,c,q){if(!c||b!=h){for(var l=0;l<d;l++)this.g[b+l]=this.g[h+l];if(!c)for(h=b,b=b+d-q,c=0,d=f.J.truncate(d/2);c<d;c++){for(l=0;l<q;l++){var D=this.g[h+l];this.g[h+l]=this.g[b+l];this.g[b+l]=D}h+=q;b-=q}}};c.prototype.js=function(b,d,h,c,q){if(0>
b||0>d||0>c)throw f.f.F();if(0!=d)for(this.size<(d<<1)+b&&this.resize((d<<1)+b),q||(b+=d-1<<1),q=q?2:-2,d+=c;c<d;c++)this.g[b]=h[c].x,this.g[b+1]=h[c].y,b+=q};c.prototype.gy=function(b,d,h,c,q){if(0>b||0>d||0>c)throw f.f.F();if(0!=d)for(this.size<(d<<1)+b&&this.resize((d<<1)+b),q||(b+=d-1<<1),q=q?2:-2,d+=c;c<d;c++)this.g[b]=h[c][0],this.g[b+1]=h[c][1],b+=q};c.prototype.pl=function(b,d,h,c,q){if(0>b||0>d||0>c||this.size<d+b)throw f.f.F();if(q)for(q=0;q<d;q++)h[c+q]=this.g[b+q];else for(c=c+d-1;b<d;b++)h[c]=
this.g[b],c--};c.prototype.Gx=function(b,d,h,c,q){if(0>b||0>d||0>c||this.size<(d>>1)+b)throw f.f.F();if(0!=d)for(q||(b+=d-1),q=q?2:-2,d=c+d;c<d;c++)h[c][0]=this.g[b],h[c][1]=this.g[b+1],b+=q};c.prototype.clear=function(b){b?this.resize(0):this.yf(0)};c.prototype.Mp=function(){this.Ce=this.Fa=!0};c.prototype.Gd=function(b,d,h){var c=this.g.slice(0,b),q=this.g.slice(d);b=this.g.slice(b,d).sort(h);this.g.length=0;this.g.push.apply(this.g,c.concat(b).concat(q))};c.prototype.si=function(){return 1};c.Bb=
0;return c}();f.Sd=e;e=function(){function c(b){this.Fa=this.Ce=!1;this.g=null;var d=b;2>d&&(d=2);this.g=new Float64Array(d);this.size=b}c.prototype.rotate=function(b,d,h){if(this.Fa)throw f.f.X("invalid_call");if(d<b||d>h||b>h)throw f.f.F();b!=d&&h!=d&&(this.Zd(b,d-b,1),this.Zd(d,h-d,1),this.Zd(b,h-b,1))};c.yd=function(b,d){var h=new c(b),l=h.g;2>b&&(b=2);if(0!==d)for(var q=0;q<b;q++)l[q]=d;return h};c.Ak=function(b){var d=new c(0);d.g=new Float64Array(b.g);d.size=b.size;return d};c.$=function(b,
d){var h=new c(0);h.size=b.size;h.size>d&&(h.size=d);d=h.size;2>d&&(d=2);h.g=new Float64Array(d);h.g.set(b.g.length<=d?b.g:b.g.subarray(0,d),0);return h};c.prototype.yb=function(b){0>=b||(null==this.g?this.g=new Float64Array(b):b<=this.g.length||(0<this.g.length?(b=new Float64Array(b),b.set(this.g),this.g=b):this.g=new Float64Array(b)))};c.prototype.read=function(b){return this.g[b]};c.prototype.fc=function(b,d){d.x=this.g[b];d.y=this.g[b+1]};c.prototype.get=function(b){return this.g[b]};c.prototype.write=
function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.set=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.ho=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.add=function(b){this.resize(this.size+1);this.g[this.size-1]=b};c.prototype.Sr=function(b){return c.$(this,b)};c.prototype.Of=function(b){return this.read(b)};c.prototype.resize=function(b,d){void 0===d&&(d=0);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");
if(b<=this.size){if(30<this.g.length&&5*b/4<this.g.length){var h=new Float64Array(this.g,0,b);this.g=h}}else{b>this.g.length&&(h=f.J.truncate(64>b?Math.max(2*b,4):5*b/4),h=new Float64Array(h),h.set(this.g),this.g=h);for(var h=this.g,c=this.size;c<b;c++)h[c]=d}this.size=b};c.prototype.yf=function(b){(null==this.g||b>this.g.length)&&this.resize(b);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Dm=function(b,d){this.write(b,d)};c.prototype.zk=
function(b,d,h){for(var c=this.size;d<c&&d<h;d++)b=f.J.Zi(this.read(d));return b};c.prototype.Eb=function(b,d,h){if(null==b||!(b instanceof c))return!1;var l=this.size,q=b.size;if(h>l||h>q&&l!=q)return!1;for(h>l&&(h=l);d<h;d++)if(this.read(d)!=b.read(d))return!1;return!0};c.prototype.Rk=function(b,d,h,c,q,v,D){if(this.Fa)throw f.f.La();if(!q&&(1>v||0!=c%v))throw f.f.F();var l=this.size-D;l<c&&this.resize(this.size+c-l);a(this.g,b+c,b,b+(D-b));this.g==d.g&&b<h&&(h+=c);if(q)this.g.set(d.g.subarray(h,
h+c),b);else for(q=c,D=0;D<c;D+=v)for(q-=v,l=0;l<v;l++)this.g[b+D+l]=d.g[h+q+l]};c.prototype.Qk=function(b,d,h,c){if(this.Fa)throw f.f.La();c-=b;a(this.g,b+c,b,b+c);for(c=0;c<h;c++)this.g[b+c]=d};c.prototype.eh=function(b,d,h){if(this.Fa)throw f.f.La();a(this.g,b+2,b,b+(h-b));this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.hs=function(b,d,h,c,q){if(0>b||0>d||0>c)throw f.f.F();if(h.length<c+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),q)this.g.set(h.subarray(c,d),b);else for(q||(b+=d-1),d=
c+d;c<d;c++)this.g[b]=h[c],b--};c.prototype.Em=function(b,d,h,c,q,v){if(0>b||0>d||0>c)throw f.f.F();if(!q&&(0>=v||0!=d%v))throw f.f.F();if(h.size<c+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),h==this)this.Ij(b,d,c,q,v);else if(q)for(q=0;q<d;q++)this.g[b]=h.g[c],b++,c++;else if(c=c+d-v,1==v)for(q=0;q<d;q++)this.g[b]=h.g[c],b++,c--;else for(q=0,d=f.J.truncate(d/v);q<d;q++){for(var l=0;l<v;l++)this.g[b+l]=h.g[c+l];b+=v;c-=v}};c.prototype.Ek=function(b,d,c){if(this.Fa)throw f.f.La();if(b+
d>this.size)throw f.f.La();0<c-(b+d)&&a(this.g,b,b+d,b+(c-(b+d))+d);this.size-=d};c.prototype.Zd=function(b,d,c){if(this.Fa)throw f.f.La();if(1>c||0!=d%c)throw f.f.La();for(var h=d>>1,q=0;q<h;q+=c){d-=c;for(var v=0;v<c;v++){var D=this.g[b+q+v];this.g[b+q+v]=this.g[b+d+v];this.g[b+d+v]=D}}};c.prototype.Zh=function(b,d,c){if(0>d||0>c||0>d||c+d>this.size)throw f.f.F();for(var h=d;h<d+c;h++)this.g[h]=b};c.prototype.Ij=function(b,d,c,l,q){if(!l||b!=c)if(this.g.set(this.g.subarray(c,c+d),b),!l)for(c=b,
b=b+d-q,l=0,d=f.J.truncate(d/2);l<d;l++){for(var h=0;h<q;h++){var D=this.g[c+h];this.g[c+h]=this.g[b+h];this.g[b+h]=D}c+=q;b-=q}};c.prototype.js=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(0!=d)for(this.size<(d<<1)+b&&this.resize((d<<1)+b),q||(b+=d-1<<1),q=q?2:-2,d+=l;l<d;l++)this.g[b]=c[l].x,this.g[b+1]=c[l].y,b+=q};c.prototype.gy=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(0!=d)for(this.size<(d<<1)+b&&this.resize((d<<1)+b),q||(b+=d-1<<1),q=q?2:-2,d+=l;l<d;l++)this.g[b]=c[l][0],
this.g[b+1]=c[l][1],b+=q};c.prototype.pl=function(b,d,c,l,q){if(0>b||0>d||0>l||this.size<d+b)throw f.f.F();if(q)for(q=0;q<d;q++)c[l+q]=this.g[b+q];else for(l=l+d-1;b<d;b++)c[l]=this.g[b],l--};c.prototype.Gx=function(b,d,c,l,q){if(0>b||0>d||0>l||this.size<(d>>1)+b)throw f.f.F();if(0!=d)for(q||(b+=d-1),q=q?2:-2,d=l+d;l<d;l++)c[l][0]=this.g[b],c[l][1]=this.g[b+1],b+=q};c.prototype.clear=function(b){b?this.resize(0):this.yf(0)};c.prototype.Mp=function(){this.Ce=this.Fa=!0};c.prototype.Gd=function(b,d,
c){Array.prototype.sort.call(this.g.subarray(b,d),c)};c.prototype.si=function(){return 1};return c}();f.JL=e})(C||(C={}));!0===C.Xh.Bm&&!0===C.Xh.iw&&(C.Sd=C.JL);(function(f){function a(c,b,d,h){d=new Int32Array(c.subarray(d,h));c.set(d,b)}f.AZ=function(){return function(){this.random=1973}}();var e=function(){function c(b){this.Fa=this.Ce=!1;this.g=[];var d=b;2>d&&(d=2);this.g=this.g=f.J.gf(d,c.Bb);this.size=b}c.prototype.rotate=function(b,d,c){if(this.Fa)throw f.f.X("invalid_call");if(d<b||d>c||
b>c)throw f.f.F();b!=d&&c!=d&&(this.Zd(b,d-b,1),this.Zd(d,c-d,1),this.Zd(b,c-b,1))};c.yd=function(b,d){c.Bb=d;b=new c(b);c.Bb=0;return b};c.Ak=function(b){var d=new c(0);d.g=b.g.slice(0);d.size=b.size;return d};c.$=function(b,d){var h=new c(0);h.size=b.size;h.size>d&&(h.size=d);h.g=b.g.slice(0,h.size);return h};c.prototype.yb=function(){};c.prototype.read=function(b){return this.g[b]};c.prototype.fc=function(b,d){d.x=this.g[b];d.y=this.g[b+1]};c.prototype.get=function(b){return this.g[b]};c.prototype.write=
function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.set=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.ho=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.add=function(b){this.resize(this.size+1);this.g[this.size-1]=b};c.prototype.Sr=function(b){return c.$(this,b)};c.prototype.Of=function(b){return this.read(b)};c.prototype.resize=function(b,d){void 0===d&&(d=0);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");
if(b<=this.size){if(f.J.truncate(5*b/4)<this.g.length){var c=this.g.slice(0,b);this.g=c}}else if(b>this.g.length){f.J.truncate(64>b?Math.max(2*b,4):5*b/4);for(var c=this.g.slice(0),l=this.g.length;l<b;l++)c[l]=d;this.g=c}this.size=b};c.prototype.yf=function(b){(null==this.g||b>this.g.length)&&this.resize(b);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Dm=function(b,d){this.write(b,d)};c.prototype.zk=function(b,d,c){for(var h=this.size;d<
h&&d<c;d++)b=f.J.dh(this.read(d),b);return b};c.prototype.Eb=function(b,d,h){if(null==b||!(b instanceof c))return!1;var l=this.size,q=b.size;if(h>l||h>q&&l!=q)return!1;for(h>l&&(h=l);d<h;d++)if(this.read(d)!=b.read(d))return!1;return!0};c.prototype.Rk=function(b,d,c,l,q,v,D){if(this.Fa)throw f.f.La();if(!q&&(1>v||0!=l%v))throw f.f.F();for(var h=0;h<D-b;h++)this.g[b+l+h]=this.g[b+h];this.g==d.g&&b<c&&(c+=l);if(q)for(h=0;h<l;h++)this.g[h+b]=d.g[c+h];else for(q=l,D=0;D<l;D+=v)for(q-=v,h=0;h<v;h++)this.g[b+
D+h]=d.g[c+q+h]};c.prototype.Qk=function(b,d,c,l){if(this.Fa)throw f.f.La();l-=b;for(var h=this.g.slice(b,b+l),v=0;v<l;v++)this.g[b+c+v]=h[v];for(l=0;l<c;l++)this.g[b+l]=d};c.prototype.eh=function(b,d,c){if(this.Fa)throw f.f.La();for(var h=this.g.slice(b,b+(c-b)),q=0;q<c-b;q++)this.g[q+b+2]=h[q];this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.hs=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(c.length<l+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),q)for(q=0;q<d;q++)this.g[b+q]=c[l+
q];else for(q||(b+=d-1),d=l+d;l<d;l++)this.g[b]=c[l],b--};c.prototype.Em=function(b,d,c,l,q,v){if(0>b||0>d||0>l)throw f.f.F();if(!q&&(0>=v||0!=d%v))throw f.f.F();if(c.size<l+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),c==this)this.Ij(b,d,l,q,v);else if(q)for(q=0;q<d;q++)this.g[b]=c.g[l],b++,l++;else if(l=l+d-v,1==v)for(q=0;q<d;q++)this.g[b]=c.g[l],b++,l--;else for(q=0,d=f.J.truncate(d/v);q<d;q++){for(var h=0;h<v;h++)this.g[b+h]=c.g[l+h];b+=v;l-=v}};c.prototype.Ek=function(b,d,c){if(this.Fa)throw f.f.La();
if(b+d>this.size)throw f.f.La();if(0<c-(b+d)){c-=b+d;for(var h=this.g.slice(b+d,b+c+d),q=0;q<c;q++)this.g[b+q]=h[q]}this.size-=d};c.prototype.Zd=function(b,d,c){if(this.Fa)throw f.f.La();if(1>c||0!=d%c)throw f.f.La();for(var h=d>>1,q=0;q<h;q+=c){d-=c;for(var v=0;v<c;v++){var D=this.g[b+q+v];this.g[b+q+v]=this.g[b+d+v];this.g[b+d+v]=D}}};c.prototype.Zh=function(b,d,c){if(0>d||0>c||0>d||c+d>this.size)throw f.f.F();for(var h=d;h<d+c;h++)this.g[h]=b};c.prototype.Ij=function(b,d,c,l,q){if(!l||b!=c){for(var h=
0;h<d;h++)this.g[b+h]=this.g[c+h];if(!l)for(c=b,b=b+d-q,l=0,d=f.J.truncate(d/2);l<d;l++){for(h=0;h<q;h++){var D=this.g[c+h];this.g[c+h]=this.g[b+h];this.g[b+h]=D}c+=q;b-=q}}};c.prototype.js=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(0!=d)for(this.size<(d<<1)+b&&this.resize((d<<1)+b),q||(b+=d-1<<1),q=q?2:-2,d+=l;l<d;l++)this.g[b]=c[l].x,this.g[b+1]=c[l].y,b+=q};c.prototype.pl=function(b,d,c,l,q){if(0>b||0>d||0>l||this.size<d+b)throw f.f.F();if(q)for(q=0;q<d;q++)c[l+q]=this.g[b+q];else for(l=
l+d-1;b<d;b++)c[l]=this.g[b],l--};c.prototype.clear=function(b){b?this.resize(0):this.yf(0)};c.prototype.Mp=function(){this.Ce=this.Fa=!0};c.prototype.Gd=function(b,d,c){var h=this.g.slice(0,b),q=this.g.slice(d);b=this.g.slice(b,d).sort(c);this.g.length=0;this.g.push.apply(this.g,h.concat(b).concat(q))};c.prototype.si=function(){return 2};c.prototype.Fc=function(){return this.g[this.size-1]};c.prototype.Pf=function(){this.resize(this.size-1)};c.prototype.BK=function(b){this.g[this.size-1]=b};c.prototype.GJ=
function(b){b<this.size-1&&(this.g[b]=this.g[this.size-1]);this.resize(this.size-1)};c.prototype.Nv=function(b){for(var d=0,c=this.size;d<c;d++)if(this.g[d]==b)return d;return-1};c.prototype.mA=function(b){return 0<=this.Nv(b)};c.Bb=0;return c}();f.ia=e;e=function(){function c(b){this.Fa=this.Ce=!1;this.g=null;var d=b;2>d&&(d=2);this.g=new Int32Array(d);this.size=b}c.prototype.rotate=function(b,d,c){if(this.Fa)throw f.f.X("invalid_call");if(d<b||d>c||b>c)throw f.f.F();b!=d&&c!=d&&(this.Zd(b,d-b,1),
this.Zd(d,c-d,1),this.Zd(b,c-b,1))};c.yd=function(b,d){var h=new c(b),l=h.g;2>b&&(b=2);if(0!==d)for(var q=0;q<b;q++)l[q]=d;return h};c.Ak=function(b){var d=new c(0);d.g=new Int32Array(b.g);d.size=b.size;return d};c.$=function(b,d){var h=new c(0);h.size=b.size;h.size>d&&(h.size=d);d=h.size;2>d&&(d=2);h.g=new Int32Array(d);h.g.set(b.g.length<=d?b.g:b.g.subarray(0,d),0);return h};c.prototype.yb=function(b){0>=b||(null==this.g?this.g=new Int32Array(b):b<=this.g.length||(0<this.g.length?(b=new Int32Array(b),
b.set(this.g),this.g=b):this.g=new Int32Array(b)))};c.prototype.read=function(b){return this.g[b]};c.prototype.fc=function(b,d){d.x=this.g[b];d.y=this.g[b+1]};c.prototype.get=function(b){return this.g[b]};c.prototype.write=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.set=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.ho=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.add=function(b){this.resize(this.size+1);this.g[this.size-
1]=b};c.prototype.Sr=function(b){return c.$(this,b)};c.prototype.Of=function(b){return this.read(b)};c.prototype.resize=function(b,d){void 0===d&&(d=0);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(30<this.g.length&&5*b/4<this.g.length){var c=new Int32Array(this.g,0,b);this.g=c}}else{b>this.g.length&&(c=f.J.truncate(64>b?Math.max(2*b,4):5*b/4),c=new Int32Array(c),c.set(this.g),this.g=c);for(var c=this.g,l=this.size;l<b;l++)c[l]=d}this.size=
b};c.prototype.yf=function(b){(null==this.g||b>this.g.length)&&this.resize(b);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Dm=function(b,d){this.write(b,d)};c.prototype.zk=function(b,d,c){for(var h=this.size;d<h&&d<c;d++)b=f.J.dh(this.read(d),b);return b};c.prototype.Eb=function(b,d,h){if(null==b||!(b instanceof c))return!1;var l=this.size,q=b.size;if(h>l||h>q&&l!=q)return!1;for(h>l&&(h=l);d<h;d++)if(this.read(d)!=b.read(d))return!1;
return!0};c.prototype.Rk=function(b,d,c,l,q,v,D){if(this.Fa)throw f.f.La();if(!q&&(1>v||0!=l%v))throw f.f.F();a(this.g,b+l,b,b+(D-b));this.g==d.g&&b<c&&(c+=l);if(q)this.g.set(d.g.subarray(c,c+l),b);else for(q=l,D=0;D<l;D+=v){q-=v;for(var h=0;h<v;h++)this.g[b+D+h]=d.g[c+q+h]}};c.prototype.Qk=function(b,d,c,l){if(this.Fa)throw f.f.La();l-=b;a(this.g,b+l,b,b+l);for(l=0;l<c;l++)this.g[b+l]=d};c.prototype.eh=function(b,d,c){if(this.Fa)throw f.f.La();a(this.g,b+2,b,b+(c-b));this.g[b]=d.x;this.g[b+1]=d.y};
c.prototype.hs=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(c.length<l+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),q)this.g.set(c.subarray(l,d),b);else for(q||(b+=d-1),d=l+d;l<d;l++)this.g[b]=c[l],b--};c.prototype.Em=function(b,d,c,l,q,v){if(0>b||0>d||0>l)throw f.f.F();if(!q&&(0>=v||0!=d%v))throw f.f.F();if(c.size<l+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),c==this)this.Ij(b,d,l,q,v);else if(q)for(q=0;q<d;q++)this.g[b]=c.g[l],b++,l++;else if(l=l+d-v,1==v)for(q=
0;q<d;q++)this.g[b]=c.g[l],b++,l--;else for(q=0,d=f.J.truncate(d/v);q<d;q++){for(var h=0;h<v;h++)this.g[b+h]=c.g[l+h];b+=v;l-=v}};c.prototype.Ek=function(b,d,c){if(this.Fa)throw f.f.La();if(b+d>this.size)throw f.f.La();0<c-(b+d)&&a(this.g,b,b+d,b+(c-(b+d))+d);this.size-=d};c.prototype.Zd=function(b,d,c){if(this.Fa)throw f.f.La();if(1>c||0!=d%c)throw f.f.La();for(var h=d>>1,q=0;q<h;q+=c){d-=c;for(var v=0;v<c;v++){var D=this.g[b+q+v];this.g[b+q+v]=this.g[b+d+v];this.g[b+d+v]=D}}};c.prototype.Zh=function(b,
d,c){if(0>d||0>c||0>d||c+d>this.size)throw f.f.F();for(var h=d;h<d+c;h++)this.g[h]=b};c.prototype.Ij=function(b,d,c,l,q){if(!l||b!=c)if(this.g.set(this.g.subarray(c,c+d),b),!l)for(c=b,b=b+d-q,l=0,d=f.J.truncate(d/2);l<d;l++){for(var h=0;h<q;h++){var D=this.g[c+h];this.g[c+h]=this.g[b+h];this.g[b+h]=D}c+=q;b-=q}};c.prototype.js=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(0!=d)for(this.size<(d<<1)+b&&this.resize((d<<1)+b),q||(b+=d-1<<1),q=q?2:-2,d+=l;l<d;l++)this.g[b]=c[l].x,this.g[b+1]=c[l].y,
b+=q};c.prototype.pl=function(b,d,c,l,q){if(0>b||0>d||0>l||this.size<d+b)throw f.f.F();if(q)for(q=0;q<d;q++)c[l+q]=this.g[b+q];else for(l=l+d-1;b<d;b++)c[l]=this.g[b],l--};c.prototype.clear=function(b){b?this.resize(0):this.yf(0)};c.prototype.Mp=function(){this.Ce=this.Fa=!0};c.prototype.Gd=function(b,d,h){10>d-b?c.ul(this.g,b,d,h):c.Oi(this.g,b,d-1,h)};c.prototype.si=function(){return 2};c.prototype.Fc=function(){return this.g[this.size-1]};c.prototype.Pf=function(){this.resize(this.size-1)};c.prototype.BK=
function(b){this.g[this.size-1]=b};c.prototype.GJ=function(b){b<this.size-1&&(this.g[b]=this.g[this.size-1]);this.resize(this.size-1)};c.prototype.Nv=function(b){for(var d=0,c=this.size;d<c;d++)if(this.g[d]==b)return d;return-1};c.prototype.mA=function(b){return 0<=this.Nv(b)};c.ul=function(b,d,c,l){for(var h=d;h<c;h++){for(var f=b[h],D=h-1;D>=d&&0<l(b[D],f);)b[D+1]=b[D],D--;b[D+1]=f}};c.Wg=function(b,d,c){var h=b[c];b[c]=b[d];b[d]=h};c.Oi=function(b,d,h,l){if(!(d>=h))for(;;){if(9>h-d){c.ul(b,d,h+
1,l);break}var q=b[d];c.Wg(b,d,h);for(var f=d,D=d;D<h;D++)0>=l(b[D],q)&&(c.Wg(b,f,D),f+=1);c.Wg(b,f,h);f-d<h-f?(c.Oi(b,d,f-1,l),d=f+1):(c.Oi(b,f+1,h,l),h=f-1)}};return c}();f.iy=e})(C||(C={}));!0===C.Xh.Bm&&(C.ia=C.iy);(function(f){function a(c,b,d,h){d=new Int8Array(c.subarray(d,h));c.set(d,b)}var e=function(){function c(b){this.Fa=this.Ce=!1;this.g=[];var d=b;2>d&&(d=2);this.g=f.J.gf(d,c.Bb);this.size=b}c.prototype.rotate=function(b,d,c){if(this.Fa)throw f.f.X("invalid_call");if(d<b||d>c||b>c)throw f.f.F();
b!=d&&c!=d&&(this.Zd(b,d-b,1),this.Zd(d,c-d,1),this.Zd(b,c-b,1))};c.yd=function(b,d){c.Bb=d;b=new c(b);c.Bb=0;return b};c.Ak=function(b){var d=new c(0);d.g=b.g.slice(0);d.size=b.size;return d};c.$=function(b,d){var h=new c(0);h.size=b.size;h.size>d&&(h.size=d);h.g=b.g.slice(0,h.size);return h};c.prototype.yb=function(){};c.prototype.read=function(b){return this.g[b]};c.prototype.fc=function(b,d){d.x=this.g[b];d.y=this.g[b+1]};c.prototype.get=function(b){return this.g[b]};c.prototype.write=function(b,
d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.set=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.ho=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.add=function(b){this.resize(this.size+1);this.g[this.size-1]=b};c.prototype.Sr=function(b){return c.$(this,b)};c.prototype.Of=function(b){return this.read(b)};c.prototype.resize=function(b,d){void 0===d&&(d=0);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");
if(b<=this.size){if(f.J.truncate(5*b/4)<this.g.length){var c=this.g.slice(0,b);this.g=c}}else if(b>this.g.length){f.J.truncate(64>b?Math.max(2*b,4):5*b/4);for(var c=this.g.slice(0),l=this.g.length;l<b;l++)c[l]=d;this.g=c}this.size=b};c.prototype.yf=function(b){(null==this.g||b>this.g.length)&&this.resize(b);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Dm=function(b,d){this.write(b,d)};c.prototype.zk=function(b,d,c){for(var h=this.size;d<
h&&d<c;d++)b=f.J.dh(this.read(d),b);return b};c.prototype.Eb=function(b,d,h){if(null==b||!(b instanceof c))return!1;var l=this.size,f=b.size;if(h>l||h>f&&l!=f)return!1;for(h>l&&(h=l);d<h;d++)if(this.read(d)!=b.read(d))return!1;return!0};c.prototype.Rk=function(b,d,c,l,q,v,D){if(this.Fa)throw f.f.La();if(!q&&(1>v||0!=l%v))throw f.f.F();for(var h=0;h<D-b;h++)this.g[b+l+h]=this.g[b+h];this.g==d.g&&b<c&&(c+=l);if(q)for(h=0;h<l;h++)this.g[h+b]=d.g[c+h];else for(q=l,D=0;D<l;D+=v)for(q-=v,h=0;h<v;h++)this.g[b+
D+h]=d.g[c+q+h]};c.prototype.Qk=function(b,d,c,l){if(this.Fa)throw f.f.La();l-=b;for(var h=this.g.slice(b,b+l),v=0;v<l;v++)this.g[b+c+v]=h[v];for(l=0;l<c;l++)this.g[b+l]=d};c.prototype.eh=function(b,d,c){if(this.Fa)throw f.f.La();for(var h=this.g.slice(b,b+(c-b)),q=0;q<c-b;q++)this.g[q+b+2]=h[q];this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.hs=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(c.length<l+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),q)for(q=0;q<d;q++)this.g[b+q]=c[l+
q];else for(q||(b+=d-1),d=l+d;l<d;l++)this.g[b]=c[l],b--};c.prototype.Em=function(b,d,c,l,q,v){if(0>b||0>d||0>l)throw f.f.F();if(!q&&(0>=v||0!=d%v))throw f.f.F();if(c.size<l+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),c==this)this.Ij(b,d,l,q,v);else if(q)for(q=0;q<d;q++)this.g[b]=c.g[l],b++,l++;else if(l=l+d-v,1==v)for(q=0;q<d;q++)this.g[b]=c.g[l],b++,l--;else for(q=0,d=f.J.truncate(d/v);q<d;q++){for(var h=0;h<v;h++)this.g[b+h]=c.g[l+h];b+=v;l-=v}};c.prototype.Ek=function(b,d,c){if(this.Fa)throw f.f.La();
if(b+d>this.size)throw f.f.La();if(0<c-(b+d)){c-=b+d;for(var h=this.g.slice(b+d,b+c+d),q=0;q<c;q++)this.g[b+q]=h[q]}this.size-=d};c.prototype.Zd=function(b,d,c){if(this.Fa)throw f.f.La();if(1>c||0!=d%c)throw f.f.La();for(var h=d>>1,q=0;q<h;q+=c){d-=c;for(var v=0;v<c;v++){var D=this.g[b+q+v];this.g[b+q+v]=this.g[b+d+v];this.g[b+d+v]=D}}};c.prototype.Zh=function(b,d,c){if(0>d||0>c||0>d||c+d>this.size)throw f.f.F();for(var h=d;h<d+c;h++)this.g[h]=b};c.prototype.Ij=function(b,d,c,l,q){if(!l||b!=c){for(var h=
0;h<d;h++)this.g[b+h]=this.g[c+h];if(!l)for(c=b,b=b+d-q,l=0,d=f.J.truncate(d/2);l<d;l++){for(h=0;h<q;h++){var D=this.g[c+h];this.g[c+h]=this.g[b+h];this.g[b+h]=D}c+=q;b-=q}}};c.prototype.js=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(0!=d)for(this.size<(d<<1)+b&&this.resize((d<<1)+b),q||(b+=d-1<<1),q=q?2:-2,d+=l;l<d;l++)this.g[b]=c[l].x,this.g[b+1]=c[l].y,b+=q};c.prototype.pl=function(b,d,c,l,q){if(0>b||0>d||0>l||this.size<d+b)throw f.f.F();if(q)for(q=0;q<d;q++)c[l+q]=this.g[b+q];else for(l=
l+d-1;b<d;b++)c[l]=this.g[b],l--};c.prototype.clear=function(b){b?this.resize(0):this.yf(0)};c.prototype.Mp=function(){this.Ce=this.Fa=!0};c.prototype.Gd=function(b,d,c){var h=this.g.slice(0,b),f=this.g.slice(d);b=this.g.slice(b,d).sort(c);this.g.length=0;this.g.push.apply(this.g,h.concat(b).concat(f))};c.prototype.si=function(){return 1};c.prototype.hC=function(b,d){if(this.Fa)throw f.f.X("invalid call. Attribute Stream is read only.");this.g[b]|=d};c.prototype.ez=function(b,d){if(this.Fa)throw f.f.X("invalid call. Attribute Stream is read only.");
this.g[b]&=~d};c.Bb=0;return c}();f.Gm=e;e=function(){function c(b){this.g=null;var d=b;2>d&&(d=2);this.g=new Int8Array(d);this.size=b}c.prototype.rotate=function(b,d,c){if(this.Fa)throw f.f.X("invalid_call");if(d<b||d>c||b>c)throw f.f.F();b!=d&&c!=d&&(this.Zd(b,d-b,1),this.Zd(d,c-d,1),this.Zd(b,c-b,1))};c.yd=function(b,d){var h=new c(b),l=h.g;2>b&&(b=2);if(0!==d)for(var f=0;f<b;f++)l[f]=d;return h};c.Ak=function(b){var d=new c(0);d.g=new Int8Array(b.g);d.size=b.size;return d};c.$=function(b,d){var h=
new c(0);h.size=b.size;h.size>d&&(h.size=d);d=h.size;2>d&&(d=2);h.g=new Int8Array(d);h.g.set(b.g.length<=d?b.g:b.g.subarray(0,d),0);return h};c.prototype.yb=function(b){0>=b||(null==this.g?this.g=new Int8Array(b):b<=this.g.length||(0<this.g.length?(b=new Int8Array(b),b.set(this.g),this.g=b):this.g=new Int8Array(b)))};c.prototype.read=function(b){return this.g[b]};c.prototype.fc=function(b,d){d.x=this.g[b];d.y=this.g[b+1]};c.prototype.get=function(b){return this.g[b]};c.prototype.write=function(b,
d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.set=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d};c.prototype.ho=function(b,d){if(this.Fa)throw f.f.La();this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.add=function(b){this.resize(this.size+1);this.g[this.size-1]=b};c.prototype.Sr=function(b){return c.$(this,b)};c.prototype.Of=function(b){return this.read(b)};c.prototype.resize=function(b,d){void 0===d&&(d=0);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");
if(b<=this.size){if(30<this.g.length&&5*b/4<this.g.length){var c=new Int8Array(this.g,0,b);this.g=c}}else{b>this.g.length&&(c=f.J.truncate(64>b?Math.max(2*b,4):5*b/4),c=new Int8Array(c),c.set(this.g),this.g=c);for(var c=this.g,l=this.size;l<b;l++)c[l]=d}this.size=b};c.prototype.yf=function(b){(null==this.g||b>this.g.length)&&this.resize(b);if(this.Ce)throw f.f.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Dm=function(b,d){this.write(b,d)};c.prototype.zk=
function(b,d,c){for(var h=this.size;d<h&&d<c;d++)b=f.J.dh(this.read(d),b);return b};c.prototype.Eb=function(b,d,h){if(null==b||!(b instanceof c))return!1;var l=this.size,f=b.size;if(h>l||h>f&&l!=f)return!1;for(h>l&&(h=l);d<h;d++)if(this.read(d)!=b.read(d))return!1;return!0};c.prototype.Rk=function(b,d,c,l,q,v,D){if(this.Fa)throw f.f.La();if(!q&&(1>v||0!=l%v))throw f.f.F();a(this.g,b+l,b,b+(D-b));this.g==d.g&&b<c&&(c+=l);if(q)this.g.set(d.g.subarray(c,c+l),b);else for(q=l,D=0;D<l;D+=v){q-=v;for(var h=
0;h<v;h++)this.g[b+D+h]=d.g[c+q+h]}};c.prototype.Qk=function(b,d,c,l){if(this.Fa)throw f.f.La();l-=b;a(this.g,b+l,b,b+l);for(l=0;l<c;l++)this.g[b+l]=d};c.prototype.eh=function(b,d,c){if(this.Fa)throw f.f.La();a(this.g,b+2,b,b+(c-b));this.g[b]=d.x;this.g[b+1]=d.y};c.prototype.hs=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(c.length<l+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),q)this.g.set(c.subarray(l,d),b);else for(q||(b+=d-1),d=l+d;l<d;l++)this.g[b]=c[l],b--};c.prototype.Em=
function(b,d,c,l,q,v){if(0>b||0>d||0>l)throw f.f.F();if(!q&&(0>=v||0!=d%v))throw f.f.F();if(c.size<l+d)throw f.f.F();if(0!=d)if(this.size<d+b&&this.resize(d+b),c==this)this.Ij(b,d,l,q,v);else if(q)for(q=0;q<d;q++)this.g[b]=c.g[l],b++,l++;else if(l=l+d-v,1==v)for(q=0;q<d;q++)this.g[b]=c.g[l],b++,l--;else for(q=0,d=f.J.truncate(d/v);q<d;q++){for(var h=0;h<v;h++)this.g[b+h]=c.g[l+h];b+=v;l-=v}};c.prototype.Ek=function(b,d,c){if(this.Fa)throw f.f.La();if(b+d>this.size)throw f.f.La();0<c-(b+d)&&a(this.g,
b,b+d,b+(c-(b+d))+d);this.size-=d};c.prototype.Zd=function(b,d,c){if(this.Fa)throw f.f.La();if(1>c||0!=d%c)throw f.f.La();for(var h=d>>1,q=0;q<h;q+=c){d-=c;for(var v=0;v<c;v++){var D=this.g[b+q+v];this.g[b+q+v]=this.g[b+d+v];this.g[b+d+v]=D}}};c.prototype.Zh=function(b,d,c){if(0>d||0>c||0>d||c+d>this.size)throw f.f.F();for(var h=d;h<d+c;h++)this.g[h]=b};c.prototype.Ij=function(b,d,c,l,q){if(!l||b!=c)if(this.g.set(this.g.subarray(c,c+d),b),!l)for(c=b,b=b+d-q,l=0,d=f.J.truncate(d/2);l<d;l++){for(var h=
0;h<q;h++){var D=this.g[c+h];this.g[c+h]=this.g[b+h];this.g[b+h]=D}c+=q;b-=q}};c.prototype.js=function(b,d,c,l,q){if(0>b||0>d||0>l)throw f.f.F();if(0!=d)for(this.size<(d<<1)+b&&this.resize((d<<1)+b),q||(b+=d-1<<1),q=q?2:-2,d+=l;l<d;l++)this.g[b]=c[l].x,this.g[b+1]=c[l].y,b+=q};c.prototype.pl=function(b,d,c,l,q){if(0>b||0>d||0>l||this.size<d+b)throw f.f.F();if(q)for(q=0;q<d;q++)c[l+q]=this.g[b+q];else for(l=l+d-1;b<d;b++)c[l]=this.g[b],l--};c.prototype.clear=function(b){b?this.resize(0):this.yf(0)};
c.prototype.Mp=function(){this.Ce=this.Fa=!0};c.prototype.Gd=function(b,d,c){d=this.g.subarray(b,d);Array.prototype.sort.call(d,c);this.g.set(d,b)};c.prototype.hC=function(b,d){if(this.Fa)throw f.f.X("invalid call. Attribute Stream is read only.");this.g[b]|=d};c.prototype.ez=function(b,d){if(this.Fa)throw f.f.X("invalid call. Attribute Stream is read only.");this.g[b]&=~d};c.prototype.si=function(){return 1};return c}();f.jy=e})(C||(C={}));!0===C.Xh.Bm&&(C.Gm=C.jy);(function(f){var a=function(){function a(){}
a.vq=function(c,b){return f.Gm.yd(c,b)};a.Vm=function(c,b){return f.Sd.yd(c,b)};a.oz=function(c,b,d){switch(c){case 1:c=f.Sd.yd(b,d);break;case 2:c=f.ia.yd(b,d);break;case 4:c=f.Gm.yd(b,d);break;default:throw f.f.ya();}return c};a.pz=function(c,b){return a.oz(f.na.si(c),b*f.na.Xa(c),f.na.pe(c))};a.wh=function(c,b){return f.ia.yd(c,b)};a.HB=function(c){var b,d=[];for(b=0;b<c;b++)d.push(null);return d};return a}();f.Uc=a})(C||(C={}));(function(f){var a=function(){function a(){}a.vq=function(c,b){return f.jy.yd(c,
b)};a.Vm=function(c,b){return f.Sd.yd(c,b)};a.oz=function(c,b,d){switch(c){case 1:c=f.Sd.yd(b,d);break;case 2:c=f.iy.yd(b,d);break;case 4:c=f.jy.yd(b,d);break;default:throw f.f.ya();}return c};a.pz=function(c,b){return f.Uc.oz(f.na.si(c),b*f.na.Xa(c),f.na.pe(c))};a.wh=function(c,b){return f.iy.yd(c,b)};a.HB=function(c){var b,d=[];for(b=0;b<c;b++)d.push(null);return d};return a}();f.KL=a})(C||(C={}));!0===C.Xh.Bm&&(C.Uc=C.KL);(function(f){f.ea=function(){return function(f){void 0===f&&(f=0);this.j=
f}}()})(C||(C={}));(function(f){var a=function(){function a(){}a.bind=function(c){f.Vc=c.PeDefs;f.Tf=c.PeFactory;f.PD=c.PeVertcs;f.MD=c.PeCoordsys;f.fi=c.PeCSTransformations;f.OD=c.PeGTTransformations;f.xN=c.PeGeogtran;f.wN=c.PeFactoryCodechange;f.ND=c.PeGCSExtent;f.Bg=c.PePCSInfo;f.yN=c.PeHorizon;f.MD=c.PeCoordsys;f.fq=c.PeGTlistExtended;f.fq.PE_GTLIST_OPTS_USE_DEFAULT=128;f.Tf.initialize(null);f.vy=c.PeGTlistExtendedEntry;a.PY=f.Tf.fromString(f.Vc.PE_TYPE_UNIT,'UNIT["Meter",1.0]')};a.v_=function(){};
a.PY=null;return a}();f.zN=a;f.Tf=null;f.PD=null;f.MD=null;f.yN=null;f.Bg=null;f.fq=null;f.vy=null;f.ND=null;f.wN=null;f.xN=null;f.Vc=null;f.OD=null;f.fi=null})(C||(C={}));(function(f){var a=function(){function c(){}c.Ab=function(b,d){return 0<=d?c.K(b):-c.K(b)};c.K=function(b){return 0>b?-b:b};c.Qi=function(b){return 3.552713678800501E-15>b};c.LD=function(b,d,h){return c.K(b-d)<=h*(1+(c.K(b)+c.K(d))/2)};c.W=function(b,d){return c.LD(b,d,3.552713678800501E-15)};c.iW=function(b){return 3.552713678800501E-15>=
c.K(b)};c.wd=function(b){return c.iW(b)};return c}();f.l=a;var e=function(){function c(){}c.Sp=function(b,d){b=a.K(b);d=a.K(d);var c=0;0!=b+d&&(b>d?(c=d/b,c=b*Math.sqrt(1+c*c)):(c=b/d,c=d*Math.sqrt(1+c*c)));return c};c.Nr=function(b,d,h,l,f){for(var q=[0,0,0],D=[0,0,0],H=0;2>=H;H++)d[H]-=b[H],h[H]-=d[H];h=q[1]*D[2]-q[2]*D[1];d=q[2]*D[0]-q[0]*D[2];q=q[0]*D[1]-q[1]*D[0];b=-1*(h*b[0]+d*b[1]+q*b[2]);l[0]=h;l[1]=d;l[2]=q;l[3]=b;D=c.fo(l);l[0]/=D;l[1]/=D;l[2]/=D;l[3]/=D;0!=f&&(D=a.wd(q)?a.wd(b)?a.Ab(1,
d):-a.Ab(1,b):a.Ab(1,q),D*=a.Ab(1,f),l[0]*=D,l[1]*=D,l[2]*=D,l[3]*=D)};c.ey=function(b,d,c){c[0]=b[1]*d[2]-d[1]*b[2];c[1]=b[2]*d[0]-d[2]*b[0];c[2]=b[0]*d[1]-d[0]*b[1]};c.Du=function(b,d){return b[0]*d[0]+b[1]*d[1]+b[2]*d[2]};c.fo=function(b){return c.Sp(c.Sp(b[0],b[1]),b[2])};c.Ck=function(b,d,h,l,f,v,D,a){b=c.n(b,d,h);var q=Math.cos(h);v.j=(b+f)*q*Math.cos(l);D.j=(b+f)*q*Math.sin(l);a.j=(b*(1-d)+f)*Math.sin(h)};c.iQ=function(b,d,h,l,f,v,D){var q=c.Sp(d,h),F=1*Math.sqrt(1-b),G=F/1;if(a.W(q,0))v.j=
0,f.j=a.Ab(1.570796326794897,l),D.j=a.K(l)-F;else{v.j=Math.atan2(h,d);h=Math.atan2(1*l,F*q);v=Math.cos(h);var e=Math.sin(h);d=F*b/(1-b);b*=1;h=Math.atan2(l+d*e*e*e,q-b*v*v*v);3.141592653589793<a.K(h)&&(h=a.Ab(3.141592653589793,h)-h);h=Math.atan(G*Math.tan(h));e=Math.sin(h);v=Math.cos(h);f.j=Math.atan2(l+d*e*e*e,q-b*v*v*v);1.570796326794897<a.K(f.j)&&(f.j=a.Ab(3.141592653589793,f.j)-f.j);h=Math.atan(G*Math.tan(f.j));e=Math.sin(h);v=Math.cos(h);D.j=(l-F*e)*Math.sin(f.j)+(q-1*v)*Math.cos(f.j)}};c.n=
function(b,d,c){c=Math.sin(c);return b/Math.sqrt(1-d*c*c)};c.cu=function(b,d){return Math.atan2(Math.sin(d)*(1-b),Math.cos(d))};c.hk=function(b,d){return Math.atan2(Math.sin(d),Math.cos(d)*(1-b))};c.xp=function(b,d){if(a.Qi(b)||0==d||a.W(a.K(d),1.570796326794897))return d;var h,l,f,v,D,H,F,G,e;if(.006884661117170036>b){v=Math.sqrt(1-b);D=(1-v)/(1+v);H=D*D;F=D*H;G=D*F;h=D*G;e=D*h;l=D*e;f=1.572916666666667*F-3.2578125*h+4.295068359375*l;v=2.142578125*G-6.071484375*e;b=3.129296875*h-11.249837239583334*
l;var E=4.775276692708333*e,k=7.958636765252976*l,p=Math.cos(2*d);return d+Math.sin(2*d)*(1.5*D-.84375*F+.525390625*h-.2688395182291667*l-f+b-k+p*(2*(1.3125*H-1.71875*G+1.650146484375*e)-4*v+6*E+p*(4*f-12*b+24*k+p*(8*v-32*E+p*(16*b-80*k+p*(32*E+64*p*k))))))}v=1-b;D=b/2;H=a.K(d);F=H*c.Su(b)/(1.570796326794897*v);G=9999;e=H;for(H=0;1E-16<G&&50>H;H++)l=c.Cm(b,e),h=(c.DG(e,b)-D*Math.sin(2*e)/l)/v-F,l=1/(l*l*l),f=h/l,h=e-f,G=a.K(f),e=h;return 0<=d?e:-e};c.oX=function(b,d){return a.Qi(d)?b:b*c.Su(d)/1.570796326794897};
c.da=function(b){b=c.pG(b,6.283185307179586);return 0>b?b+6.283185307179586:3.141592653589793>a.K(b)||a.W(a.K(b),3.141592653589793)?b:b-6.283185307179586};c.pG=function(b,d){return b-Math.floor(b/d)*d};c.Yg=function(b,d){if(.006884661117170036>d){d=Math.sqrt(1-d);d=(1-d)/(1+d);var h=d*d,l=h*h;return b/(1+d)*(1+.25*h+.015625*l+.00390625*h*l)*1.570796326794897}return b*c.Su(d)};c.Mr=function(b,d){var h=a.Ab(1,Math.sin(d));d=a.K(c.pG(d,3.141592653589793));d=1.570796326794897>=d?d:3.141592653589793-d;
var l;a.W(d,1.570796326794897)?l=d:l=Math.atan(Math.sqrt(1-b)*Math.tan(d));return l*h};c.q=function(b,d,h){if(.006884661117170036>d){d=Math.sqrt(1-d);d=(1-d)/(1+d);var l=d*d,f=d*l,v=d*f,D=d*v,a=d*D,F=d*a,G=-.7291666666666666*f+.2278645833333333*D+.03987630208333334*F,e=.615234375*v-.21533203125*a,E=-.54140625*D+.20302734375*F,k=.48876953125*a,p=-.4488699776785715*F,n=Math.cos(2*h);return b/(1+d)*((1+.25*l+.015625*v+.00390625*a)*h+Math.sin(2*h)*(-1.5*d+.1875*f+.0234375*D+.00732421875*F-G+E-p+n*(2*
(.9375*l-.234375*v-.03662109375*a)-4*e+6*k+n*(4*G-12*E+24*p+n*(8*e-32*k+n*(16*E-80*p+n*(32*k+64*n*p)))))))}return b*(c.DG(h,d)-.5*d*Math.sin(2*h)/c.Cm(d,h))};c.Cm=function(b,d){d=Math.sin(d);return Math.sqrt(1-b*d*d)};c.Su=function(b){return a.LD(b,1,2.220446049250313E-16)?1:1>b?c.Kv(0,1-b)-b/3*c.Hv(0,1-b):NaN};c.DG=function(b,d){var h=a.Ab(1,b);b=a.K(b);var l=Math.floor(b/1.570796326794897),q;if(1<d)q=0==b?0:NaN;else if(a.wd(l))q=c.sin(b),q=q*c.Kv(1-q*q,1-d*q*q)-d/3*q*q*q*c.Hv(1-q*q,1-d*q*q);else{q=
f.J.truncate(l%2);var v=c.Su(d);0<q?(q=Math.sin(1.570796326794897*(l+1)-b),q=q*c.Kv(1-q*q,1-d*q*q)-d/3*q*q*q*c.Hv(1-q*q,1-d*q*q),q=v*(l+1)-q):(q=Math.sin(b-1.570796326794897*l),q=q*c.Kv(1-q*q,1-d*q*q)-d/3*q*q*q*c.Hv(1-q*q,1-d*q*q),q=v*l+q)}return q*h};c.sin=function(b){b=c.da(b);var d=a.Ab(1,b);b=a.K(b);return a.W(b,3.141592653589793)?0:a.W(b,1.570796326794897)?1*d:Math.sin(b)*d};c.Hv=function(b,d){for(var c=1,l=0,f=1,v,D,H,F;;){v=.2*(b+d+3*c);D=(v-b)/v;H=(v-d)/v;F=(v-c)/v;if(1E-4>a.K(D)&&1E-4>a.K(H)&&
1E-4>a.K(F))break;F=Math.sqrt(d);v=Math.sqrt(c);F=Math.sqrt(b)*(F+v)+F*v;l+=f/(v*(c+F));f*=.25;b=.25*(b+F);d=.25*(d+F);c=.25*(c+F)}b=D*H;c=F*F;d=b-c;c=b-6*c;D=c+d+d;return 3*l+f*(1+c*(-.2142857142857143+.10227272727272728*c-.1730769230769231*F*D)+F*(.1666666666666667*D+F*(-.4090909090909091*d+.1153846153846154*F*b)))/(v*Math.sqrt(v))};c.Kv=function(b,d){for(var c,l,f,v,D=1;;D=.25*(D+c)){c=(b+d+D)/3;l=2-(c+b)/c;f=2-(c+d)/c;v=2-(c+D)/c;if(1E-4>a.K(l)&&1E-4>a.K(f)&&1E-4>a.K(v))break;c=Math.sqrt(d);l=
Math.sqrt(D);c=Math.sqrt(b)*(c+l)+c*l;b=.25*(b+c);d=.25*(d+c)}b=l*f-v*v;d=l*f*v;return(1+(.04166666666666666*b-.1-.06818181818181818*d)*b+.07142857142857142*d)/Math.sqrt(c)};c.Bx=function(b,d){if(a.Qi(b)||0==d||a.W(a.K(d),1.570796326794897))return d;var c,l,f;if(.006884661117170036>b){c=b*b;l=b*c;f=b*l;var v=b*f,D=b*v,H=b*D,F=-(.02708333333333333*l+.03430059523809524*f+.03149181547619048*v+.02634359154541446*D+.02156896735835538*H),G=.007669890873015873*f+.01299603174603175*v+.0148051353064374*D+
.01454454953803912*H,e=-(.002275545634920635*v+.004830845032667949*D+.006558395368616723*H),E=6.957236677288761E-4*D+.001775193002406544*H,k=-(2.17324089394402E-4*H),p=Math.cos(2*d);return d+Math.sin(2*d)*(-(.5*b+.2083333333333333*c+.09375*l+.04878472222222222*f+.02916666666666667*v+.01938905423280423*D+.01388255931712963*H)-F+e-k+p*(2*(.1041666666666667*c+.0875*l+.06050347222222222*f+.04151785714285714*v+.02958958540013228*D+.02203667534722222*H)-4*G+6*E+p*(4*F-12*e+24*k+p*(8*G-32*E+p*(16*e-80*k+
p*(32*E+64*p*k))))))}0==d||a.W(a.K(d),1.570796326794897)?c=d:(l=Math.sqrt(b),f=l*Math.sin(d),c=Math.tan(.7853981633974483+d/2)*Math.pow((1-f)/(1+f),l/2),c=2*Math.atan(c)-1.570796326794897);return c};c.AQ=function(b,d){if(a.Qi(b)||0==d||a.W(a.K(d),1.570796326794897))return d;var c,l;if(.006884661117170036>b){p=b*b;e=b*p;E=b*e;c=b*E;k=b*c;l=b*k;var f=.05833333333333333*e+.07232142857142858*E+.05634300595238095*c+.0355325796406526*k+.020235546186067*l,v=.02653149801587302*E+.04379960317460317*c+.0429211791776896*
k+.03255384637546096*l,D=.01294022817460318*c+.02668104344536636*k+.03155651254609588*l,H=.00659454790965208*k+.0163075268674227*l,F=.003463473736911237*l,G=Math.cos(2*d);return d+Math.sin(2*d)*(.5*b+.2083333333333333*p+.08333333333333333*e+.03611111111111111*E+.01875*c+.01195601851851852*k+.008863673941798942*l-f+D-F+G*(2*(.1458333333333333*p+.1208333333333333*e+.07039930555555556*E+.03616071428571429*c+.01839451058201058*k+.01017113095238095*l)-4*v+6*H+G*(4*f-12*D+24*F+G*(8*v-32*H+G*(16*D-80*F+
G*(32*H+64*G*F))))))}for(var e=Math.sqrt(b),E=e/2,k=Math.tan(.7853981633974483+d/2),f=0,v=1,p=d;0!=v;p=l)if(c=e*Math.sin(p),l=k*Math.pow((1+c)/(1-c),E),l=2*Math.atan(l)-1.570796326794897,f++,a.W(l,p)||3E4<f)v=0;return p};return c}();f.C=e})(C||(C={}));(function(f){var a=function(){function a(c){this.Zl=this.Ot=null;this.uw=!1;this.lB=this.mB=0;this.jB=new f.b;this.wB=new f.b;this.hx=!1;this.jr=new f.h;this.HI=this.ex=0;this.fx=null;this.al=!1;this.Er=null;this.JA=0;this.uf=c;this.vt=f.Ib.hw(this.uf,
0,!0);this.jB.$c();this.wB.$c();this.dJ=NaN;var b=c.getCode();0<b?(this.ll=b,f.Tf.getCode(c)):this.ll=f.Tf.getCode(c);0>this.ll&&(this.ll=0);var d=this.uf.getType();this.uI=d==f.Vc.PE_TYPE_PROJCS?2:1;if(d==f.Vc.PE_TYPE_PROJCS&&!c.loadConstants())throw f.f.F("PeProjcs.loadConstants failed");b=d==f.Vc.PE_TYPE_GEOGCS?this.uf:this.uf.getGeogcs();d!=f.Vc.PE_TYPE_GEOGCS&&f.Tf.getCode(b);this.Er=c.getUnit();this.dJ=b.getPrimem().getLongitude();this.HI=c=b.getUnit().getUnitFactor();c=Math.PI/(180*c);1E-10>
Math.abs(c-1)&&(c=1);this.lB=c;0!=(d&f.Vc.PE_TYPE_PROJCS)?(b=this.uf,this.mB=1/b.getUnit().getUnitFactor(),this.ex=.001/this.uf.getUnit().getUnitFactor(),this.fx=f.Bg.generate(b,f.Bg.PE_PCSINFO_OPTION_NONE),this.al=this.fx.isPannableRectangle(),this.JA=f.Ib.pP(this.fx.getCentralMeridian(),this.lB)):(this.hx=this.al=!0,this.mB=0,d=1/b.getUnit().getUnitFactor(),this.ex=.001/b.getDatum().getSpheroid().getAxis()*d,this.JA=0);this.al&&(this.cy(),this.tL(),this.uL(),this.sL(),this.hZ(),this.iZ())}a.prototype.Zs=
function(){return this.ll};a.prototype.Sj=function(){return this.fx};a.yz=function(c,b){return c==b?!0:null!=c&&null!=b&&0==c.ll&&0==b.ll?c.vt===b.vt:!1};a.prototype.Jc=function(){return this.al};a.prototype.Bh=function(c){c.I(this.gp)};a.prototype.aw=function(){return this.gp.o};a.prototype.$v=function(){return this.gp.v};a.prototype.yT=function(c){c.I(this.gx)};a.prototype.hZ=function(){var c=this.uf.getType();if(c==f.Vc.PE_TYPE_PROJCS){var c=this.uf,b=this.Sj().getCentralMeridian(),d=c.getGeogcs();
if(null==d)throw f.f.X("internal error");d=1/d.getUnit().getUnitFactor()*Math.PI;b=[[b+d,0]];f.fi.geogToProj(c,1,b);var b=b[0][0],d=c.getParameters()[f.Vc.PE_PARM_X0].getValue(),h=this.Lk(),c=new f.h;h.s(c);var h=Math.abs(b-d),b=h+d,d=-1*h+d,h=c.B,c=c.A,l=new f.h;l.I(d,c,b,h);null==this.gp&&(this.gp=l)}else if(c==f.Vc.PE_TYPE_GEOGCS)d=1/this.uf.getUnit().getUnitFactor()*Math.PI,c=new f.h,c.I(-d,-d/2,d,d/2),null==this.gp&&(this.gp=c);else throw f.f.X("internal error");};a.prototype.iZ=function(){var c=
this.uf.getType();if(c==f.Vc.PE_TYPE_PROJCS){var b=this.uf,c=this.Sj().getCentralMeridian(),b=b.getGeogcs();if(null==b)throw f.f.X("internal error");var b=1/b.getUnit().getUnitFactor()*Math.PI,d=this.Us(),h=new f.h;d.s(h);d=new f.h;d.I(c-b,h.A,c+b,h.B);null==this.gx&&(this.gx=d)}else if(c==f.Vc.PE_TYPE_GEOGCS)b=1/this.uf.getUnit().getUnitFactor()*Math.PI,c=new f.h,c.I(-b,-b/2,b,b/2),null==this.gx&&(this.gx=c);else throw f.f.X("internal error");};a.prototype.de=function(){return this.lB};a.prototype.cn=
function(){return this.mB};a.prototype.Us=function(){if(this.al)return this.Zl;var c=this.Zl;if(null!=c)return c;this.cy();return this.Zl};a.prototype.Vs=function(){if(this.al)return null;if(null!=this.Zl)return this.gI;this.cy();return this.gI};a.prototype.cy=function(){if(this.uf.getType()==f.Vc.PE_TYPE_PROJCS){var c;c=this.uf;var b=c.getGeogcs(),d=c.horizonGcsGenerate();if(null!=d){var h=d[0].getNump(),l=d[0].getKind();c=0<d[0].getInclusive();var q=this.de(),v=90*q,D=360*q,a=370*q,F=180*q*f.Vc.PE_HORIZON_DELTA/
Math.PI,G=new f.h,e=null;if(1<h)for(var E=1;E<h;E++)if(d[E].getKind()==f.Vc.PE_HORIZON_LINE){null==e&&(e=new f.Ua);var k=d[E].getCoord();e.Zx(k[0][0],k[0][1]);e.Wj(k[1][0],k[1][1])}if(l==f.Vc.PE_HORIZON_RECT)d=d[0].getCoord(),G.I(d[0][0],d[0][1]),G.Nb(d[1][0],d[1][1]),Math.abs(G.B-v)<1E-7*F&&(G.B=v),Math.abs(G.A+v)<1E-7*F&&(G.A=-v),G.N()>a&&(d=-400*q,G.I(d,G.A,d+5*D,G.B)),d=new f.ci(G),null==this.Zl&&(this.Zl=d,this.uw=c);else{a=new f.Ia;D=this.Sj().isGcsHorizonMultiOverlap();G=f.Nu.hG(b,f.ss.Integer64);
if(D){a=new f.PM;F=f.ei.local().V(a,G,null);for(E=0;E<h;E++)if(d[E].getKind()==f.Vc.PE_HORIZON_POLY){b=d[E].getSize();q=d[E].getCoord();l=[];for(v=0;v<b;v++)l[v]=f.b.pa(q[v][0],q[v][1]);d[E].getInclusive();D&&(q=new f.Ia,q.Bl(l,b-1),a.RY(q),F.Re())}a=F.next()}else for(E=0;E<h;E++)if(d[E].getKind()==f.Vc.PE_HORIZON_POLY){b=d[E].getSize();q=d[E].getCoord();D=[];for(v=0;v<b;v++)D[v]=f.b.pa(q[v][0],q[v][1]);d[E].getInclusive();a.Bl(D,b-1)}c?f.sk.local().qo(a,G,1):f.cq.local().qo(a,G,1);f.Gj.local().qo(a,
G,1);null==this.Zl&&(this.Zl=a,this.uw=c,this.gI=e)}}}};a.prototype.Tv=function(){if(this.al)return this.uw;null==this.Zl&&this.cy();return this.uw};a.prototype.tL=function(){if(2==this.uI){var c=this.uf.horizonPcsGenerate();if(null!=c){var b=c[0].getKind();c[0].getInclusive();var d=c[0].getNump(),h=!1;if(b==f.Vc.PE_HORIZON_RECT)c=c[0].getCoord(),d=new f.h,d.I(c[0][0],c[0][1]),d.Nb(c[1][0],c[1][1]),c=new f.ci(d);else{b=-1;for(h=0;h<d;h++)c[h].getKind()==f.Vc.PE_HORIZON_POLY&&(b=h);h=c[b].getSize()-
1;c=c[b].getCoord();d=[];for(b=0;b<h;b++)d[b]=f.b.pa(c[b][0],c[b][1]);c=b=new f.Ia;b.Bl(d,h);h=!0}this.Sj().isDensificationNeeded()&&(d=1E5*this.cn(),c=f.Km.local().V(c,d,null));h&&(h=new f.ci,c.Rn(h),c.hf(),c.Rb(),c.fT(),f.sk.local().qo(c,null,1));null==this.Ot&&(this.Ot=c)}}};a.prototype.Lk=function(){if(this.al)return this.Ot;var c=this.Ot;if(null!=c)return c;this.tL();return this.Ot};a.prototype.uL=function(){if(this.uf.getType()==f.Vc.PE_TYPE_PROJCS){var c=90*this.de(),c=[[0,c],[0,-c]];f.fi.geogToProj(this.uf,
2,c);var b=this.Sj(),d=b.getNorthPoleLocation()!=f.Bg.PE_POLE_OUTSIDE_BOUNDARY,b=b.getSouthPoleLocation()!=f.Bg.PE_POLE_OUTSIDE_BOUNDARY;this.hx||(d&&this.jB.ka(c[0][0],c[0][1]),b&&this.wB.ka(c[1][0],c[1][1]))}this.hx=!0};a.prototype.cA=function(c,b){this.al||this.hx||this.uL();c?b.L(this.wB):b.L(this.jB)};a.prototype.sL=function(){if(1==this.uI){var c=400*this.de();this.jr.I(-c,-c,c,c)}else c=f.Bg.generate(this.uf,f.Bg.PE_PCSINFO_OPTION_DOMAIN),c=f.h.pa(c.getDomainMinx(),c.getDomainMiny(),c.getDomainMaxx(),
c.getDomainMaxy()),this.jr.u()&&this.jr.I(c)};a.prototype.YS=function(c){this.al&&c.I(this.jr);this.jr.u()&&this.sL();c.I(this.jr)};a.prototype.en=function(){return this.dJ};a.prototype.pi=function(){return this.JA};a.prototype.Od=function(){return this.Er};a.prototype.Ws=function(){return this.HI};return a}();f.SD=a})(C||(C={}));(function(f){var a=function(){function a(c){this.HV=c;this.vt=f.Ib.hw(c,0,!0);var b=c.getCode();this.mt=0<b?b:f.Tf.getCode(c);0>this.mt&&(this.mt=0);this.Er=b=this.HV.getUnit();
this.WI=1/b.getUnitFactor();f.Tf.getCode(c)}a.yz=function(c,b){return c==b?!0:null!=c&&null!=b&&0==c.mt&&0==b.mt?c.vt===b.vt:!1};a.prototype.Zs=function(){return this.mt};return a}();f.EN=a})(C||(C={}));(function(f){var a=function(){function a(){}a.Cb=function(c,b,d,h,l,q,v,D){if(null!=q||null!=v||null!=D){h=f.C.da(h);b=f.C.da(b);d=f.C.da(d);l=f.C.da(l);1.570796326794897<f.l.K(d)&&(d=f.l.Ab(3.141592653589793,d)-d,b=f.C.da(b+3.141592653589793));1.570796326794897<f.l.K(l)&&(l=f.l.Ab(3.141592653589793,
l)-l,h=f.C.da(h+3.141592653589793));var a=f.C.da(h-b);if(f.l.W(d,l)&&(f.l.W(b,h)||f.l.W(f.l.K(d),1.570796326794897)))null!=q&&(q.j=0),null!=v&&(v.j=0),null!=D&&(D.j=0);else{if(f.l.W(d,-l)){if(f.l.W(f.l.K(d),1.570796326794897)){null!=q&&(q.j=3.141592653589793*c);null!=v&&(v.j=0<d?f.C.da(3.141592653589793-f.C.da(h)):f.C.da(h));null!=D&&(D.j=0<d?f.C.da(h):f.C.da(3.141592653589793-f.C.da(h)));return}if(f.l.W(f.l.K(a),3.141592653589793)){null!=q&&(q.j=3.141592653589793*c);null!=v&&(v.j=0);null!=D&&(D.j=
0);return}}var F=1.570796326794897==f.l.K(d)?0:Math.cos(d),G=Math.sin(d),e=1.570796326794897==f.l.K(l)?0:Math.cos(l),E=Math.sin(l),k=1.570796326794897==f.l.K(a)?0:Math.cos(a),p=3.141592653589793==f.l.K(a)?0:Math.sin(a);if(null!=q){var n=Math.sin((l-d)/2),a=Math.sin(a/2);q.j=2*Math.asin(Math.sqrt(n*n+F*e*a*a))*c}null!=v&&(f.l.W(f.l.K(d),1.570796326794897)?v.j=0>d?h:f.C.da(3.141592653589793-h):v.j=Math.atan2(e*p,F*E-G*e*k));null!=D&&(f.l.W(f.l.K(l),1.570796326794897)?D.j=0>l?b:f.C.da(3.141592653589793-
b):(D.j=Math.atan2(F*p,E*F*k-e*G),D.j=f.C.da(D.j+3.141592653589793)))}}};a.Uf=function(c,b,d,h,l,q,v){if(null!=q||null!=v){b=f.C.da(b);d=f.C.da(d);1.570796326794897<f.l.K(d)&&(d=f.l.Ab(3.141592653589793,d)-d,b=f.C.da(b+3.141592653589793));f.l.W(f.l.K(d),1.570796326794897)&&(b=0);l=f.C.da(l);var D=f.l.W(f.l.K(l),1.570796326794897)?0:Math.cos(l),a=f.l.W(f.l.K(l),3.141592653589793)?0:Math.sin(l),F=f.l.W(f.l.K(d),1.570796326794897)?0:Math.cos(d),G=Math.sin(d);c=h/c;h=f.l.W(f.l.K(c),1.570796326794897)?
0:Math.cos(c);var e=f.l.W(f.l.K(c),3.141592653589793)?0:Math.sin(c),E=Math.asin(G*h+F*e*D);null!=v&&(v.j=E);null!=q&&(q.j=f.l.W(f.l.K(E),1.570796326794897)?f.l.W(d,-E)?0>E?l:f.C.da(3.141592653589793-l):b:f.l.W(f.l.K(d),1.570796326794897)&&f.l.W(c,3.141592653589793)?0>d?l:f.C.da(3.141592653589793-l):f.C.da(b+Math.atan2(e*a,F*h-G*e*D)))}};return a}();f.vh=a})(C||(C={}));(function(f){var a=function(){function a(){}a.Cb=function(c,b,d,h,l,q,v,D,a){var H=new f.ea(0),G=new f.ea(0),e=[0,0,0],E=[0,0,0],k=
[0,0,0],p=new f.ea(0),n=new f.ea(0),g=new f.ea(0),u=new f.ea(0),z=new f.ea(0);if(null!=v||null!=D||null!=a)if(f.l.Qi(b))f.vh.Cb(c,d,h,l,q,v,D,a);else{l=f.C.da(l);d=f.C.da(d);var t=f.C.da(l-d);if(f.l.W(h,q)&&(f.l.W(d,l)||f.l.W(f.l.K(h),1.570796326794897)))null!=v&&(v.j=0),null!=D&&(D.j=0),null!=a&&(a.j=0);else{if(f.l.W(h,-q)){if(f.l.W(f.l.K(h),1.570796326794897)){null!=v&&(v.j=2*f.C.Yg(c,b));null!=D&&(D.j=0<h?f.C.da(3.141592653589793-f.C.da(l)):f.C.da(l));null!=a&&(a.j=0<h?f.C.da(l):f.C.da(3.141592653589793-
f.C.da(l)));return}f.l.W(f.l.K(t),3.141592653589793)&&(null!=v&&(v.j=2*f.C.Yg(c,b)),null!=D&&(D.j=0),null!=a&&(a.j=0))}else if(f.l.W(f.l.K(h),1.570796326794897)||f.l.W(f.l.K(q),1.570796326794897))f.l.W(f.l.K(h),1.570796326794897)?d=l:l=d;var r=0,A;0>t&&(r=1,A=d,d=l,l=A,A=h,h=q,q=A);var t=f.C.cu(b,h),m=f.C.cu(b,q);if(null!=D||null!=a)f.vh.Cb(c,d,t,l,m,null,H,G),H=Math.atan2(Math.sin(H.j)*Math.cos(h-t),Math.cos(H.j)),G=Math.atan2(Math.sin(G.j)*Math.cos(q-m),Math.cos(G.j)),0!=r&&(A=H,H=G,G=A),null!=
D&&(D.j=H),null!=a&&(a.j=G);null!=v&&(f.C.Ck(1,b,h,d,0,g,u,z),e[0]=g.j,e[1]=u.j,e[2]=z.j,f.C.Ck(1,b,q,l,0,g,u,z),E[0]=g.j,E[1]=u.j,E[2]=z.j,k[0]=e[1]*E[2]-E[1]*e[2],k[1]=-(e[0]*E[2]-E[0]*e[2]),k[2]=e[0]*E[1]-E[0]*e[1],b=1-f.C.Cm(b,f.C.Mr(b,f.C.hk(b,Math.acos(k[2]/Math.sqrt(k[0]*k[0]+k[1]*k[1]+k[2]*k[2]))))),b*=2-b,D=Math.atan2(-k[1],-k[0]),k=f.C.da(D-1.570796326794897),D=f.C.da(D+1.570796326794897),k=f.l.K(f.C.da(d-k))<=f.l.K(f.C.da(d-D))?k:D,f.vh.Cb(1,k,0,d,t,p,null,null),f.vh.Cb(1,k,0,l,m,n,null,
null),3.141592653589793<p.j+n.j&&(k=f.C.da(k+3.141592653589793),f.vh.Cb(1,k,0,d,t,p,null,null),f.vh.Cb(1,k,0,l,m,n,null,null)),p.j*=f.l.Ab(1,h),n.j*=f.l.Ab(1,q),p.j=f.C.hk(b,p.j),n.j=f.C.hk(b,n.j),d=f.C.q(c,b,p.j),c=f.C.q(c,b,n.j),v.j=f.l.K(c-d))}}};a.Uf=function(c,b,d,h,l,q,v,D){var a=0,F=new f.ea(0),G=new f.ea(0),e=[0,0,0],E=[0,0,0],k=new f.ea(0),p=new f.ea(0),n=new f.ea(0);if(null!=v||null!=D)if(f.l.Qi(b))f.vh.Uf(c,d,h,l,q,v,D);else if(f.l.wd(l))null!=v&&(v.j=d),null!=D&&(D.j=h);else{q=f.C.da(q);
0>l&&(l=f.l.K(l),q=f.C.da(q+3.141592653589793));d=f.C.da(d);h=f.C.da(h);1.570796326794897<f.l.K(h)&&(d=f.C.da(d+3.141592653589793),h=f.l.Ab(3.141592653589793,h)-h);f.l.W(f.l.K(h),1.570796326794897)&&(d=0);var g;if(f.l.wd(h))g=f.l.K(1.570796326794897-f.l.K(q)),g=f.C.hk(b,g),g=1-f.C.Cm(b,f.C.Mr(b,g)),g*=2-g,c=l/f.C.Yg(c,g)*1.570796326794897,c=f.C.xp(g,c),c=f.C.cu(g,c),f.vh.Uf(1,d,h,c,q,v,F),null!=D&&(a=F.j),null!=D&&(D.j=f.C.hk(b,a));else if(f.l.W(f.l.K(h),1.570796326794897))a=f.C.Yg(c,b),F=2*a,c=f.l.Ab(1.570796326794897,
h),q=0<c?f.C.da(3.141592653589793-q):q,h=a-l,f.l.K(h)<=a?null!=v&&(v.j=q):(h=Math.floor(l/F),0==f.J.truncate(h%2)?(null!=v&&(v.j=q),h=a-(l-h*F)):(null!=v&&(v.j=f.C.da(q+3.141592653589793)),h=a-((h+1)*F-l))),null!=D&&(D.j=f.C.xp(b,h/a*c));else{g=f.C.cu(b,h);q=Math.atan2(Math.sin(q),Math.cos(q)*Math.cos(h-g));var u=f.J.truncate(f.l.Ab(1,g))*(1.570796326794897>=f.l.K(q)?1:-1);q=f.C.da(d+Math.atan(Math.tan(q)*-Math.sin(g)));f.vh.Cb(c,q,0,d,g,null,G,null);g=f.l.K(1.570796326794897-f.l.K(G.j));g=f.C.hk(b,
g);g=1-f.C.Cm(b,f.C.Mr(b,g));g*=2-g;f.C.Ck(1,b,0,q,0,k,p,n);e[0]=k.j;e[1]=p.j;e[2]=n.j;f.C.Ck(1,b,h,d,0,k,p,n);E[0]=k.j;E[1]=p.j;E[2]=n.j;h=Math.acos((e[0]*E[0]+e[1]*E[1]+e[2]*E[2])/Math.sqrt(E[0]*E[0]+E[1]*E[1]+E[2]*E[2]));h=f.C.hk(g,h);h=f.C.q(c,g,h)+l*u;l=0<h?G.j:f.C.da(G.j+3.141592653589793);c=f.l.K(h)/f.C.Yg(c,g)*1.570796326794897;c=f.C.xp(g,c);c=f.C.cu(g,c);f.vh.Uf(1,q,0,c,l,v,F);null!=D&&(a=F.j);null!=D&&(D.j=f.C.hk(b,a))}}};return a}();f.yl=a})(C||(C={}));(function(f){var a=function(){function a(){}
a.Cb=function(c,b,d,h,l,q,v,D,a){var H=0,G=0,e=0;if(null!=v||null!=D||null!=a)if(f.l.Qi(b))f.vh.Cb(c,d,h,l,q,v,D,a);else{var E=f.C.da(l-d);if(f.l.W(h,q)&&(f.l.wd(E)||f.l.W(f.l.K(h),1.570796326794897)))null!=v&&(v.j=0),null!=D&&(D.j=0),null!=a&&(a.j=0);else{if(f.l.W(h,-q)){if(f.l.W(f.l.K(h),1.570796326794897)){null!=v&&(v.j=2*f.C.Yg(c,b));null!=D&&(D.j=0<h?f.C.da(3.141592653589793-f.C.da(l)):f.C.da(l));null!=a&&(a.j=0<h?f.C.da(l):f.C.da(3.141592653589793-f.C.da(l)));return}f.l.W(f.l.K(E),3.141592653589793)&&
(null!=v&&(v.j=2*f.C.Yg(c,b)),null!=D&&(D.j=0),null!=a&&(a.j=0))}else{if(f.l.W(f.l.K(h),1.570796326794897)||f.l.W(f.l.K(q),1.570796326794897)){f.yl.Cb(c,b,d,h,l,q,v,D,a);return}if(f.l.wd(E)||f.l.W(f.l.K(E),3.141592653589793)){f.yl.Cb(c,b,d,h,l,q,v,D,a);return}}var k=1-Math.sqrt(1-b),p=b/(1-b),n=c*(1-k);c=f.C.Mr(b,h);var g=f.C.Mr(b,q);b=1.570796326794897==f.l.K(c)?0:Math.cos(c);var u=Math.sin(c),z=1.570796326794897==f.l.K(g)?0:Math.cos(g),t=Math.sin(g),r=E,A=Math.cos(r),m=Math.sin(r),w=1,x=0,C,I,J,
K,y;do{C=r;I=Math.sqrt(Math.pow(z*m,2)+Math.pow(b*t-u*z*A,2));J=u*t+b*z*A;K=Math.atan2(I,J);if(0==I){w=0;break}y=b*z*m/I;H=Math.cos(Math.asin(y));H*=H;G=J-2*u*t/H;1<f.l.K(G)&&(G=f.l.Ab(1,G));e=G*G;r=k/16*H*(4+k*(4-3*H));r=E+(1-r)*k*y*(K+r*I*(G+r*J*(2*e-1)));A=Math.cos(r);m=Math.sin(r);x++;if(3.141592653589793<f.l.K(r)&&30<x){w=0;break}}while(5E3>=x&&!f.l.W(C,r));if(0!=w)p*=H,k=p*(256+p*(-128+p*(74-47*p)))/1024,null!=v&&(v.j=n*(1+p*(4096+p*(-768+p*(320-175*p)))/16384)*(K-k*I*(G+k/4*(J*(2*e-1)-k/6*
G*(4*I*I-3)*(4*e-3))))),null!=D&&(f.l.W(f.l.K(h),1.570796326794897)?D.j=0>h?l:f.C.da(3.141592653589793-l):D.j=Math.atan2(z*m,b*t-u*z*A)),null!=a&&(f.l.W(f.l.K(q),1.570796326794897)?a.j=0>q?d:f.C.da(3.141592653589793-d):(a.j=Math.atan2(b*m,b*t*A-u*z),a.j=f.C.da(a.j+3.141592653589793)));else{r=f.l.Ab(3.141592653589793,E);J=u*t-b*z;K=Math.acos(J);I=Math.sin(K);H=1;x=y=0;do e=y,H*=H,A=H*H,y=k*H*(1+k+k*k),G=k*k*A*(1+2.25*k),w=k*k*k*A*H,A=1-.25*y+.1875*G-.1953125*w,y=.25*y-.25*G+.29296875*w,m=.03125*G-
.05859375*w,w*=.00651041666666667,G=J-2*u*t/H,1<f.l.K(G)&&(G=f.l.Ab(1,G)),H=Math.acos(G),J=Math.cos(2*H),C=Math.cos(3*H),y=f.l.W(h,-q)?f.C.da(3.141592653589793-E)/(3.141592653589793*k*A):f.C.da(r-E)/(k*(A*K+y*I*G+m*Math.sin(2*K)*J+w*Math.sin(3*K)*C)),m=y*I/(b*z),r=1.570796326794897<f.l.K(E)?f.l.Ab(3.141592653589793,m)-Math.asin(m):Math.asin(m),A=Math.cos(r),I=Math.sqrt(Math.pow(z*m,2)+Math.pow(b*t-u*z*A,2)),K=3.141592653589793-Math.asin(f.l.K(I)),J=Math.cos(K),H=Math.cos(Math.asin(y)),x++;while(70>=
x&&!f.l.W(e,y));null!=v&&(H*=H,p*=H,A=1+p*(4096+p*(-768+p*(320-175*p)))/16384,f.l.W(h,-q)?v.j=3.141592653589793*n*A:(G=J-2*u*t/H,H=Math.acos(G),J=Math.cos(2*H),C=Math.cos(3*H),v.j=n*(A*K+p*(-512+p*(128+p*(-60+35*p)))/2048*I*G+p*(-4+5*p)/6144*p*p*Math.sin(2*K)*J+w*Math.sin(3*K)*C+-7.62939453125E-5*p*p*p*p*Math.sin(4*K)*Math.cos(4*H))));null!=D&&(f.l.wd(h)&&f.l.wd(q)?(H=Math.sqrt(1-y*y),D.j=Math.acos(H),0>E&&(D.j*=-1)):f.l.W(f.l.K(h),1.570796326794897)?D.j=0>h?l:f.C.da(3.141592653589793-l):(v=y/b,n=
Math.sqrt(1-v*v),0>b*t-u*z*Math.cos(r)&&(n*=-1),D.j=Math.atan2(v,n),f.l.W(h,-q)&&f.l.K(f.C.da(d-l))>3.141592653589793*(1-k*Math.cos(h))&&(0<h&&1.570796326794897>f.l.K(D.j)||0>h&&1.570796326794897<f.l.K(D.j))&&(D.j=f.l.Ab(3.141592653589793,D.j)-D.j)));if(null!=a)if(f.l.wd(h)&&f.l.wd(q))H=Math.sqrt(1-y*y),a.j=Math.acos(H),0<=E&&(a.j*=-1);else if(f.l.W(f.l.K(q),1.570796326794897))a.j=0>q?d:f.C.da(3.141592653589793-d);else if(E=y/z,v=Math.sqrt(1-E*E),n=Math.sin(r/2),0>Math.sin(g-c)-2*b*t*n*n&&(v*=-1),
a.j=Math.atan2(E,v),a.j=f.C.da(a.j+3.141592653589793),f.l.W(h,-q)&&!f.l.wd(h)&&!f.l.W(f.l.K(h),1.570796326794897)&&f.l.K(f.C.da(d-l))>3.141592653589793*(1-k*Math.cos(h))&&(null!=D?n=D.j:(v=y/b,n=Math.sqrt(1-v*v),0>b*t-u*z*Math.cos(r)&&(n*=-1),n=Math.atan2(v,n),f.l.W(h,-q)&&f.l.K(f.C.da(d-l))>3.141592653589793*(1-k*Math.cos(h))&&(0<h&&1.570796326794897>f.l.K(n)||0>h&&1.570796326794897<f.l.K(n))&&(n=f.l.Ab(3.141592653589793,n)-n)),1.570796326794897>=f.l.K(n)&&1.570796326794897<f.l.K(a.j)||1.570796326794897<=
f.l.K(n)&&1.570796326794897>f.l.K(a.j)))a.j=-1*f.C.da(a.j+3.141592653589793)}}}};a.Uf=function(c,b,d,h,l,q,v,D){if(null!=v||null!=D)if(f.l.Qi(b))f.vh.Uf(c,d,h,l,q,v,D);else if(q=f.C.da(q),f.l.W(f.l.K(h),1.570796326794897)||f.l.wd(q)||f.l.W(f.l.K(q),3.141592653589793))f.yl.Uf(c,b,d,h,l,q,v,D);else{var a=1.570796326794897==f.l.K(q)?0:Math.cos(q),F=3.141592653589793==f.l.K(q)?0:Math.sin(q);f.l.W(f.l.K(h),1.570796326794897)&&(d=0);q=1-Math.sqrt(1-b);var G=f.C.Mr(b,h);h=1.570796326794897==f.l.K(G)?0:Math.cos(G);
var e=Math.sin(G),G=Math.atan2(Math.tan(G),a),E=h*F,k=E*E,p=1-k,n=b/(1-b)*p;b=n*(256+n*(-128+n*(74-47*n)))/1024;var g=b/4,u=b/6,z=l/(c*(1-q)*(1+n*(4096+n*(-768+n*(320-175*n)))/16384)),t=z,r;do{r=t;l=1.570796326794897==f.l.K(t)?0:Math.cos(t);var n=3.141592653589793==f.l.K(t)?0:Math.sin(t),A=n*n;c=Math.cos(2*G+t);t=c*c;t=b*n*(c+g*(l*(2*t-1)-u*c*(4*A-3)*(4*t-3)))+z}while(!f.l.W(r,t));l=1.570796326794897==f.l.K(t)?0:Math.cos(t);n=3.141592653589793==f.l.K(t)?0:Math.sin(t);null!=v&&(F=Math.atan2(n*F,h*
l-e*n*a),p=q/16*p*(4+q*(4-3*p)),c=Math.cos(2*G+t),v.j=f.C.da(d+(F-(1-p)*q*E*(t+p*n*(c+p*l*(2*c*c-1))))));null!=D&&(p=e*n-h*l*a,p=(1-q)*Math.sqrt(k+p*p),D.j=Math.atan2(e*l+h*n*a,p))}};return a}();f.Mu=a})(C||(C={}));(function(f){var a=function(){function a(){}a.Cb=function(c,b,d,h,l,q,v,D,a){var H=f.C.da(l-d),G=f.l.W(f.l.K(h),1.570796326794897),e=f.l.W(f.l.K(q),1.570796326794897);if(f.l.W(h,q)&&(f.l.wd(H)||G))null!=v&&(v.j=0),null!=D&&(D.j=0),null!=a&&(a.j=0);else{var E,k;f.l.Qi(b)?(E=Math.sin(h),
k=Math.sin(q),E=Math.sqrt((1+E)/(1-E)),k=Math.sqrt((1+k)/(1-k)),E=Math.log(k)-Math.log(E),E=Math.atan2(H,E),null!=v&&(v.j=f.l.W(h,q)?f.l.K(c*Math.cos(h)*H):f.l.K((c*q-c*h)/Math.cos(E)))):(k=f.C.Bx(b,q),E=Math.sin(f.C.Bx(b,h)),k=Math.sin(k),E=Math.sqrt((1+E)/(1-E)),k=Math.sqrt((1+k)/(1-k)),E=Math.log(k)-Math.log(E),E=Math.atan2(H,E),null!=v&&(f.l.W(h,q)?v.j=f.l.K(c*H*Math.cos(h)/f.C.Cm(b,h)):(H=f.C.q(c,b,h),c=f.C.q(c,b,q),v.j=f.l.K((c-H)/Math.cos(E)))));if(null!=D||null!=a)v=f.C.da(E+3.141592653589793),
G&&e||!G&&!e||(G?E=0>h?l:f.C.da(3.141592653589793-l):e&&(v=0>q?d:f.C.da(3.141592653589793-d))),null!=D&&(D.j=E),null!=a&&(a.j=v)}};a.Uf=function(c,b,d,h,l,q,v,D){q=f.C.da(q);0>l&&(l=f.l.K(l),q=f.C.da(q+3.141592653589793));f.l.Qi(b)?f.l.W(f.l.K(h),1.570796326794897)?(d=0>h?q:f.C.da(3.141592653589793-q),q=l/c%6.283185307179586,3.141592653589793>=q?c=h-f.l.Ab(q,h):(d=f.C.da(d+3.141592653589793),c=-h+f.l.Ab(q-3.141592653589793,h))):f.l.W(f.l.K(q),1.570796326794897)?(d=f.C.da(d+f.l.Ab(l,q)/(c*Math.cos(h))),
c=h):(c=h+l*Math.cos(q)/c,1.570796326794897<f.l.K(c)&&(c=1.570796326794897),f.l.W(f.l.K(c),1.570796326794897)&&(f.l.wd(q)||f.l.W(f.l.K(q),3.141592653589793))||(1.570796316258184<f.l.K(c)&&(c=f.l.Ab(1.570796316258184,c)),b=Math.sin(h),h=Math.sin(c),b=Math.sqrt((1+b)/(1-b)),h=Math.sqrt((1+h)/(1-h)),b=Math.log(h)-Math.log(b),d=f.C.da(d+Math.tan(q)*b))):f.l.W(f.l.K(h),1.570796326794897)?(d=0>h?q:f.C.da(3.141592653589793-q),q=l/f.C.oX(c,b),q%=6.283185307179586,3.141592653589793>=q?(c=h-f.l.Ab(q,h),c=f.C.xp(b,
c)):(d=f.C.da(d+3.141592653589793),c=-h+f.l.Ab(q-3.141592653589793,h),c=f.C.xp(b,c))):f.l.W(f.l.K(q),1.570796326794897)?(d=f.C.da(d+f.l.Ab(l,q)*f.C.Cm(b,h)/(c*Math.cos(h))),c=h):(c=1.570796326794897*(l*Math.cos(q)+f.C.q(c,b,h))/f.C.Yg(c,b),1.570796326794897<f.l.K(c)&&(c=f.l.Ab(1.570796326794897,c)),c=f.C.xp(b,c),f.l.W(f.l.K(c),1.570796326794897)&&(f.l.wd(q)||f.l.W(f.l.K(q),3.141592653589793))||(l=f.C.Bx(b,h),h=f.C.Bx(b,c),1.570796316258184<f.l.K(h)&&(h=f.l.Ab(1.570796316258184,c),c=f.C.AQ(b,h)),b=
Math.sin(l),h=Math.sin(h),b=Math.sqrt((1+b)/(1-b)),h=Math.sqrt((1+h)/(1-h)),b=Math.log(h)-Math.log(b),d=f.C.da(d+Math.tan(q)*b)));null!=v&&(v.j=d);null!=D&&(D.j=c)};return a}();f.TD=a})(C||(C={}));(function(f){var a=function(){function a(){}a.Ez=function(c,b,d,h,l,q,v){f.Mu.Cb(c,b,d,h,l,q,null,v,null)};a.Xi=function(c,b,d,h,l,q,v,D){f.Mu.Uf(c,b,d,h,l,q,v,D)};a.Md=function(c,b,d,h,l,q,v,D,a,F){switch(F){case 2:f.yl.Cb(c,b,d,h,l,q,v,D,a);break;case 3:f.UD.Cb(c,b,d,h,l,q,v,D,a);break;case 1:f.TD.Cb(c,
b,d,h,l,q,v,D,a);break;default:f.Mu.Cb(c,b,d,h,l,q,v,D,a)}};a.Oj=function(c,b,d,h,l,q,v,D,a){switch(a){case 2:f.yl.Uf(c,b,d,h,l,q,v,D);break;case 3:f.UD.Uf(c,b,d,h,l,q,v,D);break;case 1:f.TD.Uf(c,b,d,h,l,q,v,D);break;default:f.Mu.Uf(c,b,d,h,l,q,v,D)}};return a}();f.mb=a})(C||(C={}));(function(f){var a=function(){function b(){this.y=this.x=null}b.pa=function(d){var c=new b;c.x=new f.Xb;c.x.set(d.x);c.y=new f.Xb;c.y.set(d.y);return c};b.$F=function(d,c){var h=new b;h.x=new f.Xb;h.x.set(d);h.y=new f.Xb;
h.y.set(c);return h};b.prototype.Lg=function(){return this.x.Lg()&&this.y.Lg()};b.prototype.value=function(){return f.b.pa(this.x.value(),this.y.value())};return b}();f.HZ=a;var e=function(){function b(){this.z=this.y=this.x=null}b.pa=function(d){var c=new b;c.x=new f.Xb;c.x.set(d.x);c.y=new f.Xb;c.y.set(d.y);c.z=new f.Xb;c.z.set(d.z);return c};b.$F=function(d,c,l){var h=new b;h.x=new f.Xb;h.x.set(d);h.y=new f.Xb;h.y.set(c);h.z=new f.Xb;h.z.set(l);return h};b.prototype.Lg=function(){return this.x.Lg()&&
this.y.Lg()&&this.z.Lg()};b.prototype.value=function(){return new f.qd(this.x.value(),this.y.value(),this.z.value())};b.prototype.oi=function(b){var d=new f.Xb,c=new f.Xb,q=new f.Xb;d.pm(this.x,b.x);c.pm(this.y,b.y);q.pm(this.z,b.z);b=new f.Xb;b.aP(d,c);b.add(q);return b};b.prototype.iG=function(d){var c=new b;c.x.pm(this.y,d.z);c.y.pm(this.z,d.x);c.z.pm(this.x,d.y);var l=new f.Xb,q=new f.Xb,v=new f.Xb;l.pm(this.z,d.y);q.pm(this.x,d.z);v.pm(this.y,d.x);c.x.sub(l);c.y.sub(q);c.z.sub(v);return c};return b}();
f.IZ=e;var c=function(){function b(){}b.oO=function(d,c,l){var h=c.x;c=c.y;b.Ck(1,d,Math.cos(h),Math.sin(h),Math.cos(c),Math.sin(c),l)};b.lO=function(d,c){var h=new f.qd;b.oO(d,c,h);return h};b.GZ=function(d,c,l,q,v,D){var h=new f.qd;b.Ck(d,c,l,q,v,D,h);return h};b.Ck=function(b,c,l,f,v,D,a){b/=Math.sqrt(1-c*D*D);a.I(b*v*l,b*v*f,b*(1-c)*D)};b.Ru=function(b,c){var d=new f.Xb,h=new f.Xb,v=new f.Xb,D=new f.Xb;d.cos(c.x);h.sin(c.x);v.cos(c.y);D.sin(c.y);c=new f.Xb;c.set(D);c.Vg(D);c.yp(b);c.yp(-1);c.hP();
c.sqrt();var a=new f.Xb;a.set(1);a.Xm(c);c=new f.Xb;c.set(a);c.Vg(v);c.Vg(d);d=new f.Xb;d.set(a);d.Vg(v);d.Vg(h);h=new f.Xb;h.set(a);h.yp(1-b);h.Vg(D);return e.$F(c,d,h)};b.KN=function(b,c,l){var d=c.x,h=c.y;l.ka(Math.atan2(h,d),Math.atan2(c.z,(1-b)*Math.sqrt(d*d+h*h)))};b.Y_=function(d,c,l){d=new f.b;b.KN(c,l,d);return d};b.LU=function(d,c,l,q){if(Math.abs(c.x-l.x)>Math.PI||Math.abs(c.y)>.5*Math.PI||Math.abs(l.y)>.5*Math.PI||(Math.abs(c.y)==.5*Math.PI||Math.abs(l.y)==.5*Math.PI)&&c.x!=l.x)return NaN;
q=b.QC(q,Math.min(c.x,l.x),Math.max(c.x,l.x));if(!(new f.Ac(c.x,l.x)).contains(q))return NaN;var h=a.pa(c);l=a.pa(l);h=b.Ru(d,h);l=b.Ru(d,l);l=h.iG(l);if(l.z.Lg())return c=c.y;var D=new f.Xb;D.set(l.x);D.Xm(l.z);D.yp(-1);var H=new f.Xb;H.set(l.y);H.Xm(l.z);H.yp(-1);var F=new f.Xb;F.set(H);F.Vg(H);h=new f.Xb;h.set(D);h.Vg(D);h.add(F);h.sqrt();if(h.Lg()||D.Lg()&&H.Lg())return c=c.y;c=Math.atan2(H.value(),D.value());c=Math.atan2(h.value()*Math.cos(c-q),1-d);q=b.lO(d,f.b.pa(q,c));d=new f.qd(q.x,q.y,-q.z);
q=l.value().oi(q);d=l.value().oi(d);Math.abs(d)<Math.abs(q)&&(c=-c);return c};b.tA=function(d,c,l,q,v,D){D[0]=NaN;D[1]=NaN;if(Math.abs(l.x-q.x)>Math.PI||Math.abs(l.y)>.5*Math.PI||Math.abs(q.y)>.5*Math.PI||(Math.abs(l.y)==.5*Math.PI||Math.abs(q.y)==.5*Math.PI)&&l.x!=q.x||Math.abs(v)>=.5*Math.PI||0<l.y&&0<q.y&&l.y>v&&q.y>v||0>l.y&&0>q.y&&l.y<v&&q.y<v)return 0;var h=a.pa(l);d=a.pa(q);h=b.Ru(c,h);d=b.Ru(c,d);var F=h.iG(d);if(F.z.Lg())return(new f.Ac(l.y,q.y)).contains(v)?(D[0]=l.x,1):0;d=new f.Xb;d.set(F.x);
d.Xm(F.z);d.yp(-1);h=new f.Xb;h.set(F.y);h.Xm(F.z);h.yp(-1);F=new f.Xb;F.set(h);F.Vg(h);var G=new f.Xb;G.set(d);G.Vg(d);G.add(F);G.sqrt();if(G.Lg()||d.Lg()&&h.Lg())return 0==v?(D[0]=l.x,D[1]=q.x,2):0;c=(1-c)*Math.tan(v)/G.value();if(1<Math.abs(c))return 0;c=Math.acos(c);F=Math.atan2(h.value(),d.value());d=Math.min(l.x,q.x);h=Math.max(l.x,q.x);q=b.QC(F-c,d,h);c=0!=v?b.QC(F+c,d,h):q;v=0;d<=q&&q<=h&&(D[v]=q,v++);c!=q&&d<=c&&c<=h&&(D[v]=c,v++,2==v&&Math.abs(D[0]-l.x)>Math.abs(D[1]-l.x)&&(l=D[0],D[0]=
D[1],D[1]=l));return v};b.QC=function(b,c,l){b>l?(c=Math.ceil((b-l)/(2*Math.PI)),b-=2*c*Math.PI):b<c&&(c=Math.ceil((c-b)/(2*Math.PI)),b+=2*c*Math.PI);return b};b.JB=function(b,c){c[0]>.5*Math.PI?(b[0]+=Math.PI,c[0]=Math.PI-c[0]):c[0]<-.5*Math.PI&&(b[0]-=Math.PI,c[0]=-Math.PI-c[0])};return b}();f.xy=c})(C||(C={}));(function(f){var a=function(){function a(){}a.SY=function(c,b){var d=8;0>d&&(d=8);var h=[0,0,0,0],l=new f.b;l.L(b);l.scale(9102==f.fb.kc(c).Od().yc()?1:f.fb.kc(c).Od().Ai/3.141592653589793*
180);-180>l.x?(l.x-=l.x%360,-180>l.x&&(l.x+=360)):180<l.x&&(l.x-=l.x%360,180<l.x&&(l.x-=360));90<l.y&&(l.y=90);-90>l.y&&(l.y=-90);c=5*d;b=(c+31)/32;for(var q=-180,v=180,D=c-1,H=b-1;0<=H;H--)for(var F=D-32*H,G=Math.min(32,c-32*H),e=1;e<G;e+=2){var E=.5*(v+q);l.x>=E?(h[H]|=1<<F,q=E):v=E;F-=2;D-=2}q=-90;v=90;D=c-2;for(H=b-1;0<=H;H--)for(F=D-32*H,G=Math.min(32,c-32*H),e=0;e<G;e+=2)E=.5*(v+q),l.y>=E?(h[H]|=1<<F,q=E):v=E,F-=2,D-=2;return a.uO(h,d,d)};a.uO=function(c,b,d){for(var h=[],l=0;l<b;l++)h[l]="";
for(var f=l=0,v=0;v<b;v++){var D=c[l]>>f&31,f=f+5;if(31<f){var a=37-f,D=D&(1<<a)-1,f=f-32;l++;D|=(c[l]&(1<<f)-1)<<a}h[b-1-v]="0123456789bcdefghjkmnpqrstuvwxyz".split("")[D]}if(d>b)for(v=0;v<d-b;v++)h.push("0");else d<b&&(h.length=d);return h.join("")};return a}();f.rM=a})(C||(C={}));(function(f){var a={gcstol:[0,1E-8,1,1.11111E-8,2,1.68845E-8,3,2.17661E-8,4,2.22508E-8,5,2.34848E-8,6,2.37811E-8,7,2.88455E-8,8,3.1456E-8,9,3.29779E-8,10,3.66789E-8,11,4.23597E-8,12,4.79463E-8,13,6.45223E-8,14,7.26274E-8,
15,7.49945E-8,16,7.52506E-8,17,7.97991E-8,18,9.66202E-8,19,9.79918E-8,20,9.89735E-8,21,1.02314E-7,22,1.08146E-7,23,2.29734E-7,24,2.42985E-7,25,2.7546E-7,26,3.37034E-7,27,4.30795E-7,28,5.20871E-7,29,5.50921E-7,30,6.74068E-7,31,6.86177E-7,32,7.25263E-7,33,7.44101E-7,34,7.74267E-7,35,9.62954E-7,36,1.06103E-6,37,1.14363E-6,38,1.16219E-6,39,1.36419E-6,40,1.36744E-6,41,1.43239E-6,42,1.73624E-6,43,1.84825E-6,44,1.90986E-6,45,1.97572E-6,46,2.12207E-6,47,2.72837E-6,48,3.1831E-6,49,3.58099E-6,50,3.81972E-6,
51,4.09256E-6,52,4.40737E-6,53,4.77465E-6,54,5.16178E-6,55,5.20871E-6,56,5.72958E-6,57,6.03113E-6,58,6.98729E-6,59,9.24125E-6,60,1.14592E-5],pcstol:[0,6.66667E-9,1,2E-8,2,4.97098E-5,3,.001,4,.00109362,5,.00328087,6,.00497101],newtoold:[2154,102110,2195,102200,2204,32036,2205,26979,2225,102641,2226,102642,2227,102643,2228,102644,2229,102645,2230,102646,2231,102653,2232,102654,2233,102655,2234,102656,2235,102657,2236,102658,2237,102659,2238,102660,2239,102666,2240,102667,2241,102668,2242,102669,2243,
102670,2246,102679,2247,102680,2248,102685,2249,102686,2250,102687,2254,102694,2255,102695,2257,102712,2258,102713,2259,102714,2260,102715,2261,102716,2262,102717,2263,102718,2264,102719,2267,102724,2268,102725,2271,102728,2272,102729,2274,102736,2275,102737,2276,102738,2277,102739,2278,102740,2279,102741,2283,102746,2284,102747,2285,102748,2286,102749,2287,102752,2288,102753,2289,102754,2312,23433,2326,102140,2395,2091,2396,2092,2397,2166,2398,2167,2399,2168,2759,102229,2760,102230,2761,102248,2762,
102249,2763,102250,2764,102251,2765,102252,2766,102241,2767,102242,2768,102243,2769,102244,2770,102245,2771,102246,2772,102253,2773,102254,2774,102255,2775,102256,2776,102257,2777,102258,2778,102259,2779,102260,2780,102266,2781,102267,2782,102261,2783,102262,2784,102263,2785,102264,2786,102265,2787,102268,2788,102269,2789,102270,2790,102271,2791,102272,2792,102273,2793,102274,2794,102275,2795,102276,2796,102277,2797,102278,2798,102279,2799,102280,2800,102281,2801,102282,2802,102283,2803,102284,2804,
102285,2805,102286,2806,102287,2807,102288,2808,102289,2809,102290,2810,102291,2811,102292,2812,102293,2813,102294,2814,102295,2815,102296,2816,102297,2817,102298,2818,102300,2819,102304,2820,102307,2821,102308,2822,102309,2823,102310,2824,102311,2825,102312,2826,102313,2827,102314,2828,102315,2829,102316,2830,102317,2831,102318,2832,102320,2833,102321,2834,102322,2835,102323,2836,102324,2837,102325,2838,102326,2839,102327,2840,102330,2841,102334,2842,102335,2843,102336,2844,102337,2845,102338,2846,
102339,2847,102340,2848,102341,2849,102342,2850,102343,2851,102344,2852,102345,2853,102346,2854,102347,2855,102348,2856,102349,2857,102350,2858,102351,2859,102352,2860,102353,2861,102354,2862,102355,2863,102356,2864,102357,2865,102358,2866,102361,2942,102167,2943,102169,2944,2139,2945,2140,2946,2141,2947,2142,2948,2143,2949,2144,2950,2145,2951,2146,2952,2147,2953,2036,2954,2291,2955,2153,2956,2152,2957,2151,2958,2150,2959,2149,2960,2037,2961,2038,2962,2148,2965,2244,2966,2245,3003,102091,3004,102092,
3005,102190,3060,2982,3067,102139,3072,102606,3074,102608,3075,102208,3077,102210,3078,102123,3080,102119,3081,102603,3082,102602,3083,102601,3088,65163,3089,102763,3090,102363,3092,102151,3093,102152,3094,102153,3095,102154,3096,102155,3097,102145,3098,102146,3099,102147,3100,102148,3101,102149,3102,2155,3107,102172,3110,102170,3111,102171,3119,2214,3158,102234,3159,102235,3160,102236,3336,2979,3338,102006,3346,2600,3370,102126,3371,102127,3372,102130,3373,102131,3400,102184,3401,102185,3404,3359,
3407,3366,3417,102675,3418,102676,3419,102677,3420,102678,3421,102707,3422,102708,3423,102709,3424,102711,3433,102651,3434,102652,3435,102671,3436,102672,3437,102710,3438,102730,3448,102095,3451,102681,3452,102682,3455,102735,3461,2063,3462,2064,3463,3073,3464,3076,3560,102742,3566,102743,3567,102744,3734,102722,3735,102723,3736,102755,3737,102756,3738,102757,3739,102758,3741,102205,3742,102206,3743,102207,3748,102211,3750,102202,3751,102203,3759,102663,3760,102463,3764,102112,3770,102090,3771,102180,
3772,102181,3773,102182,3775,102186,3776,102187,3777,102188,3800,102183,3801,102189,3812,102199,3814,102609,3815,102469,3819,104990,3821,104136,3824,104137,3825,102444,3826,102443,3827,102442,3828,102441,3857,102100,3889,104991,3906,104992,4048,103201,4049,103202,4050,103203,4051,103204,4056,103205,4057,103206,4058,103207,4059,103208,4060,103209,4061,103210,4062,103211,4063,103212,4071,103213,4082,103214,4083,103215,4093,103216,4094,103217,4095,103218,4096,103219,4167,104108,4169,37252,4171,104107,
4189,104110,4197,4234,4223,37223,4304,104304,4414,102201,4415,102762,4417,102764,4434,102765,4437,102647,4455,32029,4456,32018,4457,3454,4462,102439,4463,4466,4470,4469,4484,103794,4485,103795,4486,103796,4487,103797,4488,103798,4489,103799,4611,104104,4612,104111,4613,37255,4615,37247,4616,37250,4617,4140,4618,4291,4620,37211,4626,37235,4647,102362,4658,37204,4668,37201,4669,4126,4672,37217,4673,104125,4675,37220,4684,37232,4698,4631,4707,37213,4708,37231,4709,37212,4710,37238,4711,37214,4712,37237,
4713,37208,4714,37215,4715,37253,4716,37216,4717,37239,4719,37219,4722,37242,4724,37233,4725,37222,4727,37224,4728,37246,4729,37226,4730,37227,4731,37228,4732,37229,4733,37230,4734,37251,4735,37259,4736,37254,4739,37205,4758,104133,4760,37001,4762,104114,4826,102214,5013,104142,5014,102331,5015,102332,5016,102333,5173,102085,5174,102086,5175,102087,5176,102088,5177,102089,5178,102040,5179,102080,5185,102081,5186,102082,5187,102083,5188,102084,5221,102066,5246,104100,5247,102490,5324,104144,5325,102420,
5329,2934,5365,104143,5367,102305,5451,104132,5513,102065,5514,102067,5519,102111,5520,31461,5646,102745,5839,5388,5858,5532,5879,4474,21896,21891,21897,21892,21898,21893,21899,21894,26701,102124,26702,102125,26799,26747,26847,102683,26848,102684,26849,102691,26850,102692,26851,102693,26852,102704,26853,102750,26854,102751,26857,102466,26858,102467,26859,102468,26901,102128,26902,102129,27493,27492,29101,29100,29168,29118,29169,29119,29170,29120,29171,29121,29172,29122,29187,29177,29188,29178,29189,
29179,29190,29180,29191,29181,29192,29182,29193,29183,29194,29184,29195,29185,29902,29900,31279,31278,31281,31291,31282,31292,31283,31293,31284,31294,31285,31295,31286,31296,31287,31297,31466,31462,31467,31463,31468,31464,31469,31465,31986,31917,31987,31918,31988,31919,31989,31920,31990,31921,31991,31922,32064,32074,32065,32075,32066,32076,32067,32077],pcsid:[2066,6,2136,5,2155,5,2157,3,2158,3,2159,5,2160,5,2219,3,2220,3,2244,5,2245,5,2256,5,2265,5,2266,5,2269,5,2270,5,2273,5,2290,3,2291,3,2294,3,
2295,3,2313,3,2314,5,2964,5,2967,5,2968,5,2991,3,2992,5,2993,3,2994,5,3073,3,3076,3,3079,3,3091,5,3106,3,3108,3,3109,3,3141,3,3142,3,3167,2,3337,3,3347,3,3348,3,3359,5,3360,3,3361,5,3362,3,3363,5,3364,3,3365,5,3366,5,3402,3,3403,3,3405,3,3406,3,3439,3,3440,3,3447,3,3449,3,3450,3,3453,5,3454,5,3460,3,3479,5,3480,3,3481,5,3482,3,3483,5,3484,3,3485,5,3486,3,3487,5,3488,3,3489,3,3490,5,3491,3,3492,5,3493,3,3494,5,3495,3,3496,5,3497,3,3498,5,3499,3,3500,5,3501,3,3502,5,3503,3,3504,5,3505,3,3506,5,3507,
3,3508,5,3509,3,3510,5,3511,3,3512,5,3513,3,3514,3,3515,5,3516,3,3517,5,3518,3,3519,5,3520,3,3521,5,3522,3,3523,5,3524,3,3525,5,3526,3,3527,5,3528,3,3529,5,3530,3,3531,5,3532,3,3533,5,3534,3,3535,5,3536,3,3537,5,3538,3,3539,5,3540,3,3541,5,3542,3,3543,5,3544,3,3545,5,3546,3,3547,5,3548,3,3549,5,3550,3,3551,5,3552,3,3553,5,3582,5,3583,3,3584,5,3585,3,3586,5,3587,3,3588,5,3589,3,3590,5,3591,3,3592,3,3593,5,3598,5,3599,3,3600,5,3605,5,3606,3,3607,3,3608,5,3609,3,3610,5,3611,3,3612,5,3613,3,3614,5,3615,
3,3616,5,3617,3,3618,5,3619,3,3620,5,3621,3,3622,5,3623,3,3624,5,3625,3,3626,5,3627,3,3628,5,3629,3,3630,5,3631,3,3632,5,3633,3,3634,5,3635,3,3636,5,3640,5,3641,3,3642,5,3643,3,3644,5,3645,3,3646,5,3647,3,3648,5,3649,3,3650,5,3651,3,3652,5,3653,3,3654,5,3655,3,3656,5,3657,3,3658,5,3659,3,3660,5,3661,3,3662,5,3663,3,3664,5,3668,5,3669,3,3670,5,3671,3,3672,5,3673,3,3674,5,3675,3,3676,5,3677,5,3678,3,3679,5,3680,5,3681,3,3682,5,3683,5,3684,3,3685,3,3686,5,3687,3,3688,5,3689,3,3690,5,3691,3,3692,5,3696,
5,3697,3,3698,5,3699,3,3700,5,3740,3,3749,3,3783,3,3784,3,3793,3,3794,3,3802,3,3816,3,3829,3,3854,3,3920,3,3978,3,3979,3,3991,5,3992,5,4026,3,4037,3,4038,3,4217,5,4438,5,4439,5,4467,3,4471,3,4474,3,4559,3,4839,3,5018,3,5048,3,5167,3,5168,3,5223,3,5234,3,5235,3,5243,3,5266,3,5316,3,5320,3,5321,3,5330,3,5331,3,5337,3,5361,3,5362,3,5382,3,5383,3,5396,3,5456,3,5457,3,5469,3,5472,4,5490,3,5518,3,5523,3,5559,3,5588,5,5589,5,5596,3,5627,3,5629,3,5641,3,5643,3,5644,3,5654,5,5655,5,5659,3,5700,3,5825,3,5836,
3,5837,3,5842,3,5844,3,5880,3,5887,3,5890,3,20499,3,20538,3,20539,3,20790,3,20791,3,21291,3,21292,3,21500,3,21817,3,21818,3,22032,3,22033,3,22091,3,22092,3,22332,3,22391,3,22392,3,22700,3,22770,3,22780,3,22832,3,23090,3,23095,3,23239,3,23240,3,23433,3,23700,3,24047,3,24048,3,24100,5,24200,3,24305,3,24306,3,24382,4,24383,3,24500,3,24547,3,24548,3,24571,2,24600,3,25E3,3,25231,3,25884,3,25932,3,26237,3,26331,3,26332,3,26591,3,26592,3,26632,3,26692,3,26855,5,26856,5,27120,3,27200,3,27291,4,27292,4,27429,
3,27492,3,27500,3,27700,3,28232,3,28600,3,28991,3,28992,3,29100,3,29220,3,29221,3,29333,3,29635,3,29636,3,29701,3,29738,3,29739,3,29849,3,29850,3,29871,2,29872,5,29873,3,29900,3,29901,3,29903,3,30200,6,30339,3,30340,3,30591,3,30592,3,30791,3,30792,3,31028,3,31121,3,31154,3,31170,3,31171,3,31370,3,31528,3,31529,3,31600,3,31700,3,31838,3,31839,3,31901,3,32061,3,32062,3,32098,3,32099,5,32100,3,32104,3,32161,3,32766,3,53034,3,53048,3,53049,3,54034,3,65061,5,65062,5,65161,3,65163,3,102041,5,102064,4,102068,
1,102069,0,102217,5,102218,3,102219,5,102220,5,102378,5,102379,5,102380,3,102381,5,102589,5,102599,5,102600,5,102604,5,102605,3,102606,3,102647,3,102704,5,102705,5,102733,5,102761,5,102762,3,102763,5,102764,3,102765,3,102766,5,102970,5,102974,5,102993,3,102994,3,102995,5,102996,5,103015,3,103016,5,103017,3,103018,5,103025,3,103026,3,103027,5,103028,5,103035,3,103036,3,103037,5,103038,5,103039,3,103040,3,103041,5,103042,5,103043,3,103044,3,103045,5,103046,5,103047,3,103048,3,103049,5,103050,5,103051,
3,103052,5,103053,3,103054,5,103055,3,103056,5,103057,3,103058,3,103059,5,103060,5,103061,3,103062,3,103063,5,103064,5,103069,5,103070,3,103071,3,103072,5,103073,5,103086,3,103087,3,103088,5,103089,5,103094,5,103095,3,103096,5,103103,3,103104,5,103105,3,103106,5,103121,3,103122,5,103123,3,103124,3,103125,5,103126,5,103127,3,103128,3,103129,5,103130,5,103131,3,103132,3,103133,5,103134,5,103135,3,103136,3,103137,5,103138,5,103139,3,103140,5,103141,3,103142,5,103143,3,103144,5,103145,3,103146,5,103147,
3,103148,3,103149,5,103150,5,103151,3,103152,5,103172,3,103173,5,103174,3,103175,3,103176,5,103177,5,103178,3,103179,3,103180,5,103181,5,103182,3,103183,3,103184,5,103185,5,103228,3,103229,3,103230,5,103231,5,103250,3,103251,5,103252,3,103253,5,103260,3,103261,3,103262,5,103263,5,103270,3,103271,3,103272,5,103273,5,103274,3,103275,3,103276,5,103277,5,103278,3,103279,3,103280,5,103281,5,103282,3,103283,3,103284,5,103285,5,103286,3,103287,5,103288,3,103289,5,103290,3,103291,5,103292,3,103293,3,103294,
5,103295,5,103296,3,103297,3,103298,5,103299,5,103376,5,103377,3,103378,3,103379,5,103380,5,103393,3,103394,3,103395,5,103396,5,103472,3,103473,5,103474,3,103475,5,103482,3,103483,5,103484,3,103485,5,103500,3,103501,5,103502,3,103503,3,103504,5,103505,5,103506,3,103507,3,103508,5,103509,5,103510,3,103511,3,103512,5,103513,5,103514,3,103515,5,103516,3,103517,5,103518,3,103519,5,103520,3,103521,5,103522,3,103523,3,103524,5,103525,5,103526,3,103527,5,103561,5,103562,5,103563,3,103564,3,103565,5,103566,
5,103567,3,103568,3,103569,5,103570,5,103585,5,103695,5],pcsidc:[[2E3,2045,3],[2056,2065,3],[2067,2135,3],[2137,2153,3],[2161,2170,3],[2172,2193,3],[2196,2198,3],[2200,2203,3],[2206,2217,3],[2222,2224,5],[2251,2253,5],[2280,2282,5],[2308,2311,3],[2315,2325,3],[2327,2394,3],[2400,2462,3],[2523,2576,3],[2578,2693,3],[2695,2758,3],[2867,2888,5],[2891,2930,5],[2931,2941,3],[2969,2973,3],[2975,2982,3],[2984,2988,3],[2995,3002,3],[3006,3051,3],[3054,3059,3],[3061,3066,3],[3068,3071,3],[3084,3087,3],[3112,
3118,3],[3120,3138,3],[3146,3151,3],[3153,3157,3],[3161,3166,3],[3168,3172,3],[3174,3203,3],[3294,3313,3],[3315,3335,3],[3339,3345,3],[3350,3358,3],[3367,3369,3],[3374,3399,3],[3408,3416,3],[3425,3432,5],[3441,3446,5],[3456,3459,5],[3465,3478,3],[3554,3559,3],[3561,3565,5],[3568,3570,5],[3571,3581,3],[3594,3597,3],[3601,3604,3],[3637,3639,3],[3665,3667,3],[3693,3695,3],[3701,3727,3],[3728,3733,5],[3744,3747,3],[3753,3758,5],[3761,3763,3],[3765,3769,3],[3779,3781,3],[3788,3791,3],[3797,3799,3],[3832,
3841,3],[3844,3852,3],[3873,3885,3],[3890,3893,3],[3907,3912,3],[3942,3950,3],[3968,3970,3],[3973,3976,3],[3986,3989,3],[3994,3997,3],[4399,4413,5],[4418,4433,5],[4491,4554,3],[5069,5072,3],[5105,5130,3],[5180,5184,3],[5253,5259,3],[5269,5275,3],[5292,5311,3],[5343,5349,3],[5355,5357,3],[5387,5389,3],[5459,5463,3],[5479,5482,3],[5530,5539,3],[5550,5552,3],[5562,5583,3],[5623,5625,5],[5631,5639,3],[5649,5653,3],[5663,5680,3],[5682,5685,3],[5875,5877,3],[20002,20032,3],[20062,20092,3],[20135,20138,
3],[20248,20258,3],[20348,20358,3],[20436,20440,3],[20822,20824,3],[20934,20936,3],[21035,21037,3],[21095,21097,3],[21148,21150,3],[21413,21423,3],[21473,21483,3],[21780,21782,3],[21891,21894,3],[22171,22177,3],[22181,22187,3],[22191,22197,3],[22234,22236,3],[22521,22525,3],[22991,22994,3],[23028,23038,3],[23830,23853,3],[23866,23872,3],[23877,23884,3],[23886,23894,3],[23946,23948,3],[24311,24313,3],[24342,24347,3],[24370,24374,4],[24375,24381,3],[24718,24721,3],[24817,24821,3],[24877,24882,3],[24891,
24893,3],[25391,25395,3],[25828,25838,3],[26191,26195,3],[26391,26393,3],[26703,26722,3],[26729,26760,5],[26766,26798,5],[26860,26870,5],[26891,26899,3],[26903,26923,3],[26929,26946,3],[26948,26998,3],[27037,27040,3],[27205,27232,3],[27258,27260,3],[27391,27398,3],[27561,27564,3],[27571,27574,3],[27581,27584,3],[27591,27594,3],[28191,28193,3],[28348,28358,3],[28402,28432,3],[28462,28492,3],[29118,29122,3],[29177,29185,3],[30161,30179,3],[30491,30494,3],[30729,30732,3],[31251,31259,3],[31265,31268,
3],[31275,31278,3],[31288,31297,3],[31461,31465,3],[31491,31495,3],[31917,31922,3],[31965,31985,3],[31992,32E3,3],[32001,32003,5],[32005,32031,5],[32033,32060,5],[32074,32077,5],[32081,32086,3],[32107,32130,3],[32133,32158,3],[32164,32167,5],[32180,32199,3],[32201,32260,3],[32301,32360,3],[32601,32662,3],[32664,32667,5],[32701,32761,3],[53001,53004,3],[53008,53019,3],[53021,53032,3],[53042,53046,3],[54001,54004,3],[54008,54019,3],[54021,54032,3],[54042,54046,3],[54048,54053,3],[102001,102040,3],[102042,
102063,3],[102065,102067,3],[102070,102112,3],[102114,102117,3],[102118,102121,5],[102122,102208,3],[102210,102216,3],[102221,102300,3],[102304,102377,3],[102382,102388,3],[102389,102391,5],[102401,102444,3],[102450,102452,3],[102461,102468,5],[102469,102492,3],[102500,102519,5],[102530,102549,3],[102570,102588,3],[102590,102598,3],[102601,102603,3],[102608,102628,3],[102629,102646,5],[102648,102672,5],[102675,102700,5],[102701,102703,3],[102707,102730,5],[102735,102758,5],[102767,102798,3],[102962,
102969,3],[102971,102973,3],[102975,102989,3],[102990,102992,5],[102997,103002,3],[103003,103008,5],[103009,103011,3],[103012,103014,5],[103019,103021,3],[103022,103024,5],[103029,103031,3],[103032,103034,5],[103065,103068,3],[103074,103076,3],[103077,103079,5],[103080,103082,3],[103083,103085,5],[103090,103093,3],[103097,103099,3],[103100,103102,5],[103107,103109,3],[103110,103112,5],[103113,103116,3],[103117,103120,5],[103153,103157,3],[103158,103162,5],[103163,103165,3],[103166,103171,5],[103186,
103188,3],[103189,103191,5],[103192,103195,3],[103196,103199,5],[103200,103224,3],[103225,103227,5],[103232,103237,3],[103238,103243,5],[103244,103246,3],[103247,103249,5],[103254,103256,3],[103257,103259,5],[103264,103266,3],[103267,103269,5],[103300,103375,3],[103381,103383,3],[103384,103386,5],[103387,103389,3],[103390,103392,5],[103397,103399,3],[103400,103471,5],[103476,103478,3],[103479,103481,5],[103486,103488,3],[103489,103491,5],[103492,103495,3],[103496,103499,5],[103539,103543,3],[103544,
103548,5],[103549,103551,3],[103552,103557,5],[103558,103560,3],[103571,103573,3],[103574,103576,5],[103577,103580,3],[103581,103583,5],[103600,103694,3],[103700,103793,5],[103794,103799,3]],gcsid:[4042,0,4075,0,4081,0,4168,0,4170,0,4188,0,4261,1,4262,0,4263,0,4288,0,4289,0,4305,1,4322,0,4324,0,4326,0,4466,0,4469,0,4475,0,4483,0,4490,0,4555,0,4558,0,4614,0,4619,0,4657,0,4670,0,4671,0,4674,0,4682,0,4683,0,4718,0,4720,0,4721,0,4723,0,4726,0,4737,0,4738,0,4759,0,4761,0,4807,1,4808,0,4809,0,4816,1,4817,
0,4818,0,4819,1,4820,0,4821,1,4823,0,4824,0,4901,1,4902,1,4903,0,4904,0,5228,0,5229,0,5233,0,5252,0,5264,0,5340,0,5354,0,5360,0,5371,0,5373,0,5381,0,5393,0,5464,0,5467,0,5489,0,5524,0,5527,0,5546,0,5561,0,5593,0,5681,0,5886,0,37225,1,37235,0,37257,0,37259,0,37260,0,104020,0,104139,1,104140,1,104223,0,104286,0,104287,0,104304,0,104305,0,104896,0,104900,5,104901,0,104902,0,104903,9,104904,2,104905,2,104906,59,104907,54,104908,0,104909,58,104910,31,104911,56,104912,6,104913,50,104914,41,104915,10,104916,
3,104917,30,104918,8,104919,60,104920,53,104921,44,104922,48,104923,51,104924,38,104925,0,104926,49,104927,57,104928,21,104929,23,104930,35,104931,49,104932,27,104933,17,104934,13,104935,7,104936,56,104937,40,104938,28,104939,37,104940,15,104941,55,104942,22,104943,4,104944,0,104945,20,104946,42,104947,47,104948,52,104949,43,104950,46,104951,39,104952,24,104953,16,104954,50,104955,36,104956,33,104957,46,104958,14,104959,19,104960,0,104961,34,104962,32,104963,29,104964,45,104965,26,104966,25,104967,
41,104968,11,104969,12,104970,18],gcsidc:[[4001,4016,0],[4018,4025,0],[4027,4029,0],[4031,4036,0],[4044,4047,0],[4052,4054,0],[4120,4166,0],[4172,4176,0],[4178,4185,0],[4190,4196,0],[4198,4216,0],[4218,4222,0],[4224,4232,0],[4234,4260,0],[4265,4267,0],[4269,4286,0],[4291,4303,0],[4306,4319,0],[4600,4610,0],[4621,4625,0],[4627,4633,0],[4636,4639,0],[4641,4646,0],[4659,4667,0],[4676,4680,0],[4686,4697,0],[4699,4706,0],[4740,4757,0],[4763,4765,0],[4801,4806,0],[4810,4812,1],[4813,4815,0],[37001,37008,
0],[37201,37208,0],[37211,37224,0],[37226,37233,0],[37237,37243,0],[37245,37247,0],[37249,37255,0],[104100,104138,0],[104141,104145,0],[104256,104261,0],[104700,104786,0],[104990,104992,0]]},e={c:[[2E3,2045,9001],[2056,2065,9001],[2067,2135,9001],[2137,2153,9001],[2161,2170,9001],[2172,2193,9001],[2196,2198,9001],[2200,2203,9001],[2206,2217,9001],[2222,2224,9002],[2251,2253,9002],[2280,2282,9002],[2308,2311,9001],[2315,2325,9001],[2327,2394,9001],[2400,2462,9001],[2523,2576,9001],[2578,2693,9001],
[2695,2758,9001],[2867,2869,9002],[2870,2888,9003],[2891,2895,9003],[2896,2898,9002],[2902,2908,9003],[2915,2920,9003],[2921,2923,9002],[2924,2930,9003],[2931,2941,9001],[2969,2973,9001],[2975,2982,9001],[2984,2988,9001],[2995,3002,9001],[3006,3051,9001],[3054,3059,9001],[3061,3066,9001],[3068,3071,9001],[3084,3087,9001],[3112,3118,9001],[3120,3138,9001],[3146,3151,9001],[3153,3157,9001],[3161,3166,9001],[3168,3172,9001],[3174,3203,9001],[3294,3313,9001],[3315,3335,9001],[3339,3345,9001],[3350,3358,
9001],[3367,3369,9001],[3374,3399,9001],[3408,3416,9001],[3425,3432,9003],[3441,3446,9003],[3456,3459,9003],[3465,3478,9001],[3554,3559,9001],[3561,3565,9003],[3568,3570,9003],[3571,3581,9001],[3594,3597,9001],[3601,3604,9001],[3637,3639,9001],[3665,3667,9001],[3693,3695,9001],[3701,3727,9001],[3728,3733,9003],[3744,3747,9001],[3753,3758,9003],[3761,3763,9001],[3765,3769,9001],[3779,3781,9001],[3788,3791,9001],[3797,3799,9001],[3832,3841,9001],[3844,3852,9001],[3873,3885,9001],[3890,3893,9001],[3907,
3912,9001],[3942,3950,9001],[3968,3970,9001],[3973,3976,9001],[3986,3989,9001],[3994,3997,9001],[4001,4016,9102],[4018,4025,9102],[4027,4029,9102],[4031,4036,9102],[4044,4047,9102],[4052,4054,9102],[4120,4166,9102],[4172,4176,9102],[4178,4185,9102],[4190,4196,9102],[4198,4216,9102],[4218,4222,9102],[4224,4232,9102],[4234,4260,9102],[4265,4267,9102],[4269,4286,9102],[4291,4303,9102],[4306,4319,9102],[4399,4413,9003],[4418,4433,9003],[4491,4554,9001],[4600,4610,9102],[4621,4625,9102],[4627,4633,9102],
[4636,4639,9102],[4641,4646,9102],[4659,4667,9102],[4676,4680,9102],[4686,4697,9102],[4699,4706,9102],[4740,4757,9102],[4763,4765,9102],[4801,4806,9102],[4810,4812,9105],[4813,4815,9102],[5069,5072,9001],[5105,5130,9001],[5180,5184,9001],[5253,5259,9001],[5269,5275,9001],[5292,5311,9001],[5343,5349,9001],[5355,5357,9001],[5387,5389,9001],[5459,5463,9001],[5479,5482,9001],[5530,5539,9001],[5550,5552,9001],[5562,5583,9001],[5623,5625,9003],[5631,5639,9001],[5649,5653,9001],[5663,5680,9001],[5682,5685,
9001],[5875,5877,9001],[20002,20032,9001],[20062,20092,9001],[20135,20138,9001],[20248,20258,9001],[20348,20358,9001],[20436,20440,9001],[20822,20824,9001],[20934,20936,9001],[21035,21037,9001],[21095,21097,9001],[21148,21150,9001],[21413,21423,9001],[21473,21483,9001],[21780,21782,9001],[21891,21894,9001],[22171,22177,9001],[22181,22187,9001],[22191,22197,9001],[22234,22236,9001],[22521,22525,9001],[22991,22994,9001],[23028,23038,9001],[23830,23853,9001],[23866,23872,9001],[23877,23884,9001],[23886,
23894,9001],[23946,23948,9001],[24311,24313,9001],[24342,24347,9001],[24370,24374,9084],[24375,24381,9001],[24718,24721,9001],[24817,24821,9001],[24877,24882,9001],[24891,24893,9001],[25391,25395,9001],[25828,25838,9001],[26191,26195,9001],[26391,26393,9001],[26703,26722,9001],[26729,26760,9003],[26766,26798,9003],[26860,26870,9003],[26891,26899,9001],[26903,26923,9001],[26929,26946,9001],[26948,26998,9001],[27037,27040,9001],[27205,27232,9001],[27258,27260,9001],[27391,27398,9001],[27561,27564,9001],
[27571,27574,9001],[27581,27584,9001],[27591,27594,9001],[28191,28193,9001],[28348,28358,9001],[28402,28432,9001],[28462,28492,9001],[29118,29122,9001],[29177,29185,9001],[30161,30179,9001],[30491,30494,9001],[30729,30732,9001],[31251,31259,9001],[31265,31268,9001],[31275,31278,9001],[31288,31297,9001],[31461,31465,9001],[31491,31495,9001],[31917,31922,9001],[31965,31985,9001],[31992,32E3,9001],[32001,32003,9003],[32005,32031,9003],[32033,32060,9003],[32074,32077,9003],[32081,32086,9001],[32107,32130,
9001],[32133,32158,9001],[32164,32167,9003],[32180,32199,9001],[32201,32260,9001],[32301,32360,9001],[32601,32662,9001],[32664,32667,9003],[32701,32761,9001],[37001,37008,9102],[37201,37208,9102],[37211,37224,9102],[37226,37233,9102],[37237,37243,9102],[37245,37247,9102],[37249,37255,9102],[53001,53004,9001],[53008,53019,9001],[53021,53032,9001],[53042,53046,9001],[54001,54004,9001],[54008,54019,9001],[54021,54032,9001],[54042,54046,9001],[54048,54053,9001],[102001,102040,9001],[102042,102063,9001],
[102065,102067,9001],[102070,102112,9001],[102114,102117,9001],[102122,102208,9001],[102210,102216,9001],[102221,102300,9001],[102304,102377,9001],[102382,102388,9001],[102389,102391,9003],[102401,102444,9001],[102450,102452,9001],[102461,102468,9003],[102469,102492,9001],[102500,102519,9002],[102530,102549,9001],[102570,102588,9001],[102590,102598,9001],[102601,102603,9001],[102608,102628,9001],[102629,102646,9003],[102648,102672,9003],[102675,102700,9003],[102701,102703,9001],[102707,102730,9003],
[102735,102758,9003],[102767,102798,9001],[102962,102969,9001],[102971,102973,9001],[102975,102989,9001],[102990,102992,9002],[102997,103002,9001],[103003,103008,9003],[103009,103011,9001],[103012,103014,9003],[103019,103021,9001],[103022,103024,9003],[103029,103031,9001],[103032,103034,9003],[103065,103068,9001],[103074,103076,9001],[103077,103079,9002],[103080,103082,9001],[103083,103085,9003],[103090,103093,9001],[103097,103099,9001],[103100,103102,9003],[103107,103109,9001],[103110,103112,9003],
[103113,103116,9001],[103117,103120,9003],[103153,103157,9001],[103158,103162,9003],[103163,103165,9001],[103166,103168,9002],[103169,103171,9003],[103186,103188,9001],[103189,103191,9003],[103192,103195,9001],[103196,103199,9003],[103200,103224,9001],[103225,103227,9002],[103232,103237,9001],[103238,103243,9003],[103244,103246,9001],[103247,103249,9003],[103254,103256,9001],[103257,103259,9003],[103264,103266,9001],[103267,103269,9003],[103300,103375,9001],[103381,103383,9001],[103384,103386,9002],
[103387,103389,9001],[103390,103392,9003],[103397,103399,9001],[103400,103471,9003],[103476,103478,9001],[103479,103481,9003],[103486,103488,9001],[103489,103491,9003],[103492,103495,9001],[103496,103499,9003],[103539,103543,9001],[103544,103548,9003],[103549,103551,9001],[103552,103554,9002],[103555,103557,9003],[103558,103560,9001],[103571,103573,9001],[103574,103576,9003],[103577,103580,9001],[103581,103583,9003],[103600,103694,9001],[103700,103793,9003],[103794,103799,9001],[104100,104138,9102],
[104141,104145,9102],[104256,104261,9102],[104700,104786,9102],[104900,104970,9102],[104990,104992,9102]],nc:[2066,9039,2136,9094,2155,9003,2157,9001,2158,9001,2159,9094,2160,9094,2219,9001,2220,9001,2244,9003,2245,9003,2256,9002,2265,9002,2266,9002,2269,9002,2270,9002,2273,9002,2290,9001,2291,9001,2294,9001,2295,9001,2313,9001,2314,9005,2899,9003,2900,9003,2901,9002,2909,9002,2910,9002,2911,9003,2912,9003,2913,9002,2914,9002,2964,9003,2967,9003,2968,9003,2991,9001,2992,9002,2993,9001,2994,9002,3073,
9001,3076,9001,3079,9001,3091,9003,3106,9001,3108,9001,3109,9001,3141,9001,3142,9001,3167,9301,3337,9001,3347,9001,3348,9001,3359,9003,3360,9001,3361,9002,3362,9001,3363,9003,3364,9001,3365,9003,3366,9005,3402,9001,3403,9001,3405,9001,3406,9001,3439,9001,3440,9001,3447,9001,3449,9001,3450,9001,3453,9003,3454,9003,3460,9001,3479,9002,3480,9001,3481,9002,3482,9001,3483,9002,3484,9001,3485,9003,3486,9001,3487,9003,3488,9001,3489,9001,3490,9003,3491,9001,3492,9003,3493,9001,3494,9003,3495,9001,3496,9003,
3497,9001,3498,9003,3499,9001,3500,9003,3501,9001,3502,9003,3503,9001,3504,9003,3505,9001,3506,9003,3507,9001,3508,9003,3509,9001,3510,9003,3511,9001,3512,9003,3513,9001,3514,9001,3515,9003,3516,9001,3517,9003,3518,9001,3519,9003,3520,9001,3521,9003,3522,9001,3523,9003,3524,9001,3525,9003,3526,9001,3527,9003,3528,9001,3529,9003,3530,9001,3531,9003,3532,9001,3533,9003,3534,9001,3535,9003,3536,9001,3537,9003,3538,9001,3539,9003,3540,9001,3541,9003,3542,9001,3543,9003,3544,9001,3545,9003,3546,9001,3547,
9003,3548,9001,3549,9003,3550,9001,3551,9003,3552,9001,3553,9003,3582,9003,3583,9001,3584,9003,3585,9001,3586,9003,3587,9001,3588,9002,3589,9001,3590,9002,3591,9001,3592,9001,3593,9002,3598,9003,3599,9001,3600,9003,3605,9002,3606,9001,3607,9001,3608,9003,3609,9001,3610,9003,3611,9001,3612,9003,3613,9001,3614,9003,3615,9001,3616,9003,3617,9001,3618,9003,3619,9001,3620,9003,3621,9001,3622,9003,3623,9001,3624,9003,3625,9001,3626,9003,3627,9001,3628,9003,3629,9001,3630,9003,3631,9001,3632,9003,3633,9001,
3634,9002,3635,9001,3636,9002,3640,9003,3641,9001,3642,9003,3643,9001,3644,9002,3645,9001,3646,9002,3647,9001,3648,9002,3649,9001,3650,9003,3651,9001,3652,9003,3653,9001,3654,9003,3655,9001,3656,9002,3657,9001,3658,9003,3659,9001,3660,9003,3661,9001,3662,9003,3663,9001,3664,9003,3668,9003,3669,9001,3670,9003,3671,9001,3672,9003,3673,9001,3674,9003,3675,9001,3676,9002,3677,9003,3678,9001,3679,9002,3680,9003,3681,9001,3682,9002,3683,9003,3684,9001,3685,9001,3686,9003,3687,9001,3688,9003,3689,9001,3690,
9003,3691,9001,3692,9003,3696,9003,3697,9001,3698,9003,3699,9001,3700,9003,3740,9001,3749,9001,3783,9001,3784,9001,3793,9001,3794,9001,3802,9001,3816,9001,3829,9001,3854,9001,3920,9001,3978,9001,3979,9001,3991,9003,3992,9003,4026,9001,4037,9001,4038,9001,4042,9102,4075,9102,4081,9102,4168,9102,4170,9102,4188,9102,4217,9003,4261,9105,4262,9102,4263,9102,4288,9102,4289,9102,4305,9105,4322,9102,4324,9102,4326,9102,4438,9003,4439,9003,4466,9102,4467,9001,4469,9102,4471,9001,4474,9001,4475,9102,4483,9102,
4490,9102,4555,9102,4558,9102,4559,9001,4614,9102,4619,9102,4657,9102,4670,9102,4671,9102,4674,9102,4682,9102,4683,9102,4718,9102,4720,9102,4721,9102,4723,9102,4726,9102,4737,9102,4738,9102,4759,9102,4761,9102,4807,9105,4808,9102,4809,9102,4816,9105,4817,9102,4818,9102,4819,9105,4820,9102,4821,9105,4823,9102,4824,9102,4839,9001,4901,9105,4902,9105,4903,9102,4904,9102,5018,9001,5048,9001,5167,9001,5168,9001,5223,9001,5228,9102,5229,9102,5233,9102,5234,9001,5235,9001,5243,9001,5252,9102,5264,9102,5266,
9001,5316,9001,5320,9001,5321,9001,5330,9001,5331,9001,5337,9001,5340,9102,5354,9102,5360,9102,5361,9001,5362,9001,5371,9102,5373,9102,5381,9102,5382,9001,5383,9001,5393,9102,5396,9001,5456,9001,5457,9001,5464,9102,5467,9102,5469,9001,5472,9037,5489,9102,5490,9001,5518,9001,5523,9001,5524,9102,5527,9102,5546,9102,5559,9001,5561,9102,5588,9002,5589,9005,5593,9102,5596,9001,5627,9001,5629,9001,5641,9001,5643,9001,5644,9001,5654,9003,5655,9003,5659,9001,5681,9102,5700,9001,5825,9001,5836,9001,5837,9001,
5842,9001,5844,9001,5880,9001,5886,9102,5887,9001,5890,9001,20499,9001,20538,9001,20539,9001,20790,9001,20791,9001,21291,9001,21292,9001,21500,9001,21817,9001,21818,9001,22032,9001,22033,9001,22091,9001,22092,9001,22332,9001,22391,9001,22392,9001,22700,9001,22770,9001,22780,9001,22832,9001,23090,9001,23095,9001,23239,9001,23240,9001,23433,9001,23700,9001,24047,9001,24048,9001,24100,9005,24200,9001,24305,9001,24306,9001,24382,9084,24383,9001,24500,9001,24547,9001,24548,9001,24571,9062,24600,9001,25E3,
9001,25231,9001,25884,9001,25932,9001,26237,9001,26331,9001,26332,9001,26591,9001,26592,9001,26632,9001,26692,9001,26855,9003,26856,9003,27120,9001,27200,9001,27291,9040,27292,9040,27429,9001,27492,9001,27500,9001,27700,9001,28232,9001,28600,9001,28991,9001,28992,9001,29100,9001,29220,9001,29221,9001,29333,9001,29635,9001,29636,9001,29701,9001,29738,9001,29739,9001,29849,9001,29850,9001,29871,9042,29872,9041,29873,9001,29900,9001,29901,9001,29903,9001,30200,9039,30339,9001,30340,9001,30591,9001,30592,
9001,30791,9001,30792,9001,31028,9001,31121,9001,31154,9001,31170,9001,31171,9001,31370,9001,31528,9001,31529,9001,31600,9001,31700,9001,31838,9001,31839,9001,31901,9001,32061,9001,32062,9001,32098,9001,32099,9003,32100,9001,32104,9001,32161,9001,32766,9001,37225,9105,37235,9102,37257,9102,37259,9102,37260,9102,53034,9001,53048,9001,53049,9001,54034,9001,65061,9003,65062,9003,65161,9001,65163,9001,102041,9003,102064,9085,102068,109030,102069,109031,102118,9003,102119,9002,102120,9003,102121,9003,
102217,9003,102218,9001,102219,9003,102220,9003,102378,9002,102379,9002,102380,9001,102381,9002,102589,9003,102599,9003,102600,9003,102604,9003,102605,9001,102606,9001,102647,9001,102704,9003,102705,9003,102733,9003,102761,9003,102762,9001,102763,9003,102764,9001,102765,9001,102766,9003,102970,9002,102974,9003,102993,9001,102994,9001,102995,9003,102996,9003,103015,9001,103016,9003,103017,9001,103018,9003,103025,9001,103026,9001,103027,9003,103028,9003,103035,9001,103036,9001,103037,9003,103038,9003,
103039,9001,103040,9001,103041,9003,103042,9003,103043,9001,103044,9001,103045,9003,103046,9003,103047,9001,103048,9001,103049,9003,103050,9003,103051,9001,103052,9003,103053,9001,103054,9003,103055,9001,103056,9003,103057,9001,103058,9001,103059,9003,103060,9003,103061,9001,103062,9001,103063,9003,103064,9003,103069,9003,103070,9001,103071,9001,103072,9003,103073,9003,103086,9001,103087,9001,103088,9003,103089,9003,103094,9002,103095,9001,103096,9003,103103,9001,103104,9003,103105,9001,103106,9003,
103121,9001,103122,9003,103123,9001,103124,9001,103125,9002,103126,9002,103127,9001,103128,9001,103129,9003,103130,9003,103131,9001,103132,9001,103133,9003,103134,9003,103135,9001,103136,9001,103137,9002,103138,9002,103139,9001,103140,9003,103141,9001,103142,9003,103143,9001,103144,9003,103145,9001,103146,9002,103147,9001,103148,9001,103149,9003,103150,9003,103151,9001,103152,9003,103172,9001,103173,9003,103174,9001,103175,9001,103176,9003,103177,9003,103178,9001,103179,9001,103180,9003,103181,9003,
103182,9001,103183,9001,103184,9003,103185,9003,103228,9001,103229,9001,103230,9003,103231,9003,103250,9001,103251,9003,103252,9001,103253,9003,103260,9001,103261,9001,103262,9003,103263,9003,103270,9001,103271,9001,103272,9003,103273,9003,103274,9001,103275,9001,103276,9003,103277,9003,103278,9001,103279,9001,103280,9003,103281,9003,103282,9001,103283,9001,103284,9003,103285,9003,103286,9001,103287,9003,103288,9001,103289,9003,103290,9001,103291,9003,103292,9001,103293,9001,103294,9003,103295,9003,
103296,9001,103297,9001,103298,9003,103299,9003,103376,9003,103377,9001,103378,9001,103379,9003,103380,9003,103393,9001,103394,9001,103395,9003,103396,9003,103472,9001,103473,9002,103474,9001,103475,9003,103482,9001,103483,9003,103484,9001,103485,9003,103500,9001,103501,9003,103502,9001,103503,9001,103504,9002,103505,9002,103506,9001,103507,9001,103508,9003,103509,9003,103510,9001,103511,9001,103512,9003,103513,9003,103514,9001,103515,9003,103516,9001,103517,9003,103518,9001,103519,9003,103520,9001,
103521,9002,103522,9001,103523,9001,103524,9003,103525,9003,103526,9001,103527,9003,103561,9003,103562,9003,103563,9001,103564,9001,103565,9003,103566,9003,103567,9001,103568,9001,103569,9003,103570,9003,103585,9003,103695,9003,104020,9102,104139,9105,104140,9105,104223,9102,104286,9102,104287,9102,104304,9102,104305,9102,104896,9102]},c=function(){function b(){}b.wG=function(d){!1===b.ul&&b.hq();var c=b.dU(d);if(-1==c){var l=b.Pv(d);l!=d&&(c=b.wG(l))}return c};b.dU=function(d){return void 0!==b.gv[d]?
b.gv[d]:-1};b.tS=function(d){!1===b.ul&&b.hq();var c=b.JF(d);if(1E38==c){var l=b.Pv(d);l!=d&&(c=b.JF(l));if(1E38==c)return 1E-10}return c};b.RU=function(d){if(void 0!==b.$p[d])return!0;var c=b.Pv(d);return c!=d&&void 0!==b.$p[c]?!0:!1};b.TU=function(d){if(void 0!==b.Dj[d])return!0;var c=b.Pv(d);return c!=d&&void 0!==b.Dj[c]?!0:!1};b.JF=function(d){!1===b.ul&&b.hq();return void 0!==b.$p[d]?b.$p[d]:void 0!==b.Dj[d]?b.Dj[d]:1E38};b.rZ=function(d){!1===b.ul&&b.hq();return void 0!==b.GC[d]?b.GC[d]:d};
b.Pv=function(d){!1===b.ul&&b.hq();return void 0!==b.OC[d]?b.OC[d]:d};b.hq=function(){for(var d=a,c,l=0;l<d.pcsid.length;l+=2)b.Dj[d.pcsid[l]]=d.pcstol[2*d.pcsid[l+1]+1];for(l=0;l<d.pcsidc.length;l+=1){c=d.pcsidc[l];for(var f=c[0];f<=c[1];f++)b.Dj[f]=d.pcstol[2*c[2]+1]}for(l=0;l<d.gcsid.length;l+=2)b.$p[d.gcsid[l]]=d.gcstol[2*d.gcsid[l+1]+1];for(l=0;l<d.gcsidc.length;l+=1)for(c=d.gcsidc[l],f=c[0];f<=c[1];f++)b.Dj[f]=d.gcstol[2*c[2]+1];for(l=0;l<e.c.length;l+=1)for(c=e.c[l],f=c[0];f<=c[1];f++)b.gv[f]=
c[2];for(l=0;l<e.nc.length;l+=2)b.gv[e.nc[l]]=e.nc[l+1];e=null;for(l=0;l<d.newtoold.length;l+=2)b.GC[d.newtoold[l+1]]=d.newtoold[l],b.OC[d.newtoold[l]]=d.newtoold[l+1];a=null;b.ul=!0};b.ul=!1;b.$p=[];b.Dj=[];b.GC=[];b.OC=[];b.gv=[];return b}();f.ts=c})(C||(C={}));(function(f){function a(b){return 0===b.length?'""':'"'==b[0]||"."==b[0]||"0"<=b[0]&&"9">=b[0]?b:'"'+b.trim()+'"'}var e=[],c=function(){function b(){}b.vS=function(d){try{for(var c=0;c<e.length;c++)if(e[c].wkttext===d)return e[c].unit;for(var l,
q=c="",v=!1,D=0;D<d.length;D++){var H=d[D];!0===v?'"'==H?'"'==d[D+1]?c+=H:v=!1:c+=H:/[\s]/.test(H)||(","==H?(q=""!==c?q+(a(c)+","):q+",",c=""):")"==H||"]"==H?(q=""!==c?q+(a(c)+"]}"):q+"]}",c=""):"("==H||"["==H?(q+='{ "entity": "'+c.toUpperCase().trim()+'", "values":[',c=""):'"'==H?(v=!0,c=""):c+=H)}l=JSON.parse(q);var F=b.oF(l);if(null===F)return null;l=null;for(H=0;H<F.values.length;H++)if("object"===typeof F.values[H]&&"UNIT"===F.values[H].entity){l=F.values[H];break}if(null===l)return null;var G=
f.oc.aR("GEOGCS"===F.entity?1:0,l.values[1],l.values[2]);e.push({wkttext:d,unit:G});10<e.length&&e.shift();return G}catch(ba){return null}};b.oF=function(d){if(null===d)return null;if("GEOGCS"===d.entity||"PROJCS"===d.entity)return d;for(var c=[],l=0;l<d.values.length;l++)if("object"===typeof d.values[l]&&void 0!==d.values[l].entity){if("GEOGCS"===d.values[l].entity||"PROJCS"==d.values[l].entity)return d.values[l];c.push(d.values[l])}for(d=0;d<c.length;d++)if(l=b.oF(c[d]),null!==l)return l;return null};
b.uS=function(b){var d=-1;if(null!=b&&0<b.length){var c,f;c=b.indexOf("PROJCS");if(0<=c){var v=0;c=b.lastIndexOf("UNIT");if(0<=c&&(c=b.indexOf(",",c+4),0<c&&(c++,f=b.indexOf("]",c+1),0<f)))try{v=parseFloat(b.substring(c,f))}catch(H){v=0}0<v&&(d=.001/v)}else if(c=b.indexOf("GEOGCS"),0<=c){var D=0,v=0;c=b.indexOf("SPHEROID",c+6);if(0<c&&(c=b.indexOf(",",c+8),0<c)){c++;f=b.indexOf(",",c+1);if(0<f)try{D=parseFloat(b.substring(c,f))}catch(H){D=0}if(0<D&&(c=b.indexOf("UNIT",f+1),0<=c&&(c=b.indexOf(",",
c+4),0<c&&(c++,f=b.indexOf("]",c+1),0<f))))try{v=parseFloat(b.substring(c,f))}catch(H){v=0}}0<D&&0<v&&(d=.001/(D*v))}}return d};return b}();f.nE=c})(C||(C={}));(function(f){(function(f){f[f.NONE=0]="NONE";f[f.LINEAR=1]="LINEAR";f[f.ANGULAR=2]="ANGULAR"})(f.EM||(f.EM={}));(function(f){f[f.enumFloat=0]="enumFloat";f[f.enumDouble=1]="enumDouble";f[f.enumInt32=2]="enumInt32";f[f.enumInt64=3]="enumInt64";f[f.enumInt8=4]="enumInt8";f[f.enumInt16=5]="enumInt16"})(f.FN||(f.FN={}));(function(f){f[f.POSITION=
0]="POSITION";f[f.Z=1]="Z";f[f.M=2]="M";f[f.ID=3]="ID";f[f.NORMAL=4]="NORMAL";f[f.TEXTURE1D=5]="TEXTURE1D";f[f.TEXTURE2D=6]="TEXTURE2D";f[f.TEXTURE3D=7]="TEXTURE3D";f[f.ID2=8]="ID2";f[f.MAXSEMANTICS=10]="MAXSEMANTICS"})(f.Wc||(f.Wc={}));var a=function(){function a(c,b){this.Pt=this.af=null;this.Dr=this.Ea=0;this.Sh=this.wg=null;this.bm=0;if(void 0!==b){this.Ea=b.Ea;this.Dr=b.Dr;this.wg=b.wg.slice(0);this.Sh=b.Sh.slice(0);this.bm=b.bm;this.Pt=[];for(b=c=0;b<this.Ea;b++)this.Pt[b]=c,c+=a.Xa(this.wg[b]);
this.Dr=c;this.af=[];for(b=0;b<this.Ea;b++){c=a.Xa(this.zd(b));for(var d=a.pe(this.zd(b)),h=0;h<c;h++)this.af[this.Pt[b]+h]=d}}else this.Dr=this.Ea=0}a.prototype.zd=function(c){if(0>c||c>this.Ea)throw f.f.F();return this.wg[c]};a.prototype.mg=function(c){return this.Sh[c]};a.Vz=function(c){return a.uc[c]};a.si=function(c){return a.bd[c]};a.Mg=function(c){return a.ee[c]};a.Cj=function(c){return a.Mg(a.si(c))*a.Xa(c)};a.Xa=function(c){return a.Bb[c]};a.Wg=function(c){return 2>c};a.qk=function(c){return a.Wg(a.si(c))};
a.prototype.hasAttribute=function(c){return 0<=this.Sh[c]};a.prototype.tH=function(){return this.hasAttribute(1)};a.pe=function(c){return a.$[c]};a.prototype.DT=function(c){return this.Pt[c]};a.OH=function(c,b){return a.$[c]===b};a.Oi=function(c){if(4==c)return 2;if(8==c)return 3;throw f.f.F();};a.prototype.Eb=function(c){return this===c};a.prototype.zk=function(){for(var c=f.J.dh(this.wg[0]),b=1;b<this.Ea;b++)c=f.J.dh(this.wg[b],c);return c};a.prototype.wk=function(c){return this.Pt[c]};a.prototype.jc=
function(){return this.bm};a.prototype.Id=function(c){return this.wg[c]};a.$=[0,0,NaN,0,0,0,0,0,0];a.uc=[1,1,1,0,2,1,1,1,0];a.bd=[1,1,1,2,0,0,0,0,2];a.ee=[4,8,4,8,1,2];a.Bb=[2,1,1,1,3,1,2,3,2];return a}();f.na=a})(C||(C={}));(function(f){function a(b,c,l,f){var d=b.Kd,h=b.e+c+1;1===l?f=5<=d[h]:2===l?f=5<d[h]||5==d[h]&&(f||0>h||void 0!==d[h+1]||d[h-1]&1):3===l?f=f||void 0!==d[h]||0>h:(f=!1,0!==l&&e("!Big.RM!"));if(1>h||!d[0])f?(b.e=-c,b.Kd=[1]):b.Kd=[b.e=0];else{d.length=h--;if(f)for(;9<++d[h];)d[h]=
0,h--||(++b.e,d.unshift(1));for(h=d.length;!d[--h];d.pop());}}function e(b){b=Error(b);b.name="BigError";throw b;}var c=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,b=function(){function b(d){if(d instanceof b)this.le=d.le,this.e=d.e,this.Kd=d.Kd.slice();else{var h,f,v;0===d&&0>1/d?d="-0":c.test(d+="")||e(NaN);this.le="-"==d.charAt(0)?(d=d.slice(1),-1):1;-1<(h=d.indexOf("."))&&(d=d.replace(".",""));0<(f=d.search(/e/i))?(0>h&&(h=f),h+=+d.slice(f+1),d=d.substring(0,f)):0>h&&(h=d.length);for(f=0;"0"==d.charAt(f);f++);
if(f==(v=d.length))this.Kd=[this.e=0];else{for(;"0"==d.charAt(--v););this.e=h-f-1;this.Kd=[];for(h=0;f<=v;this.Kd[h++]=+d.charAt(f++));}}}b.prototype.abs=function(){var d=new b(this);d.le=1;return d};b.prototype.QF=function(){var d=0,c=this.Kd,f=(d=new b(d)).Kd,v=this.le,D=d.le,a=this.e,F=d.e;if(!c[0]||!f[0])return c[0]?v:f[0]?-D:0;if(v!=D)return v;d=0>v;if(a!=F)return a>(F^d)?1:-1;v=-1;for(D=(a=c.length)<(F=f.length)?a:F;++v<D;)if(c[v]!=f[v])return c[v]>(f[v]^d)?1:-1;return a==F?0:a>(F^d)?1:-1};
b.prototype.Xm=function(d){var c=this.Kd,h=(d=new b(d)).Kd,f=this.le==d.le?1:-1,D=b.bd;(D!==~~D||0>D||1E6<D)&&e("!Big.DP!");if(!c[0]||!h[0])return c[0]==h[0]&&e(NaN),h[0]||e(f/0),new b(0*f);var H,F,G,k,E=h.slice(),p=H=h.length,n=c.length,g=c.slice(0,H),u=g.length,z=d,t=z.Kd=[],r=0,A=D+(z.e=this.e-d.e)+1;z.le=f;f=0>A?0:A;for(E.unshift(0);u++<H;g.push(0));do{for(F=0;10>F;F++){if(H!=(u=g.length))G=H>u?1:-1;else for(k=-1,G=0;++k<H;)if(h[k]!=g[k]){G=h[k]>g[k]?1:-1;break}if(0>G){for(d=u==H?h:E;u;){if(g[--u]<
d[u]){for(k=u;k&&!g[--k];g[k]=9);--g[k];g[u]+=10}g[u]-=d[u]}for(;!g[0];g.shift());}else break}t[r++]=G?F:++F;g[0]&&G?g[u]=c[p]||0:g=[c[p]]}while((p++<n||void 0!==g[0])&&f--);t[0]||1==r||(t.shift(),z.e--);r>A&&a(z,D,b.Mg,void 0!==g[0]);return z};b.prototype.ZT=function(){return 0<this.QF()};b.prototype.nV=function(){return 0>this.QF()};b.prototype.Yt=function(d){var c,h,f=this.le,D=(d=new b(d)).le;if(f!=D)return d.le=-D,this.DJ(d);var a=this.Kd.slice();h=this.e;var F=d.Kd,G=d.e;if(!a[0]||!F[0])return F[0]?
(d.le=-D,d):new b(a[0]?this:0);if(f=h-G){(c=0>f)?(f=-f,h=a):(G=h,h=F);h.reverse();for(D=f;D--;h.push(0));h.reverse()}else for(h=((c=a.length<F.length)?a:F).length,f=D=0;D<h;D++)if(a[D]!=F[D]){c=a[D]<F[D];break}c&&(h=a,a=F,F=h,d.le=-d.le);if(0<(D=(h=F.length)-(c=a.length)))for(;D--;a[c++]=0);for(D=c;h>f;){if(a[--h]<F[h]){for(c=h;c&&!a[--c];a[c]=9);--a[c];a[h]+=10}a[h]-=F[h]}for(;0==a[--D];a.pop());for(;0==a[0];)a.shift(),--G;a[0]||(d.le=1,a=[G=0]);d.Kd=a;d.e=G;return d};b.prototype.DJ=function(d){var c,
h=this.le;c=(d=new b(d)).le;if(h!=c)return d.le=-c,this.Yt(d);c=this.e;var f=this.Kd,D=d.e,a=d.Kd;if(!f[0]||!a[0])return a[0]?d:new b(f[0]?this:0*h);f=f.slice();if(h=c-D){0<h?(D=c,c=a):(h=-h,c=f);for(c.reverse();h--;c.push(0));c.reverse()}0>f.length-a.length&&(c=a,a=f,f=c);h=a.length;for(c=0;h;)c=(f[--h]=f[h]+a[h]+c)/10|0,f[h]%=10;c&&(f.unshift(c),++D);for(h=f.length;0==f[--h];f.pop());d.Kd=f;d.e=D;return d};b.prototype.pow=function(d){var c=this,h=new b(1),f=h,D=0>d;(d!==~~d||-1E6>d||1E6<d)&&e("!pow!");
for(d=D?-d:d;;){d&1&&(f=f.cs(c));d>>=1;if(!d)break;c=c.cs(c)}return D?h.Xm(f):f};b.prototype.round=function(d,c){var h=this;null==d?d=0:(d!==~~d||0>d||1E6<d)&&e("!round!");a(h=new b(h),d,null==c?b.Mg:c);return h};b.prototype.sqrt=function(){var d,c,f;c=this.Kd;d=this.le;f=this.e;var v=new b("0.5");if(!c[0])return new b(this);0>d&&e(NaN);d=Math.sqrt(this.toString());0==d||d==1/0?(d=c.join(""),d.length+f&1||(d+="0"),c=new b(Math.sqrt(d).toString()),c.e=((f+1)/2|0)-(0>f||f&1)):c=new b(d.toString());
d=c.e+(b.bd+=4);do f=c,c=v.cs(f.DJ(this.Xm(f)));while(f.Kd.slice(0,d).join("")!==c.Kd.slice(0,d).join(""));a(c,b.bd-=4,b.Mg);return c};b.prototype.cs=function(d){var c,h=this.Kd,f=(d=new b(d)).Kd,D=h.length,a=f.length,F=this.e,G=d.e;d.le=this.le==d.le?1:-1;if(!h[0]||!f[0])return new b(0*d.le);d.e=F+G;D<a&&(c=h,h=f,f=c,G=D,D=a,a=G);for(c=Array(G=D+a);G--;c[G]=0);for(F=a;F--;){a=0;for(G=D+F;G>F;)a=c[G]+f[F]*h[G-F-1]+a,c[G--]=a%10,a=a/10|0;c[G]=(c[G]+a)%10}a&&++d.e;c[0]||c.shift();for(F=c.length;!c[--F];c.pop());
d.Kd=c;return d};b.prototype.toString=function(){var b=this.e,d=this.Kd.join(""),c=d.length;if(-7>=b||21<=b)d=d.charAt(0)+(1<c?"."+d.slice(1):"")+(0>b?"e":"e+")+b;else if(0>b){for(;++b;d="0"+d);d="0."+d}else if(0<b)if(++b>c)for(b-=c;b--;d+="0");else b<c&&(d=d.slice(0,b)+"."+d.slice(b));else 1<c&&(d=d.charAt(0)+"."+d.slice(1));return 0>this.le&&this.Kd[0]?"-"+d:d};b.bd=20;b.Mg=1;return b}();f.Tp=b})(C||(C={}));(function(f){var a=function(){function c(b){this.Nf=b}c.prototype.gs=function(b,d,c){var h=
new f.b,q=new f.b,v=this.Nf;c.Gd(b,d,function(b,d){v.fc(2*b,h);v.fc(2*d,q);return h.compare(q)})};c.prototype.Qq=function(b){return this.Nf.read(2*b+1)};return c}(),e=function(){function c(){}c.Rq=function(b){if(b.u())return!1;var d=b.G();return 1736==d?0==b.hf()?!1:!0:1607==d?(d=[!1],c.lE(b,!0,d),d[0]):197==d||f.T.Oc(d)&&!b.NH()?!0:!1};c.Sm=function(b){var d=b.G();if(1736==d)return d=new f.Ua(b.description),b.u()||b.wE(d),d;if(1607==d)return c.lE(b,!1,null);if(197==d)return d=new f.Ua(b.description),
b.u()||d.jd(b,!1),d;if(f.T.Oc(d)){d=new f.Ed(b.description);if(!b.u()&&!b.NH()){var h=new f.Wa;b.Dp(h);d.add(h);b.Bp(h);d.add(h)}return d}if(f.T.Jo(d))return null;throw f.f.F();};c.lE=function(b,d,c){null!=c&&(c[0]=!1);var h=null;d||(h=new f.Ed(b.description));if(!b.u()){var q=new f.ia(0);q.yb(2*b.aa());for(var v=0,D=b.aa();v<D;v++)if(0<b.Ka(v)&&!b.Eo(v)){var H=b.wa(v);q.add(H);H=b.Gc(v)-1;q.add(H)}if(0<q.size){D=new f.Gu;v=b.Pa(0);D.sort(q,0,q.size,new a(v));D=new f.b;v.fc(2*q.get(0),D);for(var H=
0,F=1,G=new f.Wa,e=new f.b,k=1,E=q.size;k<E;k++)if(v.fc(2*q.get(k),e),e.ub(D))q.get(H)>q.get(k)?(q.set(H,2147483647),H=k):q.set(k,2147483647),F++;else{if(0==(F&1))q.set(H,2147483647);else if(d)return null!=c&&(c[0]=!0),null;D.L(e);H=k;F=1}if(0==(F&1))q.set(H,2147483647);else if(d)return null!=c&&(c[0]=!0),null;if(!d)for(q.Gd(0,q.size,function(b,d){return b-d}),k=0,E=q.size;k<E&&2147483647!=q.get(k);k++)b.Ae(q.get(k),G),h.add(G)}}return d?null:h};return c}();f.Pi=e})(C||(C={}));(function(f){var a=
function(){function a(){this.ag=new f.ia(0);this.tt=new f.ia(0);this.TI=1;this.zt=NaN}a.prototype.sort=function(c,b,d,h){if(32>d-b)h.gs(b,d,c);else{var l=!0;try{for(var f=Infinity,v=-Infinity,D=b;D<d;D++){var a=h.Qq(c.get(D));a<f&&(f=a);a>v&&(v=a)}if(this.reset(d-b,f,v,d-b)){for(D=b;D<d;D++){var F=c.get(D),a=h.Qq(F),G=this.KG(a);this.ag.set(G,this.ag.get(G)+1);this.tt.write(D-b,F)}var e=this.ag.get(0);this.ag.set(0,0);for(var D=1,k=this.ag.size;D<k;D++){var E=this.ag.get(D);this.ag.set(D,e);e+=E}for(D=
b;D<d;D++){var F=this.tt.read(D-b),a=h.Qq(F),G=this.KG(a),p=this.ag.get(G);c.set(p+b,F);this.ag.set(G,p+1)}l=!1}}catch(oa){this.ag.resize(0),this.tt.resize(0)}if(l)h.gs(b,d,c);else{D=d=0;for(k=this.ag.size;D<k;D++)l=d,d=this.ag.get(D),d>l&&h.gs(b+l,b+d,c);100<this.ag.size&&(this.ag.resize(0),this.tt.resize(0))}}};a.prototype.reset=function(c,b,d,h){if(2>c||d==b)return!1;c=Math.min(a.PV,c);this.ag.yb(c);this.ag.resize(c);this.ag.Zh(0,0,this.ag.size);this.TI=b;this.tt.resize(h);this.zt=(d-b)/(c-1);
return!0};a.prototype.KG=function(c){return f.J.truncate((c-this.TI)/this.zt)};a.PV=65536;return a}();f.Gu=a})(C||(C={}));(function(f){var a;(function(b){b[b.enum_line=1]="enum_line";b[b.enum_arc=2]="enum_arc";b[b.enum_dummy=4]="enum_dummy";b[b.enum_concave_dip=8]="enum_concave_dip";b[b.enum_connection=3]="enum_connection"})(a||(a={}));var e=function(){function b(){}b.Dv=function(d,c,h,l,a,G){var q=new b;q.vn=new f.b;q.Jn=new f.b;q.Nw=new f.b;q.vn.L(d);q.Jn.L(c);q.Nw.L(h);q.qp=l;q.Nh=a;q.Qh=G;return q};
b.pa=function(d,c,h,l){var q=new b;q.vn=new f.b;q.Jn=new f.b;q.Nw=new f.b;q.vn.L(d);q.Jn.L(c);q.Nw.$c();q.qp=4;q.Nh=h;q.Qh=l;return q};return b}(),c=function(){function b(b,d,c,h,l,f){this.Kw=null;this.Ba=0;this.iB=b;this.nJ=this.lJ=0;this.Qa=d;this.ek=c;this.Xk=h;this.sr=l;this.lc=f}b.prototype.next=function(){for(var b=new f.Wa;;){if(this.Ba==this.iB.D())return null;this.iB.Ae(this.Ba,b);this.Ba++;if(!b.u())break}var d=!1;null==this.Kw&&(this.lJ=b.Be(),this.nJ=b.nf(),this.Kw=h.buffer(b,this.Qa,
this.ek,this.Xk,this.sr,this.lc),d=!0);var c;this.Ba<this.iB.D()?(c=new f.Ia,this.Kw.copyTo(c)):c=this.Kw;if(!d){var d=new f.Hd,l=b.Be()-this.lJ,b=b.nf()-this.nJ;d.Ag(l,b);c.Xc(d)}return c};b.prototype.Ha=function(){return 0};b.prototype.Re=function(){return!0};return b}(),b=function(){function b(b,d){this.$a=b;this.Ba=0;this.cr=d}b.prototype.next=function(){var b=this.$a.Y;if(this.Ba<b.aa()){var d=this.Ba;this.Ba++;if(!b.Eo(d))for(var c=b.Aa(b.Gc(d)-1);this.Ba<b.aa();){var h=b.Aa(b.wa(this.Ba));
if(b.Eo(this.Ba))break;if(h!=c)break;c=b.Aa(b.Gc(this.Ba)-1);this.Ba++}if(1==this.Ba-d)return this.$a.wF(this.$a.Y,d,this.cr);c=new f.Ua(this.$a.Y.description);c.Ti(this.$a.Y,d,!0);for(d+=1;d<this.Ba;d++)c.As(this.$a.Y,d,0,b.dw(d),!1);return this.$a.wF(c,0,this.cr)}return null};b.prototype.Ha=function(){return 0};b.prototype.Re=function(){return!0};return b}(),d=function(){function b(b){this.$a=b;this.Ba=0}b.prototype.next=function(){var b=this.$a.Y;if(this.Ba<b.aa()){var d=this.Ba;b.Tm(this.Ba);
for(this.Ba++;this.Ba<b.aa()&&!(0<b.Tm(this.Ba));)this.Ba++;return 0==d&&this.Ba==b.aa()?this.$a.Vy(b,0,b.aa()):this.$a.Vy(b,d,this.Ba)}return null};b.prototype.Ha=function(){return 0};b.prototype.Re=function(){return!0};return b}(),h=function(){function h(b){this.Et=this.Yw=this.Ft=this.Wd=null;this.te=[];this.lc=b;this.vb=this.ww=this.GV=this.Qa=this.YA=this.Ut=this.ta=0;this.VA=this.Xk=-1;this.cr=!0}h.buffer=function(b,d,c,l,a,G){if(null==b)throw f.f.F();if(0>l)throw f.f.F();if(b.u())return new f.Ia(b.description);
var q=new f.h;b.ac(q);0<d&&q.O(d,d);G=new h(G);G.ek=c;G.Y=b;G.ta=f.ma.be(c,q,!0);G.Ut=f.ma.be(null,q,!0);G.Qa=d;G.GV=b.G();0>=a&&(a=96);G.vb=Math.abs(G.Qa);G.ww=0!=G.vb?1/G.vb:0;isNaN(l)||0==l?l=1E-5*G.vb:l>.5*G.vb&&(l=.5*G.vb);12>a&&(a=12);b=Math.abs(d)*(1-Math.cos(Math.PI/a));b>l?l=b:(b=Math.PI/Math.acos(1-l/Math.abs(d)),b<a-1&&(a=f.J.truncate(b),12>a&&(a=12,l=Math.abs(d)*(1-Math.cos(Math.PI/a)))));G.Xk=l;G.sr=a;G.YA=Math.min(G.Ut,.25*l);return G.xF()};h.prototype.Qv=function(){if(null==this.Wd)this.Wd=
[];else if(0!==this.Wd.length)return;var b=this.BF(),b=f.J.truncate((b+3)/4),d=.5*Math.PI/b;this.VA=d;for(var c=0;c<4*b;c++)this.Wd.push(null);for(var h=Math.cos(d),d=Math.sin(d),l=f.b.pa(0,1),c=0;c<b;c++)this.Wd[c+0*b]=f.b.pa(l.y,-l.x),this.Wd[c+1*b]=f.b.pa(-l.x,-l.y),this.Wd[c+2*b]=f.b.pa(-l.y,l.x),this.Wd[c+3*b]=l,l=f.b.pa(l.x,l.y),l.pu(h,d)};h.prototype.xF=function(){var b=this.Y.G();if(f.T.Oc(b))return b=new f.Ua(this.Y.description),b.dc(this.Y,!0),this.Y=b,this.xF();if(this.Qa<=this.ta)if(f.T.NU(b)){if(0>=
this.Qa&&(b=new f.h,this.Y.s(b),b.N()<=2*-this.Qa||b.fa()<=2*this.Qa))return new f.Ia(this.Y.description)}else return new f.Ia(this.Y.description);switch(this.Y.G()){case 33:return this.RP();case 550:return this.QP();case 1607:return this.TP();case 1736:return this.SP();case 197:return this.OP();default:throw f.f.ya();}};h.prototype.TP=function(){if(this.PH(this.Y)){var d=new f.Wa;this.Y.Ae(0,d);var c=new f.h;this.Y.s(c);d.rb(c.Wf());return this.qv(d)}this.Y=this.NW(this.Y);d=new b(this,this.cr);
return f.ei.local().V(d,this.ek,this.lc).next()};h.prototype.SP=function(){if(0==this.Qa)return this.Y;var b=f.Lm.local();this.Qv();this.Y=b.V(this.Y,null,!1,this.lc);if(0>this.Qa){var c=this.Y,c=this.Vy(c,0,c.aa());return b.V(c,this.ek,!1,this.lc)}if(this.PH(this.Y))return b=new f.Wa,this.Y.Ae(0,b),c=new f.h,this.Y.s(c),b.rb(c.Wf()),this.qv(b);b=new d(this);return f.ei.local().V(b,this.ek,this.lc).next()};h.prototype.Vy=function(b,d,c){for(var l=new f.Ia(b.description);d<c;d++)if(!(1>b.Ka(d))){var q=
b.Tm(d),v=new f.h;b.ik(d,v);if(0<this.Qa)if(0<q)if(this.QH(b,d))q=new f.Wa,b.Ae(b.wa(d),q),q.rb(v.Wf()),this.hv(l,q);else{var D=q=new f.Ua(b.description),D=f.Iu.UH(this.Y,d)||2==this.to(this.Y,d,D,!0,1)?this.vF(b,d):this.so(q);l.add(D,!1)}else{if(!(v.N()+this.ta<=2*this.vb||v.fa()+this.ta<=2*this.vb||(D=q=new f.Ua(b.description),this.to(this.Y,d,D,!0,1),q.u()))){var a=new f.h;a.I(v);a.O(this.vb,this.vb);D.oq(a);D=this.so(q);v=1;for(q=D.aa();v<q;v++)l.Ti(D,v,!0)}}else if(0<q){if(!(v.N()+this.ta<=2*
this.vb||v.fa()+this.ta<=2*this.vb||(D=q=new f.Ua(b.description),this.to(this.Y,d,D,!0,-1),q.u())))for(a=new f.h,D.ac(a),a.O(this.vb,this.vb),D.oq(a),D=this.so(q),v=1,q=D.aa();v<q;v++)l.Ti(D,v,!0)}else for(D=q=new f.Ua(b.description),this.to(this.Y,d,D,!0,-1),D=this.so(q),v=0,q=D.aa();v<q;v++)l.Ti(D,v,!0)}if(0<this.Qa)return 1<l.aa()?l=this.so(l):h.We(l);b=new f.h;l.ac(b);if(l.u())return h.We(l);b.O(this.vb,this.vb);l.oq(b);l=this.so(l);b=new f.Ia(l.description);v=1;for(q=l.aa();v<q;v++)b.Ti(l,v,
!1);return h.We(b)};h.prototype.RP=function(){return this.qv(this.Y)};h.prototype.qv=function(b){var d=new f.Ia(this.Y.description);this.hv(d,b);return this.mY(d)};h.prototype.QP=function(){var b=new c(this.Y,this.Qa,this.ek,this.Xk,this.sr,this.lc);return f.ei.local().V(b,this.ek,this.lc).next()};h.prototype.OP=function(){var b=new f.Ia(this.Y.description);if(0>=this.Qa){if(0==this.Qa)b.jd(this.Y,!1);else{var d=new f.ci;this.Y.Rn(d);d.O(this.Qa,this.Qa);b.jd(d,!1)}return b}b.jd(this.Y,!1);this.Y=
b;return this.vF(b,0)};h.prototype.vF=function(b,d){this.Qv();var c=new f.Ia(b.description),l=new f.b,q=new f.b,v=new f.b,a=new f.b,e=new f.b,k=new f.b,E=new f.b,p=new f.b,n=b.Ka(d),g=b.wa(d),u=0;for(d=b.Ka(d);u<d;u++){b.w(g+u,q);b.w(g+(u+1)%n,a);b.w(g+(u+2)%n,k);E.zc(a,q);if(0==E.length())throw f.f.ya();E.tw();E.normalize();E.scale(this.vb);l.add(E,q);v.add(E,a);0==u?c.yu(l):c.aj(l);c.aj(v);p.zc(k,a);if(0==p.length())throw f.f.ya();p.tw();p.normalize();p.scale(this.vb);e.add(p,a);this.WE(c,a,v,e,
!1)}return h.We(c)};h.prototype.wF=function(b,d,c){this.Qv();if(1>b.Ka(d))return null;if(this.QH(b,d)&&0<this.Qa){c=new f.Wa;b.Ae(b.wa(d),c);var h=new f.h;b.ik(d,h);c.rb(h.Wf());return this.qv(c)}h=new f.Ua(b.description);if(b.Eo(d))this.to(b,d,h,c,1),this.to(b,d,h,c,-1);else{var l=new f.Ua(b.description);l.Ti(b,d,!1);l.As(b,d,0,b.dw(d),!1);this.to(l,0,h,c,1)}return this.so(h)};h.prototype.Or=function(){this.jx++};h.prototype.so=function(b){return f.Dg.ol(b,this.Ut,!0,!0,this.lc)};h.prototype.BF=
function(){if(0==this.Xk)return this.sr;var b=1-this.Xk*Math.abs(this.ww),d;-1>b?d=4:d=2*Math.PI/Math.acos(b)+.5;4>d?d=4:d>this.sr&&(d=this.sr);return f.J.truncate(d)};h.prototype.WE=function(b,d,c,h,l){this.Qv();var q=new f.b;q.zc(c,d);q.scale(this.ww);var v=new f.b;v.zc(h,d);v.scale(this.ww);q=Math.atan2(q.y,q.x)/this.VA;0>q&&(q=this.Wd.length+q);q=this.Wd.length-q;v=Math.atan2(v.y,v.x)/this.VA;0>v&&(v=this.Wd.length+v);v=this.Wd.length-v;v<q&&(v+=this.Wd.length);var D=f.J.truncate(v),v=f.J.truncate(Math.ceil(q)),
q=new f.b;q.L(this.Wd[v%this.Wd.length]);q.qu(this.vb,d);var a=10*this.ta;q.sub(c);q.length()<a&&(v+=1);q.L(this.Wd[D%this.Wd.length]);q.qu(this.vb,d);q.sub(h);q.length()<a&&--D;c=D-v;c++;D=0;for(v%=this.Wd.length;D<c;D++,v=(v+1)%this.Wd.length)q.L(this.Wd[v]),q.qu(this.vb,d),b.aj(q),this.Or();l&&b.aj(h)};h.prototype.to=function(b,d,c,h,l){var q=new f.fd,v=q.jP(b,d);q.zq(this.YA,!1,!1);if(2>q.D(v)){if(0>l)return 1;l=b;q=new f.Wa;l.Ae(l.wa(d),q);this.hv(c,q);return 1}var D=q.Aa(q.cb(q.Pb(v))),a=new f.Hd;
a.Ag(-D.x,-D.y);q.Xc(a);if(h&&(this.nS(q,v,l),2>q.D(v))){if(0>l)return 1;l=b;q=new f.Wa;l.Ae(l.wa(d),q);this.hv(c,q);return 1}this.te.length=0;var H=q.Pb(v);d=q.cb(H);var F=1==l?q.Ra(d):q.U(d);b=1==l?q.U(d):q.Ra(d);var k=!0;h=new f.b;for(var v=new f.b,E=new f.b,p=new f.b,n=new f.b,g=new f.b,u=new f.b,z=new f.b,t=new f.b,r=new f.b,A=this.vb,H=q.Ka(H),m=0;m<H;m++)q.w(b,v),k&&(q.w(d,h),q.w(F,E),z.zc(h,E),z.normalize(),r.$H(z),r.scale(A),p.add(r,h)),u.zc(v,h),u.normalize(),t.$H(u),t.scale(A),n.add(h,
t),F=z.Ui(u),k=z.oi(u),0>F||0>k&&0==F?this.te.push(e.Dv(p,n,h,2,this.te.length+1,this.te.length-1)):p.ub(n)||(this.te.push(e.pa(p,h,this.te.length+1,this.te.length-1,"dummy")),this.te.push(e.pa(h,n,this.te.length+1,this.te.length-1,"dummy"))),g.add(v,t),this.te.push(e.Dv(n,g,h,1,this.te.length+1,this.te.length-1)),p.L(g),r.L(t),E.L(h),h.L(v),z.L(u),F=d,d=b,k=!1,b=1==l?q.U(d):q.Ra(d);this.te[this.te.length-1].Nh=0;this.te[0].Qh=this.te.length-1;this.PW(c);a.Ag(D.x,D.y);c.jF(a,c.aa()-1);return 1};h.prototype.PW=
function(b){for(var d=this.BQ(),c=!0,h=d+1,l=d;h!=d;l=h){var f=this.te[l],h=-1!=f.Nh?f.Nh:(l+1)%this.te.length;0!=f.qp&&(c&&b.yu(f.vn),2==f.qp?this.WE(b,f.Nw,f.vn,f.Jn,!0):b.aj(f.Jn),c=!1)}};h.prototype.BQ=function(){null==this.Et&&(this.Et=[null,null,null,null,null,null,null,null,null]);for(var b=0,d=0,c=this.te.length;d<c;){var h=this.te[d];if(0!=(h.qp&3)){b=d;break}d=h.Nh}c=b+1;for(d=b;c!=b;d=c){for(var h=this.te[d],c=h.Nh,l=1,a=null;c!=d;){a=this.te[c];if(0!=(a.qp&3))break;c=a.Nh;l++}1!=l&&1==
(h.qp&a.qp)&&(null==this.Ft&&(this.Ft=new f.Hb,this.Yw=new f.Hb),this.Ft.Mc(h.vn),this.Ft.Zc(h.Jn),this.Yw.Mc(a.vn),this.Yw.Zc(a.Jn),1==this.Ft.Ma(this.Yw,this.Et,null,null,this.Ut)&&(h.Jn.L(this.Et[0]),a.vn.L(this.Et[0]),h.Nh=c,a.Qh=d))}return b};h.prototype.rw=function(b,d,c){var h=new f.b;h.zc(c,b);c=h.length();c=this.vb*this.vb-c*c*.25;if(0<c){c=Math.sqrt(c);h.normalize();h.Tr();var l=new f.b;l.zc(d,b);if(l.oi(h)+c>=this.vb)return!0}return!1};h.prototype.nS=function(b,d,c){for(var h=0;1>h;h++){var l=
!1,q=b.Pb(d),v=b.Ka(q);if(0==v)break;var a=v;if(3>v)break;!b.Qb(q)&&(a=v-1);for(var q=b.cb(q),v=0<c?b.Ra(q):b.U(q),D=0<c?b.U(q):b.Ra(q),e=v,k=!0,E=new f.b,p=new f.b,n=new f.b,g=new f.b,u=new f.b,z=f.b.pa(0,0),t=new f.b,r=new f.b,A=new f.b,m=new f.b,w=this.vb,x=0,C=0;C<a;){b.w(D,p);k&&(b.w(q,E),b.w(v,n),e=v);r.zc(E,n);r.normalize();t.zc(p,E);t.normalize();if(e==D)break;var I=r.Ui(t),J=r.oi(t),K=!0;0>I||0>J&&0==I||!this.rw(n,E,p)||(z.L(p),K=!1,++x,l=!0);if(K){if(0<x)for(;;){I=0<c?b.Ra(e):b.U(e);if(I==
q)break;b.w(I,g);if(this.rw(g,n,z))n.L(g),e=I,K=!1,++x;else{I!=D&&this.rw(g,n,p)&&this.rw(g,E,p)&&(n.L(g),e=I,K=!1,++x);break}}if(!K)continue;if(0<x){e=0<c?b.Ra(v):b.U(v);for(k=1;k<x;k++)K=0<c?b.Ra(e):b.U(e),b.td(e,!0),e=K;A.zc(E,n);x=A.length();x=w*w-x*x*.25;x=Math.sqrt(x);w-x>.5*this.Xk?(u.add(n,E),u.scale(.5),A.normalize(),A.Tr(),m.L(A),m.scale(w-x),u.add(m),b.Qf(v,u)):b.td(v,!0);x=0}n.L(E);e=q}E.L(p);v=q;q=D;D=0<c?b.U(q):b.Ra(q);C++;k=!1}if(0<x){e=0<c?b.Ra(v):b.U(v);for(k=1;k<x;k++)K=0<c?b.Ra(e):
b.U(e),b.td(e,!0),e=K;u.add(n,E);u.scale(.5);A.zc(E,n);x=A.length();x=w*w-x*x*.25;x=Math.sqrt(x);A.normalize();A.Tr();m.L(A);m.scale(w-x);u.add(m);b.Qf(v,u)}b.zq(this.YA,!1,!1);if(!l)break}};h.prototype.QH=function(b,d){if(1==b.Ka(d))return!0;var c=new f.h;b.ik(d,c);return Math.max(c.N(),c.fa())<.5*this.Xk?!0:!1};h.prototype.PH=function(b){var d=new f.h;b.s(d);return Math.max(d.N(),d.fa())<.5*this.Xk?!0:!1};h.prototype.NW=function(b){b=f.FD.local().V(b,.25*this.Xk,!1,this.lc);for(var d=0,c=0,h=b.aa();c<
h;c++)d=Math.max(b.Ka(c),d);if(32>d)return this.cr=!1,b;this.cr=!0;return f.Dg.ol(b,this.Ut,!1,!0,this.lc)};h.prototype.hv=function(b,d){d=d.w();if(null!=this.Wd&&0!==this.Wd.length){var c=new f.b;c.L(this.Wd[0]);c.qu(this.vb,d);b.yu(c);for(var h=1,l=this.Wd.length;h<l;h++)c.L(this.Wd[h]),c.qu(this.vb,d),b.aj(c)}else for(var h=this.BF(),c=f.J.truncate((h+3)/4),h=.5*Math.PI/c,l=Math.cos(h),q=Math.sin(h),v=new f.b,a=3;0<=a;a--){v.ka(0,this.vb);switch(a){case 0:for(h=0;h<c;h++)b.Wj(v.x+d.x,v.y+d.y),
v.pu(l,q);break;case 1:for(h=0;h<c;h++)b.Wj(-v.y+d.x,v.x+d.y),v.pu(l,q);break;case 2:for(h=0;h<c;h++)b.Wj(-v.x+d.x,-v.y+d.y),v.pu(l,q);break;default:for(b.Zx(v.y+d.x,-v.x+d.y),h=1;h<c;h++)v.pu(l,q),b.Wj(v.y+d.x,-v.x+d.y)}this.Or()}};h.We=function(b){b.Zg(1,0);return b};h.prototype.mY=function(b){b.Zg(2,this.ta);b.Al();return b};return h}();f.OL=h})(C||(C={}));(function(f){var a=function(){function a(c){this.Ga=c;this.a=new f.fd;this.od=new f.ia(0)}a.prototype.ji=function(c,b,d){switch(b){case 0:if(c.o<
d&&c.v<=d)break;else return c.o>=d?1:-1;case 1:if(c.A<d&&c.B<=d)break;else return c.A>=d?1:-1;case 2:if(c.o>=d&&c.v>d)break;else return c.v<=d?1:-1;case 3:if(!(c.A>=d&&c.B>d))return c.B<=d?1:-1}return 0};a.prototype.gz=function(c,b,d){return 1736==c.G()?this.hz(c,b,d):this.iz(c,b)};a.prototype.hz=function(c,b,d){if(0==this.Ga.N()||0==this.Ga.fa())return c.Ja();b=new f.h;c.ac(b);this.Y=this.a.Jb(c);var h=new f.h,l=new f.h,q=new f.b,v=new f.b,a=[0,0,0,0,0,0,0,0,0],H=[0,0,0,0,0,0,0,0,0];new f.Cg;var F=
new f.Hb,e=new f.ia(0);e.yb(Math.min(100,c.D()));for(var k=!1,E=0;!k&&4>E;E++){var p=!1,n=0!=(E&1),g=0;switch(E){case 0:g=this.Ga.o;p=b.o<=g&&b.v>=g;break;case 1:g=this.Ga.A;p=b.A<=g&&b.B>=g;break;case 2:g=this.Ga.v;p=b.o<=g&&b.v>=g;break;case 3:g=this.Ga.B,p=b.A<=g&&b.B>=g}if(p)for(k=!0,p=this.a.Pb(this.Y);-1!=p;){var u=-1,z=-1,t=this.a.cb(p),r=t;do{var A=this.a.ic(r);null==A&&(A=F,this.a.w(r,q),A.Mc(q),this.a.w(this.a.U(r),v),A.Zc(v));A.s(h);var m=this.ji(h,E,g),w=0,x=-1;if(-1==m){A=A.Sq(n,g,a,
H);0<A?w=this.a.zm(r,H,A):w=0;for(var w=w+1,C=r,I=this.a.U(C),A=0;A<w;A++){this.a.w(C,q);this.a.w(I,v);x=this.a.ic(C);null==x&&(x=F,x.Mc(q),x.Zc(v));x.s(l);x=this.ji(l,E,g);if(-1==x){if(n)x=Math.abs(q.y-g),J=Math.abs(v.y-g),x<J?(q.y=g,this.a.Qf(C,q)):(v.y=g,this.a.Qf(I,v));else{var x=Math.abs(q.x-g),J=Math.abs(v.x-g);x<J?(q.x=g,this.a.Qf(C,q)):(v.x=g,this.a.Qf(I,v))}x=this.a.ic(C);null==x&&(x=F,x.Mc(q),x.Zc(v));x.s(l);x=this.ji(l,E,g)}J=u;u=x;-1==z&&(z=u);if(0!=J||1!=u)1==J&&0==u||0!=J||0!=u||e.add(C);
1==u&&(k=!1);x=C=I;I=this.a.U(I)}}if(0==w){J=u;u=m;-1==z&&(z=u);if(0!=J||1!=u)1==J&&0==u||0!=J||0!=u||e.add(r);1==u&&(k=!1);x=this.a.U(r)}r=x}while(r!=t);0==z&&0==u&&e.add(t);A=0;for(u=e.size;A<u;A++)z=e.get(A),this.a.td(z,!1);e.clear(!1);p=3>this.a.Ka(p)?this.a.Qr(p):this.a.Sb(p)}}if(k)return c.Ja();this.eC();0<d&&this.uz(d);return this.a.Se(this.Y)};a.prototype.iz=function(c){var b=new f.h,d=new f.h,h=[0,0,0,0,0,0,0,0,0],l=[0,0,0,0,0,0,0,0,0],q=new f.Cg,v=c,a=new f.h;c.ac(a);for(var H=0;4>H;H++){var F=
!1,e=0!=(H&1),k=0;switch(H){case 0:k=this.Ga.o;F=a.o<=k&&a.v>=k;break;case 1:k=this.Ga.A;F=a.A<=k&&a.B>=k;break;case 2:k=this.Ga.v;F=a.o<=k&&a.v>=k;break;case 3:k=this.Ga.B,F=a.A<=k&&a.B>=k}if(F){F=v;v=c.Ja();F=F.Da();F.yj();for(var E,p=new f.b;F.Ya();)for(var n,g=!0;F.Ca();){var u=F.ba();u.s(b);var z=this.ji(b,H,k);if(-1==z){if(z=u.Sq(e,k,h,l),0<z){var t=0;E=u.ec();for(var A=0;A<=z;A++)if(n=A<z?l[A]:1,t!=n){u.yh(t,n,q);var r=q.get();r.Mc(E);A<z&&(e?(p.x=h[A],p.y=k):(p.x=k,p.y=h[A]),r.Zc(p));r.s(d);
var m=this.ji(d,H,k);if(-1==m){E=r.ec();t=r.Cc();if(e)m=Math.abs(E.y-k),w=Math.abs(t.y-k),m<w?(E.y=k,r.Mc(E)):(t.y=k,r.Zc(t));else{var m=Math.abs(E.x-k),w=Math.abs(t.x-k);m<w?(E.x=k,r.Mc(E)):(t.x=k,r.Zc(t))}r.s(d);m=this.ji(d,H,k)}E=r.Cc();t=n;n=m;1==n?(v.dc(r,g),g=!1):g=!0}}}else n=z,1==n?(v.dc(u,g),g=!1):g=!0}}}return v};a.prototype.eC=function(){this.Ki=-1;this.Am(!1,this.Ga.o);this.Am(!1,this.Ga.v);this.Am(!0,this.Ga.A);this.Am(!0,this.Ga.B);this.od.resize(0);this.od.yb(100);this.Ki=this.a.Vd();
for(var c=new f.b,b=this.a.Pb(this.Y);-1!=b;b=this.a.Sb(b))for(var d=this.a.cb(b),h=0,l=this.a.Ka(b);h<l;h++,d=this.a.U(d))if(this.a.w(d,c),this.Ga.o==c.x||this.Ga.v==c.x||this.Ga.A==c.y||this.Ga.B==c.y)this.a.Va(d,this.Ki,this.od.size),this.od.add(d);this.sm(!1,this.Ga.o);this.sm(!1,this.Ga.v);this.sm(!0,this.Ga.A);this.sm(!0,this.Ga.B);this.Bz()};a.prototype.uz=function(c){for(var b=new f.b,d=new f.b,h=f.J.gf(2048,0),l=this.a.Pb(this.Y);-1!=l;l=this.a.Sb(l)){var q=this.a.cb(l),v=q;do{var a=this.a.U(v);
this.a.w(v,b);var H=-1;b.x==this.Ga.o?(this.a.w(a,d),d.x==this.Ga.o&&(H=1)):b.x==this.Ga.v&&(this.a.w(a,d),d.x==this.Ga.v&&(H=1));b.y==this.Ga.A?(this.a.w(a,d),d.y==this.Ga.A&&(H=0)):b.y==this.Ga.B&&(this.a.w(a,d),d.y==this.Ga.B&&(H=0));if(-1!=H&&(H=f.b.Cb(b,d),H=f.J.truncate(Math.min(Math.ceil(H/c),2048)),!(1>=H))){for(var F=1;F<H;F++)h[F-1]=1*F/H;this.a.zm(v,h,H-1)}v=a}while(v!=q)}};a.prototype.Am=function(c,b){var d=this.a.Vd(),h=new f.b,l=new f.ia(0);l.yb(100);for(var q=this.a.Pb(this.Y);-1!=
q;q=this.a.Sb(q))for(var v=this.a.cb(q),a=0,H=this.a.Ka(q);a<H;a++){var F=this.a.U(v);this.a.w(v,h);if(c?h.y==b:h.x==b)if(this.a.w(F,h),c?h.y==b:h.x==b)1!=this.a.Sa(v,d)&&(l.add(v),this.a.Va(v,d,1)),1!=this.a.Sa(F,d)&&(l.add(F),this.a.Va(F,d,1));v=F}this.a.ke(d);if(!(3>l.size)){var e=this;l.Gd(0,l.size,function(b,d){return e.ki(b,d)});d=new f.b;q=new f.b;v=new f.b;q.$c();for(var k=-1,a=new f.ia(0),H=new f.ia(0),F=this.a.Vd(),E=this.a.Vd(),p=0,n=l.size;p<n;p++){var g=l.get(p);this.a.w(g,h);if(!h.ub(q)){if(-1!=
k){for(var u=k;u<p;u++){var k=l.get(u),z=this.a.U(k),g=this.a.Ra(k),t=!1;0>this.ki(k,z)&&(this.a.w(z,d),c?d.y==b:d.x==b)&&(a.add(k),t=!0,this.a.Va(k,E,1));0>this.ki(k,g)&&(this.a.w(g,d),c?d.y==b:d.x==b)&&(t||a.add(k),this.a.Va(k,F,1))}u=0;for(t=a.size;u<t;u++){k=a.get(u);g=this.a.Sa(k,F);z=this.a.Sa(k,E);if(1==g){g=this.a.Ra(k);this.a.w(g,v);var r=[0];r[0]=0;if(!v.ub(h)){var A=f.b.Cb(q,v);r[0]=f.b.Cb(v,h)/A;0==r[0]?r[0]=2.220446049250313E-16:1==r[0]&&(r[0]=.9999999999999998);this.a.zm(g,r,1);g=this.a.Ra(k);
this.a.Qf(g,h);H.add(g);this.a.Va(g,F,1);this.a.Va(g,E,-1)}}1==z&&(z=this.a.U(k),this.a.w(z,v),r=[0],r[0]=0,v.ub(h)||(A=f.b.Cb(q,v),r[0]=f.b.Cb(q,h)/A,0==r[0]?r[0]=2.220446049250313E-16:1==r[0]&&(r[0]=.9999999999999998),this.a.zm(k,r,1),g=this.a.U(k),this.a.Qf(g,h),H.add(g),this.a.Va(g,F,-1),this.a.Va(g,E,1)))}k=a;a=H;H=k;H.clear(!1)}k=p;q.L(h)}}this.a.ke(F);this.a.ke(E)}};a.prototype.sm=function(c,b){var d=new f.b,h=new f.ia(0);h.yb(100);for(var l=this.a.Vd(),q=0,v=this.od.size;q<v;q++){var a=this.od.get(q);
if(-1!=a){var H=this.a.U(a);this.a.w(a,d);if(c?d.y==b:d.x==b)if(this.a.w(H,d),c?d.y==b:d.x==b)-2!=this.a.Sa(a,l)&&(h.add(a),this.a.Va(a,l,-2)),-2!=this.a.Sa(H,l)&&(h.add(H),this.a.Va(H,l,-2))}}if(0!=h.size){var F=this;h.Gd(0,h.size,function(b,d){return F.ki(b,d)});q=0;for(v=h.size;q<v;q++){var e=h.get(q);this.a.Va(e,l,q)}a=new f.b;H=new f.b;H.$c();for(var k=-1,q=0,v=h.size;q<v;q++)if(e=h.get(q),-1!=e&&(this.a.w(e,d),!d.ub(H))){if(-1!=k)for(;;){for(var e=!1,E=1<q-k?q-1:q,p=k;p<E;p++){var n=h.get(p);
if(-1!=n){var g=-1,u=this.a.U(n);0>this.ki(n,u)&&(this.a.w(u,a),c?a.y==b:a.x==b)&&(g=u);var u=-1,z=this.a.Ra(n);0>this.ki(n,z)&&(this.a.w(z,a),c?a.y==b:a.x==b)&&(u=z);if(-1!=g&&-1!=u)this.ii(n,h,l),this.a.td(n,!1),this.ii(g,h,l),this.a.td(g,!1),e=!0;else if(-1!=g||-1!=u){for(z=p+1;z<q;z++){var t=h.get(z);if(-1!=t){var r=this.a.U(t),A=-1;0>this.ki(t,r)&&(this.a.w(r,a),c?a.y==b:a.x==b)&&(A=r);var r=this.a.Ra(t),m=-1;0>this.ki(t,r)&&(this.a.w(r,a),c?a.y==b:a.x==b)&&(m=r);if(-1!=A&&-1!=m){this.ii(t,h,
l);this.a.td(t,!1);this.ii(A,h,l);this.a.td(A,!1);e=!0;break}if(-1!=g&&-1!=m){this.nu(h,n,g,t,m,l);e=!0;break}else if(-1!=u&&-1!=A){this.nu(h,t,A,n,u,l);e=!0;break}}}if(e)break}}}if(!e)break}k=q;H.L(d)}}this.a.ke(l)};a.prototype.ii=function(c,b,d){d=this.a.Sa(c,d);b.set(d,-1);d=this.a.Sa(c,this.Ki);this.od.set(d,-1);b=this.a.ld(c);-1!=b&&this.a.cb(b)==c&&(this.a.jg(b,-1),this.a.sh(b,-1))};a.prototype.nu=function(c,b,d,h,l,f){this.a.Kc(b,h);this.a.Lc(h,b);this.a.Lc(d,l);this.a.Kc(l,d);this.ii(h,c,
f);this.a.Mi(h,!1);this.ii(l,c,f);this.a.Mi(l,!0)};a.prototype.Bz=function(){for(var c=0,b=this.od.size;c<b;c++){var d=this.od.get(c);-1!=d&&this.a.Aj(d,-1)}for(var h=0,l=0,f=this.a.Pb(this.Y);-1!=f;){var v=this.a.cb(f);if(-1==v||f!=this.a.ld(v)){var a=f,f=this.a.Sb(f);this.a.jg(a,-1);this.a.Rr(a)}else{d=v;a=0;do this.a.Aj(d,f),a++,d=this.a.U(d);while(d!=v);2>=a?(d=this.a.Sa(v,this.Ki),this.od.set(d,-1),v=this.a.td(v,!1),2==a&&(d=this.a.Sa(v,this.Ki),this.od.set(d,-1),this.a.td(v,!1)),a=f,f=this.a.Sb(f),
this.a.jg(a,-1),this.a.Rr(a)):(this.a.Np(f,!1),this.a.sh(f,this.a.Ra(v)),this.a.mk(f,a),l+=a,h++,f=this.a.Sb(f))}}c=0;for(b=this.od.size;c<b;c++)if(d=this.od.get(c),-1!=d&&(f=this.a.ld(d),-1==f)){f=this.a.Yf(this.Y,-1);a=0;v=d;do this.a.Aj(d,f),a++,d=this.a.U(d);while(d!=v);2>=a?(d=this.a.Sa(v,this.Ki),this.od.set(d,-1),v=this.a.td(v,!1),2==a&&(d=this.a.Sa(v,this.Ki),0<=d&&this.od.set(d,-1),this.a.td(v,!1)),a=f,this.a.jg(a,-1),this.a.Rr(a)):(this.a.ao(f,!0),this.a.mk(f,a),this.a.jg(f,v),this.a.sh(f,
this.a.Ra(v)),this.a.Np(f,!1),l+=a,h++)}this.a.wm(this.Y,h);this.a.kk(this.Y,l);c=0;for(b=this.a.rd;-1!=b;b=this.a.Ue(b))c+=this.a.D(b);this.a.yC(c)};a.Im=function(c,b,d,h){return(new a(b)).gz(c,d,h)};a.clip=function(c,b,d,h){if(c.u())return c;if(b.u())return c.Ja();var l=c.G();if(33==l)return d=c.w(),b.contains(d)?c:c.Ja();if(197==l)return d=new f.h,c.s(d),d.Ma(b)?(b=new f.ci,c.copyTo(b),b.Gp(d),b):c.Ja();var q=new f.h;c.ac(q);if(b.contains(q))return c;if(!b.Yb(q))return c.Ja();q=c.ob;if(null!=q&&
(q=q.Hi,null!=q)){q=q.Sn(b);if(1==q){if(1736!=l)throw f.f.ya();c=new f.Ia(c.description);c.oq(b);return c}if(0==q)return c.Ja()}switch(l){case 550:h=null;for(var l=c.D(),q=c.Pa(0),v=0,D=0;D<l;D++)d=new f.b,q.fc(2*D,d),b.contains(d)||(0==v&&(h=c.Ja()),v<D&&h.Jd(c,v,D),v=D+1);0<v&&h.Jd(c,v,l);return 0==v?c:h;case 1736:case 1607:return a.Im(c,b,d,h);default:throw f.f.ya();}};a.prototype.ki=function(c,b){var d=new f.b;this.a.w(c,d);c=new f.b;this.a.w(b,c);return d.compare(c)};return a}();f.me=a})(C||
(C={}));(function(f){var a=function(){function a(c,b){this.Ga=c;this.a=new f.fd;this.od=new f.ia(0);this.je=b}a.prototype.ji=function(c,b,d){switch(b){case 0:if(c.o<d&&c.v<=d)break;else return c.o>=d?1:-1;case 1:if(c.A<d&&c.B<=d)break;else return c.A>=d?1:-1;case 2:if(c.o>=d&&c.v>d)break;else return c.v<=d?1:-1;case 3:if(!(c.A>=d&&c.B>d))return c.B<=d?1:-1}return 0};a.prototype.gz=function(c,b,d){return 1736==c.G()?this.hz(c,b,d):this.iz(c,b)};a.prototype.hz=function(c,b,d){if(0==this.Ga.N()||0==
this.Ga.fa())return c.Ja();b=new f.h;c.ac(b);this.Y=this.a.Jb(c);var h=new f.h,l=new f.h,q=new f.b,v=new f.b,a=[0,0,0,0,0,0,0,0,0],H=[0,0,0,0,0,0,0,0,0],F=new f.Hb,e=new f.ia(0);e.yb(256);for(var k=!1,E=0;!k&&4>E;E++){var p=!1,n=0!=(E&1),g=0;switch(E){case 0:g=this.Ga.o;p=b.o<=g&&b.v>=g;break;case 1:g=this.Ga.A;p=b.A<=g&&b.B>=g;break;case 2:g=this.Ga.v;p=b.o<=g&&b.v>=g;break;case 3:g=this.Ga.B,p=b.A<=g&&b.B>=g}if(p)for(k=!0,p=this.a.Pb(this.Y);-1!=p;){var u=!0,z=-1,t=-1,r=this.a.cb(p),A=r;do{var m=
this.a.ic(A);null==m&&(m=F,this.a.w(A,q),m.Mc(q),this.a.w(this.a.U(A),v),m.Zc(v));m.s(h);var w=this.ji(h,E,g),x=0,C=-1;if(-1==w){m=m.Sq(n,g,a,H);0<m?x=this.a.DY(A,H,m):x=0;for(var x=x+1,I=A,J=this.a.U(I),m=0;m<x;m++){this.a.w(I,q);this.a.w(J,v);C=this.a.ic(I);null==C&&(C=F,C.Mc(q),C.Zc(v));C.s(l);C=this.ji(l,E,g);if(-1==C){if(n)C=Math.abs(q.y-g),K=Math.abs(v.y-g),C<K?(q.y=g,this.a.Qf(I,q)):(v.y=g,this.a.Qf(J,v));else{var C=Math.abs(q.x-g),K=Math.abs(v.x-g);C<K?(q.x=g,this.a.Qf(I,q)):(v.x=g,this.a.Qf(J,
v))}C=this.a.ic(I);null==C&&(C=F,C.Mc(q),C.Zc(v));C.s(l);C=this.ji(l,E,g)}K=z;z=C;-1==t&&(t=z);if(0!=K||1!=z)1==K&&0==z||0!=K||0!=z||e.add(I);1==z&&(u=k=!1);C=I=J;J=this.a.U(J)}}if(0==x){K=z;z=w;-1==t&&(t=z);if(0!=K||1!=z)1==K&&0==z||0!=K||0!=z||e.add(A);1==z&&(u=k=!1);C=this.a.U(A)}A=C;if(256<=e.size){m=1;for(w=e.size-1;m<w;m++)x=e.get(m),this.a.td(x,!1);e.set(1,e.Fc());e.yf(2)}}while(A!=r);if(!u)for(0==t&&0==z&&e.add(r),m=0,w=e.size;m<w;m++)x=e.get(m),this.a.td(x,!1);e.clear(!1);p=u||0==this.a.Ka(p)?
this.a.Qr(p):this.a.Sb(p)}}if(k)return c.Ja();this.eC();0<d&&this.uz(d);return this.a.Se(this.Y)};a.prototype.iz=function(c){var b=new f.h,d=new f.h,h=[0,0,0,0,0,0,0,0,0],l=[0,0,0,0,0,0,0,0,0],q=new f.Cg,v=c,a=new f.h;c.ac(a);for(var H=new f.b,F=new f.b,e=null,k=null,E=0;4>E;E++){var p=!1,n=0!=(E&1),g=0;switch(E){case 0:g=this.Ga.o;p=a.o<=g&&a.v>=g;break;case 1:g=this.Ga.A;p=a.A<=g&&a.B>=g;break;case 2:g=this.Ga.v;p=a.o<=g&&a.v>=g;break;case 3:g=this.Ga.B,p=a.A<=g&&a.B>=g}if(p)for(p=v,v=c.Ja(),p=
p.Da(),p.yj();p.Ya();)for(var u,z=!0;p.Ca();){var t=p.ba();t.s(b);var r=this.ji(b,E,g);if(-1==r){if(r=t.Sq(n,g,h,l),0<r){var A=0;t.Oq(H);for(var m=0;m<=r;m++)if(u=m<r?l[m]:1,A!=u){t.yh(A,u,q);var w=q.get();w.Mc(H);m<r&&(n?(F.x=h[m],F.y=g):(F.x=g,F.y=h[m]),w.Zc(F));w.s(d);var x=this.ji(d,E,g);-1==x&&(null==e&&(e=new f.b),null==k&&(k=new f.b),w.Oq(e),w.Os(k),n?(A=Math.abs(e.y-g),x=Math.abs(k.y-g),A<x?(e.y=g,w.Mc(e)):(k.y=g,w.Zc(k))):(A=Math.abs(e.x-g),x=Math.abs(k.x-g),A<x?(e.x=g,w.Mc(e)):(k.x=g,w.Zc(k))),
w.s(d),x=this.ji(d,E,g));w.Os(H);A=u;u=x;1==u?(v.dc(w,z),z=!1):z=!0}}}else u=r,1==u?(v.dc(t,z),z=!1):z=!0}}return v};a.prototype.eC=function(){this.Ki=-1;this.Am(!1,this.Ga.o);this.Am(!1,this.Ga.v);this.Am(!0,this.Ga.A);this.Am(!0,this.Ga.B);this.od.resize(0);this.od.yb(100);this.Ki=this.a.Vd();for(var c=new f.b,b=this.a.Pb(this.Y);-1!=b;b=this.a.Sb(b))for(var d=this.a.cb(b),h=0,l=this.a.Ka(b);h<l;h++,d=this.a.U(d))if(this.a.w(d,c),this.Ga.o==c.x||this.Ga.v==c.x||this.Ga.A==c.y||this.Ga.B==c.y)this.a.Va(d,
this.Ki,this.od.size),this.od.add(d);this.sm(!1,this.Ga.o);this.sm(!1,this.Ga.v);this.sm(!0,this.Ga.A);this.sm(!0,this.Ga.B);this.Bz()};a.prototype.uz=function(c){for(var b=new f.b,d=new f.b,h=null,l=null,q=f.J.gf(2048,0),v=this.a.Pb(this.Y);-1!=v;v=this.a.Sb(v)){var a=this.a.cb(v),H=a;do{var F=this.a.U(H);this.a.w(H,b);var e=-1;b.x==this.Ga.o?(this.a.w(F,d),d.x==this.Ga.o&&(e=1)):b.x==this.Ga.v&&(this.a.w(F,d),d.x==this.Ga.v&&(e=1));b.y==this.Ga.A?(this.a.w(F,d),d.y==this.Ga.A&&(e=0)):b.y==this.Ga.B&&
(this.a.w(F,d),d.y==this.Ga.B&&(e=0));if(-1!=e){null==h&&(h=new f.b);null==l&&(l=new f.b);h.L(b);l.ka(0,0);if(0==e){var k=b.x-this.Ga.o;l.x=f.Ub.sign(d.x-b.x);h.x=c*f.Ub.Fl(Math.floor(Math.abs(k/c)),k)+this.Ga.o;0>h.x&&(h.x+=c)}else k=b.y-this.Ga.A,l.y=f.Ub.sign(d.y-b.y),h.y=c*f.Ub.Fl(Math.floor(Math.abs(k/c)),k)+this.Ga.A,0>h.y&&(h.y+=c);var k=0!=e?d.y-b.y:d.x-b.x,E=Math.abs(k);if(65536<E/c)throw f.f.X("internal error");if(0<E){E=f.J.truncate(E/c)+2;q.length<E&&(q=f.J.gf(E));for(var p=E=0;;p++){var g=
new f.b;g.x=h.x+l.x*p*c;g.y=h.y+l.y*p*c;g=(0!=e?g.y-b.y:g.x-b.x)/k;if(1<=g)break;0>=g||(q[E]=g,E++)}0!=E&&this.a.zm(H,q,E)}}H=F}while(H!=a)}};a.prototype.Am=function(c,b){for(var d=-1,h=new f.b,l=null,q=this.a.Pb(this.Y);-1!=q;q=this.a.Sb(q))for(var v=this.a.cb(q),a=0,H=this.a.Ka(q);a<H;a++){var F=this.a.U(v);this.a.w(v,h);if(c?h.y==b:h.x==b)if(this.a.w(F,h),c?h.y==b:h.x==b)-1==d&&(d=this.a.Vd()),null==l&&(l=new f.ia(0),l.yb(100)),1!=this.a.Sa(v,d)&&(l.add(v),this.a.Va(v,d,1)),1!=this.a.Sa(F,d)&&
(l.add(F),this.a.Va(F,d,1));v=F}-1!=d&&this.a.ke(d);if(!(null==l||3>l.size)){var e=this;l.Gd(0,l.size,function(b,d){return e.ki(b,d)});d=new f.b;q=new f.b;v=new f.b;q.$c();for(var k=-1,a=new f.ia(0),H=new f.ia(0),F=null,E=this.a.Vd(),p=this.a.Vd(),g=0,n=l.size;g<n;g++){var u=l.get(g);this.a.w(u,h);if(!h.ub(q)){if(-1!=k){for(var z=k;z<g;z++){var k=l.get(z),t=this.a.U(k),u=this.a.Ra(k),r=!1;this.a.w(t,d);0>q.compare(d)&&(c?d.y==b:d.x==b)&&(a.add(k),r=!0,this.a.Va(k,p,1));this.a.w(u,d);0>q.compare(d)&&
(c?d.y==b:d.x==b)&&(r||a.add(k),this.a.Va(k,E,1))}z=0;for(r=a.size;z<r;z++){k=a.get(z);u=this.a.Sa(k,E);t=this.a.Sa(k,p);if(1==u&&(u=this.a.Ra(k),this.a.w(u,v),!v.ub(h))){null==F&&(F=[]);var A=f.b.Cb(q,v);F[0]=f.b.Cb(v,h)/A;0==F[0]?F[0]=2.220446049250313E-16:1==F[0]&&(F[0]=.9999999999999998);this.a.zm(u,F,1);u=this.a.Ra(k);this.a.Qf(u,h);H.add(u);this.a.Va(u,E,1);this.a.Va(u,p,-1)}1==t&&(t=this.a.U(k),this.a.w(t,v),v.ub(h)||(null==F&&(F=[]),A=f.b.Cb(q,v),F[0]=f.b.Cb(q,h)/A,0==F[0]?F[0]=2.220446049250313E-16:
1==F[0]&&(F[0]=.9999999999999998),this.a.zm(k,F,1),u=this.a.U(k),this.a.Qf(u,h),H.add(u),this.a.Va(u,E,-1),this.a.Va(u,p,1)))}k=a;a=H;H=k;H.clear(!1)}k=g;q.L(h)}}this.a.ke(E);this.a.ke(p)}};a.prototype.sm=function(c,b){for(var d=new f.b,h=null,l=-1,q=0,v=this.od.size;q<v;q++){var a=this.od.get(q);if(-1!=a){var H=this.a.U(a);this.a.w(a,d);if(c?d.y==b:d.x==b)if(this.a.w(H,d),c?d.y==b:d.x==b)-1==l&&(l=this.a.Vd()),null==h&&(h=new f.ia(0),h.yb(100)),-2!=this.a.Sa(a,l)&&(h.add(a),this.a.Va(a,l,-2)),-2!=
this.a.Sa(H,l)&&(h.add(H),this.a.Va(H,l,-2))}}if(null==h)-1!=l&&this.a.ke(l);else{var F=this;h.Gd(0,h.size,function(b,d){return F.ki(b,d)});q=0;for(v=h.size;q<v;q++){var e=h.get(q);this.a.Va(e,l,q)}a=new f.b;H=new f.b;H.$c();for(var k=-1,q=0,v=h.size;q<v;q++)if(e=h.get(q),-1!=e&&(this.a.w(e,d),!d.ub(H))){if(-1!=k)for(;;){for(var e=!1,E=1<q-k?q-1:q,p=k;p<E;p++){var g=h.get(p);if(-1!=g){var n=-1,u=this.a.U(g);this.a.w(u,a);0>H.compare(a)&&(c?a.y==b:a.x==b)&&(n=u);var u=-1,z=this.a.Ra(g);this.a.w(z,
a);0>H.compare(a)&&(c?a.y==b:a.x==b)&&(u=z);if(-1!=n&&-1!=u)this.ii(g,h,l),this.a.td(g,!1),this.ii(n,h,l),this.a.td(n,!1),e=!0;else if(-1!=n||-1!=u){for(z=p+1;z<q;z++){var t=h.get(z);if(-1!=t){var r=this.a.U(t),A=-1;this.a.w(r,a);0>H.compare(a)&&(c?a.y==b:a.x==b)&&(A=r);var r=this.a.Ra(t),m=-1;this.a.w(r,a);0>H.compare(a)&&(c?a.y==b:a.x==b)&&(m=r);if(-1!=A&&-1!=m){this.ii(t,h,l);this.a.td(t,!1);this.ii(A,h,l);this.a.td(A,!1);e=!0;break}if(-1!=n&&-1!=m){this.nu(h,g,n,t,m,l);e=!0;break}else if(-1!=
u&&-1!=A){this.nu(h,t,A,g,u,l);e=!0;break}}}if(e)break}}}if(!e)break}k=q;H.L(d)}this.a.ke(l)}};a.prototype.ii=function(c,b,d){d=this.a.Sa(c,d);b.set(d,-1);d=this.a.Sa(c,this.Ki);this.od.set(d,-1);b=this.a.ld(c);-1!=b&&this.a.cb(b)==c&&(this.a.jg(b,-1),this.a.sh(b,-1))};a.prototype.nu=function(c,b,d,h,l,f){this.a.Kc(b,h);this.a.Lc(h,b);this.a.Lc(d,l);this.a.Kc(l,d);this.ii(h,c,f);this.a.Mi(h,!1);this.ii(l,c,f);this.a.Mi(l,!0)};a.prototype.Bz=function(){for(var c=0,b=this.od.size;c<b;c++){var d=this.od.get(c);
-1!=d&&this.a.Aj(d,-1)}for(var h=0,l=0,f=this.a.Pb(this.Y);-1!=f;){var v=this.a.cb(f);if(-1==v||f!=this.a.ld(v)){var a=f,f=this.a.Sb(f);this.a.jg(a,-1);this.a.Rr(a)}else{d=v;a=0;do this.a.Aj(d,f),a++,d=this.a.U(d);while(d!=v);this.a.Np(f,!1);this.a.sh(f,this.a.Ra(v));this.a.mk(f,a);l+=a;h++;f=this.a.Sb(f)}}c=0;for(b=this.od.size;c<b;c++)if(d=this.od.get(c),-1!=d&&(f=this.a.ld(d),-1==f)){f=this.a.Yf(this.Y,-1);a=0;v=d;do this.a.Aj(d,f),a++,d=this.a.U(d);while(d!=v);2>=a?(d=this.a.Sa(v,this.Ki),this.od.set(d,
-1),v=this.a.td(v,!1),2==a&&(d=this.a.Sa(v,this.Ki),0<=d&&this.od.set(d,-1),this.a.td(v,!1)),a=f,this.a.jg(a,-1),this.a.Rr(a)):(this.a.ao(f,!0),this.a.mk(f,a),this.a.jg(f,v),this.a.sh(f,this.a.Ra(v)),this.a.Np(f,!1),l+=a,h++)}this.a.wm(this.Y,h);this.a.kk(this.Y,l);c=0;for(b=this.a.rd;-1!=b;b=this.a.Ue(b))c+=this.a.D(b);this.a.yC(c)};a.We=function(c,b,d,h,l){return(new a(b,l)).gz(c,d,h)};a.clip=function(c,b,d,h,l){return a.rq(c,b,null,d,h,l)};a.rq=function(c,b,d,h,l,q){var v=c.G();if(33==v)return l=
c.w(),b.contains(l)?c:c.Ja();if(197==v)return l=new f.h,c.s(l),l.Ma(b)?(b=new f.ci,c.copyTo(b),b.Gp(l),b):c.Ja();if(c.u())return c;if(b.u())return c.Ja();var D=new f.h;c.ac(D);if(b.contains(D))return c;if(!b.Yb(D))return c.Ja();if(null!=d||isNaN(h))h=f.ma.Yy(d,b,!1);if(!f.T.gh(v))throw f.f.F();d=c.ob;if(null!=d&&(d=d.Hi,null!=d)){d=d.Sn(b);if(1==d){if(1736!=v)throw f.f.X("internal error");c=new f.Ia(c.description);c.oq(b);return c}if(0==d)return c.Ja()}switch(v){case 550:q=null;v=c.D();h=c.Pa(0);
d=0;l=new f.b;for(D=0;D<v;D++)h.fc(2*D,l),b.contains(l)||(0==d&&(q=c.Ja()),d<D&&q.Jd(c,d,D),d=D+1);0<d&&q.Jd(c,d,v);return 0==d?c:q;case 1736:case 1607:return a.We(c,b,h,l,q);default:throw f.f.X("internal error");}};a.prototype.ki=function(c,b){var d=new f.b;this.a.w(c,d);c=new f.b;this.a.w(b,c);return d.compare(c)};return a}();f.uh=a})(C||(C={}));(function(f){var a=new f.b,e=function(){function b(b,c,l,q,v){this.Dn=new f.b;this.fl=new f.b;this.oj=new f.b;this.a=b;this.ox=l;this.ap=q;this.Dn=c;this.dm=
v;this.fl.$c();this.oj.$c()}b.prototype.FF=function(b){this.a.w(b,this.fl);b=f.J.truncate((this.fl.x-this.Dn.x)*this.ap+.5);var d=f.J.truncate((this.fl.y-this.Dn.y)*this.ap+.5);return c.uH(b,d)};b.prototype.Uz=function(b){return this.a.Sa(b,this.dm)};b.prototype.yz=function(b,h){this.a.w(b,this.fl);this.a.w(h,this.oj);return c.ow(this.fl.x,this.fl.y,this.oj.x,this.oj.y,this.ox)};return b}();f.DZ=function(){return function(){}}();var c=function(){function b(){this.Dn=new f.b;this.dr=[0,0,0,0];this.st=
[0,0,0,0];this.ep=this.dm=-1}b.aS=function(d,c){var h=new b;h.a=d;h.ta=c;h.ox=c*c;h.Mw=2*c;h.ap=1/h.Mw;return h.DQ()};b.ow=function(b,c,l,f,v){b-=l;c-=f;return b*b+c*c<=v};b.uH=function(b,c){return f.J.dh(c,f.J.dh(b))};b.prototype.FQ=function(d,c){this.a.Nc(d,a);for(var h=(a.y-this.Dn.y)*this.ap,q=f.J.truncate((a.x-this.Dn.x)*this.ap),v=f.J.truncate(h),D=h=0;1>=D;D+=1)for(var H=0;1>=H;H+=1){var F=b.uH(q+D,v+H),e=this.cm.gT(F);-1!=e&&(this.dr[h]=e,this.st[h]=F,h++)}for(q=h-1;1<=q;q--)for(e=this.dr[q],
v=q-1;0<=v;v--)if(e==this.dr[v]){this.st[v]=-1;h--;q!=h&&(this.st[q]=this.st[h],this.dr[q]=this.dr[h]);break}for(v=0;v<h;v++)this.GQ(d,this.st[v],a,this.dr[v],c)};b.prototype.GQ=function(d,c,l,q,v){for(var h=new f.b;-1!=q;q=this.cm.wT(q)){var a=this.cm.ja(q);d==a||-1!=c&&this.a.Sa(a,this.dm)!=c||(this.a.Nc(a,h),b.ow(l.x,l.y,h.x,h.y,this.ox)&&v.add(q))}};b.prototype.Mn=function(b,c,l){var d=this.a.Sa(b,this.ep),h=this.a.Sa(c,this.ep);-1==d&&(d=this.Pd.mi(),this.Pd.addElement(d,b),this.a.Va(b,this.ep,
d));-1==h?this.Pd.addElement(d,c):this.Pd.lz(d,h);this.a.Va(c,this.ep,-2);c=this.VV(b,c);l&&(l=this.Xw.FF(b),this.a.Va(b,this.dm,l));return c};b.UV=function(d,c,l){d.Eb(c);l=d;var h=new f.b;b.EX(d.w(),c.w(),h);l.rb(h)};b.EX=function(b,c,l){var d=b.x;b.x!=c.x&&(d=(1*b.x+1*c.x)/2);var h=b.y;b.y!=c.y&&(h=(1*b.y+1*c.y)/2);l.ka(d,h)};b.prototype.VV=function(b,c){var d=new f.b;this.a.w(b,d);var h=new f.b;this.a.w(c,h);var v=this.a.nH(b);c=this.a.nH(c);var a=v+c,H=0,F=d.x;d.x!=h.x&&(F=(d.x*v+h.x*c)/a,H++);
var e=d.y;d.y!=h.y&&(e=(d.y*v+h.y*c)/a,H++);0<H&&this.a.rb(b,F,e);this.a.pY(b,a);return 0!=H};b.prototype.DQ=function(){var b=this.a.ud,c=this.a.SG();this.Dn=c.Xz();c=Math.max(c.fa(),c.N())/2147483646;this.Mw<c&&(this.Mw=c,this.ap=1/this.Mw);this.Pd=new f.Ku;this.Pd.ou(f.J.truncate(this.a.ud/3+1));this.Pd.Wn(f.J.truncate(this.a.ud/3+1));this.dm=this.a.Vd();this.ep=this.a.Vd();this.Xw=new e(this.a,this.Dn,this.ox,this.ap,this.dm);this.cm=new f.DM(f.J.truncate(4*b/3),this.Xw);this.cm.wX(this.a.ud);
b=!1;for(c=this.a.rd;-1!=c;c=this.a.Ue(c))for(var l=this.a.Pb(c);-1!=l;l=this.a.Sb(l))for(var q=this.a.cb(l),v=0,a=this.a.Ka(l);v<a;v++){var H=this.Xw.FF(q);this.a.Va(q,this.dm,H);this.cm.addElement(q,H);q=this.a.U(q)}var F=new f.ia(0);F.yb(10);for(c=this.a.rd;-1!=c;c=this.a.Ue(c))for(l=this.a.Pb(c);-1!=l;l=this.a.Sb(l))for(q=this.a.cb(l),v=0,a=this.a.Ka(l);v<a;v++){if(-2!=this.a.Sa(q,this.ep))for(H=this.a.Sa(q,this.dm),this.cm.kd(q,H);;){this.FQ(q,F);if(0==F.size)break;for(var H=!1,k=0,E=F.size;k<
E;k++){var p=F.get(k),g=this.cm.ja(p);this.cm.Ld(p);H=this.Mn(q,g,k+1==E)||H}b=b||H;F.clear(!1);if(!H)break}q=this.a.U(q)}b&&this.wP();this.Xw=this.cm=null;this.a.ke(this.dm);this.a.ke(this.ep);return b};b.prototype.wP=function(){for(var b=new f.b,c=this.Pd.Ge;-1!=c;c=this.Pd.aA(c)){var l=this.Pd.xc(c);this.a.w(this.Pd.ja(l),b);for(l=this.Pd.nb(l);-1!=l;l=this.Pd.nb(l))this.a.Qf(this.Pd.ja(l),b)}};return b}();f.Hu=c})(C||(C={}));(function(f){var a=function(){function a(c){void 0===c&&(c=null);this.Oe=
null;this.Fa=!1;null===c?this.Oe=[]:this.Oe=c}a.prototype.copyTo=function(c){if(c.Fa)throw f.f.X("CompositeGeographicTransformation is read-only");for(var b=0;b<this.Oe.length;b++)c.Oe.push(this.Oe[b].Vf())};a.prototype.count=function(){return this.Oe.length};a.prototype.iT=function(c){return this.Oe[c]};a.prototype.add=function(c){if(this.Fa)throw f.f.X("CompositeGeographicTransformation is read-only");this.Oe.push(c.Vf())};a.prototype.clear=function(){if(this.Fa)throw f.f.X("CompositeGeographicTransformation is read-only");
this.Oe.length=0};a.prototype.remove=function(c){if(this.Fa)throw f.f.X("CompositeGeographicTransformation is read-only");this.Oe.splice(c,1)};a.prototype.Vv=function(){for(var c=this.ne(),b=0;b<c.count();b++)c.iT(b).jt();c.Oe=c.Oe.reverse();return c};a.prototype.ne=function(){var c=new a;this.copyTo(c);return c};a.prototype.Vf=function(){return this.ne()};a.prototype.transform=function(c,b,d,h){if(c.length<b)throw f.f.X("invalid Argument");var l=d;for(d=0;d<this.Oe.length;d++){var q=this.Oe[d];if(null!=
q.dn()){var v=q.on,a=v?1:0,H=v?q.dn().getGeogcs2():q.dn().getGeogcs1(),H=H.getUnit().getUnitFactor(),H=l/H;if(3.552713678800501E-15<Math.abs(H-1))for(l=0;l<b;l++)c[l][0]*=H,c[l][1]*=H;f.OD.geogToGeog(q.dn(),b,c,null,a);l=(v?q.dn().getGeogcs1():q.dn().getGeogcs2()).getUnit().getUnitFactor()}}H=l/h;if(3.552713678800501E-15<Math.abs(H-1))for(l=0;l<b;l++)c[l][0]*=H,c[l][1]*=H;return b};a.prototype.getName=function(){if(0==this.Oe.length)return"";for(var c="",b=0,d=this.Oe.length;b<d;++b)""!==c&&(c+=" + "),
c+=this.Oe[b].getName();return c};a.prototype.Eb=function(c){if(c==this)return!0;if(!(c instanceof a)||this.Oe.length!=c.Oe.length)return!1;for(var b=0;b<this.Oe.length;b++)if(!this.Oe[b].Eb(c.Oe[b]))return!1;return!0};a.prototype.Mp=function(){this.Fa=!0};a.prototype.toString=function(){var c=toString();return 200<c.length?c.substring(0,197)+"... ("+c.length.toString()+" characters)":c};a.create=function(){return new a};a.aq=function(c,b){var d=new a;d.add(f.io.create(c,b));return d};a.bq=function(c,
b){var d=new a;d.add(f.io.eG(c,b));return d};return a}();f.my=a})(C||(C={}));(function(f){var a=Math.PI,e=2*Math.PI,c=Math.PI/2,b=function(){function b(){}b.VQ=function(d,c){var h=new b;h.x=d;h.y=c;h.type=0;h.ui=0;return h};b.El=function(d){var c=new b;c.x=d.x;c.y=d.y;c.type=0;c.ui=0;return c};b.UQ=function(d){var c=new b;c.x=d.x;c.y=d.y;c.type=d.type;c.ui=d.ui;return c};b.ce=function(d,c,h){var l=new b;l.x=d.x+c*Math.cos(h);l.y=d.y+c*Math.sin(h);l.type=d.type;l.ui=d.ui;return l};b.Cv=function(d,
c){var h=new b;h.x=.5*(d.x+c.x);h.y=.5*(d.y+c.y);h.type=d.type;h.ui=d.ui;return h};b.YF=function(d,c){var h=new b;h.x=d.x+.001*(c.x-d.x);h.y=d.y+.001*(c.y-d.y);h.type=d.type;h.ui=d.ui;return h};return b}(),d=function(){return function(){}}();(function(b){b[b.Round=0]="Round";b[b.Bevel=1]="Bevel";b[b.Miter=2]="Miter";b[b.Square=3]="Square"})(f.IM||(f.IM={}));var h=function(){function h(b){this.rB=this.$b=this.Sg=null;this.je=b}h.V=function(b,d,c,l,a,e){if(null==b)throw f.f.F();if(1>b.tb())throw f.f.F();
if(0==d||b.u())return b;e=new h(e);e.Yo=b;e.Qa=d;e.ta=a;e.jj=c;e.hB=l;return e.zy()};h.prototype.yO=function(){var b=this.Yo,d=b.ec(),c=b.Cc(),h=new f.b;h.zc(c,d);h.normalize();h.tw();h.scale(this.Qa);d.add(h);c.add(h);h=b.Ja();b.Mc(d);b.Zc(c);return h};h.prototype.xO=function(){var b=this.Yo;if(0<this.Qa&&2!=this.jj){var d=new f.Ia;d.jd(b,!1);this.Yo=d;return this.zy()}b=new f.ci(b.R);b.O(this.Qa,this.Qa);return b};h.prototype.jK=function(b,d,c,h){return(d.x-b.x)*(h.x-c.x)+(d.y-b.y)*(h.y-c.y)};h.prototype.pc=
function(d,h){if(void 0===h)this.$b.push(d),this.Kf++;else if(0==this.Kf)this.pc(d);else{var l=this.px,f,q;f=this.Sg[0==h?l-1:h-1];q=this.Sg[h];var v=this.jK(f,q,this.$b[this.Kf-1],d);0<v?this.pc(d):0>v&&(0<this.jK(f,q,q,this.$b[this.Kf-1])?(q=this.Sg[0==h?l-2:1==h?l-1:h-2],l=b.ce(f,this.Qa,Math.atan2(f.y-q.y,f.x-q.x)-c),this.$b[this.Kf-1]=l,1==this.jj||2==this.jj?(l=b.Cv(l,f),this.pc(l),l=b.ce(f,this.Qa,this.vw+c),f=b.Cv(l,f),f.type|=256,this.pc(f)):(l=b.ce(f,this.Qa,this.vw+c),l.type|=256),this.pc(l),
this.pc(d,h)):(l=b.ce(q,this.Qa,this.vw+c),this.pc(l),1==this.jj||2==this.jj?(l=b.Cv(l,q),this.pc(l),l=b.ce(q,this.Qa,this.IA-c),f=b.Cv(l,q),f.type|=256,this.pc(f)):(l=b.ce(q,this.Qa,this.IA-c),l.type|=256),this.pc(l)))}};h.prototype.yF=function(){var d,h,l,H,F,k,p=this.px;this.Kf=0;var E=.5*this.ta,g=0,n=0;for(d=0;d<p;d++){H=this.Sg[d];F=0==d?this.Sg[p-1]:this.Sg[d-1];k=d==p-1?this.Sg[0]:this.Sg[d+1];var u=F.x-H.x,z=F.y-H.y,t=k.x-H.x,r=k.y-H.y;h=Math.atan2(z,u);l=Math.atan2(r,t);this.vw=h;this.IA=
l;0==d&&(g=h,n=l);u=u*r-t*z;z=l;l<h&&(l+=e);if(0<u*this.Qa)1==this.jj||2==this.jj?(h=b.ce(H,this.Qa,h+c),this.pc(h),h=b.YF(H,h),this.pc(h),h=b.ce(H,this.Qa,l-c),H=b.YF(H,h),H.type|=256,this.pc(H),this.pc(h)):(u=.5*(l-h),u=this.Qa/Math.abs(Math.sin(u)),h=b.ce(H,u,.5*(h+l)),this.pc(h,d));else if(0!=(H.type&512)){u=1-E/Math.abs(this.Qa);F=1;k=0>this.Qa?-a:a;-1<u&&1>u&&(z=2*Math.acos(u),.017453292519943295>z&&(z=.017453292519943295),F=f.J.truncate(a/z+1.5),1<F&&(k/=F));z=h+c;h=b.ce(H,this.Qa,z);0==d&&
(h.type|=1024);this.pc(h,d);u=this.Qa/Math.cos(k/2);z+=k/2;h=b.ce(H,u,z);h.type|=1024;for(this.pc(h);0<--F;)z+=k,h=b.ce(H,u,z),h.type|=1024,this.pc(h);h=b.ce(H,this.Qa,l-c);h.type|=1024;this.pc(h)}else if(1==this.jj)h=b.ce(H,this.Qa,h+c),this.pc(h,d),h=b.ce(H,this.Qa,l-c),this.pc(h);else if(0==this.jj)for(u=1-E/Math.abs(this.Qa),F=1,k=l-c-(h+c),-1<u&&1>u&&(z=2*Math.acos(u),.017453292519943295>z&&(z=.017453292519943295),F=f.J.truncate(Math.abs(k)/z+1.5),1<F&&(k/=F)),u=this.Qa/Math.cos(.5*k),z=h+c+
.5*k,h=b.ce(H,u,z),this.pc(h,d);0<--F;)z+=k,h=b.ce(H,u,z),this.pc(h);else 2==this.jj?(u=F.x-H.x,z=F.y-H.y,t=k.x-H.x,r=k.y-H.y,F=(u*t+z*r)/Math.sqrt(u*u+z*z)/Math.sqrt(t*t+r*r),.99999999<F?(h=b.ce(H,1.4142135623730951*this.Qa,l-.25*a),this.pc(h,d),h=b.ce(H,1.4142135623730951*this.Qa,l+.25*a),this.pc(h)):(F=Math.abs(this.Qa/Math.sin(.5*Math.acos(F))),k=Math.abs(this.hB*this.Qa),F>k?(u=.5*(l-h),u=this.Qa/Math.abs(Math.sin(u)),h=b.ce(H,u,.5*(h+l)),l=f.b.pa(h.x,h.y),h=f.b.pa(H.x,H.y),H=new f.b,H.zc(l,
h),l=new f.b,l.DX(k/H.length(),H,h),h=(F-k)*Math.abs(this.Qa)/Math.sqrt(F*F-this.Qa*this.Qa),0<this.Qa?H.tw():H.Tr(),H.scale(h/H.length()),h=new f.b,h.add(l,H),F=new f.b,F.zc(l,H),h=b.El(h),this.pc(h,d),h=b.El(F),this.pc(h)):(u=.5*(l-h),u=this.Qa/Math.abs(Math.sin(u)),h=b.ce(H,u,.5*(h+l)),this.pc(h,d)))):(l=z,0<this.Qa?(l>h&&(l-=e),F=h-l<c):(l<h&&(l+=e),F=l-h<c),F?(u=1.4142135623730951*this.Qa,z=0>u?h+.25*a:h+.75*a,h=b.ce(H,u,z),this.pc(h,d),z=0>u?l-.25*a:l-.75*a,h=b.ce(H,u,z),this.pc(h)):(u=.5*(l-
h),u=this.Qa/Math.abs(Math.sin(u)),l<h&&(l+=e),h=b.ce(H,u,(h+l)/2),this.pc(h,d)))}this.vw=g;this.IA=n;this.pc(this.$b[0],0);H=b.UQ(this.$b[this.Kf-1]);this.$b[0]=H;return this.sX()};h.prototype.jv=function(b,d){if(!(2>d))for(var c=0;c<d;c++){var h=this.$b[b+c];0!=c?this.rB.aj(f.b.pa(h.x,h.y)):this.rB.yu(f.b.pa(h.x,h.y))}};h.prototype.zO=function(d,c,h){var l=d.wa(c),f=d.Gc(c);this.$b=[];this.rB=h;if(d.Qb(c)){for(c=d.Aa(l);d.Aa(f-1).ub(c);)f--;if(2<=f-l){this.px=f-l;this.Sg=[];for(c=l;c<f;c++)this.Sg.push(b.El(d.Aa(c)));
this.yF()&&this.jv(0,this.Kf-1)}}else{for(c=d.Aa(l);l<f&&d.Aa(l+1).ub(c);)l++;for(c=d.Aa(f-1);l<f&&d.Aa(f-2).ub(c);)f--;if(2<=f-l){this.px=2*(f-l)-2;this.Sg=[];h=b.El(d.Aa(l));h.type|=1536;this.Sg.push(h);for(c=l+1;c<f-1;c++)h=b.El(d.Aa(c)),this.Sg.push(h);h=b.El(d.Aa(f-1));h.type|=512;this.Sg.push(h);for(c=f-2;c>=l+1;c--)h=b.El(d.Aa(c)),h.type|=1024,this.Sg.push(h);if(this.yF())if(2<=this.$b.length){d=-1;(f=0!=(this.$b[this.Kf-1].type&1024))||(d=0);for(c=1;c<this.Kf;c++)(l=0!=(this.$b[c].type&1024))?
f||(f=c-1,1<f-d+1&&this.jv(d,f-d+1)):f&&(d=c-1),f=l;f||(f=this.Kf-1,1<f-d+1&&this.jv(d,f-d+1))}else d=0,f=this.Kf-1,0<=d&&1<=f-d&&this.jv(d,f-d+1)}}this.Sg=null;this.px=0;this.$b=null;this.Kf=0};h.prototype.sX=function(){for(var b=!1,d=0;d<this.Kf;d++){var c=this.$b[d];c.Nh=d+1;c.Qh=d-1;this.$b[d]=c}c=this.$b[0];c.Qh=this.Kf-2;this.$b[0]=c;c=this.$b[this.Kf-2];c.Nh=0;this.$b[this.Kf-2]=c;for(d=c=0;d<this.Kf;d++)if(0!=(this.$b[c].type&256)){var h=this.BR(c);if(-1!=h)c=h;else{b=!0;break}}else c=this.$b[c].Nh;
if(b)return!1;this.SQ(c);return!0};h.prototype.BR=function(b){for(var d=this.Kf-1,c=b,h,l,f=1;f<=d-2;f++){h=c=this.$b[c].Nh;l=b;for(var q=1;q<=f;q++){l=this.$b[l].Qh;if(0==(this.$b[l].type&256)&&0==(this.$b[h].type&256)){var a=this.$T(l,h);if(-1!=a)return a}h=this.$b[h].Qh}}return-1};h.prototype.$T=function(b,c){var h,l,q,v;h=this.$b[this.$b[b].Qh];l=this.$b[b];q=this.$b[this.$b[c].Qh];v=this.$b[c];if(!this.HX(h,l,q,v))return-1;var a=new d;return this.oS(h,l,q,v,a)&&!a.nF&&f.J.RK((l.x-h.x)*(v.y-q.y)-
(l.y-h.y)*(v.x-q.x))!=f.J.RK(this.Qa)?(h=this.$b[b].Qh,a.Qn.type=l.type,a.Qn.Nh=c,a.Qn.Qh=h,this.$b[b]=a.Qn,a.Qn=this.$b[c],a.Qn.Qh=b,this.$b[c]=a.Qn,c):-1};h.prototype.HX=function(b,d,c,h){return Math.max(b.x,d.x)>=Math.min(c.x,h.x)&&Math.max(c.x,h.x)>=Math.min(b.x,d.x)&&Math.max(b.y,d.y)>=Math.min(c.y,h.y)&&Math.max(c.y,h.y)>=Math.min(b.y,d.y)};h.prototype.oS=function(d,c,h,l,f){f.nF=!1;var q,v,a;q=(c.y-d.y)*(l.x-h.x)-(c.x-d.x)*(l.y-h.y);v=(h.y-d.y)*(c.x-d.x)-(h.x-d.x)*(c.y-d.y);q=0==q?2:v/q;return 0<=
q&&1>=q&&(a=q,q=(l.y-h.y)*(c.x-d.x)-(l.x-h.x)*(c.y-d.y),v=(d.y-h.y)*(l.x-h.x)-(d.x-h.x)*(l.y-h.y),q=0==q?2:v/q,0<=q&&1>=q)?(f.Qn=b.VQ(d.x+q*(c.x-d.x),d.y+q*(c.y-d.y)),f.Qn.ui=h.ui+a*(l.ui-h.ui),0!=a&&1!=a||0!=q&&1!=q||(f.nF=!0),f.N_=q,f.O_=a,(0==a||1==a)&&0<q&&1>q||(0==q||1==q)&&0<a&&1>a?!1:!0):!1};h.prototype.SQ=function(b){for(;this.$b[b].Qh<b;)b=this.$b[b].Qh;var d=0,c=b;do c=this.$b[c],this.$b[d]=c,c=c.Nh,d++;while(c!=b);this.$b[d]=this.$b[0];this.Kf=d+1};h.prototype.uE=function(b){var d=this.Yo,
c=d.Da();if(null!=c){c.yj();for(var h=-1;c.Ya();)h++,this.zO(d,h,b)}};h.prototype.zy=function(){var b=this.Yo.G();return 322==b?this.yO():197==b?this.xO():f.T.Oc(b)?(b=new f.Ua,b.dc(this.Yo,!0),this.Yo=b,this.zy()):1607==b?(b=new f.Ua,this.uE(b),b):1736==b?(b=new f.Ia,this.uE(b),b):null};return h}();f.SL=h})(C||(C={}));(function(f){var a=function(){function b(b){this.Sk=b}b.prototype.w=function(b,d){this.Sk.a.w(b,d)};b.prototype.Ld=function(b){var d=this.Sk.Na.ja(b);this.Sk.Na.Ld(b,-1);this.Sk.a.td(d,
!1)};return b}(),e=function(){function b(b){this.Sk=b}b.prototype.w=function(b,d){this.Sk.FV.w(b,d)};b.prototype.Ld=function(b){this.Sk.Na.Ld(b,-1)};return b}(),c=function(){function b(b){this.Sk=b}b.prototype.w=function(b,d){d.L(this.Sk.IV[b])};b.prototype.Ld=function(b){this.Sk.Na.Ld(b,-1)};return b}(),b=function(){function b(b){void 0===b?(this.Na=new f.tk,this.Na.Qe(20),this.a=new f.fd,this.wV=this.a.bh(550),this.Mt=this.a.Yf(this.wV,-1),this.wi=new a(this)):b instanceof Array?(this.Na=new f.tk,
this.Na.Qe(20),this.IV=b,this.wi=new c(this)):(this.Na=new f.tk,this.Na.Qe(20),this.FV=b,this.wi=new e(this))}b.prototype.Jb=function(b){var d=b.G();if(f.Lu.gh(d))this.gP(b);else if(f.xl.Oc(d))this.nP(b);else if(197==d)this.dP(b);else if(33==d)this.kP(b);else throw f.f.F("invalid shape type");};b.prototype.TS=function(){var b=new f.Wa,d=this.Na.xc(-1),c=new f.Ia(this.a.Gr);this.a.wj(this.Na.ja(d),b);c.Rf(b);for(d=this.Na.nb(d);-1!=d;d=this.Na.nb(d))this.a.wj(this.Na.ja(d),b),c.lineTo(b);return c};
b.TQ=function(d){var c=new b(d),h=d.D(),v=1,a=new f.b,e=new f.b,F=new f.b;for(d.w(0,a);;){d.w(v,e);if(!(e.vA(a)&&v<h-1))break;v++}c.Na.addElement(0,-1);c.Na.ro(v);for(h=v+1;h<d.D();h++)d.w(h,F),v=c.NC(F),-1!=v&&c.Na.jk(v,h);F=new f.Wa;v=c.Na.xc(-1);h=new f.Ia(d.description);d.Ae(c.Na.ja(v),F);h.Rf(F);for(v=c.Na.nb(v);-1!=v;v=c.Na.nb(v))d.Ae(c.Na.ja(v),F),h.lineTo(F);return h};b.pa=function(d,c,f){for(var h=new b(d),l=1,q=d[0];d[l].vA(q)&&l<c-1;)l++;h.Na.addElement(0,-1);h.Na.ro(l);for(l+=1;l<c;l++)q=
h.NC(d[l]),-1!=q&&h.Na.jk(q,l);d=0;for(c=h.Na.xc(-1);-1!=c;c=h.Na.nb(c))f[d++]=h.Na.ja(c);return d};b.UH=function(d,c){var h=d.wa(c),l=d.Gc(c);c=!d.Qb(c)&&d.Eo(c);d=d.Pa(0);h*=2;l*=2;c&&(l-=2);if(6>l-h)return!0;c=new f.b;var a=new f.b,e=new f.b;d.fc(h,c);d.fc(h+2,a);d.fc(h+4,e);var F=b.ee(a,e,c);if(F.kt()||!b.uc(F.value()))return!1;for(var k=f.b.pa(a.x,a.y),p=new f.b,h=h+6;h<l;h+=2){p.L(a);a.L(e);d.fc(h,e);F=b.ee(a,e,c);if(F.kt()||!b.uc(F.value()))return!1;F=b.ee(k,e,c);if(F.kt()||!b.uc(F.value()))return!1;
F=b.ee(a,e,p);if(F.kt()||!b.uc(F.value()))return!1}return!0};b.prototype.gP=function(b){for(var d=new f.Wa,c=new f.b,h=0;h<b.D();h++){b.w(h,c);var a=this.zs(c);if(-1!=a){b.Ae(h,d);var e=this.a.pc(this.Mt,d);this.Na.jk(a,e)}}};b.prototype.dP=function(b){for(var d=new f.Wa,c=new f.b,h=0;4>h;h++){b.Fx(h,c);var a=this.zs(c);if(-1!=a){b.ig(h,d);var e=this.a.pc(this.Mt,d);this.Na.jk(a,e)}}};b.prototype.nP=function(b){var d=new f.Wa,c=b.ec(),c=this.zs(c);if(-1!=c){b.Dp(d);var h=this.a.pc(this.Mt,d);this.Na.jk(c,
h)}c=b.Cc();c=this.zs(c);-1!=c&&(b.Bp(d),b=this.a.pc(this.Mt,d),this.Na.jk(c,b))};b.prototype.kP=function(b){var d=b.w(),d=this.zs(d);-1!=d&&(b=this.a.pc(this.Mt,b),this.Na.jk(d,b))};b.prototype.zs=function(b){var d=-1;if(0==this.Na.size(-1))return d=this.Na.addElement(-4,-1);if(1==this.Na.size(-1)){var c=this.a.Aa(this.Na.ja(this.Na.xc(-1)));b.vA(c)||(d=this.Na.ro(-5));return d}return d=this.NC(b)};b.prototype.NC=function(d){var c=-1,h=this.Na.xc(-1),v=this.Na.Fc(-1),a=this.Na.ja(h),e=this.Na.ja(v),
F=new f.b,k=new f.b;this.wi.w(a,F);this.wi.w(e,k);a=f.b.zp(k,d,F);if(b.uc(a))c=this.Na.ro(-1),F=this.LC(d,v,h),F!=h&&this.MC(d,h,this.Na.Ve(F));else if(b.vl(a)){for(var k=this.Na.ew(-1),p=this.Na.xc(-1),E=this.Na.Fc(-1),g,a=new f.b,e=new f.b;p!=this.Na.Ve(E);)g=this.Na.ja(k),this.wi.w(g,a),g=f.b.zp(a,d,F),b.vl(g)?(E=k,k=this.Na.Pl(k)):(p=k,k=this.Na.Nq(k));k=E;F=p;g=this.Na.ja(k);p=this.Na.ja(F);this.wi.w(g,a);this.wi.w(p,e);if(F==h||(a=f.b.zp(e,d,a),b.uc(a)))c=this.Na.iv(F,k,-2,!1),this.MC(d,k,v),
this.LC(d,F,h)}else null==this.wb&&(this.wb=new f.Hb),this.wb.Mc(k),this.wb.Zc(F),F=this.wb.oe(d,!0),0>F?(F=this.Na.Ve(v),this.Na.Ld(v,-1),c=this.Na.ro(-3),this.LC(d,F,h)):1<F&&(F=this.Na.nb(h),this.Na.Ld(h,-1),c=this.Na.iv(-1,F,-3,!1),this.MC(d,F,v));return c};b.prototype.MC=function(d,c,q){if(c!=q){var h=this.Na.ja(c),l=this.Na.nb(c),a=new f.b,e=new f.b;for(this.wi.w(h,a);c!=q&&2<this.Na.size(-1);){this.wi.w(this.Na.ja(l),e);h=f.b.zp(e,d,a);if(b.uc(h))break;h=c;c=l;a.L(e);l=this.Na.nb(c);this.wi.Ld(h)}}};
b.prototype.LC=function(d,c,q){if(c==q)return q;var h=this.Na.ja(c),l=this.Na.Ve(c),a=new f.b,e=new f.b;for(this.wi.w(h,a);c!=q&&2<this.Na.size(-1);){this.wi.w(this.Na.ja(l),e);h=f.b.zp(a,d,e);if(b.uc(h))break;h=c;c=l;a.L(e);l=this.Na.Ve(c);this.wi.Ld(h)}return c};b.ee=function(b,d,c){var h=new f.Xb;h.set(d.x);h.sub(b.x);var l=new f.Xb;l.set(c.y);l.sub(b.y);var q=new f.Xb;q.set(d.y);q.sub(b.y);d=new f.Xb;d.set(c.x);d.sub(b.x);h.Vg(l);q.Vg(d);h.sub(q);return h};b.uc=function(b){return 0>b};b.vl=function(b){return 0<
b};b.hq=function(b){return 0==b};return b}();f.Iu=b})(C||(C={}));(function(f){var a=function(){function a(c){this.je=this.a=null;this.EI=!0;this.je=c}a.xJ=function(c,b,d){c=f.ma.Bs(c);return f.Hu.ow(b.Be(),b.nf(),d.Be(),d.nf(),f.Ub.Xx(c))};a.EQ=function(c,b){var d=new f.Wa;f.Hu.UV(c,b,d);return d};a.V=function(c,b,d,h){d=new a(d);d.a=c;d.ta=b;d.EI=h;return d.KO()};a.prototype.EO=function(c){return f.Hu.aS(this.a,c)};a.prototype.HO=function(c){return f.Ju.V(this.a,c,this.je)};a.prototype.KO=function(){for(var c=
this.ta,b=f.ma.Bs(c),c=f.ma.qP(c),d=1.00001*c,c=1.000001*c,h=!1,l=30<this.a.ud+10?1E3:(this.a.ud+10)*(this.a.ud+10),q=0,v=this.a.cU();;q++){if(q>l)throw f.f.X("Internal Error: max number of iterations exceeded");var a=this.EO(b),h=h||a;this.EI&&(a=0!=this.a.zq(b,!0,!1),h=h||a);a=!1;if(0==q||v||f.Ju.sJ(!0,this.a,c,null,this.je))a=this.HO(d),h=h||a;if(!a)break}return h};return a}();f.rk=a})(C||(C={}));(function(f){var a=function(){function c(b){this.we=this.Tc=null;this.jx=0;this.lc=b;this.KA=!0}c.prototype.fw=
function(b,d){var c=this.a.ic(b);if(null==c){if(!this.a.pd(b,d))return null;c=d}return c};c.prototype.Or=function(b){void 0===b&&(b=!1);this.jx++;if(b||0==(this.jx&4095))this.jx=0};c.prototype.lR=function(){var b=this.a.Pr(!1),d=!1,c=new f.Hb,l=new f.Hb,q=new f.h;q.Oa();var v=new f.h;v.Oa();for(var a=new f.Wa,e=new f.cE,F=b.next();-1!=F;F=b.next()){var k=null,p=!1;if(!f.T.Jo(this.a.hc(b.Bk))){k=this.fw(F,c);if(null==k)continue;k.s(q);q.O(this.ta,this.ta);if(k.fh(this.ta))if(k.fh(0))p=!0,k=null;else continue}var E=
this.a.Pr(b),g=E.next();for(-1!=g&&(g=E.next());-1!=g;g=E.next()){var n=null,u=!1;if(!f.T.Jo(this.a.hc(E.Bk))){n=this.fw(g,l);if(null==n)continue;n.s(v);if(n.fh(this.ta))if(n.fh(0))u=!0,n=null;else continue}var z=0,t=0;if(null!=k&&null!=n)q.SH(v)&&(e.Ap(k),e.Ap(n),e.Ma(this.ta,!1),z=e.Rl(0),t=e.Rl(1),0<z+t&&(this.a.as(F,e,0,!0),this.a.as(g,e,1,!0)),e.clear());else if(null!=k){var r=new f.b;this.a.w(g,r);if(q.contains(r)){e.Ap(k);this.a.wj(g,a);e.rA(this.ta,a,!1);z=e.Rl(0);if(0<z)if(this.a.as(F,e,
0,!0),u){u=-1;for(r=this.a.U(g);-1!=r&&r!=g&&(n=this.fw(r,l),u=r,null!=n&&n.fh(0));r=this.a.U(r));for(r=g;-1!=r&&(this.a.Yh(r,e.cg),r!=u);r=this.a.U(r));}else this.a.Yh(g,e.cg);e.clear()}}else if(null!=n){if(r=new f.b,this.a.w(F,r),v.O(this.ta,this.ta),v.contains(r)){e.Ap(n);this.a.wj(F,a);e.rA(this.ta,a,!1);t=e.Rl(0);if(0<t)if(this.a.as(g,e,0,!0),p){u=-1;for(r=this.a.U(F);-1!=r&&r!=F&&(n=this.fw(r,l),u=r,null!=n&&n.fh(0));r=this.a.U(r));for(r=F;-1!=r&&(this.a.Yh(r,e.cg),r!=u);r=this.a.U(r));}else this.a.Yh(F,
e.cg);e.clear()}}else continue;if(0!=z+t){if(0!=z){k=this.a.ic(F);if(null==k){if(!this.a.pd(F,c))continue;k=c;c.s(q)}else k.s(q);if(k.fh(this.ta))break}d=!0}}}return d};c.prototype.mR=function(){return this.BW()};c.prototype.BW=function(){return(new f.VD).HY(this.a,this.ta)};c.prototype.tJ=function(){var b=!1,d,c;null==this.Tc&&(this.Tc=new f.tk);var l=new f.ia(0);l.yb(this.a.ud+1);for(var q=this.a.Pr(),v=q.next();-1!=v;v=q.next())l.add(v);this.a.Wx(l,l.size);l.add(-1);q=this.a.Vd();v=this.a.Vd();
this.we=new f.eE(this.a,this.ta,!this.KA);this.Tc.Ep(this.we);var a=new f.ia(0),e=new f.ia(0),F=0;new f.b;var k=this.a.Dd;this.a.xb.tc();for(var p=this.a.xb.xa[0].g,E,g,n=l.get(F++);-1!=n;){g=k.S(n,0);E=p[2*g];g=p[2*g+1];var u=E,z=g;do{var r=k.S(n,2),t=k.S(n,1);-1!=r&&(d=k.S(r,0),c=p[2*d],d=p[2*d+1],0>(z<d?-1:z>d?1:u<c?-1:u>c?1:0)&&(e.add(n),e.add(r)));-1!=t&&(d=k.S(t,0),c=p[2*d],d=p[2*d+1],0>(z<d?-1:z>d?1:u<c?-1:u>c?1:0)&&(e.add(t),e.add(t)));c=this.a.Sa(n,q);-1!=c&&(a.add(c),this.a.Va(n,q,-1));
c=this.a.Sa(n,v);-1!=c&&(a.add(c),this.a.Va(n,v,-1));n=l.get(F++);-1!==n&&(z=k.S(n,0),u=p[2*z],z=p[2*z+1])}while(-1!=n&&u===E&&z===g);u=1==a.size&&2==e.size;c=z=-1;r=0;for(t=a.size;r<t;r++){d=a.get(r);var A=this.Tc.Ve(d);-1==A||a.mA(A)||(z=A);d=this.Tc.nb(d);-1==d||a.mA(d)||(c=d);if(-1!=z&&-1!=c)break}this.we.PK(g,E);r=0;for(t=a.size;r<t;r++)d=a.get(r),this.Tc.Ld(d,-1);a.clear(!1);if(!u&&-1!=z&&-1!=c&&this.sQ(z,c)){b=!0;this.mj=this.we.fn();break}r=0;for(t=e.size;r<t;r+=2){g=e.get(r);E=e.get(r+1);
u?(g=this.Tc.iv(z,c,g,!0),u=!1):g=this.Tc.addElement(g,-1);if(this.we.Ng){this.mj=this.we.fn();b=!0;break}-1==this.a.Sa(E,q)?this.a.Va(E,q,g):this.a.Va(E,v,g)}if(b)break;e.yf(0)}this.a.ke(q);this.a.ke(v);return b};c.prototype.sQ=function(b,d){this.we.compare(this.Tc,this.Tc.ja(b),d);b=this.we.Ng;this.we.Fs();return b};c.Cj=function(b){for(var d=b.rd;-1!=d;d=b.Ue(d))if(f.T.Ic(b.hc(d)))return!0;return!1};c.Hm=function(b,d,h,l){if(!c.Cj(b))return!1;d=new c(l);d.a=b;d.ta=h;if(15>b.ud)b=d.lR();else return d.mR();
return b};c.V=function(b,d,h){return c.Hm(b,b.SG(),d,h)};c.sJ=function(b,d,h,l,q){if(!c.Cj(d))return!1;var v=new c(q);v.a=d;v.ta=h;v.KA=b;if(v.tJ())return null!=l&&l.ls(v.mj),!0;var a=new f.Hd;a.wC();d.Xc(a);v=new c(q);v.a=d;v.ta=h;v.KA=b;b=v.tJ();a.wC();d.Xc(a);return b?(null!=l&&l.ls(v.mj),!0):!1};c.qm=function(b,d){b=b.D();return 16>b?!1:2*b+Math.log(b)*Math.LOG10E/Math.log(2)*1*d<1*b*d};c.jR=function(b,d,h,l){if(f.T.Ic(d.G()))return(new c(l)).kR(b,d,h);throw f.f.X("crack_A_with_B");};c.prototype.kR=
function(b,d,h){var l=new f.h;b.ac(l);var q=new f.h;d.ac(q);q.O(h,h);if(!q.Yb(l))return b;var v=b.ob,a=null;null!=v&&(a=v.Mb);c.qm(b,b.D())&&(a=f.ma.Lj(b,q));var k=null!=a?a.mf():null,F=d.Da();d=b.Da();for(var p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=[];F.Ya();)for(;F.Ca();){var E=F.ba();if(null!=a)for(k.Xn(E,h),v=k.next();-1!=v;v=k.next()){if(this.Or(),d.Tb(a.ja(v),-1),d.Ca())for(var v=d.ba(),g=v.Ma(E,null,p,null,h),v=0;v<g;++v){var n=p[v];if(0!=n&&1!=n){var u=d.Db(),z=new e;z.t=n;z.index=u;q.push(z)}}}else{var r=
new f.h;E.ac(r);r.O(h,h);if(l.Yb(r))for(d.yj();d.Ya();)for(;d.Ca();)if(this.Or(),v=d.ba(),n=new f.h,v.ac(n),n.Yb(r))for(g=v.Ma(E,null,p,null,h),v=0;v<g;++v)n=p[v],0!=n&&1!=n&&(u=d.Db(),z=new e,z.t=n,z.index=u,q.push(z))}}if(0==q.length)return b;q=q.sort(e.Gs);b=b.Ja();for(d.yj();d.Ya()&&!d.Ca(););h=d.ba();l=new f.Cg;a=-1;v=0;for(k=q.length;v<k;){p=q[v].index;for(F=v+1;F<k&&q[F].index==p;)++F;for(;d.Db()<p;){this.Or();E=d.Ca();n=d.Ta;(r=E||!d.Fo()||d.Go())&&b.dc(h,a!=n);a=n;if(!E)for(;d.Ya()&&!d.Ca(););
h=d.ba()}for(p=0;v<F;v++)n=q[v].t,n!=p&&(h.yh(p,n,l),p=n,n=d.Ta,b.dc(l.get(),a!=n),a=n);if(r=(E=d.Ca())||!d.Fo()||d.Go())h.yh(p,1,l),b.dc(l.get(),!1);if(E)h=d.ba();else{for(;d.Ya()&&!d.Ca(););d.Ca()?h=d.ba():h=null}v=F}null!=h&&(n=d.Ta,(r=(E=d.Ca())||!d.Fo()||d.Go())&&b.dc(h,a!=n),a=n);for(E=d.Ca();;){if(!E){for(;d.Ya()&&!(E=d.Ca()););if(!E)break}h=d.ba();n=d.Ta;(r=(E=d.Ca())||!d.Fo()||d.Go())&&b.dc(h,a!=n);a=n}return b};return c}();f.Ju=a;var e=function(){function c(){}c.Gs=function(b,d){return b.index==
d.index?b.t>d.t?1:b.t<d.t?-1:0:b.index>d.index?1:-1};return c}()})(C||(C={}));(function(f){(function(b){b[b.Left=0]="Left";b[b.Right=1]="Right";b[b.Coincident=2]="Coincident";b[b.Undefined=3]="Undefined";b[b.Uncut=4]="Uncut"})(f.UL||(f.UL={}));var a=function(){return function(b,c,l,f,v,a,e,F,k,p,E){this.Y=b;this.mx=c;this.Ht=l;this.Pg=f;this.zn=p;this.em=E}}();f.FZ=a;var e=function(){function b(b,d){this.XI=b;this.gj=d}b.prototype.GO=function(b,d){var c=new f.b;this.gj.w(b,c);var h=new f.b;this.gj.w(d,
h);c=c.compare(h);if(0!=c)return c;c=this.gj.Sa(b,this.XI);h=this.gj.Sa(d,this.XI);return c<h?-1:c==h?0:1};return b}(),c=function(){return function(b,c,l,f,v,a,e,F,k){this.Pg=b;this.Ht=c;this.sB=l;this.gJ=f;this.dj=v;this.em=a;this.zn=e;this.hJ=F;this.LV=k}}();f.EZ=c;var b=function(){function b(){}b.TL=function(d,c,q,v,D,e){if(c.u())d=new a(c,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),D.push(d);else{var h=new f.fd;h.Jb(c);h.Jb(q);f.rk.V(h,v,e,!0);c=0;q=h.Vd();for(v=h.rd;-1!=v;v=h.Ue(v))for(e=h.Pb(v);-1!=
e;e=h.Sb(e))for(var l=h.cb(e),k=0,H=h.Ka(e);k<H;l=h.U(l),k++)h.Va(l,q,c++);c=b.kM(q,h);b.sW(d,c,h,D)}};b.kM=function(d,c){for(var h=c.ud,l=new f.ia(0),a=c.rd;-1!=a;a=c.Ue(a))for(var k=c.Pb(a);-1!=k;k=c.Sb(k))for(var F=c.cb(k),p=0,E=c.Ka(k);p<E;F=c.U(F),p++)l.add(F);var g=new e(d,c);l.Gd(0,h,function(b,d){return g.GO(b,d)});d=[];var n=[],u=c.Vd(),z=c.Vd(),a=c.rd,k=c.Ue(a),E=new f.b,r=new f.b,t=l.get(0),A=c.ld(t),m=c.ng(A);c.w(t,E);for(var w=1,F=0;w<h-1;){for(var x=!1,p=w;p<h;p++)if(p!=F){var C=l.get(p),
I=c.ld(C),J=c.ng(I);c.w(C,r);if(E.ub(r))m==a&&J==k&&(x=b.mZ(u,z,c,d,n,A,t,I,C));else break}if(x||F==w-1){x&&F==w-1&&w--;if(++F==h)break;t=l.get(F);A=c.ld(t);m=c.ng(A);c.w(t,E)}x||(w=F+1)}h=[];for(a=c.rd;-1!=a;a=c.Ue(a))for(k=c.Pb(a);-1!=k;k=c.Sb(k))for(l=c.cb(k),p=0,E=c.Ka(k);p<E;l=c.U(l),p++){F=c.Sa(l,z);if(0<=F)for(;F<n.length&&n[F].Pg==l;)h.push(n[F++]);F=c.Sa(l,u);if(0<=F)for(;F<d.length&&d[F].Pg==l;)h.push(d[F++])}c.ke(u);c.ke(z);return h};b.mZ=function(d,c,f,v,a,e,k,p,E){var h=f.Rj(e),l=f.Rj(p),
q=f.cb(e),D=f.cb(p),F=f.Ra(k),H=f.Ra(E),g=!1,n=!1,G=!1,u=!1;k!=q&&(E!=D&&(g=b.sZ(d,f,v,e,F,p,H)),E!=l&&(n=b.uZ(d,f,v,e,F,p,E)));k!=h&&(E!=D&&(G=b.wZ(c,f,a,e,k,p,H,q)),E!=l&&(u=b.FL(c,f,a,e,k,p,E,q)));g&&n&&G?(d=v.length-1,2==a[u?a.length-2:a.length-1].dj&&(v[d-1]=v[d],--v.length)):g&&n&&u&&2==a[a.length-1].dj&&(a=v[v.length-1],--v.length,f.Sa(a.Pg,d)==v.length&&f.Va(a.Pg,d,-1));return g||n||G||u};b.sZ=function(b,d,q,v,a,e,k){var h,l;l=new f.Hb;var D=new f.Hb,F=[0,0],H=[0,0];h=d.ic(a);null==h&&(d.pd(a,
l),h=l);l=d.ic(k);null==l&&(d.pd(k,D),l=D);h=h.Ma(l,null,F,H,0);2>h&&(v=new c(a,v,F[0],NaN,h,k,e,H[0],NaN),q.push(v),v=d.Sa(a,b),0>v&&d.Va(a,b,q.length-1));return!0};b.uZ=function(b,d,q,v,a,e,k){var h,l;l=new f.Hb;var D=new f.Hb,F=[0,0],H=[0,0];h=d.ic(a);null==h&&(d.pd(a,l),h=l);l=d.ic(k);null==l&&(d.pd(k,D),l=D);h=h.Ma(l,null,F,H,0);return 2>h?(v=new c(a,v,F[0],NaN,h,k,e,H[0],NaN),q.push(v),v=d.Sa(a,b),0>v&&d.Va(a,b,q.length-1),!0):!1};b.wZ=function(b,d,q,v,a,e,k,p){var h,l;l=new f.Hb;var D=new f.Hb,
F=[0,0],H=[0,0];h=d.ic(a);null==h&&(d.pd(a,l),h=l);l=d.ic(k);null==l&&(d.pd(k,D),l=D);h=h.Ma(l,null,F,H,0);if(2==h)return v=new c(a,v,F[0],F[1],h,k,e,H[0],H[1]),q.push(v),v=d.Sa(a,b),0>v&&d.Va(a,b,q.length-1),!0;D=!1;a==p&&(v=new c(a,v,F[0],NaN,h,k,e,H[0],NaN),q.push(v),v=d.Sa(a,b),0>v&&d.Va(a,b,q.length-1),D=!0);return D};b.FL=function(b,d,q,v,a,e,k,p){var h,l;l=new f.Hb;var D=new f.Hb,F=[0,0],H=[0,0];h=d.ic(a);null==h&&(d.pd(a,l),h=l);l=d.ic(k);null==l&&(d.pd(k,D),l=D);h=h.Ma(l,null,F,H,0);if(2==
h)return v=new c(a,v,F[0],F[1],h,k,e,H[0],H[1]),q.push(v),v=d.Sa(a,b),0>v&&d.Va(a,b,q.length-1),!0;D=!1;a==p&&(v=new c(a,v,F[0],NaN,h,k,e,H[0],NaN),q.push(v),v=d.Sa(a,b),0>v&&d.Va(a,b,q.length-1),D=!0);return D};b.sW=function(d,c,q,v){var h,l=[];l[0]=new f.b;l[1]=new f.b;l[2]=new f.b;l[3]=new f.b;var e=new f.b,k=new f.b,p=new f.b,E=new f.b,g=null;null!=v&&(g=new f.Cg,g.Is());var n,u=0,z=null,r=new f.Hb;new f.Hb;for(var t=q.Pb(q.rd);-1!=t;t=q.Sb(t)){var A,m=4,w=-1,x,C,I,J=-1,K,y,M,O,P=-1,L=-1,N=NaN;
A=!0;var B=!1,aa=!0,U=!0,R=!0,W=0;I=t;K=0;for(var T=q.cb(t),Q=q.Ka(t),S=0;S<Q;T=q.U(T),S++){n=q.ic(T);if(null==n){if(!q.pd(T,r))continue;n=r}-1==J&&(J=T);for(var V=0;u<c.length&&T==c[u].Pg;){w=c[u].Ht;x=c[u].Pg;C=c[u].sB;y=c[u].zn;M=c[u].em;O=c[u].hJ;if(2==c[u].dj){if(B||(I=w,J=x,K=C,P=y,L=M,N=O,m=2,null!=v?z=new f.Ua:W=0,R=!1,U=!0),C=c[u].gJ,O=c[u].LV,null!=v?(n.yh(V,c[u].gJ,g),z.dc(g.get(),U)):W++,V=C,B=!0,U=A=!1,u+1==c.length||2!=c[u+1].dj||c[u+1].Pg==x&&c[u+1].sB!=V)null!=v?(h=new a(z,2,w,x,C,
m,I,J,K,y,M,O,P,L,N),v.push(h)):null.add(W),I=w,J=x,K=C,P=y,L=M,N=O,m=2,B=A=!1,U=R=!0}else{var Y=q.U(x);if(u<c.length-1&&c[u+1].Pg==Y&&c[u+1].em==M&&2==c[u+1].dj)C!=V&&(R&&(null!=v?z=new f.Ua:W=0),A=0<u&&c[u-1].Ht==w?1==m?0:0==m?1:3:3,null!=v?(n.yh(V,C,g),z.dc(g.get(),U),h=new a(z,A,w,x,C,m,I,J,K,y,M,O,P,L,N),v.push(h)):(W++,null.add(W)),V=C,I=w,J=x,K=C,P=y,L=M,N=O,m=A,A=aa=!1,U=R=!0);else if(!b.$L(d,q,c,u,e,k)){b.LL(q,c,u,t,T,p,E);var X=!1,Y=!1;h=!0;if(!(e.ub(p)||k.ub(p)||e.ub(E)||k.ub(E))){l[0].L(e);
l[1].L(k);l[2].L(p);l[3].L(E);l.sort(f.b.us);var Z=l[0],fa=l[1],ga=l[2],ja=l[3];Z.ub(e)?fa.ub(k)?d?(Y=X=!0,h=!1):X=!1:ja.ub(k)?d?h=Y=X=!0:X=!1:(X=!0,h=fa.ub(p)):fa.ub(e)?ga.ub(k)?d?(Y=X=!0,h=!1):X=!1:Z.ub(k)?d?h=Y=X=!0:X=!1:(X=!0,h=ga.ub(p)):ga.ub(e)?ja.ub(k)?d?(Y=X=!0,h=!1):X=!1:fa.ub(k)?d?h=Y=X=!0:X=!1:(X=!0,h=ja.ub(p)):Z.ub(k)?d?(Y=X=!0,h=!1):X=!1:ga.ub(k)?d?h=Y=X=!0:X=!1:(X=!0,h=Z.ub(p))}if(X){X=T==x;if(C!=V||X&&0==V)R&&(null!=v?z=new f.Ua:W=0),null!=v?(n.yh(V,C,g),z.dc(g.get(),U)):W++;if(h)if(1!=
m){if(C!=V||X&&0==V)null!=v?(h=new a(z,1,w,x,C,m,I,J,K,y,M,O,P,L,N),v.push(h)):null.add(W);if(!Y)m=1;else if(u==c.length-2||c[u+2].Ht!=w)m=0}else{if(C!=V||X&&0==V)null!=v?(h=new a(z,3,w,x,C,m,I,J,K,y,M,O,P,L,N),v.push(h)):null.add(W);m=1}else if(0!=m){if(C!=V||X&&0==V)null!=v?(h=new a(z,0,w,x,C,m,I,J,K,y,M,O,P,L,N),v.push(h)):null.add(W);if(!Y)m=0;else if(u==c.length-2||c[u+2].Ht!=w)m=1}else{if(C!=V||X&&0==V)null!=v?(h=new a(z,3,w,x,C,m,I,J,K,y,M,O,P,L,N),v.push(h)):null.add(W);m=0}if(C!=V||X&&0==
V)V=C,I=w,J=x,K=C,P=y,L=M,N=O,A=aa=!1,U=R=!0}}}u++}1!=V&&(R&&(null!=v?z=new f.Ua:W=0),null!=v?(n.yh(V,1,g),z.dc(g.get(),U)):W++,U=R=!1,aa=!0)}aa&&(C=1,x=q.Rj(t),x=q.Ra(x),M=y=-1,O=NaN,A?null!=v?(h=new a(z,4,w,x,C,m,I,J,K,y,M,O,P,L,N),v.push(h)):null.add(W):(A=1==m?0:0==m?1:3,null!=v?(h=new a(z,A,w,x,C,m,I,J,K,y,M,O,P,L,N),v.push(h)):null.add(W)))}};b.$L=function(d,c,q,v,a,e){var h=q[v].hJ;if(1==h)return b.PL(d,c,q,v,a,e);if(0==h)return b.WL(d,c,q,v,a,e);throw f.f.ya();};b.PL=function(b,d,c,v,a,e){var h=
new f.Hb,l=c[v].Pg,q=c[v].zn,D=c[v].em,k=-1,H=-1,p=-1,E=-1;if(!b&&0<v)var g=c[v-1],k=g.Pg,H=g.zn,p=g.em,E=g.dj;var n=-1,u=-1,z=-1,r=-1;v<c.length-1&&(g=c[v+1],n=g.Pg,u=g.zn,z=g.em,r=g.dj);var t=d.U(l),g=d.U(D);if(!b)return 0<v&&k==l&&H==q&&p==g&&2==E||v<c.length-1&&n==t&&u==q&&z==g&&2==r?(b=d.ic(D),null==b&&(d.pd(D,h),b=h),e.L(b.Eg(1)),a.au(e),e.normalize(),a.normalize(),!1):v<c.length-1&&n==l&&u==q&&z==g?(b=d.ic(D),null==b&&(d.pd(D,h),b=h),a.L(b.Eg(1)),b=d.ic(g),null==b&&(d.pd(g,h),b=h),e.L(b.Eg(0)),
a.Kr(),e.normalize(),a.normalize(),!1):!0;if(v==c.length-1||n!=l||u!=q||z!=g||2==r)return b=d.ic(D),null==b&&(d.pd(D,h),b=h),e.L(b.Eg(1)),a.au(e),e.normalize(),a.normalize(),!1;b=d.ic(D);null==b&&(d.pd(D,h),b=h);a.L(b.Eg(1));b=d.ic(g);null==b&&(d.pd(g,h),b=h);e.L(b.Eg(0));a.Kr();e.normalize();a.normalize();return!1};b.WL=function(b,d,c,v,a,e){var h=new f.Hb,l=c[v].Pg,q=c[v].zn,D=c[v].em,k=-1,H=-1,p=-1,E=-1;if(!b&&v<c.length-1)var g=c[v+1],k=g.Pg,H=g.zn,p=g.em,E=g.dj;var n=-1,u=-1,z=-1,g=-1;0<v&&(g=
c[v-1],n=g.Pg,u=g.zn,z=g.em,g=g.dj);var r=d.U(l),t=d.Ra(D);return b?0==v||n!=l||u!=q||z!=t||2==g?(b=d.ic(D),null==b&&(d.pd(D,h),b=h),e.L(b.Eg(0)),a.au(e),e.normalize(),a.normalize(),!1):!0:0<v&&n==l&&u==q&&z==t&&2==g||v<c.length-1&&k==r&&H==q&&p==t&&2==E?(b=d.ic(D),null==b&&(d.pd(D,h),b=h),e.L(b.Eg(0)),a.au(e),e.normalize(),a.normalize(),!1):!0};b.LL=function(b,d,c,v,a,e,k){var h=new f.Hb,l=b.ic(a);null==l&&(b.pd(a,h),l=h);c=d[c];d=c.Pg;c=c.sB;a=b.U(d);if(1==c)e.L(l.Eg(1)),-1!=a&&a!=b.Rj(v)?(l=b.ic(a),
null==l&&(b.pd(a,h),l=h),k.L(l.Eg(0)),l=b.ic(d),null==l&&b.pd(d,h)):k.L(e),e.Kr(),k.normalize(),e.normalize();else if(0==c)k.L(l.Eg(c)),e.au(k),k.normalize(),e.normalize();else throw f.f.ya();};return b}();f.VL=b})(C||(C={}));(function(f){(function(b){b[b.Linear=0]="Linear";b[b.Angular=1]="Angular";b[b.Area=2]="Area"})(f.hO||(f.hO={}));var a=function(){function b(b,d,c){this.nd=d;this.Ai=c;this.aB=b}b.prototype.Eb=function(d){return d instanceof b?this.Ai===d.Ai:!1};b.kH=function(d){return 0!==d.nd?
null:-1===d.aB?new b(-1,2,d.Ai*d.Ai):b.ze(h[d.aB])};b.ze=function(b){b=d[b];return void 0===b?null:b};b.aR=function(d,c,h){var f=null;if(void 0!==h&&null!==h)try{"EPSG"===h.values[0]&&(f=b.ze(parseInt(h.values[1])))}catch(G){}null===f&&(f=new b(-1,d,c));return f};b.prototype.yc=function(){return this.aB};b.prototype.NG=function(b){if(b.nd!=this.nd)throw f.f.La();return this.Ai/b.Ai};b.li=function(b,d,c){return d.NG(c)*b};b.cG=function(b,d,c,h,f){c=c.NG(h);for(h=0;h<d;h++)f[h]=b[h]*c};return b}();
f.oc=a;for(var e=[109402,4046.8564224,109403,4046.87260987425,109463,100,109401,1E4,109461,225E8,109460,25E8,109451,1E-4,109444,404.68564224000005,109424,404.6849341289498,109428,404.68493792602754,109416,404.67838076760535,109420,404.68423895571647,109448,404.683871963536,109411,404.6872609874253,109450,.01,109408,3.34450944,109405,.09290304,109430,.09290354800069446,109423,.0929028774400711,109427,.09290287831176021,109441,.09290349665192114,109407,.09290137299531805,109440,.09290286332673177,109431,
.09290274144751023,109432,.09290207073852812,109433,.09290279616016,109434,.09290273520025,109419,.09290271785025629,109447,.0929026336004445,109406,.09290341161327487,109453,6.4516E-4,109454,6.451625806477421E-4,109414,1E6,109445,.04046856422400001,109425,.04046849341289498,109429,.04046849379260275,109417,.04046783807676053,109421,.04046842389557164,109449,.0404683871963536,109412,.04046872609874253,109404,1,109410,1.000027193184865,109413,2589998.4703195216,109452,1E-6,109409,3429904,109458,3434290.937856,
109457,3434528.1495040003,109464,1.244521604938272E-7,109455,25.292852640000003,109456,25.29295381171408,109459,2.89612324,109439,2589988.110336,109462,.7168473118308245,109442,.83612736,109422,.83612589696064,109426,.836125904805842,109415,.8361123569578626,109435,.836124673027592,109436,.836118636646753,109437,.8361251654414399,109438,.83612461680225,109418,.8361244606523066,109446,.8361237024040001,109443,.8361307045194736],c=[9103,2.908882086657216E-4,9104,4.84813681109536E-6,9102,.0174532925199433,
9106,.01570796326794897,9105,.01570796326794897,9109,1E-6,9114,9.817477042468104E-4,1031,4.84813681109536E-9,9112,1.570796326794897E-4,9101,1,9113,1.570796326794897E-6],b=[109031,15E4,109461,109030,5E4,109460,1033,.01,109451,9097,20.1168,109444,9052,20.1167824,109424,9062,20.116782494375872,109428,9038,20.1166195164,109416,9042,20.116765121552632,109420,9301,20.116756,109448,9033,20.11684023368047,109411,109005,.1,109450,9014,1.8288,109408,9002,.3048,109405,9070,.3048008333333334,109430,9051,.3047997333333333,
109423,9061,.3047997347632708,109427,9095,.3048007491,109441,9005,.3047972654,109407,9094,.3047997101815088,109440,9080,.3047995102481469,109431,9081,.30479841,109432,9082,.3047996,109433,9083,.3047995,109434,9041,.304799471538676,109419,9300,.3047993333333334,109447,9003,.3048006096012192,109406,109008,.0254,109453,109009,.0254000508001016,109454,9036,1E3,109414,9098,.201168,109445,9053,.201167824,109425,9063,.2011678249437587,109429,9039,.201166195164,109417,9043,.2011676512155263,109421,9302,.20116756,
109449,9034,.2011684023368047,109412,9001,1,109404,9031,1.0000135965,109410,9035,1609.3472186944375,109413,1025,.001,109452,9030,1852,109409,109013,1853.184,109458,109012,1853.248,109457,109016,3.527777777777778E-4,109464,109010,5.0292,109455,109011,5.029210058420118,109456,109014,1.7018,109459,9093,1609.344,109439,109015,.8466683600033867,109462,9096,.9144,109442,9050,.9143992,109422,9060,.9143992042898124,109426,9037,.9143917962000001,109415,9084,.9143985307444408,109435,9085,.91439523,109436,9086,
.9143988,109437,9087,.9143985,109438,9040,.9143984146160287,109418,9099,.914398,109446,109002,.9144018288036576,109443,109001,.9144,109442,109003,20.1168,109444,109004,.201168,109445,109006,.01,109451,109007,.001,109452],d=[],h=[],l=0;l<e.length;l+=2)d[e[l]]=new a(e[l],2,e[l+1]);e=null;for(l=0;l<c.length;l+=2)d[c[l]]=new a(c[l],1,c[l+1]);c=null;for(l=0;l<b.length;l+=3)d[b[l]]=new a(b[l],0,b[l+1]),h[b[l]]=b[l+2];b=null})(C||(C={}));(function(f){var a=function(){function f(){this.Gb=this.qb=0}f.prototype.set=
function(c,b){void 0!==b?(this.qb=c,this.Gb=b):"number"===typeof c?(this.qb=c,this.Gb=0):(this.qb=c.qb,this.Gb=c.Gb)};f.prototype.value=function(){return this.qb};f.prototype.add=function(c){var b=this.qb+c.qb;c=this.Gb+c.Gb+2.220446049250313E-16*Math.abs(b);this.qb=b;this.Gb=c};f.prototype.hP=function(){var c=this.qb+1,b=this.Gb+2.220446049250313E-16*Math.abs(c);this.qb=c;this.Gb=b};f.prototype.aP=function(c,b){this.qb=c.qb+b.qb;this.Gb=c.Gb+b.Gb+2.220446049250313E-16*Math.abs(this.qb)};f.prototype.sub=
function(c){if("number"===typeof c){var b=this.qb-c;c=this.Gb+2.220446049250313E-16*Math.abs(b)}else b=this.qb-c.qb,c=this.Gb+c.Gb+2.220446049250313E-16*Math.abs(b);this.qb=b;this.Gb=c};f.prototype.Vg=function(c){var b=this.qb*c.qb;this.Gb=this.Gb*Math.abs(c.qb)+c.Gb*Math.abs(this.qb)+this.Gb*c.Gb+2.220446049250313E-16*Math.abs(b);this.qb=b};f.prototype.yp=function(c){var b=this.qb*c;this.Gb=this.Gb*Math.abs(c)+2.220446049250313E-16*Math.abs(b);this.qb=b};f.prototype.pm=function(c,b){var d=Math.abs(c.qb)*
Math.abs(b.qb);this.Gb=c.Gb*Math.abs(b.qb)+b.Gb*Math.abs(c.qb)+c.Gb*b.Gb+2.220446049250313E-16*Math.abs(d);this.qb=d};f.prototype.Xm=function(c){var b=Math.abs(c.qb),d=this.qb/c.qb,h=(this.Gb+Math.abs(d)*c.Gb)/b;c.Gb>.01*b&&(c=c.Gb/b,h*=1+(1+c)*c);this.qb=d;this.Gb=h+2.220446049250313E-16*Math.abs(d)};f.prototype.sqrt=function(){var c,b;0<=this.qb?(c=Math.sqrt(this.qb),b=this.qb>10*this.Gb?.5*this.Gb/c:this.qb>this.Gb?c-Math.sqrt(this.qb-this.Gb):Math.max(c,Math.sqrt(this.qb+this.Gb)-c),b+=2.220446049250313E-16*
Math.abs(c)):this.qb<-1*this.Gb?b=c=NaN:(c=0,b=Math.sqrt(this.Gb));this.qb=c;this.Gb=b};f.prototype.sin=function(c){var b=Math.sin(c.qb),d=Math.cos(c.qb);this.qb=b;b=Math.abs(b);this.Gb=(Math.abs(d)+.5*b*c.Gb)*c.Gb+2.220446049250313E-16*b};f.prototype.cos=function(c){var b=Math.sin(c.qb),d=Math.cos(c.qb);this.qb=d;d=Math.abs(d);this.Gb=(Math.abs(b)+.5*d*c.Gb)*c.Gb+2.220446049250313E-16*d};f.prototype.Lg=function(){return Math.abs(this.qb)<=this.Gb};f.prototype.kt=function(){return this.Lg()&&0!=this.Gb};
return f}();f.Xb=a})(C||(C={}));var J=new C.b,O=new C.b,R=new C.b,Q=new C.b,T=new C.b;(function(f){var a;(function(c){c[c.closedPath=1]="closedPath";c[c.exteriorPath=2]="exteriorPath";c[c.ringAreaValid=4]="ringAreaValid"})(a||(a={}));var e=function(){function c(b,d,c,f,q,v,a){void 0!==d?(this.bb=b,this.Bk=d,this.Gl=c,this.Ji=f,this.Ba=v,this.PA=a,this.Tw=q):(this.bb=b.bb,this.Bk=b.Bk,this.Gl=b.Gl,this.Ji=b.Ji,this.Ba=b.Ba,this.PA=b.PA,this.Tw=b.Tw);this.mI=!0}c.prototype.next=function(){return this.mI?
(this.mI=!1,this.Ji):-1!=this.Ji?(this.Ji=this.bb.U(this.Ji),this.Ba++,-1!=this.Ji&&this.Ji!=this.Tw?this.Ji:this.XV()):-1};c.prototype.XV=function(){this.Gl=this.bb.Sb(this.Gl);for(this.Ba=0;-1!=this.Bk;){for(;-1!=this.Gl;this.Gl=this.bb.Sb(this.Gl))if(this.Tw=this.Ji=this.bb.cb(this.Gl),-1!=this.Ji)return this.Ji;this.Bk=this.bb.Ue(this.Bk);if(-1==this.Bk)break;if(!this.PA||f.T.Ic(this.bb.hc(this.Bk)))this.Gl=this.bb.Pb(this.Bk)}return-1};c.wR=function(b,d,h,f,q,v,a){return new c(b,d,h,f,q,v,a)};
return c}();f.LZ=e;a=function(){function c(){this.Xo=this.pn=this.Yk=this.md=this.el=this.jp=this.nj=this.sd=this.Bi=this.ph=this.wf=this.Gr=this.Jr=this.xb=this.nm=null;this.bx=this.rd=-1;this.ud=0;this.NA=!1;this.Gr=this.Jr=this.xb=null}c.prototype.ti=function(b){return null!=this.wf?this.wf[b]:null};c.prototype.th=function(b,d){if(null==this.wf){if(null==d)return;this.wf=[];for(var c=0,f=this.xb.D();c<f;c++)this.wf.push(null)}this.wf[b]=d};c.prototype.Lp=function(b,d){this.sd.P(b,1,d)};c.prototype.Kp=
function(b,d){this.sd.P(b,2,d)};c.prototype.sC=function(b,d){this.sd.P(b,6,d)};c.prototype.Lq=function(b){return this.sd.S(b,6)};c.prototype.Qx=function(b,d){this.sd.P(b,7,d)};c.prototype.cw=function(b){return this.sd.S(b,0)};c.prototype.EK=function(b,d){this.md.P(b,1,d)};c.prototype.IK=function(b,d){this.md.P(b,0,d)};c.prototype.TG=function(b){return this.md.S(b,7)};c.prototype.Ip=function(b,d){this.md.P(b,3,d)};c.prototype.Jp=function(b,d){this.md.P(b,4,d)};c.prototype.dW=function(b){null==this.md&&
(this.md=new f.ad(8));var d=this.md.Pe();this.md.P(d,2,b);this.md.P(d,5,0);this.md.P(d,6,0);this.md.P(d,7,d);return d};c.prototype.BS=function(b){this.md.kd(b)};c.prototype.fW=function(b){null==this.sd&&(this.sd=new f.ad(8),this.Dd=new f.ad(5),this.nj=new f.Sd(0),this.jp=new f.Sd(0));var d=this.sd.Pe();this.sd.P(d,0,d);this.sd.P(d,3,0);this.sd.P(d,6,0);this.Qx(d,b);d>=this.nj.size&&(b=16>d?16:f.J.truncate(3*d/2),this.nj.resize(b),this.jp.resize(b));this.nj.set(d,0);this.jp.set(d,0);return d};c.prototype.CG=
function(b){this.sd.kd(b)};c.prototype.Cz=function(b){this.Dd.kd(b);this.ud--};c.prototype.wJ=function(b){null==this.sd&&(this.sd=new f.ad(8),this.Dd=new f.ad(5),this.nj=new f.Sd(0),this.jp=new f.Sd(0));var d=this.Dd.Pe(),c=0<=b?b:d;this.Dd.P(d,0,c);if(0>b){if(c>=this.xb.D()){b=16>c?16:f.J.truncate(3*c/2);this.xb.resize(b);if(null!=this.wf)for(var l=0;l<b;l++)this.wf.push(null);null!=this.ph&&this.ph.resize(b);this.Jr=this.xb.Pa(0)}this.xb.rb(c,-1E38,-1E38);null!=this.wf&&(this.wf[c]=null);null!=
this.ph&&this.ph.write(c,1)}this.Dd.P(d,4,2*c);this.ud++;return d};c.prototype.Vj=function(b,d,c){var h=-1!=d?this.Ra(d):this.Rj(b),f=-1!=h?this.U(h):-1,v=this.wJ(null==c?this.ud:-1),a=this.Za(v);null!=c&&this.xb.uu(a,c);this.Aj(v,b);this.Kc(v,f);this.Lc(v,h);-1!=f&&this.Lc(f,v);-1!=h&&this.Kc(h,v);c=this.Qb(b);h=this.cb(b);-1==d&&this.sh(b,v);d==h&&this.jg(b,v);c&&-1==f&&(this.Kc(v,v),this.Lc(v,v));this.mk(b,this.Ka(b)+1);b=this.ng(b);this.kk(b,this.D(b)+1);return v};c.prototype.bn=function(){null==
this.Xo&&(this.Xo=new f.Wa(this.xb.description));return this.Xo};c.prototype.Hp=function(b,d){this.md.P(b,2,this.md.S(b,2)&-134217729||(1==d?134217728:0))};c.prototype.xo=function(b){return 0!=(this.md.S(b,2)&134217728)?1:0};c.prototype.eP=function(b){var d=this.bh(b.G(),b.description);1736==b.G()&&this.Hp(d,b.xo());this.fF(d,b);return d};c.prototype.fP=function(b){var d=this.bh(b.G(),b.description);this.gF(d,b);return d};c.prototype.OW=function(b,d){null==this.sd&&(this.sd=new f.ad(8),this.Dd=new f.ad(5),
this.nj=new f.Sd(0),this.jp=new f.Sd(0));this.sd.Qe(this.sd.xd+b);this.Dd.Qe(this.Dd.xd+d);this.nj.yb(this.nj.size+b);this.jp.yb(this.jp.size+b)};c.prototype.fF=function(b,d){this.OW(d.aa(),d.D());this.nm.Jd(d,0,d.D());this.Jr=this.xb.Pa(0);for(var c=null!=this.wf&&null!=d.cf,l=0,q=d.aa();l<q;l++)if(!(2>d.Ka(l))){var v=this.Yf(b,-1);this.ao(v,d.Qb(l));for(var a=d.wa(l),e=d.Gc(l);a<e;a++){var k=this.Vj(v,-1,null);if(c)if(k=this.Za(k),0!=(d.iH(a)&1))this.th(k,null);else{var p=new f.Cg;d.ic(a,p,!0);
this.th(k,p.get())}}}};c.prototype.gF=function(b,d){this.nm.Jd(d,0,d.D());this.Jr=this.xb.Pa(0);b=this.Yf(b,-1);var c=0;for(d=d.D();c<d;c++)this.Vj(b,-1,null)};c.prototype.FY=function(b,d,c){var h=this.U(b);if(-1==h)throw f.f.ya();for(var q=this.bn(),v=this.ld(b),a=0,e=d.Rl(c);a<e;a++){var k=this.Za(b),p=this.U(b),g=d.Mq(c,a);0==a&&(g.Dp(q),this.Yh(b,q));322==g.G()?this.th(k,null):this.th(k,f.T.ne(g));g.Bp(q);a<e-1?b=this.Vj(v,p,q):this.Yh(h,q)}};c.prototype.EY=function(b,d,c){var h=this.U(b);if(-1==
h)throw f.f.ya();for(var q=this.bn(),v=this.ld(b),a=0,e=d.Rl(c);a<e;a++){var k=this.Za(b),p=this.U(b),g=d.Mq(c,e-a-1);0==a&&(g.Bp(q),this.Yh(b,q));322==g.G()?this.th(k,null):this.th(k,f.T.ne(g));g.Dp(q);a<e-1?b=this.Vj(v,p,q):this.Yh(h,q)}};c.prototype.SG=function(){var b=new f.h;b.Oa();for(var d=this.Pr(),c=new f.b,l=!0,q=d.next();-1!=q;q=d.next())this.w(q,c),l?b.Nb(c.x,c.y):b.ml(c.x,c.y),l=!1;return b};c.prototype.Jb=function(b){var d=b.G();if(f.T.Ic(d))return this.eP(b);if(550==d)return this.fP(b);
throw f.f.ya();};c.prototype.vP=function(b,d){var c=d.G();if(f.T.Ic(c))this.fF(b,d);else if(550==c)this.gF(b,d);else throw f.f.ya();};c.prototype.jP=function(b,d){var c=this.bh(1736,b.description);if(2>b.Ka(d))return c;this.nm.Jd(b,b.wa(d),b.Gc(d));this.Jr=this.xb.Pa(0);var l=this.Yf(c,-1);this.ao(l,b.Qb(d)||!0);var q=null!=this.wf&&null!=b.cf,v=b.wa(d);for(d=b.Gc(d);v<d;v++){var a=this.Vj(l,-1,null);if(q)if(a=this.Za(a),0!=(b.iH(v)&1))this.th(a,null);else{var e=new f.Cg;b.ic(v,e,!0);this.th(a,e.get())}}return c};
c.prototype.Se=function(b){var d=this.hc(b),c=f.tM.bh(d,this.nm.description),l=this.D(b);if(0==l)return c;if(f.T.Ic(d)){for(var d=this.aa(b),q=f.Uc.wh(d+1),v=f.Uc.vq(d+1,0),a=c.description,e=0,k=a.Ea;e<k;e++){for(var p=a.zd(e),g=f.na.Xa(p),E=f.Uc.pz(p,l),n=this.xb.Pa(p),u=0,z=0,r=0,t=this.Pb(b);-1!=t;t=this.Sb(t)){var A=0;this.Qb(t)&&(A|=1);this.QU(t)&&(A|=4);0!=A&&v.hC(z,A);var m=this.Ka(t);q.write(z++,r);r+=m;if(0==p)for(var m=n,w=E,x=new f.b,A=this.cb(t);u<r;A=this.U(A),u++){var C=this.Za(A);m.fc(2*
C,x);w.ho(2*u,x)}else for(A=this.cb(t);u<r;A=this.U(A),u++)for(C=this.Za(A),w=0;w<g;w++)x=n.Of(C*g+w),E.Dm(u*g+w,x)}c.Zn(p,E);q.write(d,l)}c.FK(v);c.GK(q);c.Dc(16777215)}else if(550==d){a=c.description;c.resize(l);e=0;for(k=a.Ea;e<k;e++){p=a.zd(e);g=f.na.Xa(p);E=c.Pa(p);n=this.xb.Pa(p);u=0;t=this.Pb(b);m=this.Ka(t);for(A=this.cb(t);u<m;A=this.U(A),u++)for(C=this.Za(A),w=0;w<g;w++)x=n.Of(C*g+w),E.Dm(u*g+w,x);c.Zn(p,E)}c.Dc(16777215)}return c};c.prototype.$B=function(b){for(var d=this.Pb(b);-1!=d;d=
this.Qr(d));var d=this.HT(b),c=this.Ue(b);-1!=d?this.EK(d,c):this.rd=c;-1!=c?this.IK(c,d):this.bx=d;this.BS(b)};c.prototype.bh=function(b,d){return void 0===d?this.fG(b,f.ye.Ig()):this.fG(b,d)};c.prototype.fG=function(b,d){b=this.dW(b);null==this.xb?this.xb=this.nm=new f.Ed(d):this.nm.om(d);this.Gr=this.nm.description;this.NA=1<this.Gr.Ea;-1==this.rd?this.rd=b:(this.IK(b,this.bx),this.EK(this.bx,b));return this.bx=b};c.prototype.Ue=function(b){return this.md.S(b,1)};c.prototype.HT=function(b){return this.md.S(b,
0)};c.prototype.hc=function(b){return this.md.S(b,2)&2147483647};c.prototype.wK=function(b,d,c){d=this.Yk[d];b=this.TG(b);b>=d.size&&d.resize(Math.max(f.J.truncate(1.25*b),16),-1);d.write(b,c)};c.prototype.UG=function(b,d){b=this.TG(b);d=this.Yk[d];return b<d.size?d.read(b):-1};c.prototype.gG=function(){null==this.Yk&&(this.Yk=[]);for(var b=0;b<this.Yk.length;b++)if(null==this.Yk[b])return this.Yk[b]=f.Uc.wh(0),b;this.Yk.push(f.Uc.wh(0));return this.Yk.length-1};c.prototype.tX=function(b){this.Yk[b]=
null};c.prototype.Pb=function(b){return this.md.S(b,3)};c.prototype.Wv=function(b){return this.md.S(b,4)};c.prototype.D=function(b){return this.md.S(b,5)};c.prototype.aa=function(b){return this.md.S(b,6)};c.prototype.zq=function(b,d,c){for(var h=0,q=this.rd;-1!=q;q=this.Ue(q)){var v=this.hc(q);if(f.T.Ic(v)&&(!c||1736==v))for(var v=1736==this.hc(q),a=this.Pb(q);-1!=a;){for(var e=0,k=this.cb(a);e<f.J.truncate(this.Ka(a)/2);){var p=this.U(k);if(-1==p)break;var g=this.Za(k),E=this.ti(g);null!=E?g=E.Rb():
(E=this.Za(p),g=this.xb.ws(g,E));g<=b?(0==g?0==h&&(h=-1):h=1,p!=this.Rj(a)&&(this.IC(p,k),this.td(p,!0))):k=this.U(k);e++}e=this.cb(a);for(k=this.Qb(a)?e:this.Rj(a);0<this.Ka(a);)if(p=this.Ra(k),-1!=p){var n=this.Za(p),E=this.ti(n);null!=E?g=E.Rb():(g=this.Za(k),g=this.xb.ws(g,n));if(g<=b)0==g?0==h&&(h=-1):h=1,this.IC(p,k),this.td(p,!1),e==p&&(e=this.cb(a));else if(k=this.Ra(k),k==e)break}else{this.td(k,!0);0==h&&(h=-1);break}k=this.Ka(a);d&&(v?3>k:2>k)?(a=this.Qr(a),h=0<k?1:0==h?-1:h):a=this.Sb(a)}}return h};
c.prototype.IC=function(b,d){var c=this.Za(b),f=this.Za(d);null!=this.ph&&(c=this.ph.read(c),this.ph.write(f,c));if(null!=this.Bi)for(f=0,c=this.Bi.length;f<c;f++)if(null!=this.Bi[f]){var q=this.Sa(b,f);-1!=q&&this.Va(d,f,q)}};c.prototype.zm=function(b,d,c){var h=0,q=this.U(b);if(-1==q)throw f.f.ya();for(var v=this.Za(b),a=this.Za(q),e=this.ti(v),k=null==e?this.xb.ws(v,a):e.Rb(),p=0;p<c;p++){var g=d[p];if(0<g&&1>g){var E=g;null!=e&&(E=0<k?e.Cy(g)/k:0);this.xb.CE(v,a,E,this.bn());var n=this.Vj(this.ld(b),
q,this.bn());h++;if(null!=e){var u=e.Hl(0,g),E=this.Za(this.Ra(n));this.th(E,u);this.Qf(n,u.Cc());if(p==c-1||1==d[p+1])g=e.Hl(g,1),this.th(E,g)}}}return h};c.prototype.DY=function(b,d,c){var h=0,q=this.U(b);if(-1==q)throw f.f.X("internal error");var v=this.Za(b),a=this.Za(q),e=this.ti(v),k=null==e?this.xb.ws(v,a):e.Rb(),p=0;b=this.ld(b);for(var g=0;g<c;g++){var E=d[g];if(p<E&&1>E){var n=E;null!=e&&(n=0<k?e.Cy(E)/k:0);this.xb.CE(v,a,n,this.bn());n=this.sU(b,q,this.bn());h++;if(null!=e){var p=e.Hl(p,
E),u=this.Za(this.Ra(n));this.th(u,p);this.rb(n,p.sa,p.oa);if(g==c-1||1==d[g+1])p=e.Hl(E,1),n=this.Za(n),this.th(n,p)}}p=E}return h};c.prototype.sU=function(b,d,c){var h=-1!=d?this.Ra(d):this.Rj(b),f=-1!=h?this.U(h):-1,v=this.wJ(null==c?this.ud:-1),a=this.Za(v);null!=c&&this.xb.uu(a,c);this.Aj(v,b);this.Kc(v,f);this.Lc(v,h);-1!=f&&this.Lc(f,v);-1!=h&&this.Kc(h,v);c=this.Qb(b);h=this.cb(b);-1==d&&this.sh(b,v);d==h&&(c&&-1!=h||this.jg(b,v));c&&-1==f&&(this.Kc(v,v),this.Lc(v,v));this.mk(b,this.Ka(b)+
1);b=this.ng(b);this.kk(b,this.D(b)+1);return v};c.prototype.DF=function(b,d,c){var h=this.Za(d),q=this.Za(c);if(0>h||q>this.ud-1)throw f.f.F("invalid call");if(h>q&&!this.Qb(b))throw f.f.F("cannot iterate across an open path");for(b=0;d!=c;d=this.U(d))h=this.Za(d),q=this.ti(h),null!=q?b+=q.Rb():(q=this.Za(this.U(d)),b+=this.xb.ws(h,q));return b};c.prototype.Yh=function(b,d){var c=this.Za(b);this.xb.uu(c,d);c=this.ti(c);null!=c&&c.setStart(d);b=this.Ra(b);-1!=b&&(b=this.Za(b),null!=this.ti(b)&&c.setEnd(d))};
c.prototype.wj=function(b,d){b=this.Za(b);this.xb.Ae(b,d)};c.prototype.Qf=function(b,d){this.rb(b,d.x,d.y)};c.prototype.rb=function(b,d,c){var h=this.Za(b);this.xb.rb(h,d,c);h=this.ti(h);null!=h&&h.vC(d,c);b=this.Ra(b);-1!=b&&(b=this.Za(b),null!=this.ti(b)&&h.vm(d,c))};c.prototype.w=function(b,d){this.xb.w(this.Dd.S(b,0),d)};c.prototype.Nc=function(b,d){this.xb.xa[0].fc(2*this.Dd.S(b,0),d)};c.prototype.Aa=function(b){var d=new f.b;this.xb.w(this.Dd.S(b,0),d);return d};c.prototype.oH=function(b,d){this.Jr.fc(2*
b,d)};c.prototype.Yc=function(b,d,c){return this.xb.Yc(b,this.Za(d),c)};c.prototype.setAttribute=function(b,d,c,f){this.xb.setAttribute(b,this.Za(d),c,f)};c.prototype.Za=function(b){return this.Dd.S(b,0)};c.prototype.nf=function(b){var d=new f.b;this.w(b,d);return d.y};c.prototype.Tq=function(b,d){b=this.Za(b);d=this.Za(d);var c=this.xb.xa[0].g;return c[2*b]===c[2*d]&&c[2*b+1]===c[2*d+1]};c.prototype.pw=function(b,d){b=this.Za(b);var c=this.xb.xa[0].g;return c[2*b]===d.x&&c[2*b+1]===d.y};c.prototype.pY=
function(b,d){1>d&&(d=1);if(null==this.ph){if(1==d)return;this.ph=f.Uc.Vm(this.xb.D(),1)}b=this.Za(b);b>=this.ph.size&&this.ph.resize(b+1,1);this.ph.write(b,d)};c.prototype.nH=function(b){b=this.Za(b);return null==this.ph||b>=this.ph.size?1:this.ph.read(b)};c.prototype.Va=function(b,d,c){d=this.Bi[d];b=this.Za(b);d.size<this.xb.D()&&d.resize(this.xb.D(),-1);d.write(b,c)};c.prototype.Sa=function(b,d){b=this.Za(b);d=this.Bi[d];return b<d.size?d.read(b):-1};c.prototype.Vd=function(){null==this.Bi&&(this.Bi=
[]);for(var b=0;b<this.Bi.length;b++)if(null==this.Bi[b])return this.Bi[b]=f.Uc.wh(0,-1),b;this.Bi.push(f.Uc.wh(0,-1));return this.Bi.length-1};c.prototype.ke=function(b){this.Bi[b]=null};c.prototype.ic=function(b){return null!=this.wf?(b=this.Za(b),this.wf[b]):null};c.prototype.pd=function(b,d){var c=this.Dd.S(b,2);if(-1==c)return!1;if(this.NA){var l=new f.Wa;this.wj(b,l);d.setStart(l);this.wj(c,l);d.setEnd(l)}else this.xb.Nc(this.Dd.S(b,0),J),d.Rm(0,J),this.xb.Nc(this.Dd.S(c,0),J),d.Rm(1,J);return!0};
c.prototype.fX=function(b,d,c){if(this.NA){var h=new f.Wa;this.wj(b,h);c.setStart(h);this.wj(d,h);c.setEnd(h)}else this.xb.Nc(b,J),c.Rm(0,J),this.xb.Nc(d,J),c.Rm(1,J)};c.prototype.Yf=function(b,d){var c;if(-1!=d){if(b!=this.ng(d))throw f.f.ya();c=this.bt(d)}else c=this.Wv(b);var l=this.fW(b);-1!=d&&this.Lp(d,l);this.Kp(l,d);this.Lp(l,c);-1!=c?this.Kp(c,l):this.Ip(b,l);-1==d&&this.Jp(b,l);this.wm(b,this.aa(b)+1);return l};c.prototype.AH=function(b,d,c,f){b=this.Yf(b,-1);for(var h=0,l=d,a=!1;l==c&&
(a=!0),this.Aj(l,b),h++,l=this.U(l),l!=d;);this.ao(b,!0);this.mk(b,h);a&&(d=c);this.jg(b,d);this.sh(b,this.Ra(d));this.Np(b,!1);null!=f&&(f[0]=a);return b};c.prototype.Qr=function(b){var d=this.bt(b),c=this.Sb(b),f=this.ng(b);-1!=d?this.Kp(d,c):this.Ip(f,c);-1!=c?this.Lp(c,d):this.Jp(f,d);this.CQ(b);this.wm(f,this.aa(f)-1);this.CG(b);return c};c.prototype.CQ=function(b){var d=this.cb(b);if(-1!=d){for(var c=0,f=this.Ka(b);c<f;c++){var q=d,d=this.U(d);this.Cz(q)}d=this.ng(b);this.kk(d,this.D(d)-this.Ka(b))}this.mk(b,
0)};c.prototype.Sb=function(b){return this.sd.S(b,2)};c.prototype.bt=function(b){return this.sd.S(b,1)};c.prototype.Ka=function(b){return this.sd.S(b,3)};c.prototype.Qb=function(b){return 0!=(this.Lq(b)&1)};c.prototype.ao=function(b,d){if(this.Qb(b)!=d){if(0<this.Ka(b)){var c=this.cb(b),f=this.Rj(b);d?(this.Kc(f,c),this.Lc(c,f)):(this.Kc(f,-1),this.Lc(c,-1));c=this.Za(f);this.th(c,null)}this.sC(b,(this.Lq(b)|1)-1|(d?1:0))}};c.prototype.ng=function(b){return this.sd.S(b,7)};c.prototype.QU=function(b){return 0!=
(this.Lq(b)&2)};c.prototype.nC=function(b,d){this.sC(b,(this.Lq(b)|2)-2|(d?2:0))};c.prototype.fA=function(b){if(this.WU(b))return this.nj.get(this.cw(b));var d=new f.Hb,c=this.cb(b);if(-1==c)return 0;var l=new f.b;this.w(c,l);for(var q=0,v=0,a=this.Ka(b);v<a;v++,c=this.U(c)){var e=this.ic(c);if(null==e){if(!this.pd(c,d))continue;e=d}q+=e.By(l.x,l.y)}this.Np(b,!0);this.nj.set(this.cw(b),q);return q};c.prototype.Zr=function(b,d,c){d=this.el[d];b=this.cw(b);d.size<this.nj.size&&d.resize(this.nj.size,
-1);d.write(b,c)};c.prototype.Tj=function(b,d){b=this.cw(b);d=this.el[d];return b<d.size?d.read(b):-1};c.prototype.qz=function(){null==this.el&&(this.el=[]);for(var b=0;b<this.el.length;b++)if(null==this.el[b])return this.el[b]=f.Uc.wh(0),b;this.el.push(f.Uc.wh(0));return this.el.length-1};c.prototype.aC=function(b){this.el[b]=null};c.prototype.WV=function(b,d,c){if(-1==c)throw f.f.F();if(d!=c){var h=this.Sb(c),q=this.bt(c),v=this.ng(c);-1==q?this.Ip(v,h):this.Kp(q,h);-1==h?this.Jp(v,q):this.Lp(h,
q);this.kk(v,this.D(v)-this.Ka(c));this.wm(v,this.aa(v)-1);q=-1==d?this.Wv(b):this.bt(d);this.Lp(c,q);this.Kp(c,d);-1==d?this.Jp(b,c):this.Lp(d,c);-1==q?this.Ip(b,c):this.Kp(q,c);this.kk(b,this.D(b)+this.Ka(c));this.wm(b,this.aa(b)+1);this.Qx(c,b)}};c.prototype.Kj=function(b,d){this.xb.Ae(this.Za(d),this.bn());this.Vj(b,-1,this.bn())};c.prototype.td=function(b,d){var c=this.ld(b),l=this.Ra(b),q=this.U(b);-1!=l&&this.Kc(l,q);var v=this.Ka(c);b==this.cb(c)&&this.jg(c,1<v?q:-1);-1!=q&&this.Lc(q,l);b==
this.Rj(c)&&this.sh(c,1<v?l:-1);if(-1!=l&&-1!=q){var l=this.Za(l),a=this.Za(q);d?(d=this.ti(l),null!=d&&(l=new f.b,this.xb.w(a,l),d.Zc(l))):(a=this.Za(b),d=this.ti(a),this.th(l,d),null!=d&&(l=this.xb.Aa(l),d.Mc(l)))}this.mk(c,v-1);c=this.ng(c);this.kk(c,this.D(c)-1);this.Cz(b);return q};c.prototype.cb=function(b){return this.sd.S(b,4)};c.prototype.Rj=function(b){return this.sd.S(b,5)};c.prototype.U=function(b){return this.Dd.S(b,2)};c.prototype.Ra=function(b){return this.Dd.S(b,1)};c.prototype.ld=
function(b){return this.Dd.S(b,3)};c.prototype.pc=function(b,d){return this.Vj(b,-1,d)};c.prototype.Pr=function(b){if(void 0===b)return this.Pr(!1);if(b instanceof e)return new e(b);var d,c=-1,l=-1,q=-1,v=0,a=!1;for(d=this.rd;-1!=d;d=this.Ue(d))if(!b||f.T.Ic(this.hc(d))){for(c=this.Pb(d);-1!=c;c=this.Sb(c))if(q=l=this.cb(c),v=0,-1!=l){a=!0;break}if(a)break}return e.wR(this,d,c,l,q,v,b)};c.prototype.Xc=function(b){this.nm.Xc(b);if(null!=this.wf)for(var d=0,c=this.wf.length;d<c;d++)null!=this.wf[d]&&
this.wf[d].Xc(b)};c.prototype.as=function(b,d,c,f){f?this.FY(b,d,c):this.EY(b,d,c)};c.prototype.Lc=function(b,d){this.Dd.P(b,1,d)};c.prototype.Kc=function(b,d){this.Dd.P(b,2,d)};c.prototype.Aj=function(b,d){this.Dd.P(b,3,d)};c.prototype.mk=function(b,d){this.sd.P(b,3,d)};c.prototype.jg=function(b,d){this.sd.P(b,4,d)};c.prototype.sh=function(b,d){this.sd.P(b,5,d)};c.prototype.wm=function(b,d){this.md.P(b,6,d)};c.prototype.kk=function(b,d){this.md.P(b,5,d)};c.prototype.eK=function(b){var d=b;do{var c=
this.U(d);this.Kc(d,this.Ra(d));this.Lc(d,c);d=c}while(d!=b)};c.prototype.yC=function(b){this.ud=b};c.prototype.Rr=function(b){var d=this.bt(b),c=this.Sb(b),f=this.ng(b);-1!=d?this.Kp(d,c):this.Ip(f,c);-1!=c?this.Lp(c,d):this.Jp(f,d);this.jg(b,-1);this.sh(b,-1);this.CG(b)};c.prototype.Mi=function(b,d){var c=this.Ra(b),l=this.U(b);-1!=c&&this.Kc(c,l);-1!=l&&this.Lc(l,c);if(-1!=c&&-1!=l)if(c=this.Za(c),l=this.Za(l),d){if(d=this.ti(c),null!=d){var q=new f.b;this.xb.w(l,q);d.Zc(q)}}else l=this.Za(b),
d=this.ti(l),this.th(c,d),null!=d&&(q=new f.b,this.xb.w(c,q),d.Mc(q));this.Cz(b)};c.prototype.WU=function(b){return 0!=(this.Lq(b)&4)};c.prototype.Np=function(b,d){this.sC(b,(this.Lq(b)|4)-4|(d?4:0))};c.prototype.Wx=function(b,d){var c=this.Dd.g;this.xb.tc();var f=this.xb.xa[0].g;b.Gd(0,d,function(b,d){b=c[5*b];d=c[5*d];var h=f[2*b];b=f[2*b+1];var l=f[2*d];d=f[2*d+1];return b<d?-1:b>d?1:h<l?-1:h>l?1:0})};c.prototype.cU=function(){for(var b=this.rd;-1!=b;b=this.Ue(b))if(!f.T.Ic(this.hc(b)))return!0;
return!1};c.prototype.DC=function(b,d){for(var c=this.Pb(b),f=this.Pb(d),q=this.Wv(b),v=this.Wv(d),a=this.Pb(b);-1!=a;a=this.Sb(a))this.Qx(a,d);for(a=this.Pb(d);-1!=a;a=this.Sb(a))this.Qx(a,b);this.Ip(b,f);this.Ip(d,c);this.Jp(b,v);this.Jp(d,q);c=this.D(b);f=this.aa(b);q=this.aa(d);this.kk(b,this.D(d));this.kk(d,c);this.wm(b,q);this.wm(d,f);c=this.md.S(b,2);this.md.P(b,2,this.md.S(d,2));this.md.P(d,2,c)};return c}();f.fd=a})(C||(C={}));(function(f){var a=function(a){function c(b,d,c,l){a.call(this);
this.R=new f.h;void 0===b?this.ZF():"number"===typeof b?this.XQ(b,d,c,l):b instanceof f.Wa?void 0!==d?this.Dv(b,d,c):this.YQ(b):b instanceof f.na?void 0!==d?this.$Q(b,d):this.ZQ(b):b instanceof f.h?this.WQ(b):this.ZF()}N(c,a);c.prototype.Dv=function(b,d,c){this.description=f.ye.Ig();this.R.Oa();b.u()||this.bv(b,d,c)};c.prototype.WQ=function(b){this.description=f.ye.Ig();this.R.I(b);this.R.normalize()};c.prototype.ZQ=function(b){if(null==b)throw f.f.F();this.description=b;this.R.Oa()};c.prototype.$Q=
function(b,d){if(null==b)throw f.f.F();this.description=b;this.R.I(d);this.R.normalize()};c.prototype.ZF=function(){this.description=f.ye.Ig();this.R.Oa()};c.prototype.YQ=function(b){this.description=f.ye.Ig();this.R.Oa();b.u()||this.bv(b)};c.prototype.XQ=function(b,d,c,l){this.description=f.ye.Ig();this.I(b,d,c,l)};c.prototype.I=function(b,d,c,f){this.Bc();if("number"===typeof b)this.R.I(b,d,c,f);else for(this.Oa(),d=0,c=b.length;d<c;d++)this.Nb(b[d])};c.prototype.Gp=function(b){this.Bc();if(!b.YU())throw f.f.F();
this.R.I(b)};c.prototype.Oa=function(){this.Bc();this.R.Oa()};c.prototype.u=function(){return this.R.u()};c.prototype.N=function(){return this.R.N()};c.prototype.fa=function(){return this.R.fa()};c.prototype.Gk=function(){return this.R.Gk()};c.prototype.Cq=function(){return this.R.Cq()};c.prototype.Bq=function(){return this.R.Wf()};c.prototype.Nb=function(b){if(b instanceof f.b)this.Bc(),this.R.Nb(b);else if(b instanceof f.h)this.Bc(),this.R.Nb(b);else if(b instanceof f.Wa){if(this.Bc(),!b.Hc()){var d=
b.description;this.description!=d&&this.om(d);if(this.u())this.bv(b);else{this.R.Nb(b.w());for(var h=1,l=d.Ea;h<l;h++)for(var q=d.Id(h),a=f.na.Xa(q),e=0;e<a;e++){var k=b.Yc(q,e),F=this.xf(q,e);F.Nb(k);setInterval(q,e,F)}}}}else if(b instanceof c&&!b.u())for(d=b.description,d!=this.description&&this.om(d),this.R.Nb(b.R),h=1,l=d.Ea;h<l;h++)for(q=d.zd(h),a=f.na.Xa(q),e=0;e<a;e++)k=b.xf(q,e),F=this.xf(q,e),F.Nb(k),setInterval(q,e,F)};c.prototype.bv=function(b,d,c){if(void 0!==d){this.R.I(b.w(),d,c);d=
b.description;c=1;for(var h=d.Ea;c<h;c++)for(var q=d.Id(c),a=f.na.Xa(q),e=0;e<a;e++){var k=b.Yc(q,e);this.setInterval(q,e,k,k)}}else for(this.R.I(b.la[0],b.la[1]),d=b.description,c=1,h=d.Ea;c<h;c++)for(q=d.Id(c),a=f.na.Xa(q),e=0;e<a;e++)k=b.Yc(q,e),this.setInterval(q,e,k,k)};c.prototype.setInterval=function(b,d,c,l){var h=null;"number"===typeof c?h=new f.Ac(c,l):h=c;this.Bc();if(0==b)if(0==d)this.R.o=h.ca,this.R.v=h.ha;else if(1==d)this.R.A=h.ca,this.R.B=h.ha;else throw f.f.vd();else this.KE(0,b,
d,h.ca),this.KE(1,b,d,h.ha)};c.prototype.O=function(b,d){this.Bc();this.R.O(b,d)};c.prototype.Xc=function(b){if(b instanceof f.Hd)this.Bc(),b.JC(this.R);else if(this.Bc(),!this.R.u()){var d=new f.cM;this.Cp(d);d.PU()?d.Oa():b.JC(d)}};c.prototype.copyTo=function(b){if(b.G()!=this.G())throw f.f.F();b.Bc();b.description=this.description;b.R.I(this.R);b.la=null;if(null!=this.la){b.Xu();for(var d=0;d<2*(this.description.af.length-2);d++)b.la[d]=this.la[d]}};c.prototype.Ja=function(){return new c(this.description)};
c.prototype.hf=function(){return this.R.HG()};c.prototype.Rb=function(){return this.R.YG()};c.prototype.G=function(){return 197};c.prototype.tb=function(){return 2};c.prototype.Rn=function(b){this.copyTo(b)};c.prototype.s=function(b){b.o=this.R.o;b.A=this.R.A;b.v=this.R.v;b.B=this.R.B};c.prototype.Cp=function(b){b.o=this.R.o;b.A=this.R.A;b.v=this.R.v;b.B=this.R.B;b.I(this.R.o,this.R.A,this.ae(0,1,0),this.R.v,this.R.B,this.ae(1,1,0))};c.prototype.xf=function(b,d){var c=new f.Ac;c.I(this.ae(0,b,d),
this.ae(1,b,d));return c};c.prototype.ig=function(b,d){d.Fg(this.description);var c=this.description.Ea-1;switch(b){case 0:for(b=0;b<c;b++)for(var l=this.description.zd(b),q=f.na.Xa(l),a=0;a<q;a++)d.setAttribute(l,a,this.ae(0,l,a));d.rb(this.R.o,this.R.A);break;case 1:for(b=0;b<c;b++)for(l=this.description.zd(b),q=f.na.Xa(l),a=0;a<q;a++)d.setAttribute(l,a,this.ae(1,l,a));d.rb(this.R.o,this.R.B);break;case 2:for(b=0;b<c;b++)for(l=this.description.zd(b),q=f.na.Xa(l),a=0;a<q;a++)d.setAttribute(l,a,this.ae(0,
l,a));d.rb(this.R.v,this.R.B);break;case 3:for(b=0;b<c;b++)for(l=this.description.zd(b),q=f.na.Xa(l),a=0;a<q;a++)d.setAttribute(l,a,this.ae(1,l,a));d.rb(this.R.v,this.R.A);break;default:throw f.f.vd();}};c.prototype.Fx=function(b,d){b=this.R.Fx(b);d.ka(b.x,b.y)};c.prototype.aT=function(b,d){return d*(b.Dr-2)};c.prototype.IG=function(b,d,c){if(this.R.u())throw f.f.X("empty geometry");if(0==d)return 0!=b?0!=c?this.R.B:this.R.v:0!=c?this.R.A:this.R.o;if(c>=f.na.Xa(d))throw f.f.F();var h=this.description.mg(d);
this.Xu();return 0<=h?this.la[this.aT(this.description,b)+this.description.DT(h)-2+c]:f.na.pe(d)};c.prototype.Xu=function(){this.Bc();if(null==this.la&&2<this.description.af.length){this.la=[];for(var b=c.$(this.description,0),d=c.$(this.description,1),h=0,l=1,q=this.description.Ea;l<q;l++)for(var a=this.description.zd(l),e=f.na.Xa(a),a=f.na.pe(a),k=0;k<e;k++)this.la[b+h]=a,this.la[d+h]=a,h++}};c.prototype.mo=function(b){if(null!=this.la)if(2<b.af.length){for(var d=f.ye.ux(b,this.description),h=[],
l=c.$(this.description,0),q=c.$(this.description,1),a=c.$(b,0),e=c.$(b,1),k=0,F=1,p=b.Ea;F<p;F++){var g=b.zd(F),E=f.na.Xa(g);if(-1==d[F])for(var n=f.na.pe(g),g=0;g<E;g++)h[a+k]=n,h[e+k]=n,k++;else for(n=this.description.wk(d[F])-2,g=0;g<E;g++)h[a+k]=this.la[l+n],h[e+k]=this.la[q+n],k++,n++}this.la=h}else this.la=null;this.description=b};c.prototype.ae=function(b,d,h){if(this.R.u())throw f.f.X("This operation was performed on an Empty Geometry.");if(0==d)return 0!=b?0!=h?this.R.B:this.R.v:0!=h?this.R.A:
this.R.o;if(h>=f.na.Xa(d))throw f.f.vd();var l=this.description.mg(d);return 0<=l?(this.Xu(),this.la[c.$(this.description,b)+this.description.wk(l)-2+h]):f.na.pe(d)};c.prototype.KE=function(b,d,h,l){this.Bc();if(0==d)0!=b?0!=h?this.R.B=l:this.R.v=l:0!=h?this.R.A=l:this.R.o=l;else{if(h>=f.na.Xa(d))throw f.f.vd();if(!this.hasAttribute(d)){if(f.na.OH(d,l))return;this.Ud(d)}d=this.description.mg(d);this.Xu();this.la[c.$(this.description,b)+this.description.wk(d)-2+h]=l}};c.$=function(b,d){return d*(b.af.length-
2)};c.prototype.Ma=function(b){this.Bc();var d=new f.h;b.s(d);return this.R.Ma(d)};c.prototype.Yb=function(b){return b instanceof f.h?this.R.Yb(b):this.R.Yb(b.R)};c.prototype.wv=function(b,d,c){this.Bc();b.u()?this.Oa():void 0!==d?this.bv(b,d,c):this.R.wv(b.Be(),b.nf())};c.prototype.offset=function(b,d){this.Bc();this.R.offset(b,d)};c.prototype.normalize=function(){this.Bc();this.R.normalize()};c.prototype.Wf=function(b){if(void 0!==b)if(b.Fg(this.description),this.u())b.Oa();else{for(var d=this.description.Ea,
c=1;c<d;c++)for(var l=this.description.zd(c),q=f.na.Xa(l),a=0;a<q;a++){var e=.5*(this.IG(0,l,a)+this.IG(1,l,a));b.setAttribute(l,a,e)}b.rb(this.R.Wf())}else{b=new f.Wa(this.description);if(this.u())return b;d=this.description.Ea;for(c=1;c<d;c++)for(l=this.description.Id(c),q=f.na.Xa(l),a=0;a<q;a++)e=.5*(this.ae(0,l,a)+this.ae(1,l,a)),b.setAttribute(l,a,e);b.rb(this.R.Gk(),this.R.Cq());return b}};c.prototype.Xz=function(){return new f.Wa(this.R.Xz())};c.prototype.contains=function(b){return b instanceof
f.Wa?b.u()?!1:this.R.contains(b.Be(),b.nf()):this.R.contains(b.R)};c.prototype.fR=function(b){return this.R.contains(b)};c.prototype.Eb=function(b){if(b==this)return!0;if(!(b instanceof c)||this.description!=b.description)return!1;if(this.u())return b.u()?!0:!1;if(!this.R.Eb(b.R))return!1;for(var d=0,h=2*(this.description.af.length-2);d<h;d++)if(this.la[d]!=b.la[d])return!1;return!0};c.prototype.jc=function(){var b=this.description.jc(),b=f.J.dh(b,this.R.jc());if(!this.u()&&null!=this.la)for(var d=
0,c=2*(this.description.af.length-2);d<c;d++)b=f.J.dh(b,this.la[d]);return b};c.prototype.Gg=function(){return f.Pi.Sm(this,null)};c.prototype.toString=function(){return this.u()?"Envelope: []":"Envelope: ["+this.R.o+", "+this.R.A+", "+this.R.v+", "+this.R.B+"]"};return c}(f.T);f.ci=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h){void 0===c?this.Oa():(this.o=c,this.A=b,this.v=d,this.B=h)}a.pa=function(c,b,d,h){var f=new a;f.o=c;f.A=b;f.v=d;f.B=h;return f};a.prototype.I=function(c,
b,d,h){"number"===typeof c?void 0!==d?(this.o=c,this.A=b,this.v=d,this.B=h,this.normalize()):(this.o=c,this.A=b,this.v=c,this.B=b):c instanceof f.b?void 0!==b?(this.o=c.x-.5*b,this.v=this.o+b,this.A=c.y-.5*d,this.B=this.A+d,this.normalize()):(this.o=c.x,this.A=c.y,this.v=c.x,this.B=c.y):c instanceof a?this.I(c.o,c.A,c.v,c.B):c instanceof f.Ac&&(c.u()||b.u()?this.Oa():(this.o=c.ca,this.v=c.ha,this.A=b.ca,this.B=b.ha))};a.prototype.mT=function(c,b){var d=new a;d.I(this.o,this.A,this.v,this.B);d.O(c,
b);return d};a.prototype.Lx=function(c,b){if(void 0!==b)if(0==b)this.Oa();else{this.o=c[0].x;this.A=c[0].y;this.v=this.o;this.B=this.A;for(var d=1;d<b;d++){var h=c[d];h.x<this.o?this.o=h.x:h.x>this.v&&(this.v=h.x);h.y<this.A?this.A=h.y:h.y>this.B&&(this.B=h.y)}}else if(null==c||0==c.length)this.Oa();else for(h=c[0],this.I(h.x,h.y),d=1;d<c.length;d++)h=c[d],this.ml(h.x,h.y)};a.prototype.Oa=function(){this.B=this.v=this.A=this.o=NaN};a.prototype.u=function(){return isNaN(this.o)};a.prototype.Nb=function(c,
b){"number"===typeof c?this.u()?(this.o=c,this.A=b,this.v=c,this.B=b):(this.o>c?this.o=c:this.v<c&&(this.v=c),this.A>b?this.A=b:this.B<b&&(this.B=b)):c instanceof f.b?this.Nb(c.x,c.y):c instanceof f.qd?this.Nb(c.x,c.y):c instanceof a&&!c.u()&&(this.Nb(c.o,c.A),this.Nb(c.v,c.B))};a.prototype.ml=function(c,b){this.o>c?this.o=c:this.v<c&&(this.v=c);this.A>b?this.A=b:this.B<b&&(this.B=b)};a.prototype.O=function(c,b){this.u()||(this.o-=c,this.v+=c,this.A-=b,this.B+=b,(this.o>this.v||this.A>this.B)&&this.Oa())};
a.prototype.scale=function(c){0>c&&this.Oa();this.u()||(this.o*=c,this.v*=c,this.A*=c,this.B*=c)};a.prototype.Yb=function(c){return!this.u()&&!c.u()&&(this.o<=c.o?this.v>=c.o:c.v>=this.o)&&(this.A<=c.A?this.B>=c.A:c.B>=this.A)};a.prototype.SH=function(c){return(this.o<=c.o?this.v>=c.o:c.v>=this.o)&&(this.A<=c.A?this.B>=c.A:c.B>=this.A)};a.prototype.Ma=function(c){if(this.u()||c.u())return!1;c.o>this.o&&(this.o=c.o);c.v<this.v&&(this.v=c.v);c.A>this.A&&(this.A=c.A);c.B<this.B&&(this.B=c.B);(c=this.o<=
this.v&&this.A<=this.B)||this.Oa();return c};a.prototype.Fx=function(c){switch(c){case 0:return f.b.pa(this.o,this.A);case 1:return f.b.pa(this.o,this.B);case 2:return f.b.pa(this.v,this.B);case 3:return f.b.pa(this.v,this.A);default:throw f.f.vd();}};a.prototype.OB=function(c){if(null==c||4>c.length)throw f.f.F();null!=c[0]?c[0].ka(this.o,this.A):c[0]=f.b.pa(this.o,this.A);null!=c[1]?c[1].ka(this.o,this.B):c[1]=f.b.pa(this.o,this.B);null!=c[2]?c[2].ka(this.v,this.B):c[2]=f.b.pa(this.v,this.B);null!=
c[3]?c[3].ka(this.v,this.A):c[3]=f.b.pa(this.v,this.A)};a.prototype.HG=function(){return this.u()?0:this.N()*this.fa()};a.prototype.YG=function(){return this.u()?0:2*(this.N()+this.fa())};a.prototype.Gk=function(){return(this.v+this.o)/2};a.prototype.Cq=function(){return(this.B+this.A)/2};a.prototype.N=function(){return this.v-this.o};a.prototype.fa=function(){return this.B-this.A};a.prototype.move=function(c,b){this.u()||(this.o+=c,this.A+=b,this.v+=c,this.B+=b)};a.prototype.wv=function(c,b){if(void 0!==
b)this.move(c-this.Gk(),b-this.Cq());else if(c instanceof f.b)this.wv(c.x,c.y);else if(c instanceof f.Wa){b=(this.v-this.o)/2;var d=(this.B-this.A)/2;this.o=c.Be()-b;this.v=c.Be()+b;this.A=c.nf()-d;this.B=c.nf()+d}else throw f.f.F();};a.prototype.offset=function(c,b){this.o+=c;this.v+=c;this.A+=b;this.B+=b};a.prototype.normalize=function(){if(!this.u()){var c=Math.min(this.o,this.v),b=Math.max(this.o,this.v);this.o=c;this.v=b;c=Math.min(this.A,this.B);b=Math.max(this.A,this.B);this.A=c;this.B=b}};
a.prototype.Un=function(c){c.ka(this.o,this.A)};a.prototype.SJ=function(c){c.ka(this.v,this.A)};a.prototype.VJ=function(c){c.ka(this.o,this.B)};a.prototype.Vn=function(c){c.ka(this.v,this.B)};a.prototype.YU=function(){return this.u()||this.o<=this.v&&this.A<=this.B};a.prototype.Wf=function(){return f.b.pa((this.v+this.o)/2,(this.B+this.A)/2)};a.prototype.Xz=function(){return f.b.pa(this.o,this.A)};a.prototype.contains=function(c,b){if(void 0!==b)return c>=this.o&&c<=this.v&&b>=this.A&&b<=this.B;if(c instanceof
f.Wa)return this.contains(c.Be(),c.nf());if(c instanceof f.b)return this.contains(c.x,c.y);if(c instanceof a)return c.o>=this.o&&c.v<=this.v&&c.A>=this.A&&c.B<=this.B;throw f.f.F();};a.prototype.Um=function(c,b){if(void 0!==b)return c>this.o&&c<this.v&&b>this.A&&b<this.B;if(c instanceof f.b)return this.Um(c.x,c.y);if(c instanceof a)return c.o>this.o&&c.v<this.v&&c.A>this.A&&c.B<this.B;throw f.f.F();};a.prototype.Eb=function(c){return c==this?!0:c instanceof a?this.u()&&c.u()?!0:this.o!=c.o||this.A!=
c.A||this.v!=c.v||this.B!=c.B?!1:!0:!1};a.prototype.jc=function(){var c=this.o,c=f.J.truncate(c^c>>>32),b=f.J.dh(c),c=this.v,c=f.J.truncate(c^c>>>32),b=f.J.dh(c,b),c=this.A,c=f.J.truncate(c^c>>>32),b=f.J.dh(c,b),c=this.B,c=f.J.truncate(c^c>>>32);return b=f.J.dh(c,b)};a.prototype.My=function(c){var b=new f.b;b.L(c);if(b.Gy())return b;if(this.u())return b.cv(),b;b.x<this.o?b.x=this.o:b.x>this.v&&(b.x=this.v);b.y<this.A?b.y=this.A:b.y>this.B&&(b.y=this.B);if(!b.Eb(c))return b;c=this.Wf();(b.x<c.x?b.x-
this.o:this.v-b.x)<(b.y<c.y?b.y-this.A:this.B-b.y)?b.x=b.x<c.x?this.o:this.v:b.y=b.y<c.y?this.A:this.B;return b};a.prototype.Vu=function(c){if(this.u())return NaN;if(c.x==this.o)return c.y-this.A;var b=this.B-this.A,d=this.v-this.o;return c.y==this.B?b+c.x-this.o:c.x==this.v?b+d+this.B-c.y:c.y==this.A?2*b+d+this.v-c.x:this.Vu(this.My(c))};a.prototype.yE=function(c){if(this.u())return-1;c=this.Vu(c);var b=this.B-this.A,d=this.v-this.o;return c<b?0:(c-=b)<d?1:c-d<b?2:3};a.prototype.no=function(){return this.u()?
2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.o)+Math.abs(this.v)+Math.abs(this.A)+Math.abs(this.B)+1)};a.prototype.fz=function(c,b){var d=this.vk(c),h=this.vk(b);if(0!=(d&h))return 0;if(0==(d|h))return 4;var f=(0!=d?1:0)|(0!=h?2:0);do{var q=b.x-c.x,v=b.y-c.y;q>v?0!=(d&a.bd)?(0!=(d&a.Bb)?(c.y+=v*(this.o-c.x)/q,c.x=this.o):(c.y+=v*(this.v-c.x)/q,c.x=this.v),d=this.vk(c)):0!=(h&a.bd)?(0!=(h&a.Bb)?(b.y+=v*(this.o-b.x)/q,b.x=this.o):(b.y+=v*(this.v-b.x)/q,b.x=this.v),h=this.vk(b)):0!=d?(0!=
(d&a.uc)?(c.x+=q*(this.A-c.y)/v,c.y=this.A):(c.x+=q*(this.B-c.y)/v,c.y=this.B),d=this.vk(c)):(0!=(h&a.uc)?(b.x+=q*(this.A-b.y)/v,b.y=this.A):(b.x+=q*(this.B-b.y)/v,b.y=this.B),h=this.vk(b)):0!=(d&a.ee)?(0!=(d&a.uc)?(c.x+=q*(this.A-c.y)/v,c.y=this.A):(c.x+=q*(this.B-c.y)/v,c.y=this.B),d=this.vk(c)):0!=(h&a.ee)?(0!=(h&a.uc)?(b.x+=q*(this.A-b.y)/v,b.y=this.A):(b.x+=q*(this.B-b.y)/v,b.y=this.B),h=this.vk(b)):0!=d?(0!=(d&a.Bb)?(c.y+=v*(this.o-c.x)/q,c.x=this.o):(c.y+=v*(this.v-c.x)/q,c.x=this.v),d=this.vk(c)):
(0!=(h&a.Bb)?(b.y+=v*(this.o-b.x)/q,b.x=this.o):(b.y+=v*(this.v-b.x)/q,b.x=this.v),h=this.vk(b));if(0!=(d&h))return 0}while(0!=(d|h));return f};a.prototype.vk=function(c){return(c.x<this.o?1:0)|(c.x>this.v?1:0)<<1|(c.y<this.A?1:0)<<2|(c.y>this.B?1:0)<<3};a.prototype.fh=function(c){return!this.u()&&(this.N()<=c||this.fa()<=c)};a.prototype.Cb=function(c){return c instanceof f.b?Math.sqrt(this.YK(c)):Math.sqrt(this.Yx(c))};a.prototype.Yx=function(c){var b=0,d=0,h;h=this.o-c.v;h>b&&(b=h);h=this.A-c.B;
h>d&&(d=h);h=c.o-this.v;h>b&&(b=h);h=c.A-this.B;h>d&&(d=h);return b*b+d*d};a.prototype.YK=function(c){var b=0,d=0,h;h=this.o-c.x;h>b&&(b=h);h=this.A-c.y;h>d&&(d=h);h=c.x-this.v;h>b&&(b=h);h=c.y-this.B;h>d&&(d=h);return b*b+d*d};a.prototype.Tn=function(c){this.u()?c.Oa():c.I(this.o,this.v)};a.BO=function(c,b,d,h){var f=1;isNaN(c)||(f+=Math.abs(c));isNaN(b)||(f+=Math.abs(b));isNaN(d)||(f+=Math.abs(d));isNaN(h)||(f+=Math.abs(h));return 2.220446049250313E-14*f};a.Bb=1;a.uc=4;a.bd=3;a.ee=12;return a}();
f.h=a})(C||(C={}));(function(f){var a;(function(c){c[c.initialize=0]="initialize";c[c.initializeRed=1]="initializeRed";c[c.initializeBlue=2]="initializeBlue";c[c.initializeRedBlue=3]="initializeRedBlue";c[c.sweep=4]="sweep";c[c.sweepBruteForce=5]="sweepBruteForce";c[c.sweepRedBlueBruteForce=6]="sweepRedBlueBruteForce";c[c.sweepRedBlue=7]="sweepRedBlue";c[c.sweepRed=8]="sweepRed";c[c.sweepBlue=9]="sweepBlue";c[c.iterate=10]="iterate";c[c.iterateRed=11]="iterateRed";c[c.iterateBlue=12]="iterateBlue";
c[c.iterateBruteForce=13]="iterateBruteForce";c[c.iterateRedBlueBruteForce=14]="iterateRedBlueBruteForce";c[c.resetRed=15]="resetRed";c[c.resetBlue=16]="resetBlue"})(a||(a={}));var e=function(){function c(b,d){this.Ci=b;this.oI=d}c.prototype.gs=function(b,d,c){this.Ci.CY(c,b,d,this.oI)};c.prototype.Qq=function(b){return this.Ci.Ls(b,this.oI)};return c}();a=function(){function c(){this.$w=this.bp=this.If=this.Bd=null;this.kr=new f.h;this.pn=this.bk=this.ck=this.Rd=this.fg=this.Yd=this.Pw=this.Uo=this.Ad=
this.Lb=null;this.Zb=-1;this.ta=0;this.ql()}c.prototype.bs=function(){this.ql();this.Aw=!0;null==this.Lb?(this.Uo=new f.ia(0),this.Lb=[]):(this.Uo.yf(0),this.Lb.length=0)};c.prototype.jd=function(b,d){if(!this.Aw)throw f.f.La();var c=new f.h;c.I(d);this.Uo.add(b);this.Lb.push(c)};c.prototype.yq=function(){if(!this.Aw)throw f.f.La();this.Aw=!1;null!=this.Lb&&0<this.Lb.length&&(this.Zb=0,this.Pc=!1)};c.prototype.aL=function(){this.ql();this.zw=!0;null==this.Lb?(this.Uo=new f.ia(0),this.Lb=[]):(this.Uo.yf(0),
this.Lb.length=0)};c.prototype.YE=function(b,d){if(!this.zw)throw f.f.La();var c=new f.h;c.I(d);this.Uo.add(b);this.Lb.push(c)};c.prototype.sG=function(){if(!this.zw)throw f.f.La();this.zw=!1;null!=this.Lb&&0<this.Lb.length&&null!=this.Ad&&0<this.Ad.length&&(-1==this.Zb?this.Zb=3:2==this.Zb?this.Zb=3:3!=this.Zb&&(this.Zb=1),this.Pc=!1)};c.prototype.$K=function(){this.ql();this.yw=!0;null==this.Ad?(this.Pw=new f.ia(0),this.Ad=[]):(this.Pw.yf(0),this.Ad.length=0)};c.prototype.UE=function(b,d){if(!this.yw)throw f.f.La();
var c=new f.h;c.I(d);this.Pw.add(b);this.Ad.push(c)};c.prototype.rG=function(){if(!this.yw)throw f.f.La();this.yw=!1;null!=this.Lb&&0<this.Lb.length&&null!=this.Ad&&0<this.Ad.length&&(-1==this.Zb?this.Zb=3:1==this.Zb?this.Zb=3:3!=this.Zb&&(this.Zb=2),this.Pc=!1)};c.prototype.next=function(){if(this.Pc)return!1;for(var b=!0;b;)switch(this.Zb){case 0:b=this.pA();break;case 1:b=this.lU();break;case 2:b=this.iU();break;case 3:b=this.kU();break;case 4:b=this.MY();break;case 5:b=this.IY();break;case 6:b=
this.JY();break;case 7:b=this.KY();break;case 8:b=this.ay();break;case 9:b=this.EC();break;case 10:b=this.BA();break;case 11:b=this.bV();break;case 12:b=this.ZU();break;case 13:b=this.$U();break;case 14:b=this.aV();break;case 15:b=this.ZJ();break;case 16:b=this.YJ();break;default:throw f.f.ya();}return this.Pc?!1:!0};c.prototype.xC=function(b){this.ta=b};c.prototype.dA=function(b){return this.Lb[b]};c.prototype.Hz=function(b){return this.Ad[b]};c.prototype.Ql=function(b){return this.Uo.read(b)};c.prototype.Ml=
function(b){return this.Pw.read(b)};c.IB=function(b){return 1==(b&1)};c.Hm=function(b){return 0==(b&1)};c.prototype.ql=function(){this.Aw=this.yw=this.zw=!1;this.dg=this.eg=this.nh=this.Ne=-1;this.Pc=!0};c.prototype.pA=function(){this.bg=this.sg=-1;if(10>this.Lb.length)return this.Ne=this.Lb.length,this.Zb=5,!0;null==this.Bd&&(this.Bd=new f.ms(!0),this.bp=this.Bd.mf(),this.Yd=new f.ia(0));this.Bd.bs();for(var b=0;b<this.Lb.length;b++){var d=this.Lb[b];this.Bd.ys(d.o,d.v)}this.Bd.yq();this.Yd.yb(2*
this.Lb.length);this.Yd.resize(0);for(b=0;b<2*this.Lb.length;b++)this.Yd.add(b);this.xu(this.Yd,2*this.Lb.length,!0);this.Ne=2*this.Lb.length;this.Zb=4;return!0};c.prototype.lU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.Bd&&(this.Bd=new f.ms(!0),this.bp=this.Bd.mf(),this.Yd=new f.ia(0));this.Bd.bs();for(var b=0;b<this.Lb.length;b++){var d=this.Lb[b];this.Bd.ys(d.o,d.v)}this.Bd.yq();this.Yd.yb(2*this.Lb.length);this.Yd.resize(0);
for(b=0;b<2*this.Lb.length;b++)this.Yd.add(b);this.xu(this.Yd,this.Yd.size,!0);this.Ne=this.Yd.size;-1!=this.eg&&(this.Rd.zh(this.eg),this.ck.resize(0),this.eg=-1);this.Zb=7;return this.YJ()};c.prototype.iU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.If&&(this.If=new f.ms(!0),this.$w=this.If.mf(),this.fg=new f.ia(0));this.If.bs();for(var b=0;b<this.Ad.length;b++){var d=this.Ad[b];this.If.ys(d.o,d.v)}this.If.yq();this.fg.yb(2*
this.Ad.length);this.fg.resize(0);for(b=0;b<2*this.Ad.length;b++)this.fg.add(b);this.xu(this.fg,this.fg.size,!1);this.nh=this.fg.size;-1!=this.dg&&(this.Rd.zh(this.dg),this.bk.resize(0),this.dg=-1);this.Zb=7;return this.ZJ()};c.prototype.kU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.Bd&&(this.Bd=new f.ms(!0),this.bp=this.Bd.mf(),this.Yd=new f.ia(0));null==this.If&&(this.If=new f.ms(!0),this.$w=this.If.mf(),this.fg=new f.ia(0));
this.Bd.bs();for(var b=0;b<this.Lb.length;b++){var d=this.Lb[b];this.Bd.ys(d.o,d.v)}this.Bd.yq();this.If.bs();for(b=0;b<this.Ad.length;b++)d=this.Ad[b],this.If.ys(d.o,d.v);this.If.yq();this.Yd.yb(2*this.Lb.length);this.fg.yb(2*this.Ad.length);this.Yd.resize(0);this.fg.resize(0);for(b=0;b<2*this.Lb.length;b++)this.Yd.add(b);for(b=0;b<2*this.Ad.length;b++)this.fg.add(b);this.xu(this.Yd,this.Yd.size,!0);this.xu(this.fg,this.fg.size,!1);this.Ne=this.Yd.size;this.nh=this.fg.size;-1!=this.eg&&(this.Rd.zh(this.eg),
this.ck.resize(0),this.eg=-1);-1!=this.dg&&(this.Rd.zh(this.dg),this.bk.resize(0),this.dg=-1);this.Zb=7;return!0};c.prototype.MY=function(){var b=this.Yd.get(--this.Ne),d=b>>1;if(c.Hm(b))return this.Bd.remove(d),0==this.Ne?(this.bg=this.sg=-1,this.Pc=!0,!1):!0;this.bp.cC(this.Lb[d].o,this.Lb[d].v,this.ta);this.sg=d;this.Zb=10;return!0};c.prototype.IY=function(){if(-1==--this.Ne)return this.bg=this.sg=-1,this.Pc=!0,!1;this.nh=this.sg=this.Ne;this.Zb=13;return!0};c.prototype.JY=function(){if(-1==--this.Ne)return this.bg=
this.sg=-1,this.Pc=!0,!1;this.sg=this.Ne;this.nh=this.Ad.length;this.Zb=14;return!0};c.prototype.KY=function(){var b=this.Yd.get(this.Ne-1),d=this.fg.get(this.nh-1),h=this.Ls(b,!0),f=this.Ls(d,!1);return h>f?this.ay():h<f?this.EC():c.IB(b)?this.ay():c.IB(d)?this.EC():this.ay()};c.prototype.ay=function(){var b=this.Yd.get(--this.Ne),d=b>>1;if(c.Hm(b))return-1!=this.eg&&-1!=this.ck.get(d)?(this.Rd.kd(this.eg,this.ck.get(d)),this.ck.set(d,-1)):this.Bd.remove(d),0==this.Ne?(this.bg=this.sg=-1,this.Pc=
!0,!1):!0;if(-1!=this.dg&&0<this.Rd.$s(this.dg))for(b=this.Rd.xc(this.dg);-1!=b;){var h=this.Rd.getData(b);this.If.eh(h);this.bk.set(h,-1);h=this.Rd.nb(b);this.Rd.kd(this.dg,b);b=h}0<this.If.size()?(this.$w.cC(this.Lb[d].o,this.Lb[d].v,this.ta),this.sg=d,this.Zb=12):(-1==this.eg&&(null==this.Rd&&(this.Rd=new f.Xp),this.ck=new f.ia(0),this.ck.resize(this.Lb.length,-1),this.ck.Zh(-1,0,this.Lb.length),this.eg=this.Rd.mi(1)),this.ck.set(d,this.Rd.addElement(this.eg,d)),this.Zb=7);return!0};c.prototype.EC=
function(){var b=this.fg.get(--this.nh),d=b>>1;if(c.Hm(b))return-1!=this.dg&&-1!=this.bk.get(d)?(this.Rd.kd(this.dg,this.bk.get(d)),this.bk.set(d,-1)):this.If.remove(d),0==this.nh?(this.bg=this.sg=-1,this.Pc=!0,!1):!0;if(-1!=this.eg&&0<this.Rd.$s(this.eg))for(b=this.Rd.xc(this.eg);-1!=b;){var h=this.Rd.getData(b);this.Bd.eh(h);this.ck.set(h,-1);h=this.Rd.nb(b);this.Rd.kd(this.eg,b);b=h}0<this.Bd.size()?(this.bp.cC(this.Ad[d].o,this.Ad[d].v,this.ta),this.bg=d,this.Zb=11):(-1==this.dg&&(null==this.Rd&&
(this.Rd=new f.Xp),this.bk=new f.ia(0),this.bk.resize(this.Ad.length,-1),this.bk.Zh(-1,0,this.Ad.length),this.dg=this.Rd.mi(0)),this.bk.set(d,this.Rd.addElement(this.dg,d)),this.Zb=7);return!0};c.prototype.BA=function(){this.bg=this.bp.next();if(-1!=this.bg)return!1;var b=this.Yd.get(this.Ne)>>1;this.Bd.eh(b);this.Zb=4;return!0};c.prototype.bV=function(){this.sg=this.bp.next();if(-1!=this.sg)return!1;this.bg=this.sg=-1;var b=this.fg.get(this.nh)>>1;this.If.eh(b);this.Zb=7;return!0};c.prototype.ZU=
function(){this.bg=this.$w.next();if(-1!=this.bg)return!1;var b=this.Yd.get(this.Ne)>>1;this.Bd.eh(b);this.Zb=7;return!0};c.prototype.$U=function(){if(-1==--this.nh)return this.Zb=5,!0;this.kr.I(this.Lb[this.Ne]);var b=this.Lb[this.nh];this.kr.O(this.ta,this.ta);return this.kr.Yb(b)?(this.bg=this.nh,!1):!0};c.prototype.aV=function(){if(-1==--this.nh)return this.Zb=6,!0;this.kr.I(this.Lb[this.Ne]);var b=this.Ad[this.nh];this.kr.O(this.ta,this.ta);return this.kr.Yb(b)?(this.bg=this.nh,!1):!0};c.prototype.ZJ=
function(){if(null==this.Bd)return this.Pc=!0,!1;this.Ne=this.Yd.size;0<this.Bd.size()&&this.Bd.reset();-1!=this.eg&&(this.Rd.zh(this.eg),this.ck.resize(0),this.eg=-1);this.Pc=!1;return!0};c.prototype.YJ=function(){if(null==this.If)return this.Pc=!0,!1;this.nh=this.fg.size;0<this.If.size()&&this.If.reset();-1!=this.dg&&(this.Rd.zh(this.dg),this.bk.resize(0),this.dg=-1);this.Pc=!1;return!0};c.prototype.xu=function(b,d,c){null==this.pn&&(this.pn=new f.Gu);c=new e(this,c);this.pn.sort(b,0,d,c)};c.prototype.CY=
function(b,d,h,f){var l=this;b.Gd(d,h,function(b,d){var h=l.Ls(b,f),q=l.Ls(d,f);return h<q||h==q&&c.Hm(b)&&c.IB(d)?-1:1})};c.prototype.Ls=function(b,d){var h=.5*this.ta;if(d)return d=this.Lb[b>>1],h=c.Hm(b)?d.A-h:d.B+h;d=this.Ad[b>>1];return h=c.Hm(b)?d.A-h:d.B+h};return c}();f.eD=a})(C||(C={}));(function(f){var a=function(){function a(){}a.pa=function(c,b,d,h,f,q){var l=new a;l.o=c;l.A=b;l.Bf=d;l.v=h;l.B=f;l.$g=q;return l};a.prototype.Oa=function(){this.Bf=this.o=NaN};a.prototype.u=function(){return isNaN(this.o)};
a.prototype.PU=function(){return isNaN(this.Bf)};a.prototype.I=function(c,b,d,h,f,q){void 0!==h?"number"===typeof c?(this.o=c,this.A=b,this.Bf=d,this.v=h,this.B=f,this.$g=q):(this.o=c.x-.5*b,this.v=this.o+b,this.A=c.y-.5*d,this.B=this.A+d,this.Bf=c.z-.5*h,this.$g=this.Bf+h):(this.o=c,this.A=b,this.Bf=d,this.v=c,this.B=b,this.$g=d)};a.prototype.move=function(c){this.o+=c.x;this.A+=c.y;this.Bf+=c.z;this.v+=c.x;this.B+=c.y;this.$g+=c.z};a.prototype.copyTo=function(c){c.o=this.o;c.A=this.A;c.v=this.v;
c.B=this.B};a.prototype.ml=function(c,b,d){this.o>c?this.o=c:this.v<c&&(this.v=c);this.A>b?this.A=b:this.B<b&&(this.B=b);0==isNaN(this.Bf)?this.Bf>d?this.Bf=d:this.$g<d&&(this.$g=d):this.$g=this.Bf=d};a.prototype.Nb=function(c,b,d,h,l,q){if("number"===typeof c)h?(this.Nb(c,b,d),this.Nb(h,l,q)):this.u()?(this.o=c,this.A=b,this.Bf=d,this.v=c,this.B=b,this.$g=d):this.ml(c,b,d);else if(c instanceof f.qd)this.Nb(c.x,c.y,c.z);else if(c instanceof a)c.u()||(this.Nb(c.o,c.A,c.Bf),this.Nb(c.v,c.B,c.$g));else throw f.f.F();
};a.prototype.pa=function(c,b,d){c.u()||b.u()?this.Oa():(this.o=c.ca,this.v=c.ha,this.A=b.ca,this.B=b.ha,this.Bf=d.ca,this.$g=d.ha)};a.prototype.OB=function(c){if(null==c||8>c.length)throw f.f.F();c[0]=new f.qd(this.o,this.A,this.Bf);c[1]=new f.qd(this.o,this.B,this.Bf);c[2]=new f.qd(this.v,this.B,this.Bf);c[3]=new f.qd(this.v,this.A,this.Bf);c[4]=new f.qd(this.o,this.A,this.$g);c[5]=new f.qd(this.o,this.B,this.$g);c[6]=new f.qd(this.v,this.B,this.$g);c[7]=new f.qd(this.v,this.A,this.$g)};a.prototype.Lx=
function(c){if(null==c||0==c.length)this.Oa();else{var b=c[0];this.I(b.x,b.y,b.z);for(b=1;b<c.length;b++){var d=c[b];this.ml(d.x,d.y,d.z)}}};return a}();f.cM=a})(C||(C={}));(function(f){(function(f){f.ya=function(){var f=Error();f.message="Internal Error";return f};f.df=function(){var f=Error();f.message="Not Implemented";return f};f.uk=function(){var f=Error();f.message="The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular";return f};f.La=function(){var f=
Error();f.message="Invalid Call";return f};f.F=function(f){var c=Error();c.message="Illegal Argument Exception";void 0!==f&&(c.message+=": "+f);return c};f.SN=function(){var f=Error();f.message="Runtime Exception.";return f};f.X=function(f){var c=Error();c.message="Geometry Exception: "+f;return c};f.IL=function(){var f=Error();f.message="Assert Failed Exception";return f};f.vd=function(){var f=Error();f.message="IndexOutOfBoundsException";return f};f.m_=function(f){f.message="UserCancelException";
return f}})(f.f||(f.f={}))})(C||(C={}));(function(f){f=f.Pm||(f.Pm={});f[f.forward=0]="forward";f[f.reverse=1]="reverse"})(C||(C={}));(function(f){var a=function(){function b(b,c){this.$a=b;this.UI=c;this.YI=-1;this.Wl=!1}b.prototype.Re=function(){return!0};b.prototype.next=function(){if(++this.YI==this.UI.D())return null;var b=this.UI.Aa(this.YI);b.scale(this.$a.mc);var c=new f.Ia;this.$a.Xy(b,this.Wl,c);return c};b.prototype.Ha=function(){return 0};return b}(),e=function(){function b(b,c,l){this.$a=
b;this.dx=c;this.Mo=!1;this.So=l;this.Ow=[0];this.Uk=[0];this.fk=[0];this.Bt=[0];this.Wl=!1;this.er=new f.Ia;this.Wk=[]}b.prototype.Re=function(){return!0};b.prototype.next=function(){if(this.Mo){this.Mo=!1;this.Cd.ba();var b=f.T.ne(this.er);return b=f.Dg.ol(b,this.$a.or,!0,!0,this.$a.lc)}null==this.Cd&&(this.Cd=this.dx.Da(),this.Cd.Ya(),null!=this.So&&this.So.Bl(null,0));if(!this.Cd.Ca()){if(!this.Cd.Ya())return null;null!=this.So&&this.So.Bl(null,0)}b=null;this.Uk[0]=0;this.kB=this.Ow[0]=0;this.Di=
NaN;this.Mo=!1;for(var h=this.Wk.length=0,l=new f.b,q=new f.b,a=[0];this.Cd.Ca()&&8>this.kB;){var e=this.Cd.ba();l.L(e.ec());q.L(e.Cc());l.scale(this.$a.mc);q.scale(this.$a.mc);f.Ej.Av(l,q)?l.x=q.x:f.Ej.yv(l,q)&&(q.x=l.x);this.Wk.length=0;f.Ej.FG(this.$a.Vb,this.$a.rc,this.$a.$e,l,q,this.$a.uB,this.$a.St,a,this.fk,this.Bt,this.Wk,this.Ow);null!=this.So&&(e=this.Wk.slice(0),this.So.DH(this.So.aa()-1,e,e.length-1));f.Ej.zv(l,q)?(this.er.Oa(),this.$a.Xy(l,this.Wl,this.er),this.Mo=!0):(this.er.Oa(),this.Mo=
this.cz(a[0],this.er));if(this.Mo){this.Cd.Li();if(this.Cd.nA()){this.Cd.Li();this.Cd.ba();break}this.Cd.yX();break}null==b&&(b=new f.Ia,b.Bl(null,0));this.cF(b);h++}this.Ow[0]=0;if(0<h){for(a=this.Cd.Db();0<h;)this.Cd.Li(),l.L(this.dx.Aa(this.Cd.Db())),q.L(this.dx.Aa(this.Cd.Ik())),l.scale(this.$a.mc),q.scale(this.$a.mc),this.Wl&&(f.Ej.Av(l,q)?l.x=q.x:f.Ej.yv(l,q)&&(q.x=l.x)),this.Wk.length=0,f.Ej.FG(this.$a.Vb,this.$a.rc,this.$a.$e,q,l,this.$a.uB,this.$a.St,null,this.fk,this.Bt,this.Wk,this.Ow),
this.cF(b),h--;l.L(this.dx.Aa(this.Cd.Db()));l.scale(this.$a.mc);c.Es(this.$a.Vb,this.$a.rc,this.$a.mc,this.$a.vb,l,this.Di+1.570796326794897,this.Di+4.71238898038469,this.$a.Qo,this.Wl,this.Uk,b,NaN,NaN);this.Cd.Tb(a);this.Cd.ba();h=f.ma.ah(null,b,!0);return b=f.Dg.ol(b,h,!0,!0,this.$a.lc)}this.Mo=!1;this.Cd.ba();b=f.T.ne(this.er);return b=f.Dg.ol(b,this.$a.or,!0,!0,this.$a.lc)};b.prototype.cF=function(b){var d=this.Wk[0],l,q=this.fk[0]-1.570796326794897,a=this.Bt[0]+1.570796326794897,e;if(!isNaN(this.Di)){this.Di>=
this.fk[0]?(l=this.Di+1.570796326794897,q=l+3.141592653589793-(this.Di-this.fk[0])):(l=this.Di+1.570796326794897,q=l+3.141592653589793-(6.283185307179586-(this.fk[0]-this.Di)));e=this.Di>=this.fk[0]&&3.141592653589793>=this.Di-this.fk[0]?!1:this.Di<this.fk[0]&&3.141592653589793<=this.fk[0]-this.Di?!1:!0;var k=!1;if(Math.abs(q-l)<=.5*this.$a.Qo)if(e){var F=b.Aa(b.D()-2);F.scale(this.$a.mc);var p=new f.ea(0);f.mb.Ez(this.$a.Vb,this.$a.rc,d.x,d.y,F.x,F.y,p);for(F=p.j;F<=l;)F+=6.283185307179586;for(;F>
l;)F-=6.283185307179586;F<q&&(k=!0)}else k=!0;k?(b.bC(0,b.D()-1),this.Wl||(d=new f.b,d.L(b.Aa(b.D()-1)),d.scale(this.$a.mc),-3.141592653589793>d.x-this.Uk[0]?this.Uk[0]-=6.283185307179586:3.141592653589793<d.x-this.Uk[0]&&(this.Uk[0]+=6.283185307179586)),e||(q=.5*(q+l))):(e?(l=new f.b,l.L(d),l.scale(1/this.$a.mc),b.Zf(0,-1,l)):c.Es(this.$a.Vb,this.$a.rc,this.$a.mc,this.$a.vb,this.Wk[0],l,q,this.$a.Qo,this.Wl,this.Uk,b,NaN,NaN),this.kB+=1)}c.Wy(this.$a.Vb,this.$a.rc,this.$a.mc,this.$a.vb,this.$a.$e,
this.Wk,q,a,this.Wl,this.Uk,b);this.Di=this.Bt[0]};b.prototype.cz=function(b,c){return this.$a.cz(this.Wk,b,this.fk[0],this.Bt[0],this.Wl,c)};b.prototype.Ha=function(){return 0};return b}(),c=function(){function b(){}b.buffer=function(d,c,l,q,a,e){if(null==d)throw f.f.F("Geometry::Geodesic_bufferer::buffer");if(d.u())return new f.Ia(d.description);var h=new b;h.mh=c;h.Qc=f.fb.kc(c);var v=f.fb.gw(h.Qc);h.lc=e;h.Vb=f.fb.Rv(h.Qc);h.rc=v*(2-v);h.mc=h.Qc.Od().Ai;h.ta=h.mh.Bo();h.or=h.Qc.Bo();h.St=h.or*
h.mc;h.nr=1.570796326794897/h.mc;h.D_=3.141592653589793/h.mc;h.Dt=6.283185307179586/h.mc;h.E_=h.Dt/6;h.pB=0;h.C_=1.5707963267948966*h.Vb/h.pB;4==l?(h.$e=2,h.Iw=!0):(h.$e=l,h.Iw=!1);h.Qa=q;h.vb=Math.abs(q);isNaN(a)||.001>a?h.rY():h.Po=a;l=d.G();f.T.Oc(l)?(l=new f.Ua(d.description),l.dc(d,!0),d=l,l=1607):197==l&&(l=new f.h,d.s(l),l.N()<=h.ta||l.fa()<=h.ta?(l=new f.Ua(d.description),l.jd(d,!1),d=l,l=1607):(l=new f.Ia(d.description),l.jd(d,!1),d=l,l=1736));h.sY();f.T.Jo(l)||h.tY();if(h.vb<=.5*h.Po)return 1736!=
l?new f.Ia(d.description):h.Iw?d:f.Ej.Ks(d,h.mh,h.$e,h.uB,-1,e);if(0>h.Qa&&1736!=l)return new f.Ia(d.description);h.Iw&&f.T.Ic(l)?(c=f.Ej.Ks(d,c,4,NaN,h.Po,e),d=f.fb.Xg(c,h.mh,h.Qc,e)):d=f.fb.Xg(d,h.mh,h.Qc,e);d=f.gi.Mj(d,h.Qc);if(d.u())return new f.Ia(d.description);!h.Iw&&f.T.Ic(l)&&(d=f.Ej.yJ(h.mc,d));d=b.lQ(d,h.Qc);switch(l){case 1736:e=h.WP(d);break;case 1607:e=h.XP(d);break;case 550:e=h.UP(d);break;case 33:e=h.VP(d);break;default:throw f.f.X("corrupted_geometry");}h=f.fb.Xg(e,h.Qc,h.mh,h.lc);
h.om(d.description);return h};b.prototype.WP=function(b){var d=new f.Ia;b=new e(this,b,d);b=f.ei.local().V(b,this.Qc,this.lc).next();b=f.Vp.Nj(b,this.Qc,2);var c=new f.Hd;c.scale(1/this.mc,1/this.mc);d.Xc(c);d=f.Vp.Nj(d,this.Qc,2);return 0<=this.Qa?f.ei.local().V(d,b,this.Qc,this.lc):f.cq.local().V(d,b,this.Qc,this.lc)};b.prototype.XP=function(b){b=new e(this,b,null);b=f.ei.local().V(b,this.Qc,this.lc).next();return b=f.Vp.Nj(b,this.Qc,2)};b.prototype.UP=function(b){b=new a(this,b);b=f.ei.local().V(b,
this.Qc,this.lc).next();return b=f.Vp.Nj(b,this.Qc,2)};b.prototype.VP=function(b){b=b.w();b.scale(this.mc);var d=new f.Ia;this.Xy(b,!1,d);return d=f.Vp.Nj(d,this.Qc,2)};b.prototype.cz=function(d,c,l,q,a,e){var h=d[0],v=d[d.length-1],D=h.y>v.y?h.y:v.y,k=f.C.q(this.Vb,this.rc,h.y<v.y?h.y:v.y),D=f.C.q(this.Vb,this.rc,D);if(.001<this.pB-(k+c+this.vb)&&.001<this.pB+(D-c-this.vb))return!1;c=l-1.570796326794897;l=q+1.570796326794897;var k=c-3.141592653589793,D=c+3.141592653589793,p=l+3.141592653589793,g=
[NaN],n=[NaN],E=[NaN],u=[NaN];q=!1;b.yD(this.Vb,this.rc,this.vb,h,c,k,v,l,g,n);b.yD(this.Vb,this.rc,this.vb,v,p,l,h,k,E,u);l<g[0]&&g[0]<p?q=!0:l<n[0]&&n[0]<p&&(q=!0);q||(k<E[0]&&E[0]<c?q=!0:k<u[0]&&u[0]<c&&(q=!0));if(!q&&a)return!1;for(var z=[],r=d.length-1;0<=r;r--)z.push(d[r]);e.Oa();e.Bl(null,0);r=[0];b.Wy(this.Vb,this.rc,this.mc,this.vb,this.$e,d,c,l,a,r,e);b.Es(this.Vb,this.rc,this.mc,this.vb,v,l,p,this.Qo,a,r,e,g[0],n[0]);b.Wy(this.Vb,this.rc,this.mc,this.vb,this.$e,z,p,D,a,r,e);b.Es(this.Vb,
this.rc,this.mc,this.vb,h,k,c,this.Qo,a,r,e,E[0],u[0]);d=!1;a||(d=this.NF(this.mc,e));return q||d};b.prototype.Xy=function(d,c,f){f.Oa();f.Bl(null,0);b.Es(this.Vb,this.rc,this.mc,this.vb,d,-this.Qo,6.283185307179586,this.Qo,c,[0],f,NaN,NaN);c||this.NF(this.mc,f)};b.prototype.NF=function(b,c){var d=this.xQ(b,c);b=this.yQ(b,c);return d||b};b.prototype.xQ=function(b,c){var d=c.D(),h=!1,a=new f.h;c.s(a);if(!f.l.W(a.B*b,1.570796326794897)&&!f.l.W(a.A*b,-1.570796326794897))return!1;for(var e=new f.b,d=
d-1;0<=d;d--)c.w(d,e),e.y==a.B&&f.l.W(e.y*b,1.570796326794897)?(h=!0,this.HJ(e,d,c)):e.y==a.A&&f.l.W(e.y*b,-1.570796326794897)&&(h=!0,this.HJ(e,d,c));return h};b.prototype.yQ=function(b,c){var d=c.Aa(0),h=c.Aa(c.D()-1);return 3.141592653589793<Math.abs(d.x-h.x)*b?(this.MW(c),!0):this.wQ(c)};b.prototype.wQ=function(b){return 0>b.hf()?(this.LW(b),!0):!1};b.prototype.HJ=function(b,c,l){var d=l.D(),h=0<c?c-1:d-1,d=l.Aa(c<d-1?c+1:0),h=l.Aa(h);if(!f.l.W(d.y,b.y)&&!f.l.W(d.x,b.x)){var a=new f.b;a.ka(d.x,
b.y);l.rb(c,a)}f.l.W(h.y,b.y)||f.l.W(h.x,b.x)||(d=new f.b,d.ka(h.x,b.y),l.Zf(0,c,d))};b.prototype.MW=function(b){var d=new f.Ia,c=new f.Ia,q=new f.Hd,a=b.Aa(0),e=b.Aa(b.D()-1),k=new f.b;a.x>e.x?(e=this.nr,q.Ag(-this.Dt,0)):(e=-this.nr,q.Ag(this.Dt,0));d.add(b,!1);b.Oa();c.add(d,!1);c.Xc(q);a=new f.h;c.s(a);a.O((this.Dt-a.N())/2,0);a.A=-this.nr;a.B=this.nr;for(var F=0;F<c.D();F++)c.w(F,k),d.Zf(0,-1,k);c.Xc(q);for(F=0;F<c.D();F++)c.w(F,k),d.Zf(0,-1,k);c=d.Aa(0);q=d.Aa(d.D()-1);k.ka(q.x,e);d.Zf(0,-1,
k);k.ka(.5*(q.x+c.x),e);d.Zf(0,-1,k);k.ka(c.x,e);d.Zf(0,-1,k);d=f.gi.gt(d,this.Qc,2,!0,a.o);d=f.gi.gt(d,this.Qc,2,!0,a.v);d=f.me.clip(d,a,this.or,NaN);b.add(d,!1)};b.prototype.LW=function(b){var d=new f.h;b.s(d);d.O((this.Dt-d.N())/2,0);d.A=-this.nr;d.B=this.nr;b.Bl(null,0);var c=new f.b;c.ka(d.o,d.A);b.Zf(1,-1,c);c.ka(d.o,d.B);b.Zf(1,-1,c);c.ka(.5*(d.o+d.v),d.B);b.Zf(1,-1,c);c.ka(d.v,d.B);b.Zf(1,-1,c);c.ka(d.v,d.A);b.Zf(1,-1,c);c.ka(.5*(d.o+d.v),d.A);b.Zf(1,-1,c)};b.Wy=function(d,c,l,q,a,e,k,F,p,
g,n){var h=null;p||(h=new f.b,h.$c(),0<n.D()&&(h.L(n.Aa(n.D()-1)),h.scale(l)));var v=new f.ea(0),D=new f.ea(0),H=new f.ea(0),E=new f.b,u=new f.b,G=e[e.length-1];l=1/l;for(var z=0;z<e.length;z++){var r=e[z],t;0==z?t=k:z==e.length-1?t=F:(f.mb.Md(d,c,G.x,G.y,r.x,r.y,null,null,v,a),t=v.j-1.570796326794897);f.mb.Xi(d,c,r.x,r.y,q,t,D,H);p?u.ka(D.j,H.j):(E.ka(D.j,H.j),b.KF(r.x,E.x,h.x,g),u.ka(g[0]+E.x,E.y),h.L(u));u.scale(l);n.Zf(0,-1,u)}};b.Es=function(d,c,l,q,a,e,k,F,p,g,n,E,u){if(!(k-e<F)){var h=new f.ea(0),
v=new f.ea(0),D=new f.b,H=new f.b,G=null;p||(G=new f.b,G.$c(),0<n.D()&&(G.L(n.Aa(n.D()-1)),G.scale(l)));var z=f.J.truncate(Math.ceil(e/F)),r=z++*F;r==e&&(r=z++*F);for(l=1/l;r<k+F;){e<E&&E<r?(r=E,z--):e<u&&u<r&&(r=u,z--);if(r>=k)break;f.mb.Xi(d,c,a.x,a.y,q,r,h,v);p?H.ka(h.j,v.j):(D.ka(h.j,v.j),b.KF(a.x,D.x,G.x,g),H.ka(g[0]+D.x,D.y),G.L(H));H.scale(l);n.Zf(0,-1,H);e=r;r=z++*F}}};b.yD=function(b,c,l,q,a,e,k,F,p,g){var d=new f.b,h=new f.b,v=new f.ea(0),D=new f.ea(0);f.mb.Xi(b,c,q.x,q.y,l,a,v,D);d.ka(v.j,
D.j);f.mb.Xi(b,c,q.x,q.y,l,e,v,D);h.ka(v.j,D.j);l=new f.ea(0);f.mb.Ez(b,c,k.x,k.y,d.x,d.y,l);p[0]=l.j;f.mb.Ez(b,c,k.x,k.y,h.x,h.y,l);for(g[0]=l.j;p[0]<=g[0];)p[0]+=6.283185307179586;for(;p[0]>g[0];)p[0]-=6.283185307179586;for(;p[0]>=F;)p[0]-=6.283185307179586,g[0]-=6.283185307179586;for(;p[0]<F;)p[0]+=6.283185307179586,g[0]+=6.283185307179586};b.KF=function(b,c,f,q){if(isNaN(f)){for(;3.141592653589793<q[0]+c-b;)q[0]-=6.283185307179586;for(;3.141592653589793<b-(q[0]+c);)q[0]+=6.283185307179586}else 3.141592653589793<
q[0]+c-f?q[0]-=6.283185307179586:3.141592653589793<f-(q[0]+c)&&(q[0]+=6.283185307179586)};b.lQ=function(b,c){var d=b.G(),h;f.T.Ic(d)?h=b.aa():550==d?h=b.D():h=1;if(1==h)return b;var a=new f.ia(0);a.resize(h);for(var e=[],k=new f.h,F=0;F<h;F++){a.write(F,F);var p;f.T.Ic(d)?(b.ik(F,k),p=k.Wf()):p=b.Aa(F);p=f.rM.SY(c,p);e[F]=p}a.Gd(0,a.size,function(b,d){return e[b]<e[d]?-1:e[b]>e[d]?1:0});k=b.Ja();for(F=0;F<h;F++)p=a.read(F),f.T.Ic(d)?k.Ti(b,p,!0):k.Jd(b,p,p+1);return k};b.prototype.sY=function(){var b=
Math.min(3.141592653589793*this.Vb-this.vb,this.vb),b=Math.min(b,.39269908169872414*this.Vb),c=new f.b;c.ka(0,10*this.mc);var l=45*this.mc,q=new f.ea(0),a=new f.ea(0),e=new f.ea(0),k=new f.ea(0),F=new f.ea(0),p=new f.ea(0),g=new f.ea(0),n=new f.ea(0),E=new f.b,u=new f.b,z=new f.b,r=new f.b;f.mb.Xi(this.Vb,this.rc,c.x,c.y,b,0,q,a);E.ka(q.j,a.j);f.mb.Xi(this.Vb,this.rc,c.x,c.y,b,l,e,k);u.ka(e.j,k.j);for(var q=new f.ea(0),a=new f.ea(0),t=new f.ea(0);;){f.mb.Xi(this.Vb,this.rc,c.x,c.y,b,.5*(0+l),F,p);
z.ka(F.j,p.j);f.mb.Md(this.Vb,this.rc,E.x,E.y,u.x,u.y,q,a,null,2);f.mb.Oj(this.Vb,this.rc,E.x,E.y,.5*q.j,a.j,g,n,2);r.ka(g.j,n.j);f.mb.Md(this.Vb,this.rc,z.x,z.y,r.x,r.y,t,null,null,2);if(t.j<=this.Po)break;l*=.9;f.mb.Xi(this.Vb,this.rc,c.x,c.y,b,l,e,k);u.ka(e.j,k.j)}this.Qo=6.283185307179586/Math.ceil(6.283185307179586/(l-0))};b.prototype.tY=function(){var b=Math.min(3.141592653589793*this.Vb-this.vb,this.vb),b=Math.min(b,.39269908169872414*this.Vb),c=new f.b,l=new f.b;c.ka(0,10*this.mc);l.ka(10*
this.mc,10*this.mc);var q=new f.ea(0),a=new f.ea(0),e=new f.ea(0);f.mb.Md(this.Vb,this.rc,c.x,c.y,l.x,l.y,e,q,a,this.$e);var k=new f.ea(0),F=new f.ea(0),p=new f.ea(0),g=new f.ea(0),n=new f.b,E=new f.ea(0),u=new f.ea(0),z=new f.ea(0),r=new f.ea(0),t=new f.ea(0),A=new f.ea(0),m=new f.ea(0),w=new f.ea(0),x=new f.ea(0),C=new f.b,I=new f.b,J=new f.b,K=new f.b,y=1,q=q.j,a=a.j+1.570796326794897,e=e.j;f.mb.Xi(this.Vb,this.rc,c.x,c.y,b,q-1.570796326794897,u,z);C.ka(u.j,z.j);f.mb.Xi(this.Vb,this.rc,l.x,l.y,
b,a,r,t);I.ka(r.j,t.j);for(var u=new f.ea(0),z=new f.ea(0),a=new f.ea(0),M=new f.ea(0);;){f.mb.Oj(this.Vb,this.rc,c.x,c.y,.5*(0+y)*e,q,k,F,this.$e);n.ka(k.j,F.j);f.mb.Md(this.Vb,this.rc,c.x,c.y,n.x,n.y,null,null,E,this.$e);f.mb.Xi(this.Vb,this.rc,n.x,n.y,b,E.j+1.570796326794897,A,m);J.ka(A.j,m.j);f.mb.Md(this.Vb,this.rc,C.x,C.y,I.x,I.y,u,z,null,2);f.mb.Oj(this.Vb,this.rc,C.x,C.y,.5*u.j,z.j,w,x,2);K.ka(w.j,x.j);f.mb.Md(this.Vb,this.rc,J.x,J.y,K.x,K.y,a,null,null,2);if(a.j<=this.Po)break;y*=.9;f.mb.Oj(this.Vb,
this.rc,c.x,c.y,y*e,q,p,g,this.$e);l.ka(p.j,g.j);f.mb.Md(this.Vb,this.rc,c.x,c.y,l.x,l.y,null,null,M,this.$e);f.mb.Xi(this.Vb,this.rc,l.x,l.y,b,M.j+1.570796326794897,r,t);I.ka(r.j,t.j)}b=y*e;1E5<b&&(b=1E5);this.uB=b};b.prototype.rY=function(){var b;b=5E4<this.vb?100:1E4<this.vb?10:1;500>this.vb/b&&(b=this.vb/500);.01>b&&(b=.01);this.Po=b};return b}();f.qM=c})(C||(C={}));(function(f){var a=function(){function a(){}a.uc=function(c,b){var d=new f.b;d.L(b);c.push(d)};a.qk=function(c,b){c.add(b.x);c.add(b.y)};
a.XC=function(c){c.yf(c.size-2)};a.ny=function(c,b){b.ka(c.get(c.size-2),c.get(c.size-1))};a.Ks=function(c,b,d,h,l,q){if(null==c)throw f.f.F();var v=c.G();if(c.u()||f.T.Jo(v))return c;var e=new a;e.mh=b;e.Qc=f.fb.kc(b);var k=f.fb.gw(e.Qc);e.lc=q;e.Vb=f.fb.Rv(e.Qc);e.rc=k*(2-k);e.mc=e.Qc.Od().Ai;e.or=e.Qc.Bo();e.St=e.or*e.mc;e.fB=h;e.eB=l;e.$e=d;197==v?(d=new f.Ia(c.description),d.jd(c,!1)):f.T.Oc(v)?(d=new f.Ua(c.description),d.dc(c,!0)):d=c;if(4!=e.$e){b=0==e.mh.Eb(e.Qc)?f.fb.Xg(d,e.mh,e.Qc,q):f.gi.Mj(d,
e.Qc);if(b.u())return b;b=a.yJ(e.mc,b);b=e.Fz(b);b=f.Vp.Nj(b,e.Qc,e.$e);e=f.fb.Xg(b,e.Qc,e.mh,q)}else{2==f.Td.Fb(b)?(c=f.fb.Lk(b),q=f.sk.local().V(d,c,b,q),q==c&&(q=new f.Ia,c.copyTo(q))):q=f.gi.Mj(d,e.Qc);b=q;if(b.u())return b;e=e.vY(b)}return e};a.yJ=function(c,b){var d=new f.h;b.ac(d);if(3.141592653589793>d.N()*c)return b;for(var h=!1,d=b.Da(),l=new f.b,q=new f.b;d.Ya();)for(;d.Ca();){var v=d.ba();l.L(v.ec());q.L(v.Cc());l.scale(c);q.scale(c);if(3.141592653589793<Math.abs(l.x-q.x)){var e=a.zv(l,
q);if(!e){h=!0;break}if(6.283185307179586<Math.abs(l.x-q.x)){h=!0;break}}}if(!h)return b;var h=b.Ja(),k=1<b.description.Ea,F=new f.b,p=new f.b,g=new f.b,n=new f.b,u=new f.Wa;for(d.yj();d.Ya();)for(var E=NaN,z=[0];d.Ca();){v=d.ba();l.L(v.ec());q.L(v.Cc());l.scale(c);q.scale(c);isNaN(E)?(a.ee(l.x,NaN,z),p.L(l)):p.L(g);E=p.x;if(e=a.zv(l,q)){if(6.283185307179586<q.x-l.x)for(;6.283185307179586<q.x-l.x;)q.x-=6.283185307179586;if(-6.283185307179586>q.x-l.x)for(;-6.283185307179586>q.x-l.x;)q.x+=6.283185307179586;
a.ee(q.x,NaN,z);g.L(q)}else F.L(q),a.UM(F),a.ee(F.x,E,z),g.ka(z[0]+F.x,F.y);.5>Math.abs(g.x-q.x)&&g.L(q);k?(v.Ex(0,u),n.L(p),n.scale(1/c),u.rb(n),(e=d.kn())?h.Rf(u):h.lineTo(u),d.Io()&&!b.Qb(d.Ta)&&(v.Ex(1,u),n.L(g),n.scale(1/c),u.rb(n),h.lineTo(u))):((e=d.kn())&&h.qA(null,0),v=h.aa()-1,n.L(p),n.scale(1/c),h.Zf(v,-1,n),d.Io()&&!b.Qb(d.Ta)&&(n.L(g),n.scale(1/c),h.Zf(v,-1,n)))}return h};a.FG=function(c,b,d,h,l,q,v,e,k,F,p,g){var D=new f.b,n=new f.b,u=0<h.compare(l);a.pF(u,h,l,D,n);a.uG(c,b,d,D,n,q,
NaN,v,e,k,F,null,p,g);u&&a.py(k,F,null,p)};a.prototype.Fz=function(c){var b=c.Ja(),d=c.Da(),h=[],l=null,q=null,v=1<c.description.Ea;v&&(l=new f.Sd(0),q=new f.Cg);for(var e=[0],k=new f.b,F=new f.b,p=new f.b,g=new f.b;d.Ya();)for(e[0]=0;d.Ca();){var n=d.ba();k.L(n.ec());F.L(n.Cc());k.scale(this.mc);F.scale(this.mc);var u=0<k.compare(F);a.pF(u,k,F,p,g);h.length=0;null!=l&&l.yf(0);0<this.fB?a.uG(this.Vb,this.rc,this.$e,p,g,this.fB,this.eB,this.St,null,null,null,v?l:null,h,e):a.QV(this.Vb,this.rc,this.$e,
p,g,this.eB,this.St,v?l:null,h,e);u&&a.py(null,null,v?l:null,h);h[0].L(n.ec());h[h.length-1].L(n.Cc());for(var E=1;E<h.length-1;E++)h[E].scale(1/this.mc);v?(u=a.RE(u,n,q),a.hE(d.kn(),d.Io()&&!c.Qb(d.Ta),n,u,l,h,b)):a.fE(d.kn(),d.Io()&&!c.Qb(d.Ta),h,b)}return b};a.prototype.vY=function(c){var b=c.Ja(),d=c.Da(),h=[],l=null,q=new f.Cg,v=1<c.description.Ea;for(v&&(l=new f.Sd(0));d.Ya();)for(;d.Ca();){var e=d.ba(),k=e.ec(),p=e.Cc(),k=0<k.compare(p),p=a.RE(k,e,q);h.length=0;null!=l&&l.yf(0);a.EL(this.Vb,
this.rc,this.mc,p,this.mh,this.fB,this.eB,v?l:null,h);k&&a.py(null,null,v?l:null,h);v?a.hE(d.kn(),d.Io()&&!c.Qb(d.Ta),e,p,l,h,b):a.fE(d.kn(),d.Io()&&!c.Qb(d.Ta),h,b)}return b};a.fE=function(c,b,d,h){c&&h.qA(null,0);c=h.aa()-1;var f=d.slice(0);h.DH(c,f,f.length-1);b&&h.Zf(c,-1,d[d.length-1])};a.hE=function(c,b,d,h,l,q,a){var v=new f.Wa;d.Dp(v);c?a.Rf(v):a.lineTo(v);if(2<q.length){c=h.Rb();for(var e=1;e<q.length-1;e++){var k=h.aI(l.get(e)*c);h.Ex(k,v);v.rb(q[e]);a.lineTo(v)}}b&&(d.Bp(v),a.lineTo(v))};
a.uG=function(c,b,d,h,l,q,v,e,k,p,g,n,u,E){var D=new f.ea(0),F=new f.ea(0),H=new f.ea(0);f.mb.Md(c,b,h.x,h.y,l.x,l.y,H,D,F,d);var H=H.j,z=D=D.j,F=F.j;0>z&&(z+=6.283185307179586);0>F&&(F+=6.283185307179586);null!=k&&(k[0]=H);null!=p&&(p[0]=z);null!=g&&(g[0]=F);p=k=NaN;null!=n&&(p=f.C.Yg(c,b),g=f.C.q(c,b,h.y),k=(p-g)/H,p=(p+g)/H);g=a.Av(h,l);var F=a.yv(h,l),z=g||F,G=a.sE(h,l,e),r=new f.ea(0),t=new f.ea(0),A=new f.b,m=new f.b,w=new f.b;a.ee(h.x,NaN,E);var x=[E[0]];if(H<=q)a.uc(u,h),a.ee(l.x,NaN,E),null!=
n&&n.add(0),z?(g&&a.ly(h,l,n,u),F&&a.hy(h,l,n,u)):G?a.ky(h,l,D,k,p,n,u):0<v&&(m.ka(h.x-x[0],h.y),A.ka(l.x-E[0],l.y),a.EA(c,b,d,h,H,D,m,A,0,1,v,n,u,x)),a.uc(u,l);else{q=1+f.J.truncate(Math.ceil(H/q));var C=H/(q-1),I=new f.b,J=0;a.uc(u,h);I.L(h);m.ka(h.x-E[0],h.y);null!=n&&n.add(0);for(var K=1;K<q;K++){var y;K<q-1?(f.mb.Oj(c,b,h.x,h.y,K*C,D,r,t,d),A.ka(r.j,t.j),a.ee(A.x,I.x,E),w.ka(E[0]+A.x,A.y),y=K/(q-1)):(a.ee(l.x,NaN,E),A.ka(l.x-E[0],l.y),w.L(l),y=1);z?(1==K&&g&&a.ly(h,w,n,u),K==q-1&&F&&a.hy(I,l,
n,u)):G?a.qE(I,w,e)&&(h.x<l.x?I.x>w.x&&(E[0]+=6.283185307179586,w.ka(E[0]+A.x,A.y)):I.x<w.x&&(E[0]-=6.283185307179586,w.ka(E[0]+A.x,A.y)),a.ky(I,w,D,k,p,n,u)):0<v&&a.EA(c,b,d,h,H,D,m,A,J,y,v,n,u,x);a.uc(u,w);null!=n&&n.add(y);I.L(w);m.L(A);x[0]=E[0];J=y}}};a.QV=function(c,b,d,h,l,q,v,e,k,p){var D=new f.ea(0),F=new f.ea(0),g=new f.ea(0);f.mb.Md(c,b,h.x,h.y,l.x,l.y,g,D,F,d);var F=g.j,D=D.j,n=g=NaN;if(null!=e)var n=f.C.Yg(c,b),u=f.C.q(c,b,h.y),g=(n-u)/F,n=(n+u)/F;var u=a.Av(h,l),H=a.yv(h,l),E=u||H;v=
a.sE(h,l,v);var z=a.zv(h,l),z=E||v||z;a.ee(h.x,NaN,p);var r=new f.b;a.uc(k,h);r.L(h);null!=e&&e.add(0);z?(E?(u&&a.ly(h,l,e,k),H&&a.hy(h,l,e,k)):v&&a.ky(h,l,D,g,n,e,k),a.ee(l.x,NaN,p),a.uc(k,l)):F<=q?(a.ee(l.x,NaN,p),a.uc(k,l)):(g=new f.b,v=new f.b,g.L(h),v.L(l),g.x-=p[0],v.x-=p[0],-3.141592653589793>v.x?v.x+=6.283185307179586:3.141592653589793<v.x&&(v.x-=6.283185307179586),a.EA(c,b,d,h,F,D,g,v,0,1,q,e,k,p),a.uc(k,l),a.ee(l.x,NaN,p));null!=e&&e.add(1)};a.EA=function(c,b,d,h,l,q,v,e,k,p,g,n,u,E){var D=
new f.b,F=new f.b;D.ka(v.x+E[0],v.y);new f.ea(0);new f.ea(0);new f.ea(0);new f.ea(0);var H=new f.ea(0),z=new f.ea(0),G=new f.ea(0),r=new f.b,t=new f.b,A=new f.b,m=new f.b;r.L(v);t.L(e);v=new f.Sd(0);e=new f.Sd(0);a.qk(v,t);e.add(p);var w=new f.b,x=new f.Hb,C=[];for(a.qG(4,C);0<v.size;){for(var I=!1,J,K=NaN,y=0;3>y;y++)if(J=C[y]*p+(1-C[y])*k,f.mb.Oj(c,b,h.x,h.y,J*l,q,H,z,d),A.ka(H.j,z.j),0==y&&(K=J,m.L(A)),a.wO(r,A,t,x),x.gc(x.oe(A,!0),w),f.mb.Md(c,b,A.x,A.y,w.x,w.y,G,null,null,2),G.j>g){I=!0;break}I?
(t.L(m),p=K,a.qk(v,t),e.add(p)):(a.XC(v),e.Ek(e.size-1,1,e.size-1),0<v.size&&(a.ee(t.x,D.x,E),F.ka(E[0]+t.x,t.y),a.uc(u,F),D.L(F),null!=n&&n.add(p),r.L(t),k=p,a.ny(v,t),p=e.get(e.size-1)))}};a.EL=function(c,b,d,h,l,q,v,e,k){var D=new f.b,p=new f.b,g=new f.b,n=new f.b,u=new f.b,H=new f.b,E=new f.b,z=new f.b,r=new f.b,t=new f.b,A=new f.ea(0),m=new f.ea(0),w=new f.b,x=[[],[]],C=1==f.Td.Fb(l);l=l.re(0);var I=h.ec(),J=h.Cc();C?(H.ka(I.x*d,I.y*d),E.ka(J.x*d,J.y*d)):(x[0][0]=I.x,x[0][1]=I.y,x[1][0]=J.x,
x[1][1]=J.y,f.fb.ku(),H.x=x[0][0]*d,H.y=x[0][1]*d,E.x=x[1][0]*d,E.y=x[1][1]*d);var K=0,y=0,M=1,O=h.Go();D.L(I);p.L(J);var J=new f.Sd(0),P=new f.Sd(0),L=new f.Sd(0);a.qk(J,p);a.qk(P,E);L.add(M);a.uc(k,D);null!=e&&e.add(y);var N=[],B;B=0<v?O?5:3:O?5:1;a.qG(B,N);for(var U=new f.ea(0),aa=new f.ea(0),R=new f.ea(0),W=new f.ea(0),T=new f.ea(0),Q=new f.ea(0),S=new f.ea(0);0<P.size;){var V=!1,Y,X=NaN;f.mb.Md(c,b,H.x,H.y,E.x,E.y,U,aa,null,2);for(I=0;I<B;I++){if(0==I){if(!O&&0>=v&&U.j<=q&&3.141592653589793>
Math.abs(H.x-E.x))break;if(h.Cy(y,M)<=l)break}Y=N[I]*M+(1-N[I])*y;h.gc(Y,g);C?z.ka(g.x*d,g.y*d):(x[0][0]=g.x,x[0][1]=g.y,f.fb.ku(),z.x=x[0][0]*d,z.y=x[0][1]*d);if(0==I&&(X=Y,u.L(g),t.L(z),0<q&&(U.j>q||3.141592653589793<=Math.abs(H.x-E.x)))){V=!0;break}if(O&&0<q){if(f.mb.Md(c,b,H.x,H.y,z.x,z.y,R,null,null,2),R.j>q||3.141592653589793<=Math.abs(H.x-z.x)){V=!0;break}}else if(0<v)if(O?(n.HU(D,p,N[I]),C?r.ka(n.x*d,n.y*d):(x[0][0]=n.x,x[0][1]=n.y,f.fb.ku(),r.x=x[0][0]*d,r.y=x[0][1]*d)):(n.L(g),r.L(z)),f.mb.Md(c,
b,H.x,H.y,r.x,r.y,W,null,null,2),W.j<=U.j){f.mb.Oj(c,b,H.x,H.y,W.j,aa.j,A,m,2);w.ka(A.j,m.j);f.mb.Md(c,b,w.x,w.y,z.x,z.y,T,null,null,2);if(T.j>v){V=!0;break}if(O){f.mb.Md(c,b,w.x,w.y,r.x,r.y,Q,null,null,2);if(Q.j>v){V=!0;break}f.mb.Md(c,b,r.x,r.y,z.x,z.y,S,null,null,2);if(S.j>v){V=!0;break}}}else{V=!0;break}}V?(p.L(u),E.L(t),M=X,a.qk(J,p),a.qk(P,E),L.add(M)):(a.XC(J),a.XC(P),L.Ek(L.size-1,1,L.size-1),a.uc(k,p),K+=U.j,null!=e&&e.add(K),0<P.size&&(D.L(p),H.L(E),y=M,a.ny(J,p),a.ny(P,E),M=L.get(L.size-
1)))}if(null!=e)for(c=1/K,I=0;I<e.size;I++)e.write(I,e.read(I)*c)};a.py=function(c,b,d,h){h.reverse();null!=d&&d.Zd(0,d.size,1);d=null!=c?c[0]:NaN;h=null!=b?b[0]:NaN;null!=c&&(c[0]=h);null!=b&&(b[0]=d)};a.pF=function(c,b,d,h,f){c?(h.L(d),f.L(b)):(h.L(b),f.L(d))};a.RE=function(c,b,d){if(!c)return b;d.create(b.G());b.copyTo(d.get());d.get().reverse();return d.get()};a.ee=function(c,b,d){if(isNaN(b)){for(;3.141592653589793<d[0]-c;)d[0]-=6.283185307179586;for(;3.141592653589793<c-d[0];)d[0]+=6.283185307179586}else 3.141592653589793<
d[0]+c-b?d[0]-=6.283185307179586:3.141592653589793<b-(d[0]+c)&&(d[0]+=6.283185307179586)};a.wO=function(c,b,d,h){3.141592653589793>Math.abs(b.x-c.x)?(h.Mc(c),3.141592653589793<=d.x-c.x?h.vm(d.x-6.283185307179586,d.y):3.141592653589793<=c.x-d.x?h.vm(d.x+6.283185307179586,d.y):h.vm(d.x,d.y)):(h.Mc(d),3.141592653589793<=c.x-d.x?h.vm(c.x-6.283185307179586,c.y):3.141592653589793<=d.x-c.x?h.vm(c.x+6.283185307179586,c.y):h.vm(c.x,c.y))};a.qG=function(c,b){for(var d=0;d<c;d++){var h=Math.ceil(d/2)/(c+1);
0!=d%2&&(h=-h);b[d]=.5+h}};a.Av=function(c,b){return f.l.W(c.y,1.570796326794897)&&!f.l.W(b.y,1.570796326794897)||f.l.W(c.y,-1.570796326794897)&&!f.l.W(b.y,-1.570796326794897)?!0:!1};a.yv=function(c,b){return f.l.W(b.y,1.570796326794897)&&!f.l.W(c.y,1.570796326794897)||f.l.W(b.y,-1.570796326794897)&&!f.l.W(c.y,-1.570796326794897)?!0:!1};a.sE=function(c,b,d){return!a.qE(c,b,d)||f.l.W(c.y,1.570796326794897)||f.l.W(c.y,-1.570796326794897)||f.l.W(b.y,1.570796326794897)||f.l.W(b.y,-1.570796326794897)?
!1:!0};a.qE=function(c,b,d){return Math.abs(Math.abs(c.x-b.x)-3.141592653589793)<=d?!0:!1};a.zv=function(c,b){return f.l.W(c.y,1.570796326794897)&&f.l.W(b.y,1.570796326794897)||f.l.W(c.y,-1.570796326794897)&&f.l.W(b.y,-1.570796326794897)?!0:!1};a.ly=function(c,b,d,h){if(0<c.y){var l=new f.b;l.ka(b.x,1.570796326794897)}else l=new f.b,l.ka(b.x,-1.570796326794897);f.l.W(c.x,l.x)||f.l.W(b.y,l.y)||(a.uc(h,l),null!=d&&d.add(0))};a.hy=function(c,b,d,h){if(0<b.y){var l=new f.b;l.ka(c.x,1.570796326794897)}else l=
new f.b,l.ka(c.x,-1.570796326794897);f.l.W(b.x,l.x)||f.l.W(c.y,l.y)||(a.uc(h,l),null!=d&&d.add(1))};a.ky=function(c,b,d,h,l,q,v){f.l.wd(d)?(0<1.570796326794897-c.y&&(d=new f.b,d.ka(c.x,1.570796326794897),a.uc(v,d),null!=q&&q.add(h)),0<1.570796326794897-b.y&&(d=new f.b,d.ka(b.x,1.570796326794897),a.uc(v,d),null!=q&&q.add(h))):(0<1.570796326794897+c.y&&(d=new f.b,d.ka(c.x,-1.570796326794897),a.uc(v,d),null!=q&&q.add(l)),0<1.570796326794897+b.y&&(d=new f.b,d.ka(b.x,-1.570796326794897),a.uc(v,d),null!=
q&&q.add(l)))};a.UM=function(c){if(-3.141592653589793>c.x)for(;-3.141592653589793>c.x;)c.x+=6.283185307179586;if(3.141592653589793<c.x)for(;3.141592653589793<c.x;)c.x-=6.283185307179586};return a}();f.Ej=a})(C||(C={}));(function(f){var a=function(){function a(){}a.Nj=function(c,b,d){if(null==c||null==b||!f.fb.Jc(b))throw f.f.F();if(c.u())return c;var h=c,l=h.G();if(f.T.Ic(l)){h=f.gi.Mj(c,b);c=new f.h;h.s(c);for(var l=f.ma.be(b,c,!1),q=f.fb.Bh(b),v=Math.floor((c.o-q.o)/q.N())*q.N()+q.o;v<c.v;)v>c.o+
l&&v<c.v-l&&(h=f.gi.gt(h,b,d,!0,v)),v+=q.N()}else{if(197==l)return c=new f.Ia(h.description),c.jd(h,!1),a.Nj(c,b,d);if(f.T.Oc(l))return c=new f.Ua(h.description),c.dc(h,!0),a.Nj(c,b,d)}return a.iV(h,b)};a.iV=function(c,b){if(null==c||null==b||!f.fb.Jc(b))throw f.f.F();if(c.u())return c;var d;d=c.G();197==d?(d=new f.Ia(c.description),d.jd(c,!1)):f.T.Oc(d)?(d=new f.Ua(c.description),d.dc(c,!0)):d=c;d=f.gi.Mj(d,b);return d.u()?d:1==f.Td.Fb(b)?f.gi.Ym(d,b,0,d!=c,0):a.cV(d,b,d!=c)};a.cV=function(c,b,d){if(!f.fb.Jc(b))throw f.f.F();
if(c.u())return c;var h=f.fb.de(b),l=0-180*h,h=360*h;2==f.Td.Fb(b)&&(l=f.fb.Bh(b),h=l.v,l=l.o,h-=l);return f.gi.Aq(c,l,h,b,d,0,!0)};return a}();f.Vp=a})(C||(C={}));(function(f){var a=function(){function a(){}a.eV=function(c,b){var d=Math.abs(c%b);return isNaN(d)||d==c||d<=Math.abs(b)/2?d:0>c?-1*(d-b):0<c?1*(d-b):0*(d-b)};a.K=function(c){return 0>c?-c:c};a.Ab=function(c,b){return 0<=b?a.K(c):-a.K(c)};a.W=function(c,b){return c==b||a.K(c-b)<=a.fD*(1+(a.K(c)+a.K(b))/2)};a.wd=function(c){return 0==c||
a.K(c)<=a.fD};a.Eu=function(c){c=a.eV(c,a.lA);return a.K(c)<=a.Oi?c:0>c?c+a.lA:c-a.lA};a.JB=function(c,b){c.j=a.Eu(c.j);b.j=a.Eu(b.j);a.K(b.j)>a.rs&&(c.j=a.Eu(c.j+a.Oi),b.j=a.Ab(a.Oi,b.j)-b.j)};a.Yg=function(c,b){b=Math.sqrt(1-b);b=(1-b)/(1+b);var d=b*b;return c/(1+b)*(1+d*(.25+d*(.015625+1/256*d)))*a.rs};a.RS=function(c,b,d,h,l){var q,v,e,k,p,g,n,u=0,z=g=0,E=0,r=0,t=0;p=0;var A,m,w;n=0;var x,C,I;w=new f.ea;q=new f.ea;if(null!=l)if(w.j=c,q.j=b,a.JB(w,q),c=w.j,b=q.j,w.j=d,q.j=h,a.JB(w,q),d=w.j,h=q.j,
d=a.Eu(d-c),a.W(b,h)&&(a.wd(d)||a.W(a.K(b),a.rs)))null!=l&&(l.j=0);else{if(a.W(b,-h)){if(a.W(a.K(b),a.rs)){null!=l&&(l.j=2*a.Yg(6378137,.0066943799901413165));return}if(a.W(a.K(d),a.Oi)){null!=l&&(l.j=2*a.Yg(6378137,.0066943799901413165));return}}if(a.wd(.0066943799901413165))r=Math.cos(b),t=Math.cos(h),null!=l&&(u=Math.sin((h-b)/2),g=Math.sin(d/2),n=2*Math.asin(Math.sqrt(u*u+r*t*g*g)),l.j=6378137*n);else{w=1-Math.sqrt(.9933056200098587);c=1-w;q=Math.atan(c*Math.tan(b));b=Math.sin(q);q=Math.cos(q);
v=Math.atan(c*Math.tan(h));h=Math.sin(v);v=Math.cos(v);k=e=d;C=0;I=1;x=d;for(m=!0;1==m;)C+=1,1==I&&(p=Math.sin(x),g=Math.cos(x),u=v*p,n=q*h-b*v*g,u=Math.sqrt(u*u+n*n),g=b*h+q*v*g,n=Math.atan2(u,g),z=1E-15>a.K(u)?q*v*p/a.Ab(1E-15,u):q*v*p/u,E=1-z*z,r=1E-15>a.K(E)?g-b*h/a.Ab(1E-15,E)*2:g-b*h/E*2,t=r*r,p=((-3*E+4)*w+4)*E*w/16),A=(1-p)*w*(n+p*u*(r+g*p*(2*t-1))),1==I?(x=d+A*z,1E-14>a.K(x-k)?m=!1:a.K(x)>a.Oi?(I=2,x=a.Oi,0>d&&(x=-x),z=0,E=1,e=k=2,n=a.Oi-a.K(Math.atan(b/q)+Math.atan(h/v)),u=Math.sin(n),g=
Math.cos(n),p=((-3*E+4)*w+4)*E*w/16,1E-14>a.K(z-e)?m=!1:(r=1E-15>a.K(E)?g-b*h/a.Ab(1E-15,E)*2:g-b*h/E*2,t=r*r)):(0>(x-k)*(k-e)&&5<C&&(x=(2*x+3*k+e)/6),e=k,k=x)):(z=(x-d)/A,0>(z-k)*(k-e)&&5<C&&(z=(2*z+3*k+e)/6),e=k,k=z,E=1-z*z,p=z*u/(q*v),g=-Math.sqrt(a.K(1-p*p)),x=Math.atan2(p,g),u=v*p,n=q*h-b*v*g,u=Math.sqrt(u*u+n*n),g=b*h+q*v*g,n=Math.atan2(u,g),p=((-3*E+4)*w+4)*E*w/16,1E-14>a.K(z-e)?m=!1:(r=1E-15>a.K(E)?g-b*h/a.Ab(1E-15,E)*2:g-b*h/E*2,t=r*r));null!=l&&(z=Math.sqrt(1+(1/(c*c)-1)*E),z=(z-1)/(z+1),
E=z*(1-.375*z*z),l.j=(1+z*z/4)/(1-z)*c*6378137*(n-E*u*(r+E/4*(g*(-1+2*t)-E/6*r*(-3+4*u*u)*(-3+4*t)))))}}};a.Oi=3.141592653589793;a.rs=1.5707963267948966;a.lA=6.283185307179586;a.fD=3.552713678800501E-15;return a}();f.oM=a})(C||(C={}));(function(f){var a=function(){return function(c){this.ue=c;this.ll=this.ue.getCode();0>this.ll&&(this.ll=0)}}();f.RZ=a;var e=function(){function c(b){void 0===b&&(b=null);this.Kh=null;this.on=!1;null!==b&&(this.Kh=new a(b))}c.prototype.yc=function(){return null!=this.Kh?
this.Kh.ll:0};c.prototype.Vf=function(){var b=new c;this.copyTo(b);return b};c.prototype.copyTo=function(b){b.Kh=this.Kh;b.on=this.on};c.prototype.Vv=function(){var b=this.Vf();b.jt();return b};c.prototype.jt=function(){this.on=!this.on};c.prototype.dn=function(){return null!=this.Kh?this.Kh.ue:null};c.prototype.AK=function(b){if(0>=b)throw f.f.F();if(b!=this.yc()){b=f.Tf.geogtran(b);if(null==b)throw f.f.F("Geogtran not found.");this.Kh=new a(b)}};c.prototype.lH=function(){return null==this.Kh?null:
this.Kh.ue.toString()};c.prototype.getName=function(){if(null==this.Kh||null==this.Kh.ue)return"";var b="";this.on&&(b+="~");return b+=this.Kh.ue.getName()};c.prototype.nY=function(b){if(null==b)throw f.f.F();var d=null;try{d=f.Tf.fromString(f.Vc.PE_TYPE_GEOGTRAN,b)}catch(h){throw f.f.F();}this.Kh=new a(d)};c.prototype.Eb=function(b){return b==this?!0:b instanceof c&&(!(0>=this.yc()||this.yc()!=b.yc())||this.dn().isEqual(b.dn()))?this.on==b.on:!1};c.prototype.toString=function(){var b=toString();
return 200<b.length?b.substring(0,197)+"... ("+b.length.toString()+" characters)":b};c.create=function(b,d){var h=new c;h.AK(b);d&&h.jt();return h};c.eG=function(b,d){var h=new c;h.nY(b);d&&h.jt();return h};return c}();f.io=e})(C||(C={}));(function(f){var a=function(){function c(){}c.pa=function(b,d,h,f){var l=new c;l.wn=b;l.xn=d;l.LI=h;l.MI=f;return l};c.Gs=function(b,d){return b.wn==d.wn?b.xn==d.xn?0:b.xn<d.xn?-1:1:b.wn<d.wn?-1:1};return c}(),e=function(){function c(){this.Gw=!1;this.NI=[];this.ZA=
[];this.iI=this.Gw=this.hI=!1;this.kq()}c.zo=function(){null==c.EG&&(c.EG=new c);return c.EG};c.b_=function(){return c.zo().Gw};c.e_=function(){return c.zo().iI};c.y_=function(b,d){if(b==d)return null;var h=c.zo();if(h.hI){var f=c.DA(h.ZA,b,d);return null!=f?f:null}f=c.DA(h.ZA,b,d);return null!=f?f:c.DA(h.NI,b,d)};c.eO=function(b,d,c,l,q){var h=f.my.create();if(0<b)try{var a=f.io.create(b,d);if(0==a.yc())return null;h.add(a);if(0<c){var e=f.io.create(c,l);if(0==e.yc())return null;h.add(e)}q&&(h=h.Vv())}catch(F){h=
null}return h};c.DA=function(b,d,h){if(d==h||0==b.length)return null;for(var f=a.pa(d,h,0,0),q=!1,v=!1,e=0,k=0,p=-1,g=0;g<b.length;g++)if(0===a.Gs(f,b[g])){p=g;break}if(0>p||b[p].wn!=f.wn||b[p].xn!=f.xn){f=a.pa(h,d,0,0);d=-1;for(g=0;g<b.length;g++)if(0===a.Gs(f,b[g])){d=g;break}0<=d&&b[d].wn==f.wn&&b[d].xn==f.xn&&(e=b[d].LI,k=b[d].MI,v=q=!0)}else e=b[p].LI,k=b[p].MI,q=!1,v=!0;if(!v)return null;0==e&&(e=k,k=0);f=b=!1;0>e&&(e=-e,b=!0);0>k&&(k=-k,f=!0);return c.eO(e,b,k,f,q)};c.prototype.kq=function(){this.AE(this.NI)&&
(this.Gw=!0);this.AE(this.ZA)&&(this.iI=!0);this.hI=!this.Gw};c.prototype.AE=function(b){try{for(var d=[],d=d.sort(a.Gs),c=0;c<d.length;c++)b.push(d[c])}catch(l){}return!0};c.Q_=function(){return null};return c}();f.QZ=e})(C||(C={}));(function(f){var a=function(){function f(){}f.prototype.Ly=function(c){this.Hi=c};f.prototype.ME=function(c){this.Mb=c};f.prototype.NE=function(c){this.np=c};f.IF=function(c){return c.u()||1607!=c.G()&&1736!=c.G()?!1:!0};f.GF=function(c){return c.u()||1607!=c.G()&&1736!=
c.G()||20>c.D()?!1:!0};f.HF=function(c){return c.u()||1607!=c.G()&&1736!=c.G()||20>c.D()?!1:!0};return f}();f.wl=a})(C||(C={}));(function(f){var a=function(){function a(){}a.lX=function(c){var b=new f.Ia;b.Zx(c.R.o,c.R.A);b.Wj(c.R.o,c.R.B);b.Wj(c.R.v,c.R.B);b.Wj(c.R.v,c.R.A);return b};a.Xg=function(c,b){return null===c?null:f.ns.local().V(c,b,null)};a.fZ=function(c,b){var d=f.ei.local();c=new f.hd(c);return d.V(c,b,null).next()};a.Wm=function(c,b,d){return f.cq.local().V(c,b,d,null)};a.Pp=function(c,
b,d){return f.ty.local().V(c,b,d,null)};a.NY=function(c,b,d){var h=f.ty.local();c=new f.hd(c);b=new f.hd(b);d=h.V(c,b,d,null);for(h=[];null!=(b=d.next());)h.push(b);return h};a.Eb=function(c,b,d){return f.Gj.local().V(3,c,b,d,null)};a.PR=function(c,b,d){return f.Gj.local().V(4,c,b,d,null)};a.KU=function(c,b,d){var h=f.sk.local();c=new f.hd(c);b=new f.hd(b);d=h.V(c,b,d,null);for(h=[];null!=(b=d.next());)h.push(b);return h};a.MR=function(c,b,d){var h=f.cq.local();c=new f.hd(c);b=new f.hd(b);d=h.V(c,
b,d,null);for(h=[];null!=(b=d.next());)h.push(b);return h};a.Ma=function(c,b,d){return f.sk.local().V(c,b,d,null)};a.qZ=function(c,b,d){return f.Gj.local().V(2,c,b,d,null)};a.contains=function(c,b,d){return f.Gj.local().V(1,c,b,d,null)};a.xR=function(c,b,d){return f.Gj.local().V(16,c,b,d,null)};a.touches=function(c,b,d){return f.Gj.local().V(8,c,b,d,null)};a.nW=function(c,b,d){return f.Gj.local().V(32,c,b,d,null)};a.MU=function(c,b,d){return f.Gj.local().V(1073741824,c,b,d,null)};a.XB=function(c,
b,d,h){return f.oN.local().V(c,b,d,h,null)};a.Cb=function(c,b,d,h){var l=null;if(null!=d){if(l=d.Od(),null!=h&&l.yc()!=h.yc()&&l.nd!=h.nd)throw f.f.uk();}else if(null!=h)throw f.f.F();c=f.gN.local().V(c,b,null);null!==l&&null!==h&&(c=f.oc.li(c,l,h));return c};a.clip=function(c,b,d){return f.aN.local().V(c,f.h.pa(b.R.o,b.R.A,b.R.v,b.R.B),d,null)};a.Hl=function(c,b,d){if(null==c||null==b)return null;c=f.cN.local().V(!0,c,b,d,null);for(b=[];null!=(d=c.next());)d.u()||b.push(d);return b.slice(0)};a.PP=
function(c,b,d,h,l,q,v,e){if(!0===l)return a.XM(c,b,d,h,q,v,e);l=d;if(null!=b){if(v=b.Od(),null!=h&&v.yc()!=h.yc()){if(v.nd!=h.nd)throw f.f.uk();l=[];f.oc.cG(d,d.length,h,v,l)}}else if(null!=h)throw f.f.F();d=f.BD.local();if(q){c=new f.hd(c);b=d.V(c,b,l,q,null);for(c=[];null!=(q=b.next());)c.push(q);q=c.slice(0)}else for(q=[],h=0;h<c.length;h++)q[h]=d.V(c[h],b,l[h],null);return q};a.XM=function(c,b,d,h,l,q,a){if(null===b)throw f.f.F();if(null===h||void 0===h)h=4326!==b.yc()?b.Od():f.oc.ze(9001);if(0!==
h.nd)throw f.f.F();f.oc.cG(d,d.length,h,f.oc.ze(9001),d);h=f.GD.local();if(l){c=new f.hd(c);b=h.V(c,b,q,d,a,!1,l,null);for(d=[];null!=(q=b.next());)d.push(q);l=d.slice(0)}else{l=[];for(var v=0;v<c.length;v++)l[v]=h.V(c[v],b,q,d[v],a,!1,null)}return l};a.buffer=function(c,b,d,h,l,q,a){var v=d;if(!1===l){if(null!=b){if(l=b.Od(),null!=h&&l.yc()!=h.yc()){if(l.nd!=h.nd)throw f.f.uk();v=f.oc.li(d,h,l)}}else if(null!=h)throw f.f.F();c=f.BD.local().V(c,b,v,null)}else{if(null===b)throw f.f.F();if(null===h||
void 0===h)h=4326!==b.yc()?b.Od():f.oc.ze(9001);if(0!==h.nd)throw f.f.F();v=f.oc.li(d,h,f.oc.ze(9001));c=f.GD.local().V(c,b,q,v,a,!1,null)}return c};a.lW=function(c,b,d,h,l,q,a){if(null!=b){var v=b.Od();if(null!=a&&v.yc()!=a.yc()){if(v.nd!=a.nd)throw f.f.uk();d=f.oc.li(d,a,v)}}else if(null!=a)throw f.f.F();c=new f.hd(c);b=f.KD.local().V(c,b,d,h,l,q,null);for(d=[];null!=(h=b.next());)d.push(h);return d.slice(0)};a.offset=function(c,b,d,h,l,q,a){if(null!=b){var v=b.Od();if(null!=a&&v.yc()!=a.yc()){if(v.nd!=
a.nd)throw f.f.uk();d=f.oc.li(d,a,v)}}else if(null!=a)throw f.f.F();return f.KD.local().V(c,b,d,h,l,q,null)};a.gR=function(c){return f.DD.local().V(c,null)};a.hR=function(c,b){var d=f.DD.local();c=new f.hd(c);d=d.V(c,b,null);for(c=[];null!=(b=d.next());)c.push(b);return c};a.Yz=function(c,b,d){return f.ry.local().Yz(c,b,d)};a.Zz=function(c,b){return f.ry.local().Zz(c,b)};a.$z=function(c,b,d,h){return f.ry.local().$z(c,b,d,h)};a.BC=function(c,b){return f.Lm.local().V(c,b,!1,null)};a.XU=function(c,
b){return f.Lm.local().Vq(c,b,null)};a.FS=function(c,b,d,h,l){var q=f.FD.local();if(null!=b){if(b=b.Od(),null!=l&&b.yc()!=l.yc()){if(b.nd!=l.nd)throw f.f.uk();d=f.oc.li(d,l,b)}}else if(null!=l)throw f.f.F();return q.V(c,d,h,null)};a.Ks=function(c,b,d,h){var l=f.Km.local();if(null!=b){if(b=b.Od(),null!=h&&b.yc()!=h.yc()){if(b.nd!=h.nd)throw f.f.uk();d=f.oc.li(d,h,b)}}else if(null!=h)throw f.f.F();return l.V(c,d,null)};a.Dz=function(c,b,d,h,l){void 0===l&&(l=0);var q=f.iN.local();if(4==l)throw f.f.df();
if(0!==l)throw f.f.df();if(null!=b){var a=b.Od();if(null!=h&&a.yc()!=h.yc()){if(a.nd!=h.nd)throw f.f.uk();d=f.oc.li(d,h,a)}}else if(null!=h)throw f.f.F();return q.V(c,d,b,l,null)};a.LS=function(c,b,d,h){if(null===c)return 0;if(4==h)throw f.f.df();if(0!==h)throw f.f.df();if(197==c.G())c=a.lX(c);else if(1736!=c.G())return 0;h=f.fb.kc(b);c=f.fb.Xg(c,b,h,null);c=f.pM.MS([c])[0];if(null!==d){if(2!==d.nd)throw f.f.F("Unit must be a area unit type");c=f.oc.li(c,f.oc.ze(109404),d)}return c};a.PS=function(c,
b,d,h){c=f.kN.local().V(c,b,h,null);if(null!==d){if(0!==d.nd)throw f.f.F("Unit must be a linear unit type");c=f.oc.li(c,f.oc.ze(9001),d)}return c};a.vW=function(c,b,d){if(null===c)return 0;var h=null;if(null!=b){h=b.Od();if(0==h.nd&&(h=f.oc.kH(h),null==h&&null!==d))throw f.f.F();if(null!=d&&h.yc()!=d.yc()&&h.nd!=d.nd)throw f.f.uk();}else if(null!=d)throw f.f.F();return 1736==c.G()||197==c.G()?(c=c.hf(),null!==d?f.oc.li(c,h,d):c):0};a.wW=function(c,b,d){if(null===c||c.u()||1>c.tb())return 0;var h=
null;if(null!=b){if(h=b.Od(),null!=d&&h.yc()!=d.yc()&&h.nd!=d.nd)throw f.f.uk();}else if(null!=d)throw f.f.F();1736==c.G()||197==c.G()?b=c.Gg():f.T.Oc(c.G())?(b=new f.Ua(c.description),b.dc(c,!0)):b=c;c=0;b=b.Da();for(var l=new f.b,q=new f.b;b.Ya();)for(;b.Ca();){var a=b.ba();a.Oq(l);a.Os(q);c+=f.b.Cb(l,q)}null!==h&&null!==d&&(c=f.oc.li(c,h,d));return c};a.ZZ=function(c,b){return f.Td.OS(c,b)};a.bG=function(c){return void 0!==c.points?a.jW(c,void 0===c.hasZ?!1:c.hasZ,void 0===c.hasM?!1:c.hasM):void 0!==
c.rings?a.vH(c.rings,void 0===c.hasZ?!1:c.hasZ,void 0===c.hasM?!1:c.hasM,"P"):void 0!==c.paths?a.vH(c.paths,void 0===c.hasZ?!1:c.hasZ,void 0===c.hasM?!1:c.hasM,"L"):void 0!==c.x?a.tW(c):void 0!==c.xmin?a.bW(c):null};a.tW=function(c){if(null==c.x||"NaN"==c.x)return new f.Wa;var b=new f.Wa(c.x,c.y);void 0!==c.z&&null!==c.z&&b.qY(c.z);void 0!==c.m&&null!==c.m&&b.aY(c.m);return b};a.bW=function(c){if(null==c.xmin||"NaN"==c.xmin)return new f.ci;var b=new f.ci(c.xmin,c.ymin,c.xmax,c.ymax);void 0!==c.zmin&&
null!==c.zmin&&b.setInterval(1,0,c.zmin,c.zmax);void 0!==c.mmin&&null!==c.mmin&&b.setInterval(2,0,c.mmin,c.mmax);return b};a.jW=function(c,b,d){var h=0,l=new f.Ed,q=3*c.points.length;0!=q%2&&q++;2>q&&(q=2);var a=f.J.truncate(3*c.points.length/2);4>a?a=4:16>a&&(a=16);for(var q=f.Uc.Vm(q,0),e=f.Uc.Vm(a),a=f.Uc.Vm(a),k=0;k<c.points.length;k++)q.write(2*k,c.points[k][0]),q.write(2*k+1,c.points[k][1]),e.write(k,b||d?c.points[k][2]:NaN),a.write(k,d&&b?c.points[k][3]:NaN),h++;0!=h&&(l.resize(h),l.Zn(0,q));
b&&(l.Ud(1),l.Zn(1,e));d&&(l.Ud(2),l.Zn(2,0==b?e:a));l.Dc(16777215);return l};a.vH=function(c,b,d,h){var l,q=0,a=2;"P"==h?(l=new f.Ia,q=1,a=3):l=new f.Ua;for(var e=f.Uc.wh(0),k=f.Uc.vq(0),p=0,g=0,n=[],u=[],z=0;z<c.length;z++){var r=c[z].length;n[z]=!1;if("P"===h&&c[z][0][0]===c[z][c[z].length-1][0]&&c[z][0][1]===c[z][c[z].length-1][1]){var E=0==d?!0:c[z][0][3]===c[z][c[z].length-1][3]||void 0===c[z][0][3]&&void 0===c[z][c[z].length-1][3];(0==b||c[z][0][2]===c[z][c[z].length-1][2]||void 0===c[z][0][2]&&
void 0===c[z][c[z].length-1][2])&&E&&(n[z]=!0,--r)}r>=a?(u[z]=!1,g+=1,e.add(p),k.add(q),p+=r):u[z]=!0}h=3*p;0!=h%2&&h++;2>h&&(h=2);z=f.J.truncate(3*p/2);4>z?z=4:16>z&&(z=16);h=f.Uc.Vm(h,0);q=f.Uc.Vm(z);a=f.Uc.Vm(z);for(z=r=0;z<c.length;z++)if(!1===u[z])for(E=0;E<c[z].length;E++){var t=!1;E===c[z].length-1&&!0===n[z]&&(t=!0);t||(h.write(2*r,c[z][E][0]),h.write(2*r+1,c[z][E][1]),q.write(r,b||d?c[z][E][2]:NaN),a.write(r,d&&b?c[z][E][3]:NaN),r++)}0!=p&&(c=l,e.resize(g),k.resize(g),0<p&&(e.add(p),k.add(0)),
c.Zn(0,h),c.FK(k),c.GK(e));b&&(l.Ud(1),l.Zn(1,q));d&&(l.Ud(2),l.Zn(2,0==b?q:a));l.Dc(16777215);return l};return a}();f.cc=a})(C||(C={}));(function(f){var a=function(){function f(){}f.Im=function(c){var b=0,d,h=c.length,f=c[0],q;for(d=0;d<h-1;d++)q=c[d+1],b+=(q[0]-f[0])*(q[1]+f[1]),f=q;return 0<=b};f.rotate=function(c,b,d){b=b*Math.PI/180;var h=Math.cos(b),l=Math.sin(b);if(void 0!==c.paths){b={paths:[]};for(var q=0;q<c.paths.length;q++){for(var a=c.paths[q],e=[],k=0;k<a.length;k++){var p=a[k].slice(0);
e.push(p);var g=h*(a[k][0]-d.x)-l*(a[k][1]-d.y)+d.x,n=l*(a[k][0]-d.x)+h*(a[k][1]-d.y)+d.y;p[0]=g;p[1]=n}b.paths.push(e)}return b}if(void 0!==c.rings){b={rings:[]};for(q=0;q<c.rings.length;q++){for(var a=c.rings[q],e=[],u=f.Im(a),k=0;k<a.length;k++)p=a[k].slice(0),e.push(p),g=h*(a[k][0]-d.x)-l*(a[k][1]-d.y)+d.x,n=l*(a[k][0]-d.x)+h*(a[k][1]-d.y)+d.y,p[0]=g,p[1]=n;f.Im(e)!==u&&e.reverse();b.rings.push(e)}return b}if(void 0!==c.x)return b={x:h*(c.x-d.x)-l*(c.y-d.y)+d.x,y:l*(c.x-d.x)+h*(c.y-d.y)+d.y},
void 0!==c.z&&(b.z=c.z),void 0!==c.m&&(b.m=c.m),b;if(void 0!==c.points){b={points:[]};c=c.points;for(k=0;k<c.length;k++)q=c[k].slice(0),q[0]=h*(c[k][0]-d.x)-l*(c[k][1]-d.y)+d.x,q[1]=l*(c[k][0]-d.x)+h*(c[k][1]-d.y)+d.y,b.points.push(q);return b}return null};f.yG=function(c,b){var d,h;if(void 0!==c.paths){d={paths:[]};for(var l=0;l<c.paths.length;l++){for(var q=c.paths[l],a=[],e=0;e<q.length;e++){var k=q[e].slice(0);a.push(k);h=b.x-q[e][0];k[0]=q[e][0]+2*h}d.paths.push(a)}return d}if(void 0!==c.rings){d=
{rings:[]};for(l=0;l<c.rings.length;l++){for(var q=c.rings[l],p=f.Im(q),a=[],e=0;e<q.length;e++)k=q[e].slice(0),a.push(k),h=b.x-q[e][0],k[0]=q[e][0]+2*h;f.Im(a)!==p&&a.reverse();d.rings.push(a)}return d}if(void 0!==c.x)return h=b.x-c.x,d={x:c.x+2*h,y:c.y},void 0!==c.z&&(d.z=c.z),void 0!==c.m&&(d.m=c.m),d;if(void 0!==c.points){d={points:[]};l=c.points;for(e=0;e<l.length;e++)q=l[e].slice(0),h=b.x-q[0],q[0]+=2*h,d.points.push(q);return d}return void 0!==c.xmin?(d={o:c.xmin,A:c.ymin,v:c.xmax,B:c.ymax},
void 0!==c.zmin&&(d.zmin=c.zmin,d.zmax=c.zmax),void 0!==c.mmin&&(d.mmin=c.mmin,d.mmax=c.mmax),h=b.x-c.xmin,d.xmax=c.xmin+2*h,h=b.x-c.xmax,d.xmin=c.xmax+2*h,d):null};f.zG=function(c,b){var d,h;if(void 0!==c.paths){d={paths:[]};for(var l=0;l<c.paths.length;l++){for(var q=c.paths[l],a=[],e=0;e<q.length;e++){var k=q[e].slice(0);a.push(k);h=b.y-q[e][1];k[1]=q[e][1]+2*h}d.paths.push(a)}return d}if(void 0!==c.rings){d={rings:[]};for(l=0;l<c.rings.length;l++){for(var q=c.rings[l],p=f.Im(q),a=[],e=0;e<q.length;e++)k=
q[e].slice(0),a.push(k),h=b.y-q[e][1],k[1]=q[e][1]+2*h;f.Im(a)!==p&&a.reverse();d.rings.push(a)}return d}if(void 0!==c.x)return h=b.y-c.y,d={y:c.y+2*h,x:c.x},void 0!==c.z&&(d.z=c.z),void 0!==c.m&&(d.m=c.m),d;if(void 0!==c.points){d={points:[]};l=c.points;for(e=0;e<l.length;e++)q=l[e].slice(0),h=b.y-q[1],q[1]+=2*h,d.points.push(q);return d}return void 0!==c.xmin?(d={o:c.xmin,A:c.ymin,v:c.xmax,B:c.ymax},void 0!==c.zmin&&(d.zmin=c.zmin,d.zmax=c.zmax),void 0!==c.mmin&&(d.mmin=c.mmin,d.mmax=c.mmax),h=
b.y-c.ymin,d.ymax=c.ymin+2*h,h=b.y-c.ymax,d.ymin=c.ymax+2*h,d):null};return f}();f.Wp=a})(C||(C={}));(function(f){var a=function(){function a(){}a.bh=function(c,b){null==b&&(b=f.ye.Ig());switch(c){case 33:return new f.Wa(b);case 322:return new f.Hb(b);case 197:return new f.ci(b);case 550:return new f.Ed(b);case 1607:return new f.Ua(b);case 1736:return new f.Ia(b);default:throw f.f.X("invalid argument.");}};return a}();f.tM=a})(C||(C={}));(function(f){var a=function(){function a(c,b){this.tf=f.ia.yd(c,
-1);this.va=new f.Ku;this.bm=b}a.prototype.wX=function(c){this.va.ou(Math.min(this.tf.size,c));this.va.Wn(c)};a.prototype.addElement=function(c,b){if(void 0===b)return this.bP(c);b=f.J.truncate(b%this.tf.size);var d=this.tf.get(b);-1==d&&(d=this.va.mi(),this.tf.set(b,d));return this.va.addElement(d,c)};a.prototype.bP=function(c){var b=this.bm.Uz(c),b=f.J.truncate(b%this.tf.size),d=this.tf.get(b);-1==d&&(d=this.va.mi(),this.tf.set(b,d));return this.va.addElement(d,c)};a.prototype.kd=function(c,b){if(void 0===
b)this.FR(c);else{b=f.J.truncate(b%this.tf.size);var d=this.tf.get(b);if(-1==d)throw f.f.F();for(var h=this.va.xc(d),l=-1;-1!=h;){var q=this.va.nb(h);this.va.ja(h)==c?(this.va.kd(d,l,h),-1==this.va.xc(d)&&(this.va.zh(d),this.tf.set(b,-1))):l=h;h=q}}};a.prototype.FR=function(c){var b=this.bm.Uz(c),b=f.J.truncate(b%this.tf.size),d=this.tf.get(b);if(-1==d)throw f.f.F();for(var h=this.va.xc(d),l=-1;-1!=h;){var q=this.va.nb(h);this.va.ja(h)==c?(this.va.kd(d,l,h),-1==this.va.xc(d)&&(this.va.zh(d),this.tf.set(b,
-1))):l=h;h=q}};a.prototype.gT=function(c){c=f.J.truncate(c%this.tf.size);c=this.tf.get(c);return-1==c?-1:this.va.xc(c)};a.prototype.wT=function(c){return this.va.nb(c)};a.prototype.Ld=function(c){var b=this.bm.Uz(this.ja(c)),b=f.J.truncate(b%this.tf.size),d=this.tf.get(b);if(-1==d)throw f.f.F();for(var h=this.va.xc(d),l=-1;-1!=h;){if(h==c){this.va.kd(d,l,h);-1==this.va.xc(d)&&(this.va.zh(d),this.tf.set(b,-1));return}l=h;h=this.va.nb(h)}throw f.f.F();};a.prototype.ja=function(c){return this.va.ja(c)};
a.prototype.clear=function(){this.tf=f.ia.yd(this.tf.size,-1);this.va.clear()};a.prototype.size=function(){return this.va.dH()};return a}();f.DM=a})(C||(C={}));(function(f){var a=function(){function a(){this.kj=new f.ad(3);this.va=new f.ad(6);this.rV=!1;this.Ge=-1}a.prototype.Kl=function(c){this.kj.kd(c)};a.prototype.Ax=function(){return this.kj.Pe()};a.prototype.Ov=function(c){this.va.kd(c)};a.prototype.EB=function(){return this.va.Pe()};a.prototype.tC=function(c,b){this.kj.P(c,1,b)};a.prototype.Px=
function(c,b){this.kj.P(c,2,b)};a.prototype.$X=function(c,b){this.kj.P(c,3,b)};a.prototype.rC=function(c,b){this.va.P(c,4,b)};a.prototype.cY=function(c,b){this.va.P(c,3,b)};a.prototype.JK=function(c,b){this.va.P(c,2,b)};a.prototype.mi=function(c){var b=this.EB();this.va.P(b,3,this.Ge);this.va.P(b,4,0);this.va.P(b,5,c);-1!=this.Ge&&this.JK(this.Ge,b);return this.Ge=b};a.prototype.zh=function(c){this.PF(c);var b=this.va.S(c,2),d=this.va.S(c,3);-1!=b?this.cY(b,d):this.Ge=d;-1!=d&&this.JK(d,b);this.Ov(c);
return d};a.prototype.ou=function(c){this.va.Qe(c)};a.prototype.ZG=function(c){return this.va.S(c,5)};a.prototype.ZX=function(c,b){this.va.P(c,5,b)};a.prototype.addElement=function(c,b){return this.nU(c,b)};a.prototype.nU=function(c,b){var d=this.Ax();this.Px(d,-1);-1==this.va.S(c,0)&&this.va.P(c,0,d);var h=this.va.S(c,1);this.tC(d,h);-1!=h&&this.Px(h,d);this.va.P(c,1,d);this.setData(d,b);this.rC(c,this.$s(c)+1);this.rV&&this.$X(d,c);return d};a.prototype.kd=function(c,b){var d=this.Ve(b),h=this.nb(b);
-1!=d?this.Px(d,h):this.va.P(c,0,h);-1!=h?this.tC(h,d):this.va.P(c,1,d);this.Kl(b);this.rC(c,this.$s(c)-1);return h};a.prototype.Wn=function(c){this.kj.Qe(c)};a.prototype.getData=function(c){return this.kj.S(c,0)};a.prototype.setData=function(c,b){this.kj.P(c,0,b)};a.prototype.nb=function(c){return this.kj.S(c,2)};a.prototype.Ve=function(c){return this.kj.S(c,1)};a.prototype.xc=function(c){return this.va.S(c,0)};a.prototype.Fc=function(c){return this.va.S(c,1)};a.prototype.clear=function(){for(var c=
this.Ge;-1!=c;)c=this.zh(c)};a.prototype.PF=function(c){for(var b=this.Fc(c);-1!=b;){var d=b,b=this.Ve(d);this.Kl(d)}this.va.P(c,0,-1);this.va.P(c,1,-1);this.rC(c,0)};a.prototype.u=function(){return 0==this.kj.size};a.prototype.dH=function(){return this.kj.size};a.prototype.$s=function(c){return this.va.S(c,4)};a.prototype.aA=function(c){return this.va.S(c,3)};return a}();f.Xp=a})(C||(C={}));(function(f){var a=function(){function a(c){void 0===c?(this.Qg=new f.ad(2),this.va=new f.ad(4),this.Ge=-1,
this.Bw=!0):(this.Qg=new f.ad(2),this.va=new f.ad(c?4:2),this.Ge=-1,this.Bw=c)}a.prototype.Kl=function(c){this.Qg.kd(c)};a.prototype.Ax=function(){return this.Qg.Pe()};a.prototype.Ov=function(c){this.va.kd(c)};a.prototype.EB=function(){return this.va.Pe()};a.prototype.mi=function(){var c=this.EB();this.Bw&&(this.va.P(c,3,this.Ge),-1!=this.Ge&&this.va.P(this.Ge,2,c),this.Ge=c);return c};a.prototype.zh=function(c){for(var b=this.xc(c);-1!=b;){var d=b,b=this.nb(b);this.Kl(d)}this.Bw&&(b=this.va.S(c,
2),d=this.va.S(c,3),-1!=b?this.va.P(b,3,d):this.Ge=d,-1!=d&&this.va.P(d,2,b));this.Ov(c)};a.prototype.ou=function(c){this.va.Qe(c)};a.prototype.addElement=function(c,b){var d=this.va.S(c,1),h=this.Ax();-1!=d?this.Qg.P(d,1,h):this.va.P(c,0,h);this.va.P(c,1,h);this.Qg.P(h,0,b);return h};a.prototype.Wn=function(c){this.Qg.Qe(c)};a.prototype.kd=function(c,b,d){-1!=b?(this.Qg.P(b,1,this.Qg.S(d,1)),this.va.S(c,1)==d&&this.va.P(c,1,b)):(this.va.P(c,0,this.Qg.S(d,1)),this.va.S(c,1)==d&&this.va.P(c,1,-1));
this.Kl(d)};a.prototype.lz=function(c,b){var d=this.va.S(c,1),h=this.va.S(b,0);-1!=h&&(-1!=d?this.Qg.P(d,1,h):this.va.P(c,0,h),this.va.P(c,1,this.va.S(b,1)));this.Bw&&(d=this.va.S(b,2),h=this.va.S(b,3),-1!=d?this.va.P(d,3,h):this.Ge=h,-1!=h&&this.va.P(h,2,d));this.Ov(b)};a.prototype.ja=function(c){return this.Qg.S(c,0)};a.prototype.jk=function(c,b){this.Qg.P(c,0,b)};a.prototype.nb=function(c){return this.Qg.S(c,1)};a.prototype.xc=function(c){return this.va.S(c,0)};a.prototype.yo=function(c){return this.ja(this.xc(c))};
a.prototype.clear=function(){this.Qg.Vi(!0);this.va.Vi(!0);this.Ge=-1};a.prototype.u=function(c){return void 0===c?0==this.Qg.size:-1==this.va.S(c,0)};a.prototype.dH=function(){return this.Qg.size};a.prototype.aA=function(c){return this.va.S(c,3)};return a}();f.Ku=a})(C||(C={}));(function(f){var a=function(){function a(){}a.YD=function(c,b,d,h,l,q,v){var e=new f.b;e.L(c);c=new f.b;c.L(b);l.My(e);l.My(c);b=l.Vu(e);var k=l.Vu(c);0==k&&(k=l.YG());if(e.x!=c.x&&(e.y!=c.y||e.y!=l.A&&e.y!=l.B)||k>b!=q){b=
l.yE(e);var k=l.yE(c),p,g=q?1:3;do b=b+g&3,p=l.Fx(b),0!=v&&(h=a.YD(e,p,d,h,l,q,v)),d[h++].ka(p.x,p.y),e=p;while((b&3)!=k);0!=v&&(h=a.YD(e,c,d,h,l,q,v))}else if(l=new f.b,l.ka(c.x-e.x,c.y-e.y),0!=v&&(v=f.J.truncate(l.QO()/v),0<v))for(l.scale(1/(v+1)),q=0;q<v;q++)e.add(l),d[h++].ka(e.x,e.y);return h};a.be=function(c,b,d){b=b.no();c=null!=c&&void 0!==c.re?c.re(0):0;d&&(b*=4,c*=1.1);return Math.max(c,b)};a.Bs=function(c){return 2*Math.sqrt(2)*c};a.qP=function(c){return Math.sqrt(2)*c};a.ah=function(c,
b,d){var h=new f.h;b.s(h);return a.be(c,h,d)};a.EF=function(c,b,d){b=b.xf(1,0).no();c=null!=c?c.re(1):0;d&&(b*=4,c*=1.1);return Math.max(c,b)};a.$Z=function(c,b){var d=new f.h;c.ac(d);d.Nb(b);return d};a.Yv=function(c,b){var d=new f.h;c.ac(d);c=new f.h;b.ac(c);d.Nb(c);return d};a.i_=function(c,b){var d=c.lT(b),h=c.wa(b),l=c.Gc(b),q=c.Aa(d);d==h?(l=c.Aa(l-1),d=c.Aa(h+1)):d==l-1?(l=c.Aa(d-1),d=c.Aa(h)):(l=c.Aa(d-1),d=c.Aa(d+1));q=f.b.zp(l,q,d);return 0==q?0<c.Tm(b):-1==q};a.$P=function(c){var b=new f.h;
c.ac(b);if(b.u())return null;var d=new f.gq(b,8),h=-1,l=new f.h,q=!1;do for(var a=0,e=c.aa();a<e;a++)if(c.ik(a,l),h=d.kw(a,l,h),-1==h){if(q)throw f.f.X("internal error");c.uo(b,!1);q=!0;d.reset(b,8);break}else q=!1;while(q);return d};a.zF=function(c){var b=new f.h;c.ac(b);for(var d=new f.gq(b,8),h=-1,l=c.Da(),q=new f.h,a=!1;l.Ya();)for(;l.Ca();){var e=l.ba(),k=l.Db();e.s(q);h=d.kw(k,q,h);if(-1==h){if(a)throw f.f.ya();c.uo(b,!1);a=!0;d.reset(b,8);l.yj();break}}return d};a.Lj=function(c,b){var d=new f.h;
c.ac(d);for(var h=new f.gq(d,8),l=-1,q=new f.h,a=c.Da(),e=!1;a.Ya();)for(;a.Ca();){var k=a.ba(),p=a.Db();k.s(q);if(q.Yb(b)&&(l=h.kw(p,q,l),-1==l)){if(e)throw f.f.X("internal error.");c.uo(d,!1);e=!0;h.reset(d,8);a.yj();break}}return h};a.S_=function(c){var b=new f.h;c.ac(b);for(var d=new f.gq(b,8),h=new f.b,l=new f.h,q=!1,a=0;a<c.D();a++)if(c.w(a,h),l.I(h),-1==d.eh(a,l)){if(q)throw f.f.ya();c.uo(b,!1);q=!0;d.reset(b,8);a=-1}return d};a.AF=function(c,b){for(var d=new f.gq(b,8),h=new f.b,l=!1,q=new f.h,
a=0;a<c.D();a++)if(c.w(a,h),b.contains(h)&&(q.I(h),-1==d.eh(a,q))){if(l)throw f.f.ya();l=!0;a=new f.h;c.uo(a,!1);d.reset(a,8);a=-1}return d};a.bT=function(c,b,d){var h=new f.h,l=new f.h;c.ac(h);b.ac(l);h.O(d,d);l.O(d,d);var q=new f.h;q.I(h);q.Ma(l);c=c.Da();b=b.Da();var a=new f.eD;a.xC(d);var e=!1;for(a.aL();c.Ya();)for(;c.Ca();)c.ba().s(h),h.Yb(q)&&(e=!0,d=new f.h,d.I(h),a.YE(c.Db(),d));a.sG();if(!e)return null;h=!1;for(a.$K();b.Ya();)for(;b.Ca();)b.ba().s(l),l.Yb(q)&&(h=!0,d=new f.h,d.I(l),a.UE(b.Db(),
d));a.rG();return h?a:null};a.cT=function(c,b,d,h,l){var q=c.G(),a=b.G(),e=new f.h,k=new f.h;c.ac(e);b.ac(k);e.O(d,d);k.O(d,d);var p=new f.h;p.I(e);p.Ma(k);var g=new f.eD;g.xC(d);var n=!1;g.aL();var u=0;for(d=c.aa();u<d;u++)if(!h||1736!=q||c.qw(u))c.ik(u,e),e.Yb(p)&&(n=!0,g.YE(u,e));g.sG();if(!n)return null;c=!1;g.$K();h=0;for(d=b.aa();h<d;h++)if(!l||1736!=a||b.qw(h))b.ik(h,k),k.Yb(p)&&(c=!0,g.UE(h,k));g.rG();return c?g:null};a.n_=function(c,b){return 0<c.Kk(b)};a.R_=function(c,b){var d=new f.h;c.gX(b,
d);var d=new f.gq(d,8),h=-1,l=new f.h;c=c.Da();c.dC(b);if(c.Ya())for(;c.Ca();){b=c.ba();var q=c.Db();b.ac(l);h=d.kw(q,l,h);if(-1==h)throw f.f.X("internal error");}return d};a.Ev=function(c,b,d){if(c!=b)for(var h=0;h<d;h++)null==c[h]?c[h]=f.b.El(b[h]):c[h].L(b[h])};a.nz=function(c,b,d,h){var f=0;for(h+=0;f<h;d++,f++)null==c[f]&&(c[f]=[0,0]),c[f][0]=b[d].x,c[f][1]=b[d].y};a.mz=function(c,b,d,h){var l=b,q=0;for(b=h+b;l<b;q++,l++)null==c[l]?c[l]=f.b.pa(d[q][0],d[q][1]):c[l].ka(d[q][0],d[q][1])};a.iR=
function(c,b,d){if(c!=b)for(var h=0;h<d;h++)null==c[h]?c[h]=new f.Wa(b[h]):b[h].copyTo(c[h])};a.DP=function(c,b,d,h){var f=h.ca;h=h.ha;for(var q=0;q<b;q+=d){var a=c.read(q);a<f?c.write(q,f):a>h&&c.write(q,h)}};a.tP=function(c,b,d,h){var f=h.ca;h=h.ha;for(var q=0;q<b;q+=d){var a=c.read(q);a<f?c.write(q,f):a>h&&c.write(q,h)}};a.TK=function(c,b,d){if(c.hasAttribute(d)){var h=c.G();if(f.T.gh(h)){var l=f.na.si(d),h=f.na.Xa(d),q=c.D();if(1==l){c=c.Pa(d);a.DP(c,q*h,h,b);return}if(2==l){c=c.Pa(d);a.tP(c,
q*h,h,b);return}throw f.f.X("snap_coordinate not implemented");}if(197==h)q=c.xf(d,0),h=!1,q.ca<b.ca&&(h=!0,q.ca=b.ca),q.ha>b.ha&&(h=!0,q.ha=b.ha),h&&c.setInterval(d,0,q);else if(33==h)q=c.Yc(d,0),h=!1,q<b.ca&&(h=!0,q=b.ca),q>b.ha&&(h=!0,q=b.ha),h&&c.setAttribute(d,0,q);else if(f.T.Oc(h))q=c.ct(d,0),h=!1,q<b.ca&&(h=!0,q=b.ca),q>b.ha&&(h=!0,q=b.ha),h&&c.Sx(d,0,q),q=c.Ns(d,0),q<b.ca&&(h=!0,q=b.ca),q>b.ha&&(h=!0,q=b.ha),h&&c.Kx(d,0,q);else throw f.f.X("snap_coordinate not implemented");}};a.jo=function(c,
b,d,h,f){var l=0;null!=b&&(l=b.re(c),f&&!h||null==b||(l+=1.01*b.eA(c)));h&&(d*=4,l*=1.01);return Math.max(l,d)};a.T_=function(c,b,d,h){b=f.h.BO(b.Be(),b.nf(),d.Be(),d.nf());return a.jo(0,c,b,h,!1)};a.Yy=function(c,b,d){b=b.no();return a.jo(0,c,b,d,!1)};a.U_=function(c,b,d){b=b.no();return a.jo(1,c,b,d,!1)};a.fQ=function(c,b){var d=new f.h;b.s(d);return a.Yy(c,d,!0)};a.Zy=function(c,b){b=b.no();return a.jo(0,c,b,!1,!0)};a.V_=function(c,b,d){b=b.no();return a.jo(1,c,b,d,!0)};a.uv=function(c,b){var d=
new f.h;b.s(d);return a.Zy(c,d)};a.MH=function(c,b,d,h){h*=h;var l=new f.b;l.zc(c,b);c=new f.b;c.zc(d,b);b=l.pk();d=c.pk();if(b<=h&&d<=h)return!0;var q=f.Ub.Xx(l.Ui(c));return q<=h*b||q<=h*d?0<=l.oi(c):!1};a.UK=function(c,b,d,h){for(var l=0;l<b;l++){var q=c[l].y,a=f.J.nk(q,d,h);a!=q&&(c[l].y=a)}};return a}();f.ma=a})(C||(C={}));(function(f){var a=function(){function b(b){this.ab=b}b.prototype.compare=function(b,c,h){b=b.ja(h);h=this.ab.Ok(c);var f=this.ab.Ok(b);return h<f?-1:h==f?d.Uq(c)&&d.sw(b)?
-1:d.Uq(b)&&d.sw(c)?1:0:1};return b}(),e=function(){function b(b){this.ab=b}b.prototype.gs=function(b,d,c){this.ab.zY(c,b,d)};b.prototype.Qq=function(b){return this.ab.Ok(b)};return b}(),c;(function(b){b[b.initialize=0]="initialize";b[b.pIn=1]="pIn";b[b.pL=2]="pL";b[b.pR=3]="pR";b[b.pT=4]="pT";b[b.right=5]="right";b[b.left=6]="left";b[b.all=7]="all"})(c||(c={}));var b=function(){function b(){this.ab=null;this.pj=new f.Ac;this.oh=new f.ia(0);this.Og=[0,0]}b.prototype.Ni=function(b,d){this.pj.ca=b.ca-
d;this.pj.ha=b.ha+d;this.oh.resize(0);this.Ee=0;this.Og[0]=0};b.prototype.cC=function(b,d,c){if(b>d)throw f.f.F();this.pj.ca=b-c;this.pj.ha=d+c;this.oh.resize(0);this.Ee=0;this.Og[0]=0};b.prototype.Xn=function(b,d){this.pj.ca=b-d;this.pj.ha=b+d;this.oh.resize(0);this.Ee=0;this.Og[0]=0};b.prototype.next=function(){if(!this.ab.$q)throw f.f.La();if(0>this.Ee)return-1;for(var b=!0;b;)switch(this.Og[this.Ee]){case 1:b=this.oW();break;case 2:b=this.pW();break;case 3:b=this.qW();break;case 4:b=this.rW();
break;case 5:b=this.BX();break;case 6:b=this.kV();break;case 7:b=this.uP();break;case 0:b=this.pA();break;default:throw f.f.ya();}return-1!=this.jh?this.Gq()>>1:-1};b.BZ=function(d,c,h){var f=new b;f.ab=d;f.oh.yb(20);f.Ni(c,h);return f};b.CZ=function(d,c,h){var f=new b;f.ab=d;f.oh.yb(20);f.Xn(c,h);return f};b.pa=function(d){var c=new b;c.ab=d;c.oh.yb(20);c.Ee=-1;return c};b.prototype.pA=function(){this.jh=this.GI=this.lj=this.Sc=-1;if(null!=this.ab.Je&&0<this.ab.Je.size)return this.Og[0]=1,this.lj=
this.ab.Mf,!0;this.Ee=-1;return!1};b.prototype.oW=function(){this.Sc=this.lj;if(-1==this.Sc)return this.jh=this.Ee=-1,!1;var b=this.ab.Hq(this.Sc);if(this.pj.ha<b)return b=this.ab.Nk(this.Sc),this.lj=this.ab.Qj(this.Sc),-1!=b&&(this.Ei=this.ab.Ol(b),this.Og[++this.Ee]=6),!0;if(b<this.pj.ca)return b=this.ab.Nk(this.Sc),this.lj=this.ab.Mk(this.Sc),-1!=b&&(this.Ei=this.ab.Ys(b),this.Og[++this.Ee]=5),!0;this.Og[this.Ee]=2;this.GI=this.Sc;b=this.ab.Nk(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=b&&(this.Ei=
this.ab.Ol(b),this.Og[++this.Ee]=7);return!0};b.prototype.pW=function(){this.Sc=this.lj;if(-1==this.Sc)return this.Og[this.Ee]=3,this.lj=this.ab.Mk(this.GI),!0;if(this.ab.Hq(this.Sc)<this.pj.ca){var b=this.ab.Nk(this.Sc);this.lj=this.ab.Mk(this.Sc);-1!=b&&(this.Ei=this.ab.Ys(b),this.Og[++this.Ee]=5);return!0}b=this.ab.Nk(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=b&&(this.Ei=this.ab.Ol(b),this.Og[++this.Ee]=7);b=this.ab.Mk(this.Sc);-1!=b&&this.oh.add(b);return!0};b.prototype.qW=function(){this.Sc=this.lj;
if(-1==this.Sc)return this.Og[this.Ee]=4,!0;if(this.pj.ha<this.ab.Hq(this.Sc)){var b=this.ab.Nk(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=b&&(this.Ei=this.ab.Ol(b),this.Og[++this.Ee]=6);return!0}b=this.ab.Nk(this.Sc);this.lj=this.ab.Mk(this.Sc);-1!=b&&(this.Ei=this.ab.Ol(b),this.Og[++this.Ee]=7);b=this.ab.Qj(this.Sc);-1!=b&&this.oh.add(b);return!0};b.prototype.rW=function(){if(0==this.oh.size)return this.jh=this.Ee=-1,!1;this.Sc=this.oh.get(this.oh.size-1);this.oh.resize(this.oh.size-1);var b=this.ab.Nk(this.Sc);
-1!=b&&(this.Ei=this.ab.Ol(b),this.Og[++this.Ee]=7);-1!=this.ab.Qj(this.Sc)&&this.oh.add(this.ab.Qj(this.Sc));-1!=this.ab.Mk(this.Sc)&&this.oh.add(this.ab.Mk(this.Sc));return!0};b.prototype.kV=function(){this.jh=this.Ei;if(-1!=this.jh&&d.Uq(this.Gq())&&this.ab.Ok(this.Gq())<=this.pj.ha)return this.Ei=this.cH(),!1;this.Ee--;return!0};b.prototype.BX=function(){this.jh=this.Ei;if(-1!=this.jh&&d.sw(this.Gq())&&this.ab.Ok(this.Gq())>=this.pj.ca)return this.Ei=this.IT(),!1;this.Ee--;return!0};b.prototype.uP=
function(){this.jh=this.Ei;if(-1!=this.jh&&d.Uq(this.Gq()))return this.Ei=this.cH(),!1;this.Ee--;return!0};b.prototype.cH=function(){return this.ab.pg?this.ab.vg.nb(this.jh):this.ab.sj.nb(this.jh)};b.prototype.IT=function(){return this.ab.pg?this.ab.vg.Ve(this.jh):this.ab.sj.Ve(this.jh)};b.prototype.Gq=function(){return this.ab.pg?this.ab.vg.ja(this.jh):this.ab.sj.getData(this.jh)};return b}();f.VZ=b;var d=function(){function d(b){this.pn=this.zi=this.vg=this.sj=this.yn=this.$j=this.Je=this.ak=null;
this.pg=b;this.$q=this.Dw=!1}d.prototype.bs=function(){this.ql(!0)};d.prototype.ys=function(b,d){if(!this.Dw)throw f.f.La();this.ak.push(new f.Ac(b,d))};d.prototype.yq=function(){if(!this.Dw)throw f.f.X("invalid call");this.Dw=!1;this.$q=!0;this.pg||(this.pU(),this.Lw=this.ak.length)};d.prototype.eh=function(b){if(!this.pg||!this.$q)throw f.f.F("invalid call");if(-1==this.Mf){var d=this.ak.length;if(this.QA){var c=new f.ia(0);c.yb(2*d);this.UJ(c);this.zi.yb(2*d);this.zi.resize(0);this.TJ(c);this.yn.resize(d,
-1);this.yn.Zh(-1,0,d);this.QA=!1}else this.yn.Zh(-1,0,d);this.Mf=this.Gv()}d=this.CH(b<<1,this.Mf);c=this.vg.addElement((b<<1)+1,this.gA(d));this.LK(d,c);this.yn.set(b,d);this.Lw++};d.prototype.remove=function(b){if(!this.pg||!this.$q)throw f.f.X("invalid call");var d=this.yn.get(b);if(-1==d)throw f.f.F("the interval does not exist in the interval tree");this.yn.set(b,-1);this.Lw--;var c=this.gA(d),h;h=this.vg.RT(c);this.vg.Ld(this.oT(d),c);this.vg.Ld(this.LT(d),c);b=this.vg.size(c);0==b&&(this.vg.HR(c),
this.OK(h,-1));this.$j.kd(d);for(var c=this.eH(h),l=this.Qj(h),a=this.Mk(h),d=0;!(0<b||h==this.Mf||-1!=l&&-1!=a);)h==this.Qj(c)?-1!=l?(this.rl(c,l),this.lk(l,c),this.rl(h,-1)):-1!=a?(this.rl(c,a),this.lk(a,c),this.tl(h,-1)):this.rl(c,-1):-1!=l?(this.tl(c,l),this.lk(l,c),this.rl(h,-1)):-1!=a?(this.tl(c,a),this.lk(a,c),this.tl(h,-1)):this.tl(c,-1),this.lk(h,-1),d++,h=c,c=this.Nk(h),b=-1!=c?this.vg.size(c):0,l=this.Qj(h),a=this.Mk(h),c=this.eH(h)};d.prototype.reset=function(){if(!this.pg||!this.$q)throw f.f.F("invalid call");
this.ql(!1)};d.prototype.size=function(){return this.Lw};d.prototype.mf=function(){return b.pa(this)};d.prototype.UJ=function(b){for(var d=this.ak.length,c=0;c<2*d;c++)b.add(c);this.AY(b,2*d)};d.prototype.TJ=function(b){for(var d=NaN,c=0;c<b.size;c++){var h=b.get(c),f=this.Ok(h);f!=d&&(this.zi.add(h),d=f)}};d.prototype.pU=function(){var b=this.ak.length,d=new f.ia(0);d.yb(2*b);this.UJ(d);this.zi.yb(2*b);this.zi.resize(0);this.TJ(d);this.$j.Qe(b);this.sj.Wn(2*b);var c=f.Uc.wh(b);c.Zh(-1,0,b);this.Mf=
this.Gv();for(b=0;b<d.size;b++){var h=d.get(b),a=c.get(h>>1);-1!=a?this.LK(a,this.sj.addElement(this.gA(a),h)):(a=this.CH(h,this.Mf),c.set(h>>1,a))}};d.prototype.CH=function(b,d){var c=d,h=d,l,q=-1,a=0,e=this.zi.size-1,k=0,p=b>>1,g=NaN,n=NaN;l=!0;for(var u=this.vT(p),p=this.sT(p);l;){a<e?(k=a+f.J.truncate((e-a)/2),-1==this.Oz(c)&&this.uK(c,this.zi.get(k),this.zi.get(k+1))):-1==this.Oz(c)&&this.uK(c,this.zi.get(a),this.zi.get(a));var z=this.Hq(c);if(p<z)-1!=d&&(d==c?(h=c,g=z,d=this.Qj(c),-1!=d?n=this.Hq(d):
n=NaN):n>z&&(z<g?this.rl(h,c):this.tl(h,c),this.tl(c,d),this.pg&&(this.lk(c,h),this.lk(d,c)),h=c,g=z,d=-1,n=NaN)),e=this.qT(c),-1==e&&(e=this.Gv(),this.XX(c,e)),c=e,e=k;else if(u>z)-1!=d&&(d==c?(h=c,g=z,d=this.Mk(c),-1!=d?n=this.Hq(d):n=NaN):n<z&&(z<g?this.rl(h,c):this.tl(h,c),this.rl(c,d),this.pg&&(this.lk(c,h),this.lk(d,c)),h=c,g=z,d=-1,n=NaN)),a=this.MT(c),-1==a&&(a=this.Gv(),this.hY(c,a)),c=a,a=k+1;else{l=this.Nk(c);-1==l&&(l=this.vR(c),this.OK(c,l));var r=this.cP(l,b),q=this.tR();this.kY(q,l);
this.WX(q,r);c!=d&&(z<g?this.rl(h,c):this.tl(h,c),this.pg&&this.lk(c,h),-1!=d&&(n<z?this.rl(c,d):this.tl(c,d),this.pg&&this.lk(d,c)));l=!1}}return q};d.prototype.Gv=function(){return this.Je.Pe()};d.prototype.vR=function(b){return this.pg?this.vg.Js(b):this.sj.mi(b)};d.prototype.tR=function(){return this.$j.Pe()};d.prototype.ql=function(b){b?(this.Dw=this.QA=!0,this.$q=!1,null==this.zi?this.zi=f.Uc.wh(0):this.zi.resize(0),null==this.ak?this.ak=[]:this.ak.length=0):this.QA=!1;this.pg?null==this.yn?
(this.yn=f.Uc.wh(0),this.vg=new f.tk,this.vg.Ep(new a(this))):this.vg.clear():null==this.sj?this.sj=new f.Xp:this.sj.clear();null==this.Je?(this.$j=new f.ad(3),this.Je=new f.ad(this.pg?8:7)):(this.$j.Vi(!1),this.Je.Vi(!1));this.Mf=-1;this.Lw=0};d.prototype.uK=function(b,d,c){this.RX(b,d);this.SX(b,c)};d.prototype.Hq=function(b){var d=this.Oz(b);if(-1==d)return NaN;d=this.Ok(d);b=this.Ok(this.XS(b));return d==b?d:.5*(d+b)};d.prototype.RX=function(b,d){this.Je.P(b,0,d)};d.prototype.SX=function(b,d){this.Je.P(b,
1,d)};d.prototype.XX=function(b,d){this.Je.P(b,3,d)};d.prototype.hY=function(b,d){this.Je.P(b,4,d)};d.prototype.OK=function(b,d){this.Je.P(b,2,d)};d.prototype.rl=function(b,d){this.Je.P(b,5,d)};d.prototype.tl=function(b,d){this.Je.P(b,6,d)};d.prototype.lk=function(b,d){this.Je.P(b,7,d)};d.prototype.kY=function(b,d){this.$j.P(b,0,d)};d.prototype.cP=function(b,d){return this.pg?this.vg.addElement(d,b):this.sj.addElement(b,d)};d.prototype.WX=function(b,d){this.$j.P(b,1,d)};d.prototype.LK=function(b,
d){this.$j.P(b,2,d)};d.prototype.Ol=function(b){return this.pg?this.vg.xc(b):this.sj.xc(b)};d.prototype.Ys=function(b){return this.pg?this.vg.Fc(b):this.sj.Fc(b)};d.Uq=function(b){return 0==(b&1)};d.sw=function(b){return 1==(b&1)};d.prototype.Oz=function(b){return this.Je.S(b,0)};d.prototype.XS=function(b){return this.Je.S(b,1)};d.prototype.Nk=function(b){return this.Je.S(b,2)};d.prototype.qT=function(b){return this.Je.S(b,3)};d.prototype.MT=function(b){return this.Je.S(b,4)};d.prototype.Qj=function(b){return this.Je.S(b,
5)};d.prototype.Mk=function(b){return this.Je.S(b,6)};d.prototype.eH=function(b){return this.Je.S(b,7)};d.prototype.gA=function(b){return this.$j.S(b,0)};d.prototype.oT=function(b){return this.$j.S(b,1)};d.prototype.LT=function(b){return this.$j.S(b,2)};d.prototype.vT=function(b){return this.ak[b].ca};d.prototype.sT=function(b){return this.ak[b].ha};d.prototype.AY=function(b,d){null==this.pn&&(this.pn=new f.Gu);var c=new e(this);this.pn.sort(b,0,d,c)};d.prototype.zY=function(b,c,h){var f=this;b.Gd(c,
h,function(b,c){var h=f.Ok(b),l=f.Ok(c);return h<l||h==l&&d.Uq(b)&&d.sw(c)?-1:1})};d.prototype.Ok=function(b){var c=this.ak[b>>1];return d.Uq(b)?c.ca:c.ha};return d}();f.ms=d})(C||(C={}));(function(f){var a=function(){function a(c){if(null==c)throw f.f.X("Invalid arguement");this.Ke=c;var b=c.dT();b.aU()?c.ie.TH()?this.Zo=f.di.PannableFold:this.Zo=f.di.Clip:this.Zo=f.di.DontClip;b.bU()?c.He.TH()?this.En=f.di.PannableFold:this.En=f.di.Clip:this.En=f.di.DontClip;this.qn=b.xv;this.xI=b.sz;c=this.Ke.DI;
this.lI=c.dt(2147483648);this.Fw=c.dt(1073741824)}a.Xg=function(c,b,d){return b.wr.Xg(c,d)};a.fs=function(c,b,d,h){return c.wr.fs(b,d,h)};a.Cu=function(c,b,d,h){d=0>d?b.length:d;c=c.wr.fs(b,d,h);if(c==d)return c;for(var f=b=0;f<d;f++){var a=h[f];a.isNaN()||(b<f&&h[b].L(a),b++)}for(;b<d;b++)h[b].$c();return c};a.KC=function(c,b,d,h){return c.wr.KC(b,d,h)};a.hL=function(c,b,d,h){d=0>d?b.length:d;c=c.wr.KC(b,d,h);if(c==d)return c;for(var f=b=0;f<d;f++){var a=h[f];isNaN(a.x)||(b<f&&h[b].I(a.x,a.y,a.z),
b++)}for(;b<d;b++)h[b].cv();return c};a.transform=function(c,b,d,h,l){if(c.Ho())return f.ma.iR(h,b,d),d;for(var q=[],v=0,e=0;e<d;){for(var k=Math.min(q.length,d-e),p=e,g=0;p<k;p++,g++)null==q[g]?q[g]=b[p].w():b[p].w(q[g]);var n;n=l?a.Cu(c,q,k,q):a.fs(c,q,k,q);for(g=p=0;p<n;p++,g++)null==h[e]&&(h[e]=new f.Wa(b[e])),h[e].rb(q[g]);e+=k;v+=n}return v};a.iL=function(c,b,d){if(0==d)return[];var h=new f.Ed;h.mP(b,2*d);b=this.Xg(h,c,null);c=b.Pa(0);b=2*b.D();d=f.J.gf(b);c.pl(0,b,d,0,!0);return d};a.prototype.fs=
function(c,b,d){if(this.Ke.Ho())return c!=d&&f.ma.Ev(d,c,b),b;var h=this.Ke.ie,l=this.Ke.He,a=h.Fb(),v=l.Fb();if(0==a&&a===v){var e=h.Yi(),l=l.Yi(),l=e/l,e=new f.Hd;e.Op(l,l);e.YY(c,b,d);return b}e=f.J.pv(Math.min(b,64));if(3==a){var k;k=h.ij;h=k.Fk();a=h.Fb();d!=c&&f.ma.Ev(d,c,b);f.Ib.Dl(k,d,b,!0);k.Cu(f.Pm.forward,d,b);f.Ib.Cl(k,d,b,!0)}if(3==a||3===v)throw f.f.X("image: transform_in_place_");if(2==a)this.Zo==f.di.Clip?(d!=c&&f.ma.Ev(d,c,b),c=h.Lk(),f.Ib.IU(c,h,d,b)):(d!=c&&f.ma.Ev(d,c,b),h.Jc()&&
(a=h.re(0),k=h.qe(),f.Ib.xY(d,b,k,a),f.Ib.AG(d,b,h,0))),f.Ib.vN(h,d,b,e);else for(a=h.re(0),k=h.qe(),h=0;h<b;h++)f.Ib.yY(c[h],k,a,d[h]);f.Ib.tN(this.Ke,d,b,e);c=0;(v=2==v)?c=l.pi():isNaN(this.qn)||(c=this.qn);v&&this.En!=f.di.Clip||f.Ib.AG(d,b,l.kc(),c);v&&(f.Ib.KH(d,b,l,this.En),f.Ib.uN(l,d,b,e));c=b;for(h=0;h<b;++h)d[h].isNaN()&&c--;return c};a.prototype.KC=function(c,b,d){b=0>b?c.length:b;if(this.Ke.Ho()){for(var h=0;h<b;++h)null==d[h]&&(d[h]=new f.qd),d[h].I(c[h].x,c[h].y,c[h].z);return b}var l=
this.Ke.ie,h=this.Ke.He,a=l.Fb(),v=h.Fb();if(0==a&&a==v)return l=l.Yi(),h=h.Yi(),h=l/h,l=new f.dO,l.Op(h,h,h),l.transform(c,b,d),b;a=new f.Ed;a.Ud(1);a.Ud(3);a.lP(c);c=a.Pa(3);h=0;for(l=b;h<l;h++)c.write(h,h);a=this.Xg(a,null);for(h=0;h<b;++h)null==d[h]?d[h]=f.qd.pa(NaN,NaN,NaN):d[h].cv();if(null==a)return 0;c=a.Pa(3);var v=a.Pa(0),e=a.Pa(1);a.eX(d,b);h=0;for(l=a.D();h<l;h++)b=c.read(h),v.nX(2*h,d[b]),d[b].z=e.read(h);return a.D()};a.prototype.Xg=function(c,b){if(this.Ke.Ho()||c.u())return c;if(33==
c.G())return this.OJ(c);var d=this.Ke.ie,h=this.Ke.He,l=d.Fb(),a=h.Fb();if(0==l&&l==a)return d=d.Yi(),h=h.Yi(),d/=h,h=new f.Hd,h.Op(d,d),d=f.T.ne(c),d.Xc(h),d;switch(c.G()){case 1607:case 1736:h=this.MJ(c,b);break;case 550:h=this.VW(c,b);break;case 197:h=this.UW(c,b);break;default:throw f.f.X("");}return h};a.prototype.OJ=function(c){var b=c.w(),d=[];d[0]=b;this.fs(d,1,d);c=new f.Wa(c);c.rb(d[0]);return c};a.prototype.MJ=function(c,b){if(c.jn())throw f.f.X("curves not supported");var d=c.G();if(1736==
d)return this.WW(c,b);if(1607==d)return this.XW(c,b);throw f.f.X("projectMultiPath");};a.prototype.WW=function(c,b){var d=this.Ke.ie,h=this.Ke.He,l=d.Fb(),q=h.Fb(),v=f.J.pv(Math.min(c.D(),64));c=f.Ia.ne(c);if(3==l){var e=d.ij,d=e.Fk(),l=d.Fb();c=e.Dl(c,!0);this.qq(e,f.Pm.forward,c);c=e.Cl(c,!0)}e=null;3==q&&(e=h.ij,h=e.Fk(),q=h.Fb());var k=2==l,p=2==q,g=p?h.kc():h,n=!p&&!this.Fw,q=!1,u=c;if(k){if(u=f.Ib.LJ(u,d,this.Zo,b),u.u())return u}else{c=new f.h;u.ac(c);l=d.qe();if(c.A<l.A||c.B>l.B){var z=f.h.pa(c.o-
1,l.A,c.v+1,l.B),u=f.uh.rq(u,z,d,NaN,0,b);if(u.u())return u}c.N()>2*l.N()&&(u=f.Ib.Aq(u,-2*l.N(),2*l.N(),d,!0,0,!0,b))}c=this.xI;(l=!isNaN(c))&&(u=f.Km.local().V(u,c,b));var z=p?h.Sj():null,r=NaN;k&&(r=d.pi());var t=null!=h.Vs();if(this.lI)k&&(f.Ib.ps(d,r,u,v),l&&(k=d.Ch(),r=d.kc().Ch(),c*=r/k)),f.Ib.os(this.Ke,u,n,v),l&&(k=d.kc().Ch(),r=h.kc().Ch(),c*=r/k),d=u;else{var A=new f.Ua(u.description);A.TE(u);k&&(f.Ib.ps(d,r,A,v),l&&(k=d.Ch(),r=d.kc().Ch(),c*=r/k));f.Ib.os(this.Ke,A,n,v);l&&(k=d.kc().cn(),
r=h.kc().cn(),c*=r/k);n=NaN;p?(z=h.Sj(),n=h.pi()):isNaN(this.qn)||(n=this.qn);k=a.se(d)|a.se(h);r=10*g.re(0);this.Fw&&(k=3,r=0);d=f.Ib.JS(u,d,A,g,n,b,k,r)}t&&(d=f.Ib.iF(d,h,b));p&&(q||(p=g.qe().N(),d.xf(0,0).N()>=p-g.re(0)&&(g=z.getNorthPoleLocation(),p=z.getSouthPoleLocation(),u=z.getNorthPoleGeometry(),z=z.getSouthPoleGeometry(),n=0,u==f.Bg.PE_POLE_POINT&&g!=f.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(n=1),z==f.Bg.PE_POLE_POINT&&p!=f.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(n|=2),0!==n&&(q=!0))),d=f.Ib.sA(d,h,this.En,
b),l&&(d=f.Km.local().V(d,c,b)),f.Ib.uy(h,d,v));if(d.u())return d;q&&(d=f.Lm.local().V(d,h,!1,b));null!=e&&(d=e.Cl(d,!1),this.qq(e,f.Pm.reverse,d),d=e.Dl(d,!1));return d};a.se=function(c){if(2!=c.Fb())return 0;var b=0,d=c.Sj();c=d.getNorthPoleLocation();var h=d.getSouthPoleLocation(),l=d.getNorthPoleGeometry(),d=d.getSouthPoleGeometry();l==f.Bg.PE_POLE_POINT&&c!=f.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(b=1);d==f.Bg.PE_POLE_POINT&&h!=f.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(b|=2);return b};a.prototype.XW=function(c,
b){var d=this.Ke.ie,h=this.Ke.He,l=d.Fb(),q=h.Fb(),v=f.J.pv(Math.min(c.D(),64));c=f.Ua.ne(c);if(3==l){var e=d.ij,d=e.Fk(),l=d.Fb();c=e.Dl(c,!0);this.qq(e,f.Pm.forward,c);c=e.Cl(c,!0)}e=null;3==q&&(e=h.ij,h=e.Fk(),q=h.Fb());var k=2==l,l=(q=2==q)?h.kc():h,p=!q&&!this.Fw;if(k){if(c=f.Ib.LJ(c,d,this.Zo,b),c.u())return c}else{var g=new f.h;c.ac(g);var n=d.qe();if(g.A<n.A||g.B>n.B)if(g=f.h.pa(g.o-1,n.A,g.v+1,n.B),c=f.uh.rq(c,g,d,NaN,0,b),c.u())return c}var u=NaN;k&&(u=d.pi());var g=null!=h.Vs(),n=this.xI,
z=!isNaN(n);z&&(c=f.Km.local().V(c,n,b));if(this.lI)k&&f.Ib.ps(d,u,c,v),z&&(k=d.Ch(),u=d.kc().Ch(),n*=u/k),f.Ib.os(this.Ke,c,p,v),z&&(k=d.kc().Ch(),u=h.kc().Ch(),n*=u/k),d=c;else{var r=new f.Ua(c.description);r.TE(c);k&&(f.Ib.ps(d,u,r,v),z&&(k=d.Ch(),u=d.kc().Ch(),n*=u/k));f.Ib.os(this.Ke,r,p,v);z&&(k=d.kc().Ch(),u=h.kc().Ch(),n*=u/k);p=NaN;q?p=h.pi():isNaN(this.qn)||(p=this.qn);k=a.se(d)|a.se(h);u=10*l.re(0);this.Fw&&(k=3,u=0);d=f.Ib.KS(c,d,r,l,p,b,k,u)}g&&(d=f.Ib.iF(d,h,b));q&&(d=f.Ib.sA(d,h,this.En,
b),z&&(d=f.Km.local().V(d,n,b)),f.Ib.uy(h,d,v));if(d.u())return d;null!=e&&(d=e.Cl(d,!1),this.qq(e,f.Pm.reverse,d),d=e.Dl(d,!1));return d};a.prototype.UW=function(c,b){var d=(c.fa()+c.N())/400;if(0!=d){var h=f.Km.local().V(c,d,b),h=this.MJ(h,b),d=c.Ja();h.Rn(d)}else d=new f.Wa(c.Bq()),h=this.OJ(d),d=c.Ja(),h.u()?d.Oa():(c.copyTo(d),h=h.w(),d.I(h.x,h.y,h.x,h.y));return d};a.prototype.VW=function(c,b){c=f.T.ne(c);var d=this.Ke.ie,h=this.Ke.He,l=d.Fb(),a=h.Fb(),v=f.J.pv(Math.min(c.D(),64));if(3==l){var e=
d.ij,d=e.Fk(),l=d.Fb();c=e.Cl(c,!0);this.qq(e,f.Pm.forward,c);c=e.Dl(c,!0)}if(2==l){this.Zo==f.di.Clip?c=f.sk.local().V(c,d.Lk(),d,b):d.Jc()&&(l=new f.h,c.ac(l),d.qe().contains(l)||(this.Zo==f.di.PannableFold&&(c=f.Ib.Mj(c,d)),f.Ib.wu(c,d.qe(),d.re(0),!0),c=f.Ib.Ym(c,d,0,!0,0,b)));if(c.u())return c;f.Ib.ps(d,0,c,v)}else f.Ib.wu(c,d.qe(),d.re(0),!0);f.Ib.os(this.Ke,c,!1,v);d=0;l=!1;e=null;3==a&&(l=!0,e=h.ij,h=e.Fk(),a=h.Fb());(a=2==a)?d=h.pi():isNaN(this.qn)||(d=this.qn);a&&this.En!=f.di.Clip||(c=
f.Ib.Ym(c,h.kc(),d,!1,0,b));if(a&&(c=f.Ib.sA(c,h,this.En,b),f.Ib.uy(h,c,v),c.u()))return c;l&&(c=e.Cl(c,!0),this.qq(e,f.Pm.reverse,c),c=e.Dl(c,!0));return c};a.prototype.qq=function(c,b,d){var h=d.D();if(0!=h){for(var l=d.Pa(0),a=f.J.gf(200,0),v=[],e=0;e<h;){var k=Math.min(100,h-e);l.pl(2*e,2*k,a,2,!0);for(var p=0;p<k;++p)v[p]=f.b.pa(a[2*e],a[2*e+1]);c.Cu(b,v,k);e+=k}d.Dc(1993)}};a.qk=function(c,b,d){if(null==c||null==b||!b.Jc())throw f.f.X("Invalid Arguement");if(c.u())return c;var h;h=c.G();197==
h?(h=new f.Ia(c.description),h.jd(c,!1)):f.T.Oc(h)?(h=new f.Ua(c.description),h.dc(c,!0)):h=c;h=f.Ib.Mj(h,b);return h.u()?h:f.Ib.Ym(h,b,0,h!=c,0,d)};a.Nj=function(c,b,d,h){if(null==c||null==b||!b.Jc())throw f.f.X("Invalid Arguement");if(c.u())return c;var l=c.G();if(f.T.Ic(l)){c=f.Ib.Mj(c,b);l=new f.h;c.s(l);for(var q=f.ma.Yy(b,l,!1),v=b.Bh(),e=Math.floor((l.o-v.o)/v.N())*v.N()+v.o;e<l.v;)e>l.o+q&&e<l.v-q&&(c=f.Ib.oU(c,b,d,e)),e+=v.N()}else{if(197==l)return l=new f.Ia(c.description),l.jd(c,!1),a.Nj(l,
b,d,h);if(f.T.Oc(l))return l=new f.Ua(c.description),l.dc(c,!0),a.Nj(l,b,d,h)}return a.qk(c,b,h)};a.Yp=function(c,b,d,h){var l=b.Fb(),q=new f.dE;b.hX(q);if(0==l)return a.Dj(c,q,b,d);h==f.Up.foldAndClipWithHorizon&&b.Jc()&&(c=a.qk(c,b,d));c=a.Dj(c,q,b,d);if(h==f.Up.clipToDomainOnly||c.u())return c;if(1==l)return h==f.Up.clipWithHorizon?(h=new f.h,c.ac(h),l=b.qe(),q=.01*l.N(),h.A=l.A,h.B=l.B,h.o-=q,h.v+=q,f.uh.rq(c,h,b,NaN,0,d)):c;if(2==l)return l=b.Lk(),h==f.Up.clipWithHorizon||h==f.Up.foldAndClipWithHorizon?
(b=f.sk.local().V(c,l,b,d),b==l?f.T.ne(b):b):c;if(3==l)return c;throw f.f.X("missing implementation");};a.Dj=function(c,b,d,h){var l=b.VT(),a=c.hasAttribute(1),v=c.hasAttribute(2),e=new f.Ac;e.Oa();var k=new f.Ac;k.Oa();a&&(e=b.WT());v&&(k=b.rT());b=f.uh.rq(c,l,d,NaN,0,h);a&&(a=b.xf(1,0),e.contains(a)||(c==b&&(b=f.T.ne(b)),f.ma.TK(b,e,1)));v&&(a=b.xf(2,0),k.contains(a)||(c==b&&(b=f.T.ne(b)),f.ma.TK(b,k,2)));return b};return a}();f.ko=a})(C||(C={}));(function(f){var a=function(a){function c(b,d,c,
l){a.call(this);void 0===b?this.description=f.ye.Ig():void 0===c?this.description=b:(this.description=f.ye.Ig(),this.vC(b,d),this.vm(c,l))}N(c,a);c.prototype.G=function(){return 322};c.prototype.Rb=function(){var b=this.ua-this.sa,d=this.ra-this.oa;return Math.sqrt(b*b+d*d)};c.prototype.fh=function(b){var d=this.ua-this.sa,c=this.ra-this.oa;return Math.sqrt(d*d+c*c)<=b};c.prototype.Go=function(){return!1};c.prototype.Eg=function(){var b=new f.b;b.zc(this.Cc(),this.ec());return b};c.eR=function(b,
d){return new c(b.x,b.y,d.x,d.y)};c.prototype.Rn=function(b){b.Oa();b.Fg(this.description);var d=new f.h;this.s(d);b.Gp(d);for(var d=1,c=this.description.Ea;d<c;d++)for(var l=this.description.zd(d),a=f.na.Xa(l);d<a;d++){var v=this.xf(l,0);b.setInterval(l,0,v)}};c.prototype.s=function(b){b.I(this.ua,this.ra,this.sa,this.oa);b.normalize()};c.prototype.Cp=function(b){b.Oa();b.Nb(this.ua,this.ra,this.ae(0,1,0));b.Nb(this.sa,this.oa,this.ae(1,1,0))};c.prototype.Xc=function(b){if(b instanceof f.Hd){this.Bc();
var d=new f.b;d.x=this.ua;d.y=this.ra;b.$h(d,d);this.ua=d.x;this.ra=d.y;d.x=this.sa;d.y=this.oa;b.$h(d,d);this.sa=d.x;this.oa=d.y}else this.Bc(),d=new f.qd,d.x=this.ua,d.y=this.ra,d.z=this.ae(0,1,0),d=b.Rp(d),this.ua=d.x,this.ra=d.y,this.oo(0,1,0,d.z),d.x=this.sa,d.y=this.oa,d.z=this.ae(1,1,0),d=b.Rp(d),this.sa=d.x,this.oa=d.y,this.oo(1,1,0,d.z)};c.prototype.Ja=function(){return new c(this.description)};c.prototype.By=function(b,d){return(this.sa-b-(this.ua-b))*(this.oa-d+(this.ra-d))*.5};c.prototype.by=
function(b){return b*this.Rb()};c.prototype.aI=function(b){return b/this.Rb()};c.prototype.OG=function(b){return f.Ub.Wq(this.ua,this.sa,b)};c.prototype.WS=function(b){return f.Ub.Wq(this.ra,this.oa,b)};c.prototype.Hl=function(b,d){var c=new f.Cg;this.yh(b,d,c);return c.get()};c.prototype.yh=function(b,d,c){if(null==c)throw f.f.F();c.Is();c=c.get();c.Fg(this.description);var h=new f.b;this.gc(b,h);c.vC(h.x,h.y);this.gc(d,h);c.vm(h.x,h.y);for(var h=1,a=this.description.Ea;h<a;h++)for(var v=this.description.Id(h),
e=f.na.Xa(v),k=0;k<e;k++){var p=this.Yc(b,v,k);c.Sx(v,k,p);p=this.Yc(d,v,k);c.Kx(v,k,p)}};c.prototype.Yc=function(b,d,c){if(0==d)return 0==c?this.gc(b).x:this.gc(b).y;switch(f.na.Vz(d)){case 0:return.5>b?this.ct(d,c):this.Ns(d,c);case 1:var h=this.ct(d,c);d=this.Ns(d,c);return f.Ub.Wq(h,d,b);case 2:throw f.f.X("not implemented");}throw f.f.ya();};c.prototype.oe=function(b,d){var c=this.sa-this.ua,f=this.oa-this.ra,a=c*c+f*f;if(0==a)return.5;c=((b.x-this.ua)*c+(b.y-this.ra)*f)/a;d||(0>c?c=0:1<c&&(c=
1));return c};c.prototype.Sq=function(b,d,c,f){if(b){b=this.oa-this.ra;if(0==b)return d==this.oa?-1:0;d=(d-this.ra)/b;if(0>d||1<d)return 0;null!=c&&(c[0]=this.OG(d))}else{b=this.sa-this.ua;if(0==b)return d==this.sa?-1:0;d=(d-this.ua)/b;if(0>d||1<d)return 0;null!=c&&(c[0]=this.WS(d))}null!=f&&(f[0]=d);return 1};c.prototype.pf=function(b,d){var c=this.oa-this.ra;if(0==c)return b==this.oa?d:NaN;c=(b-this.ra)/c;b=this.OG(c);1==c&&(b=this.sa);return b};c.prototype.$u=function(b,d,c){return 0<=this.lq(b.x,
b.y,d,c)};c.prototype.Si=function(b,d,c){return 0<=this.lq(b,d,c,!0)};c.prototype.lt=function(b,d){return this.$u(b,d,!1)};c.prototype.AJ=function(){if(this.oa<this.ra||this.oa==this.ra&&this.sa<this.ua){var b=this.ua;this.ua=this.sa;this.sa=b;b=this.ra;this.ra=this.oa;this.oa=b;for(var b=0,d=this.description.Dr-2;b<d;b++){var c=this.la[b];this.la[b]=this.la[b+d];this.la[b+d]=c}}};c.prototype.dv=function(b,d){b=f.b.pa(b,d);b.sub(this.ec());d=new f.b;d.zc(this.Cc(),this.ec());var c=d.Ui(b);b=8.881784197001252E-16*
(Math.abs(d.x*b.y)+Math.abs(d.y*b.x));return c>b?-1:c<-b?1:0};c.prototype.lq=function(b,d,c,l){var h=this.ua,a=this.ra,e=b-h,k=d-a,e=Math.sqrt(e*e+k*k);if(e<=Math.max(c,6.661338147750939E-16*e))return l&&0==e?NaN:0;e=b-this.sa;k=d-this.oa;e=Math.sqrt(e*e+k*k);if(e<=Math.max(c,6.661338147750939E-16*e))return l&&0==e?NaN:1;e=this.sa-this.ua;k=this.oa-this.ra;l=Math.sqrt(e*e+k*k);if(0<l){var p=1/l,e=e*p,k=k*p,g=b-h,n=d-a,u=g*e+n*k,z=1.7763568394002505E-15*(Math.abs(g*e)+Math.abs(n*k)),r=e,e=-k,k=r,z=
Math.max(c,z);if(u<-z||u>l+z)return NaN;if(Math.abs(g*e+n*k)<=Math.max(c,1.7763568394002505E-15*(Math.abs(g*e)+Math.abs(n*k)))&&(e=f.J.nk(u*p,0,1),.5>=e?(k=this.ua+(this.sa-this.ua)*e,l=this.ra+(this.oa-this.ra)*e):(k=this.sa-(this.sa-this.ua)*(1-e),l=this.oa-(this.oa-this.ra)*(1-e)),f.b.wz(k,l,b,d)<=c)){if(.5>e){if(f.b.wz(k,l,h,a)<=c)return 0}else if(f.b.wz(k,l,this.sa,this.oa)<=c)return 1;return e}}return NaN};c.prototype.Eb=function(b){return null==b?!1:b==this?!0:b.constructor!==this.constructor?
!1:this.LO(b)};c.prototype.HE=function(b,d,c){var h=c?this.ua:this.sa;c=c?this.ra:this.oa;var a=new f.b;a.x=b.sa-h;a.y=b.oa-c;return d.oi(a)>6.661338147750939E-16*d.xE(a)?(a.x=b.ua-h,a.y=b.ra-c,d.oi(a)<=6.661338147750939E-16*d.xE(a)):!0};c.prototype.GE=function(b){var d=new f.b;d.x=this.sa-this.ua;d.y=this.oa-this.ra;if(!this.HE(b,d,!1))return!1;d.Kr();return this.HE(b,d,!0)?!0:!1};c.We=function(b,d){var c=b.dv(d.ua,d.ra),f=b.dv(d.sa,d.oa);if(0>c&&0>f||0<c&&0<f)return!1;c=d.dv(b.ua,b.ra);f=d.dv(b.sa,
b.oa);if(0>c&&0>f||0<c&&0<f)return!1;c=b.Rb();f=d.Rb();return c>f?b.GE(d):d.GE(b)};c.se=function(b,d,c){var h=f.b.pa(NaN,NaN),a=b.sa-b.ua,v=b.oa-b.ra,e=d.sa-d.ua,k=d.oa-d.ra,p=e*v-a*k;if(0==p)return h;var g=8.881784197001252E-16*(Math.abs(e*v)+Math.abs(a*k)),n=d.ua-b.ua,u=d.ra-b.ra,z=e*u-n*k,r=z/p,t=Math.abs(p),e=(8.881784197001252E-16*(Math.abs(e*u)+Math.abs(n*k))*t+g*Math.abs(z))/(p*p)+2.220446049250313E-16*Math.abs(r);if(r<-e||r>1+e)return h;k=a*u-n*v;e=k/p;a=(8.881784197001252E-16*(Math.abs(a*
u)+Math.abs(n*v))*t+g*Math.abs(k))/(p*p)+2.220446049250313E-16*Math.abs(e);if(e<-a||e>1+a)return h;r=f.J.nk(r,0,1);a=f.J.nk(e,0,1);v=b.gc(r);p=d.gc(a);g=new f.b;g.zc(v,p);if(g.length()>c&&(g.add(v,p),g.scale(.5),r=b.oe(g,!1),a=d.oe(g,!1),b=b.gc(r),d=d.gc(a),b.sub(d),b.length()>c))return h;h.ka(r,a);return h};c.PO=function(b,d,h,f){var l=0;if(b.ua==d.ua&&b.ra==d.ra||b.ua==d.sa&&b.ra==d.oa)if(l++,!f)return 1;if(b.sa==d.ua&&b.oa==d.ra||b.sa==d.sa&&b.oa==d.oa){l++;if(2==l)return 2;if(!f)return 1}return d.Si(b.ua,
b.ra,h)||d.Si(b.sa,b.oa,h)||b.Si(d.ua,d.ra,h)||b.Si(d.sa,d.oa,h)?1:f&&0!=l?0:0==c.We(b,d)?0:1};c.Fy=function(b,d,h,l,a,v){var q=0,e=b.lq(d.ua,d.ra,v,!1),k=b.lq(d.sa,d.oa,v,!1),p=d.lq(b.ua,b.ra,v,!1),g=d.lq(b.sa,b.oa,v,!1);isNaN(e)||(null!=l&&(l[q]=e),null!=a&&(a[q]=0),null!=h&&(h[q]=f.b.pa(d.ua,d.ra)),q++);isNaN(k)||(null!=l&&(l[q]=k),null!=a&&(a[q]=1),null!=h&&(h[q]=f.b.pa(d.sa,d.oa)),q++);2==q||isNaN(p)||0==e&&0==p||0==k&&1==p||(null!=l&&(l[q]=0),null!=a&&(a[q]=p),null!=h&&(h[q]=f.b.pa(b.ua,b.ra)),
q++);2==q||isNaN(g)||1==e&&0==g||1==k&&1==g||(null!=l&&(l[q]=1),null!=a&&(a[q]=g),null!=h&&(h[q]=f.b.pa(d.sa,d.oa)),q++);if(0<q)return 2==q&&null!=l&&l[0]>l[1]&&(b=l[0],l[0]=l[1],l[1]=b,null!=a&&(l=a[0],a[0]=a[1],a[1]=l),null!=h&&(a=f.b.pa(h[0].x,h[0].y),h[0]=h[1],h[1]=a)),q;q=c.se(b,d,v);if(isNaN(q.x))return 0;null!=h&&(h[0]=b.gc(q.x));null!=l&&(l[0]=q.x);null!=a&&(a[0]=q.y);return 1};c.prototype.pH=function(){return 0};c.prototype.iq=function(){};c.prototype.toString=function(){return"Line: ["+
this.ua.toString()+", "+this.ra.toString()+", "+this.sa.toString()+", "+this.oa.toString()+"]"};return c}(f.bE);f.Hb=a})(C||(C={}));(function(f){var a=function(){function f(){this.am=[];this.Ba=-1}f.prototype.Ha=function(){return this.Ba};f.prototype.next=function(){if(null!=this.am&&0!=this.am.length){this.Ba++;var c=this.am[0];1>=this.am.length?this.am=[]:this.am=this.am.slice(1);return c}return this.am=null};f.prototype.RY=function(c){this.am.push(c)};f.prototype.Re=function(){return!0};return f}();
f.PM=a})(C||(C={}));(function(f){(function(f){f[f.enumFillRuleOddEven=0]="enumFillRuleOddEven";f[f.enumFillRuleWinding=1]="enumFillRuleWinding"})(f.HN||(f.HN={}));var a=function(a){function c(b,d){a.call(this);this.$f=!1;this.tr=null;this.fr=this.gr=0;this.bj=null;this.hh=!1;this.Xd=this.tj=this.cf=this.jb=this.kb=null;this.lr=this.Ta=this.hr=0;if(void 0===d)this.$f=b,this.hh=!1,this.qa=this.fr=this.gr=this.hr=0,this.description=f.ye.Ig();else{if(null==d)throw f.f.F();this.$f=b;this.hh=!1;this.qa=
this.fr=this.gr=this.hr=0;this.description=d}this.bj=null;this.Ta=0}N(c,a);c.prototype.jn=function(){return 0<this.hr};c.prototype.Ey=function(){this.Bc();null==this.tr?this.tr=new f.Wa(this.description):this.tr.Fg(this.description)};c.prototype.Zx=function(b,d){var c=new f.b;c.x=b;c.y=d;this.yu(c)};c.prototype.yu=function(b){this.Ey();this.tr.rb(b);this.hh=!0};c.prototype.Rf=function(b){if(b.u())throw f.f.F();this.om(b.description);this.Ey();b.copyTo(this.tr);this.hh=!0};c.prototype.Ay=function(){var b=
1;this.hh&&(this.Ey(),null==this.kb?(this.kb=f.Uc.wh(2),this.kb.write(0,0),this.jb=f.Uc.vq(2,0)):(this.kb.resize(this.kb.size+1,0),this.jb.resize(this.jb.size+1,0)),this.$f&&this.jb.write(this.jb.size-2,1),b++);var d=this.qa;this.kb.write(this.kb.size-1,this.qa+b);this.zl(d+b);this.jb.write(this.kb.size-1,0);this.hh&&(this.uu(d,this.tr),this.hh=!1)};c.prototype.Wj=function(b,d){this.Ay();this.rb(this.qa-1,b,d)};c.prototype.aj=function(b){this.Ay();this.rb(this.qa-1,b)};c.prototype.lineTo=function(b){this.Ay();
this.uu(this.qa-1,b)};c.prototype.mW=function(b){this.Bc();if(this.$f)throw f.f.ya();var d=this.aa();if(b>d)throw f.f.ya();if(this.Qb(b)){if(null==this.jb)throw f.f.ya();var c=this.qa,l=this.wa(b),a=this.Gc(b);this.zl(this.qa+1);this.tc();for(var v=0,e=this.description.Ea;v<e;v++)if(null!=this.xa[v]){var k=f.na.Xa(this.description.Id(v));this.xa[v].Rk(k*a,this.xa[v],k*l,k,!0,1,k*c)}for(;d>b;d--)c=this.kb.read(d),this.kb.write(d,c+1);this.jb.ez(b,1)}};c.prototype.sq=function(){var b;this.Bu();void 0===
b&&(this.hh=!1,b=this.aa()-1);var d=this.jb.read(b);this.jb.write(b,d|1);null!=this.cf&&(b=this.Gc(b)-1,this.cf.write(b,1),this.tj.write(b,-1))};c.Dj=function(b){return c.se[b]};c.prototype.Qb=function(b){return 0!=(this.jb.read(b)&1)};c.prototype.Eo=function(b){if(this.Qb(b))return!0;var d=this.wa(b);b=this.Gc(b)-1;if(d>b)return!1;d=this.Aa(d);b=this.Aa(b);return d.ub(b)};c.prototype.et=function(b){return 0!=(this.jb.read(b)&2)};c.prototype.dc=function(b,d){this.om(b.description);if(322==b.G()){var c=
new f.Wa;if(d||this.u())b.Dp(c),this.Rf(c);b.Bp(c);this.lineTo(c)}else throw f.f.ya();};c.prototype.oq=function(b){var d=0==this.qa;this.Zx(b.o,b.A);this.Wj(b.o,b.B);this.Wj(b.v,b.B);this.Wj(b.v,b.A);this.sq();this.hh=!1;d&&this.lg(256,!1)};c.prototype.jd=function(b,d){if(!b.u()){for(var c=0==this.qa,l=new f.Wa(this.description),a=0;4>a;a++)b.ig(d?4-a-1:a,l),0==a?this.Rf(l):this.lineTo(l);this.sq();this.hh=!1;c&&!d&&this.lg(256,!1)}};c.prototype.add=function(b,d){for(var c=0;c<b.aa();c++)this.Ti(b,
c,!d)};c.prototype.Ti=function(b,d,c){this.Yf(-1,b,d,c)};c.prototype.Bl=function(b,d){this.qA(b,d)};c.prototype.As=function(b,d,c,l,a){a||0!=this.aa()||(a=!0);0>d&&(d=b.aa()-1);if(d>=b.aa()||0>c||0>l||l>b.dw(d))throw f.f.X("index out of bounds");if(0!=l){var h=b.Qb(d)&&c+l==b.dw(d);if(!h||1!=l){this.hh=!1;this.om(b.description);c=b.wa(d)+c+1;a&&(l++,c--);h&&l--;h=this.qa;this.zl(this.qa+l);this.tc();if(a){if(0==l)return;this.kb.add(this.qa);a=b.jb.read(d);a&=-5;this.$f&&(a|=1);this.jb.write(this.jb.size-
1,a);this.jb.add(0)}else this.kb.write(this.jb.size-1,this.qa);a=0;for(var q=this.description.Ea;a<q;a++){var e=this.description.zd(a),k=f.na.Xa(e),p=b.description.mg(e);0>p||null==b.xa[p]?this.xa[a].Qk(k*h,f.na.pe(e),l*k,k*h):this.xa[a].Rk(k*h,b.xa[p],k*c,l*k,!0,k,k*h)}if(this.jn())throw f.f.ya();if(b.et(d))throw f.f.ya();this.Dc(1993)}}};c.prototype.dK=function(){for(var b=0,d=this.aa();b<d;b++)this.AX(b)};c.prototype.AX=function(b){this.tc();if(b>=this.aa())throw f.f.F();var d=this.wa(b),c=this.Ka(b);
b=this.Qb(b)?1:0;for(var l=0,a=this.description.Ea;l<a;l++)if(null!=this.xa[l]){var v=f.na.Xa(this.description.Id(l));this.xa[l].Zd(v*(d+b),v*(c-b),v)}this.Dc(1993)};c.prototype.Qr=function(b){this.tc();var d=this.aa();0>b&&(b=d-1);if(b>=d)throw f.f.F();for(var c=this.wa(b),l=this.Ka(b),a=0,v=this.description.Ea;a<v;a++)if(null!=this.xa[a]){var e=f.na.Xa(this.description.Id(a));this.xa[a].Ek(e*c,e*l,e*this.qa)}for(c=b+1;c<=d;c++)a=this.kb.read(c),this.kb.write(c-1,a-l);if(null==this.jb)for(c=b+1;c<=
d;c++)b=this.jb.read(c),this.jb.write(c-1,b);this.kb.resize(d);this.jb.resize(d);this.qa-=l;this.lh-=l;this.Dc(1993)};c.prototype.Yf=function(b,d,c,l){if(d==this)throw f.f.F();if(c>=d.aa())throw f.f.F();var h=this.aa();if(b>h)throw f.f.F();0>b&&(b=h);0>c&&(c=d.aa()-1);this.hh=!1;this.om(d.description);d.tc();var a=d.wa(c),e=d.Ka(c),k=this.qa,p=d.Qb(c)&&!l?1:0;this.zl(this.qa+e);this.tc();for(var g=b<h?this.wa(b):k,n=0,u=this.description.Ea;n<u;n++){var z=this.description.Id(n),r=d.description.mg(z),
t=f.na.Xa(z);0<=r&&null!=d.xa[r]?(0!=p&&this.xa[n].Rk(g*t,d.xa[r],t*a,t,!0,t,t*k),this.xa[n].Rk((g+p)*t,d.xa[r],t*(a+p),t*(e-p),l,t,t*(k+p))):this.xa[n].Qk(g*t,f.na.pe(z),t*e,t*k)}this.kb.add(k+e);for(l=h;l>=b+1;l--)a=this.kb.read(l-1),this.kb.write(l,a+e);d.et(c);this.jb.add(0);for(l=h-1;l>=b+1;l--)h=this.jb.read(l),h&=-5,this.jb.write(l+1,h);h=d.BT().read(c);h&=-5;this.$f&&(h|=1);this.jb.write(b,h)};c.prototype.qA=function(b,d){var c=-1,l=this.aa();if(c>l)throw f.f.F();0>c&&(c=l);this.hh=!1;var a=
this.qa;if(null!=b){this.zl(this.qa+d);this.tc();for(var v=c<l?this.wa(c):a,e=0,k=this.description.Ea;e<k;e++){var p=this.description.Id(e);if(0==p){this.xa[e].Em(2*(v+d),2*(a-c),this.xa[e],2*v,!0,2);for(var p=this.Pa(p),g=v,n=0;n<d;n++,g++){var u=0+n;p.write(2*g,b[u].x);p.write(2*g+1,b[u].y)}}else g=f.na.Xa(p),this.xa[e].Qk(v*g,f.na.pe(p),g*d,g*a)}}else this.tc();this.kb.add(this.qa);for(a=l;a>=c+1;a--)v=this.kb.read(a-1),this.kb.write(a,v+d);this.jb.add(0);for(a=l-1;a>=c+1;a--)l=this.jb.read(a),
l&=-5,this.jb.write(a+1,l);this.$f&&this.jb.write(c,1)};c.prototype.DH=function(b,d,c){var h=-1;0>b&&(b=this.aa());if(b>this.aa()||h>this.Ka(b)||c>d.length)throw f.f.X("index out of bounds");if(0!=c){b==this.aa()&&(this.kb.add(this.qa),this.$f?this.jb.add(1):this.jb.add(0));0>h&&(h=this.Ka(b));this.tc();var a=this.qa;this.zl(this.qa+c);this.tc();for(var v=0,e=this.description.Ea;v<e;v++){var k=this.description.Id(v),p=f.na.Xa(k);this.xa[v].Em(p*(this.wa(b)+h+c),(a-this.wa(b)-h)*p,this.xa[v],p*(this.wa(b)+
h),!0,p);0==v?this.xa[v].js(p*(this.wa(b)+h),c,d,0,!0):this.xa[v].Zh(f.na.pe(k),(this.wa(b)+h)*p,c*p)}this.jn()&&(this.cf.Em(this.wa(b)+h+c,a-this.wa(b)-h,this.cf,this.wa(b)+h,!0,1),this.tj.Em(this.wa(b)+h+c,a-this.wa(b)-h,this.tj,this.wa(b)+h,!0,1),this.cf.Zh(1,this.wa(b)+h,c),this.tj.Zh(-1,this.wa(b)+h,c));b+=1;for(d=this.aa();b<=d;b++)this.kb.write(b,this.kb.read(b)+c)}};c.prototype.Zf=function(b,d,c){var h=this.aa();0>b&&(b=this.aa());if(b>=h||d>this.Ka(b))throw f.f.X("index out of bounds");b==
this.aa()&&(this.kb.add(this.qa),this.$f?this.jb.add(1):this.jb.add(0));0>d&&(d=this.Ka(b));var a=this.qa;this.zl(this.qa+1);this.tc();var v=this.wa(b);this.xa[0].eh(2*(v+d),c,2*a);c=1;for(var e=this.description.Ea;c<e;c++){var k=this.description.Id(c),p=f.na.Xa(k);this.xa[c].Qk(p*(v+d),f.na.pe(k),p,p*a)}for(b+=1;b<=h;b++)this.kb.write(b,this.kb.read(b)+1)};c.prototype.bC=function(b,d){var c=this.aa();0>b&&(b=c-1);if(b>=c||d>=this.Ka(b))throw f.f.X("index out of bounds");this.tc();var l=this.wa(b);
0>d&&(d=this.Ka(b)-1);l+=d;d=0;for(var a=this.description.Ea;d<a;d++)if(null!=this.xa[d]){var v=f.na.Xa(this.description.Id(d));this.xa[d].Ek(v*l,v,v*this.qa)}for(;c>=b+1;c--)l=this.kb.read(c),this.kb.write(c,l-1);this.qa--;this.lh--;this.Dc(1993)};c.prototype.DF=function(b,d,c,l){b=this.wa(b)+d;c=this.wa(c)+l;if(c<b||0>b||c>this.D()-1)throw f.f.F();l=this.Da();d=0;l.Tb(b);do{for(;l.Ca();){b=l.ba();if(l.Db()==c)break;b=b.Rb();d+=b}if(l.Db()==c)break}while(l.Ya());return d};c.prototype.eQ=function(b,
d,c){d=this.wa(b)+d;c=this.wa(b)+c;if(0>d||c>this.D()-1)throw f.f.F();var h=this.Da();if(d>c){if(!this.Qb(b))throw f.f.F("cannot iterate across an open path");h.iC()}var a=b=0;h.Tb(d);do a+=b,b=h.ba().Rb();while(h.Db()!=c);return a};c.prototype.Gg=function(){return f.Pi.Sm(this,null)};c.prototype.EU=function(b,d,c,l){for(var h=b;h<c-1;h++)if(this.Qb(h))throw f.f.F("cannot interpolate across closed paths");h=this.description.Ea;if(1!=h){var a=this.DF(b,d,c,l);if(0!=a)for(var e=1;e<h;e++){var k=this.description.zd(e);
if(2!=f.na.Vz(k))for(var p=f.na.Xa(k),g=0;g<p;g++)this.GU(k,b,d,c,l,a,g)}}};c.prototype.DU=function(b,d,c){var h=this.description.Ea;if(1!=h){var a=this.eQ(b,d,c);if(0!=a)for(var v=1;v<h;v++){var e=this.description.zd(v);if(2!=f.na.Vz(e))for(var k=f.na.Xa(e),p=0;p<k;p++)this.FU(e,b,d,c,a,p)}}};c.prototype.GU=function(b,d,c,l,a,v,e){var h=this.Da();d=this.wa(d)+c;l=this.wa(l)+a;a=this.Yc(b,d,e);c=this.Yc(b,l,e);var q=a,k=0;h.Tb(d);do if(h.Ca()){h.ba();if(h.Db()==l)break;this.setAttribute(b,h.Db(),
e,q);h.Li();do{d=h.ba();if(h.Ik()==l)return;d=d.Rb();k+=d;q=f.Ub.Wq(a,c,k/v);h.Fo()||this.setAttribute(b,h.Ik(),e,q)}while(h.Ca())}while(h.Ya())};c.prototype.FU=function(b,d,c,l,a,v){var h=this.Da(),q=this.wa(d)+c;d=this.wa(d)+l;if(d!=q){l=this.Yc(b,q,v);c=this.Yc(b,d,v);var e=0;h.Tb(q);h.iC();q=l;do{var k=h.ba();this.setAttribute(b,h.Db(),v,q);q=k.Rb();e+=q;q=f.Ub.Wq(l,c,e/a)}while(h.Ik()!=d)}};c.prototype.Oa=function(){this.hr=0;this.hh=!1;this.Xd=this.cf=this.tj=this.jb=this.kb=null;this.LE()};
c.prototype.Xc=function(b){b instanceof f.Hd?this.jF(b,-1):this.xP(b)};c.prototype.jF=function(b,d){if(!this.u()&&!b.Ho()){this.tc();var c=this.xa[0],l=new f.b,a=new f.b,v,e,k;for(0>d?(v=this.jn(),e=0,k=this.qa):(v=this.et(d),e=this.wa(d),k=this.Gc(d));e<k;e++){l.x=c.read(2*e);l.y=c.read(2*e+1);if(v&&(d=this.tj.read(e),0<=d))switch(this.cf.read(e)&7){case 2:a.x=this.Xd.read(d);a.y=this.Xd.read(d+1);b.$h(a,a);this.Xd.write(d,a.x);this.Xd.write(d+1,a.y);a.x=this.Xd.read(d+3);a.y=this.Xd.read(d+4);b.$h(a,
a);this.Xd.write(d+3,a.x);this.Xd.write(d+4,a.y);break;case 4:throw f.f.ya();}b.$h(l,l);c.write(2*e,l.x);c.write(2*e+1,l.y)}this.Dc(1993)}};c.prototype.xP=function(b){if(!this.u()){this.Ud(1);this.tc();for(var d=this.xa[0],c=this.xa[1],l=new f.qd,a=new f.qd,v=this.jn(),e=0;e<this.qa;e++){l.x=d.read(2*e);l.y=d.read(2*e+1);l.z=c.read(e);if(v){var k=this.tj.read(e);if(0<=k)switch(this.cf.read(e)&7){case 2:a.x=this.Xd.read(k);a.y=this.Xd.read(k+1);a.z=this.Xd.read(k+2);a=b.Rp(a);this.Xd.write(k,a.x);
this.Xd.write(k+1,a.y);this.Xd.write(k+1,a.z);a.x=this.Xd.read(k+3);a.y=this.Xd.read(k+4);a.z=this.Xd.read(k+5);a=b.Rp(a);this.Xd.write(k+3,a.x);this.Xd.write(k+4,a.y);this.Xd.write(k+5,a.z);break;case 4:throw f.f.ya();}}l=b.Rp(l);d.write(2*e,l.x);d.write(2*e+1,l.y);c.write(e,l.z)}this.Dc(1993)}};c.prototype.Oy=function(){null==this.kb&&(this.kb=f.Uc.wh(1,0),this.jb=f.Uc.vq(1,0));null!=this.cf&&(this.cf.resize(this.lh,1),this.tj.resize(this.lh,-1))};c.prototype.iq=function(b){b.hh=!1;b.hr=this.hr;
b.lr=this.lr;null!=this.kb?b.kb=f.ia.Ak(this.kb):b.kb=null;null!=this.jb?b.jb=f.Gm.Ak(this.jb):b.jb=null;null!=this.tj?b.tj=f.ia.Ak(this.tj):b.tj=null;null!=this.cf?b.cf=f.Gm.Ak(this.cf):b.cf=null;null!=this.Xd?b.Xd=f.Sd.Ak(this.Xd):b.Xd=null;b.gr=this.gr;b.fr=this.fr;this.xk(1024)?b.bj=null:b.bj=this.bj};c.prototype.Rb=function(){if(!this.xk(512))return this.gr;for(var b=this.Da(),d=new f.qy(0);b.Ya();)for(;b.Ca();)d.add(b.ba().Rb());this.gr=d.fn();this.lg(512,!1);return d.fn()};c.prototype.Eb=function(b){if(b==
this)return!0;if(!(b instanceof c&&a.prototype.Eb.call(this,b)))return!1;var d=this.aa();return d!=b.aa()||null!=this.kb&&!this.kb.Eb(b.kb,0,d+1)||this.lr!=b.lr||null!=this.jb&&!this.jb.Eb(b.jb,0,d)?!1:a.prototype.Eb.call(this,b)};c.prototype.Da=function(){return new f.XN(this)};c.prototype.Ny=function(b){a.prototype.Ny.call(this,b);if(this.jn())for(b=this.Da();b.Ya();)for(;b.Ca();)break};c.prototype.uo=function(b,d){a.prototype.uo.call(this,b,d);if(this.jn())for(b=this.Da();b.Ya();)for(;b.Ca();)break};
c.prototype.Hy=function(){null==this.kb||0==this.kb.size?this.qa=0:this.qa=this.kb.read(this.kb.size-1)};c.prototype.hf=function(){if(!this.$f)return 0;this.fv();return this.fr};c.prototype.qw=function(b){if(!this.$f)return!1;if(!this.xk(8))return 0!=(this.jb.read(b)&4);this.fv();return 0<this.bj.read(b)};c.prototype.Tm=function(b){if(!this.$f)return 0;this.fv();return this.bj.read(b)};c.prototype.fv=function(){if(this.xk(1024)){var b=this.aa();null==this.bj?this.bj=new f.Sd(b):this.bj.size!=b&&this.bj.resize(b);
for(var b=new f.qy(0),d=new f.qy(0),c=new f.b,l=0,a=this.Da();a.Ya();){d.reset();for(this.w(this.wa(a.Ta),c);a.Ca();)d.add(a.ba().By(c.x,c.y));b.add(d.fn());var v=l++;this.bj.write(v,d.fn())}this.fr=b.fn();this.lg(1024,!1)}};c.prototype.xT=function(){if(this.$f){this.Al();for(var b=0,d=this.aa(),c=0;c<d;c++)0!=(this.jb.read(c)&4)&&b++}};c.prototype.Al=function(){if(this.xk(8)){this.fv();var b=this.aa();if(null==this.jb||this.jb.size<b)this.jb=f.Uc.vq(b+1);for(var d=1,c=0;c<b;c++){var l=this.bj.read(c);
0==c&&(d=0<l?1:-1);0<l*d?this.jb.hC(c,4):this.jb.ez(c,4)}this.lg(8,!1)}};c.prototype.bw=function(b){var d=this.Ta,c=this.aa();if(0<=d&&d<c){if(b<this.Gc(d)){if(b>=this.wa(d))return d;d--}else d++;if(0<=d&&d<c&&b>=this.wa(d)&&b<this.Gc(d))return this.Ta=d}if(5>c){for(d=0;d<c;d++)if(b<this.Gc(d))return this.Ta=d;throw f.f.X("corrupted geometry");}d=0;for(--c;c>d;){var l=d+(c-d>>1),a=this.wa(l);if(b<a)c=l-1;else if(d=this.Gc(l),b>=d)d=l+1;else return this.Ta=l}return this.Ta=d};c.prototype.lT=function(b){var d=
this.Pa(0);this.CT();var c=this.Gc(b),l=this.wa(b);b=-1;var a=new f.b,v=new f.b;a.y=-Infinity;a.x=-Infinity;for(l+=0;l<c;l++)d.fc(2*l,v),-1==a.compare(v)&&(b=l,a.L(v));return b};c.prototype.hA=function(){var b=this.D();if(!this.$f)for(var b=b-this.aa(),d=0,c=this.aa();d<c;d++)this.Qb(d)&&b++;return b};c.prototype.dw=function(b){var d=this.Ka(b);this.Qb(b)||d--;return d};c.prototype.Ja=function(){return new c(this.$f,this.description)};c.prototype.tb=function(){return this.$f?2:1};c.prototype.G=function(){return this.$f?
1736:1607};c.prototype.CT=function(){this.Bu()};c.prototype.GK=function(b){this.kb=b;this.Dc(16777215)};c.prototype.NT=function(){this.Bu();return this.cf};c.prototype.BT=function(){this.Bu();return this.jb};c.prototype.FK=function(b){this.jb=b;this.Dc(16777215)};c.prototype.aa=function(){return null!=this.kb?this.kb.size-1:0};c.prototype.Gc=function(b){return this.kb.read(b+1)};c.prototype.Ka=function(b){return this.kb.read(b+1)-this.kb.read(b)};c.prototype.wa=function(b){return this.kb.read(b)};
c.prototype.Wu=function(b,d){null==this.ob&&(this.ob=new f.wl);d=f.wy.jX(d);var c=this.ob.Hi;if(null!=c)if(c.jl<b||d>c.JT())this.ob.Ly(null);else return!0;c=f.wy.create(this,b,d);this.ob.Ly(c);return!0};c.prototype.jc=function(){var b=a.prototype.jc.call(this);if(!this.Hc()){var d=this.aa();null!=this.kb&&this.kb.zk(b,0,d+1);null!=this.jb&&this.jb.zk(b,0,d)}return b};c.prototype.iH=function(b){return null!=this.cf?this.cf.read(b):1};c.prototype.ic=function(b,d,c){var h=this.bw(b);if(b==this.Gc(h)-
1&&!this.Qb(h))throw f.f.X("index out of bounds");this.tc();var a=this.cf,v=1;null!=a&&(v=a.read(b)&7);switch(v){case 1:d.Is();break;case 2:throw f.f.ya();case 4:throw f.f.ya();default:throw f.f.ya();}d=d.get();c?d.Fg(f.ye.Ig()):d.Fg(this.description);h=b==this.Gc(h)-1&&this.Qb(h)?this.wa(h):b+1;a=new f.b;this.w(b,a);d.Mc(a);this.w(h,a);d.Zc(a);if(!c)for(c=1,a=this.description.Ea;c<a;c++)for(var v=this.description.Id(c),e=f.na.Xa(v),k=0;k<e;k++){var p=this.Yc(v,b,k);d.Sx(v,k,p);p=this.Yc(v,h,k);d.Kx(v,
k,p)}};c.prototype.ik=function(b,d){if(b>=this.aa())throw f.f.F();if(this.u())d.Oa();else{if(this.et(b))throw f.f.X("not implemented");var c=this.Pa(0),l=new f.b,a=new f.h;a.Oa();var v=this.wa(b);for(b=this.Gc(b);v<b;v++)c.fc(2*v,l),a.Nb(l);d.I(a)}};c.prototype.gX=function(b,d){if(b>=this.aa())throw f.f.F();if(this.u())d.Oa();else{if(this.et(b))throw f.f.X("not implemented");var c=this.Pa(0),l=new f.b,a=new f.h;a.Oa();var v=this.wa(b);for(b=this.Gc(b);v<b;v++)c.fc(2*v,l),a.Nb(l);d.I(a)}};c.prototype.Hj=
function(b){null==this.ob&&(this.ob=new f.wl);if(0==b||16>this.D())return!1;b=f.ma.zF(this);this.ob.ME(b);return!0};c.prototype.AO=function(){null==this.ob&&(this.ob=new f.wl);if(null!=this.ob.np)return!0;this.ob.NE(null);var b=f.ma.$P(this);this.ob.NE(b);return!0};c.prototype.Hp=function(b){this.lr=b};c.prototype.xo=function(){return this.lr};c.prototype.TE=function(b){if(this==b)throw f.f.X("MultiPathImpl.add");for(var d=this.aa(),c=0;c<b.aa();c++)this.Ti(b,c,!0),this.mW(d),d++};c.prototype.mQ=
function(b){var d=this.bw(b),c=this.wa(d);if(c!=b){d=this.Gc(d);if(b>=d||b<c)throw f.f.X("change_ring_start_point");for(var l=0,a=this.description.Ea;l<a;l++){var v=this.description.zd(l),v=f.na.Xa(v);this.xa[l].rotate(c*v,b*v,d*v)}}};c.se=[0,0,6,0,8,0];return c}(f.Lu);f.xl=a})(C||(C={}));(function(f){var a=function(a){function c(b){a.call(this);if(void 0!==b){if(null==b)throw f.f.F();this.description=b}else this.description=f.ye.Ig();this.qa=0}N(c,a);c.prototype.Ja=function(){return new c(this.description)};
c.prototype.add=function(b){this.resize(this.qa+1);this.Yh(this.qa-1,b)};c.prototype.kv=function(b,d){this.resize(this.qa+1);var c=new f.b;c.ka(b,d);this.rb(this.qa-1,c)};c.prototype.Jd=function(b,d,c){c=0>c?b.D():c;if(0>d||d>b.D()||c<d)throw f.f.F();if(d!=c){this.om(b.description);c-=d;var h=this.qa;this.resize(this.qa+c);this.tc();for(var a=0,v=b.description.Ea;a<v;a++){var e=b.description.Id(a),k=f.na.Xa(e),p=this.Pa(e),e=b.Pa(e);p.Rk(h*k,e,d*k,c*k,!0,1,h*k)}}};c.prototype.XE=function(b,d){var c=
b.length;d=0>d?c:d;if(0>c||0>d)throw f.f.F();if(0!=d){c=d-0;d=this.qa;this.resize(this.qa+c);for(var l=0;l<c;l++)this.rb(d+l,b[0+l])}};c.prototype.bC=function(b){if(0>b||b>=this.D())throw f.f.X("index out of bounds");this.tc();for(var d=0,c=this.description.Ea;d<c;d++)if(null!=this.xa[d]){var l=f.na.Xa(this.description.Id(d));this.xa[d].Ek(l*b,l,l*this.qa)}this.qa--;this.lh--;this.Dc(1993)};c.prototype.resize=function(b){this.zl(b)};c.prototype.iq=function(){};c.prototype.Oa=function(){a.prototype.LE.call(this)};
c.prototype.Xc=function(b){if(b instanceof f.Hd){if(!this.u()){this.tc();for(var d=this.xa[0],c=new f.b,l=0;l<this.qa;l++)c.x=d.read(2*l),c.y=d.read(2*l+1),b.$h(c,c),d.write(2*l,c.x),d.write(2*l+1,c.y);this.Dc(1993)}}else if(!this.u()){this.tc();this.Ud(1);this.tc();for(var d=this.xa[0],c=this.xa[1],a=new f.qd,l=0;l<this.qa;l++){a.x=d.read(2*l);a.y=d.read(2*l+1);a.z=c.read(l);var v=b.Rp(a);d.write(2*l,v.x);d.write(2*l+1,v.y);c.write(l,v.z)}this.Dc(1993)}};c.prototype.tb=function(){return 0};c.prototype.G=
function(){return 550};c.prototype.hf=function(){return 0};c.prototype.Rb=function(){return 0};c.prototype.Eb=function(b){return b==this?!0:b instanceof c?a.prototype.Eb.call(this,b):!1};c.prototype.lP=function(b){var d=b.length,c=d;if(0>d||0>d||0>c)throw f.f.F();this.Ud(1);if(0!=c){d=c-0;c=this.qa;this.$J(this.qa+d);for(var l=this.Pa(0),a=0;a<d;a++){var v=b[0+a].y;l.write(2*(c+a),b[0+a].x);l.write(2*(c+a)+1,v)}l=this.Pa(1);for(a=0;a<d;a++)l.write(c+a,b[0+a].z);this.Dc(1993)}};c.prototype.mP=function(b,
d){var c=b.length;d=0>d?c:d;if(0>c||0>d)throw f.f.F();if(0!=d){c=d-0;if(0!=(c&1))throw f.f.F();d=this.qa;this.$J(this.qa+c/2);this.xa[0].hs(2*d,c,b,0,!0)}};c.prototype.$J=function(b){var d=this.qa;this.zl(b);if(this.qa>d){b=1;for(var c=this.description.Ea;b<c;b++){var l=this.description.zd(b),a=f.na.Xa(l);this.xa[b].Qk(a*d,f.na.pe(l),a*(this.qa-d),a*d)}}};c.prototype.dX=function(b,d){var c=this.qa,c=Math.min(c,d+1E3);if(0>d||d>=this.qa||c<d||1E3!=b.length)throw f.f.F();var l=this.Pa(0),a=c-d,v=[];
l.pl(2*d,2*a,v,0,!0);for(l=0;l<a;l++)b[l]=f.b.pa(v[2*l],v[2*l+1]);return c};c.prototype.eX=function(b,d){var c=this.qa,c=Math.min(c,0+d);if(0>=this.qa||0>c||b.length!=d)throw f.f.F();d=this.Pa(0);var l=null,a=f.na.pe(1),v=this.hasAttribute(1);v&&(l=this.Pa(1));var c=c-0,e=[],k=[];d.pl(0,2*c,e,0,!0);l.pl(0,c,k,0,!0);for(d=0;d<c;d++)b[d]=new f.qd(e[2*d],e[2*d+1],v?k[d]:a)};c.prototype.Hy=function(){};c.prototype.Oy=function(){};c.prototype.Wu=function(){return!1};c.prototype.Hj=function(){return!1};
c.prototype.Gg=function(){return null};return c}(f.Lu);f.Ed=a})(C||(C={}));(function(f){(function(f){f[f.NotDetermined=0]="NotDetermined";f[f.Structure=1]="Structure";f[f.DegenerateSegments=2]="DegenerateSegments";f[f.Clustering=3]="Clustering";f[f.Cracking=4]="Cracking";f[f.CrossOver=5]="CrossOver";f[f.RingOrientation=6]="RingOrientation";f[f.RingOrder=7]="RingOrder";f[f.OGCPolylineSelfTangency=8]="OGCPolylineSelfTangency";f[f.OGCPolygonSelfTangency=9]="OGCPolygonSelfTangency";f[f.OGCDisconnectedInterior=
10]="OGCDisconnectedInterior"})(f.WM||(f.WM={}));var a=function(){function f(c,b,d){void 0===c?(this.Ii=0,this.mm=this.lm=-1):(this.Ii=c,this.lm=b,this.mm=d)}f.prototype.ls=function(c){this.Ii=c.Ii;this.lm=c.lm;this.mm=c.mm};return f}();f.$d=a})(C||(C={}));(function(f){var a=function(){function a(){}a.XZ=function(c){if(!1===c)throw f.f.IL();};a.RK=function(c){return isNaN(c)?NaN:0===c?c:0<c?1:-1};a.pv=function(c){var b;void 0===b&&(b=0);for(var d=[],h=0;h<c;h++)d[h]=a.gf(2,b);return d};a.gf=function(c,
b){void 0===b&&(b=0);for(var d=[],h=0;h<c;h++)d[h]=b;return d};a.Mv=function(c,b){var d,h;void 0===d&&(d=0);for(void 0===h&&(h=c.length-1);d<=h;d++)c[d]=b};a.nk=function(c,b,d){return c<b?b:c>d?d:c};a.s_=function(){return 4};a.dh=function(c,b){var d=5381;void 0!==b?d=(b<<5)+b+(c&255):d=(d<<5)+d+(c&255);d=(d<<5)+d+(c>>8&255);d=(d<<5)+d+(c>>16&255);return(d<<5)+d+(c>>24&255)&2147483647};a.Zi=function(){throw Error("Not Implemented");};a.o_=function(){return-Infinity};a.q_=function(){return Infinity};
a.g_=function(){return 2147483647};a.TZ=function(){return 2.220446049250313E-16};a.UZ=function(){return 1.7976931348623157E308};a.GB=function(c){return a.cZ(c)+12345&2147483647};a.fI=function(c){var b=32,d=c%a.oA|0,h=c/a.oA|0;if(0===(b&=63))return c;32>b?(c=d>>>b|h<<32-b,b=h>>b):(c=h>>b-32,b=0<=h?0:-1);return b*a.oA+(c>>>0)};a.cZ=function(c){c|=0;return(1103495168*c|0)+(20077*c|0)|0};a.truncate=function(c){return 0>c?-1*Math.floor(Math.abs(c)):Math.floor(c)};a.fV=Math.pow(2,53)-1;a.WZ=-a.fV;a.hD=
65536;a.J_=16777216;a.oA=a.hD*a.hD;return a}();f.J=a})(C||(C={}));(function(f){(function(f){f[f.Project=0]="Project";f[f.Union=1]="Union";f[f.Difference=2]="Difference";f[f.Proximity2D=3]="Proximity2D";f[f.Relate=4]="Relate";f[f.Equals=5]="Equals";f[f.Disjoint=6]="Disjoint";f[f.Intersects=7]="Intersects";f[f.Within=8]="Within";f[f.Contains=9]="Contains";f[f.Crosses=10]="Crosses";f[f.Touches=11]="Touches";f[f.Overlaps=12]="Overlaps";f[f.Buffer=13]="Buffer";f[f.Distance=14]="Distance";f[f.Intersection=
15]="Intersection";f[f.Clip=16]="Clip";f[f.Cut=17]="Cut";f[f.DensifyByLength=18]="DensifyByLength";f[f.DensifyByAngle=19]="DensifyByAngle";f[f.LabelPoint=20]="LabelPoint";f[f.GeodesicBuffer=21]="GeodesicBuffer";f[f.GeodeticDensifyByLength=22]="GeodeticDensifyByLength";f[f.ShapePreservingDensify=23]="ShapePreservingDensify";f[f.GeodeticLength=24]="GeodeticLength";f[f.GeodeticArea=25]="GeodeticArea";f[f.Simplify=26]="Simplify";f[f.SimplifyOGC=27]="SimplifyOGC";f[f.Offset=28]="Offset";f[f.Generalize=
29]="Generalize";f[f.SymmetricDifference=30]="SymmetricDifference";f[f.ConvexHull=31]="ConvexHull";f[f.Boundary=32]="Boundary";f[f.SimpleRelation=33]="SimpleRelation"})(f.rN||(f.rN={}));var a=function(){function a(){}a.prototype.G=function(){return null};a.prototype.qo=function(){return!1};a.prototype.vv=function(){return!1};a.MZ=function(c){f.T.gh(c.G())&&(c=c.ob,null!=c&&(c.Ly(null),c.ME(null)))};return a}();f.ef=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}
N(c,a);c.prototype.G=function(){return 13};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c,l,a){return b instanceof f.T?(a=new f.hd(b),this.V(a,d,[c],!1,l).next()):!0===l?(c=new f.CD(b,d,c,!1,a),f.ei.local().V(c,d,a)):new f.CD(b,d,c,!1,a)};c.$=null;return c}(f.ef);f.BD=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h,l){this.Ba=-1;this.he=c;this.HA=b;this.xt=d;this.sV=new f.h;this.sV.Oa();this.To=-1;this.lc=l}a.prototype.next=function(){for(var c;null!=
(c=this.he.next());)return this.Ba=this.he.Ha(),this.To+1<this.xt.length&&this.To++,this.buffer(c,this.xt[this.To]);return null};a.prototype.Ha=function(){return this.Ba};a.prototype.buffer=function(c,b){return f.OL.buffer(c,b,this.HA,NaN,96,this.lc)};a.prototype.Re=function(){return!0};return a}();f.CD=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 16};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,
d,c,l){return b instanceof f.T?(b=new f.hd(b),this.V(b,d,c,l).next()):new f.bN(b,d,c,l)};c.$=null;return c}(f.ef);f.aN=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d){this.Ba=-1;if(null==c)throw f.f.F();this.R=b;this.$k=c;this.ta=f.ma.be(d,b,!1)}a.prototype.next=function(){var c;return null!=(c=this.$k.next())?(this.Ba=this.$k.Ha(),f.me.clip(c,this.R,this.ta,0)):null};a.prototype.Ha=function(){return this.Ba};a.prototype.Re=function(){return!0};return a}();f.bN=a})(C||(C={}));(function(f){var a=
function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 31};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c){return b instanceof f.T?f.ED.CF(b):new f.ED(d,b,c)};c.$=null;return c}(f.ef);f.DD=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d){this.$A=new f.Iu;this.Ba=-1;if(null==b)throw f.f.F();this.nI=c;this.Pc=!1;this.$k=b;this.lc=d}a.prototype.next=function(){if(this.nI){if(!this.Pc){var c=this.dQ(this.$k);this.Pc=!0;
return c}return null}if(!this.Pc){c=this.$k.next();if(null!=c)return this.Ba=this.$k.Ha(),a.CF(c);this.Pc=!0}return null};a.prototype.Ha=function(){return this.Ba};a.prototype.dQ=function(c){for(var b;null!=(b=c.next());)this.$A.Jb(b);return this.$A.TS()};a.prototype.Re=function(){if(this.Pc)return!0;if(!this.nI)throw f.f.X("Invalid call for non merging convex hull.");var c=this.$k.next();if(null!=c)return this.$A.Jb(c),!0;throw f.f.X("Expects a non-null geometry.");};a.CF=function(c){if(a.Wg(c))return c;
var b=c.G();if(f.xl.Oc(b))return b=new f.Ua(c.description),b.dc(c,!0),b;if(550==b&&2==c.D()){var d=new f.Wa,b=new f.Ua(c.description);c.Ae(0,d);b.Rf(d);c.Ae(1,d);b.lineTo(d);return b}return f.Iu.TQ(c)};a.Wg=function(c){if(c.u())return!0;var b=c.G();return 33==b||197==b?!0:f.xl.Oc(b)?!1:550==b?1==c.D()?!0:!1:1607==b?1==c.aa()&&2>=c.D()?!0:!1:1!=c.aa()?!1:2>=c.D()?!0:f.Iu.UH(c,0)};return a}();f.ED=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=
function(){return 17};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c,l,a){return new f.dN(b,d,c,l,a)};c.$=null;return c}(f.ef);f.cN=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h,l){this.qg=null;if(null==b||null==d)throw f.f.X("invalid argument");this.pV=c;this.UA=b;this.wI=d;c=f.ma.Yv(b,d);this.ta=f.ma.be(h,c,!0);this.vI=-1;this.je=l}a.prototype.Ha=function(){return 0};a.prototype.next=function(){this.GS();return++this.vI<this.qg.length?this.qg[this.vI]:
null};a.prototype.GS=function(){if(null==this.qg)switch(this.qg=[],this.UA.G()){case 1607:this.IS();break;case 1736:this.HS()}};a.prototype.IS=function(){var c=new f.Ua,b=new f.Ua,d=new f.Ua;this.qg.push(c);this.qg.push(b);var h=[];f.VL.TL(this.pV,this.UA,this.wI,this.ta,h,this.je);for(var l=0;l<h.length;l++){var a=h[l];0==a.mx?c.add(a.Y,!1):1==a.mx||2==a.mx?b.add(a.Y,!1):3==a.mx?this.qg.push(a.Y):d.add(a.Y,!1)}d.u()||c.u()&&b.u()&&!(3<=this.qg.length)||this.qg.push(d);c.u()&&b.u()&&3>this.qg.length&&
(this.qg.length=0)};a.prototype.HS=function(){var c=new f.ia(0),b=new f.fd,d=b.gG(),h=b.Jb(this.UA),l=b.Jb(this.wI),a=new f.Dg;try{a.Wr(b,this.ta,this.je);a.Hl(d,h,l,c);var v=b.Se(h),e=new f.Ia,k=new f.Ia;this.qg.length=0;this.qg.push(e);this.qg.push(k);for(h=0;h<c.size;h++){var p,g=new f.fd,n=g.Jb(v),u=g.Jb(b.Se(c.get(h)));a.Vr(g,this.je);var z=a.mw(n,u);p=g.Se(z);if(!p.u()){var r=b.UG(c.get(h),d);2==r?e.add(p,!1):1==r?k.add(p,!1):this.qg.push(p);var t=new f.fd,n=t.Jb(v),u=t.Jb(b.Se(c.get(h)));a.Vr(t,
this.je);v=t.Se(a.Wm(n,u))}}!v.u()&&0<c.size&&this.qg.push(v);e.u()&&k.u()&&(this.qg.length=0)}finally{a.qh()}};a.prototype.Re=function(){return!0};return a}();f.dN=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 18};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c){if(b instanceof f.T)return b=new f.hd(b),this.V(b,d,c).next();if(0>=d)throw f.f.F();return new f.eN(b,d,c)};c.$=null;return c}(f.ef);
f.Km=a})(C||(C={}));(function(f){var a=function(){function a(c,b){this.Ba=-1;this.he=c;this.Jt=b}a.prototype.Ha=function(){return this.Ba};a.prototype.next=function(){var c;return null!=(c=this.he.next())?(this.Ba=this.he.Ha(),this.IR(c)):null};a.prototype.IR=function(c){if(c.u()||1>c.tb())return c;var b=c.G();if(1736==b||1607==b)return this.vz(c);if(f.T.Oc(b))return this.KR(c);if(197==b)return this.JR(c);throw f.f.ya();};a.prototype.KR=function(c){if(c.Rb()<=this.Jt)return c;var b=new f.Ua(c.description);
b.dc(c,!0);return this.vz(b)};a.prototype.JR=function(c){var b=new f.Ia(c.description);b.jd(c,!1);var d=new f.h;c.s(d);c=d.fa();return d.N()<=this.Jt&&c<=this.Jt?b:this.vz(b)};a.prototype.vz=function(c){for(var b=c.Ja(),d=c.Da();d.Ya();)for(var h=!0;d.Ca();){var l=d.ba();if(322!=l.G())throw f.f.X("not implemented");var a=d.Fo(),v=l.Rb();if(v>this.Jt){var e=Math.ceil(v/this.Jt),v=new f.Wa(c.description);h&&(l.Dp(v),b.Rf(v));for(var k=h=1/e,p=0,e=e-1;p<e;p++)l.Ex(k,v),b.lineTo(v),k+=h;a?b.sq():(l.Bp(v),
b.lineTo(v))}else a?b.sq():b.dc(l,h);h=!1}return b};a.prototype.Re=function(){return!0};return a}();f.eN=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.G=function(){return 2};c.prototype.V=function(b,d,c,l){return b instanceof f.T?(b=new f.hd(b),d=new f.hd(d),this.V(b,d,c,l).next()):new f.fN(b,d,c,l)};c.Wm=function(b,d,h,l){if(b.u()||d.u())return b;var a=b.tb(),v=d.tb();if(a>v)return b;var e=
b.G(),k=d.G(),p=new f.h,g=new f.h,n=new f.h;b.s(p);d.s(g);n.I(p);n.Nb(g);var n=f.ma.be(h,n,!1),u=n*Math.sqrt(2)*1.00001,z=new f.h;z.I(p);z.O(u,u);if(!z.Yb(g))return b;if(1==a&&2==v)return c.RL(b,d,k,h,l);if(33==e)switch(f.xl.Oc(k)?(h=new f.Ua(d.description),h.dc(d,!0)):h=d,k){case 1736:return c.fO(b,h,n);case 1607:return c.jO(b,h,n);case 550:return c.UN(b,h,n);case 197:return c.ON(b,h,n);case 33:return c.bO(b,h,n);default:throw f.f.F();}else if(550==e)switch(k){case 1736:return c.BM(b,d,n);case 197:return c.lM(b,
d,n);case 33:return c.wM(b,d,n)}return f.Dg.Wm(b,d,h,l)};c.fO=function(b,d,c){return 0==f.gd.VH(d,b,c)?b:b.Ja()};c.jO=function(b,d,c){var h=b.w();d=d.Da();for(var a=c*Math.sqrt(2)*1.00001,v=a*a,e=new f.h;d.Ya();)for(;d.Ca();){var k=d.ba();k.s(e);e.O(a,a);if(e.contains(h)){if(k.lt(h,c))return b.Ja();var p=k.ec();if(f.b.sc(h,p)<=v)return b.Ja();p=k.Cc();if(f.b.sc(h,p)<=v)return b.Ja()}}return b};c.UN=function(b,d,c){var h=d.Pa(0);d=d.D();var a=b.w(),v=new f.b;c=c*Math.sqrt(2)*1.00001;c*=c;for(var e=
0;e<d;e++)if(h.fc(2*e,v),f.b.sc(v,a)<=c)return b.Ja();return b};c.ON=function(b,d,c){var h=new f.h;d.s(h);h.O(c,c);d=b.w();return h.contains(d)?b.Ja():b};c.bO=function(b,d,c){c=c*Math.sqrt(2)*1.00001;c*=c;var h=b.w();d=d.w();return f.b.sc(h,d)<=c?b.Ja():b};c.BM=function(b,d,c){var h=new f.h;d.s(h);h.O(c,c);for(var a=b.D(),v=!1,e=[],k=0;k<a;k++)e[k]=!1;for(var p=new f.b,k=0;k<a;k++)b.w(k,p),h.contains(p)&&0!=f.gd.fe(d,p,c)&&(v=!0,e[k]=!0);if(!v)return b;d=b.Ja();for(k=0;k<a;k++)e[k]||d.Jd(b,k,k+1);
return d};c.lM=function(b,d,c){var h=new f.h;d.s(h);h.O(c,c);d=b.D();var a=!1;c=[];for(var v=0;v<d;v++)c[v]=!1;for(var e=new f.b,v=0;v<d;v++)b.w(v,e),h.contains(e)&&(a=!0,c[v]=!0);if(!a)return b;h=b.Ja();for(v=0;v<d;v++)c[v]||h.Jd(b,v,v+1);return h};c.wM=function(b,d,c){var h=b.Pa(0),a=b.D(),v=d.w(),e=new f.b,k=!1;d=[];for(var p=0;p<a;p++)d[p]=!1;p=c*Math.sqrt(2)*1.00001;c=p*p;for(p=0;p<a;p++)h.fc(2*p,e),f.b.sc(e,v)<=c&&(k=!0,d[p]=!0);if(!k)return b;h=b.Ja();for(p=0;p<a;p++)d[p]||h.Jd(b,p,p+1);return h};
c.RL=function(b,d,c,l,a){var h=new f.ci;b.Rn(h);var q=new f.h;d.s(q);h.Nb(q);h.O(.1*h.N(),.1*h.fa());q=new f.Ia;q.jd(h,!1);1736==c?q.add(d,!0):q.jd(d,!0);return f.sk.local().V(b,q,l,a)};c.$=null;return c}(f.ef);f.cq=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h){this.nt=null==b;this.Ba=-1;this.he=c;this.HA=d;this.vV=b.next();this.lc=h}a.prototype.next=function(){if(this.nt)return null;var c;return null!=(c=this.he.next())?(this.Ba=this.he.Ha(),f.cq.Wm(c,this.vV,this.HA,this.lc)):
null};a.prototype.Ha=function(){return this.Ba};a.prototype.Re=function(){return!0};return a}();f.fN=a})(C||(C={}));(function(f){var a=function(){function c(b){this.je=b;this.Yj=new f.h;this.Yj.Oa();this.Jh=new f.h;this.Jh.Oa()}c.prototype.Au=function(){var b;b=this.Yj.o;this.Yj.o=this.Jh.o;this.Jh.o=b;b=this.Yj.v;this.Yj.v=this.Jh.v;this.Jh.v=b;b=this.Yj.A;this.Yj.A=this.Jh.A;this.Jh.A=b;b=this.Yj.B;this.Yj.B=this.Jh.B;this.Jh.B=b};c.prototype.YR=function(b,d){var c=!this.Yj.Yb(this.Jh);if(f.T.Ic(b.G())&&
f.T.Ic(d.G())){if(b.D()>d.D())return this.sF(b,d,c);this.Au();c=this.sF(d,b,c);this.Au();return c}if(550==b.G()&&f.T.Ic(d.G()))return c=this.tF(d,b,c),this.Au(),c;if(550==d.G()&&f.T.Ic(b.G()))return this.tF(b,d,c);if(550==b.G()&&550==d.G()){if(b.D()>d.D())return this.uF(b,d);this.Au();c=this.uF(d,b);this.Au();return c}return 0};c.prototype.sF=function(b,d,c){var h=b.Da(),a=d.Da(),v=new f.h,e=new f.h,k=1.7976931348623157E308;if(!c&&this.pZ(b,d,h,a))return 0;for(;h.Ya();)for(;h.Ca();)if(b=h.ba(),b.s(v),
!(v.Yx(this.Jh)>k)){for(;a.Ya();)for(;a.Ca();)if(d=a.ba(),d.s(e),v.Yx(e)<k&&(d=b.Cb(d,c),d*=d,d<k)){if(0==d)return 0;k=d}a.yj()}return Math.sqrt(k)};c.prototype.tF=function(b,d,c){var h=b.Da(),a=new f.h,v=1.7976931348623157E308,e=new f.b,k,p=d.D();for(c=!c&&1736==b.G();h.Ya();)for(;h.Ca();){var g=h.ba();g.s(a);if(!(1<p&&a.Yx(this.Jh)>v)){for(var n=0;n<p;n++){d.w(n,e);if(c&&0!=f.gd.fe(b,e,0))return 0;k=g.oe(e,!1);e.sub(g.gc(k));k=e.pk();if(k<v){if(0==k)return 0;v=k}}c=!1}}return Math.sqrt(v)};c.prototype.uF=
function(b,d){for(var c=1.7976931348623157E308,l=new f.b,a=new f.b,v,e=b.D(),k=d.D(),p=0;p<e;p++)if(b.w(p,l),!(1<k&&this.Jh.YK(l)>c))for(var g=0;g<k;g++)if(d.w(g,a),v=f.b.sc(l,a),v<c){if(0==v)return 0;c=v}return Math.sqrt(c)};c.prototype.pZ=function(b,d,c,l){if(1736==b.G()){for(;l.Ya();)if(l.Ca()){var h=l.ba();if(0!=f.gd.fe(b,h.Cc(),0))return!0}l.yj()}if(1736==d.G()){for(;c.Ya();)if(c.Ca()&&(b=c.ba(),0!=f.gd.fe(d,b.Cc(),0)))return!0;c.yj()}return!1};c.prototype.Sm=function(b,d){if(b.u()||d.u())return NaN;
b.s(this.Yj);d.s(this.Jh);return this.YR(b,d)};return c}(),e=function(c){function b(){c.apply(this,arguments)}N(b,c);b.prototype.V=function(b,c,l){if(null==b||null==c)throw f.f.F();if(b.u()||c.u())return NaN;var d,h;d=b.G();h=c.G();if(33==d){if(33==h)return f.b.Cb(b.w(),c.w());if(197==h)return l=new f.h,c.s(l),l.Cb(b.w());d=new f.Ed;d.add(b);b=d}else if(197==d){if(197==h)return h=new f.h,b.s(h),l=new f.h,c.s(l),l.Cb(h);d=new f.Ia;d.jd(b,!1);b=d}33==h?(h=new f.Ed,h.add(c),c=h):197==h&&(h=new f.Ia,
h.jd(c,!1),c=h);return(new a(l)).Sm(b,c)};b.local=function(){null===b.$&&(b.$=new b);return b.$};b.prototype.G=function(){return 14};b.$=null;return b}(f.ef);f.gN=e})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h){this.KI=c;this.SI=b;this.je=h;this.kI=d}a.prototype.next=function(){var c=this.KI.next();return null==c?null:this.jD(c)};a.prototype.Ha=function(){return this.KI.Ha()};a.prototype.jD=function(c){var b=c.G();if(f.T.Jo(b))return c;if(197==b)return b=new f.Ia(c.description),b.jd(c,
!1),this.jD(b);if(c.u())return c;if(null==c)throw f.f.ya();for(var b=c.Ja(),d=new f.Hb,h=0,l=c.aa();h<l;h++)this.nM(c,h,b,d);return b};a.prototype.nM=function(c,b,d,h){if(!(2>c.Ka(b))){var l=c.wa(b),a=c.Gc(b)-1,v=c.Pa(0),e=c.Qb(b),k=new f.ia(0);k.yb(c.Ka(b)+1);var p=new f.ia(0);p.yb(c.Ka(b)+1);k.add(e?l:a);k.add(l);for(l=new f.b;1<k.size;){var g=k.Fc();k.Pf();var n=k.Fc();c.w(g,l);h.Mc(l);c.w(n,l);h.Zc(l);n=this.jM(h,l,v,g,n,a);0<=n?(k.add(n),k.add(g)):p.add(g)}e||p.add(k.get(0));if(p.size==k.size)d.Ti(c,
b,!0);else if(2<=p.size&&(!this.kI||2!=p.size||!(e||f.b.Cb(c.Aa(p.get(0)),c.Aa(p.get(1)))<=this.SI))){b=new f.Wa;h=0;for(a=p.size;h<a;h++)c.Ae(p.get(h),b),0==h?d.Rf(b):d.lineTo(b);e&&(this.kI||2!=p.size||d.lineTo(b),d.sq())}}};a.prototype.jM=function(c,b,d,h,f,a){var l=f-1;f<=h&&(l=a);a=f=-1;for(h+=1;h<=l;h++){d.fc(2*h,b);var q=b.x,e=b.y;c.gc(c.oe(b,!1),b);b.x-=q;b.y-=e;q=b.length();q>this.SI&&q>a&&(f=h,a=q)}return f};a.prototype.Re=function(){return!0};return a}();f.hN=a})(C||(C={}));(function(f){var a=
function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 29};c.prototype.V=function(b,d,c,l){return b instanceof f.T?(b=new f.hd(b),this.V(b,d,c,l).next()):new f.hN(b,d,c,l)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(f.ef);f.FD=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 21};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c,
l,a,v,e,k){return b instanceof f.T?(k=new f.hd(b),this.V(k,d,c,[l],a,v,!1,e).next()):!0===e?(c=new f.HD(b,d,c,l,a,!1,!1,k),f.ei.local().V(c,d,k)):new f.HD(b,d,c,l,a,!1,!1,k)};c.$=null;return c}(f.ef);f.GD=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h,l,a,v,e){if(a)throw f.f.df();if(null==b)throw f.f.F();this.Ba=-1;this.Gt=c;this.Rg=b;this.$e=d;this.xt=h;this.Po=l;this.To=-1;this.lc=e;this.tV=new f.h;this.tV.Oa()}a.prototype.next=function(){for(var c;null!=(c=this.Gt.next());)return this.Ba=
this.Gt.Ha(),this.To+1<this.xt.length&&this.To++,this.QS(c,this.xt[this.To]);return null};a.prototype.Ha=function(){return this.Ba};a.prototype.QS=function(c,b){return f.qM.buffer(c,this.Rg,this.$e,b,this.Po,this.lc)};a.prototype.Re=function(){return!0};return a}();f.HD=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 24};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c,l){if(null==d)throw f.f.F();
if(b.u()||1>b.tb())return 0;if(4==c)throw f.f.df();var h=f.fb.kc(d),a=f.fb.gw(h),e=f.fb.Rv(h),a=a*(2-a),k=h.Od().Ai,p=b.G(),g;1736==p||197==p?g=b.Gg():f.T.Oc(p)?(g=new f.Ua(b.description),g.dc(b,!0)):g=b;if(0==h.Eb(d)){if(f.fb.Jc(d)){g=f.gi.Mj(g,d);1607==p&&g==b&&(g=f.T.ne(b));b=new f.Ac;f.fb.Bh(d).Tn(b);for(var p=0,n=g.D();p<n;p++){var u=g.Aa(p);u.x=f.gi.On(u.x,b);g.rb(p,u)}}b=g.Ja();g=f.gi.NJ(d,h,g,b,l)?b:f.fb.Xg(g,d,h,l)}return this.$R(g,c,e,a,k)};c.prototype.$R=function(b,d,c,l,a){var h=new f.ea(0),
q=0;for(b=b.Da();b.Ya();)for(;b.Ca();){var e=b.ba(),k=e.ec(),e=e.Cc();k.scale(a);e.scale(a);f.mb.Md(c,l,k.x,k.y,e.x,e.y,h,null,null,d);q+=h.j}return q};c.$=null;return c}(f.ef);f.kN=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 18};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c,l,a){return b instanceof f.T?(b=new f.hd(b),this.V(b,d,c,l,a).next()):new f.jN(b,c,l,d,-1,-1,a)};c.$=null;return c}(f.ef);
f.iN=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h,l,a){if(0<a)throw f.f.df();if(4!=d&&0<l)throw f.f.df();if(null==b)throw f.f.F();this.Ba=-1;this.Gt=c;this.Rg=b;this.$e=d;this.AV=h;this.zV=l}a.prototype.next=function(){for(var c;null!=(c=this.Gt.next());)return this.Ba=this.Gt.Ha(),this.Fz(c);return null};a.prototype.Ha=function(){return this.Ba};a.prototype.Fz=function(c){return f.Ej.Ks(c,this.Rg,this.$e,this.AV,this.zV,this.lc)};a.prototype.Re=function(){return!0};return a}();
f.jN=a})(C||(C={}));(function(f){(function(f){f[f.Unknown=0]="Unknown";f[f.Contains=1]="Contains";f[f.Within=2]="Within";f[f.Equals=3]="Equals";f[f.Disjoint=4]="Disjoint";f[f.Touches=8]="Touches";f[f.Crosses=16]="Crosses";f[f.Overlaps=32]="Overlaps";f[f.NoThisRelation=64]="NoThisRelation";f[f.Intersects=1073741824]="Intersects";f[f.IntersectsOrDisjoint=1073741828]="IntersectsOrDisjoint"})(f.zM||(f.zM={}));var a=function(){function a(){}a.r_=function(c,b,d,h){if(b.u()||c.u())return 4;var l=c.G(),q=
b.G(),v;f.T.Oc(l)&&(c=v=new f.Ua(c.description),v.dc(c,!0));f.T.Oc(q)&&(b=v=new f.Ua(b.description),v.dc(b,!0));switch(l){case 33:switch(q){case 33:return a.DN(c,b,d);case 197:return a.se(a.AD(b,c,d));case 550:return a.se(a.ZD(b,c,d));case 1607:return a.se(a.ZC(b,c,d,h));case 1736:return a.se(a.mE(b,c,d))}throw f.f.ya();case 197:switch(q){case 33:return a.AD(c,b,d);case 197:return a.HM(c,b,d);case 550:return a.se(a.RD(b,c,d,h));case 1607:return a.se(a.rE(b,c));case 1736:return a.se(a.iE(b,c))}throw f.f.ya();
case 550:switch(q){case 33:return a.ZD(c,b,d);case 197:return a.RD(c,b,d,h);case 550:return a.XD(c,b,d,h);case 1607:return a.se(a.tE(b,c));case 1736:return a.se(a.kE(b,c))}throw f.f.ya();case 1607:switch(q){case 33:return a.ZC(c,b,d,h);case 197:return a.rE(c,b);case 550:return a.tE(c,b);case 1607:return a.kO(c,b);case 1736:return a.se(a.pE(b,c))}throw f.f.ya();case 1736:switch(q){case 33:return a.mE(c,b,d);case 197:return a.iE(c,b);case 550:return a.kE(c,b);case 1607:return a.pE(c,b);case 1736:return a.VN(c,
b)}throw f.f.ya();default:throw f.f.ya();}};a.DN=function(c,b,d){c=c.w();b=b.w();return a.gE(c,b,d)};a.gE=function(c,b,d){c.sub(b);return c.pk()<=d*d?3:4};a.AD=function(c,b,d){var h=new f.h;c.s(h);c=b.w();return a.OM(h,c,d)};a.OM=function(c,b,d){c.O(-d,-d);if(c.contains(b))return 1;c.O(d,d);return c.contains(b)?8:4};a.SM=function(c,b,d){return b.contains(d)?1:c.contains(d)?8:4};a.HM=function(c,b,d){var h=new f.h;c.s(h);c=new f.h;b.s(c);return a.LM(h,c,d)};a.LM=function(c,b,d){var h=0;c.contains(b)&&
(h|=1);b.contains(c)&&(h|=2);if(0!=h)return h;c.O(-d,-d);b.O(-d,-d);if(c.Yb(b))return h=c,h.O(d,d),h=h.contains(b)?1:0,b.O(d,d),h|=b.contains(c)?2:0,0!=h?h:32;h=c;h.O(d,d);b.O(d,d);return h.Yb(b)?8:4};a.ZD=function(c,b,d){b=b.w();return a.aE(c,b,d)};a.aE=function(c,b,d){for(var h=0,f=c.D();h<f;h++){var q;q=c.Aa(h);q=a.gE(q,b,d);if(4!=q)return 0!=(q&2)&&1!=f?1:q}return 4};a.RD=function(c,b,d,h){var l=new f.h;b.s(l);return a.ZM(c,l,d,h)};a.ZM=function(c,b,d,h){b.O(-d,-d);b.O(d,d);for(var f=d=0,q=c.D();f<
q;f++){var v;v=c.Aa(f);v=a.se(a.SM(b,b,v));if(4!=v&&(d|=v,4==h))return 1073741824}return 0==d?4:2==d?d:32};a.XD=function(c,b,d,h){for(var f=0,q=0,v=b.D();q<v;q++){var e;e=b.Aa(q);e=a.aE(c,e,d);if(4!=e&&(f++,4==h))return 1073741824}return 0<f?f==b.D()?3==h?(e=a.XD(b,c,d,1),1==e?3:0):1:32:0};a.ZC=function(c,b,d,h){b=b.w();return a.gO(c,b,d,h)};a.VM=function(c,b){var d=null;c=c.ob;null!=c&&(d=c.Hi);if(null!=d){d=d.rm(b.x,b.y);if(0==d)return 4;if(1==d)return 1}else return-1;return 0};a.gO=function(c,
b,d,h){if(0==(h&1073741839))return 64;var l=a.VM(c,b);if(0<l)return l;d*=d;for(l=c.Da();l.Ya();){var q=l.Ta;if(!c.Qb(q)){var v=c.Ka(q),q=c.wa(q);if(0==v)continue;if(f.b.sc(c.Aa(q),b)<=d||1<v&&f.b.sc(c.Aa(q+v-1),b)<=d)return 8}if(8!=h)for(;l.Ca();)if(v=l.ba(),v=v.gc(v.oe(b,!1)),f.b.sc(v,b)<=d)return 0!=(h&1073741828)?1073741824:1}return 0!=(h&1073741828)?4:64};a.rE=function(c,b){var d=new f.h;b.s(d);return a.cO(c,d)};a.cO=function(c,b){c=a.eq(c,b);return 0<c?c:0};a.eq=function(c,b){c=c.ob;if(null!=
c)c=c.Hi;else return-1;if(null!=c){c=c.Sn(b);if(0==c)return 4;if(1==c)return 1}else return-1;return 0};a.tE=function(c,b){var d=new f.h;b.s(d);d=a.eq(c,d);return 0<d?d:0};a.tv=function(c,b){var d=new f.h;b.s(d);d=a.eq(c,d);return 0<d?d:-1==d&&(d=new f.h,c.s(d),d=a.eq(b,d),0<d)?a.se(d):0};a.kO=function(c,b){c=a.tv(c,b);return 0<c?c:0};a.mE=function(c,b,d){b=b.w();return a.PN(c,b,d)};a.PN=function(c,b,d){c=f.gd.fe(c,b,d);if(0==c)return 4;if(1==c)return 1;if(2==c)return 8;throw f.f.ya();};a.iE=function(c,
b){var d=new f.h;b.s(d);return a.MN(c,d)};a.MN=function(c,b){c=a.eq(c,b);return 0<c?c:0};a.kE=function(c,b){c=a.tv(c,b);return 0<c?c:0};a.pE=function(c,b){c=a.tv(c,b);return 0<c?c:0};a.VN=function(c,b){c=a.tv(c,b);return 0<c?c:0};a.iX=function(c,b){var d=c.G(),h=b.G(),a;if(f.T.gh(d)&&(a=c.ob,null!=a&&(a=a.Hi,null!=a))){if(33==h){var q=b.w();a=a.rm(q.x,q.y)}else q=new f.h,b.s(q),a=a.Sn(q);if(1==a)return 1;if(0==a)return 4}if(f.T.gh(h)&&(a=b.ob,null!=a&&(a=a.Hi,null!=a))){33==d?(d=c.w(),a=a.rm(d.x,
d.y)):(d=new f.h,c.s(d),a=a.Sn(d));if(1==a)return 2;if(0==a)return 4}return 0};a.se=function(c){0!=(c&1)&&(c=c&-2|2);0!=(c&2)&&(c=c&-3|1);return c};return a}();f.lN=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.G=function(){return 15};c.prototype.V=function(b,d,c,a,q){return b instanceof f.T?(b=new f.hd(b),d=new f.hd(d),this.V(b,d,c,a,q).next()):void 0===q?new f.JD(b,d,c,a,-1):new f.JD(b,
d,c,a,q)};c.prototype.qo=function(b,d,c){if(!this.vv(b))return!1;d=f.ma.ah(d,b,!1);var h=b.Hj(c);return h=h||b.Wu(d,c)};c.prototype.vv=function(b){return f.wy.az(b)};c.$=null;return c}(f.ef);f.sk=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h,a){this.nt=null==b;this.Ba=-1;this.he=c;this.Rg=d;this.sf=b.next();this.Zj=this.sf.G();this.lc=h;this.ej=a;if(-1!=this.ej&&(0>=this.ej||7<this.ej))throw f.f.F("bad dimension mask");}a.prototype.next=function(){if(this.nt)return null;var c;if(null!=
this.nx){c=this.nx.next();if(null!=c)return c;this.nx=null}for(;null!=(c=this.he.next());){this.Ba=this.he.Ha();if(-1==this.ej)return c=this.Ma(c);this.nx=this.JU(c);return c=this.nx.next()}return null};a.prototype.Ha=function(){return this.Ba};a.prototype.Ma=function(c){var b=this.nL(c);if(null!=b)return b;var b=f.ma.Yv(this.sf,c),d=f.ma.be(this.Rg,b,!0),b=new f.h;this.sf.s(b);var h=new f.h;c.s(h);b.O(2*d,2*d);b.Ma(h);b.O(100*d,100*d);d=f.me.clip(this.sf,b,0,0);c=f.me.clip(c,b,0,0);return f.Dg.mw(c,
d,this.Rg,this.lc)};a.prototype.IJ=function(c,b,d){var h=0;if(0!=(b&1))null==d[0]&&(d[0]=new f.Ed(c)),h++;else for(var a=0;a<d.length-1;a++)d[a]=d[a+1];if(0!=(b&2))null==d[h]&&(d[h]=new f.Ua(c)),h++;else for(a=h;a<d.length-1;a++)d[a]=d[a+1];if(0!=(b&4))null==d[h]&&(d[h]=new f.Ia(c)),h++;else for(a=h;a<d.length-1;a++)d[a]=d[a+1];if(3!=h){c=[];for(a=0;a<h;a++)c[a]=d[a];return new f.hd(c)}return new f.hd(d)};a.prototype.JU=function(c){var b=this.nL(c);if(null!=b){var d=[null,null,null];d[b.tb()]=b;return this.IJ(c.description,
this.ej,d)}b=f.ma.Yv(this.sf,c);d=f.ma.be(this.Rg,b,!0);b=new f.h;this.sf.s(b);b.O(2*d,2*d);var h=new f.h;c.s(h);b.Ma(h);b.O(100*d,100*d);d=f.me.clip(this.sf,b,0,0);b=f.me.clip(c,b,0,0);d=f.Dg.uA(b,d,this.Rg,this.lc);return this.IJ(c.description,this.ej,d)};a.prototype.nL=function(c){var b=f.ma.Yv(c,this.sf),d=f.ma.be(this.Rg,b,!1),b=c.G(),h=c.u(),l=this.sf.u(),l=h||l;if(!l){l=new f.h;c.s(l);var q=new f.h;this.sf.s(q);q.O(2*d,2*d);l=!l.Yb(q)}if(!l)if(q=f.lN.iX(this.sf,c),4==q)l=!0;else{if(0!=(q&2))return this.sf;
if(0!=(q&1))return c}if(l)return d=f.T.lf(b),l=f.T.lf(this.Zj),d<l?a.$(c,h):d>l?this.cK():0==d?550==b&&33==this.Zj?this.cK():a.$(c,h):a.$(c,h);if((-1==this.ej||4==this.ej)&&197==b&&197==this.Zj)return d=this.sf,b=new f.h,c.s(b),h=new f.h,d.s(h),b.Ma(h),d=new f.ci,c.copyTo(d),d.Gp(b),d;if(197==b&&0==f.T.lf(this.Zj)||197==this.Zj&&0==f.T.lf(b))return h=197==b?c:this.sf,c=197==b?this.sf:c,b=new f.h,h.s(b),f.me.clip(c,b,d,0);if(0==f.T.lf(b)&&0<f.T.lf(this.Zj)||0<f.T.lf(b)&&0==f.T.lf(this.Zj)){d=f.ma.ah(this.Rg,
c,!1);if(550==b||33==b)return f.Dg.LH(c,this.sf,d);if(550==this.Zj||33==this.Zj)return f.Dg.LH(this.sf,c,d);throw f.f.ya();}return-1!=this.ej&&2!=this.ej||1607!=b||1736!=this.Zj?-1!=this.ej&&2!=this.ej||1736!=b||1607!=this.Zj?null:this.kL(this.sf,c):this.kL(c,this.sf)};a.prototype.kL=function(c,b){var d=c,h=b,a=f.ma.ah(this.Rg,b,!1),q=new f.h;h.s(q);var v=new f.h;d.s(v);v.O(2*a,2*a);q.Ma(v);q.O(10*a,10*a);var d=c=f.me.clip(c,q,0,0),v=new f.ia(0),e=-1,k=h.ob;if(null!=k){var p=k.Hi;if(null!=p){e=0;
v.yb(d.D()+d.aa());for(var g=new f.h,n=d.Da();n.Ya();)for(;n.Ca();){n.ba().s(g);var u=p.Sn(g);1==u?v.add(1):0==u?v.add(0):(v.add(-1),e++)}}}5<b.D()&&(h=b=f.me.clip(b,q,0,0),k=h.ob);0>e&&(e=d.hA());q=d.D()+h.D();if(e*h.D()>Math.log(q)*q*4)return null;q=null;e=h.Da();null!=k&&null!=k.Mb&&(q=k.Mb);null==q&&20<h.D()&&(q=f.ma.zF(h));h=c.Ja();k=null;p=d.Da();g=[0,0,0,0,0,0,0,0,0];n=new f.Sd(0);u=new f.Cg;c=-1;for(var z=0,r=0,t=0<v.size,A=-1;p.Ya();){var A=p.Ta,m=0;c=-1;for(z=0;p.Ca();){var w=t?f.J.truncate(v.get(r)):
-1;r++;var x=p.ba();if(0>w){if(null!=q)for(null==k?k=q.nT(x,a):k.Xn(x,a),w=k.next();-1!=w;w=k.next()){e.Tb(q.ja(w));for(var w=e.ba(),C=x.Ma(w,null,g,null,a),w=0;w<C;w++)n.add(g[w])}else for(e.yj();e.Ya();)for(;e.Ca();)for(w=e.ba(),C=x.Ma(w,null,g,null,a),w=0;w<C;w++)n.add(g[w]);if(0<n.size){n.Gd(0,n.size,function(b,d){return b-d});var I=0;n.add(1);for(var C=-1,w=0,E=n.size;w<E;w++){var J=n.get(w);if(J!=I){var K=!1;0!=I||1!=J?(x.yh(I,J,u),I=u.get()):(I=x,K=!0);if(2<=m){h.As(d,A,c,z,3==m);if(1!=this.dF(b,
I.ec(),a)&&1!=this.eF(b,I,a))return null;h.dc(I,!1);m=1;z=0}else switch(C=this.eF(b,I,a),C){case 1:K?2>m?(c=p.Db()-d.wa(A),z=1,m=0==m?3:2):z++:(h.dc(I,0==m),m=1);break;case 0:m=0;c=-1;z=0;break;default:return null}I=J}}}else{w=this.dF(b,x.ec(),a);if(0>w)return null;1==w?(2>m&&(c=p.Db()-d.wa(A),m=0==m?3:2),z++):(c=-1,z=0)}n.clear(!1)}else 0!=w&&1==w&&(0==m?(m=3,c=p.Db()-d.wa(A)):1==m?(m=2,c=p.Db()-d.wa(A)):z++)}2<=m&&(h.As(d,A,c,z,3==m),c=-1)}return h};a.prototype.dF=function(c,b,d){return f.ff.ln(c,
b,d)};a.prototype.eF=function(c,b,d){var h=b.ec();b=b.Cc();var a=f.ff.ln(c,h,d),q=f.ff.ln(c,b,d);if(1==a&&0==q||0==a&&1==q)return-1;if(0==a||0==q)return 0;if(1==a||1==q)return 1;a=new f.b;a.add(h,b);a.scale(.5);c=f.ff.ln(c,a,d);return 0==c?0:1==c?1:-1};a.$=function(c,b){return b?c:c.Ja()};a.prototype.cK=function(){null==this.JI&&(this.JI=this.sf.Ja());return this.JI};a.prototype.Re=function(){return!0};return a}();f.JD=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}
N(c,a);c.prototype.G=function(){return 28};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c,a,q,v,e){return b instanceof f.T?(b=new f.hd(b),this.V(b,d,c,a,q,v,e).next()):new f.mN(b,d,c,a,q,v,e)};c.$=null;return c}(f.ef);f.KD=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h,f,a,v){this.Ba=-1;this.he=c;this.ek=b;this.Qa=d;this.jj=h;this.hB=f;this.FI=a;this.je=v}a.prototype.next=function(){var c=this.he.next();return null!=c?(this.Ba=this.he.Ha(),this.$M(c)):
null};a.prototype.Ha=function(){return this.Ba};a.prototype.$M=function(c){var b;b=0>=this.FI?f.ma.ah(this.ek,c,!1):this.FI;return f.SL.V(c,this.Qa,this.jj,this.hB,b,this.je)};a.prototype.Re=function(){return!0};return a}();f.mN=a})(C||(C={}));(function(f){(function(f){f[f.clipToDomainOnly=1]="clipToDomainOnly";f[f.clipWithHorizon=2]="clipWithHorizon";f[f.foldAndClipWithHorizon=3]="foldAndClipWithHorizon"})(f.Up||(f.Up={}));var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=
function(){return 0};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c){return b instanceof f.T?(b=new f.hd(b),this.V(b,d,c).next()):new f.nN(b,d,c)};c.prototype.transform=function(b,d,c,a){return f.ko.transform(b,d,c,a,!0)};c.prototype.iL=function(b,d,c){return f.ko.iL(b,d,c)};c.prototype.Cu=function(b,d,c,a){return f.ko.Cu(b,d,c,a)};c.prototype.VY=function(b,d,c,a){return f.ko.fs(b,d,c,a)};c.prototype.hL=function(b,d,c,a){return f.ko.hL(b,d,c,a)};c.$=null;return c}(f.ef);
f.ns=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d){this.Ba=-1;this.he=c;this.JV=b;this.je=d}a.prototype.next=function(){var c=this.he.next();return null!=c?(this.Ba=this.he.Ha(),f.ko.Xg(c,this.JV,this.je)):null};a.prototype.Ha=function(){return this.Ba};a.prototype.Re=function(){return!0};return a}();f.nN=a})(C||(C={}));(function(f){var a=function(){function c(){}c.prototype.reset=function(){this.Lh=this.Zk=-1;this.pt=this.Zq=!1};c.prototype.rS=function(b,d,c){for(b.Tb(d,c);b.Ca();){var h=
b.ba(),h=h.Rb();if(0!=h)return b.Db()}for(b.Tb(d,c);b.nA();)if(h=b.Li(),h=h.Rb(),0!=h)return b.Db();return-1};c.prototype.sS=function(b,d){for(b.Tb(d,-1);b.nA();)if(0!=b.Li().Rb())return b.Db();return-1};c.prototype.qS=function(b,d){b.Tb(d,-1);for(b.ba();b.Ca();)if(0!=b.ba().Rb())return b.Db();return-1};c.prototype.pS=function(b,d,c,a){this.Zk=this.rS(d,c,a);if(-1!=this.Zk){d.Tb(this.Zk,-1);var h=d.ba(),l=h.gc(h.oe(b,!1));c=f.b.sc(l,b);a=new f.b;a.L(l);a.sub(h.ec());l=new f.b;l.L(b);l.sub(h.ec());
this.Zq=0>a.Ui(l);this.Lh=this.qS(d,this.Zk);if(-1!=this.Lh){d.Tb(this.Lh,-1);var h=d.ba(),e=h.oe(b,!1),e=h.gc(e),k=f.b.sc(e,b);k>c?this.Lh=-1:(a.L(e),a.sub(h.ec()),l.L(b),l.sub(h.ec()),this.pt=0>a.Ui(l))}-1==this.Lh&&(this.Lh=this.sS(d,this.Zk),-1!=this.Lh&&(d.Tb(this.Lh,-1),h=d.ba(),e=h.oe(b,!1),e=h.gc(e),k=f.b.sc(e,b),k>c?this.Lh=-1:(a.L(e),a.sub(h.ec()),l.L(b),l.sub(h.ec()),this.pt=0>a.Ui(l),b=this.Zk,this.Zk=this.Lh,this.Lh=b,b=this.Zq,this.Zq=this.pt,this.pt=b)))}};c.prototype.cQ=function(b,
d,c,f,a){c=c.Da();this.pS(b,c,f,a);if(-1!=this.Zk&&-1==this.Lh)return this.Zq;if(-1!=this.Zk&&-1!=this.Lh){if(this.Zq==this.pt)return this.Zq;c.Tb(this.Zk,-1);b=c.ba().Eg(1);c.Tb(this.Lh,-1);d=c.ba().Eg(0);return 0<=b.Ui(d)?!0:!1}return d};return c}(),e=function(c){function b(){c.apply(this,arguments)}N(b,c);b.local=function(){null===b.$&&(b.$=new b);return b.$};b.prototype.G=function(){return 3};b.prototype.Yz=function(b,c,a,q){void 0===q&&(q=!1);if(b.u())return new f.Nm;c=c.w();var d=b,h=b.G();
197==h&&(d=new f.Ia,d.jd(b,!1),h=1736);switch(h){case 33:return this.EJ(d,c);case 550:return this.qJ(d,c);case 1607:case 1736:return this.YV(d,c,a,q);default:throw f.f.X("not implemented");}};b.prototype.Zz=function(b,c){if(b.u())return new f.Nm;c=c.w();var d=b,h=b.G();197==h&&(d=new f.Ia,d.jd(b,!1),h=1736);switch(h){case 33:return this.EJ(d,c);case 550:case 1607:case 1736:return this.qJ(d,c);default:throw f.f.X("not implemented");}};b.prototype.$z=function(b,c,a,q){if(0>q)throw f.f.F();if(b.u())return[];
c=c.w();var d=b,h=b.G();197==h&&(d=new f.Ia,d.jd(b,!1),h=1736);switch(h){case 33:return this.DW(d,c,a,q);case 550:case 1607:case 1736:return this.aW(d,c,a,q);default:throw f.f.X("not implemented");}};b.prototype.YV=function(b,c,l,q){if(1736==b.G()&&l&&(l=new f.h,b.s(l),l=f.ma.be(null,l,!1),0!=(q?f.gd.fe(b,c,0):f.gd.fe(b,c,l)))){var d=new f.Nm(c,0,0);q&&d.MK(!0);return d}for(var h=b.Da(),d=new f.b,e=l=-1,k=1.7976931348623157E308,p=0;h.Ya();)for(;h.Ca();){var g=h.ba(),g=g.gc(g.oe(c,!1)),n=f.b.sc(g,
c);n<k?(p=1,d=g,l=h.Db(),e=h.Ta,k=n):n==k&&p++}d=new f.Nm(d,l,Math.sqrt(k));q&&(h.Tb(l,e),g=h.ba(),q=0>f.b.zp(c,g.ec(),g.Cc()),1<p&&(p=new a,p.reset(),q=p.cQ(c,q,b,l,e)),d.MK(q));return d};b.prototype.EJ=function(b,c){b=b.w();c=f.b.Cb(b,c);return new f.Nm(b,0,c)};b.prototype.qJ=function(b,c){var d=b.Pa(0);b=b.D();for(var h=0,a=0,e=0,k=1.7976931348623157E308,p=0;p<b;p++){var g=new f.b;d.fc(2*p,g);var n=f.b.sc(g,c);n<k&&(a=g.x,e=g.y,h=p,k=n)}d=new f.Nm;d.Ky(a,e,h,Math.sqrt(k));return d};b.prototype.DW=
function(b,c,a,q){if(0==q)return a=[];a*=a;b=b.w();c=f.b.sc(b,c);c<=a?(a=[],q=new f.Nm,q.Ky(b.x,b.y,0,Math.sqrt(c)),a[0]=q):a=[];return a};b.prototype.aW=function(b,c,a,q){if(0==q)return q=[];var d=b.Pa(0),h=b.D();b=[];var l=0;a*=a;for(var e=0;e<h;e++){var k=d.read(2*e),p=d.read(2*e+1),g=c.x-k,n=c.y-p,g=g*g+n*n;g<=a&&(n=new f.Nm,n.Ky(k,p,e,Math.sqrt(g)),l++,b.push(n))}c=b.length;b.sort(function(b,d){return b.Qa<d.Qa?-1:b.Qa==d.Qa?0:1});if(q>=c)return b.slice(0);b.length=q;return b.slice(0)};b.$=null;
return b}(f.ef);f.ry=e})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 4};c.prototype.V=function(b,d,c,a,q){return f.Om.XB(b,d,c,a,q)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.vv=function(b){return f.Fu.bz(b)};c.prototype.qo=function(b,d,c){return f.Fu.SE(b,d,c)};c.$=null;return c}(f.ef);f.oN=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 33};
c.prototype.V=function(b,d,c,a,q){return 1073741824===b?!f.Fd.YB(d,c,a,4,q):f.Fd.YB(d,c,a,b,q)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.vv=function(b){return f.Fu.bz(b)};c.prototype.qo=function(b,d,c){return f.Fu.SE(b,d,c)};c.$=null;return c}(f.ef);f.Gj=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h){this.je=h;this.qV=d;this.Ba=-1;if(null==c)throw f.f.F();this.$k=c;this.ek=b}a.prototype.next=function(){var c;return null!=(c=this.$k.next())?(this.Ba=this.$k.Ha(),
this.BC(c)):null};a.prototype.Ha=function(){return this.Ba};a.prototype.BC=function(c){if(null==c)throw f.f.F();return f.sy.SK(c,this.ek,this.qV,this.je)};a.prototype.Re=function(){return!0};return a}();f.pN=a})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 26};c.prototype.V=function(b,d,c,a){return b instanceof f.T?(b=new f.hd(b),this.V(b,d,c,a).next()):new f.pN(b,d,c,a)};c.prototype.Vq=function(b,d,c,a,q){return 0<(void 0!==
a?f.sy.Vq(b,d,c,a,q):f.sy.Vq(b,d,!1,null,c))};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(f.ef);f.Lm=a})(C||(C={}));(function(f){var a=function(){function b(){this.mr=0}b.prototype.gY=function(b){this.mr&=-2;this.mr|=b?1:0};b.prototype.gn=function(){return 0!=(this.mr&1)};b.prototype.gH=function(){return this.gn()?0:1};return b}();f.JZ=a;var e=function(){return function(){}}(),c=function(){return function(b,d,c,h){this.x=b;this.y=d;this.$i=c;this.mn=h}}(),b=function(){function b(b){this.bf=
b}b.prototype.compare=function(b,d,c){b=b.ja(c);d=this.bf.Nf.read(2*d);b=this.bf.Nf.read(2*b);d-=b;return 0>d?-1:0<d?1:0};return b}(),d=function(){function b(b){this.bf=b}b.prototype.compare=function(b,d,c){d=this.bf.ib[d];b=this.bf.ib[b.ja(c)];var h=d.gn(),f=b.gn();c=d.Le.pf(this.bf.wp,0);var a=b.Le.pf(this.bf.wp,0);c==a&&(c=Math.min(h?d.Le.ra:d.Le.oa,f?b.Le.ra:b.Le.oa),h=.5*(c-this.bf.wp)+this.bf.wp,h==this.bf.wp&&(h=c),c=d.Le.pf(h,0),a=b.Le.pf(h,0));return c<a?-1:c>a?1:0};return b}(),h=function(){function b(b,
d){this.PJ=new f.b;this.parent=b;this.XT=d}b.prototype.gs=function(b,d,c){var h=this.parent,f=this.XT;c.Gd(b,d,function(b,d){return h.ki(b,d,f)})};b.prototype.Qq=function(b){b=this.parent.Gi.get(b);this.parent.Nf.fc(2*(b>>1),this.PJ);return this.PJ.y+(0!=(b&1)?this.parent.gk:-this.parent.gk)};return b}(),l=function(){function l(b,d,c,h,a){this.yI=b.description;this.Y=b;this.mh=d;this.gk=f.ma.ah(this.mh,b,!1);this.pp=f.ma.ah(this.mh,b,!0);this.cB=c;this.oV=this.yI.Ea;this.ib=[];this.cp=[];this.Hh=
new f.Xp;this.hb=new f.tk;this.ve=new f.$d;this.jI=this.Ul=a}l.prototype.zA=function(){this.jI=!0;return(!f.T.Ic(this.Y.G())||this.MF()&&this.LF(!1))&&this.oQ()?f.T.Ic(this.Y.G())?this.rQ()?1607==this.Y.G()?this.tQ()?2:0:this.uQ()?this.vQ():0:0:2:0};l.prototype.HC=function(b,d){var c=this.Nf.read(2*b);b=this.Nf.read(2*b+1);var h=this.Nf.read(2*d);d=this.Nf.read(2*d+1);var a=!f.Hu.ow(c,b,h,d,this.gk*this.gk);return a?a:0==this.Y.tb()?!1:c==h&&b==d};l.prototype.MF=function(){for(var b=this.Y,d=b.$f?
3:2,c=0,h=b.aa();c<h;c++)if(b.Ka(c)<d)return this.ve=new f.$d(1,c,0),!1;return!0};l.prototype.LF=function(b){for(var d=this.Y,c=d.Da(),h=d.hasAttribute(1),d=h?f.ma.EF(this.mh,d,!1):0;c.Ya();)for(;c.Ca();){var a=c.ba();if(!(a.Rb()>this.gk)){if(b&&h){var l=a.ct(1,0),a=a.ct(1,0);if(Math.abs(a-l)>d)continue}this.ve=new f.$d(2,c.Db(),-1);return!1}}return!0};l.prototype.oQ=function(){var d=this.Y,c=null;f.T.Ic(this.Y.G())&&(c=this.Y);var a=(this.jI||this.Ul)&&null!=c,l=d.D();this.Nf=d.Pa(0);this.Gi=new f.ia(0);
this.Gi.yb(2*l);this.Fi=new f.ia(0);this.Fi.yb(2*l);a&&(null==this.im&&(this.im=new f.ia(0)),this.im.yb(l));for(var q=d=0;q<l;q++)if(this.Gi.add(2*q),this.Gi.add(2*q+1),this.Fi.add(2*q),this.Fi.add(2*q+1),a){for(;q>=c.Gc(d);)d++;this.im.add(d)}(new f.Gu).sort(this.Fi,0,2*l,new h(this,a));this.hb.clear();this.hb.Ep(new b(this));this.hb.Qe(l);c=0;for(l*=2;c<l;c++)if(a=this.Fi.get(c),d=this.Gi.get(a),a=d>>1,0==(d&1)){d=this.hb.addElement(a,-1);q=this.hb.Ve(d);if(-1!=q&&!this.HC(this.hb.ja(q),a))return this.ve=
new f.$d(3,a,this.hb.ja(q)),!1;var e=this.hb.nb(d);if(-1!=e&&!this.HC(this.hb.ja(e),a))return this.ve=new f.$d(3,a,this.hb.ja(e)),!1}else if(d=this.hb.search(a,-1),q=this.hb.Ve(d),e=this.hb.nb(d),this.hb.Ld(d,-1),-1!=q&&-1!=e&&!this.HC(this.hb.ja(q),this.hb.ja(e)))return this.ve=new f.$d(3,this.hb.ja(q),this.hb.ja(e)),!1;return!0};l.prototype.rQ=function(){return 10>this.Y.D()?this.pQ():this.qQ()};l.prototype.qQ=function(){var b=new f.fd;b.Jb(this.Y);var d=new f.$d;return f.Ju.sJ(!1,b,this.gk,d,this.je)?
(d.lm=b.Za(d.lm),d.mm=b.Za(d.mm),this.ve.ls(d),!1):!0};l.prototype.pQ=function(){for(var b=this.Y,d=b.Da(),b=b.Da();d.Ya();)for(;d.Ca();){var c=d.ba();if(!d.Io()||!d.SU()){b.xX(d);do for(;b.Ca();){var h=b.ba(),h=c.xs(h,this.gk,!0);if(0!=h)return this.ve=new f.$d(2==h?5:4,d.Db(),b.Db()),!1}while(b.Ya())}}return!0};l.prototype.uQ=function(){var b=this.Y;this.ib.length=0;this.cp.length=0;this.ug=b.Da();this.ug.iC();var d=new f.ia(0);d.yb(10);for(var c=NaN,h=0,a=0,b=2*b.D();a<b;a++){var l=this.Fi.get(a),
l=this.Gi.get(l);if(0==(l&1)){var l=l>>1,q=this.Nf.read(2*l),e=this.Nf.read(2*l+1);if(0!=d.size&&(q!=c||e!=h)){if(!this.JJ(d))return!1;null!=d&&d.clear(!1)}d.add(l);c=q;h=e}}return this.JJ(d)?!0:!1};l.prototype.tQ=function(){for(var b=this.Y,d=Array(b.aa()),c=0,h=b.aa();c<h;c++)d[c]=b.Eo(c);var h=new e,a,l,q,k=new f.b,c=this.Fi.get(0),c=this.Gi.get(c),p=c>>1;this.Nf.fc(2*p,k);c=this.im.get(p);a=d[c];l=b.wa(c);q=b.Gc(c)-1;h.Il=p==l||p==q;h.Ty=this.Ul?!a&&h.Il:h.Il;h.$i=c;h.x=k.x;h.y=k.y;h.mn=p;for(var g=
new e,n=1,u=this.Fi.size;n<u;n++)if(c=this.Fi.get(n),c=this.Gi.get(c),0==(c&1)){p=c>>1;this.Nf.fc(2*p,k);c=this.im.get(p);c!=h.$i&&(a=d[c],l=b.wa(c),q=b.Gc(c)-1);var z,r=p==l||p==q;z=this.Ul?!a&&h.Il:h.Il;g.x=k.x;g.y=k.y;g.$i=c;g.mn=p;g.Ty=z;g.Il=r;if(g.x==h.x&&g.y==h.y)if(this.Ul){if(!g.Ty||!h.Ty)if(g.$i!=h.$i||!g.Il&&!h.Il)return this.ve=new f.$d(8,g.mn,h.mn),!1}else if(!g.Il||!h.Il)return this.ve=new f.$d(5,g.mn,h.mn),!1;c=h;h=g;g=c}return!0};l.prototype.OF=function(){for(var b=this.Y,d=[],h=-1,
a=!1,l=0,q=b.aa();l<q;l++)b.qw(l)&&(a=!1,h++,l<q-1&&(b.qw(l+1)||(a=!0))),d[l]=a?h:-1;var a=new f.b,l=this.Fi.get(0),l=this.Gi.get(l),e=l>>1;this.Nf.fc(2*e,a);for(var l=this.im.get(e),h=new c(a.x,a.y,l,e,d[l]),b=[],k=1,q=this.Fi.size;k<q;k++)if(l=this.Fi.get(k),l=this.Gi.get(l),0==(l&1)){e=l>>1;this.Nf.fc(2*e,a);l=this.im.get(e);l=new c(a.x,a.y,l,e,d[l]);if(l.x==h.x&&l.y==h.y){if(l.$i==h.$i)return this.ve=new f.$d(9,l.mn,h.mn),!1;0<=d[l.$i]&&d[l.$i]==d[h.$i]&&(0!=b.length&&b[b.length-1]==h||b.push(h),
b.push(l))}h=l}if(0==b.length)return!0;l=new f.Xp(!0);f.J.Mv(d,-1);a=-1;k=new f.b;k.$c();h=0;for(q=b.length;h<q;h++){e=b[h];if(e.x!=k.x||e.y!=k.y)a=l.mi(0),k.x=e.x,k.y=e.y;var p=d[e.$i];-1==p&&(p=l.mi(2),d[e.$i]=p);l.addElement(p,a);l.addElement(a,p)}q=new f.ia(0);q.yb(10);for(h=l.Ge;-1!=h;h=l.aA(h))if(b=l.ZG(h),0==(b&1)&&0!=(b&2)){b=-1;q.add(h);for(q.add(-1);0<q.size;){a=q.Fc();q.Pf();k=q.Fc();q.Pf();e=l.ZG(k);if(0!=(e&1)){b=0==(e&2)?a:k;break}l.ZX(k,e|1);for(e=l.xc(k);-1!=e;e=l.nb(e))p=l.getData(e),
p!=a&&(q.add(p),q.add(k))}if(-1!=b){l=-1;h=0;for(q=d.length;h<q;h++)if(d[h]==b){l=h;break}this.ve=new f.$d(10,l,-1);return!1}}return!0};l.prototype.vQ=function(){var b=this.Y;if(0>=b.hf())return this.ve=new f.$d(6,1==b.aa()?1:-1,-1),0;if(1==b.aa())return this.Ul&&!this.OF()?0:2;this.hp=f.ia.yd(b.aa(),0);this.oB=f.ia.yd(b.aa(),-1);for(var c=-1,h=0,a=0,l=b.aa();a<l;a++){var q=b.Tm(a);this.hp.write(a,0>q?0:256);if(0<q)c=a,h=q;else{if(0==q)return this.ve=new f.$d(6,a,-1),0;if(0>c||h<Math.abs(q))if(this.ve=
new f.$d(7,a,-1),this.Ul)return 0;this.oB.write(a,c)}}this.Vt=b.aa();this.Cn=new f.ia(0);this.Cn.yb(10);l=b.D();this.wp=NaN;b=new f.ia(0);b.yb(10);this.Ir=f.ia.yd(l,-1);this.tx=f.ia.yd(l,-1);null!=this.Xj?this.Xj.clear(!1):this.Xj=new f.ia(0);this.Xj.yb(10);this.hb.clear();this.hb.Ep(new d(this));c=0;for(l*=2;0<this.Vt&&c<l;c++)if(h=this.Fi.get(c),h=this.Gi.get(h),0==(h&1)){h>>=1;a=this.Nf.read(2*h+1);if(a!=this.wp&&0!=b.size){if(!this.iu(b))return 0;null!=b&&b.clear(!1)}b.add(h);this.wp=a}return 0<
this.Vt&&!this.iu(b)?0:this.Ul?0==this.ve.Ii&&this.OF()?2:0:0==this.ve.Ii?2:1};l.prototype.JJ=function(b){if(1==b.size)return!0;for(var d=0,c=b.size;d<c;d++){var h=b.get(d);this.ug.Tb(h);var a=this.ug.Li();this.ib.push(this.Fv(a,h,this.ug.Ta,!0));this.ug.ba();a=this.ug.ba();this.ib.push(this.Fv(a,h,this.ug.Ta,!1))}var l=this;this.ib.sort(function(b,d){return l.TR(b,d)});h=this.Hh.Ge;-1==h&&(h=this.Hh.mi(0));this.Hh.Wn(this.ib.length);d=0;for(c=this.ib.length;d<c;d++)this.Hh.addElement(h,d);for(var d=
!0,q=c=-1;d;){d=!1;a=this.Hh.xc(h);if(-1==a)break;for(var e=this.Hh.nb(a);-1!=e;){c=this.Hh.getData(a);q=this.Hh.getData(e);c=this.ib[c].up;q=this.ib[q].up;if(c==q)if(d=!0,this.Hh.kd(h,a),a=this.Hh.Ve(e),e=this.Hh.kd(h,e),-1==e||-1==a)break;else continue;a=e;e=this.Hh.nb(a)}}d=this.Hh.$s(h);this.Hh.PF(h);if(0<d)return this.ve=new f.$d(5,c,q),!1;d=0;for(c=b.size;d<c;d++)this.UB(this.ib[d]);this.ib.length=0;return!0};l.prototype.iu=function(b){for(var d=0,c=b.size;d<c;d++){var h=b.get(d),a=this.Ir.read(h);
if(-1!=a){var l=this.hb.ja(a);this.Xj.add(l);this.hb.Ld(a,-1);this.UB(this.ib[l]);this.ib[l]=null;this.Ir.write(h,-1)}a=this.tx.read(h);-1!=a&&(l=this.hb.ja(a),this.Xj.add(l),this.hb.Ld(a,-1),this.UB(this.ib[l]),this.ib[l]=null,this.tx.write(h,-1))}d=0;for(c=b.size;d<c;d++){h=b.get(d);this.ug.Tb(h);a=this.ug.Li();if(a.ra>a.oa){var q=this.ug.Db(),e=this.Fv(a,h,this.ug.Ta,!0);0<this.Xj.size?(l=this.Xj.Fc(),this.Xj.Pf(),this.ib[l]=e):(l=this.ib.length,this.ib.push(e));a=this.hb.addElement(l,-1);-1==
this.Ir.read(q)?this.Ir.write(q,a):this.tx.write(q,a);0==(this.hp.read(this.ug.Ta)&3)&&this.Cn.add(a)}this.ug.ba();a=this.ug.ba();a.ra<a.oa&&(q=this.ug.Ik(),e=this.Fv(a,h,this.ug.Ta,!1),0<this.Xj.size?(l=this.Xj.Fc(),this.Xj.Pf(),this.ib[l]=e):(l=this.ib.length,this.ib.push(e)),a=this.hb.addElement(l,-1),-1==this.Ir.read(q)?this.Ir.write(q,a):this.tx.write(q,a),0==(this.hp.read(this.ug.Ta)&3)&&this.Cn.add(a))}d=0;for(c=this.Cn.size;d<c&&0<this.Vt;d++)if(a=this.Cn.get(d),0==(this.hp.read(this.ib[this.hb.ja(a)].nB)&
3)){b=-1;for(var h=this.hb.Ve(a),v=a,e=null,l=-1,k=0;-1!=h;){l=this.hb.ja(h);e=this.ib[l];l=e.nB;k=this.hp.read(l);if(0!=(k&3))break;v=h;h=this.hb.Ve(h)}-1==h?(q=1,h=v):(b=1==(k&3)?l:this.oB.read(l),q=0!=e.gH()?0:1,h=this.hb.nb(h));do{l=this.hb.ja(h);e=this.ib[l];l=e.nB;v=this.hp.read(l);if(0==(v&3)){if(q!=e.gH())return this.ve=new f.$d(6,l,-1),!1;k=0==q||e.gn()?2:1;v=v&252|k;this.hp.write(l,k);if(2==k&&0==this.ve.Ii&&this.oB.read(l)!=b&&(this.ve=new f.$d(7,l,-1),this.Ul))return!1;this.Vt--;if(0==
this.Vt)return!0}1==(v&3)&&(b=l);v=h;h=this.hb.nb(h);q=0!=q?0:1}while(v!=a)}null!=this.Cn?this.Cn.clear(!1):this.Cn=new f.ia(0);return!0};l.prototype.Fv=function(b,d,c,h){if(322==b.G())b=this.qR(b);else throw f.f.ya();b.up=d;b.nB=c;b.mr=0;b.gY(h);return b};l.prototype.qR=function(b){var d;0<this.cp.length?(d=this.cp[this.cp.length-1],--this.cp.length,b.copyTo(d.Le)):(d=new a,d.Le=f.bE.ne(b));return d};l.prototype.UB=function(b){322==b.Le.G()&&this.cp.push(b)};l.prototype.ZV=function(){for(var b=this.Y.D(),
d=new f.ia(0),c=0;c<b;c++)d.add(c);var h=this;d.Gd(0,b,function(b,d){return h.Bv(b,d)});for(c=1;c<b;c++)if(0==this.Bv(d.get(c-1),d.get(c)))return this.ve=new f.$d(3,d.get(c-1),d.get(c)),0;return 2};l.prototype.IW=function(){return this.MF()?this.LF(!0)?2:0:0};l.prototype.GW=function(){return this.zA()};l.prototype.$V=function(){for(var b=this.Y.D(),d=new f.ia(0),c=0;c<b;c++)d.add(c);var h=this;d.Gd(0,b,function(b,d){return h.RQ(b,d)});var a=Array(b);f.J.Mv(a,!1);a[d.get(0)]=!0;for(c=1;c<b;c++){var l=
d.get(c-1),q=d.get(c);0==this.Bv(l,q)?a[q]=!1:a[q]=!0}for(var d=this.Y.Ja(),l=this.Y,q=0,e=1,c=0;c<b;c++)a[c]?e=c+1:(q<e&&d.Jd(l,q,e),q=c+1);q<e&&d.Jd(l,q,e);d.Zg(2,this.pp);return d};l.prototype.JW=function(){var b=this.Y,d=b.Da(),c=b.Da(),h=this.Y.Ja(),a=this.Y,l=b.hasAttribute(1),q=l?f.ma.EF(this.mh,b,!0):0,e=new f.ia(0),k=new f.ia(0);e.yb(f.J.truncate(b.D()/2+1));for(k.yb(f.J.truncate(b.D()/2+1));d.Ya();)if(c.Ya(),!(2>b.Ka(d.Ta))){c.zX();for(var p,g,n=!0;d.Ca();){var u=d.ba(),z=c.Li();if(d.Db()>
c.Db())break;n&&(e.add(d.Db()),k.add(c.Ik()),n=!1);g=e.Fc();var r=d.Ik();if(1<r-g){var t=new f.b;t.zc(b.Aa(g),b.Aa(r));p=t.length()}else p=u.Rb();g=k.Fc();r=c.Db();1<r-g?(t=new f.b,t.zc(b.Aa(g),b.Aa(r)),g=t.length()):g=z.Rb();p>this.pp?e.add(d.Ik()):l&&(p=b.Yc(1,e.Fc(),0),u=u.Ns(1,0),Math.abs(u-p)>q&&e.add(d.Ik()));g>this.pp?k.add(c.Db()):l&&(p=b.Yc(1,k.Fc(),0),u=z.Ns(1,0),Math.abs(u-p)>q&&k.add(c.Db()))}e.Fc()<k.Fc()?e.size>k.size?e.Pf():k.Pf():(e.Fc()!=k.Fc()&&k.Pf(),k.Pf());if(2<=k.size+e.size){n=
new f.Wa;z=0;for(u=e.size;z<u;z++)a.Ae(e.get(z),n),0==z?h.Rf(n):h.lineTo(n);for(z=k.size-1;0<z;z--)a.Ae(k.get(z),n),h.lineTo(n);a.Qb(d.Ta)?h.sq():0<k.size&&(a.Ae(k.get(0),n),h.lineTo(n))}null!=e&&e.clear(!1);null!=k&&k.clear(!1)}h.Zg(2,this.pp);return h};l.prototype.HW=function(){return this.wY()};l.prototype.wY=function(){if(1736==this.Y.G()&&1==this.Y.xo())return f.Dg.ol(this.Y,this.pp,!0,!1,this.je);this.gj=new f.fd;this.gj.Jb(this.Y);0!=this.gj.ud&&(1!=this.cB&&f.rk.V(this.gj,this.pp,this.je,
!0),1736==this.Y.G()&&f.lo.V(this.gj,this.gj.rd,this.cB,!1,this.je));this.Y=this.gj.Se(this.gj.rd);1736==this.Y.G()&&(this.Y.Al(),this.Y.Hp(0));this.Y.Zg(2,this.pp);return this.Y};l.uc=function(b,d,c){if(b.u())return 1;var h=b.G();if(33==h)return 1;if(197==h)return c=new f.h,b.s(c),c.fh(f.ma.ah(d,b,!1))?0:1;if(f.T.Oc(h))throw f.f.ya();if(!f.T.gh(h))throw f.f.ya();var h=f.ma.ah(d,b,!1),a=b.Kk(h);c=c?-1:a;if(-1!=c)return c;1==c&&(h=0);c=(new l(b,d,c,0,!1)).zA();b.Zg(c,h);return c};l.Vq=function(b,d,
c,h,a){null!=h&&(h.Ii=0,h.lm=-1,h.mm=-1);if(b.u())return 1;var q=b.G();if(33==q)return 1;var e=f.ma.ah(d,b,!1);if(197==q)return d=new f.h,b.s(d),d.fh(e)?(null!=h&&(h.Ii=2,h.lm=-1,h.mm=-1),0):1;if(f.T.Oc(q))return e=new f.Ua(b.description),e.dc(b,!0),l.Vq(e,d,c,h,a);a=b.Kk(e);c=c?-1:a;if(-1!=c)return c;d=new l(b,d,c,0,!1);if(550==q)c=d.ZV();else if(1607==q)c=d.IW();else if(1736==q)c=d.GW();else throw f.f.ya();b.Zg(c,e);null!=h&&0==c&&h.ls(d.ve);return c};l.Bb=function(b,d,c,h,a){null!=h&&(h.Ii=0,h.lm=
-1,h.mm=-1);if(b.u())return 1;var q=b.G();if(33==q)return 1;var e=f.ma.ah(d,b,!1);if(197==q)return d=new f.h,b.s(d),d.fh(e)?(null!=h&&(h.Ii=2,h.lm=-1,h.mm=-1),0):1;if(f.T.Oc(q))return q=new f.Ua(b.description),q.dc(b,!0),l.Vq(q,d,c,h,a);b=new l(b,d,-1,0,!0);if(550==q||1607==q||1736==q)d=b.zA();else throw f.f.ya();null!=h&&h.ls(b.ve);return d};l.SK=function(b,d,c,h){if(b.u())return b;var a=b.G();if(33==a)return b;var q=f.ma.ah(d,b,!1);if(197==a)return d=new f.h,b.s(d),d.fh(q)?b.Ja():b;if(f.T.Oc(a))return a=
new f.Ua(b.description),a.dc(b,!0),l.SK(a,d,c,h);h=b.Kk(q);c=c?-1:h;if(2==c)return b;b=new l(b,d,c,0,!1);if(550==a)b=b.$V();else if(1607==a)b=b.JW();else if(1736==a)b=b.HW();else throw f.f.ya();return b};l.CC=function(b,d,c,h){if(b.u())return b;var a=b.G();if(33==a)return b;var q=f.ma.ah(d,b,!1);if(197==a)return d=new f.h,b.s(d),d.fh(q)?b.Ja():b;if(f.T.Oc(a))return q=new f.Ua(b.description),q.dc(b,!0),l.CC(q,d,c,h);if(!f.T.gh(a))throw f.f.X("OGC simplify is not implemented for this geometry type "+
a);return f.Dg.CC(b,q,!1,h)};l.prototype.ki=function(b,d,c){if(b==d)return 0;b=this.Gi.get(b);var h=this.Gi.get(d);d=b>>1;var a=h>>1,l=new f.b,q=new f.b;this.Nf.fc(2*d,l);l.y+=0!=(b&1)?this.gk:-this.gk;this.Nf.fc(2*a,q);q.y+=0!=(h&1)?this.gk:-this.gk;b=l.compare(q);return 0==b&&c?(c=this.im.get(d)-this.im.get(a),0>c?-1:0<c?1:0):b};l.prototype.Bv=function(b,d){if(b==d)return 0;var c=this.Y,h=c.Aa(b),a=c.Aa(d);if(h.x<a.x)return-1;if(h.x>a.x)return 1;if(h.y<a.y)return-1;if(h.y>a.y)return 1;for(h=1;h<
this.oV;h++)for(var a=this.yI.zd(h),l=f.na.Xa(a),q=0;q<l;q++){var e=c.Yc(a,b,q),v=c.Yc(a,d,q);if(e<v)return-1;if(e>v)return 1}return 0};l.prototype.RQ=function(b,d){var c=this.Bv(b,d);return 0==c?b<d?-1:1:c};l.prototype.TR=function(b,d){if(b===d)return 0;var c=b.Le.Eg(b.gn()?1:0);b.gn()&&c.Kr();b=d.Le.Eg(d.gn()?1:0);d.gn()&&b.Kr();d=c.Zu();var h=b.Zu();return h==d?(d=c.Ui(b),Math.abs(d)<=8.881784197001252E-16*(Math.abs(b.x*c.y)+Math.abs(b.y*c.x))&&(d--,d++),0>d?1:0<d?-1:0):d<h?-1:1};return l}();f.sy=
l})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 30};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(b,d,c,a){return b instanceof f.T?(b=new f.hd(b),d=new f.hd(d),this.V(b,d,c,a).next()):new f.qN(b,d,c,a)};c.Pp=function(b,d,h,a){var l=b.tb(),e=d.tb();if(b.u()&&d.u())return l>e?b:d;if(b.u())return d;if(d.u())return b;var k=new f.h,p=new f.h,g=new f.h;b.s(k);d.s(p);g.I(k);g.Nb(p);k=f.ma.be(h,g,!1);
p=b.G();g=d.G();return 33==p&&33==g?c.mO(b,d,k):p!=g?0<l||0<e?l>e?b:d:550==p?c.WJ(b,d,k):c.WJ(d,b,k):f.Dg.Pp(b,d,h,a)};c.mO=function(b,d,c){c=c*Math.sqrt(2)*1.00001;c*=c;var h=b.w(),a=d.w(),e=new f.Ed(b.description);f.b.sc(h,a)>c&&(e.add(b),e.add(d));return e};c.WJ=function(b,d,c){var h=b.Pa(0),a=b.D(),e=d.w(),k=b.Ja();c=c*Math.sqrt(2)*1.00001;var p=new f.h;b.s(p);p.O(c,c);if(p.contains(e)){c*=c;for(var p=!1,g=[],n=0;n<a;n++)g[n]=!1;for(n=0;n<a;n++){var u=h.read(2*n),z=h.read(2*n+1),u=u-e.x,z=z-e.y;
u*u+z*z<=c&&(p=!0,g[n]=!0)}if(p)for(n=0;n<a;n++)g[n]||k.Jd(b,n,n+1);else k.Jd(b,0,a),k.add(d)}else k.Jd(b,0,a),k.add(d);return k};c.$=null;return c}(f.ef);f.ty=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d,h){this.nt=null==b;this.Ba=-1;this.he=c;this.Rg=d;this.KV=b.next();this.lc=h}a.prototype.next=function(){if(this.nt)return null;var c;return null!=(c=this.he.next())?(this.Ba=this.he.Ha(),f.ty.Pp(c,this.KV,this.Rg,this.lc)):null};a.prototype.Ha=function(){return this.Ba};a.prototype.Re=
function(){return!0};return a}();f.qN=a})(C||(C={}));(function(f){var a=function(){function b(){}b.prototype.jw=function(){this.Gz=null;this.fy=-1;this.qL=!1};return b}(),e=function(){function b(){this.Ds=0;this.Pj=[]}b.prototype.oP=function(b){this.Ds+=b.fy;this.Pj.push(b)};b.prototype.KW=function(){this.Ds-=this.Pj[this.Pj.length-1].fy;--this.Pj.length};b.prototype.Sy=function(){return this.Pj[this.Pj.length-1]};b.prototype.Eb=function(b){return b===this};return b}(),c=function(){function b(b,c,
f){this.Ba=-1;this.Pc=!1;this.OI=[!1,!1,!1,!1];this.ir=[0,0,0,0];this.RA=!1;this.bl=-1;this.Xq=0;this.Ro=-1;this.rp=[];this.he=b;this.Rg=c;this.lc=f}b.uc=function(b){var d=[],c;for(c in b)d.push(Number(c));d.sort(function(b,d){return b-d});return d};b.prototype.rH=function(d){var c=this.rp[d],a=b.uc(c)[0],q=c[a],e=q.Sy().Gz,q=q.Sy().qL;delete c[a];q&&(e=f.Lm.local().V(e,this.Rg,!1,this.lc),0==d&&33==e.G()&&(d=new f.Ed(e.description),e.u()||d.add(e),e=d));return e};b.prototype.next=function(){if(this.Pc&&
this.Ro==this.bl)return null;for(;!this.bL(););if(-1==this.bl)return null;if(this.RA){for(this.Ro++;;){if(this.Ro>this.bl||0>this.Ro)throw f.f.ya();if(this.OI[this.Ro])break}this.Ba++;return this.rH(this.Ro)}this.Ba=0;this.Ro=this.bl;return this.rH(this.bl)};b.prototype.Ha=function(){return this.Ba};b.prototype.bL=function(){if(this.Pc)return!0;var b=null;null!=this.he&&(b=this.he.next(),null==b&&(this.Pc=!0,this.he=null));if(null!=b){var c=b.tb();this.OI[c]=!0;c>=this.bl&&!this.RA&&(this.bF(c,!1,
b),c>this.bl&&!this.RA&&this.vX(c))}if(0<this.Xq)for(c=0;c<=this.bl;c++)for(;1<this.ir[c];)if(b=this.HQ(c),0!=b.length)b=f.Dg.QR(b,this.Rg,this.lc),this.bF(c,!0,b);else break;return this.Pc};b.prototype.HQ=function(d){for(var c=[],f=[],a=this.rp[d],e=b.uc(a),k=0;k<e.length;k++){var p=e[k],g=a[p];if(this.Pc||1E4<g.Ds&&1<g.Pj.length){this.ir[d]-=g.Pj.length;for(this.Xq-=g.Pj.length;0<g.Pj.length;)c.push(g.Sy().Gz),g.KW();f.push(p)}}for(k=0;k<f.length;k++)delete a[f[k]];return c};b.prototype.vX=function(b){for(var d=
0;d<b;d++)this.rp[d]=[],this.Xq-=this.ir[d],this.ir[d]=0};b.prototype.bF=function(d,c,f){var h=new a;h.jw();h.Gz=f;f=b.Mg(f);h.fy=f;f=b.We(f);if(d+1>this.rp.length)for(var l=0,k=Math.max(2,d+1);l<k;l++)this.rp.push([]);l=this.rp[d][f];void 0===l&&(l=new e,this.rp[d][f]=l);h.qL=c;l.oP(h);this.ir[d]++;this.Xq++;this.bl=Math.max(this.bl,d)};b.We=function(b){return 0<b?f.J.truncate(Math.log(b)/Math.log(4)+.5):0};b.Mg=function(b){var d=b.G();if(f.T.gh(d))return b.D();if(33==d)return 1;if(197==d)return 4;
if(f.T.Oc(d))return 2;throw f.f.ya();};b.prototype.Re=function(){return this.bL()};return b}();f.sN=c})(C||(C={}));(function(f){var a=function(a){function c(){a.apply(this,arguments)}N(c,a);c.prototype.G=function(){return 1};c.prototype.V=function(b,d,c,a){return void 0===a?new f.sN(b,d,c):this.ZR(b,d,c,a)};c.prototype.ZR=function(b,d,c,a){b=new f.hd([b,d]);return this.V(b,c,a).next()};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(f.ef);f.ei=a})(C||(C={}));(function(f){var a;
(function(f){f[f.nextPath=0]="nextPath";f[f.nextSegment=1]="nextSegment";f[f.iterate=2]="iterate"})(a||(a={}));a=function(){function a(c,b,d,h){this.Nt=new f.h;this.DV=c;this.EV=b;this.ar=h;this.ip=-1;this.Vl=!1;var a=c.ob;null!=a&&(a=h?a.np:a.Mb,null!=a&&(this.Pc=!1,this.ta=d,this.Mb=a,this.kx=this.Mb.mf(),this.br=this.Vl=!0,this.Zb=0,h?this.ip=b.aa():this.Cd=b.Da()));this.Vl||(a=b.ob,null!=a&&(a=h?a.np:a.Mb,null!=a&&(this.Pc=!1,this.ta=d,this.Mb=a,this.kx=this.Mb.mf(),this.Vl=!0,this.br=!1,this.Zb=
0,h?this.ip=c.aa():this.Cd=c.Da())));this.Vl||(this.Ci=h?f.ma.cT(c,b,d,1<=c.Kk(0),1<=b.Kk(0)):f.ma.bT(c,b,d))}a.prototype.next=function(){if(this.Vl){if(this.Pc)return!1;for(var c=!0;c;)switch(this.Zb){case 0:c=this.gW();break;case 1:c=this.hW();break;case 2:c=this.BA();break;default:throw f.f.X("internal error");}return this.Pc?!1:!0}return null==this.Ci?!1:this.Ci.next()};a.prototype.Ql=function(){return this.Vl?this.br?this.Mb.ja(this.At):this.ar?this.ip:this.Cd.Db():this.Ci.Ql(this.Ci.sg)};a.prototype.Ml=
function(){return this.Vl?this.br?this.ar?this.ip:this.Cd.Db():this.Mb.ja(this.At):this.Ci.Ml(this.Ci.bg)};a.prototype.dA=function(){if(!this.ar)throw f.f.X("internal error");return this.Vl?this.br?this.Mb.QG(this.At):this.Nt:this.Ci.dA(this.Ci.sg)};a.prototype.Hz=function(){if(!this.ar)throw f.f.X("internal error");return this.Vl?this.br?this.Nt:this.Mb.QG(this.At):this.Ci.Hz(this.Ci.bg)};a.prototype.gW=function(){if(!this.ar){if(!this.Cd.Ya())return this.Pc=!0,!1;this.Zb=1;return!0}if(-1==--this.ip)return this.Pc=
!0,!1;this.br?this.EV.ik(this.ip,this.Nt):this.DV.ik(this.ip,this.Nt);this.kx.Ni(this.Nt,this.ta);this.Zb=2;return!0};a.prototype.hW=function(){if(!this.Cd.Ca())return this.Zb=0,!0;var c=this.Cd.ba();this.kx.Xn(c,this.ta);this.Zb=2;return!0};a.prototype.BA=function(){this.At=this.kx.next();return-1==this.At?(this.Zb=this.ar?0:1,!0):!1};return a}();f.Mm=a})(C||(C={}));(function(f){f=f.AN||(f.AN={});f[f.enumClosed=1]="enumClosed";f[f.enumHasNonlinearSegments=2]="enumHasNonlinearSegments";f[f.enumOGCStartPolygon=
4]="enumOGCStartPolygon";f[f.enumCalcMask=4]="enumCalcMask"})(C||(C={}));(function(f){var a=function(){function a(){}a.Cb=function(c,b,d,h,l,q,e,k,p){var v=[0,0,0],g=[0,0,0],n=[0,0,0],u=[0,0,0,0],z=new f.ea(0),r=new f.ea(0),t=new f.ea(0);if(null!=e||null!=k||null!=p)if(f.l.Qi(b))f.vh.Cb(c,d,h,l,q,e,k,p);else{l=f.C.da(l);d=f.C.da(d);var A=f.C.da(l-d);if(f.l.W(h,q)&&(f.l.W(d,l)||f.l.W(f.l.K(h),1.570796326794897)))null!=e&&(e.j=0),null!=k&&(k.j=0),null!=p&&(p.j=0);else{if(f.l.W(h,-q)){if(f.l.W(f.l.K(h),
1.570796326794897)){null!=e&&(e.j=2*f.C.Yg(c,b));null!=k&&(k.j=0<h?f.C.da(3.141592653589793-f.C.da(l)):f.C.da(l));null!=p&&(p.j=0<h?f.C.da(l):f.C.da(3.141592653589793-f.C.da(l)));return}f.l.W(f.l.K(A),3.141592653589793)&&(null!=e&&(e.j=2*f.C.Yg(c,b)),null!=k&&(k.j=0),null!=p&&(p.j=0))}else{if(f.l.W(f.l.K(h),1.570796326794897)||f.l.W(f.l.K(q),1.570796326794897)){f.yl.Cb(c,b,d,h,l,q,e,k,p);return}if(f.l.W(d,l)||f.l.W(f.l.K(A),3.141592653589793)){f.yl.Cb(c,b,d,h,l,q,e,k,p);return}if(f.l.wd(h)){f.yl.Cb(c,
b,d,h,l,q,e,k,p);return}}var m=Math.sqrt(1-b);l=f.C.da(l-d);d=0;f.C.Ck(1,b,h,d,0,z,r,t);v[0]=z.j;v[1]=r.j;v[2]=t.j;f.C.Ck(1,b,q,l,0,z,r,t);g[0]=z.j;g[1]=r.j;g[2]=t.j;n[0]=0;n[1]=0;n[2]=-1*b*f.C.n(1,b,h)*Math.sin(h);0>l?f.C.Nr(n,g,v,u,0):f.C.Nr(n,v,g,u,0);for(var r=[0,0,0],t=[0,0,0],w=[0,0,0],v=[0,0,0],z=[0,0,0],D=Math.acos(u[2]/1),x=1-b,C=Math.tan(D),I=1+C*C/x,H=2*n[2]*C/x,C=Math.sqrt(H*H-4*I*(n[2]*n[2]/x-1)),I=2*I,x=(-H+C)/I,H=(-H-C)/I,C=Math.tan(D),I=C*x+n[2],D=(x+H)/2,n=(I+(C*H+n[2]))/2,C=f.C.Sp(x-
D,I-n),x=n/m*1.570796326794897,H=0;100>H;H++){I=f.C.Cm(b,x);I=I*I/Math.cos(x)*(Math.sin(x)-n*I/(1*(1-b)));if(f.l.wd(I))break;x-=I}var n=f.C.n(1,b,x)*Math.cos(x),n=Math.sqrt((n-D)*(n+D)),C=1-C/n,C=C*(2-C),I=f.C.fo(r),D=f.C.fo(t),x=f.C.fo(w),J=f.C.Du(w,r),H=f.C.Du(w,t);f.C.ey(w,r,v);f.C.ey(w,t,z);r=Math.acos(J/(x*I));t=Math.acos(H/(x*D));t*=f.l.Ab(1,f.C.Du(v,z));if(1.570796326794897<=f.l.K(r)&&1.570796326794897<=f.l.K(t)||3.141592653589793<f.l.K(r-t))r=(3.141592653589793-f.l.K(r))*f.l.Ab(1,r),t=(3.141592653589793-
f.l.K(t))*f.l.Ab(1,t);v=f.C.hk(C,t);z=f.C.q(n,C,f.C.hk(C,r));v=f.C.q(n,C,v);v=f.l.K(v-z)*c;r=new f.ea(0);t=new f.ea(0);w=u[1]/1;w*=-f.l.Ab(1,A);z=Math.acos(w)*f.l.Ab(1,A);a.Uf(c,b,d,h,v,z,r,t);f.l.W(l,r.j)&&f.l.W(q,t.j)||(C=f.C.Sp(f.C.da(l-r.j),q-t.j),a.Uf(c,b,d,h,v,f.C.da(z+3.141592653589793),r,t),I=f.C.Sp(f.C.da(l-r.j),q-t.j),I<C&&(z=f.C.da(z+3.141592653589793)));r=[0,0,0,0];t=[0,0,0,0];n=[0,0,0];C=[0,0,0];c=[0,0,0];d=[0,0,0];h=[0,0,0];w=[0,0,0];n[0]=0;n[1]=0;n[2]=m;C[0]=0;C[1]=0;C[2]=0;f.C.Nr(C,
n,g,r,0);f.l.wd(q)?(c[0]=g[0],c[1]=g[1],c[2]=1,d[0]=1*Math.cos(l)-1*Math.sin(l),d[1]=1*Math.sin(l)+1*Math.cos(l)):(b=f.C.n(1,b,q)*Math.cos(q),c[0]=0,c[1]=0,g[2]+=Math.tan(1.570796326794897-f.l.K(q))*b*f.l.Ab(1,q),d[0]=b*Math.cos(l)-b*Math.sin(l),d[1]=b*Math.sin(l)+b*Math.cos(l));d[2]=g[2];f.C.Nr(g,d,c,t,1);f.C.ey(t,r,h);f.C.ey(t,u,w);w=f.C.Du(h,w)/(f.C.fo(h)*f.C.fo(w));w*=f.l.Ab(1,A);l=Math.acos(w)*-f.l.Ab(1,A);0<z&&0<l?l=f.C.da(l+3.141592653589793):0>z&&0>l&&(l=f.C.da(l+3.141592653589793));null!=
e&&(e.j=v);null!=k&&(k.j=z);null!=p&&(p.j=l)}}};a.Uf=function(c,b,d,h,a,q,e,k){var l=[0,0,0],v=[0,0,0],p=[0,0,0],g=[0,0,0],n=[0,0,0],u=[0,0,0],z=[0,0,0],r=[0,0,0,0],t=new f.ea(0),A=new f.ea(0),m=new f.ea(0),w=new f.ea(0),D=new f.ea(0),x=new f.ea(0);if(null!=e&&null!=k)if(f.l.Qi(b))f.vh.Uf(c,d,h,a,q,e,k);else if(f.l.wd(a))null!=e&&(e.j=d),null!=k&&(k.j=h);else if(q=f.C.da(q),0>a&&(a=f.l.K(a),q=f.C.da(q+3.141592653589793)),d=f.C.da(d),h=f.C.da(h),1.570796326794897<f.l.K(h)&&(d=f.C.da(d+3.141592653589793),
h=f.l.Ab(3.141592653589793,h)-h),f.l.W(f.l.K(h),1.570796326794897)||f.l.wd(h)||f.l.wd(q)||f.l.W(f.l.K(q),3.141592653589793))f.yl.Uf(c,b,d,h,a,q,e,k);else{var C=Math.sqrt(1-b);c=a/c;f.C.Ck(1,b,h,0,0,w,D,x);l[0]=w.j;l[1]=D.j;l[2]=D.j;z[0]=0;z[1]=0;z[2]=-1*b*f.C.n(1,b,h)*Math.sin(h);w=f.C.n(1,b,h);D=f.C.da(1.570796326794897-q);x=Math.sin(D);a=Math.cos(h);h=Math.sin(h);n[0]=w*a-h*x;n[1]=Math.cos(D);n[2]=(1-b)*w*h+a*x;0>q?f.C.Nr(z,n,l,r,0):f.C.Nr(z,l,n,r,0);l=Math.acos(r[2]/1);r=Math.atan2(-r[1],-r[0]);
h=1-b;n=Math.tan(l);D=1+n*n/h;w=2*z[2]*n/h;n=Math.sqrt(w*w-4*D*(z[2]*z[2]/h-1));D*=2;h=(-w+n)/D;w=(-w-n)/D;n=Math.tan(l);D=n*h+z[2];l=(h+w)/2;z=(D+(n*w+z[2]))/2;n=f.C.Sp(h-l,D-z);C=z/C*1.570796326794897;for(h=0;100>h;h++){w=f.C.Cm(b,C);w=w*w/Math.cos(C)*(Math.sin(C)-z*w/(1*(1-b)));if(f.l.wd(w))break;C-=w}C=f.C.n(1,b,C)*Math.cos(C);C=Math.sqrt((C-l)*(C+l));z=1-n/C;z*=2-z;u=Math.acos(f.C.Du(u,v)/(f.C.fo(u)*f.C.fo(v)));u*=f.l.Ab(1,v[0]);q=(f.C.q(C,z,f.C.hk(z,u))+c*f.l.Ab(1,q))/f.C.Yg(C,z);q=f.C.da(1.570796326794897*
q);q=f.C.xp(z,q);f.C.n(C,z,q);n=f.C.da(r+d);d=Math.cos(n);q=Math.sin(n);p[0]=g[0]*d+g[1]*-q;p[1]=g[0]*q+g[1]*d;p[2]=g[2];f.C.iQ(b,p[0],p[1],p[2],m,A,t);null!=e&&(e.j=A.j);null!=k&&(k.j=m.j)}};return a}();f.UD=a})(C||(C={}));(function(f){var a=function(){function b(b){this.ab=null;this.lu=new f.b;this.mu=new f.b;this.a=b}b.prototype.compare=function(b,d,c){this.a.Nc(d,this.lu);this.a.Nc(b.ja(c),this.mu);return this.lu.compare(this.mu)};return b}(),e=function(){function b(b){this.cg=new f.b;this.fl=
new f.b;this.a=b}b.prototype.Yh=function(b){this.cg.L(b)};b.prototype.compare=function(b,d){this.a.Nc(b.ja(d),this.fl);return this.cg.compare(this.fl)};return b}(),c=function(b){function d(d){b.call(this,d.a,d.ta,!1);this.bb=d}N(d,b);d.prototype.compare=function(b,d,c){if(this.Ng)return-1;var h=this.bb.ge.yo(this.bb.ri(d));b=b.ja(c);var f=this.bb.ge.yo(this.bb.ri(b));this.sn=c;return this.WF(d,h,b,f)};return d}(f.eE),b=function(b){function d(d){b.call(this,d.a,d.ta);this.bb=d}N(d,b);d.prototype.compare=
function(b,d){if(this.Ng)return-1;b=this.bb.ge.yo(this.bb.ri(b.ja(d)));this.sn=d;return this.XF(d,b)};return d}(f.$N),d=function(){function d(){this.Tc=this.Hf=this.Xo=this.ge=this.Gh=this.Pd=this.ib=this.a=null;this.ih=!1;this.Th=this.Bn=this.Fe=this.hl=this.Ih=this.cl=this.gg=this.we=null;this.Vh=this.yr=this.zB=this.ta=0;this.Jw=this.Lo=!1;this.mp=new f.b;this.oj=new f.b;this.ib=new f.ad(8);this.Pd=new f.ad(5);this.Gh=new f.Ku;this.ge=new f.Ku;this.ih=!1;this.Th=new f.b;this.Th.ka(0,0);this.ta=
0;this.Vh=-1;this.Lo=!1;this.a=null;this.Hf=new f.tk;this.Tc=new f.tk;this.Ih=new f.ia(0);this.hl=new f.cE;this.gg=new f.ia(0);this.cl=new f.ia(0);this.Xo=new f.Wa}d.prototype.HY=function(b,d){var c=new f.Hd;c.wC();b.Xc(c);this.Xr(b);this.Lo=!1;this.ta=d;this.zB=d*d;d=this.FC();b.Xc(c);d||(this.kS(),d||this.FC());-1!=this.Vh&&(this.a.ke(this.Vh),this.Vh=-1);this.a=null;return this.Lo};d.prototype.LY=function(b,d){this.Xr(b);this.Lo=!1;this.ta=d;this.zB=d*d;this.ih=!1;this.FC();this.ih||(this.ih=1==
b.zq(d,!0,!1));-1!=this.Vh&&(this.a.ke(this.Vh),this.Vh=-1);this.a=null};d.prototype.Jg=function(b,d){return this.ib.S(b,0+d)};d.prototype.kC=function(b,d,c){this.ib.P(b,0+d,c)};d.prototype.ri=function(b){return this.ib.S(b,2)};d.prototype.TX=function(b,d){this.ib.P(b,2,d)};d.prototype.bH=function(b,d){return this.ib.S(b,3+d)};d.prototype.Jq=function(b){return this.ib.S(b,7)};d.prototype.um=function(b,d){this.ib.P(b,7,d)};d.prototype.Kq=function(b,d){return this.ib.S(b,3+this.Iq(b,d))};d.prototype.Yr=
function(b,d,c){this.ib.P(b,3+this.Iq(b,d),c)};d.prototype.FT=function(b,d){return this.ib.S(b,5+this.Iq(b,d))};d.prototype.$r=function(b,d,c){this.ib.P(b,5+this.Iq(b,d),c)};d.prototype.Ms=function(b){return this.Pd.S(b,0)};d.prototype.QX=function(b,d){this.Pd.P(b,0,d)};d.prototype.Lz=function(b){return this.Pd.S(b,4)};d.prototype.Ur=function(b,d){this.Pd.P(b,4,d)};d.prototype.Nl=function(b){return this.Pd.S(b,1)};d.prototype.bo=function(b,d){this.Pd.P(b,1,d)};d.prototype.Kz=function(b){return this.Pd.S(b,
3)};d.prototype.su=function(b,d){this.Pd.P(b,3,d)};d.prototype.Nn=function(b){var d=this.Pd.Pe(),c=this.Gh.mi();this.QX(d,c);-1!=b?(this.Gh.addElement(c,b),this.a.Va(b,this.Vh,d),this.Ur(d,this.a.Za(b))):this.Ur(d,-1);return d};d.prototype.CR=function(b){this.Pd.kd(b)};d.prototype.$E=function(b,d){this.Gh.addElement(this.Ms(b),d);this.a.Va(d,this.Vh,b)};d.prototype.bu=function(b){var d=this.ib.Pe(),c=this.ge.mi();this.TX(d,c);-1!=b&&this.ge.addElement(c,b);return d};d.prototype.aF=function(b,d){this.ge.addElement(this.ri(b),
d)};d.prototype.Iv=function(b){this.ib.kd(b);b=this.Ih.Nv(b);0<=b&&this.Ih.GJ(b)};d.prototype.Jj=function(b,d){if(-1==this.Jg(b,0))this.kC(b,0,d);else if(-1==this.Jg(b,1))this.kC(b,1,d);else throw f.f.ya();this.Qy(b,d)};d.prototype.Qy=function(b,d){var c=this.Nl(d);if(-1!=c){var h=this.Kq(c,d);this.$r(h,d,b);this.Yr(b,d,h);this.Yr(c,d,b);this.$r(b,d,c)}else this.$r(b,d,b),this.Yr(b,d,b),this.bo(d,b)};d.prototype.Iq=function(b,d){return this.Jg(b,0)==d?0:1};d.prototype.Mn=function(b,d){var c=this.Kz(d);
-1!=c&&(this.Hf.Ld(c,-1),this.su(d,-1));var h,c=this.Nl(d);if(-1!=c){var f=h=c,a;do{a=!1;var l=this.Iq(h,d),q=this.bH(h,l);if(this.Jg(h,l+1&1)==b){this.Jv(h);this.ge.zh(this.ri(h));this.Iv(h);if(h==q){c=-1;break}c==h&&(c=this.Nl(d),f=q,a=!0)}h=q}while(h!=f||a);if(-1!=c){do l=this.Iq(h,d),q=this.bH(h,l),this.kC(h,l,b),h=q;while(h!=f);h=this.Nl(b);-1!=h?(f=this.Kq(h,b),a=this.Kq(c,b),f==h?(this.bo(b,c),this.Qy(h,b),this.bo(b,h)):a==c&&this.Qy(c,b),this.Yr(c,b,f),this.$r(f,b,c),this.Yr(h,b,a),this.$r(a,
b,h)):this.bo(b,c)}}c=this.Ms(b);h=this.Ms(d);for(f=this.Gh.xc(h);-1!=f;f=this.Gh.nb(f))this.a.Va(this.Gh.ja(f),this.Vh,b);this.Gh.lz(c,h);this.CR(d)};d.prototype.SV=function(b,d){var c=this.Jg(b,0),h=this.Jg(b,1),f=this.Jg(d,0),a=this.Jg(d,1);this.ge.lz(this.ri(b),this.ri(d));d==this.Nl(c)&&this.bo(c,b);d==this.Nl(h)&&this.bo(h,b);this.Jv(d);this.Iv(d);c==f&&h==a||h==f&&c==a||(this.wo(c,this.mp),this.wo(f,this.oj),this.mp.ub(this.oj)?(c!=f&&this.Mn(c,f),h!=a&&this.Mn(h,a)):(h!=f&&this.Mn(h,f),c!=
a&&this.Mn(c,a)))};d.prototype.Jv=function(b){var d=this.Jg(b,1);this.kG(b,this.Jg(b,0));this.kG(b,d)};d.prototype.kG=function(b,d){var c=this.Kq(b,d),h=this.FT(b,d),f=this.Nl(d);c!=b?(this.Yr(h,d,c),this.$r(c,d,h),f==b&&this.bo(d,c)):this.bo(d,-1)};d.prototype.hF=function(b,d,c){var h=this.ge.xc(b),f=this.ge.ja(h);b=this.jf(f);var a=this.jf(this.a.U(f));this.a.as(f,d,c,!0);for(h=this.ge.nb(h);-1!=h;h=this.ge.nb(h)){var f=this.ge.ja(h),l=this.jf(f)==b;this.a.as(f,d,c,l)}h=d.Mq(c,0).ec();d=d.Mq(c,
d.Rl(c)-1).Cc();this.rL(b,h);this.rL(a,d)};d.prototype.dG=function(b,d,c){var h=this.ri(b),f=this.Jg(b,0),a=this.Jg(b,1),l=this.bu(-1);this.Ih.add(l);this.um(l,-3);this.gg.add(l);this.Jj(l,f);b=1;for(d=d.Rl(c);b<d;b++)c=this.Nn(-1),this.cl.add(c),this.gg.add(c),this.Jj(l,c),l=this.bu(-1),this.Ih.add(l),this.um(l,-3),this.gg.add(l),this.Jj(l,c);this.Jj(l,a);for(h=this.ge.xc(h);-1!=h;h=this.ge.nb(h))if(a=this.ge.ja(h),this.jf(a)==f){b=0;do 0<b&&(l=this.gg.get(b-1),this.$E(l,a),-1==this.Lz(l)&&this.Ur(l,
this.a.Za(a))),l=this.gg.get(b),b+=2,this.aF(l,a),a=this.a.U(a);while(b<this.gg.size)}else{b=this.gg.size-1;do b<this.gg.size-2&&(l=this.gg.get(b+1),this.$E(l,a),0>this.Lz(l)&&this.Ur(l,this.a.Za(a))),l=this.gg.get(b),b-=2,this.aF(l,a),a=this.a.U(a);while(0<=b)}this.gg.clear(!1)};d.prototype.jf=function(b){return this.a.Sa(b,this.Vh)};d.prototype.KJ=function(b,d,c){var h=this.Jg(d,0),a=new f.b;this.wo(h,a);var l=new f.b,q=this.Jg(d,1);this.wo(q,l);var e=c.Rl(b),k=c.Mq(b,0),v=new f.b;k.Oq(v);if(!a.ub(v)){if(!this.ih){var p=
a.compare(this.Th),v=v.compare(this.Th);0>p*v&&(this.ih=!0)}this.GG(h,this.gg);this.cl.add(h)}!this.ih&&1<e&&(p=a.compare(l),k=k.Cc(),a.compare(k)!=p||k.compare(l)!=p?this.ih=!0:0>k.compare(this.Th)&&(this.ih=!0));k=c.Mq(b,e-1);b=k.Cc();l.ub(b)||(this.ih||(p=l.compare(this.Th),v=b.compare(this.Th),0>p*v&&(this.ih=!0)),this.GG(q,this.gg),this.cl.add(q));this.gg.add(d);l=0;for(q=this.gg.size;l<q;l++)b=this.gg.get(l),c=this.Jq(b),f.ad.AA(c)&&(this.Tc.Ld(c,-1),this.um(b,-1)),b!=d&&-3!=this.Jq(b)&&(this.Ih.add(b),
this.um(b,-3));this.gg.clear(!1)};d.prototype.nQ=function(b,d){this.we.compare(this.Tc,this.Tc.ja(b),d);this.we.Ng&&(this.we.Fs(),this.xG(b,d))};d.prototype.xG=function(b,d){this.Lo=!0;b=this.Tc.ja(b);d=this.Tc.ja(d);var c,h;h=this.ge.yo(this.ri(b));var a=this.ge.yo(this.ri(d));c=this.a.ic(h);null==c&&(null==this.Fe&&(this.Fe=new f.Hb),this.a.pd(h,this.Fe),c=this.Fe);h=this.a.ic(a);null==h&&(null==this.Bn&&(this.Bn=new f.Hb),this.a.pd(a,this.Bn),h=this.Bn);this.hl.Ap(c);this.hl.Ap(h);this.hl.Ma(this.ta,
!0)&&(this.ih=!0);this.XK(b,d,-1,this.hl);this.hl.clear()};d.prototype.wS=function(b,d){this.Lo=!0;d=this.Tc.ja(d);var c,h=this.ge.yo(this.ri(d));c=this.a.ic(h);null==c&&(null==this.Fe&&(this.Fe=new f.Hb),this.a.pd(h,this.Fe),c=this.Fe);h=this.MG(b);this.hl.Ap(c);this.a.wj(h,this.Xo);this.hl.rA(this.ta,this.Xo,!0);this.XK(d,-1,b,this.hl);this.hl.clear()};d.prototype.rU=function(){if(0!=this.Ih.size)for(;0!=this.Ih.size;){if(this.Ih.size>Math.max(100,this.a.ud)){this.Ih.clear(!1);this.ih=!0;break}var b=
this.Ih.Fc();this.Ih.Pf();this.um(b,-1);-1!=this.OU(b)&&this.qU(b);this.Ko=!1}};d.prototype.qU=function(b){var d;this.Ko?(d=this.Tc.iv(this.ZI,this.VI,b,!0),this.Ko=!1):d=this.Tc.ZE(b);-1==d?this.SV(this.Tc.ja(this.Tc.PG()),b):(this.um(b,d),this.we.Ng&&(this.we.Fs(),this.xG(this.we.sn,d)))};d.prototype.OU=function(b){var d=this.Jg(b,0);b=this.Jg(b,1);this.wo(d,this.mp);this.wo(b,this.oj);if(f.b.sc(this.mp,this.oj)<=this.zB)return this.ih=!0,-1;var c=this.mp.compare(this.Th),h=this.oj.compare(this.Th);
return 0>=c&&0<h?b:0>=h&&0<c?d:-1};d.prototype.iS=function(){var b=new f.ia(0);b.yb(this.a.ud);for(var d=this.a.Pr(),c=d.next();-1!=c;c=d.next())-1!=this.a.Sa(c,this.Vh)&&b.add(c);this.a.Wx(b,b.size);this.jS(b)};d.prototype.jS=function(b){this.Hf.clear();this.Hf.Qe(b.size);this.Hf.Ep(new a(this.a));var d=new f.b;d.$c();for(var c=-1,h=new f.b,l=0,e=b.size;l<e;l++){var k=b.get(l);this.a.Nc(k,h);h.ub(d)?(k=this.a.Sa(k,this.Vh),this.Mn(c,k)):(c=this.jf(k),this.a.Nc(k,d),k=this.Hf.ro(k),this.su(c,k))}};
d.prototype.kS=function(){var b=new f.ia(0);b.yb(this.a.ud);for(var d=this.Hf.xc(-1);-1!=d;d=this.Hf.nb(d))b.add(this.Hf.ja(d));this.Hf.clear();this.a.Wx(b,b.size);for(var d=0,c=b.size;d<c;d++){var h=b.get(d),a=this.jf(h),h=this.Hf.ro(h);this.su(a,h)}};d.prototype.GG=function(b,d){var c=this.Nl(b);if(-1!=c){var h=c;do f.ad.AA(this.Jq(h))&&d.add(h),h=this.Kq(h,b);while(h!=c)}};d.prototype.rL=function(b,d){for(b=this.Gh.xc(this.Ms(b));-1!=b;b=this.Gh.nb(b))this.a.Qf(this.Gh.ja(b),d)};d.prototype.XK=
function(b,d,c,h){this.Jv(b);-1!=d&&this.Jv(d);this.KJ(0,b,h);-1!=d&&this.KJ(1,d,h);-1!=c&&(h.cg.w(this.mp),this.wo(c,this.oj),this.oj.ub(this.mp)||this.cl.add(c));c=0;for(var f=this.cl.size;c<f;c++){var a=this.cl.get(c),l=this.Kz(a);-1!=l&&(this.Hf.Ld(l,-1),this.su(a,-1))}c=this.ri(b);f=-1!=d?this.ri(d):-1;this.hF(c,h,0);-1!=d&&this.hF(f,h,1);this.dG(b,h,0);-1!=d&&this.dG(d,h,1);this.ge.zh(c);this.Iv(b);-1!=d&&(this.ge.zh(f),this.Iv(d));c=0;for(f=this.cl.size;c<f;c++)a=this.cl.get(c),a==this.yr&&
(this.Jw=!0),l=this.Kz(a),-1==l&&(l=this.Hf.ZE(this.MG(a)),-1==l?(b=this.jf(this.Hf.ja(this.Hf.PG())),this.Mn(b,a)):this.su(a,l));this.cl.clear(!1)};d.prototype.wo=function(b,d){this.a.oH(this.Lz(b),d)};d.prototype.MG=function(b){return this.Gh.yo(this.Ms(b))};d.prototype.FC=function(){this.Jw=!1;this.yr=-1;null==this.we&&(this.Tc.Cw=!1,this.we=new c(this),this.Tc.Oo=this.we);var d=new f.ia(0),h=null,a=null,k=0;this.VI=this.ZI=-1;this.Ko=!1;for(var p=this.Hf.xc(-1);-1!=p;){k++;this.Ko=!1;var g=this.Hf.ja(p);
this.yr=this.jf(g);this.a.Nc(g,this.Th);this.we.PK(this.Th.y,this.Th.x);var n,u=this.Nl(this.yr);n=-1==u;if(!n){g=u;do{var z=this.Jq(g);-1==z?(this.Ih.add(g),this.um(g,-3)):-3!=z&&d.add(z);g=this.Kq(g,this.yr)}while(g!=u)}if(0<d.size){this.Ko=1==d.size&&1==this.Ih.size;n=0;for(u=d.size;n<u;n++)g=this.Tc.ja(d.get(n)),this.um(g,-2);var r=-2,t=-2;n=0;for(u=d.size;n<u;n++){z=d.get(n);if(-2==r){var A=this.Tc.Ve(z);-1!=A?(g=this.Tc.ja(A),g=this.Jq(g),-2!=g&&(r=A)):r=-1}-2==t&&(z=this.Tc.nb(z),-1!=z?(g=
this.Tc.ja(z),g=this.Jq(g),-2!=g&&(t=z)):t=-1);if(-2!=r&&-2!=t)break}n=0;for(u=d.size;n<u;n++)z=d.get(n),g=this.Tc.ja(z),this.Tc.Ld(z,-1),this.um(g,-1);d.clear(!1);this.ZI=-1!=r?r:-1;this.VI=-1!=t?t:-1;-1!=r&&-1!=t?this.Ko||this.nQ(r,t):-1==r&&-1==t&&(this.Ko=!1)}else n&&(null==h&&(h=new b(this)),h.Yh(this.Th),this.Tc.kK(h),h.Ng&&(h.Fs(),this.wS(this.yr,h.sn)));this.rU();this.Jw?(this.Jw=!1,null==a&&(a=new e(this.a)),a.Yh(this.Th),p=this.Hf.kK(a)):p=this.Hf.nb(p)}return this.Lo};d.prototype.Xr=function(b){this.a=
b;this.Vh=this.a.Vd();this.ib.Qe(b.ud+32);this.Pd.Qe(b.ud);this.Gh.ou(b.ud);this.Gh.Wn(b.ud);this.ge.ou(b.ud+32);this.ge.Wn(b.ud+32);for(b=this.a.rd;-1!=b;b=this.a.Ue(b))if(f.T.Ic(this.a.hc(b)))for(k=this.a.Pb(b);-1!=k;k=this.a.Sb(k)){var d=this.a.Ka(k),c=this.a.cb(k),h=this.Nn(c),a=this.bu(c);this.Jj(a,h);p=this.a.U(c);c=0;for(d-=2;c<d;c++){var l=this.a.U(p),e=this.Nn(p);this.Jj(a,e);a=this.bu(p);this.Jj(a,e);p=l}this.a.Qb(k)?(e=this.Nn(p),this.Jj(a,e),a=this.bu(p),this.Jj(a,e),this.Jj(a,h)):(e=
this.Nn(p),this.Jj(a,e))}else for(var k=this.a.Pb(b);-1!=k;k=this.a.Sb(k))for(var p=this.a.cb(k),h=0,d=this.a.Ka(k);h<d;h++)this.Nn(p),p=this.a.U(p);this.iS()};return d}();f.VD=d})(C||(C={}));(function(f){var a=function(a){function c(b,d,h){a.call(this);if(void 0!==b)if(void 0!==h){this.description=f.ye.Ig();var l=new f.qd;l.I(b,d,h);this.AC(l)}else if(void 0!==d)this.description=f.ye.Ig(),this.rb(b,d);else if(b instanceof f.na)this.description=b;else if(b instanceof f.b)this.description=f.ye.Ig(),
this.rb(b);else if(b instanceof c)this.description=b.description,this.rb(b.Be(),b.nf()),null!==b.la&&(this.la=b.la.slice(0));else throw f.f.F();else this.description=f.ye.Ig()}N(c,a);c.prototype.w=function(b){if(void 0!==b){if(this.Hc())throw f.f.X("This operation should not be performed on an empty geometry.");b.ka(this.la[0],this.la[1])}else{if(this.Hc())throw f.f.X("This operation should not be performed on an empty geometry.");b=new f.b;b.ka(this.la[0],this.la[1]);return b}};c.prototype.rb=function(b,
d){"number"===typeof b?(this.Bc(),null==this.la&&this.nq(),this.la[0]=b,this.la[1]=d):(this.Bc(),this.rb(b.x,b.y))};c.prototype.kA=function(){if(this.Hc())throw f.f.X("This operation should not be performed on an empty geometry.");var b=new f.qd;b.x=this.la[0];b.y=this.la[1];this.description.tH()?b.z=this.la[2]:b.z=f.na.pe(1);return b};c.prototype.AC=function(b){this.Bc();var d=this.hasAttribute(1);d||f.na.OH(1,b.z)||(this.Ud(1),d=!0);null==this.la&&this.nq();this.la[0]=b.x;this.la[1]=b.y;d&&(this.la[2]=
b.z)};c.prototype.Be=function(){if(this.Hc())throw f.f.X("This operation should not be performed on an empty geometry.");return this.la[0]};c.prototype.zC=function(b){this.setAttribute(0,0,b)};c.prototype.nf=function(){if(this.Hc())throw f.f.X("This operation should not be performed on an empty geometry.");return this.la[1]};c.prototype.QK=function(b){this.setAttribute(0,1,b)};c.prototype.qH=function(){return this.Yc(1,0)};c.prototype.qY=function(b){this.setAttribute(1,0,b)};c.prototype.$G=function(){return this.Yc(2,
0)};c.prototype.aY=function(b){this.setAttribute(2,0,b)};c.prototype.yc=function(){return this.JG(3,0)};c.prototype.AK=function(b){this.setAttribute(3,0,b)};c.prototype.Yc=function(b,d){var c=this.description.mg(b);return 0<=c?this.la[this.description.wk(c)+d]:f.na.pe(b)};c.prototype.JG=function(b,d){var c=this.description.mg(b);return 0<=c?this.la[this.description.wk(c)+d]:f.na.pe(b)};c.prototype.setAttribute=function(b,d,c){this.Bc();var h=this.description.mg(b);0>h&&(this.Ud(b),h=this.description.mg(b));
null==this.la&&this.nq();this.la[this.description.wk(h)+d]=c};c.prototype.G=function(){return 33};c.prototype.tb=function(){return 0};c.prototype.Oa=function(){this.Bc();null!=this.la&&(this.la[0]=NaN,this.la[1]=NaN)};c.prototype.mo=function(b){if(null!=this.la){for(var d=f.ye.ux(b,this.description),c=[],a=0,q=0,e=b.Ea;q<e;q++){var k=b.zd(q),p=f.na.Xa(k);if(-1==d[q])for(var g=f.na.pe(k),k=0;k<p;k++)c[a]=g,a++;else for(g=this.description.wk(d[q]),k=0;k<p;k++)c[a]=this.la[g],a++,g++}this.la=c}this.description=
b};c.prototype.nq=function(){this.aK(this.description.af.length);c.Bb(this.description.af,this.la,this.description.af.length);this.la[0]=NaN;this.la[1]=NaN};c.prototype.Xc=function(b){if(b instanceof f.Hd){if(!this.Hc()){var d=this.w();b.$h(d,d);this.rb(d)}}else this.Hc()||(this.Ud(1),d=this.kA(),this.AC(b.Rp(d)))};c.prototype.copyTo=function(b){if(33!=b.G())throw f.f.F();b.Bc();null==this.la?(b.Oa(),b.la=null,b.Fg(this.description)):(b.Fg(this.description),b.aK(this.description.af.length),c.Bb(this.la,
b.la,this.description.af.length))};c.prototype.Ja=function(){return new c(this.description)};c.prototype.u=function(){return this.Hc()};c.prototype.Hc=function(){return null==this.la||isNaN(this.la[0])||isNaN(this.la[1])};c.prototype.Rn=function(b){b.Oa();this.description!=b.description&&b.Fg(this.description);b.Nb(this)};c.prototype.s=function(b){this.Hc()?b.Oa():(b.o=this.la[0],b.A=this.la[1],b.v=this.la[0],b.B=this.la[1])};c.prototype.Cp=function(b){if(this.Hc())b.Oa();else{var d=this.kA();b.o=
d.x;b.A=d.y;b.Bf=d.z;b.v=d.x;b.B=d.y;b.$g=d.z}};c.prototype.xf=function(b,d){var c=new f.Ac;if(this.Hc())return c.Oa(),c;b=this.Yc(b,d);c.ca=b;c.ha=b;return c};c.prototype.aK=function(b){if(null==this.la)this.la=f.J.gf(b);else if(this.la.length<b){for(var d=this.la.slice(0),c=this.la.length;c<b;c++)d[c]=0;this.la=d}};c.Bb=function(b,d,c){if(0<c)for(c=0;c<b.length;c++)d[c]=b[c]};c.prototype.Eb=function(b){if(b==this)return!0;if(!(b instanceof c)||this.description!=b.description)return!1;if(this.Hc())return b.Hc()?
!0:!1;for(var d=0,h=this.description.af.length;d<h;d++)if(this.la[d]!=b.la[d])return!1;return!0};c.prototype.jc=function(){var b=this.description.jc();if(!this.Hc())for(var d=0,c=this.description.af.length;d<c;d++)var a=this.la[d],a=f.J.truncate(a^a>>>32),b=f.J.dh(a,b);return b};c.prototype.Gg=function(){return null};return c}(f.T);f.Wa=a})(C||(C={}));(function(f){var a=function(){function f(c,b,d){void 0!==c&&(this.x=c,this.y=b,this.z=d)}f.pa=function(c,b,d){var h=new f;h.x=c;h.y=b;h.z=d;return h};
f.prototype.I=function(c,b,d){this.x=c;this.y=b;this.z=d};f.prototype.Ux=function(){this.z=this.y=this.x=0};f.prototype.normalize=function(){var c=this.length();0==c&&(this.x/=c,this.y/=c,this.z/=c)};f.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};f.prototype.sub=function(c){return new f(this.x-c.x,this.y-c.y,this.z-c.z)};f.prototype.Vg=function(c){return new f(this.x*c,this.y*c,this.z*c)};f.prototype.cv=function(){this.x=NaN};f.prototype.Gy=function(){return isNaN(this.x)};
f.prototype.oi=function(c){return this.x*c.x+this.y*c.y+this.z*c.z};return f}();f.qd=a})(C||(C={}));(function(f){var a=function(){function a(c,b,d){this.sx=this.cx=null;this.tg=b;this.CV=b.y-d;this.BV=b.y+d;this.Hr=0;this.LA=c;this.ta=d;this.OV=d*d;this.MA=0!=d;this.xw=!1}a.prototype.result=function(){return 0!=this.Hr?1:0};a.prototype.WO=function(c){c=c.gc(c.oe(this.tg,!1));return f.b.sc(c,this.tg)<=this.OV?!0:!1};a.prototype.nG=function(c){if(!this.MA&&(this.LA&&this.tg.ub(c.ec())||this.tg.ub(c.Cc())))this.xw=
!0;else if(c.ra==this.tg.y&&c.ra==c.oa){if(this.LA&&!this.MA){var b=Math.max(c.ua,c.sa);this.tg.x>Math.min(c.ua,c.sa)&&this.tg.x<b&&(this.xw=!0)}}else{var d=!1,b=Math.max(c.ua,c.sa);this.tg.x>b?d=!0:this.tg.x>=Math.min(c.ua,c.sa)&&(d=0<c.Sq(!0,this.tg.y,this.sx,null)&&this.sx[0]<=this.tg.x);if(d){if(this.tg.y==c.ec().y){if(this.tg.y<c.Cc().y)return}else if(this.tg.y==c.Cc().y&&this.tg.y<c.ec().y)return;this.Hr=this.LA?this.Hr^1:this.Hr+(c.ec().y>c.Cc().y?1:-1)}}};a.prototype.ju=function(c){var b=
c.xf(0,1);if(b.ca>this.BV||b.ha<this.CV)return!1;if(this.MA&&this.WO(c))return!0;if(b.ca>this.tg.y||b.ha<this.tg.y)return!1;null==this.cx&&(this.cx=[null,null,null,null,null]);null==this.sx&&(this.sx=[0,0,0]);b=c.pH(this.cx);if(0<b)for(c=0;c<b;c++){var d=this.cx[c].get();this.nG(d);if(this.xw)return!0}else if(this.nG(c),this.xw)return!0;return!1};a.$=function(c,b,d){b=new a(0==c.xo(),b,d);for(c=c.Da();c.Ya();)for(;c.Ca();)if(d=c.ba(),b.ju(d))return-1;return b.result()};a.bd=function(c,b,d,h){var l=
new f.h;c.ac(l);l.O(h,h);var q=new a(0==c.xo(),d,h);c=c.Da();var e=new f.h;e.I(l);e.v=d.x+h;e.A=d.y-h;e.B=d.y+h;d=b.Wz(e,h);for(h=d.next();-1!=h;h=d.next())if(c.Tb(b.ja(h)),c.Ca()&&(h=c.ba(),q.ju(h)))return-1;return q.result()};a.ln=function(c,b,d){if(c.u())return 0;var h=new f.h;c.ac(h);h.O(d,d);if(!h.contains(b))return 0;h=c.ob;if(null!=h){var l=h.Hi;if(null!=l){l=l.rm(b.x,b.y);if(1==l)return 1;if(0==l)return 0}h=h.Mb;if(null!=h)return a.bd(c,h,b,d)}return a.$(c,b,d)};a.VU=function(c,b,d,h){if(c.u())return 0;
var l=new f.h;c.ac(l);l.O(h,h);if(!l.contains(b,d))return 0;l=c.ob;if(null!=l&&(l=l.Hi,null!=l)){l=l.rm(b,d);if(1==l)return 1;if(0==l)return 0}return a.$(c,f.b.pa(b,d),h)};a.UU=function(c,b,d){return b.u()?0:a.ln(c,b.w(),d)};a.xA=function(c,b,d,h,l){var q=new f.h;c.ac(q);q.O(h,h);if(!q.contains(d))return 0;var e=new a(!0,d,h);if(null!=l){var k=new f.h;k.I(q);k.v=d.x+h;k.A=d.y-h;k.B=d.y+h;c=c.Da();h=l.Wz(k,h);for(k=h.next();-1!=k;k=h.next())if(c.Tb(l.ja(k),b),c.Ca()&&c.Ta==b&&(k=c.ba(),e.ju(k)))return-1}else if(c=
c.Da(),c.dC(b),c.Ya())for(;c.Ca();)if(k=c.ba(),e.ju(k))return-1;return e.result()};a.wA=function(c,b,d){var h=new f.h;c.ac(h);h.O(d,d);if(!h.contains(b))return 0;b=new a(!1,b,d);for(d=c.Da();d.Ya();)if(!(0>c.Tm(d.Ta))){for(b.Hr=0;d.Ca();)if(h=d.ba(),b.ju(h))return-1;if(0!=b.Hr)return 1}return b.result()};a.Oi=function(c,b,d,h,l){var q=c.Da();q.dC(b);if(!q.Ya()||!q.Ca())throw f.f.X("corrupted geometry");for(b=2;2==b&&q.Ca();)b=q.ba().gc(.5),b=a.xA(c,d,b,h,l);if(2==b)throw f.f.X("internal error");return 1==
b?!0:!1};a.qm=function(c,b){c=c.D();return 16>c?!1:2*c+Math.log(c)/Math.log(2)*1*b<1*c*b};return a}();f.ff=a})(C||(C={}));(function(f){var a=function(f){function c(b){f.call(this,!0,b)}N(c,f);c.prototype.Ja=function(){return new c(this.description)};c.prototype.tb=function(){return 2};c.prototype.G=function(){return 1736};c.prototype.JH=function(b,d,c){this.DU(b,d,c)};c.prototype.fT=function(){this.xT()};return c}(f.xl);f.Ia=a})(C||(C={}));(function(f){(function(f){f[f.PiPOutside=0]="PiPOutside";
f[f.PiPInside=1]="PiPInside";f[f.PiPBoundary=2]="PiPBoundary"})(f.GN||(f.GN={}));var a=function(){function a(){}a.VH=function(c,b,d){c=f.ff.UU(c,b,d);return 0==c?0:1==c?1:2};a.fe=function(c,b,d){c=f.ff.ln(c,b,d);return 0==c?0:1==c?1:2};a.bX=function(c,b,d,h){c=f.ff.VU(c,b,d,h);return 0==c?0:1==c?1:2};a.l_=function(c,b,d,h){return 0==f.ff.xA(c,b,d,h,null)?0:1};a.wA=function(c,b,d){return 0==f.ff.wA(c,b,d)?0:1};a.LR=function(c,b,d,h,l){if(b.length<d||l.length<d)throw f.f.F();for(var q=0;q<d;q++)l[q]=
a.fe(c,b[q],h)};a.WR=function(c,b,d,h,l){if(b.length/2<d||l.length<d)throw f.f.F();for(var q=0;q<d;q++)l[q]=a.bX(c,b[2*q],b[2*q+1],h)};a.eL=function(c,b,d,h,l){if(1736==c.G())a.LR(c,b,d,h,l);else if(197==c.G()){var q=new f.h;c.s(q);a.MM(q,b,d,h,l)}else throw f.f.X("invalid_call");};a.u_=function(c,b,d,h,l){if(1736==c.G())a.WR(c,b,d,h,l);else if(197==c.G()){var q=new f.h;c.s(q);a.QM(q,b,d,h,l)}else throw f.f.La();};a.MM=function(c,b,d,h,a){if(b.length<d||a.length<d)throw f.f.F();if(c.u())for(h=0;h<
d;h++)a[h]=0;else for(c.O(.5*-h,.5*-h),c.O(.5*h,.5*h),h=0;h<d;h++)c.contains(b[h])?a[h]=1:c.contains(b[h])?a[h]=2:a[h]=0};a.QM=function(c,b,d,h,a){if(b.length/2<d||a.length<d)throw f.f.F();if(c.u())for(h=0;h<d;h++)a[h]=0;else for(c.O(.5*-h,.5*-h),c.O(.5*h,.5*h),h=0;h<d;h++)c.contains(b[2*h],b[2*h+1])?a[h]=1:c.contains(b[2*h],b[2*h+1])?a[h]=2:a[h]=0};a.YT=function(c,b,d,h,f){for(var a=0;a<d;a++)f[a]=c.lt(b[a],h)?2:0};a.hS=function(c,b,d,h,f){var a=c.ob,l=null;null!=a&&(l=a.Hi);for(var a=d,e=0;e<d;e++)if(f[e]=
1,null!=l){var k=b[e];0==l.rm(k.x,k.y)&&(f[e]=0,a--)}if(0!=a)for(c=c.Da();c.Ya()&&0!=a;)for(;c.Ca()&&0!=a;)for(l=c.ba(),e=0;e<d&&0!=a;e++)1==f[e]&&l.lt(b[e],h)&&(f[e]=2,a--);for(e=0;e<d;e++)1==f[e]&&(f[e]=0)};a.fL=function(c,b,d,h,l){var q=c.G();if(1607==q)a.hS(c,b,d,h,l);else if(f.T.Oc(q))a.YT(c,b,d,h,l);else throw f.f.X("Invalid call.");};return a}();f.gd=a})(C||(C={}));(function(f){var a=function(f){function c(b,d){2==arguments.length?(f.call(this,!1,b.description),this.Rf(b),this.lineTo(d)):f.call(this,
!1,b)}N(c,f);c.prototype.Ja=function(){return new c(this.description)};c.prototype.tb=function(){return 1};c.prototype.G=function(){return 1607};c.prototype.JH=function(b,d,c,f){this.EU(b,d,c,f)};return c}(f.xl);f.Ua=a})(C||(C={}));(function(f){var a=function(){function f(){}f.$_=function(){};return f}();f.c_=a})(C||(C={}));(function(f){(function(b){b[b.clipWithInputHorizon=1]="clipWithInputHorizon";b[b.clipWithOutputHorizon=2]="clipWithOutputHorizon"})(f.dM||(f.dM={}));var a=function(){function b(){this.Jl=
3;this.sz=this.xv=NaN}b.prototype.aU=function(){return this.dt(1)};b.prototype.bU=function(){return this.dt(2)};b.prototype.dt=function(b){return 0!=(this.Jl&b)};b.prototype.Vf=function(){var d=new b;d.xv=this.xv;d.sz=this.sz;d.Jl=this.Jl;return d};return b}();f.NZ=a;(function(b){b[b.Dont_Geonomalize_Polygon=2147483648]="Dont_Geonomalize_Polygon";b[b.Dont_Adjust_At_Poles=1073741824]="Dont_Adjust_At_Poles"})(f.eM||(f.eM={}));var e=function(){function b(){this.Jl=0}b.prototype.dt=function(b){return 0!=
(this.Jl&b)};b.ne=function(d){var c=new b;c.Jl=d.Jl;return c};b.prototype.DO=function(b){this.Jl=b.Jl};return b}();f.OZ=e;var c=function(){function b(b,c,a){this.ie=b;this.He=c;this.rg=new f.h;this.rg.I(a);this.xV=b.jc()+c.jc()+this.rg.jc().toString()}b.prototype.jc=function(){return this.xV};b.prototype.Eb=function(b){return this==b||this.ie.Eb(b.ie)&&this.He.Eb(b.He)&&this.rg.Eb(b.rg)};return b}();f.d_=c;c=function(){function b(){this.He=this.ie=null;this.CI=new a;this.DI=new e;this.wr=this.ue=
null;this.rr=this.Tl=!0}b.Hs=function(d,c,f,a){var h;void 0===a&&(a=null);void 0===h&&(h=null);var l=new b;l.kq(d,c,f,a,h);return l};b.prototype.kq=function(b,c,a,q,e){if(null==b||null==c)throw f.f.X("invalidArgument");this.ie=b;this.He=c;this.rr=this.Tl=!1;null!=q&&(this.CI=q.Vf());null!=e&&this.DI.DO(e);e=!1;1==c.Fb()&&null!=q&&(q=q.xv,isNaN(q)||0==q||(e=!0));if(b==c)this.Tl=!e,this.rr=!0;else{q=b.Fb();var d=c.Fb();if(0==q||0==d){if(null!=a)throw f.f.F();null!=b.Od()&&null!=c.Od()&&(this.Tl=b.Od().Eb(c.Od()))}else 3==
q||3==d?this.Tl=b.Eb(c):this.ie.gU(this.He)?this.Tl=!e:this.Tl=!1,this.ue=a,null!=this.ue&&this.ue.Mp(),this.rr=(null==this.ue||0==this.ue.count())&&this.ie.kc().Eb(this.He.kc())}this.vL()};b.prototype.Vv=function(){var d=new b;d.ie=this.He;d.He=this.ie;null!=this.ue&&(d.ue=this.ue.Vv());d.Tl=this.Tl;d.rr=this.rr;d.vL();return d};b.prototype.Ho=function(){return this.Tl};b.prototype.dT=function(){return this.CI.Vf()};b.prototype.Eb=function(d){return d==this?!0:d instanceof b&&this.ie.Eb(d.ie)&&this.He.Eb(d.He)?
this.ue==d.ue?!0:null!=this.ue&&null!=d.ue&&this.ue.Eb(d.ue)?!0:!1:!1};b.prototype.vL=function(){this.wr=new f.ko(this)};b.t_={};return b}();f.qs=c})(C||(C={}));(function(f){var a=function(){function c(){}c.uq=function(b){return b*c.nO};c.Vx=function(b,d){return c.TN(d-b)};c.aO=function(b){if(-360<=b&&720>b)return 0>b?b+=360:360<=b&&(b-=360),b;b=f.Ub.fM(b);0>b&&(b+=360);return b};c.TN=function(b){b=c.aO(b);180<b&&(b-=360);return b};c.PZ=.0174532925199433;c.nO=57.29577951308232;return c}();f.ks=a;
var e=function(){function c(){}c.Mj=function(b,d){var c=new f.h;b.s(c);var a=f.fb.Bh(d),q=new f.h;q.I(a);q.o=c.o;q.v=c.v;q.O(.01*q.fa(),0);a=f.ma.be(d,c,!1);return q.contains(c)?b:f.me.clip(b,q,a,0)};c.gt=function(b,d,h,a,q){if(!f.fb.Jc(d))throw f.f.F();var l=f.ma.ah(d,b,!1),e=f.fb.Bh(d),k=f.fb.kc(d),p=k.Od().Ai,g=f.fb.gw(k),k=f.fb.Rv(k),g=g*(2-g),n=new f.Ac;e.Tn(n);var u=[[0,0],[0,0]];2==f.Td.Fb(d)?a?(u[0][0]=c.On(q,n),u[0][1]=e.Cq(),f.fb.ku(),e=u[0][0]*p):(u[0][0]=e.Gk(),u[0][1]=q,f.fb.ku(),e=u[0][1]*
p):e=q*p;if(!a&&0!=e)throw f.f.F();var z=new f.ea,r=new f.fd;b=r.Jb(b);for(var t=[0],A=new f.b,m=new f.b,w=new f.b,x=new f.b,C=new f.b,I=new f.b,J=r.Pb(b);-1!=J;J=r.Sb(J)){var K=r.cb(J);r.w(K,w);for(var y=!1,M=K=r.U(K);-1!=M;M=r.U(M)){if(M==K){if(y)break;y=!0}r.w(M,x);if(a&&l<q-w.x&&x.x-q>l||l<q-x.x&&w.x-q>l||!a&&l<-w.y&&x.y>l||l<-x.y&&w.y>l){do if(!(Math.abs(w.x-x.x)>=.5*n.N())){2==f.Td.Fb(d)?(u[0][0]=c.On(w.x,n),u[0][1]=w.y,u[1][0]=c.On(x.x,n),u[1][1]=x.y,f.fb.TW(),C.x=u[0][0]*p,C.y=u[0][1]*p,I.x=
u[1][0]*p,I.y=u[1][1]*p):(C.x=w.x*p,C.y=w.y*p,I.x=x.x*p,I.y=x.y*p);I.x=6.283185307179586*(x.x-w.x)/n.N()+C.x;if(a){if(m.x=e,m.y=c.DB(k,g,C,I,e,h),isNaN(m.y))break}else{m.x=c.BB(k,g,C,I,h);if(isNaN(m.x))break;m.y=0}f.mb.Md(k,g,C.x,C.y,I.x,I.y,z,null,null,h);var E=z.j;f.mb.Md(k,g,C.x,C.y,m.x,m.y,z,null,null,h);var O=z.j;2==f.Td.Fb(d)?(u[0][0]=m.x/p,u[0][1]=m.y/p,f.fb.SS(),a?(A.y=u[0][1],A.x=q):(A.x=c.Zp(u[0][0],w.x,x.x,n),A.y=q)):a?(A.x=q,A.y=m.y/p):(A.x=c.Zp(m.x/p,w.x,x.x,n),A.y=q);t[0]=0<E?f.J.nk(O/
E,0,1):.5;0!=t[0]&&1!=t[0]&&(E=r.Ra(M),r.zm(E,t,1),r.rb(r.U(E),A.x,A.y))}while(0)}w.L(x)}}return r.Se(b)};c.Ym=function(b,d,h,a,q){if(b.u())return b;var l=f.fb.de(d);return c.Aq(b,h-180*l,360*l,d,a,q,!0)};c.DB=function(b,d,h,a,q,e){if(3.141592653589793<=Math.abs(h.x-a.x)||!c.Cj(h.x,a.x,q))return NaN;var l;h.x>a.x?l=a:(l=h,h=a);a=new f.ea(0);var k=new f.ea(0),v=new f.ea(0);f.mb.Md(b,d,l.x,l.y,h.x,h.y,k,a,null,e);var p=k.j,g=0,n=1,u=new f.b;for(u.L(l);p*(n-g)>1E-12*b;){var z=.5*(g+n);f.mb.Oj(b,d,l.x,
l.y,p*z,a.j,k,v,e);u.x=k.j;u.y=v.j;if(u.x==q)break;if(c.Cj(l.x,u.x,q))n=z;else if(c.Cj(h.x,u.x,q))g=z;else return NaN}return u.y};c.Cj=function(b,d,c){b=a.uq(b);d=a.Vx(b,a.uq(d));c=a.Vx(b,a.uq(c));return 0==c||0<d&&0<c&&c<=d||0>d&&0>c&&c>=d?!0:!1};c.On=function(b,d){var c=d.ha-d.ca;return d.vu(b-Math.floor((b-d.ca)/c)*c)};c.Zp=function(b,d,c,a){var h=new f.Ac;h.I(d,c);c=a.N();b=Math.floor((b-d)/c)*c+b;for(h=h.Wf();Math.abs(b-h)>Math.abs(b+c-h);)b+=c;return b};c.BB=function(b,d,c,a,q){var h;c.y>a.y?
h=a:(h=c,c=a);a=new f.Ac;a.I(h.y,c.y);if(!a.contains(0)||3.141592653589793<=Math.abs(h.x-c.x))return NaN;if(h.x==c.x)return h.x;var l=new f.ea(0),e=new f.ea(0),k=new f.ea(0);f.mb.Md(b,d,h.x,h.y,c.x,c.y,e,l,null,q);var p=e.j,g=0,n=1,u=new f.b;for(u.L(h);p*(n-g)>1E-12*b;){var z=.5*(g+n);f.mb.Oj(b,d,h.x,h.y,p*z,l.j,e,k,q);u.x=e.j;u.y=k.j;a.I(h.y,u.y);if(0==u.y)break;if(a.contains(0))n=z;else if(a.I(c.y,u.y),a.contains(0))g=z;else return NaN}return u.x};c.Aq=function(b,d,c,a,q,e,k){var h=new f.h;b.s(h);
if(h.u())return b;var l=new f.Ac;h.Tn(l);var v=new f.Ac;v.I(d,d+c);if(v.contains(l)&&v.ha!=l.ha)return b;var p=new f.h;p.I(h);var g=b.G();if(33==g){p=q?b:b.Vf();h=p.Be();if(h<v.ca||h>=v.ha||k&&h==v.ha)h+=Math.ceil((v.ca-h)/c)*c,h=v.vu(h),p.zC(h);return p}if(550==g){p=q?b:b.Vf();a=p.Pa(0);g=2*p.D();b=!1;for(q=0;q<g;q+=2)if(h=a.read(q),h<v.ca||h>=v.ha||k&&h==v.ha)b=!0,h+=Math.ceil((v.ca-h)/c)*c,h=v.vu(h),a.write(q,h);b&&p.Dc(1993);return p}if(v.contains(l))return b;if(197==g)return c=q?b:b.Vf(),h.Ma(p),
c.Gp(h),c;var n=.1*Math.max(h.fa(),h.N());p.O(0,n);k=b;v=a.re(0);b=f.ei.local();q=new f.Hd;for(var u=0;;){var z=Math.floor((l.ca-d)/c),r=Math.ceil((l.ha-d)/c);if(3<r-z){z=Math.floor(.5*(r+z));p.o=h.o-n;p.v=d+c*z;var t=f.me.clip(k,p,v,e);p.o=p.v;p.v=h.v+n;var A=f.me.clip(k,p,v,e);q.Ag((z-r)*c,0);A.Xc(q);1736==g?k=b.V(t,A,a,null):(k=t,k.add(A,!1));k.s(h);h.Tn(l);u++}else break}p.o=d;p.v=d+c;d=new f.h;d.I(p);d.O(v,0);d=Math.floor((h.o-p.o)/c)*c;0!=d?(p.move(d,0),q.Ag(-d,0)):q.oC();d=1607==g?new f.Ua(k.description):
new f.Ia(k.description);e=new f.h;for(l=new f.h;h.v>p.o;){n=f.me.clip(k,p,v,0);n.s(l);if(1607==g?!n.u()&&(l.N()>v||l.fa()>v):!n.u()&&(1736!=g||l.N()>v))n.Xc(q),n.s(l),d.s(e),e.O(v,v),e.Yb(l)&&1736==g?d=b.V(d,n,a,null):d.add(n,!1);p.move(c,0);q.shift(-c,0)}return d};c.NJ=function(b,d,c,a,q){var h=new f.Ed(c.description);h.Jd(c,0,-1);q=f.fb.Xg(h,b,d,q);h=c.D();a.Oa();if(!f.fb.Jc(b)||h!=q.D())return!1;var l=new f.h;c.s(l);var e=new f.h;q.s(e);l=l.N();e=e.N();if(0!=l&&0!=e){if(e/=l,b=f.fb.Bh(d).N()/f.fb.Bh(b).N(),
1E-10<Math.abs(e/b-1))return!1}else if(0!=l||0!=e)return!1;a.add(c,!1);for(c=0;c<h;c++)b=q.Aa(c),a.rb(c,b);return!0};c.tA=function(){throw f.f.df();};return c}();f.gi=e})(C||(C={}));(function(f){(function(b){b[b.Clip=0]="Clip";b[b.DontClip=1]="DontClip";b[b.PannableFold=2]="PannableFold"})(f.di||(f.di={}));var a=f.di;(function(b){b[b.Geodesic=0]="Geodesic";b[b.Loxodrome=1]="Loxodrome";b[b.GreatElliptic=2]="GreatElliptic";b[b.NormalSection=3]="NormalSection";b[b.ShapePreserving=4]="ShapePreserving"})(f.kD||
(f.kD={}));var e=f.kD,c=function(){function b(){}b.hw=function(b,c,a){if(a||0<c){b=b.toString(f.Vc.PE_STR_NAME_CANON|f.Vc.PE_STR_AUTH_NONE);c=[];for(a=0;a<b.length;a++)c[a]="a"<=b[a]&&"z">=b[a]?c[a]=b[a].toUpperCase():b[a];return c.join()}return b.toString(f.Vc.PE_STR_AUTH_TOP)};b.ps=function(b,c,a,q){var d=q.length,h=a.D();if(0!=h){var l=a.Pa(0),e=Math.min(h,d),k=0,p=b.Kg();isNaN(c)&&(c=0);var g=b.Jc();b=g?b.kc().qe().N():0;for(var n=179*b/360;0<h;){l.Gx(k<<1,e,q,0,!0);f.fi.projToGeogCenter(p,e,
q,c);if(g)for(var u=0;u<e;u++){var z=q[u][0]-c,r=f.Ub.sign(z),t=l.read(2*(k+u));0>r*f.Ub.sign(t)&&Math.abs(z)>n&&(q[u][0]+=-r*b)}l.gy(k<<1,e,q,0,!0);k+=e;h-=e;e=Math.min(h,d)}a.Dc(1993)}};b.I_=function(b,c,a,q){var d=b.Kg();isNaN(c)&&(c=0);var h=a.Be();q[0][0]=h;q[0][1]=a.nf();f.fi.projToGeogCenter(d,1,q,c);b.Jc()&&(c=f.Ub.sign(q[0][0]-c),0>c*f.Ub.sign(h)&&(b=b.kc().qe().N(),Math.abs(q[0][0])>179*b/360&&(q[0][0]-=c*b)));a.rb(q[0][0],q[0][1])};b.vN=function(b,c,a,q){var d=0,h=b.Kg();isNaN(d)&&(d=0);
var l=b.Jc(),e=b.de();b=360*e;for(var e=179*e,k=q.length,p=0;p<a;){for(var g=p;g<a&&c[g].isNaN();++g)p++;var n=Math.min(k,a-p);if(0<n){for(var g=1,u=p+1;g<n;++g,++u)if(c[u].isNaN()){n=g;break}f.ma.nz(q,c,p,n);f.fi.projToGeogCenter(h,n,q,d);if(l)for(g=0,u=p;g<n;++g,++u){var z=c[u].x,r=q[g][0]-d,t=f.Ub.sign(r);0>t*f.Ub.sign(z)&&Math.abs(r)>e&&(q[g][0]-=t*b)}f.ma.mz(c,p,q,n);p+=n}}};b.uy=function(b,c,a){var d=a.length,h=c.D();if(!(1>h)){var l=c.Pa(0),e=Math.min(h,d),k=0,p=b.Kg(),g=b.Jc(),n=g?b.qe().N():
0,u=179*n/360,z=0;for(g&&(z=b.pi());0<h;){l.Gx(k<<1,e,a,0,!0);f.fi.geogToProj(p,e,a);if(g)for(b=0;b<e;b++){var r=a[b][0],t=f.Ub.sign(r),A=l.read(2*(k+b))-z;0>t*f.Ub.sign(A)&&Math.abs(r)>u&&(a[b][0]+=-t*n)}l.gy(k<<1,e,a,0,!0);k+=e;h-=e;e=Math.min(h,d)}c.Dc(1993)}};b.A_=function(b,c,a){if(!c.u()){var d=b.Kg();a[0][0]=c.Be();a[0][1]=c.nf();f.fi.geogToProj(d,1,a);if(b.Jc()){var d=f.Ub.sign(a[0][0]),h=b.pi();0>d*f.Ub.sign(c.Be()-h)&&(b=b.qe().N(),Math.abs(a[0][0])>179*b/360&&(a[0][0]-=d*b))}c.rb(a[0][0],
a[0][1])}};b.uN=function(b,c,a,q){if(0!=a){var d=b.Kg(),h=b.Jc(),l=h?b.qe().N():0,e=179*l/360,k=0;h&&(k=b.pi());for(b=0;b<a;){for(var p=b;p<a&&c[p].isNaN();++p)b++;var g=Math.min(q.length,a-b);if(0<g){for(var p=1,n=b+1;p<g;++p,++n)if(c[n].isNaN()){g=p;break}f.ma.nz(q,c,b,g);f.fi.geogToProj(d,g,q);if(h)for(p=0,n=b;p<g;p++){var u=q[p][0],z=f.Ub.sign(u);0>z*f.Ub.sign(c[n].x-k)&&Math.abs(u)>e&&(q[p][0]-=z*l)}f.ma.mz(c,b,q,g);b+=g}}}};b.os=function(b,c,a,q){var d=c.D();if(0!=d){var h=c.Pa(0),l=b.ie,e=
b.He,k=l.kc().Yi(),p=e.kc().Yi(),g=l.de(),n=e.de();b=b.ue;if(null==b||0==b.count()){a=k/p;q=(l.en()-e.en())*n;p=-90*g;b=90*g;k=!1;n=1;for(l=2*d;n<l;)g=h.get(n),e=f.J.nk(g,p,b),e!=g&&(h.set(n,e),k=!0),n+=2;if(0!=q||1!=a)for(k=!0,p=new f.b,n=0;n<d;n++)h.fc(2*n,p),p.x*=a,p.x+=q,p.y*=a,h.ho(2*n,p);k&&c.Dc(1993)}else{var l=q.length,e=Math.min(d,l),u=f.J.gf(e),z=null,r=0,t=NaN,A=NaN,m=360*n,w=n/g;a&&(A=90*n,t=89.9*g,z=f.J.gf(e));for(var x=!0,C=0;0!=d;){g=!1;h.Gx(r<<1,e,q,0,!0);for(n=0;n<e;n++)u[n]=q[n][0];
if(a)for(n=0;n<e;n++){var I=Math.abs(q[n][1])-t;0<I&&(g=q[n][1],q[n][1]=f.Ub.Fl(t,g),z[n]=f.Ub.Fl(I,g),g=!0)}n=q[0][0];b.transform(q,e,k,p);x&&(C=q[0][0]-w*n,x=!1);for(n=0;n<e;n++)I=q[n][0]-u[n]*w-C,200<Math.abs(I)&&(q[n][0]=0<I?q[n][0]-m:q[n][0]+m);if(g){for(n=0;n<e;n++)0!=z[n]&&(q[n][1]+=w*z[n],q[n][1]>A?q[n][1]=A:q[n][1]<-A&&(q[n][1]=-A));for(g=0;g<e;g++)z[g]=0}h.gy(r<<1,e,q,0,!0);r+=e;d-=e;e=Math.min(d,l)}c.Dc(1993)}}};b.z_=function(b,c,a,q){if(c.u())return!1;var d=b.ie,h=b.He,l=b.ue,e=d.kc().Yi(),
k=h.kc().Yi();q[0][0]=c.Be();q[0][1]=c.nf();if(null!=l&&0<l.count()){b=!0;var p=!1,g=NaN,n=0,u=1;a&&(a=d.de(),g=h.de(),u=g/a,g*=90,d=89.9*a,h=Math.abs(q[0][1])-d,0<h&&(p=q[0][1],q[0][1]=f.Ub.Fl(d,p),n=f.Ub.Fl(h,p),p=!0));l.transform(q,1,e,k);p&&0!=n&&(q[0][1]+=u*n,q[0][1]>g?q[0][1]=g:q[0][1]<-g&&(q[0][1]=-g));c.rb(q[0][0],q[0][1])}else{a=d.de();b=f.J.nk(q[0][1],-90*a,90*a)!=q[0][1];g=h.de();l=(d.en()-h.en())*g;e/=k;if(1!=e||0!=l)b=!0,q[0][0]*=e,q[0][0]+=l,q[0][1]*=e;b&&c.rb(q[0][0],q[0][1])}return b};
b.tN=function(b,c,a,q){var d;if(b.rr)q=90*b.ie.de(),f.ma.UK(c,a,-q,q);else{var h=b.ue,l=b.ie,e=b.He;b=l.Ws();var k=e.Ws(),p=l.de(),g=90*p,n=e.de();if(null==h||0==h.count()){if(q=b/k,h=(l.en()-e.en())*n,f.ma.UK(c,a,-g,g),0!=h||1!=q)for(n=0;n<a;n++)c[n].x*=q,c[n].x+=h,c[n].y*=q}else for(var l=Math.min(a,q.length),g=f.J.gf(l),e=360*n,p=n/p,u=!0,z=0,r=0;0!=a;){for(n=0;n<l;n++)g[n]=c[n+r].x;n=c[0].x;f.ma.nz(q,c,r,l);h.transform(q,l,b,k);f.ma.mz(c,r,q,l);u&&(z=c[0].x-p*n,u=!1);for(n=0;n<l;n++)d=c[r+n].x-
g[n]*p-z,200<Math.abs(d)&&(c[r+n].x=0<d?c[r+n].x-e:c[r+n].x+e);r+=l;a-=l;l=Math.min(a,q.length)}}};b.YZ=function(d,c,f,a){return b.Ym(d,c,isNaN(f)?0:f,!0,a,null)};b.Uu=function(b,c){b=b.Bh();isNaN(c)||b.wv(c,0);return b};b.JS=function(d,c,a,q,e,k,p,g){for(var h=b.Uu(q,e),l=h.N(),v=l/360,n=b.jE*v,u=d.Pa(0),z=c.Jc(),r=z?l/c.qe().N():0,t=!1,A=new f.Ia(a.description),w=0,m=a.aa();w<m;++w){var x=z,F=new f.Ua(a.description);F.Ti(a,w,!0);if(0!=p){var C=b.$D(!0,F,h.B-g,h.B,p);(t=t||C)&&(x=!1)}var I=-1;x&&
(I=d.wa(w));var D=F.Pa(0),J=F.D(),K=0,y=D.read(0),H=0,C=3*q.re(0),M=!1,E=new f.b;E.$c();var O=new f.b;O.$c();for(var P=!1,L=1;L<J;++L){var N=f.b.pa(D.Of(2*L),D.Of(2*L+1)),B=N.x,U=B+K,R=U-y;N.x=U;if(Math.abs(R)>n){if(x){var W=I+(L+1<J?L:0),T=u.read(2*(I+L-1)),W=(u.read(2*W)-T)*r;Math.abs(R-W)>1*v&&(x=!1)}x||(K-=f.Ub.Fl(l,U-y),U=B+K,++H,P=0!=K,N.x=U)}else M||f.ma.MH(O,E,N,C)&&(M=!0);P&&D.write(2*L,U);y=U;O.L(E);E.L(N)}0<H&&F.Dc(1993);x=F.Aa(0);J=F.Aa(J-1);F=f.b.Cb(x,J)<C?b.SR(F,q,e,k,M):b.fS(d,w,F,
q,e);A.add(F,!1)}e=q.re(0);a=h.N()/180;b.wu(A,h,.1*e,!1);e=f.uh.clip(A,h,e,a,k);A=A!=e;d=d.hf();g=e.hf();p=0;0<g&&0>d?p=1:0>=g&&0<d&&(0==g?(g=NaN,2==c.Fb()?g=c.Lk().hf():1==c.Fb()&&(g=c.qe().HG()),d>.99*g&&(p=-1)):p=-1);0!=p&&(c=new f.Ia(e.description),c.oq(h),c=f.Km.local().V(c,a,k),c.add(e,!1),A=!0,e=c);A&&(e=f.Lm.local().V(e,q,!1,k));return e};b.fS=function(d,c,a,q,e){var h=a.D(),l=a.Aa(0),k=a.Aa(h-1);q=b.Uu(q,e);e=q.N();var l=f.Ub.sign(k.x-l.x),v=new f.h;a.ac(v);var p=q.Gk(),g,k=p-e,p=p+e;if(0<=
l){for(var n=Math.ceil((k-v.o)/e),n=n*e;k>v.o+n;)n+=e;for(;k<v.v+n;)n-=e;g=n;720<v.N()&&(p=k+360*Math.ceil(v.N()/360))}else{n=Math.ceil((p-v.v)/e);for(n*=e;p<v.v+n;)n-=e;for(;p>v.o+n;)n+=e;g=n;720<v.N()&&(k=p-360*Math.ceil(v.N()/360))}var n=l*e,u=f.h.pa(v.o,v.A,v.v,v.B);u.move(g,0);var z=new f.Hd;z.Ag(g,0);a.Xc(z);v=new f.Ua(a.description);v.add(a,!1);g=a.Aa(h-1);e=0;for(var r=v.Aa(0).x,t=0;0<l?u.v<p:u.o>k;)1024<=t&&(t=0),u.move(n,0),z.Wb=n,a.Xc(z),r+=n,q.o<=r&&q.v>=r&&(e=v.D()-1),a.rb(0,g),g=a.Aa(h-
1),v.As(a,0,0,h-1,!1);a=new f.Ia(v.description);h=0<d.Tm(c);a.add(v,!1);d=v.Aa(0);k=v.Aa(v.D()-1);c=a.aa()-1;(0>l?h:!h)?(l=f.b.pa(k.x,q.B),a.aj(l),l=f.b.pa(q.Gk(),q.B),a.aj(l),q=f.b.pa(d.x,q.B)):(l=f.b.pa(k.x,q.A),a.aj(l),l=f.b.pa(q.Gk(),q.A),a.aj(l),q=f.b.pa(d.x,q.A));a.aj(q);a.JH(0,c,0);a.mQ(e);return a};b.SR=function(d,c,a,q,e){var h=new f.Ia(d.description);h.add(d,!1);h.bC(0,h.D()-1);var l=new f.h;h.ac(l);a=b.Uu(c,a);for(var k=a.N(),v=Math.ceil((a.o-l.o)/k),v=v*k;a.o>l.o+v;)v+=k;for(;a.o<l.v+
v;)v-=k;v+=k;if(0!=v){l.move(v,0);var p=new f.Hd;p.Ag(v,0);h.Xc(p)}if(a.o<=l.o&&a.v>l.v)return e&&(e=h.hf(),h=f.Lm.local().V(h,c,!0,q),c=h.hf(),(c=f.Ub.sign(e)!=f.Ub.sign(c))&&h.dK()),h;d=new f.Ia(d.description);d.add(h,!1);for(e=e||l.N()>k-c.re(0);l.o<a.v;)l.move(k,0),p=new f.Hd,p.Ag(k,0),h.Xc(p),d.add(h,!1);e&&(e=d.hf(),d.Hp(1),d=f.Lm.local().V(d,c,!0,q),c=d.hf(),(c=f.Ub.sign(e)!=f.Ub.sign(c))&&d.dK());return d};b.$D=function(b,c,a,q,e){for(var d=c.Pa(0),h=c.D(),l=!1,k=0;k<h;k++){var v=f.b.pa(d.Of(2*
k),d.Of(2*k+1));if(0!=(e&1)&&v.y>=a){l=!0;break}if(0!=(e&2)&&v.y<=-a){l=!0;break}}if(!l)return!1;d=!1;b&&(d=c.Eo(0));b=new f.fd;var h=b.Jb(c),l=b.Pb(h),p=-1,g=!0,n=new f.b;n.$c();for(var k=new f.Wa,u=-1,z=b.cb(l);-1!=z;z=b.U(z)){var v=b.Aa(z),r=0!=(e&1)&&90<=v.y?1:0,r=r|(0!=(e&2)&&v.y<=-a?2:0);if(0<p&&p!=r){if(n.x!=v.x){n.x=v.x;b.wj(b.Ra(z),k);var t=b.Vj(l,z,k);b.Qf(t,n)}if(d)for(u=-1!=u?b.U(u):b.cb(l),t=b.Ra(z);u!=t;)u=b.td(u,!1);u=-1}0<r&&(v.y=f.Ub.Fl(q,v.y),b.Qf(z,v),g||p==r||(v.x!=n.x?(b.wj(z,
k),t=b.Vj(l,z,k),b.rb(t,n.x,v.y),u=t):u=z));p=r;n=v;g=!1}if(d){if(-1!=u)for(u=b.U(u);-1!=u;)u=b.td(u,!1);a=b.cb(l);b.Tq(a,b.Rj(l))||(b.wj(a,k),b.Vj(l,-1,k))}b.Se(h).copyTo(c);return!0};b.yZ=function(b,c){var d=0,h=b.Ka(c);c+=1;for(var f=b.aa();c<f&&!(0<b.Tm(c));++c)d++;return 64<h&&3<=d};b.sA=function(c,h,l,q){var d=c;if(d.u()||l==a.DontClip)return d;var e=d.G();if(33==e)return q=d,d=[q.w()],b.KH(d,1,h,l),d[0].isNaN()?q.Oa():q.rb(d[0]),c;c=h.kc();var k=c.de(),p=90*k,g=180*k,n=360*k,u=h.pi(),z=.5*
k,r=new f.h;d.s(r);var t=h.Us(),A=h.CS(),w=197==t.G();h=new f.h;t.s(h);l==a.PannableFold&&(l=c.qe().N(),h.o=u-.5*l,h.v=h.o+l);if(r.A<-p||r.B>p){(new f.h).I(r.o-k,-p,r.v+k,p);d=f.uh.rq(d,h,c,NaN,0,q);if(d.u())return d;d.s(r)}if(A&&(h.B<r.A||h.A>r.B))return d.Ja();r.N()>n&&(d=b.Aq(d,u-g,n,c,!0,0,!0,q),d.s(r));p=b.BN(r.o,r.v,h.o,h.v,n);0!=p&&r.move(p,0);if(r.v>h.v||r.o<h.o){if(r.v>h.v)for(;r.o>=h.v;)r.move(-n,0),p-=n;for(;r.o<h.v-n;)r.move(n,0),p+=n}l=f.ma.uv(c,t);0!=p&&(k=new f.Hd,k.Ag(p,0),d.Xc(k));
if(A){if(w&&h.contains(r))return d;A=[null,null];for(p=0;2>p;p++){w?k=f.T.Ic(e)?f.uh.clip(d,h,l,z,q):f.uh.clip(d,h,l,0,q):(k=f.sk.local().V(d,t,c,q),k==t&&(k=f.T.ne(k)));if(h.o<=r.o&&h.v>=r.v||h.o>=r.o&&h.v<=r.v)return k;A[p]=k;0==p&&(r.move(-n,0),k=new f.Hd,k.Ag(-n,0),d.Xc(k))}if(550==e)A[0].Jd(A[1],0,-1);else if(f.T.Ic(e))A[0].add(A[1],!1);else if(33==e)A[0].u()&&(A[0]=A[1]);else throw f.f.X("intersect_with_GCS_horizon: unexpected geometry type");return A[0]}if(h.B<r.A||h.A>r.B)return d;for(e=0;!d.u()&&
r.v>h.o;)0!=e&&(k=new f.Hd,k.Ag(e,0),d.Xc(k)),f.Gj.local().V(4,d,t,c,q)||(d=f.cq.local().V(d,t,c,q),t==d&&(d=f.T.ne(d))),0!=e&&(z=new f.Hd,z.Ag(-e,0),d.Xc(z)),e-=n,r.move(-n,0);return d};b.KH=function(c,h,l,q){if(0!=h&&q!=a.DontClip)if(q==a.PannableFold){q=l.zT();for(var d=h,e=0;e<h;e++)if(c[e].y>q.B||c[e].y<q.A)c[e].$c(),d--;0!=d&&b.Tu(c,h,q.o,q.N())}else{q=l.de();var k=90*q,p=180*q;q*=360;d=h;for(e=0;e<h;e++)if(c[e].y>k||c[e].y<-k)c[e].$c(),d--;if(0!=d){d=new f.h;d.Lx(c,h);var k=l.Us(),g=l.Tv(),
e=197==k.G(),n=new f.h;k.s(n);if(!g||!(n.B<d.A||n.A>d.B))if(g)if(b.Tu(c,h,n.Gk()-p,q),d=h,e)for(e=0;e<h;e++)n.contains(c[e])||(c[e].$c(),d--);else for(l=f.ma.uv(l.kc(),k),e=0;e<h;e++)(p=0!=f.gd.fe(k,c[e],l))||(c[e].$c(),d--);else for(b.Tu(c,h,-p,q),d=h,l=f.ma.uv(l.kc(),k),e=0;e<h;e++)if(p=c[e],p.isNaN()&&d--,g=b.oE(p.x,n.o,n.v,q),p.x+=g,p=0!=f.gd.fe(k,p,l))c[e].$c(),d--}}};b.a_=function(b,c,a){if(0<=c&&!b.Qb(c))return 0;var d=0;if(1==a.Fb())return c=90*a.de(),c-=2*c/Math.PI*f.Vc.PE_HORIZON_DELTA,
a=new f.h,b.s(a),a.B>=c&&(d=1),a.A<=-c&&(d|=2),d;var h=a.Sj();if(null==h)return 0;var l=null;0<=c&&(l=b);for(var e=0;2>e;e++)if((0<e?h.getSouthPoleLocation():h.getNorthPoleLocation())!=f.Bg.PE_POLE_OUTSIDE_BOUNDARY){var k=a.cA(0<e);k.isNaN()||(k=0>c?f.ff.wA(b,k,0):f.ff.xA(l,c,k,0,null),d|=k<<e)}return d};b.Aq=function(b,c,a,q,e,k,p,g){var d=b.G(),h=c+a;if(33===d){q=e?b:b.Vf();var l=q.Be();if(l<c||l>=h||p&&l==h)l+=Math.ceil((c-l)/a)*a,l=f.J.nk(l,c,h),q.zC(l);return q}if(b.u())return b;l=new f.h;b.s(l);
if(l.u())return b;var v=new f.Ac;l.Tn(v);var n=new f.Ac;n.I(c,h);if(n.contains(v))return b;h=new f.h;h.I(l);if(550===d){q=e?b:b.Vf();g=q.Pa(0);d=2*q.D();h=!1;for(c=0;c<d;c+=2)if(l=g.read(c),l<n.ca||l>=n.ha||p&&l==n.ha)h=!0,l+=Math.ceil((n.ca-l)/a)*a,l=n.vu(l),g.write(c,l);h&&q.Dc(1993);return q}if(197==d)return a=e?b:b.Vf(),l.Ma(h),a.Gp(l),a;var u=.1*Math.max(l.fa(),l.N());h.O(0,u);p=b;n=q.re(0);b=f.ei.local();for(e=new f.Hd;;){var z=Math.floor((v.ca-c)/a),r=Math.ceil((v.ha-c)/a);if(3<r-z){z=Math.floor(.5*
(r+z));h.o=l.o-u;h.v=c+a*z;var t=f.uh.clip(p,h,n,k,g);h.o=h.v;h.v=l.v+u;var A=f.uh.clip(p,h,n,k,g);e.Ag((z-r)*a,0);A.Xc(e);1736==d?p=b.V(t,A,q,null):(p=t,p.add(A,!1));p.s(l);l.Tn(v)}else break}h.o=c;h.v=c+a;c=new f.h;c.I(h);c.O(n,0);c=Math.floor((l.o-h.o)/a)*a;0!=c?(h.move(c,0),e.Ag(-c,0)):e.oC();c=1607==d?new f.Ua(p.description):new f.Ia(p.description);k=new f.h;for(v=new f.h;l.v>h.o;){u=f.uh.clip(p,h,n,0,g);u.s(v);if(1607==d?!u.u()&&(v.N()>n||v.fa()>n):!u.u()&&(1736!=d||v.N()>n))u.Xc(e),u.s(v),
c.s(k),k.O(n,n),k.Yb(v)&&1736==d?c=b.V(c,u,q,null):c.add(u,!1);h.move(a,0);e.shift(-a,0)}return c};b.Tu=function(b,c,a,q){for(var d=a+q,h=0;h<c;h++){var l=b[h].x;a<=l&&l<d||!(l<a||l>d||l==d)||(l+=Math.ceil((a-l)/q)*q,l=f.J.nk(l,a,d),b[h].x=l)}};b.Ym=function(c,h,a,q,e,k){if(!h.Jc())throw f.f.X("fold_into_360_degree_range");if(c.u())return c;var d;if(2==h.Fb())a=h.aw(),d=h.$v()-a;else{var l=h.de();d=360*l;a-=180*l}return b.Aq(c,a,d,h,q,e,!0,k)};b.AG=function(c,h,f,a){if(2==f.Fb())a=f.aw(),f=f.$v()-
a;else{var d=f.de();f=360*d;a-=180*d}b.Tu(c,h,a,f)};b.Mj=function(b,c){var d=c.qe();if(33==b.G()){var h=b.nf();return d.A<=h&&h<=d.B?b:b.Ja()}h=new f.h;b.s(h);var a=new f.h;a.I(d);a.o=h.o;a.v=h.v;a.O(.01*a.fa(),0);d=f.ma.Zy(c,h);return a.contains(h)?b:f.uh.clip(b,a,d,0,null)};b.Jm=function(b,c,f){return b>c.v&&b-c.v<f?c.v:b<c.o&&c.o-b<f?c.o:b};b.yY=function(c,h,f,a){a.x=b.Jm(c.x,h,f);a.y=c.y};b.xY=function(c,h,f,a){for(var d=0;d<h;d++)c[d].y<f.A||c[d].y>f.B?c[d].$c():c[d].x=b.Jm(c[d].x,f,a)};b.wu=
function(c,h,a,q){if(!c.u()){var d=c.G();if(!q||1736!=d)if(f.T.gh(d)){q=c.Pa(0);for(var d=0,l=c.D();d<l;d++){var e=q.read(2*d),k=b.Jm(e,h,a);k!=e&&q.write(2*d,k)}c.Dc(1993)}else if(197==d)q=new f.h,c.s(q),q.o=b.Jm(q.o,h,a),q.v=b.Jm(q.v,h,a),c.Gp(q);else if(33==d)c.zC(b.Jm(c.Be(),h,a));else throw f.f.X("internal error");}};b.oU=function(c,h,a,q){var d=new f.fd,l=d.Jb(c);c=f.ma.uv(h,c);b.gt(d,l,h,c,a,!0,q);return d.Se(l)};b.gt=function(c,h,a,q,k,p,g){if(!a.Jc())throw f.f.F("invalid call");var d=a.qe(),
l=a.kc(),v=l.Kg().getDatum().getSpheroid(),l=l.Od().Ai,n=v.getFlattening(),v=v.getAxis(),n=n*(2-n),u=new f.Ac;d.Tn(u);var z=null,r=[[0,0],[0,0]];2==a.Fb()?(z=a.Kg(),p?(r[0][0]=b.On(g,u),r[0][1]=d.Cq(),f.fi.projToGeog(z,1,r),d=r[0][0]*l):(r[0][0]=d.Gk(),r[0][1]=g,f.fi.projToGeog(z,1,r),d=r[0][1]*l)):d=g*l;if(!p&&0!=d&&k!=e.GreatElliptic)throw f.f.X("invalid argument");var t=new f.ea,A=[0],w=new f.b,m=new f.b,x=new f.b,C=[null,null],I=new f.b,D=new f.b,J=new f.b,K=new f.b;for(h=c.Pb(h);-1!=h;h=c.Sb(h)){var y=
c.cb(h);c.w(y,I);for(var M=!1,E=y=c.U(y);-1!=E;E=c.U(E)){if(E==y){if(M)break;M=!0}c.w(E,D);if(p&&(q<g-I.x&&D.x-g>q||q<g-D.x&&I.x-g>q)||!p&&(0!=g||q<-I.y&&D.y>q||q<-D.y&&I.y>q)){do if(!(Math.abs(I.x-D.x)>=.5*u.N())){2==a.Fb()?(r[0][0]=b.On(I.x,u),r[0][1]=I.y,r[1][0]=b.On(D.x,u),r[1][1]=D.y,f.fi.projToGeogCenter(z,2,r,0),J.x=r[0][0]*l,J.y=r[0][1]*l,K.y=r[1][1]*l):(J.x=I.x*l,J.y=I.y*l,K.y=D.y*l);K.x=2*(D.x-I.x)*Math.PI/u.N()+J.x;var H;if(p){m.x=d;m.y=b.DB(v,n,J,K,d,k);if(isNaN(m.y))break;C[0]=m;H=1}else if(k==
e.GreatElliptic){var O=[0,0];H=f.xy.tA(v,n,J,K,d,O);if(0==H)break;m.x=O[0];m.y=d;C[0]=m;2==H&&(x.x=O[1],x.y=d,C[1]=x)}else{m.x=b.BB(v,n,J,K,k);if(isNaN(m.x))break;m.y=0;C[0]=m;H=1}for(var P=-1,O=0;O<H;O++){f.mb.Md(v,n,J.x,J.y,K.x,K.y,t,null,null,k);var L=t.j;f.mb.Md(v,n,J.x,J.y,C[O].x,C[O].y,t,null,null,k);var N=t.j;2==a.Fb()?(r[0][0]=C[O].x/l,r[0][1]=C[O].y/l,f.fi.geogToProj(z,1,r),p?(w.y=r[0][1],w.x=g):(w.x=b.Zp(r[0][0],I.x,D.x,u),w.y=g)):p?(w.x=g,w.y=C[O].y/l):(w.x=b.Zp(C[O].x/l,I.x,D.x,u),w.y=
g);A[0]=0<L?f.J.nk(N/L,0,1):.5;if(0==A[0]||1==A[0])break;P>A[0]||(P=c.Ra(E),c.zm(P,A,1),c.rb(c.U(P),w.x,w.y),P=A[0])}}while(0)}I.L(D)}}};b.On=function(b,c){var d=c.ha-c.ca;return c.vu(b-Math.floor((b-c.ca)/d)*d)};b.Zp=function(b,c,a,q){var d=new f.Ac;d.I(c,a);a=q.N();b=Math.floor((b-c)/a)*a+b;for(d=d.Wf();Math.abs(b-d)>Math.abs(b+a-d);)b+=a;return b};b.Cj=function(b,c,a){b=f.ks.uq(b);c=f.ks.Vx(b,f.ks.uq(c));a=f.ks.Vx(b,f.ks.uq(a));return 0==a||0<c&&0<a&&a<=c||0>c&&0>a&&a>=c?!0:!1};b.DB=function(c,
h,a,q,k,p){if(p==e.GreatElliptic)return f.xy.LU(h,a,q,k);if(Math.abs(a.x-q.x)>=Math.PI||!b.Cj(a.x,q.x,k))return NaN;var d;a.x>q.x?d=q:(d=a,a=q);q=new f.ea;var l=new f.ea,v=new f.ea;f.mb.Md(c,h,d.x,d.y,a.x,a.y,l,q,null,p);var g=l.j,n=0,u=1,z=new f.b;for(z.L(d);g*(u-n)>1E-12*c;){var r=.5*(n+u);f.mb.Oj(c,h,d.x,d.y,g*r,q.j,l,v,p);z.x=l.j;z.y=v.j;if(z.x==k)break;if(b.Cj(d.x,z.x,k))u=r;else if(b.Cj(a.x,z.x,k))n=r;else return NaN}return z.y};b.BB=function(b,c,a,q,k){if(k==e.GreatElliptic)return k=[0,0],
f.xy.tA(b,c,a,q,0,k),k[0];var d;a.y>q.y?d=q:(d=a,a=q);q=new f.Ac;q.I(d.y,a.y);if(!q.contains(0)||Math.abs(d.x-a.x)>=Math.PI)return NaN;if(d.x==a.x)return d.x;var h=new f.ea,l=new f.ea,p=new f.ea;f.mb.Md(b,c,d.x,d.y,a.x,a.y,l,h,null,k);var v=l.j,g=0,n=1,u=new f.b;for(u.L(d);v*(n-g)>1E-12*b;){var z=.5*(g+n);f.mb.Oj(b,c,d.x,d.y,v*z,h.j,l,p,k);u.x=l.j;u.y=p.j;q.I(d.y,u.y);if(0==u.y)break;if(q.contains(0))n=z;else if(q.I(a.y,u.y),q.contains(0))g=z;else return NaN}return u.x};b.w_=function(b,c,a,q,e,k){if(c==
e&&a!=k)throw f.f.F();if(0>=q)return 0;if(b.Ho()){k*=2;var d=2*a;b=2*q;for(a=0;a<b;a++)e[k+a]=c[d+a];return q}if(2>=q){k=[new f.b,new f.b];for(d=0;d<q;d++)k[d].ka(c[2*d],c[2*d+1]);c=f.ns.local().VY(b,k,q,k);for(d=0;d<q;d++)e[2*d]=k[d].x,e[2*d+1]=k[d].y;return c}var h=b.ie,d=b.He,l=h.Fb(),p=d.Fb();if(0==l&&l==p)return b=h.Yi(),d=d.Yi(),d=b/d,b=new f.Hd,b.Op(d,d),b.WY(c,a,e,k,q),q;l=new f.Ed;l.Ud(3);l.resize(q);for(var p=l.Pa(0),v=l.Pa(3),d=0,g=2*a,n=2*k;d<q;d++,n+=2){a=c[g++];var h=c[g++],u=n;if(isNaN(a)||
isNaN(h))h=a=0,u=-1;v.write(d,u);p.write(2*d,a);p.write(2*d+1,h)}l.Dc(1993);c=f.ns.local().V(l,b,null);d=0;for(k*=2;d<q;d++,k+=2)e[k]=NaN,e[k+1]=NaN;if(c.u())return 0;k=c.Pa(3);b=c.Pa(0);d=l=0;for(q=c.D();d<q;d++)c=k.read(d),-1!=c&&(a=b.read(2*d),h=b.read(2*d+1),e[c]=a,e[c+1]=h,l++);return l};b.NJ=function(b,c,a,q){if(!b.ie.Jc())return!1;var d=new f.Ed(c.description);d.Jd(c,0,-1);q=f.ns.local().V(d,b,q);d=c.D();a.Oa();if(d!=q.D())return!1;var h=new f.h;c.s(h);var l=new f.h;q.s(l);h=h.N();l=l.N();
if(0!=h&&0!=l){if(l/=h,b=b.He.Bh().N()/b.ie.Bh().N(),1E-10<Math.abs(l/b-1))return!1}else if(0!=h||0!=l)return!1;a.add(c,!1);c=new f.b;for(b=0;b<d;b++)q.w(b,c),a.rb(b,c);return!0};b.pP=function(b,c){b%=360*c;b>=180*c&&(b-=360*c);return b};b.LJ=function(c,h,l,q){if(l==a.Clip){var d=h.Lk();197==d.G()?(l=new f.h,d.s(l),d=f.ma.Zy(h,l),c=f.uh.clip(c,l,d,5E4*h.cn(),q)):f.Gj.local().V(1,d,c,h,q)||(c=f.sk.local().V(c,d,h,q),c==d&&(c=f.xl.ne(c)))}else h.Jc()&&(q=new f.h,c.ac(q),h.qe().contains(q)||(b.wu(c,
h.qe(),h.re(0),!0),l==a.PannableFold&&(c=b.Mj(c,h)),c=b.Ym(c,h,0,!0,1E5*h.cn(),null)));return c};b.iF=function(b,c,a){var d=c.Vs();if(null==d)return b;c=c.kc();var h=c.qe().N(),l=new f.h;b.ac(l);var e=new f.Ac;l.Tn(e);for(var l=d.Da(),d=null,k=new f.Hd;l.Ya();)for(;l.Ca();){var p=l.ba(),g=p.xf(0,0),n=new f.Ac;n.I(g.ca,g.ha);for(g=0;n.ha>e.ca;)n.move(-h),--g;for(;n.ca<=e.ha;){if(n.Yb(e)){null==d&&(d=new f.Ua);var u=f.Hb.eR(p.ec(),p.Cc());0!=g&&(k.Ag(g*h,0),u.Xc(k));d.dc(u,!0)}n.move(h);++g}}return null!=
d?(c=f.ma.fQ(c,d),c=f.ma.Bs(c),f.Ju.jR(b,d,c,a)):b};b.BN=function(c,h,f,a,e){return c>=f&&h<=a?0:b.oE(.5*(h+c),f,a,e)};b.oE=function(b,c,a,q){return f.Ub.round((.5*(a+c)-b)/q)*q};b.KS=function(c,h,a,q,e,k,p,g){var d=b.Uu(q,e),l=d.N(),v=l/360,n=b.jE*v,u=c.Pa(0),z=h.Jc(),r=z?l/h.qe().N():0,t;h=c.Ja();for(var A=0,w=a.aa();A<w;++A){var m=z,x=new f.Ua(a.description);x.Ti(a,A,!0);t=a.Qb(A);0!=p&&(t=b.$D(t,x,d.B-g,d.B,p))&&(m=!1);var C=-1;t=x.D();var F=!1;m&&(C=c.wa(A),F=c.Qb(A));var I=x.Pa(0),D=0,J=I.read(0),
K=0,y=3*q.re(0),M=!1,E=new f.b;E.$c();var O=new f.b;O.$c();for(var P=!1,H=1;H<t;++H){var L=f.b.pa(I.Of(2*H),I.Of(2*H+1)),N=L.x,B=N+D,U=B-J;L.x=B;if(Math.abs(U)>n){if(m){var R=C+H-1,W=C;if(!F||H+1<t)W+=H;R=u.read(2*R);W=(u.read(2*W)-R)*r;Math.abs(U-W)>1*v&&(z=!1)}m||(D-=f.Ub.Fl(l,B-J),B=N+D,++K,P=0!=D,L.x=B)}else M||f.ma.MH(E,O,L,y)&&(M=!0);P&&I.write(2*H,B);J=B;E.L(O);O.L(L)}0!=K&&x.Dc(1993);m=x.Aa(0);t=x.Aa(t-1);f.b.Cb(m,t);x=b.DS(x,q,isNaN(e)?0:e,k);h.add(x,!1)}c=q.re(0);a=d.N()/180;b.wu(h,d,.1*
c,!1);return f.uh.clip(h,d,c,a,k)};b.DS=function(c,h,f,a){return b.Ym(c,h,f,!0,0,a)};b.IU=function(b,c,a,q){var d=b.G();if(1736==d)for(c=null!=c?c.re(0):0,d=0;d<q;d++)1!=f.gd.fe(b,a[d],c)&&a[d].$c();else if(197==d)for(d=0;d<q;d++)b.fR(a[d])||a[d].$c();else throw f.f.F();};b.Dl=function(b,c,a,q){if(32>a)for(var d=new f.Wa,h=0;h<a;h++)d.rb(c[h]),b.Dl(d,q).w(c[h]);else{var l=new f.Ed;l.Ud(3);l.XE(c,a);d=l.Pa(3);for(h=0;h<a;h++)d.write(h,h);h=b.Dl(l,q);b=h.Pa(0);d=h.Pa(3);q=f.b.pa(NaN,NaN);for(l=0;l<
a;l++)c[l]=q;a=h.D();for(h=0;h<a;h++)q=d.read(h),b.fc(2*h,c[q])}};b.Cl=function(b,c,a,q){if(32>a)for(var d=new f.Wa,h=0;h<a;h++)d.rb(c[h]),b.Cl(d,q).w(c[h]);else{var l=new f.Ed;l.Ud(3);l.XE(c,a);d=l.Pa(3);for(h=0;h<a;h++)d.write(h,h);h=b.Cl(l,q);b=h.Pa(0);d=h.Pa(3);q=f.b.pa(NaN,NaN);for(l=0;l<a;l++)c[l]=q;a=h.D();for(h=0;h<a;h++)q=d.read(h),b.fc(2*h,c[q])}};b.Z_="ABCDEFGHIJKLMNOPQRSTUVWXYZ";b.jE=210;return b}();f.Ib=c})(C||(C={}));(function(f){(function(f){f[f.rightSide=1]="rightSide"})(f.JN||(f.JN=
{}));var a=function(){function a(c,b,d){this.wt=new f.b;void 0===c?this.up=-1:(this.wt.L(c),this.up=b,this.Qa=d,this.Zw=0)}a.prototype.MK=function(c){this.Zw=c?this.Zw|1:this.Zw&-2};a.prototype.u=function(){return 0>this.up};a.prototype.Mz=function(){if(this.u())throw f.f.X("invalid call");return new f.Wa(this.wt.x,this.wt.y)};a.prototype.Za=function(){if(this.u())throw f.f.X("invalid call");return this.up};a.prototype.Pz=function(){if(this.u())throw f.f.X("invalid call");return this.Qa};a.prototype.yA=
function(){return 0!=(this.Zw&1)};a.prototype.Ky=function(c,b,d,h){this.wt.x=c;this.wt.y=b;this.up=d;this.Qa=h};return a}();f.Nm=a})(C||(C={}));(function(f){var a=function(){function c(){}c.prototype.Xn=function(b,c){this.Rh.resize(0);this.hj.length=0;this.Vk=-1;b.ac(this.gl);this.gl.O(c,c);this.gl.Yb(this.Mb.Ga)?((this.qt=f.T.Oc(b.G()))?(this.fJ=b.ec(),this.eJ=b.Cc(),this.ta=c):this.ta=NaN,this.Rh.add(this.Mb.Mf),this.hj.push(this.Mb.Ga),this.Kt=this.Mb.Ts(this.Mb.Mf)):this.Kt=-1};c.prototype.Ni=
function(b,c){this.Rh.resize(0);this.hj.length=0;this.Vk=-1;this.gl.I(b);this.gl.O(c,c);this.ta=NaN;this.gl.Yb(this.Mb.Ga)?(this.Rh.add(this.Mb.Mf),this.hj.push(this.Mb.Ga),this.Kt=this.Mb.Ts(this.Mb.Mf),this.qt=!1):this.Kt=-1};c.prototype.next=function(){if(0==this.Rh.size)return-1;this.Vk=this.Kt;var b=null,c=null,h,a=null,q=null;this.qt&&(b=new f.b,c=new f.b,a=new f.h);for(var k=!1;!k;){for(;-1!=this.Vk;){h=this.Mb.Iz(this.Mb.Sv(this.Vk));if(h.Yb(this.gl))if(this.qt){if(b.L(this.fJ),c.L(this.eJ),
a.I(h),a.O(this.ta,this.ta),0<a.fz(b,c)){k=!0;break}}else{k=!0;break}this.Vk=this.Mb.Zv(this.Vk)}if(-1==this.Vk){h=this.Rh.Fc();var p=this.hj[this.hj.length-1];null==q&&(q=[],q[0]=new f.h,q[1]=new f.h,q[2]=new f.h,q[3]=new f.h);e.tK(p,q);this.Rh.Pf();--this.hj.length;for(p=0;4>p;p++){var g=this.Mb.Eq(h,p);if(-1!=g&&0<this.Mb.OT(g)&&q[p].Yb(this.gl))if(this.qt){if(b.L(this.fJ),c.L(this.eJ),a.I(q[p]),a.O(this.ta,this.ta),0<a.fz(b,c)){var n=new f.h;n.I(q[p]);this.Rh.add(g);this.hj.push(n)}}else n=new f.h,
n.I(q[p]),this.Rh.add(g),this.hj.push(n)}if(0==this.Rh.size)return-1;this.Vk=this.Mb.Ts(this.Rh.get(this.Rh.size-1))}}this.Kt=this.Mb.Zv(this.Vk);return this.Vk};c.dR=function(b,d,h){var a=new c;a.Mb=b;a.gl=new f.h;a.Rh=new f.ia(0);a.hj=[];a.Xn(d,h);return a};c.cR=function(b,d,h){var a=new c;a.Mb=b;a.gl=new f.h;a.Rh=new f.ia(0);a.hj=[];a.Ni(d,h);return a};c.bR=function(b){var d=new c;d.Mb=b;d.gl=new f.h;d.Rh=new f.ia(0);d.hj=[];return d};return c}();f.f_=a;var e=function(){function c(b,c){this.Lf=
new f.ad(11);this.yi=new f.ad(5);this.rt=[];this.Vw=new f.ia(0);this.Ga=new f.h;this.ql(b,c)}c.prototype.reset=function(b,c){this.Lf.Vi(!1);this.yi.Vi(!1);this.rt.length=0;this.Vw.clear(!1);this.ql(b,c)};c.prototype.eh=function(b,c){return this.lw(b,c,0,this.Ga,this.Mf,!1,-1)};c.prototype.kw=function(b,c,h){h=-1==h?this.Mf:this.fH(h);var d=this.fa(h),a=this.eT(h);return this.lw(b,c,d,a,h,!1,-1)};c.prototype.ja=function(b){return this.$S(b)};c.prototype.QG=function(b){return this.Iz(this.Sv(b))};c.prototype.fa=
function(b){return this.Uv(b)};c.prototype.eT=function(b){var c=new f.h;c.I(this.Ga);var h=this.Uv(b);b=this.aH(b);for(var a=0;a<2*h;a+=2){var q=f.J.truncate(3&b>>a);0==q?(c.o=.5*(c.o+c.v),c.A=.5*(c.A+c.B)):1==q?(c.v=.5*(c.o+c.v),c.A=.5*(c.A+c.B)):(2==q?c.v=.5*(c.o+c.v):c.o=.5*(c.o+c.v),c.B=.5*(c.A+c.B))}return c};c.prototype.OT=function(b){return this.jA(b)};c.prototype.nT=function(b,c){return a.dR(this,b,c)};c.prototype.Wz=function(b,c){return a.cR(this,b,c)};c.prototype.mf=function(){return a.bR(this)};
c.prototype.ql=function(b,c){if(0>c||32<2*c)throw f.f.F("invalid height");this.yV=c;this.Ga.I(b);this.Mf=this.Lf.Pe();this.Tx(this.Mf,0);this.Nx(this.Mf,0);this.DK(this.Mf,0);this.zK(this.Mf,0)};c.prototype.lw=function(b,d,h,a,q,e,k){if(!a.contains(d))return 0==h?-1:this.lw(b,d,0,this.Ga,this.Mf,e,k);if(!e)for(var l=q;-1!=l;l=this.AT(l))this.Tx(l,this.jA(l)+1);l=new f.h;l.I(a);a=q;var p=[];p[0]=new f.h;p[1]=new f.h;p[2]=new f.h;for(p[3]=new f.h;h<this.yV&&this.hQ(a);h++){c.tK(l,p);for(var v=!1,g=
0;4>g;g++)if(p[g].contains(d)){var v=!0,n=this.Eq(a,g);-1==n&&(n=this.oR(a,g));this.Tx(n,this.jA(n)+1);a=n;l.I(p[g]);break}if(!v)break}return this.mU(b,d,h,l,a,e,q,k)};c.prototype.mU=function(b,c,h,a,f,e,k,p){var d=this.WG(f);if(e){if(f==k)return p;this.OR(p);e=p}else e=this.rR(),this.mC(e,b),this.IX(this.Sv(e),c);this.fY(e,f);-1!=d?(this.Rx(e,d),this.Ox(d,e)):this.vK(f,e);this.pC(f,e);this.Nx(f,this.Xv(f)+1);this.gQ(f)&&this.AS(h,a,f);return e};c.prototype.OR=function(b){var c=this.fH(b),h=this.WG(c),
a=this.GT(b),f=this.Zv(b);this.Ts(c)==b?(-1!=f?this.Rx(f,-1):this.pC(c,-1),this.vK(c,f)):h==b?(this.Ox(a,-1),this.pC(c,a)):(this.Rx(f,a),this.Ox(a,f));this.Rx(b,-1);this.Ox(b,-1);this.Nx(c,this.Xv(c)-1)};c.tK=function(b,c){var d=.5*(b.o+b.v),a=.5*(b.A+b.B);c[0].I(d,a,b.v,b.B);c[1].I(b.o,a,d,b.B);c[2].I(b.o,b.A,d,a);c[3].I(d,b.A,b.v,a)};c.prototype.gQ=function(b){return 8==this.Xv(b)&&!this.sH(b)};c.prototype.AS=function(b,c,h){var d,a,f=this.Ts(h);do a=this.Sv(f),d=this.yi.S(f,0),a=this.Iz(a),this.lw(d,
a,b,c,h,!0,f),f=d=this.Zv(f);while(-1!=f)};c.prototype.hQ=function(b){return 8<=this.Xv(b)||this.sH(b)};c.prototype.sH=function(b){return-1!=this.Eq(b,0)||-1!=this.Eq(b,1)||-1!=this.Eq(b,2)||-1!=this.Eq(b,3)};c.prototype.oR=function(b,c){var d=this.Lf.Pe();this.MX(b,c,d);this.Tx(d,0);this.Nx(d,0);this.sl(d,b);this.zK(d,this.Uv(b)+1);this.DK(d,c<<2*this.Uv(b)|this.aH(b));return d};c.prototype.rR=function(){var b=this.yi.Pe(),c;0<this.Vw.size?(c=this.Vw.Fc(),this.Vw.Pf()):(c=this.rt.length,this.rt.push(new f.h));
this.JX(b,c);return b};c.prototype.Eq=function(b,c){return this.Lf.S(b,c)};c.prototype.MX=function(b,c,h){this.Lf.P(b,c,h)};c.prototype.Ts=function(b){return this.Lf.S(b,4)};c.prototype.vK=function(b,c){this.Lf.P(b,4,c)};c.prototype.WG=function(b){return this.Lf.S(b,5)};c.prototype.pC=function(b,c){this.Lf.P(b,5,c)};c.prototype.aH=function(b){return this.Lf.S(b,6)};c.prototype.DK=function(b,c){this.Lf.P(b,6,c)};c.prototype.Xv=function(b){return this.Lf.S(b,7)};c.prototype.jA=function(b){return this.Lf.S(b,
8)};c.prototype.Nx=function(b,c){this.Lf.P(b,7,c)};c.prototype.Tx=function(b,c){this.Lf.P(b,8,c)};c.prototype.AT=function(b){return this.Lf.S(b,9)};c.prototype.sl=function(b,c){this.Lf.P(b,9,c)};c.prototype.Uv=function(b){return this.Lf.S(b,10)};c.prototype.zK=function(b,c){this.Lf.P(b,10,c)};c.prototype.$S=function(b){return this.yi.S(b,0)};c.prototype.mC=function(b,c){this.yi.P(b,0,c)};c.prototype.GT=function(b){return this.yi.S(b,1)};c.prototype.Zv=function(b){return this.yi.S(b,2)};c.prototype.Rx=
function(b,c){this.yi.P(b,1,c)};c.prototype.Ox=function(b,c){this.yi.P(b,2,c)};c.prototype.fH=function(b){return this.yi.S(b,3)};c.prototype.fY=function(b,c){this.yi.P(b,3,c)};c.prototype.Sv=function(b){return this.yi.S(b,4)};c.prototype.JX=function(b,c){this.yi.P(b,4,c)};c.prototype.Iz=function(b){return this.rt[b]};c.prototype.IX=function(b,c){this.rt[b].I(c)};return c}();f.gq=e})(C||(C={}));(function(a){(function(c){c[c.Outside=0]="Outside";c[c.Inside=1]="Inside";c[c.Border=2]="Border"})(a.yM||
(a.yM={}));var f=function(){function c(b,c){this.Dh=null;this.MV=c;this.Dh=b}c.prototype.Jx=function(b,c){this.tI!=c&&b.flush();this.tI=c};c.prototype.oG=function(b,c){for(var d=0;d<c;)for(var a=b[d++],f=b[d++],e=b[d++]*this.MV;a<f;a++)this.Dh[e+(a>>4)]|=this.tI<<2*(a&15)};return c}();a.h_=f;var e=function(){function c(b,c,h){this.Dh=null;this.xB=this.jl=this.oJ=this.mJ=this.zt=this.BI=this.hg=this.In=0;this.qj=this.kl=this.$l=null;this.jw(b,c,h)}c.create=function(b,d,h){if(!c.az(b))throw a.f.F();
return c.ee(b,d,h)};c.Cj=function(b,d,h){if(!c.az(b))throw a.f.F();return c.se(b,d,h)};c.jX=function(b){switch(b){case 0:b=1024;break;case 1:b=16384;break;case 2:b=262144;break;default:throw a.f.X("Internal Error");}return b};c.az=function(b){return b.u()||1607!=b.G()&&1736!=b.G()?!1:!0};c.prototype.lS=function(b,c){c=c.Da();for(var d=new a.b,f=new a.b;c.Ya();)for(;c.Ca();){var q=c.ba();if(322!=q.G())throw a.f.X("Internal Error");b.$h(q.ec(),d);b.$h(q.Cc(),f);this.qj.Py(d.x,d.y,f.x,f.y)}this.qj.XJ(a.yy.oy)};
c.prototype.mS=function(){throw a.f.X("Internal Error");};c.prototype.Az=function(b,c){for(var d=1;4>d;d++)b.Py(c[d-1].x,c[d-1].y,c[d].x,c[d].y);b.Py(c[3].x,c[3].y,c[0].x,c[0].y);this.qj.XJ(a.yy.oy)};c.prototype.cL=function(b,c,h){for(var d=[null,null,null,null],f=0;f<d.length;f++)d[f]=new a.b;c=c.Da();h=this.kl.XY(h)+1.5;for(var f=new a.b,e=new a.b,k=new a.b,p=new a.b,g=new a.b,n=new a.h,u=new a.b;c.Ya();){var z=!1,r=!0;for(u.ka(0,0);c.Ca();){var t=c.ba();p.x=t.ua;p.y=t.ra;g.x=t.sa;g.y=t.oa;n.Oa();
n.Nb(p.x,p.y);n.ml(g.x,g.y);if(this.$l.SH(n)){this.kl.$h(g,g);r?(this.kl.$h(p,p),u.L(p),r=!1):p.L(u);f.zc(g,p);var t=f.length(),A=.5>t;0==t?f.ka(1,0):(A||u.L(g),f.scale(h/t),e.ka(-f.y,f.x),k.ka(f.y,-f.x),p.sub(f),g.add(f),d[0].add(p,e),d[1].add(p,k),d[2].add(g,k),d[3].add(g,e),A?z=!0:this.Az(b,d))}else z&&(this.Az(b,d),z=!1),r=!0}z&&this.Az(b,d)}};c.prototype.TC=function(b){return a.J.truncate(b*this.BI+this.mJ)};c.prototype.UC=function(b){return a.J.truncate(b*this.zt+this.oJ)};c.ee=function(b,d,
h){return new c(b,d,h)};c.se=function(b,d,h){return new c(b,d,h)};c.prototype.jw=function(b,c,h){this.hg=Math.max(a.J.truncate(2*Math.sqrt(h)+.5),64);this.In=a.J.truncate((2*this.hg+31)/32);this.$l=new a.h;this.jl=c;h=0;for(var d=this.hg,q=this.In;8<=d;)h+=d*q,d=a.J.truncate(d/2),q=a.J.truncate((2*d+31)/32);this.Dh=a.J.gf(h,0);this.qj=new a.yy;h=new f(this.Dh,this.In,this);this.qj.uY(this.hg,this.hg,h);b.s(this.$l);this.$l.O(c,c);var d=new a.h,q=a.h.pa(1,1,this.hg-2,this.hg-2),e=c*q.N();c*=q.fa();
d.I(this.$l.Wf(),Math.max(e,this.$l.N()),Math.max(c,this.$l.fa()));this.xB=this.jl;this.kl=new a.Hd;this.kl.jU(d,q);new a.Hd;switch(b.G()){case 550:h.Jx(this.qj,2);this.mS();break;case 1607:h.Jx(this.qj,2);this.cL(this.qj,b,this.xB);break;case 1736:h.Jx(this.qj,1),this.lS(this.kl,b),h.Jx(this.qj,2),this.cL(this.qj,b,this.xB)}this.BI=this.kl.lb;this.zt=this.kl.gb;this.mJ=this.kl.Wb;this.oJ=this.kl.bc;this.ZP()};c.prototype.ZP=function(){this.qj.flush();for(var b=0,c=this.hg*this.In,h=this.hg,f=a.J.truncate(this.hg/
2),q=this.In,e=a.J.truncate((2*f+31)/32);8<h;){for(h=0;h<f;h++)for(var k=2*h,p=2*h+1,g=0;g<f;g++){var n=2*g,u=2*g+1,z=n>>4,n=2*(n&15),r=u>>4,u=2*(u&15),t=this.Dh[b+q*k+z]>>n&3,t=t|this.Dh[b+q*k+r]>>u&3,t=t|this.Dh[b+q*p+z]>>n&3,t=t|this.Dh[b+q*p+r]>>u&3;this.Dh[c+e*h+(g>>4)]|=t<<2*(g&15)}h=f;q=e;b=c;f=a.J.truncate(h/2);e=a.J.truncate((2*f+31)/32);c=b+q*h}};c.prototype.rm=function(b,c){if(!this.$l.contains(b,c))return 0;b=this.TC(b);c=this.UC(c);if(0>b||b>=this.hg||0>c||c>=this.hg)return 0;b=this.Dh[this.In*
c+(b>>4)]>>2*(b&15)&3;return 0==b?0:1==b?1:2};c.prototype.Sn=function(b){if(!b.Ma(this.$l))return 0;var c=this.TC(b.o),h=this.TC(b.v),f=this.UC(b.A);b=this.UC(b.B);0>c&&(c=0);0>f&&(f=0);h>=this.hg&&(h=this.hg-1);b>=this.hg&&(b=this.hg-1);if(c>h||f>b)return 0;for(var q=Math.max(h-c,1)*Math.max(b-f,1),e=0,k=this.In,p=this.hg,g=0;;){if(32>q||16>p){for(q=f;q<=b;q++)for(var n=c;n<=h;n++)if(g=this.Dh[e+k*q+(n>>4)]>>2*(n&15)&3,1<g)return 2;if(0==g)return 0;if(1==g)return 1}e+=k*p;p=a.J.truncate(p/2);k=a.J.truncate((2*
p+31)/32);c=a.J.truncate(c/2);f=a.J.truncate(f/2);h=a.J.truncate(h/2);b=a.J.truncate(b/2);q=Math.max(h-c,1)*Math.max(b-f,1)}};c.prototype.JT=function(){return this.hg*this.In};return c}();a.wy=e})(C||(C={}));(function(a){(function(c){c[c.contains=1]="contains";c[c.within=2]="within";c[c.equals=3]="equals";c[c.disjoint=4]="disjoint";c[c.touches=8]="touches";c[c.crosses=16]="crosses";c[c.overlaps=32]="overlaps";c[c.unknown=0]="unknown";c[c.intersects=1073741824]="intersects"})(a.QN||(a.QN={}));var f=
function(){function c(){}c.pa=function(b,d,h,a,f,e,k,p){var l=new c;l.ax=b;l.An=d;l.dk=h;l.rj=a;l.QI=f;l.F_=e;l.G_=k;l.H_=p;return l};return c}(),e=function(){function c(){}c.SE=function(b,d,h){if(!c.bz(b))return!1;var f=a.ma.ah(d,b,!1);d=!1;a.wl.IF(b)&&(d=d||b.Wu(f,h));f=b.G();1736!=f&&1607!=f||!a.wl.GF(b)||0==h||(d=d||b.Hj(h));1736!=f&&1607!=f||!a.wl.HF(b)||0==h||(d=d||b.AO());return d};c.bz=function(b){return a.wl.IF(b)||a.wl.GF(b)||a.wl.HF(b)};return c}();a.Fu=e;e=function(){function c(){this.Ph=
[]}c.YB=function(b,d,h,f,q){var l=b.G(),e=d.G();if(197==l){if(197==e)return c.qO(b,d,h,f);if(33==e)return 2==f?f=1:1==f&&(f=2),c.jG(d,b,h,f)}else if(33==l){if(197==e)return c.jG(b,d,h,f);if(33==e)return c.tO(b,d,h,f)}if(b.u()||d.u())return 4==f?!0:!1;var k=new a.h;b.s(k);var p=new a.h;d.s(p);var g=new a.h;g.I(k);g.Nb(p);h=a.ma.be(h,g,!1);if(c.Dk(k,p,h))return 4==f?!0:!1;k=!1;a.xl.Oc(l)&&(l=new a.Ua(b.description),l.dc(b,!0),b=l,l=1607);a.xl.Oc(e)&&(e=new a.Ua(d.description),e.dc(d,!0),d=e,e=1607);
if(197!=l&&197!=e){if(b.tb()<d.tb()||33==l&&550==e)2==f?f=1:1==f&&(f=2)}else 1736!=l&&197!=e&&(2==f?f=1:1==f&&(f=2));switch(l){case 1736:switch(e){case 1736:k=c.fu(b,d,h,f,q);break;case 1607:k=c.Pn(b,d,h,f,q);break;case 33:k=c.eu(b,d,h,f,q);break;case 550:k=c.du(b,d,h,f,q);break;case 197:k=c.cD(b,d,h,f,q)}break;case 1607:switch(e){case 1736:k=c.Pn(d,b,h,f,q);break;case 1607:k=c.LB(b,d,h,f,q);break;case 33:k=c.hu(b,d,h,f,q);break;case 550:k=c.gu(b,d,h,f,q);break;case 197:k=c.qD(b,d,h,f)}break;case 33:switch(e){case 1736:k=
c.eu(d,b,h,f,q);break;case 1607:k=c.hu(d,b,h,f,q);break;case 550:k=c.$t(d,b,h,f,q)}break;case 550:switch(e){case 1736:k=c.du(d,b,h,f,q);break;case 1607:k=c.gu(d,b,h,f,q);break;case 550:k=c.CB(b,d,h,f,q);break;case 33:k=c.$t(b,d,h,f,q);break;case 197:k=c.QJ(b,d,h,f)}break;case 197:switch(e){case 1736:k=c.cD(d,b,h,f,q);break;case 1607:k=c.qD(d,b,h,f);break;case 550:k=c.QJ(d,b,h,f)}}return k};c.qO=function(b,d,h,f){if(b.u()||d.u())return 4==f?!0:!1;var l=new a.h,e=new a.h,k=new a.h;b.s(l);d.s(e);k.I(l);
k.Nb(e);b=a.ma.be(h,k,!1);switch(f){case 4:return c.Dk(l,e,b);case 2:return c.QE(e,l,b);case 1:return c.QE(l,e,b);case 3:return c.We(l,e,b);case 8:return c.BP(l,e,b);case 32:return c.ZO(l,e,b);case 16:return c.CL(l,e,b)}return!1};c.jG=function(b,d,h,f){if(b.u()||d.u())return 4==f?!0:!1;b=b.w();var l=new a.h,e=new a.h;d.s(l);e.I(b);e.Nb(l);d=a.ma.be(h,e,!1);switch(f){case 4:return c.Cx(b,l,d);case 2:return c.WC(b,l,d);case 1:return c.CN(b,l,d);case 3:return c.oL(b,l,d);case 8:return c.VC(b,l,d)}return!1};
c.tO=function(b,d,h,f){if(b.u()||d.u())return 4==f?!0:!1;b=b.w();d=d.w();var l=new a.h;l.I(b);l.Nb(d);h=a.ma.be(h,l,!1);switch(f){case 4:return c.LN(b,d,h);case 2:return c.dL(d,b,h);case 1:return c.dL(b,d,h);case 3:return c.xL(b,d,h)}return!1};c.fu=function(b,d,h,a,f){switch(a){case 4:return c.gS(b,d,h);case 2:return c.Dx(d,b,h,f);case 1:return c.Dx(b,d,h,f);case 3:return c.hU(b,d,h);case 8:return c.kW(b,d,h);case 32:return c.gV(b,d,h,f)}return!1};c.Pn=function(b,d,h,a,f){switch(a){case 4:return c.ES(b,
d,h);case 1:return c.KB(b,d,h,f);case 8:return c.uW(b,d,h,f);case 16:return c.CP(b,d,h)}return!1};c.eu=function(b,d,h,a){switch(a){case 4:return c.VR(b,d,h);case 1:return c.vO(b,d,h);case 8:return c.cW(b,d,h)}return!1};c.du=function(b,d,h,a){switch(a){case 4:return c.AR(b,d,h);case 1:return c.sO(b,d,h);case 8:return c.RV(b,d,h);case 16:return c.sP(b,d,h)}return!1};c.cD=function(b,d,h,a,f){if(c.kQ(b,d,h))return 4==a?!0:!1;if(4==a)return!1;switch(a){case 2:return c.cX(b,d,h);case 1:return c.pO(b,d,
h);case 3:return c.eU(b,d,h);case 8:return c.jV(b,d,h,f);case 32:return c.dV(b,d,h,f);case 16:return c.DL(b,d,h,f)}return!1};c.LB=function(b,d,h,a){switch(a){case 4:return c.xZ(b,d,h);case 2:return c.mD(d,b,h);case 1:return c.mD(b,d,h);case 3:return c.NL(b,d,h);case 8:return c.sD(b,d,h);case 32:return c.bM(b,d,h);case 16:return c.oD(b,d,h)}return!1};c.hu=function(b,d,h,a){switch(a){case 4:return c.vZ(b,d,h);case 1:return c.QY(b,d,h);case 8:return c.xM(b,d,h)}return!1};c.gu=function(b,d,h,a){switch(a){case 4:return c.tZ(b,
d,h);case 1:return c.FX(b,d,h);case 8:return c.mM(b,d,h);case 16:return c.lZ(b,d,h)}return!1};c.qD=function(b,d,h,a){if(c.oZ(b,d,h))return 4==a?!0:!1;if(4==a)return!1;switch(a){case 2:return c.CM(b,d,h);case 1:return c.mX(b,d,h);case 3:return c.HL(b,d,h);case 8:return c.iM(b,d,h);case 32:return c.YL(b,d,h);case 16:return c.dZ(b,d,h)}return!1};c.CB=function(b,d,h,a){switch(a){case 4:return c.QL(b,d,h);case 2:return c.rJ(d,b,h);case 1:return c.rJ(b,d,h);case 3:return c.aM(b,d,h);case 32:return c.GM(b,
d,h)}return!1};c.$t=function(b,d,h,a){switch(a){case 4:return c.zJ(b,d,h);case 2:return c.RM(b,d,h);case 1:return c.nZ(b,d,h);case 3:return c.yx(b,d,h)}return!1};c.QJ=function(b,d,h,a){switch(a){case 4:return c.ML(b,d,h);case 2:return c.NM(b,d,h);case 1:return c.kZ(b,d,h);case 3:return c.XL(b,d,h);case 8:return c.KM(b,d,h);case 16:return c.GL(b,d,h)}return!1};c.hU=function(b,d,h){var f=new a.h,q=new a.h;b.s(f);d.s(q);if(!c.We(f,q,h))return!1;f=c.wc(b,d,!1);if(4==f||1==f||2==f)return!1;if(c.pJ(b,d,
h))return!0;f=b.Rb();q=d.Rb();return Math.abs(f-q)>4*Math.max(b.D(),d.D())*h?!1:c.NB(b,d,h,!0)};c.gS=function(b,d,h){var a=c.wc(b,d,!0);return 4==a?!0:1==a||2==a||1073741824==a?!1:c.aD(b,d,h)};c.kW=function(b,d,h){var a=c.wc(b,d,!1);return 4==a||1==a||2==a?!1:c.gD(b,d,h,null)};c.gV=function(b,d,h,a){var f=c.wc(b,d,!1);return 4==f||1==f||2==f?!1:c.bD(b,d,h,a)};c.Dx=function(b,d,h,f){var l=new a.h,e=new a.h;b.s(l);d.s(e);if(!c.Ec(l,e,h))return!1;l=c.wc(b,d,!1);return 4==l||2==l?!1:1==l?!0:c.AL(b,d,
h,f)};c.ES=function(b,d,h){var a=c.wc(b,d,!0);return 4==a?!0:1==a||1073741824==a?!1:c.aD(b,d,h)};c.uW=function(b,d,h,a){var f=c.wc(b,d,!1);return 4==f||1==f?!1:c.iD(b,d,h,a)};c.CP=function(b,d,h){var a=c.wc(b,d,!1);return 4==a||1==a?!1:c.$C(b,d,h,null)};c.KB=function(b,d,h,f){var l=new a.h,e=new a.h;b.s(l);d.s(e);if(!c.Ec(l,e,h))return!1;l=c.wc(b,d,!1);return 4==l?!1:1==l?!0:c.BL(b,d,h,f)};c.VR=function(b,c,h){return 0==a.gd.VH(b,c,h)?!0:!1};c.cW=function(b,d,h){d=d.w();return c.dD(b,d,h)};c.vO=function(b,
d,h){d=d.w();return c.zL(b,d,h)};c.AR=function(b,d,h){var f=c.wc(b,d,!1);if(4==f)return!0;if(1==f)return!1;f=new a.h;b.s(f);f.O(h,h);for(var q=new a.b,e=0;e<d.D();e++)if(d.w(e,q),f.contains(q)){var k=a.gd.fe(b,q,h);if(1==k||2==k)return!1}return!0};c.RV=function(b,c,h){var d=this.wc(b,c,!1);if(4==d||1==d)return!1;d=new a.h;b.s(d);d.O(h,h);var f,e=!1,k;k=b;for(var p=!1,g=0;g<c.D();g++){f=c.Aa(g);if(d.contains(f))if(f=a.gd.fe(k,f,h),2==f)e=!0;else if(1==f)return!1;p||(!a.ff.qm(b,c.D()-1)||null!=b.ob&&
null!=b.ob.Mb?k=b:(k=new a.Ia,b.copyTo(k),k.Hj(1)),p=!0)}return e?!0:!1};c.sP=function(b,c,h){var d=this.wc(b,c,!1);if(4==d||1==d)return!1;var f=new a.h,d=new a.h,e=new a.h;b.s(f);c.s(e);d.I(f);d.O(h,h);var e=f=!1,k,p;p=b;for(var g=!1,n=0;n<c.D();n++){k=c.Aa(n);d.contains(k)?(k=a.gd.fe(p,k,h),0==k?e=!0:1==k&&(f=!0)):e=!0;if(f&&e)return!0;g||(!a.ff.qm(b,c.D()-1)||null!=b.ob&&null!=b.ob.Mb?p=b:(p=new a.Ia,b.copyTo(p),p.Hj(1)),g=!0)}return!1};c.sO=function(b,c,h){var d=new a.h,f=new a.h;b.s(d);c.s(f);
if(!this.Ec(d,f,h))return!1;f=this.wc(b,c,!1);if(4==f)return!1;if(1==f)return!0;var f=!1,e,k;k=b;for(var p=!1,g=0;g<c.D();g++){e=c.Aa(g);if(!d.contains(e))return!1;e=a.gd.fe(k,e,h);if(1==e)f=!0;else if(0==e)return!1;p||(!a.ff.qm(b,c.D()-1)||null!=b.ob&&null!=b.ob.Mb?k=b:(k=new a.Ia,b.copyTo(k),k.Hj(1)),p=!0)}return f};c.eU=function(b,d,h){var f=new a.h,q=new a.h;b.s(f);d.s(q);if(!c.We(f,q,h))return!1;f=new a.Ia;f.jd(d,!1);return c.NB(b,f,h,!0)};c.kQ=function(b,d,h){var f=c.wc(b,d,!1);if(4==f)return!0;
if(1==f||2==f)return!1;var q=new a.h,f=new a.h;b.s(q);d.s(f);if(c.Ec(f,q,h))return!1;q=new a.b;f.Un(q);d=a.gd.fe(b,q,h);if(0!=d)return!1;f.SJ(q);d=a.gd.fe(b,q,h);if(0!=d)return!1;f.Vn(q);d=a.gd.fe(b,q,h);if(0!=d)return!1;f.VJ(q);d=a.gd.fe(b,q,h);if(0!=d)return!1;d=b.Pa(0);q=new a.h;q.I(f);q.O(h,h);for(var e=0,k=b.D();e<k;e++){var p=d.read(2*e),g=d.read(2*e+1);if(q.contains(p,g))return!1}return!c.WH(b,f,h)};c.jV=function(b,d,h,f){var l=c.wc(b,d,!1);if(4==l||1==l||2==l)return!1;var l=new a.h,e=new a.h;
b.s(l);d.s(e);if(c.Ec(e,l,h))return!1;if(e.N()<=h&&e.fa()<=h)return d=d.Bq(),c.dD(b,d,h);if(e.N()<=h||e.fa()<=h)return l=new a.Ua,e=new a.Wa,d.ig(0,e),l.Rf(e),d.ig(2,e),l.lineTo(e),c.iD(b,l,h,f);l=new a.Ia;l.jd(d,!1);return c.gD(b,l,h,f)};c.dV=function(b,d,h,f){var l=c.wc(b,d,!1);if(4==l||1==l||2==l)return!1;var l=new a.h,e=new a.h;b.s(l);d.s(e);if(c.Ec(e,l,h)||e.N()<=h||e.fa()<=h)return!1;l=new a.Ia;l.jd(d,!1);return c.bD(b,l,h,f)};c.cX=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return c.Ec(e,
f,h)};c.pO=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(!c.Ec(f,e,h))return!1;f=c.wc(b,d,!1);if(4==f||2==f)return!1;if(1==f)return!0;if(e.N()<=h&&e.fa()<=h)return d=d.Bq(),c.zL(b,d,h);if(e.N()<=h||e.fa()<=h)return e=new a.Ua,f=new a.Wa,d.ig(0,f),e.Rf(f),d.ig(2,f),e.lineTo(f),c.BL(b,e,h,null);e=new a.Ia;e.jd(d,!1);return c.AL(b,e,h,null)};c.DL=function(b,d,h,f){var l=new a.h,e=new a.h;b.s(l);d.s(e);if(c.Ec(e,l,h)||e.fa()>h&&e.N()>h||e.fa()<=h&&e.N()<=h)return!1;l=new a.Ua;e=new a.Wa;d.ig(0,
e);l.Rf(e);d.ig(2,e);l.lineTo(e);return c.$C(b,l,h,f)};c.NL=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return c.We(f,e,h)&&4!=c.wc(b,d,!1)?c.pJ(b,d,h)?!0:c.NB(b,d,h,!1):!1};c.xZ=function(b,c,h){return 4==this.wc(b,c,!1)?!0:(new a.Mm(b,c,h,!0)).next()?!this.eI(b,c,h):!1};c.sD=function(b,d,h){if(4==c.wc(b,d,!1))return!1;var f=new a.Sd(0);if(0!=c.QB(b,d,h,f))return!1;for(var e=new a.Ed,k=0;k<f.size;k+=2){var p=f.read(k),g=f.read(k+1);e.kv(p,g)}b=b.Gg();d=d.Gg();b.Jd(d,0,d.D());return c.xx(b,
e,h)};c.oD=function(b,d,h){if(4==c.wc(b,d,!1))return!1;var f=new a.Sd(0);if(0!=c.QB(b,d,h,f))return!1;for(var e=new a.Ed,k=0;k<f.size;k+=2){var p=f.read(k),g=f.read(k+1);e.kv(p,g)}b=b.Gg();d=d.Gg();b.Jd(d,0,d.D());return!c.xx(b,e,h)};c.bM=function(b,d,h){return 4==c.wc(b,d,!1)?!1:c.ZH(b,d,h)};c.mD=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return c.Ec(f,e,h)&&4!=c.wc(b,d,!1)?c.Wg(d,b,h,!1):!1};c.vZ=function(b,d,h){if(4==c.wc(b,d,!1))return!0;d=d.w();return!c.GA(b,d,h)};c.xM=function(b,
d,h){if(4==c.wc(b,d,!1))return!1;d=d.w();return c.fC(b,d,h)};c.QY=function(b,d,h){if(4==c.wc(b,d,!1))return!1;d=d.w();return c.xH(b,d,h)};c.tZ=function(b,d,h){return 4==c.wc(b,d,!1)?!0:!c.YH(b,d,h,!1)};c.mM=function(b,c,h){if(4==this.wc(b,c,!1))return!1;var d=b.Da(),f=new a.h,e=new a.h,k=new a.h;b.s(f);c.s(e);f.O(h,h);e.O(h,h);k.I(f);k.Ma(e);var p,g,f=null;p=b.ob;null!=p?(g=p.Mb,f=p.np,null==g&&(g=p=a.ma.Lj(b,k))):g=p=a.ma.Lj(b,k);var n=g.mf(),u=null;null!=f&&(u=f.mf());var z=new a.b,r=new a.b,t=
!1,A=h*h,f=new a.Gm(c.D());for(p=0;p<c.D();p++)f.write(p,0);for(p=0;p<c.D();p++)if(c.w(p,z),k.contains(z))if(e.I(z.x,z.y,z.x,z.y),null==u||(u.Ni(e,h),-1!=u.next())){n.Ni(e,h);for(var w=n.next();-1!=w;w=n.next())if(d.Tb(g.ja(w)),w=d.ba(),w.gc(w.oe(z,!1),r),a.b.sc(z,r)<=A){f.write(p,1);t=!0;break}}if(!t)return!1;b=b.Gg();d=new a.Ed;e=new a.b;for(p=0;p<c.D();p++)0!=f.read(p)&&(c.w(p,e),d.kv(e.x,e.y));return this.xx(b,d,h)};c.lZ=function(b,c,h){if(4==this.wc(b,c,!1))return!1;var d=b.Da(),f=new a.h,e=
new a.h,k=new a.h;b.s(f);c.s(e);f.O(h,h);e.O(h,h);k.I(f);k.Ma(e);var p,g,f=null;p=b.ob;null!=p?(g=p.Mb,f=p.np,null==g&&(g=p=a.ma.Lj(b,k))):g=p=a.ma.Lj(b,k);var n=g.mf(),u=null;null!=f&&(u=f.mf());var z=new a.b,r=new a.b,t=!1,A=!1,w=h*h,f=new a.Gm(c.D());for(p=0;p<c.D();p++)f.write(p,0);for(p=0;p<c.D();p++)if(c.w(p,z),k.contains(z))if(e.I(z.x,z.y,z.x,z.y),null!=u&&(u.Ni(e,h),-1==u.next()))A=!0;else{n.Ni(e,h);for(var m=!1,x=n.next();-1!=x;x=n.next())if(d.Tb(g.ja(x)),x=d.ba(),x.gc(x.oe(z,!1),r),a.b.sc(z,
r)<=w){f.write(p,1);m=t=!0;break}m||(A=!0)}else A=!0;if(!t||!A)return!1;b=b.Gg();d=new a.Ed;e=new a.b;for(p=0;p<c.D();p++)0!=f.read(p)&&(c.w(p,e),d.kv(e.x,e.y));return!this.xx(b,d,h)};c.FX=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(!c.Ec(f,e,h)||4==c.wc(b,d,!1)||!c.YH(b,d,h,!0))return!1;b=b.Gg();return!c.BJ(b,d,h)};c.HL=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return e.fa()>h&&e.N()>h?!1:c.We(f,e,h)};c.oZ=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return c.Ec(e,
f,h)?!1:!c.WH(b,e,h)};c.iM=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(e.fa()<=h&&e.N()<=h)return e=d.Bq(),c.fC(b,e,h);if(e.fa()<=h||e.N()<=h)return e=new a.Ua,f=new a.Wa,d.ig(0,f),e.Rf(f),d.ig(2,f),e.lineTo(f),c.sD(b,e,h);b=b.Da();d=new a.h;f=new a.h;d.I(e);f.I(e);d.O(-h,-h);f.O(h,h);for(var e=!1,k=new a.h,p=new a.h;b.Ya();)for(;b.Ca();){b.ba().s(k);p.I(d);p.Ma(k);if(!p.u()&&(p.fa()>h||p.N()>h))return!1;p.I(f);p.Ma(k);p.u()||(e=!0)}return e};c.YL=function(b,d,h){var f=new a.h,e=new a.h;
b.s(f);d.s(e);if(c.Ec(f,e,h)||c.Ec(e,f,h)||c.Ec(e,f,h)||e.fa()>h&&e.N()>h||e.fa()<=h&&e.N()<=h)return!1;f=new a.Ua;e=new a.Wa;d.ig(0,e);f.Rf(e);d.ig(2,e);f.lineTo(e);return c.ZH(b,f,h)};c.CM=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(!c.Ec(e,f,h)||e.fa()<=h&&e.N()<=h)return!1;if(e.fa()<=h||e.N()<=h)return c.Ec(e,f,h);b=b.Da();d=new a.h;d.I(e);d.O(-h,-h);for(var e=!1,f=new a.h,k=new a.h;b.Ya();)for(;b.Ca();)b.ba().s(f),d.Um(f)?e=!0:(k.I(d),k.Ma(f),!k.u()&&(k.fa()>h||k.N()>h)&&(e=!0));
return e};c.mX=function(b,d,h){var f=new a.h,e=new a.h;d.s(e);b.s(f);if(!c.Ec(f,e,h)||e.fa()>h&&e.N()>h)return!1;if(e.fa()<=h&&e.N()<=h)return d=d.Bq(),c.xH(b,d,h);f=new a.Ua;e=new a.Wa;d.ig(0,e);f.Rf(e);d.ig(2,e);f.lineTo(e);return c.Wg(f,b,h,!1)};c.dZ=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(c.Ec(e,f,h)||e.fa()<=h&&e.N()<=h)return!1;if(e.fa()<=h||e.N()<=h)return f=new a.Ua,e=new a.Wa,d.ig(0,e),f.Rf(e),d.ig(2,e),f.lineTo(e),c.oD(b,f,h);b=b.Da();d=new a.h;f=new a.h;f.I(e);d.I(e);f.O(-h,
-h);d.O(h,h);for(var k=e=!1,p=new a.h,g=new a.h;b.Ya();)for(;b.Ca();)if(b.ba().s(p),k||d.contains(p)||(k=!0),e||(g.I(f),g.Ma(p),!g.u()&&(g.fa()>h||g.N()>h)&&(e=!0)),e&&k)return!0;return!1};c.aM=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return c.We(f,e,h)?c.hM(b,d,h)?!0:c.PC(b,d,h,!1,!0,!1):!1};c.QL=function(b,d,h){return!c.BJ(b,d,h)};c.GM=function(b,d,h){return c.PC(b,d,h,!1,!1,!0)};c.rJ=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return c.Ec(f,e,h)?c.PC(d,b,h,!0,!1,!1):!1};
c.xx=function(b,c,h){h*=h;for(var d=new a.b,f=new a.b,e=0;e<c.D();e++){c.w(e,f);for(var k=!1,p=0;p<b.D();p++)if(b.w(p,d),a.b.sc(d,f)<=h){k=!0;break}if(!k)return!1}return!0};c.yx=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return c.We(f,e,h)};c.zJ=function(b,d,h){d=d.w();return c.Zt(b,d,h)};c.RM=function(b,d,h){return c.yx(b,d,h)};c.nZ=function(b,d,h){return!c.zJ(b,d,h)};c.XL=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);return e.fa()>h||e.N()>h?!1:c.We(f,e,h)};c.ML=function(b,d,
h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(c.Ec(e,f,h))return!1;d=new a.h;d.I(e);d.O(h,h);h=new a.b;for(e=0;e<b.D();e++)if(b.w(e,h),d.contains(h))return!1;return!0};c.KM=function(b,c,h){var d=new a.h,f=new a.h,e=new a.h;c.s(d);if(d.fa()<=h&&d.N()<=h)return!1;if(d.fa()<=h||d.N()<=h){c=new a.b;var k=!1;f.I(d);e.I(d);f.O(h,h);d.fa()>h?e.O(0,-h):e.O(-h,0);for(var p=0;p<b.D();p++)if(b.w(p,c),f.contains(c)){if(d.fa()>h){if(c.y>e.A&&c.y<e.B)return!1}else if(c.x>e.o&&c.x<e.v)return!1;k=!0}return k}f.I(d);
e.I(d);f.O(h,h);e.O(-h,-h);c=new a.b;k=!1;for(p=0;p<b.D();p++)if(b.w(p,c),f.contains(c)){if(e.Um(c))return!1;k=!0}return k};c.NM=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(!c.Ec(e,f,h))return!1;if(e.fa()<=h&&e.N()<=h)return c.We(f,e,h);if(e.fa()<=h||e.N()<=h){d=!1;var f=new a.h,k=new a.h;f.I(e);k.I(e);e.fa()>h?f.O(0,-h):f.O(-h,0);k.O(h,h);for(var p=new a.b,g=0;g<b.D();g++){b.w(g,p);if(!k.contains(p))return!1;e.fa()>h?p.y>f.A&&p.y<f.B&&(d=!0):p.x>f.o&&p.x<f.v&&(d=!0)}return d}d=!1;f=
new a.h;k=new a.h;f.I(e);k.I(e);f.O(-h,-h);k.O(h,h);p=new a.b;for(g=0;g<b.D();g++){b.w(g,p);if(!k.contains(p))return!1;f.Um(p)&&(d=!0)}return d};c.kZ=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(!c.Ec(f,e,h)||e.fa()>h||e.N()>h)return!1;d=d.Bq();return!c.Zt(b,d,h)};c.GL=function(b,d,h){var f=new a.h,e=new a.h;b.s(f);d.s(e);if(c.Ec(e,f,h)||e.fa()<=h&&e.N()<=h)return!1;if(e.fa()<=h||e.N()<=h){d=new a.h;f=new a.h;d.I(e);e.fa()>h?d.O(0,-h):d.O(-h,0);f.I(e);f.O(h,h);for(var k=new a.b,p=!1,g=
!1,n=0;n<b.D();n++)if(b.w(n,k),p||(e.fa()>h?k.y>d.A&&k.y<d.B&&(p=!0):k.x>d.o&&k.x<d.v&&(p=!0)),g||f.contains(k)||(g=!0),p&&g)return!0;return!1}d=new a.h;f=new a.h;d.I(e);d.O(-h,-h);f.I(e);f.O(h,h);k=new a.b;g=p=!1;for(n=0;n<b.D();n++)if(b.w(n,k),!p&&d.Um(k)&&(p=!0),g||f.contains(k)||(g=!0),p&&g)return!0;return!1};c.xL=function(b,c,h){return a.b.sc(b,c)<=h*h?!0:!1};c.LN=function(b,c,h){return a.b.sc(b,c)>h*h?!0:!1};c.dL=function(b,d,h){return c.xL(b,d,h)};c.oL=function(b,d,h){var f=new a.h;f.I(b);
return c.We(f,d,h)};c.Cx=function(b,c,h){var d=new a.h;d.I(c);d.O(h,h);return!d.contains(b)};c.VC=function(b,c,h){if(c.fa()<=h&&c.N()<=h)return!1;var d=new a.h,f=new a.h;d.I(c);d.O(h,h);if(!d.contains(b))return!1;if(c.fa()<=h||c.N()<=h){f.I(c);c.fa()>h?f.O(0,-h):f.O(-h,0);if(c.fa()>h){if(b.y>f.A&&b.y<f.B)return!1}else if(b.x>f.o&&b.x<f.v)return!1;return!0}f.I(c);f.O(-h,-h);return f.Um(b)?!1:!0};c.WC=function(b,c,h){if(c.fa()<=h&&c.N()<=h)return!0;if(c.fa()<=h||c.N()<=h){var d=new a.h;d.I(c);c.fa()>
h?d.O(0,-h):d.O(-h,0);var f=!1;c.fa()>h?b.y>d.A&&b.y<d.B&&(f=!0):b.x>d.o&&b.x<d.v&&(f=!0);return f}d=new a.h;d.I(c);d.O(-h,-h);return d.Um(b)};c.CN=function(b,d,h){return c.oL(b,d,h)};c.We=function(b,d,h){return c.Ec(b,d,h)&&c.Ec(d,b,h)};c.Dk=function(b,c,h){var d=new a.h;d.I(c);d.O(h,h);return!b.Yb(d)};c.BP=function(b,d,h){if(b.fa()<=h&&b.N()<=h){var f=b.Wf();return c.VC(f,d,h)}if(d.fa()<=h&&d.N()<=h)return f=d.Wf(),c.VC(f,b,h);b.fa()>h&&b.N()>h&&(d.fa()<=h||d.N()<=h)?f=d:(f=b,b=d);if(f.fa()<=h||
f.N()<=h){if(b.fa()<=h||b.N()<=h){d=new a.Hb;var e=new a.Hb,k=[0,0],p=[0,0],g=new a.b;f.Un(g);d.Mc(g);f.Vn(g);d.Zc(g);b.Un(g);e.Mc(g);b.Vn(g);e.Zc(g);d.Ma(e,null,k,p,h);return 1!=d.Ma(e,null,null,null,h)?!1:0==k[0]||1==k[1]||0==p[0]||1==p[1]}d=new a.h;e=new a.h;d.I(b);d.O(-h,-h);e.I(d);e.Ma(f);return!e.u()&&(e.fa()>h||e.N()>h)?!1:!0}b.O(h,h);e=new a.h;e.I(f);e.Ma(b);return e.u()||!e.u()&&e.fa()>h&&e.N()>h?!1:!0};c.ZO=function(b,d,h){if(c.Ec(b,d,h)||c.Ec(d,b,h)||b.fa()<=h&&b.N()<=h||d.fa()<=h&&d.N()<=
h)return!1;if(b.fa()<=h||b.N()<=h){if(d.fa()>h&&d.N()>h)return!1;var f=new a.Hb,e=new a.Hb,k=[0,0],p=[0,0],g=new a.b;b.Un(g);f.Mc(g);b.Vn(g);f.Zc(g);d.Un(g);e.Mc(g);d.Vn(g);e.Zc(g);f.Ma(e,null,k,p,h);return 2!=f.Ma(e,null,null,null,h)?!1:(0<k[0]||1>k[1])&&(0<p[0]||1>p[1])}if(d.fa()<=h||d.N()<=h)return!1;f=new a.h;f.I(b);f.Ma(d);return f.u()||f.fa()<=h||f.N()<=h?!1:!0};c.QE=function(b,d,h){if(!c.Ec(b,d,h))return!1;if(b.fa()<=h&&b.N()<=h)return b=b.Wf(),c.WC(b,d,h);if(d.fa()<=h&&d.N()<=h)return d=d.Wf(),
c.WC(d,b,h);if(b.fa()<=h||b.N()<=h)return c.Ec(b,d,h);if(d.fa()<=h||d.N()<=h){var f=new a.h;f.I(b);f.O(-h,-h);if(f.Um(d))return!0;b=new a.h;b.I(f);b.Ma(d);return b.u()||b.fa()<=h&&b.N()<=h?!1:!0}return c.Ec(b,d,h)};c.CL=function(b,d,h){if(c.Ec(b,d,h)||c.Ec(d,b,h)||b.fa()<=h&&b.N()<=h||d.fa()<=h&&d.N()<=h||d.fa()>h&&d.N()>h&&b.fa()>h&&b.N()>h)return!1;var f;b.fa()>h&&b.N()>h?f=d:(f=b,b=d);if(b.fa()>h&&b.N()>h){d=new a.h;var e=new a.h;e.I(b);e.O(-h,-h);d.I(e);d.Ma(f);return d.u()||d.fa()<=h&&d.N()<=
h?!1:!0}d=new a.Hb;var e=new a.Hb,k=[0,0],p=[0,0],g=new a.b;f.Un(g);d.Mc(g);f.Vn(g);d.Zc(g);b.Un(g);e.Mc(g);b.Vn(g);e.Zc(g);d.Ma(e,null,k,p,h);return 1!=d.Ma(e,null,null,null,h)?!1:0<k[0]&&1>k[1]&&0<p[0]&&1>p[1]};c.aD=function(b,c,h){var d,f,e=new a.h,k=new a.h,p=new a.Mm(b,c,h,!0);if(!p.next())return!0;if(this.eI(b,c,h))return!1;var g;g=b;var n;n=null;1736==c.G()&&(n=c);var u=!1,z=!1;do{d=p.Ql();f=p.Ml();f=c.Aa(c.wa(f));e.I(p.dA());e.O(h,h);if(e.contains(f)&&(f=a.gd.fe(g,f,0),0!=f)||1736==c.G()&&
(d=b.Aa(b.wa(d)),k.I(p.Hz()),k.O(h,h),k.contains(d)&&(f=a.gd.fe(n,d,0),0!=f)))return!1;u||(!a.ff.qm(b,c.aa()-1)||null!=b.ob&&null!=b.ob.Mb?g=b:(g=new a.Ia,b.copyTo(g),g.Hj(1)),u=!0);1736!=c.G()||z||(z=c,!a.ff.qm(z,b.aa()-1)||null!=c.ob&&null!=c.ob.Mb?n=c:(n=new a.Ia,z.copyTo(n),n.Hj(1)),z=!0)}while(p.next());return!0};c.Ec=function(b,c,h){var d=new a.h;d.I(b);d.O(h,h);return d.contains(c)};c.Yp=function(b,c,h){var d=new a.h;d.I(c);d.O(h,h);c=new a.b;b.Un(c);if(!d.contains(c))return!0;b.SJ(c);if(!d.contains(c))return!0;
b.VJ(c);if(!d.contains(c))return!0;b.Vn(c);return d.contains(c)?!1:!0};c.pJ=function(b,c,h){if(b.aa()!=c.aa()||b.D()!=c.D())return!1;var d=new a.b,f=new a.b,e=!0;h*=h;for(var k=0;k<b.aa();k++){if(b.Gc(k)!=c.Gc(k)){e=!1;break}for(var p=b.wa(k);p<c.Gc(k);p++)if(b.w(p,d),c.w(p,f),a.b.sc(d,f)>h){e=!1;break}if(!e)break}return e?!0:!1};c.hM=function(b,c,h){if(b.D()!=c.D())return!1;var d=new a.b,f=new a.b,e=!0;h*=h;for(var k=0;k<b.D();k++)if(b.w(k,d),c.w(k,f),a.b.sc(d,f)>h){e=!1;break}return e?!0:!1};c.PC=
function(b,c,h,f,e,k){var d=!1,l;b.D()>c.D()?(f&&(f=!1,d=!0),l=c):(l=b,b=c);c=null;if(e||k||d){c=new a.Gm(b.D());for(var q=0;q<b.D();q++)c.write(q,0)}var q=new a.h,p=new a.h,g=new a.h;l.s(q);b.s(p);q.O(h,h);p.O(h,h);g.I(q);g.Ma(p);for(var p=new a.b,n=new a.b,v=!0,u=a.ma.AF(b,g),z=u.mf(),r=h*h,t=0;t<l.D();t++)if(l.w(t,p),g.contains(p)){var A=!1;q.I(p.x,p.y,p.x,p.y);z.Ni(q,h);for(var w=z.next();-1!=w&&!(w=u.ja(w),b.w(w,n),a.b.sc(p,n)<=r&&((e||k||d)&&c.write(w,1),A=!0,f));w=z.next());if(!A&&(v=!1,e||
f))return!1}else{if(e||f)return!1;v=!1}if(k&&v)return!1;if(f)return!0;for(q=0;q<b.D();q++)if(1==c.read(q)){if(k)return!0}else if(e||d)return!1;return k?!1:!0};c.BJ=function(b,c,h){var d;b.D()>c.D()?d=c:(d=b,b=c);c=new a.h;var f=new a.h,e=new a.h;d.s(c);b.s(f);c.O(h,h);f.O(h,h);e.I(c);e.Ma(f);for(var f=new a.b,k=new a.b,p=h*h,g=a.ma.AF(b,e),n=g.mf(),u=0;u<d.D();u++)if(d.w(u,f),e.contains(f)){c.I(f.x,f.y,f.x,f.y);n.Ni(c,h);for(var z=n.next();-1!=z;z=n.next())if(b.w(g.ja(z),k),a.b.sc(f,k)<=p)return!0}return!1};
c.NB=function(b,d,h,a){return c.Wg(b,d,h,a)&&c.Wg(d,b,h,a)};c.Wg=function(b,d,h,l){function e(b,c){return z.VF(b,c)}var k=!0,p=[0,0],g=[0,0],n=0,u=new a.ia(0),z=new c,r,t=new a.h,A=new a.h,w=new a.h;b.s(t);d.s(A);t.O(h,h);A.O(h,h);w.I(t);w.Ma(A);b=b.Da();var A=d.Da(),m=null,x=m=null,C=d.ob;null!=C?(m=C.Mb,x=C.np,null==m&&(m=a.ma.Lj(d,w))):m=a.ma.Lj(d,w);d=m.mf();C=null;for(null!=x&&(C=x.mf());b.Ya();)for(;b.Ca();){var I=!1,J=b.ba();J.s(t);if(!t.Yb(w))return!1;if(null!=C&&(C.Ni(t,h),-1==C.next()))return k=
!1;x=J.Rb();d.Xn(J,h);for(r=d.next();-1!=r;r=d.next()){A.Tb(m.ja(r));r=A.ba();var K=J.Ma(r,null,p,g,h);if(2==K&&(!l||g[0]<=g[1])){var K=p[0],y=p[1],M=g[0],E=g[1];if(K*x<=h&&(1-y)*x<=h){I=!0;n=0;u.resize(0);z.Ph.length=0;for(var O=b.Db(),M=!0;M;){if(b.Ca()){J=b.ba();x=J.Rb();K=J.Ma(r,null,p,g,h);if(2==K&&(!l||g[0]<=g[1])&&(K=p[0],y=p[1],K*x<=h&&(1-y)*x<=h)){O=b.Db();continue}if(A.Ca()&&(r=A.ba(),K=J.Ma(r,null,p,g,h),2==K&&(!l||g[0]<=g[1])&&(K=p[0],y=p[1],K*x<=h&&(1-y)*x<=h))){O=b.Db();continue}}M=
!1}O!=b.Db()&&(b.Tb(O),b.ba());break}else O=b.Db(),r=f.pa(O,b.Ta,K,y,A.Db(),A.Ta,M,E),z.Ph.push(r),u.add(u.size)}}if(!I){if(n==z.Ph.length)return!1;1<u.size-n&&u.Gd(n,u.size,e);for(I=0;n<z.Ph.length;n++)if(r=z.Ph[u.get(n)],!(r.dk<I&&r.rj<I)){if(x*(r.dk-I)>h)return!1;I=r.rj;if(x*(1-I)<=h||1==I)break}if(x*(1-I)>h)return!1;n=0;u.resize(0);z.Ph.length=0}}return k};c.ZH=function(b,d,h){if(1>c.QB(b,d,h,null))return!1;var f=new a.h,e=new a.h;b.s(f);d.s(e);var k=c.Yp(f,e,h),f=c.Yp(e,f,h);return k&&f?!0:k&&
!f?!c.Wg(d,b,h,!1):f&&!k?!c.Wg(b,d,h,!1):!c.Wg(b,d,h,!1)&&!c.Wg(d,b,h,!1)};c.QB=function(b,d,h,l){function e(b,c){return A.VF(b,c)}var k,p;b.hA()>d.hA()?(k=d,p=b):(k=b,p=d);b=k.Da();d=p.Da();var g=[0,0],n=[0,0],u=-1,z=0,r,t=new a.ia(0),A=new c,w,m=new a.h,x=new a.h,C=new a.h;k.s(m);p.s(x);m.O(h,h);x.O(h,h);C.I(m);C.Ma(x);k=null;null!=l&&(k=new a.b);r=x=x=null;var I=p.ob;null!=I?(x=I.Mb,r=I.np,null==x&&(x=a.ma.Lj(p,C))):x=a.ma.Lj(p,C);p=x.mf();I=null;for(null!=r&&(I=r.mf());b.Ya();)for(r=0;b.Ca();){var J=
b.ba();J.s(m);if(m.Yb(C)&&(null==I||(I.Ni(m,h),-1!=I.next()))){var K=J.Rb();p.Xn(J,h);for(var y=p.next();-1!=y;y=p.next()){var M=x.ja(y);d.Tb(M);w=d.ba();var E=w.Rb(),O=J.Ma(w,null,g,n,h);if(0<O){var y=g[0],u=n[0],P=2==O?g[1]:NaN,L=2==O?n[1]:NaN;if(2==O){if(K*(P-y)>h)return u=1;var N=K*(P-y);if(d.Ca()){w=d.ba();O=J.Ma(w,null,g,null,h);if(2==O){var O=g[0],B=g[1],O=K*(B-O);if(N+O>h)return u=1}d.Tb(M);d.ba()}if(!d.kn()){d.Li();w=d.Li();O=J.Ma(w,null,g,null,h);if(2==O&&(O=g[0],B=g[1],O=K*(B-O),N+O>h))return u=
1;d.Tb(M);d.ba()}if(b.Ca()){M=b.Db();J=b.ba();O=J.Ma(w,null,g,null,h);if(2==O&&(O=g[0],B=g[1],O=K*(B-O),N+O>h))return u=1;b.Tb(M);b.ba()}if(!b.kn()){M=b.Db();b.Li();J=b.Li();O=J.Ma(w,null,g,null,h);if(2==O&&(O=g[0],B=g[1],O=E*(B-O),N+O>h))return u=1;b.Tb(M);b.ba()}w=f.pa(b.Db(),b.Ta,y,P,d.Db(),d.Ta,u,L);A.Ph.push(w);t.add(t.size)}u=0;null!=l&&(J.gc(y,k),l.add(k.x),l.add(k.y))}}if(z<A.Ph.length){t.Gd(z,t.size,e);J=0;for(y=A.Ph[t.get(z)].An;z<A.Ph.length;z++)if(w=A.Ph[t.get(z)],!(w.dk<J&&w.rj<J))if(K*
(w.dk-J)>h)r=K*(w.rj-w.dk),J=w.rj,y=w.An;else{w.An!=y?(r=K*(w.rj-w.dk),y=w.An):r+=K*(w.rj-w.dk);if(r>h)return u=1;J=w.rj;if(1==J)break}K*(1-J)>h&&(r=0);z=0;t.resize(0);A.Ph.length=0}}}return u};c.eI=function(b,c,h){var d=b.Da(),f=c.Da();for(b=new a.Mm(b,c,h,!1);b.next();){c=b.Ql();var e=b.Ml();d.Tb(c);f.Tb(e);c=d.ba();if(0<f.ba().Ma(c,null,null,null,h))return!0}return!1};c.YH=function(b,c,h,f){var d=b.Da(),l=new a.h,e=new a.h,k=new a.h;b.s(l);c.s(e);l.O(h,h);l.contains(e);e.O(h,h);k.I(l);k.Ma(e);
l=b.ob;null!=l?(l=l.Mb,null==l&&(l=a.ma.Lj(b,k))):l=a.ma.Lj(b,k);b=l.mf();for(var p=new a.b,g=new a.b,n=h*h,u=0;u<c.D();u++)if(c.w(u,p),k.contains(p)){e.I(p.x,p.y,p.x,p.y);b.Ni(e,h);for(var z=!1,r=b.next();-1!=r;r=b.next())if(d.Tb(l.ja(r)),r=d.ba(),r.gc(r.oe(p,!1),g),a.b.sc(g,p)<=n){z=!0;break}if(f){if(!z)return!1}else if(z)return!0}return f?!0:!1};c.GA=function(b,c,h){var d=new a.b,f=h*h,e=b.Da();b=b.ob;if(null!=b&&(b=b.Mb,null!=b)){var k=new a.h;k.I(c);h=b.Wz(k,h);for(k=h.next();-1!=k;k=h.next())if(e.Tb(b.ja(k)),
e.Ca()){var k=e.ba(),p=k.oe(c,!1);k.gc(p,d);if(a.b.sc(c,d)<=f)return!0}return!1}for(b=new a.h;e.Ya();)for(;e.Ca();)if(k=e.ba(),k.s(b),b.O(h,h),b.contains(c)&&(p=k.oe(c,!1),k.gc(p,d),a.b.sc(c,d)<=f))return!0;return!1};c.xH=function(b,d,h){return c.GA(b,d,h)&&!c.fC(b,d,h)};c.fC=function(b,d,h){b=b.Gg();return!c.Zt(b,d,h)};c.WH=function(b,c,h){if(b.jn()){var d=new a.Hb(c.o,c.A,c.o,c.B),f=new a.Hb(c.o,c.B,c.v,c.B),e=new a.Hb(c.v,c.B,c.v,c.A);c=new a.Hb(c.v,c.A,c.o,c.A);for(b=b.Da();b.Ya();)for(;b.Ca();){var k=
b.ba();if(k.Yb(d,h)||k.Yb(f,h)||k.Yb(e,h)||k.Yb(c,h))return!0}}else{d=new a.h;d.I(c);d.O(h,h);h=b.Pa(0);f=new a.b;e=new a.b;c=new a.b;for(var k=new a.b,p=0,g=b.aa();p<g;p++)for(var n=!0,u=b.wa(p),z=b.Gc(p);u<z;u++)if(n)h.fc(2*u,e),n=!1;else{h.fc(2*u,f);c.L(e);k.L(f);if(0!=d.fz(c,k))return!0;e.L(f)}}return!1};c.wc=function(b,d,h){var f=b.G(),e=d.G();if(a.T.gh(f)){var k=b.ob;if(null!=k&&(k=k.Hi,null!=k))if(33==e){var p=d.w(),p=k.rm(p.x,p.y);if(1==p)return 1;if(0==p)return 4}else{p=new a.h;d.s(p);p=
k.Sn(p);if(1==p)return 1;if(0==p)return 4;if(h&&a.T.gh(e)&&c.YC(d,k))return 1073741824}}if(a.T.gh(e)&&(k=d.ob,null!=k&&(k=k.Hi,null!=k)))if(33==f){b=b.w();p=k.rm(b.x,b.y);if(1==p)return 2;if(0==p)return 4}else{d=new a.h;b.s(d);p=k.Sn(d);if(1==p)return 2;if(0==p)return 4;if(h&&a.T.gh(f)&&c.YC(b,k))return 1073741824}return 0};c.YC=function(b,c){for(var d=b.D(),f=new a.b,e=0;e<d;e++)if(b.w(e,f),1==c.rm(f.x,f.y))return!0;return!1};c.gD=function(b,c,h,f){for(var d=1<=b.Kk(0)&&1<=c.Kk(0),l=b.Da(),e=c.Da(),
k=[0,0],p=[0,0],g=new a.Mm(b,c,h,!1),n=!1;g.next();){var u=g.Ql(),z=g.Ml();l.Tb(u);e.Tb(z);u=l.ba();z=e.ba().Ma(u,null,p,k,h);if(2==z){n=k[0];z=k[1];u=u.Rb();if(d&&(z-n)*u>h)return!1;n=!0}else if(0!=z){n=k[0];u=p[0];if(0<n&&1>n&&0<u&&1>u)return!1;n=!0}}if(!n)return!1;l=new a.h;e=new a.h;d=new a.h;b.s(l);c.s(e);l.O(1E3*h,1E3*h);e.O(1E3*h,1E3*h);d.I(l);d.Ma(e);return 10<b.D()&&(b=a.me.clip(b,d,h,0),b.u())||10<c.D()&&(c=a.me.clip(c,d,h,0),c.u())?!1:a.Om.fu(b,c,h,"F********",f)};c.bD=function(b,d,h,f){var l=
1<=b.Kk(0)&&1<=d.Kk(0),e=new a.h,k=new a.h,p=new a.h;b.s(e);d.s(k);for(var g=!1,n=c.Yp(e,k,h),u=c.Yp(k,e,h),z=b.Da(),r=d.Da(),t=[0,0],A=[0,0],w=new a.Mm(b,d,h,!1);w.next();){var m=w.Ql(),x=w.Ml();z.Tb(m);r.Tb(x);x=z.ba();m=r.ba().Ma(x,null,A,t,h);if(2==m){var m=t[0],C=t[1],x=x.Rb();if(l&&(C-m)*x>h&&(g=!0,n&&u))return!0}else if(0!=m&&(m=t[0],x=A[0],0<m&&1>m&&0<x&&1>x))return!0}l=new a.h;z=new a.h;l.I(e);l.O(1E3*h,1E3*h);z.I(k);z.O(1E3*h,1E3*h);p.I(l);p.Ma(z);e="";e=g?e+"**":e+"T*";if(n){if(10<d.D()&&
(d=a.me.clip(d,p,h,0),d.u()))return!1;e+="****"}else e+="T***";if(u){if(10<b.D()&&(b=a.me.clip(b,p,h,0),b.u()))return!1;e+="***"}else e+="T**";return a.Om.fu(b,d,h,e.toString(),f)};c.AL=function(b,d,h,f){var l=[!1],e=c.yL(b,d,h,l);if(l[0])return e;l=new a.h;d.s(l);l.O(1E3*h,1E3*h);return 10<b.D()&&(b=a.me.clip(b,l,h,0),b.u())?!1:a.Om.Dx(b,d,h,f)};c.yL=function(b,c,h,f){f[0]=!1;for(var d=b.Da(),l=c.Da(),e=[0,0],k=[0,0],p=new a.Mm(b,c,h,!1),g=!1;p.next();){var n=p.Ql(),u=p.Ml();d.Tb(n,-1);l.Tb(u,-1);
n=d.ba();n=l.ba().Ma(n,null,k,e,h);if(0!=n&&(g=!0,1==n&&(n=e[0],u=k[0],0<n&&1>n&&0<u&&1>u)))return f[0]=!0,!1}if(!g){f[0]=!0;e=new a.h;b.s(e);e.O(h,h);p=b;g=!1;k=new a.h;f=0;for(d=c.aa();f<d;f++)if(0<c.Ka(f)){c.ik(f,k);if(e.Yb(k)){if(l=c.Aa(c.wa(f)),l=a.ff.ln(p,l,0),0==l)return!1}else return!1;g||(!a.ff.qm(b,c.aa()-1)||null!=b.ob&&null!=b.ob.Mb?p=b:(l=new a.Ia,b.copyTo(l),l.Hj(1),p=l),g=!0)}if(1==b.aa()||1607==c.G())return!0;e=new a.h;c.s(e);e.O(h,h);k=c;p=!1;h=new a.h;f=0;for(d=b.aa();f<d;f++)if(0<
b.Ka(f)){b.ik(f,h);if(e.Yb(h)&&(l=b.Aa(b.wa(f)),l=a.ff.ln(k,l,0),1==l))return!1;p||(!a.ff.qm(c,b.aa()-1)||null!=c.ob&&null!=c.ob.Mb?k=c:(l=new a.Ia,c.copyTo(l),l.Hj(1),k=l),p=!0)}return!0}return!1};c.iD=function(b,c,h,f){for(var d=b.Da(),l=c.Da(),e=[0,0],k=[0,0],p=new a.Mm(b,c,h,!1),g=!1;p.next();){var n=p.Ql(),u=p.Ml();d.Tb(n);l.Tb(u);n=d.ba();n=l.ba().Ma(n,null,k,e,h);if(2==n)g=!0;else if(0!=n){g=e[0];n=k[0];if(0<g&&1>g&&0<n&&1>n)return!1;g=!0}}if(!g)return!1;l=new a.h;e=new a.h;d=new a.h;b.s(l);
c.s(e);l.O(1E3*h,1E3*h);e.O(1E3*h,1E3*h);d.I(l);d.Ma(e);return 10<b.D()&&(b=a.me.clip(b,d,h,0),b.u())||10<c.D()&&(c=a.me.clip(c,d,h,0),c.u())?!1:a.Om.Pn(b,c,h,"F********",f)};c.$C=function(b,d,h,f){for(var l=b.Da(),e=d.Da(),k=[0,0],p=[0,0],g=new a.Mm(b,d,h,!1),n=!1;g.next();){var u=g.Ql(),z=g.Ml();l.Tb(u);e.Tb(z);u=l.ba();u=e.ba().Ma(u,null,p,k,h);if(2==u)n=!0;else if(0!=u){n=k[0];u=p[0];if(0<n&&1>n&&0<u&&1>u)return!0;n=!0}}if(!n)return!1;e=new a.h;k=new a.h;p=new a.h;g=new a.h;l=new a.h;b.s(e);d.s(k);
return c.Yp(k,e,h)?(p.I(e),p.O(1E3*h,1E3*h),g.I(k),g.O(1E3*h,1E3*h),l.I(p),l.Ma(g),10<b.D()&&(b=a.me.clip(b,l,h,0),b.u())||10<d.D()&&(d=a.me.clip(d,l,h,0),d.u())?!1:h=a.Om.Pn(b,d,h,"T********",f)):h=a.Om.Pn(b,d,h,"T*****T**",f)};c.BL=function(b,d,h,f){var l=[!1],e=c.yL(b,d,h,l);if(l[0])return e;l=new a.h;d.s(l);l.O(1E3*h,1E3*h);return 10<b.D()&&(b=a.me.clip(b,l,h,0),b.u())?!1:a.Om.KB(b,d,h,f)};c.zL=function(b,c,h){return 1==a.gd.fe(b,c,h)?!0:!1};c.dD=function(b,c,h){return 2==a.gd.fe(b,c,h)?!0:!1};
c.Zt=function(b,c,h){var d=new a.b;h*=h;for(var f=0;f<b.D();f++)if(b.w(f,d),a.b.sc(d,c)<=h)return!1;return!0};c.prototype.VF=function(b,c){b=this.Ph[b];c=this.Ph[c];return b.An<c.An||b.An==c.An&&(b.ax<c.ax||b.ax==c.ax&&(b.dk<c.dk||b.dk==c.dk&&(b.rj<c.rj||b.rj==c.rj&&b.QI<c.QI)))?-1:1};return c}();a.Fd=e})(C||(C={}));(function(a){var f;(function(c){c[c.InteriorInterior=0]="InteriorInterior";c[c.InteriorBoundary=1]="InteriorBoundary";c[c.InteriorExterior=2]="InteriorExterior";c[c.BoundaryInterior=3]=
"BoundaryInterior";c[c.BoundaryBoundary=4]="BoundaryBoundary";c[c.BoundaryExterior=5]="BoundaryExterior";c[c.ExteriorInterior=6]="ExteriorInterior";c[c.ExteriorBoundary=7]="ExteriorBoundary";c[c.ExteriorExterior=8]="ExteriorExterior"})(f||(f={}));var e;(function(c){c[c.AreaAreaPredicates=0]="AreaAreaPredicates";c[c.AreaLinePredicates=1]="AreaLinePredicates";c[c.LineLinePredicates=2]="LineLinePredicates";c[c.AreaPointPredicates=3]="AreaPointPredicates";c[c.LinePointPredicates=4]="LinePointPredicates";
c[c.PointPointPredicates=5]="PointPointPredicates"})(e||(e={}));f=function(){function c(){this.Ie=0;this.i=new a.Pu;this.H=[0,0,0,0,0,0,0,0,0];this.eb=[0,0,0,0,0,0,0,0,0];this.ga=[!1,!1,!1,!1,!1,!1,!1,!1,!1];this.Gn=this.ix=-1}c.XB=function(b,c,h,f,e){if(9!=f.length)throw a.f.X("relation string length has to be 9 characters");for(var d=0;9>d;d++){var l=f.charAt(d);if("*"!=l&&"T"!=l&&"F"!=l&&"0"!=l&&"1"!=l&&"2"!=l)throw a.f.X("relation string");}d=this.ET(f,b.tb(),c.tb());if(0!=d)return a.Fd.YB(b,
c,h,d,e);d=new a.h;b.s(d);l=new a.h;c.s(l);var k=new a.h;k.I(d);k.Nb(l);h=a.ma.be(h,k,!1);b=this.aG(b,h);c=this.aG(c,h);if(b.u()||c.u())return this.rX(b,c,f);d=c.G();l=!1;switch(b.G()){case 1736:switch(d){case 1736:l=this.fu(b,c,h,f,e);break;case 1607:l=this.Pn(b,c,h,f,e);break;case 33:l=this.eu(b,c,h,f,e);break;case 550:l=this.du(b,c,h,f,e)}break;case 1607:switch(d){case 1736:l=this.Pn(c,b,h,this.Pq(f),e);break;case 1607:l=this.LB(b,c,h,f,e);break;case 33:l=this.hu(b,c,h,f,e);break;case 550:l=this.gu(b,
c,h,f,e)}break;case 33:switch(d){case 1736:l=this.eu(c,b,h,this.Pq(f),e);break;case 1607:l=this.hu(c,b,h,this.Pq(f),e);break;case 33:l=this.FW(b,c,h,f);break;case 550:l=this.$t(c,b,h,this.Pq(f),e)}break;case 550:switch(d){case 1736:l=this.du(c,b,h,this.Pq(f),e);break;case 1607:l=this.gu(c,b,h,this.Pq(f),e);break;case 550:l=this.CB(b,c,h,f,e);break;case 33:l=this.$t(b,c,h,f,e)}break;default:l=!1}return l};c.fu=function(b,d,h,f,e){var l=new c;l.xj();l.Bj(f);l.nK();var k=new a.h,q=new a.h;b.s(k);d.s(q);
f=!1;a.Fd.Dk(k,q,h)&&(l.lv(b,d),f=!0);f||(k=a.Fd.wc(b,d,!1),4==k?(l.lv(b,d),f=!0):1==k?(l.Ry(d),f=!0):2==k&&(l.kF(b),f=!0));f||(f=new a.fd,b=f.Jb(b),d=f.Jb(d),l.Fp(f,h,e),l.tq(b,d),l.i.qh());return c.zg(l.H,l.dd)};c.Dx=function(b,d,h,f){var l=new c;l.xj();l.Bj("T*****F**");l.nK();var e=new a.h,k=new a.h;b.s(e);d.s(k);var p=!1;a.Fd.Dk(e,k,h)&&(l.lv(b,d),p=!0);p||(e=a.Fd.wc(b,d,!1),4==e?(l.lv(b,d),p=!0):1==e?(l.Ry(d),p=!0):2==e&&(l.kF(b),p=!0));if(p)return e=this.zg(l.H,l.dd);p=new a.fd;b=p.Jb(b);e=
p.Jb(d);a.rk.V(p,h,f,!1);h=p.Se(e).Gg();p.zq(0,!0,!0);a.lo.V(p,b,-1,!1,f);if(0==p.D(b))return!1;a.lo.V(p,e,-1,!1,f);l.Xr(p,f);d=0==p.D(e);if(!d&&(l.tq(b,e),l.i.qh(),e=this.zg(l.H,l.dd),!e))return e;b=p.Se(b);p=new a.fd;b=p.Jb(b);e=p.Jb(h);l.Xr(p,f);l.Ie=0;l.xj();l.Bj(d?"T*****F**":"******F**");l.gC();l.tq(b,e);l.i.qh();return e=this.zg(l.H,l.dd)};c.Pn=function(b,d,h,f,e){var l=new c;l.xj();l.Bj(f);l.gC();var k=new a.h,q=new a.h;b.s(k);d.s(q);f=!1;a.Fd.Dk(k,q,h)&&(l.mv(b,d),f=!0);f||(k=a.Fd.wc(b,d,
!1),4==k?(l.mv(b,d),f=!0):1==k&&(l.lF(d),f=!0));f||(f=new a.fd,b=f.Jb(b),d=f.Jb(d),l.Fp(f,h,e),l.Fh=l.i.wq(),c.ov(d,l.i,l.Fh),l.tq(b,d),l.i.xq(l.Fh),l.i.qh());return c.zg(l.H,l.dd)};c.KB=function(b,d,h,f){var l=new c;l.xj();l.Bj("T*****F**");l.gC();var e=new a.h,k=new a.h;b.s(e);d.s(k);var p=!1;a.Fd.Dk(e,k,h)&&(l.mv(b,d),p=!0);p||(e=a.Fd.wc(b,d,!1),4==e?(l.mv(b,d),p=!0):1==e&&(l.lF(d),p=!0));if(p)return h=this.zg(l.H,l.dd);p=new a.fd;b=p.Jb(b);d=p.Jb(d);l.Fp(p,h,f);if(0==p.D(b))return!1;l.tq(b,d);
l.i.qh();return h=this.zg(l.H,l.dd)};c.du=function(b,d,h,f,e){var l=new c;l.xj();l.Bj(f);l.oK();var k=new a.h,q=new a.h;b.s(k);d.s(q);f=!1;a.Fd.Dk(k,q,h)&&(l.nv(b),f=!0);f||(k=a.Fd.wc(b,d,!1),4==k?(l.nv(b),f=!0):1==k&&(l.AP(),f=!0));f||(f=new a.fd,b=f.Jb(b),d=f.Jb(d),l.Fp(f,h,e),l.kz(b,d),l.i.qh());return c.zg(l.H,l.dd)};c.LB=function(b,d,h,f,e){var l=new c;l.xj();l.Bj(f);l.YX();f=new a.h;var k=new a.h;b.s(f);d.s(k);var q=!1;a.Fd.Dk(f,k,h)&&(l.cI(b,d),q=!0);q||4!=a.Fd.wc(b,d,!1)||(l.cI(b,d),q=!0);
q||(f=new a.fd,b=f.Jb(b),d=f.Jb(d),l.Fp(f,h,e),l.xi=l.i.wq(),l.Fh=l.i.wq(),c.ov(b,l.i,l.xi),c.ov(d,l.i,l.Fh),l.tq(b,d),l.i.xq(l.xi),l.i.xq(l.Fh),l.i.qh());return c.zg(l.H,l.dd)};c.gu=function(b,d,h,f,e){var l=new c;l.xj();l.Bj(f);l.CK();f=new a.h;var k=new a.h;b.s(f);d.s(k);var q=!1;a.Fd.Dk(f,k,h)&&(l.FA(b),q=!0);q||4!=a.Fd.wc(b,d,!1)||(l.FA(b),q=!0);q||(f=new a.fd,b=f.Jb(b),d=f.Jb(d),l.Fp(f,h,e),l.xi=l.i.wq(),c.ov(b,l.i,l.xi),l.kz(b,d),l.i.xq(l.xi),l.i.qh());return c.zg(l.H,l.dd)};c.CB=function(b,
d,h,f,e){var l=new c;l.xj();l.Bj(f);l.HK();f=new a.h;var k=new a.h;b.s(f);d.s(k);var q=!1;a.Fd.Dk(f,k,h)&&(l.FJ(),q=!0);q||(f=new a.fd,b=f.Jb(b),d=f.Jb(d),l.Fp(f,h,e),l.kz(b,d),l.i.qh());return c.zg(l.H,l.dd)};c.eu=function(b,d,h,f){var l=new c;l.xj();l.Bj(f);l.oK();var e=new a.h;b.s(e);d=d.w();var k=!1;a.Fd.Cx(d,e,h)&&(l.nv(b),k=!0);k||(h=a.gd.fe(b,d,h),1==h?(l.H[0]=0,l.H[2]=2,l.H[3]=-1,l.H[5]=1,l.H[6]=-1):2==h?(l.H[6]=-1,0!=b.hf()?(l.H[0]=-1,l.H[3]=0,l.H[2]=2,l.H[5]=1):(l.H[0]=0,l.H[3]=-1,l.H[5]=
-1,h=new a.h,b.s(h),l.H[2]=0==h.fa()&&0==h.N()?-1:1)):l.nv(b));return this.zg(l.H,f)};c.hu=function(b,d,h,f,e){var l=new c;l.xj();l.Bj(f);l.CK();var k=new a.h;b.s(k);f=d.w();var q=!1;a.Fd.Cx(f,k,h)&&(l.FA(b),q=!0);if(!q){var k=null,p=q=!1;if(l.ga[0]||l.ga[6])a.Fd.GA(b,f,h)?(l.ga[0]&&(k=a.Pi.Sm(b,e),p=!a.Fd.Zt(k,f,h),q=!0,l.H[0]=p?-1:0),l.H[6]=-1):(l.H[0]=-1,l.H[6]=0);l.ga[3]&&(null!=k&&k.u()?l.H[3]=-1:(q||(null==k&&(k=a.Pi.Sm(b,e)),p=!a.Fd.Zt(k,f,h),q=!0),l.H[3]=p?0:-1));l.ga[5]&&(null!=k&&k.u()?
l.H[5]=-1:q&&!p?l.H[5]=0:(null==k&&(k=a.Pi.Sm(b,e)),e=a.Fd.yx(k,d,h),l.H[5]=e?-1:0));l.ga[2]&&(0!=b.Rb()?l.H[2]=1:(e=new a.Ed(b.description),e.Jd(b,0,b.D()),b=a.Fd.yx(e,d,h),l.H[2]=b?-1:0))}return this.zg(l.H,l.dd)};c.$t=function(b,d,h,f){var l=new c;l.xj();l.Bj(f);l.HK();var e=new a.h;b.s(e);d=d.w();var k=!1;a.Fd.Cx(d,e,h)&&(l.FJ(),k=!0);if(!k){e=!1;k=!0;h*=h;for(var p=0;p<b.D();p++){var g=b.Aa(p);a.b.sc(g,d)<=h?e=!0:k=!1;if(e&&!k)break}e?(l.H[0]=0,l.H[2]=k?-1:0,l.H[6]=-1):(l.H[0]=-1,l.H[2]=0,l.H[6]=
0)}return c.zg(l.H,f)};c.FW=function(b,d,h,f){b=b.w();d=d.w();for(var l=[],e=0;9>e;e++)l[e]=-1;a.b.sc(b,d)<=h*h?l[0]=0:(l[2]=0,l[6]=0);l[8]=2;return c.zg(l,f)};c.zg=function(b,c){for(var d=0;9>d;d++)switch(c.charAt(d)){case "T":if(-1==b[d])return!1;break;case "F":if(-1!=b[d])return!1;break;case "0":if(0!=b[d])return!1;break;case "1":if(1!=b[d])return!1;break;case "2":if(2!=b[d])return!1}return!0};c.rX=function(b,c,h){var d=[-1,-1,-1,-1,-1,-1,-1,-1,-1];if(b.u()&&c.u()){for(var f=0;9>f;f++)d[f]=-1;
return this.zg(d,h)}f=!1;b.u()&&(b=c,f=!0);d[0]=-1;d[1]=-1;d[3]=-1;d[4]=-1;d[6]=-1;d[7]=-1;d[8]=2;c=b.G();a.T.Ic(c)?1736==c?0!=b.hf()?(d[2]=2,d[5]=1):(d[5]=-1,c=new a.h,b.s(c),d[2]=0==c.fa()&&0==c.N()?0:1):(c=0!=b.Rb(),d[2]=c?1:0,d[5]=a.Pi.Rq(b)?0:-1):(d[2]=0,d[5]=-1);f&&this.jL(d);return this.zg(d,h)};c.ET=function(b,d,a){return c.jQ(b)?3:c.rO(b)?4:c.fU(b,d,a)?8:c.iO(b,d,a)?16:c.NN(b)?1:c.YM(b,d,a)?32:0};c.jQ=function(b){return"T"==b.charAt(0)&&"*"==b.charAt(1)&&"F"==b.charAt(2)&&"*"==b.charAt(3)&&
"*"==b.charAt(4)&&"F"==b.charAt(5)&&"F"==b.charAt(6)&&"F"==b.charAt(7)&&"*"==b.charAt(8)?!0:!1};c.rO=function(b){return"F"==b.charAt(0)&&"F"==b.charAt(1)&&"*"==b.charAt(2)&&"F"==b.charAt(3)&&"F"==b.charAt(4)&&"*"==b.charAt(5)&&"*"==b.charAt(6)&&"*"==b.charAt(7)&&"*"==b.charAt(8)?!0:!1};c.fU=function(b,c,a){if(0==c&&0==a)return!1;if(2!=c||2!=a)if("F"==b.charAt(0)&&"*"==b.charAt(1)&&"*"==b.charAt(2)&&"T"==b.charAt(3)&&"*"==b.charAt(4)&&"*"==b.charAt(5)&&"*"==b.charAt(6)&&"*"==b.charAt(7)&&"*"==b.charAt(8)||
1==c&&1==a&&"F"==b.charAt(0)&&"T"==b.charAt(1)&&"*"==b.charAt(2)&&"*"==b.charAt(3)&&"*"==b.charAt(4)&&"*"==b.charAt(5)&&"*"==b.charAt(6)&&"*"==b.charAt(7)&&"*"==b.charAt(8))return!0;return 0!=a&&"F"==b.charAt(0)&&"*"==b.charAt(1)&&"*"==b.charAt(2)&&"*"==b.charAt(3)&&"T"==b.charAt(4)&&"*"==b.charAt(5)&&"*"==b.charAt(6)&&"*"==b.charAt(7)&&"*"==b.charAt(8)?!0:!1};c.iO=function(b,c,a){return c>a?"T"==b.charAt(0)&&"*"==b.charAt(1)&&"*"==b.charAt(2)&&"*"==b.charAt(3)&&"*"==b.charAt(4)&&"*"==b.charAt(5)&&
"T"==b.charAt(6)&&"*"==b.charAt(7)&&"*"==b.charAt(8)?!0:!1:1==c&&1==a&&"0"==b.charAt(0)&&"*"==b.charAt(1)&&"*"==b.charAt(2)&&"*"==b.charAt(3)&&"*"==b.charAt(4)&&"*"==b.charAt(5)&&"*"==b.charAt(6)&&"*"==b.charAt(7)&&"*"==b.charAt(8)?!0:!1};c.NN=function(b){return"T"==b.charAt(0)&&"*"==b.charAt(1)&&"*"==b.charAt(2)&&"*"==b.charAt(3)&&"*"==b.charAt(4)&&"*"==b.charAt(5)&&"F"==b.charAt(6)&&"F"==b.charAt(7)&&"*"==b.charAt(8)?!0:!1};c.YM=function(b,c,a){if(c==a){if(1!=c)return"T"==b.charAt(0)&&"*"==b.charAt(1)&&
"T"==b.charAt(2)&&"*"==b.charAt(3)&&"*"==b.charAt(4)&&"*"==b.charAt(5)&&"T"==b.charAt(6)&&"*"==b.charAt(7)&&"*"==b.charAt(8)?!0:!1;if("1"==b.charAt(0)&&"*"==b.charAt(1)&&"T"==b.charAt(2)&&"*"==b.charAt(3)&&"*"==b.charAt(4)&&"*"==b.charAt(5)&&"T"==b.charAt(6)&&"*"==b.charAt(7)&&"*"==b.charAt(8))return!0}return!1};c.ov=function(b,c,a){b=c.Ha(b);for(var d=c.rf;-1!=d;d=c.og(d))if(0!=(c.Nd(d)&b)){var h=c.kf(d);if(-1==h)c.eo(d,a,0);else{var f=h,e=0;do 0!=(c.Ah(f)&b)&&e++,f=c.qc(c.za(f));while(f!=h);c.eo(d,
a,e)}}};c.Pq=function(b){var c;c=""+b.charAt(0);c+=b.charAt(3);c+=b.charAt(6);c+=b.charAt(1);c+=b.charAt(4);c+=b.charAt(7);c+=b.charAt(2);c+=b.charAt(5);return c+=b.charAt(8)};c.prototype.xj=function(){for(var b=0;9>b;b++)this.H[b]=-2,this.eb[b]=-2};c.jL=function(b){var c=b[1],a=b[2],f=b[5];b[1]=b[3];b[2]=b[6];b[5]=b[7];b[3]=c;b[6]=a;b[7]=f};c.prototype.Bj=function(b){this.dd=b;for(b=0;9>b;b++)"*"!=this.dd.charAt(b)?(this.ga[b]=!0,this.Ie++):this.ga[b]=!1};c.prototype.KK=function(){for(var b=0;9>
b;b++)this.ga[b]&&-2==this.H[b]&&(this.H[b]=-1,this.ga[b]=!1)};c.prototype.vc=function(b){if(-2==this.H[b])return!1;if(-1==this.H[b])return this.ga[b]=!1,this.Ie--,!0;if("T"!=this.dd.charAt(b)&&"F"!=this.dd.charAt(b)){if(this.H[b]<this.eb[b])return!1;this.ga[b]=!1;this.Ie--;return!0}this.ga[b]=!1;this.Ie--;return!0};c.prototype.nK=function(){this.ix=0;this.eb[0]=2;this.eb[1]=1;this.eb[2]=2;this.eb[3]=1;this.eb[4]=1;this.eb[5]=1;this.eb[6]=2;this.eb[7]=1;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=
!1,this.Ie--)};c.prototype.gC=function(){this.ix=1;this.Gn=3;this.eb[0]=1;this.eb[1]=0;this.eb[2]=2;this.eb[3]=1;this.eb[4]=0;this.eb[5]=1;this.eb[6]=1;this.eb[7]=0;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};c.prototype.YX=function(){this.ix=2;this.Gn=4;this.eb[0]=1;this.eb[1]=0;this.eb[2]=1;this.eb[3]=0;this.eb[4]=0;this.eb[5]=0;this.eb[6]=1;this.eb[7]=0;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};c.prototype.oK=function(){this.Gn=3;this.eb[0]=0;this.eb[1]=
-1;this.eb[2]=2;this.eb[3]=0;this.eb[4]=-1;this.eb[5]=1;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);this.ga[4]&&(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};c.prototype.CK=function(){this.Gn=4;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=1;this.eb[3]=0;this.eb[4]=-1;this.eb[5]=0;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);
this.ga[4]&&(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};c.prototype.HK=function(){this.Gn=5;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=0;this.eb[3]=-1;this.eb[4]=-1;this.eb[5]=-1;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);this.ga[3]&&(this.H[3]=-1,this.ga[3]=!1,this.Ie--);this.ga[4]&&(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[5]&&(this.H[5]=-1,this.ga[5]=
!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};c.prototype.yP=function(b,c,a){var d=!0;this.ga[0]&&(this.wU(b,c,a),d=d&&this.vc(0));this.ga[1]&&(this.EH(b,c,1),d=d&&this.vc(1));this.ga[2]&&(this.FH(b,c,a,2),d=d&&this.vc(2));this.ga[3]&&(this.EH(b,a,3),d=d&&this.vc(3));this.ga[4]&&(this.EP(b,c,a),d=d&&this.vc(4));this.ga[5]&&(this.qF(b,a,5),d=d&&this.vc(5));this.ga[6]&&(this.FH(b,a,c,6),d=d&&this.vc(6));this.ga[7]&&(this.qF(b,c,7),
d=d&&this.vc(7));return d};c.prototype.lv=function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;this.Cs(b,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?5:-1,this.dd.charAt(5));this.Cs(c,this.ga[6]?6:-1,this.dd.charAt(6),this.ga[7]?7:-1,this.dd.charAt(7))};c.prototype.Cs=function(b,c,h,f,e){if(-1!=c||-1!=f)("T"!=h&&"F"!=h&&-1!=c||"T"!=e&&"F"!=e&&-1!=f?0!=b.hf():1)?(-1!=c&&(this.H[c]=2),-1!=f&&(this.H[f]=1)):(-1!=f&&(this.H[f]=-1),-1!=c&&(h=new a.h,b.s(h),this.H[c]=0==h.fa()&&0==h.N()?0:
1))};c.prototype.Ry=function(b){this.H[2]=2;this.H[3]=-1;this.H[4]=-1;this.H[5]=1;this.H[6]=-1;this.H[7]=-1;this.Cs(b,this.ga[0]?0:-1,this.dd.charAt(0),this.ga[1]?1:-1,this.dd.charAt(1))};c.prototype.kF=function(b){this.Ry(b);c.jL(this.H)};c.prototype.mv=function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;if(this.ga[6]){var d=this.dd.charAt(6),d="T"!=d&&"F"!=d?0!=c.Rb():!0;this.H[6]=d?1:0}this.ga[7]&&(d=a.Pi.Rq(c),this.H[7]=d?0:-1);this.Cs(b,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?
5:-1,this.dd.charAt(5))};c.prototype.lF=function(b){if(this.ga[0]){var c=this.dd.charAt(0),c="T"!=c&&"F"!=c?0!=b.Rb():!0;this.H[0]=c?1:0}this.ga[1]&&(b=a.Pi.Rq(b),this.H[1]=b?0:-1);this.H[2]=2;this.H[3]=-1;this.H[4]=-1;this.H[5]=1;this.H[6]=-1;this.H[7]=-1};c.prototype.nv=function(b){this.H[0]=-1;this.H[3]=-1;this.H[6]=0;this.Cs(b,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?5:-1,this.dd.charAt(5))};c.prototype.AP=function(){this.H[0]=0;this.H[2]=2;this.H[3]=-1;this.H[5]=1;this.H[6]=-1};c.prototype.cI=
function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;if(this.ga[2]){var d=this.dd.charAt(2),d="T"!=d&&"F"!=d?0!=b.Rb():!0;this.H[2]=d?1:0}this.ga[5]&&(d=a.Pi.Rq(b),this.H[5]=d?0:-1);this.ga[6]&&(d=this.dd.charAt(6),d="T"!=d&&"F"!=d?0!=c.Rb():!0,this.H[6]=d?1:0);this.ga[7]&&(d=a.Pi.Rq(c),this.H[7]=d?0:-1)};c.prototype.FA=function(b){this.H[0]=-1;this.H[3]=-1;if(this.ga[2]){var c=this.dd.charAt(2),c="T"!=c&&"F"!=c?0!=b.Rb():!0;this.H[2]=c?1:0}this.ga[5]&&(b=a.Pi.Rq(b),this.H[5]=b?0:-1);
this.H[6]=0};c.prototype.FJ=function(){this.H[0]=-1;this.H[2]=0;this.H[6]=0};c.prototype.zP=function(b,c,a){var d=!0;this.ga[0]&&(this.xU(b,c),d=d&&this.vc(0));this.ga[1]&&(this.tU(b,c,a,this.Fh),d=d&&this.vc(1));this.ga[2]&&(this.uU(b,c),d=d&&this.vc(2));this.ga[3]&&(this.IP(b,c,a,this.Fh),d=d&&this.vc(3));this.ga[4]&&(this.FP(b,c,a,this.Fh),d=d&&this.vc(4));this.ga[5]&&(this.GP(b,c,a),d=d&&this.vc(5));this.ga[6]&&(this.cS(b,c),d=d&&this.vc(6));this.ga[7]&&(this.bS(b,c,a,this.Fh),d=d&&this.vc(7));
return d};c.prototype.mV=function(b,c,a){var d=!0;this.ga[0]&&(this.AU(b,c,a,this.xi,this.Fh),d=d&&this.vc(0));this.ga[1]&&(this.GH(b,c,a,this.xi,this.Fh,1),d=d&&this.vc(1));this.ga[2]&&(this.HH(b,c,a,2),d=d&&this.vc(2));this.ga[3]&&(this.GH(b,a,c,this.Fh,this.xi,3),d=d&&this.vc(3));this.ga[4]&&(this.KP(b,c,a,this.xi,this.Fh),d=d&&this.vc(4));this.ga[5]&&(this.rF(b,a,this.xi,5),d=d&&this.vc(5));this.ga[6]&&(this.HH(b,a,c,6),d=d&&this.vc(6));this.ga[7]&&(this.rF(b,c,this.Fh,7),d=d&&this.vc(7));return d};
c.prototype.mF=function(b,c,a){var d=!0;this.ga[0]&&(this.yU(b,c),d=d&&this.vc(0));this.ga[2]&&(this.vU(b,c),d=d&&this.vc(2));this.ga[3]&&(this.JP(b,c,a),d=d&&this.vc(3));this.ga[5]&&(this.HP(b,c),d=d&&this.vc(5));this.ga[6]&&(this.dS(b,c),d=d&&this.vc(6));return d};c.prototype.dI=function(b,c,a){var d=!0;this.ga[0]&&(this.BU(b,c,a,this.xi),d=d&&this.vc(0));this.ga[2]&&(this.zU(b,a),d=d&&this.vc(2));this.ga[3]&&(this.MP(b,c,a,this.xi),d=d&&this.vc(3));this.ga[5]&&(this.LP(b,c,a,this.xi),d=d&&this.vc(5));
this.ga[6]&&(this.eS(b,c,a),d=d&&this.vc(6));return d};c.prototype.EW=function(b,c,a){var d=!0;this.ga[0]&&(this.CU(b,c,a),d=d&&this.vc(0));this.ga[2]&&(this.IH(b,c,a,2),d=d&&this.vc(2));this.ga[6]&&(this.IH(b,a,c,6),d=d&&this.vc(6));return d};c.prototype.wU=function(b,c,a){2!=this.H[0]&&(b=this.i.Ff(b),0!=(b&c)&&0!=(b&a)&&(this.H[0]=2))};c.prototype.EH=function(b,c,a){if(1!=this.H[a]){var d=this.i.Ff(this.i.za(b));0!=(this.i.Ff(b)&c)&&0!=(d&c)&&(this.H[a]=1)}};c.prototype.FH=function(b,c,a,f){2!=
this.H[f]&&(b=this.i.Ff(b),0!=(b&c)&&0==(b&a)&&(this.H[f]=2))};c.prototype.EP=function(b,c,a){if(1!=this.H[4]){var d=this.i.Ah(b);0!=(d&c)&&0!=(d&a)?this.H[4]=1:0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)&&(b=this.i.Nd(this.i.Xf(b)),0!=(b&c)&&0!=(b&a)&&(this.H[4]=0))}};c.prototype.qF=function(b,c,a){if(1!=this.H[a]){var d=this.i.Ff(this.i.za(b));0==(this.i.Ff(b)&c)&&0==(d&c)&&(this.H[a]=1)}};c.prototype.xU=function(b,c){if(1!=this.H[0]){var d=this.i.Ff(this.i.za(b));0!=(this.i.Ff(b)&
c)&&0!=(d&c)&&(this.H[0]=1)}};c.prototype.tU=function(b,c,a,f){if(0!=this.H[1]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)){var d=this.i.Xf(b),h=this.i.Nd(d);0==(h&c)&&0!=(this.i.Ff(b)&c)&&(b=this.i.Hg(d,f),0!=(h&a)&&0!=b%2&&(this.H[1]=0))}};c.prototype.uU=function(b,c){2!=this.H[2]&&0!=(this.i.Ah(b)&c)&&(this.H[2]=2)};c.prototype.IP=function(b,c,a,f){if(1!=this.H[3]){var d=this.i.Ah(b);0!=(d&c)&&0!=(d&a)?this.H[3]=1:0!=this.H[3]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)&&(d=this.i.Xf(b),
b=this.i.Nd(d),0!=(b&c)&&(c=this.i.Hg(d,f),0!=(b&a)&&0==c%2&&(this.H[3]=0)))}};c.prototype.FP=function(b,c,a,f){if(0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)){var d=this.i.Xf(b);b=this.i.Nd(d);0!=(b&c)&&(c=this.i.Hg(d,f),0!=(b&a)&&0!=c%2&&(this.H[4]=0))}};c.prototype.GP=function(b,c,a){1!=this.H[5]&&(b=this.i.Ah(b),0!=(b&c)&&0==(b&a)&&(this.H[5]=1))};c.prototype.cS=function(b,c){if(1!=this.H[6]){var d=this.i.Ff(this.i.za(b));0==(this.i.Ff(b)&c)&&0==(d&c)&&(this.H[6]=1)}};c.prototype.bS=
function(b,c,a,f){if(0!=this.H[7]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)){var d=this.i.Xf(b),h=this.i.Nd(d);0==(h&c)&&0==(this.i.Ff(b)&c)&&(b=this.i.Hg(d,f),0!=(h&a)&&0!=b%2&&(this.H[7]=0))}};c.prototype.AU=function(b,c,a,f,e){if(1!=this.H[0]){var d=this.i.Ah(b);0!=(d&c)&&0!=(d&a)?this.H[0]=1:0!=this.H[0]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)&&(b=this.i.Xf(b),d=this.i.Nd(b),0!=(d&c)&&0!=(d&a)&&(c=this.i.Hg(b,f),e=this.i.Hg(b,e),0==c%2&&0==e%2&&(this.H[0]=0)))}};c.prototype.GH=function(b,
c,a,f,e,k){if(0!=this.H[k]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)){b=this.i.Xf(b);var d=this.i.Nd(b);0!=(d&c)&&0!=(d&a)&&(c=this.i.Hg(b,f),e=this.i.Hg(b,e),0==c%2&&0!=e%2&&(this.H[k]=0))}};c.prototype.HH=function(b,c,a,f){1!=this.H[f]&&(b=this.i.Ah(b),0!=(b&c)&&0==(b&a)&&(this.H[f]=1))};c.prototype.KP=function(b,c,a,f,e){if(0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)){b=this.i.Xf(b);var d=this.i.Nd(b);0!=(d&c)&&0!=(d&a)&&(c=this.i.Hg(b,f),e=this.i.Hg(b,e),0!=c%2&&0!=e%2&&(this.H[4]=
0))}};c.prototype.rF=function(b,c,a,f){0!=this.H[f]&&1!=this.i.Kb(this.i.Te(this.i.za(b)),this.vj)&&(b=this.i.Xf(b),0==(this.i.Nd(b)&c)&&0!=this.i.Hg(b,a)%2&&(this.H[f]=0))};c.prototype.yU=function(b,c){0!=this.H[0]&&0==(this.i.Nd(b)&c)&&0!=(this.i.Hk(this.i.Jz(b))&c)&&(this.H[0]=0)};c.prototype.vU=function(b,c){2!=this.H[2]&&0!=(this.i.Nd(b)&c)&&(this.H[2]=2)};c.prototype.JP=function(b,c,a){0!=this.H[3]&&(b=this.i.Nd(b),0!=(b&c)&&0!=(b&a)&&(this.H[3]=0))};c.prototype.HP=function(b,c){1!=this.H[5]&&
0!=(this.i.Nd(b)&c)&&(this.H[5]=1)};c.prototype.dS=function(b,c){0!=this.H[6]&&0==(this.i.Nd(b)&c)&&0==(this.i.Hk(this.i.Jz(b))&c)&&(this.H[6]=0)};c.prototype.BU=function(b,c,a,f){if(0!=this.H[0]){var d=this.i.Nd(b);0!=(d&c)&&0!=(d&a)&&0==this.i.Hg(b,f)%2&&(this.H[0]=0)}};c.prototype.zU=function(b,c){1!=this.H[2]&&(-1!=this.i.kf(b)?this.H[2]=1:0!=this.H[2]&&0==(this.i.Nd(b)&c)&&(this.H[2]=0))};c.prototype.MP=function(b,c,a,f){if(0!=this.H[3]){var d=this.i.Nd(b);0!=(d&c)&&0!=(d&a)&&0!=this.i.Hg(b,
f)%2&&(this.H[3]=0)}};c.prototype.LP=function(b,c,a,f){if(0!=this.H[5]){var d=this.i.Nd(b);0!=(d&c)&&0==(d&a)&&0!=this.i.Hg(b,f)%2&&(this.H[5]=0)}};c.prototype.eS=function(b,c,a){0!=this.H[6]&&(b=this.i.Nd(b),0==(b&c)&&0!=(b&a)&&(this.H[6]=0))};c.prototype.CU=function(b,c,a){0!=this.H[0]&&(b=this.i.Nd(b),0!=(b&c)&&0!=(b&a)&&(this.H[0]=0))};c.prototype.IH=function(b,c,a,f){0!=this.H[f]&&(b=this.i.Nd(b),0!=(b&c)&&0==(b&a)&&(this.H[f]=0))};c.prototype.tq=function(b,c){var d=!1;b=this.i.Ha(b);c=this.i.Ha(c);
this.vj=this.i.xh();for(var f=this.i.rf;-1!=f;f=this.i.og(f)){var e=this.i.kf(f);if(-1==e){if(-1!=this.Gn)switch(this.Gn){case 3:d=this.mF(f,b,c);break;case 4:d=this.dI(f,b,c);break;default:throw a.f.X("internal error");}}else{var k=e;do{var p=k;if(1!=this.i.Kb(p,this.vj)){do{switch(this.ix){case 0:d=this.yP(p,b,c);break;case 1:d=this.zP(p,b,c);break;case 2:d=this.mV(p,b,c);break;default:throw a.f.X("internal error");}if(d)break;this.i.Ob(p,this.vj,1);p=this.i.qc(p)}while(p!=k&&!d)}if(d)break;k=this.i.qc(this.i.za(p))}while(k!=
e);if(d)break}}d||this.KK();this.i.ni(this.vj)};c.prototype.kz=function(b,c){var d=!1;b=this.i.Ha(b);c=this.i.Ha(c);for(var f=this.i.rf;-1!=f;f=this.i.og(f)){switch(this.Gn){case 3:d=this.mF(f,b,c);break;case 4:d=this.dI(f,b,c);break;case 5:d=this.EW(f,b,c);break;default:throw a.f.ya();}if(d)break}d||this.KK()};c.prototype.Xr=function(b,c){this.i.Vr(b,c)};c.prototype.Fp=function(b,c,a){this.UR(b,c,a);this.Xr(b,a)};c.prototype.UR=function(b,c,h){a.rk.V(b,c,h,!1);b.zq(0,!0,!0);for(c=b.rd;-1!=c;c=b.Ue(c))1736==
b.hc(c)&&a.lo.V(b,c,-1,!1,h)};c.aG=function(b,c){var d=b.G();if(a.T.Oc(d))return d=new a.Ua(b.description),d.dc(b,!0),d;if(197==d){d=new a.h;b.s(d);if(d.fa()<=c&&d.N()<=c)return d=new a.Wa(b.description),b.Wf(d),d;if(d.fa()<=c||d.N()<=c)return d=new a.Ua(b.description),c=new a.Wa,b.ig(0,c),d.Rf(c),b.ig(2,c),d.lineTo(c),d;d=new a.Ia(b.description);d.jd(b,!1);return d}return b};return c}();a.Om=f})(C||(C={}));(function(a){var f=function(){function b(b){this.tn=new a.ia(0);this.Qw=new a.ia(0);this.lu=
new a.b;this.mu=new a.b;this.a=b;this.Ct=-1}b.prototype.ic=function(b){return this.a.ic(this.iA(b))};b.prototype.nw=function(b){var c=this.Qz(b);b=this.RG(b);if(this.a.Ra(c)==b){var d=c,c=b;b=d}this.a.Nc(c,this.lu);this.a.Nc(b,this.mu);return this.lu.y<this.mu.y};b.prototype.iA=function(b){var c=this.Qz(b);b=this.RG(b);return this.a.U(c)==b?c:b};b.prototype.Qz=function(b){return this.tn.get(b)};b.prototype.RG=function(b){return this.Qw.get(b)};b.prototype.BG=function(b){this.tn.set(b,this.Ct);this.Ct=
b};b.prototype.vJ=function(b){if(-1!=this.Ct){var c=this.Ct;this.Ct=this.tn.get(c);this.tn.set(c,b);this.Qw.set(c,this.a.U(b));return c}null==this.tn&&(this.tn=new a.ia(0),this.Qw=new a.ia(0));c=this.tn.size;this.tn.add(b);this.Qw.add(this.a.U(b));return c};b.prototype.bA=function(b){return this.a.ld(this.Qz(b))};return b}();a.KZ=f;var e=function(){function b(b){this.bf=b;this.Fe=new a.Hb;this.Bn=new a.Hb;this.RI=0;this.op=null;this.dB=-1}b.prototype.compare=function(b,c,a){a=b.ja(a);var d=this.bf.ib,
h;this.dB==c?h=this.RI:(this.op=d.ic(c),null==this.op?(b=d.a,b.pd(d.iA(c),this.Fe),this.op=this.Fe,h=this.Fe.pf(this.bf.Wh,0)):h=this.op.pf(this.bf.Wh,0),this.RI=h,this.dB=c);b=d.ic(a);var f;null==b?(b=d.a,b.pd(d.iA(a),this.Bn),b=this.Bn,f=this.Bn.pf(this.bf.Wh,0)):f=b.pf(this.bf.Wh,0);h==f&&(c=d.nw(c),a=d.nw(a),a=Math.min(c?this.op.oa:this.op.ra,a?b.oa:b.ra),c=.5*(a+this.bf.Wh),c==this.bf.Wh&&(c=a),h=this.op.pf(c,0),f=b.pf(c,0));return h<f?-1:h>f?1:0};b.prototype.reset=function(){this.dB=-1};return b}(),
c=function(){function b(){this.Ln=this.jm=null;this.hb=new a.tk;this.hb.NR();this.we=new e(this);this.hb.Ep(this.we)}b.prototype.xS=function(){var b=!1;this.Uw&&(b=this.yS());if(1==this.a.aa(this.Y)){var c=this.a.Pb(this.Y),b=this.a.fA(c);this.a.nC(c,!0);return 0>b?(b=this.a.cb(c),this.a.eK(b),this.a.sh(c,this.a.Ra(b)),!0):!1}this.hm=this.a.qz();this.kp=this.a.qz();for(c=this.a.Pb(this.Y);-1!=c;c=this.a.Sb(c))this.a.Zr(c,this.hm,0),this.a.Zr(c,this.kp,-1);c=new a.ia(0);this.Wh=NaN;var f=new a.b;this.Wt=
this.a.aa(this.Y);this.fp=this.a.Vd();this.Lt=this.a.Vd();for(var e=this.jm.xc(this.jm.Ge);-1!=e;e=this.jm.nb(e)){var k=this.jm.getData(e);this.a.Nc(k,f);f.y!=this.Wh&&0!=c.size&&(b=this.iu(c)||b,this.we.reset(),c.clear(!1));c.add(k);this.Wh=f.y;if(0==this.Wt)break}0<this.Wt&&(b=this.iu(c)||b,c.clear(!1));this.a.ke(this.fp);this.a.ke(this.Lt);for(c=this.a.Pb(this.Y);-1!=c;)if(3==this.a.Tj(c,this.hm)){this.a.nC(c,!0);f=c;for(c=this.a.Tj(c,this.kp);-1!=c;)e=this.a.Tj(c,this.kp),this.a.WV(this.Y,this.a.Sb(f),
c),f=c,c=e;c=this.a.Sb(f)}else this.a.nC(c,!1),c=this.a.Sb(c);this.a.aC(this.hm);this.a.aC(this.kp);return b};b.prototype.iu=function(b){return this.RW(b)};b.prototype.RW=function(b){var c=!1;null==this.ib&&(this.ib=new f(this.a));null==this.Ln?(this.Ln=new a.ia(0),this.Ln.yb(16)):this.Ln.clear(!1);this.QW(b);for(var d=0,e=b.size;d<e;d++){var k=b.get(d);-1!=k&&this.BH(k,-1)}for(d=0;d<this.Ln.size&&0<this.Wt;d++)if(b=this.Ln.get(d),k=this.ib.bA(this.hb.ja(b)),e=-1,0==this.a.Tj(k,this.hm)){for(var k=
this.hb.Ve(b),p=b,g;-1!=k;){var n=this.hb.ja(k),u=this.ib.bA(n),z=this.a.Tj(u,this.hm);if(0!=z){e=u;break}p=k;k=this.hb.Ve(k)}-1==k?(g=!0,k=p):(n=this.hb.ja(k),g=this.ib.nw(n),k=this.hb.nb(k),g=!g);do{n=this.hb.ja(k);u=this.ib.bA(n);z=this.a.Tj(u,this.hm);if(0==z&&(g!=this.ib.nw(n)&&(c=this.a.cb(u),this.a.eK(c),this.a.sh(u,this.a.Ra(c)),c=!0),this.a.Zr(u,this.hm,g?3:2),g||(p=this.a.Tj(e,this.kp),this.a.Zr(e,this.kp,u),this.a.Zr(u,this.kp,p)),this.Wt--,0==this.Wt))return c;e=u;p=k;k=this.hb.nb(k);
g=!g}while(p!=b)}return c};b.prototype.QW=function(b){for(var c=0,d=b.size;c<d;c++){var a=b.get(c),f=this.a.Sa(a,this.fp),e=this.a.Sa(a,this.Lt);if(-1!=f){var k=this.hb.ja(f);this.ib.BG(k);this.a.Va(a,this.fp,-1)}-1!=e&&(k=this.hb.ja(e),this.ib.BG(k),this.a.Va(a,this.Lt,-1));k=-1;-1!=f&&-1!=e?(this.hb.Ld(f,-1),this.hb.Ld(e,-1),b.set(c,-1)):k=-1!=f?f:e;-1!=k&&(this.BH(a,k)||this.hb.Ld(k,-1),b.set(c,-1))}};b.prototype.BH=function(b,c){var d=new a.b,h=new a.b;this.a.Nc(b,d);var f=this.a.U(b);this.a.Nc(f,
h);var e=!1;if(d.y<h.y){var e=!0,k=this.ib.vJ(b),p;-1==c?p=this.hb.addElement(k,-1):(p=c,this.hb.jk(p,k));k=this.a.Sa(f,this.fp);-1==k?this.a.Va(f,this.fp,p):this.a.Va(f,this.Lt,p);f=this.a.ld(b);0==this.a.Tj(f,this.hm)&&this.Ln.add(p)}f=this.a.Ra(b);this.a.Nc(f,h);d.y<h.y&&(e=!0,k=this.ib.vJ(f),-1==c?p=this.hb.addElement(k,-1):(p=c,this.hb.jk(p,k)),k=this.a.Sa(f,this.fp),-1==k?this.a.Va(f,this.fp,p):this.a.Va(f,this.Lt,p),f=this.a.ld(b),0==this.a.Tj(f,this.hm)&&this.Ln.add(p));return e};b.V=function(c,
a,f,e){var d=new b;d.a=c;d.Y=a;d.jm=f;d.Uw=e;return d.xS()};b.prototype.yS=function(){var b=new a.ia(0),c=new a.ia(0),f=-1,e=-1,k=new a.b;k.$c();for(var p=-1,g=-1,n=-1,u=new a.b,z=this.jm.xc(this.jm.Ge);-1!=z;z=this.jm.nb(z)){var r=this.jm.getData(z);this.a.Nc(r,u);var t=this.a.ld(r);k.ub(u)&&g==t?(-1==e&&(f=this.a.qz(),e=this.a.Vd()),-1==n&&(n=c.size,this.a.Va(p,e,n),c.add(1),-1==this.a.Tj(t,f)&&(this.a.Zr(t,f,p),b.add(t))),this.a.Va(r,e,n),c.BK(c.Fc()+1)):(n=-1,k.L(u));p=r;g=t}if(0==b.size)return!1;
k=new a.ia(0);p=new a.ia(0);g=0;for(n=b.size;g<n;g++){var t=b.get(g),A=this.a.Tj(t,f),r=this.a.Sa(A,e);k.clear(!1);p.clear(!1);k.add(A);p.add(r);for(r=this.a.U(A);r!=A;r=this.a.U(r)){var w=r,u=this.a.Sa(w,e);if(-1!=u)if(0==p.size)p.add(u),k.add(w);else if(p.Fc()==u){var z=k.Fc(),m=this.a.U(z),A=this.a.U(w);this.a.Kc(z,A);this.a.Lc(A,z);this.a.Kc(w,m);this.a.Lc(m,w);w=[!1];m=this.a.AH(this.Y,m,this.a.cb(t),w);this.a.Va(r,e,-1);w[0]&&this.a.jg(t,A);r=this.a.Ka(t);A=this.a.Ka(m);r-=A;this.a.mk(t,r);
c.set(u,c.get(u)-1);1==c.get(u)&&(c.set(u,0),p.Pf(),k.Pf());r=A=z}else k.add(r),p.add(u)}}this.a.aC(f);this.a.ke(e);return!0};return b}();a.RN=c})(C||(C={}));(function(a){var f=function(){function f(){}f.prototype.Cg=function(){this.tB=this.wb=null};f.prototype.get=function(){return this.tB};f.prototype.set=function(c){this.tB=c;if(null!=c)throw 322==c.G()&&(this.wb=c),a.f.ya();};f.prototype.create=function(c){if(322==c)this.Is();else throw a.f.X("Not Implemented");};f.prototype.Is=function(){null==
this.wb&&(this.wb=new a.Hb);this.tB=this.wb};return f}();a.Cg=f})(C||(C={}));(function(a){a=a.WN||(a.WN={});a[a.enumLineSeg=1]="enumLineSeg";a[a.enumBezierSeg=2]="enumBezierSeg";a[a.enumArcSeg=4]="enumArcSeg";a[a.enumNonlinearSegmentMask=6]="enumNonlinearSegmentMask";a[a.enumSegmentMask=7]="enumSegmentMask";a[a.enumDensified=8]="enumDensified"})(C||(C={}));(function(a){var f=function(){return function(c){this.zj=c;this.RC=this.SC=1;this.SB=this.RB=this.TB=0}}(),e=function(){function c(){this.ur=[0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.dl=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.cg=new a.Wa;this.ta=this.rx=0;this.$o=[];this.Tt=[];this.lx=[];this.xr=[];this.qB=[]}c.prototype.VB=function(b){if(null!=b){for(var c=0,a=b.length;c<a;c++)this.pX(b[c]);b.length=0}};c.prototype.pX=function(b){b.zj=null;this.xr.push(b)};c.prototype.zx=function(b){if(0===this.xr.length)var c=new f(b);else c=this.xr[this.xr.length-1],c.zj=b,--this.xr.length;return c};c.prototype.KT=function(b,c){return 0==b?this.Tt[c]:this.lx[c]};
c.prototype.FB=function(){this.rx>=this.qB.length&&this.qB.push(new a.Cg);var b=this.qB[this.rx];this.rx++;return b};c.prototype.clear=function(){this.VB(this.$o);this.VB(this.Tt);this.VB(this.lx);this.rx=0};c.prototype.Ap=function(b){this.$o.push(this.zx(b))};c.prototype.Rl=function(b){return 0==b?this.Tt.length:this.lx.length};c.prototype.Mq=function(b,c){return this.KT(b,c).zj};c.prototype.Ma=function(b,c){if(2!=this.$o.length)throw a.f.ya();this.ta=b;var d=a.Ub.Xx(.01*b),f=!1,e=this.$o[0],k=this.$o[1];
if(c||0!=(e.zj.xs(k.zj,b,!0)&5)){if(322==e.zj.G()&&(c=e.zj,322==k.zj.G())){var p=k.zj,g=a.Hb.Fy(c,p,null,this.ur,this.dl,b);if(0==g)throw a.Hb.Fy(c,p,null,this.ur,this.dl,b),a.f.ya();b=Array(9);a.J.Mv(b,null);for(var n=0;n<g;n++){var u=this.ur[n],z=this.dl[n],r=e.SB,t=1;0==u?(r=e.TB,t=e.SC):1==u&&(r=e.RB,t=e.RC);var A=k.SB,w=1;0==z?(A=k.TB,w=k.SC):1==z&&(A=k.RB,w=k.RC);var m=new a.b;r==A?(r=new a.b,c.gc(u,r),u=new a.b,p.gc(z,u),z=t+w,w/=z,a.Ub.bI(r,u,w,m),a.b.sc(m,r)+a.b.sc(m,u)>d&&(f=!0)):r>A?(c.gc(u,
m),u=new a.b,p.gc(z,u),a.b.sc(m,u)>d&&(f=!0)):(p.gc(z,m),r=new a.b,c.gc(u,r),a.b.sc(m,r)>d&&(f=!0));b[n]=m}e=0;k=-1;for(n=0;n<=g;n++)w=n<g?this.ur[n]:1,w!=e&&(d=this.FB(),c.yh(e,w,d),-1!=k&&d.get().Mc(b[k]),n!=g&&d.get().Zc(b[n]),e=w,this.Tt.push(this.zx(d.get()))),k=n;c=[0,0,0,0,0,0,0,0,0];for(n=0;n<g;n++)c[n]=n;1<g&&this.dl[0]>this.dl[1]&&(w=this.dl[0],this.dl[0]=this.dl[1],this.dl[1]=w,n=c[0],c[0]=c[1],c[1]=n);e=0;k=-1;for(n=0;n<=g;n++)w=n<g?this.dl[n]:1,w!=e&&(d=this.FB(),p.yh(e,w,d),-1!=k&&(e=
c[k],d.get().Mc(b[e])),n!=g&&(e=c[n],d.get().Zc(b[e])),e=w,this.lx.push(this.zx(d.get()))),k=n;return f}throw a.f.ya();}return!1};c.prototype.rA=function(b,c,h){c.copyTo(this.cg);if(1!=this.$o.length)throw a.f.ya();this.ta=b;var d=this.$o[0];if(h||d.zj.$u(c.w(),b,!0))if(322==d.zj.G()){b=d.zj;var f=b.oe(c.w(),!1);this.ur[0]=f;var e=d.SB;h=1;0==f?(e=d.TB,h=d.SC):1==f&&(e=d.RB,h=d.RC);d=new a.b;0==e?(e=new a.b,b.gc(f,e),c=c.w(),a.Ub.bI(e,c,1/(h+1),d)):0<e?(d=new a.b,b.gc(f,d)):d=c.w();h=0;f=-1;for(e=
0;1>=e;e++){c=1>e?this.ur[e]:1;if(c!=h){var k=this.FB();b.yh(h,c,k);-1!=f&&k.get().Mc(d);1!=e&&k.get().Zc(d);h=c;this.Tt.push(this.zx(k.get()))}f=e}this.cg.rb(d)}else throw a.f.ya();};return c}();a.cE=e})(C||(C={}));(function(a){var f=function(){function f(c){this.yt=this.Tk=this.wb=null;this.gm=this.vf=this.cd=this.Ze=this.Oh=this.Ta=0;this.bb=null;this.Sl=this.nn=!1;this.Ze=-1;this.Oh=this.cd=0;this.Ta=-1;this.bb=c;this.vf=this.vs(this.Oh);this.nn=!1;this.Tk=null;this.gm=-1;this.Sl=!1;this.yt=new a.b}
f.$p=function(c,b){if(0>b||b>=c.D())throw a.f.vd();var d=new f(c),h=c.bw(b);d.cd=b-c.wa(h);d.Oh=h+1;d.Ta=h;d.vf=d.vs(d.Ta);d.gm=d.bb.wa(d.Ta);d.Sl=d.bb.Qb(d.Ta);return d};f.Zp=function(c,b,d){if(0>b||b>=c.aa()||0>d)throw a.f.vd();var h=c.Qb(b)?0:1;if(d>=c.Ka(b)-h)throw a.f.vd();c=new f(c);c.Ze=-1;c.cd=d;c.Ta=b;c.Oh=c.cd+1;c.vf=c.vs(c.Oh);c.gm=c.bb.wa(c.Ta);c.Sl=c.bb.Qb(c.Ta);return c};f.prototype.xX=function(c){if(this.bb!=c.bb)throw a.f.La();this.Ze=c.Ze;this.cd=c.cd;this.Ta=c.Ta;this.Oh=c.Oh;this.vf=
c.vf;this.nn=c.nn;this.gm=c.gm;this.Tk=null;this.Sl=c.Sl};f.prototype.ba=function(){this.Ze!=this.cd&&this.PE();if(this.nn)this.cd=(this.cd+1)%this.vf;else{if(this.cd==this.vf)throw a.f.vd();this.cd++}return this.Tk};f.prototype.Li=function(){if(this.nn)this.cd=(this.vf+this.cd-1)%this.vf;else{if(0==this.cd)throw a.f.vd();this.cd--}this.cd!=this.Ze&&this.PE();return this.Tk};f.prototype.yX=function(){this.Ze=-1;this.cd=0};f.prototype.zX=function(){this.cd=this.vf;this.Ze=-1};f.prototype.Tb=function(c,
b){void 0===b&&(b=-1);if(0<=this.Ta&&this.Ta<this.bb.aa()){var d=this.NO();if(c>=d&&c<this.bb.Gc(this.Ta)){this.Ze=-1;this.cd=c-d;return}}d=0<=b&&b<this.bb.aa()&&c>=this.bb.wa(b)&&c<this.bb.Gc(b)?b:this.bb.bw(c);this.Oh=d+1;this.Ta=d;this.Ze=-1;this.cd=c-this.bb.wa(d);this.vf=this.vs(d);this.gm=this.bb.wa(this.Ta);this.Sl=this.bb.Qb(this.Ta)};f.prototype.Ya=function(){this.Ta=this.Oh;if(this.Ta>=this.bb.aa())return!1;this.Ze=-1;this.cd=0;this.vf=this.vs(this.Ta);this.gm=this.bb.wa(this.Ta);this.Sl=
this.bb.Qb(this.Ta);this.Oh++;return!0};f.prototype.yj=function(){this.vf=this.cd=this.Ze=-1;this.Oh=0;this.Ta=-1;this.Sl=!1;this.gm=-1};f.prototype.dC=function(c){if(0>c)throw a.f.vd();this.Oh=c;this.gm=this.vf=this.cd=this.Ze=this.Ta=-1;this.Sl=!1};f.prototype.vs=function(c){if(this.bb.Hc())return 0;var b=1;this.bb.Qb(c)&&(b=0);return this.bb.Ka(c)-b};f.prototype.Fo=function(){return this.Ze==this.vf-1&&this.bb.Qb(this.Ta)};f.prototype.iC=function(){this.nn=!0};f.prototype.Db=function(){return this.bb.kb.g[this.Ta]+
this.Ze};f.prototype.NO=function(){return this.bb.wa(this.Ta)};f.prototype.Ik=function(){return this.Fo()?this.bb.wa(this.Ta):this.Db()+1};f.prototype.kn=function(){return 0==this.Ze};f.prototype.Io=function(){return this.Ze==this.vf-1};f.prototype.Ca=function(){return this.cd<this.vf};f.prototype.nA=function(){return 0<this.cd};f.prototype.Vf=function(){var c=new f(this.bb);c.Ze=this.Ze;c.cd=this.cd;c.vf=this.vf;c.Ta=this.Ta;c.Oh=this.Oh;c.bb=this.bb;c.nn=this.nn;return c};f.prototype.PE=function(){if(0>
this.cd||this.cd>=this.vf)throw a.f.vd();this.Ze=this.cd;var c=this.Db();this.bb.tc();var b=this.bb.cf,d=1;null!=b&&(d=b.read(c)&7);b=this.bb.description;switch(d){case 1:null==this.wb&&(this.wb=new a.Hb);this.Tk=this.wb;break;case 2:throw a.f.X("internal error");case 4:throw a.f.ya();default:throw a.f.ya();}this.Tk.Fg(b);d=this.Ik();this.bb.Nc(c,this.yt);this.Tk.Mc(this.yt);this.bb.Nc(d,this.yt);this.Tk.Zc(this.yt);for(var h=1,f=b.Ea;h<f;h++)for(var e=b.zd(h),k=a.na.Xa(e),p=0;p<k;p++){var g=this.bb.Yc(e,
c,p);this.Tk.Sx(e,p,g);g=this.bb.Yc(e,d,p);this.Tk.Kx(e,p,g)}};f.prototype.SU=function(){return this.Ta==this.bb.aa()-1};f.prototype.Go=function(){var c=this.bb.NT();return null!=c?1!=(c.read(this.Ze)&7):!1};return f}();a.XN=f})(C||(C={}));(function(a){var f=function(){function f(c){c instanceof a.T?(this.II=c,this.Ba=-1,this.dj=1):(this.uV=c.slice(0),this.Ba=-1,this.dj=c.length)}f.prototype.Ha=function(){return this.Ba};f.prototype.next=function(){return this.Ba<this.dj-1?(this.Ba++,null!=this.II?
this.II:this.uV[this.Ba]):null};f.prototype.Re=function(){return!0};return f}();a.hd=f})(C||(C={}));(function(a){var f=function(){return function(){this.next=null}}(),e=function(){function c(){this.Lr=this.vx=this.wx=this.Pk=this.ai=0;this.tG=!1;this.WK=0;this.Yn=this.kg=this.Fm=this.hi=null;this.tm=0;this.$y=null;this.Pk=this.ai=-1}c.prototype.uY=function(b,c,h){this.ai=b;this.Pk=c;this.hi=this.Fm=null;this.Lr=0;this.$y=h;null==this.Yn&&(this.Yn=a.J.gf(384,0));this.ZK()};c.prototype.N=function(){return this.ai};
c.prototype.fa=function(){return this.Pk};c.prototype.flush=function(){0<this.tm&&(this.$y.oG(this.Yn,this.tm),this.tm=0)};c.prototype.ZK=function(){if(0<this.Lr){for(var b=0;b<this.Pk;b++){for(var c=this.Fm[b];null!=c;){var a=c,c=c.next;a.next=null}this.Fm[b]=null}this.hi=null}this.wx=this.Pk;this.vx=-1;this.Lr=0};c.prototype.XJ=function(b){this.tG=b==c.oy;for(b=this.wx;b<=this.vx;b++)this.rP(),this.iP(b),this.XR();this.ZK()};c.prototype.Py=function(b,c,h,e){if(c!=e){var d=1;c>e&&(d=b,b=h,h=d,d=
c,c=e,e=d,d=-1);if(!(0>e||c>=this.Pk)){0>b&&0>h?h=b=-1:b>=this.ai&&h>=this.ai&&(h=b=this.ai);var l=(h-b)/(e-c);e>this.Pk&&(e=this.Pk,h=l*(e-c)+b);0>c&&(b=l*(0-c)+b,c=0);var k=Math.max(this.ai+1,8388607);-8388607>b?(c=(0-b)/l+c,b=0):b>k&&(c=(this.ai-b)/l+c,b=this.ai);-8388607>h?e=(0-b)/l+c:h>k&&(e=(this.ai-b)/l+c);c=a.J.truncate(c);e=a.J.truncate(e);c!=e&&(h=new f,h.x=a.J.truncate(4294967296*b),h.y=c,h.B=e,h.RR=a.J.truncate(4294967296*l),h.dir=d,null==this.Fm&&(this.Fm=a.J.gf(this.Pk,null)),h.next=
this.Fm[h.y],this.Fm[h.y]=h,h.y<this.wx&&(this.wx=h.y),h.B>this.vx&&(this.vx=h.B),this.Lr++)}}};c.prototype.rP=function(){if(null!=this.hi){for(var b=!1,c=null,a=this.hi;null!=a;)if(a.y++,a.y==a.B){var f=a,a=a.next;null!=c?c.next=a:this.hi=a;f.next=null}else a.x+=a.RR,null!=c&&c.x>a.x&&(b=!0),c=a,a=a.next;b&&(this.hi=this.VK(this.hi))}};c.prototype.iP=function(b){if(!(b>=this.Pk)){var c=this.Fm[b];if(null!=c){this.Fm[b]=null;c=this.VK(c);this.Lr-=this.WK;b=this.hi;for(var a=!0,f=c,e=null;null!=b&&
null!=f;)b.x>f.x?(a&&(this.hi=f),a=f.next,f.next=b,null!=e&&(e.next=f),e=f,f=a):(a=b.next,b.next=f,null!=e&&(e.next=b),e=b,b=a),a=!1;null==this.hi&&(this.hi=c)}}};c.vG=function(b,c){return 0>b?0:b>c?c:b};c.prototype.XR=function(){if(null!=this.hi)for(var b=0,d=this.hi,f=a.J.truncate(a.J.fI(d.x)),e=d.next;null!=e;e=e.next)if(b=this.tG?b^1:b+e.dir,e.x>d.x){var k=a.J.truncate(a.J.fI(e.x));0!=b&&(d=c.vG(f,this.ai),f=c.vG(k,this.ai),f>d&&d<this.ai&&(this.Yn[this.tm++]=d,this.Yn[this.tm++]=f,this.Yn[this.tm++]=
e.y,this.tm==this.Yn.length&&(this.$y.oG(this.Yn,this.tm),this.tm=0)));d=e;f=k}};c.prototype.VK=function(b){for(var d=0,f=b;null!=f;f=f.next)d++;this.WK=d;if(1==d)return b;null==this.kg?this.kg=a.J.gf(Math.max(d,16),null):this.kg.length<d&&(this.kg=a.J.gf(Math.max(d,2*this.kg.length),null));for(var e=0,f=b;null!=f;f=f.next)this.kg[e++]=f;2==d?this.kg[0].x>this.kg[1].x&&(b=this.kg[0],this.kg[0]=this.kg[1],this.kg[1]=b):c.TM(this.kg,d,function(b,c){return b==c?0:b.x<c.x?-1:b.x>c.x?1:0});b=this.kg[0];
this.kg[0]=null;f=b;for(e=1;e<d;e++)f.next=this.kg[e],f=this.kg[e],this.kg[e]=null;f.next=null;return b};c.TM=function(b,c,a){if(c==b.length)b.sort(a);else{var d=b.slice(0,0),f=b.slice(c);c=b.slice(0,c).sort(a);b.length=0;b.push.apply(b,d.concat(c).concat(f))}};c.oy=0;c.K_=1;return c}();a.yy=e})(C||(C={}));(function(a){var f=function(){function f(){}f.prototype.Ri=function(c,b){var d=this.a.Sa(c,this.Fr);this.fm==d&&(this.fm=this.Me.nb(this.fm));this.Vo==d&&(this.Vo=this.Me.nb(this.Vo));this.Me.kd(this.vB,
d);this.yk(c);if(b&&(d=this.a.ld(c),-1!=d&&this.a.cb(d)==c)){b=this.a.U(c);if(b!=c){var a=this.a.ld(b);if(a==d){this.a.jg(d,b);return}b=this.a.Ra(c);if(b!=c&&(a=this.a.ld(b),a==d)){this.a.jg(d,b);return}}this.a.jg(d,-1);this.a.sh(d,-1)}};f.prototype.FE=function(){for(var c=!1,b=0,d=new a.b;;){b++;null==this.vi?(this.vi=new a.ia(0),this.ut=new a.ia(0),this.Xe=new a.ia(0)):(this.vi.clear(!1),this.ut.clear(!1),this.Xe.clear(!1));for(var f=this.Vo,e=0,k=!0;f!=this.fm;){var p=this.Me.getData(f),g=new a.b;
this.a.Nc(p,g);k&&(this.a.Nc(p,d),k=!1);var g=this.a.Ra(p),n=this.a.U(p);-559038737!=this.a.Sa(g,this.Ug)&&(this.vi.add(g),this.a.Va(g,this.Ug,-559038737),this.ut.add(p),this.Xe.add(e++));-559038737!=this.a.Sa(n,this.Ug)&&(this.vi.add(n),this.a.Va(n,this.Ug,-559038737),this.ut.add(p),this.Xe.add(e++));f=this.Me.nb(f)}if(2>this.vi.size)break;var u=this;this.Xe.Gd(0,this.Xe.size,function(b,c){return u.FO(b,c)});f=0;for(e=this.Xe.size;f<e;f++)k=this.Xe.get(f),k=this.vi.get(k),this.a.Va(k,this.Ug,f),
g=new a.b,this.a.Nc(k,g);g=this.RO(d);f=0;for(e=this.Xe.size;f<e;f++)k=this.Xe.get(f),-1!=k&&(k=this.vi.get(k),this.a.Va(k,this.Ug,-1));if(g)c=!0;else break}return c};f.prototype.RO=function(c){for(var b=!1,d=!0;d;){var d=!1,a=0;-1==this.Xe.get(a)&&(a=this.Qm(a));for(var f=this.Qm(a),e=0,k=this.Xe.size;e<k&&-1!=a&&-1!=f&&a!=f;e++){var p=this.Xe.get(a),f=this.Xe.get(f),p=this.vi.get(p),f=this.vi.get(f),g=this.a.U(p);this.a.pw(g,c)||(g=this.a.Ra(p));var n=this.a.U(f);this.a.pw(n,c)||(n=this.a.Ra(f));
var u=this.Yu(g,p),z=this.Yu(n,f),r=u?this.a.Ra(g):this.a.U(g),t=z?this.a.Ra(n):this.a.U(n),A=!1;this.mq(g)?A=!0:this.mq(n)?A=!0:this.mq(p)?A=!0:this.mq(f)?A=!0:this.mq(r)?A=!0:this.mq(t)&&(A=!0);!A&&this.a.Tq(p,f)&&(A=!0,this.IE(u,z,g,p,n,f));!A&&this.a.Tq(r,t)&&(A=!0,this.IE(!u,!z,g,r,n,t));A&&(b=!0);d=d||A;a=this.Qm(a);f=this.Qm(a)}}if(!b)for(a=0,-1==this.Xe.get(a)&&(a=this.Qm(a)),f=this.Qm(a),e=0,k=this.Xe.size;e<k&&-1!=a&&-1!=f&&a!=f;e++)p=this.Xe.get(a),f=this.Xe.get(f),p=this.vi.get(p),f=this.vi.get(f),
g=this.a.U(p),this.a.pw(g,c)||(g=this.a.Ra(p)),n=this.a.U(f),this.a.pw(n,c)||(n=this.a.Ra(f)),u=this.Yu(g,p),z=this.Yu(n,f),r=u?this.a.Ra(g):this.a.U(g),t=z?this.a.Ra(n):this.a.U(n),this.JO(u,z,p,g,r,f,n,t)&&(b=!0),a=this.Qm(a),f=this.Qm(a);return b};f.prototype.UO=function(){1736==this.a.hc(this.Y)&&1==this.a.xo(this.Y)&&(new a.Dg).xW(this.Uw,this.a,this.Y,this.je);var c=!1,b=!0;this.Ug=this.Fr=-1;var d=this.a.D(this.Y),f=new a.ia(0);f.yb(d);for(var e=this.a.Pb(this.Y);-1!=e;e=this.a.Sb(e))for(var k=
this.a.cb(e),p=0,g=this.a.Ka(e);p<g;p++)f.add(k),k=this.a.U(k);var n=this.a.Dd.g,u=this.a.Dd.ed;this.a.xb.tc();var z=this.a.xb.xa[0].g;f.Gd(0,d,function(b,c){var d=n[u*b],a=n[u*c],f=z[2*d],d=z[2*d+1],h=z[2*a],a=z[2*a+1],f=d<a?-1:d>a?1:f<h?-1:f>h?1:0;0==f&&(f=n[u*b+3],a=n[u*c+3],f=f<a?-1:f==a?0:1);return f});this.Fr=this.a.Vd();this.Me=new a.Xp;this.vB=this.Me.mi(0);this.Me.Wn(d);for(e=0;e<d;e++)k=f.get(e),p=this.Me.addElement(this.vB,k),this.a.Va(k,this.Fr,p);this.Ug=this.a.Vd();this.fm=-1;for(this.vE()&&
(c=!0);b;){b=!1;d=0;f=!1;do{f=!1;this.Vo=-1;for(var g=0,e=new a.b,p=new a.b,r=this.Me.xc(this.vB);-1!=r;)k=this.Me.getData(r),-1!=this.Vo?(this.a.Nc(k,p),e.ub(p))?g++:(e.L(p),this.fm=r,0<g&&(k=this.FE())&&(f=!0,-1!=this.fm&&(k=this.Me.getData(this.fm),this.a.Nc(k,e))),this.Vo=r=this.fm,g=0):(this.Vo=r,this.a.Nc(this.Me.getData(r),e),g=0),-1!=r&&(r=this.Me.nb(r));this.fm=-1;0<g&&(k=this.FE())&&(f=!0);if(10<d++)throw a.f.ya();f&&this.MO();this.vE()&&(f=!0);b=b||f&&!1;c=c||f}while(f)}this.a.ke(this.Fr);
this.a.ke(this.Ug);return c=a.RN.V(this.a,this.Y,this.Me,this.Uw)||c};f.prototype.Yu=function(c,b){return this.a.U(b)==c?!1:!0};f.prototype.JO=function(c,b,d,a,f,e,k,p){if(a==k)return this.yk(d),this.yk(e),!1;var h=this.a.Sa(d,this.Ug),l=this.a.Sa(f,this.Ug),q=this.a.Sa(e,this.Ug),g=this.a.Sa(p,this.Ug);d=[0,0,0,0,0,0,0,0];var n=[0,0,0,0];d[0]=0;n[0]=h;d[1]=0;n[1]=l;d[2]=1;n[2]=q;d[3]=1;n[3]=g;for(h=1;4>h;h++){l=n[h];q=d[h];for(g=h-1;0<=g&&n[g]>l;)n[g+1]=n[g],d[g+1]=d[g],g--;n[g+1]=l;d[g+1]=q}n=0;
0!=d[0]&&(n|=1);0!=d[1]&&(n|=2);0!=d[2]&&(n|=4);0!=d[3]&&(n|=8);if(5!=n&&10!=n)return!1;c==b?c?(this.a.Kc(p,a),this.a.Lc(a,p),this.a.Kc(f,k),this.a.Lc(k,f)):(this.a.Lc(p,a),this.a.Kc(a,p),this.a.Lc(f,k),this.a.Kc(k,f)):c?(this.a.Lc(a,e),this.a.Kc(e,a),this.a.Lc(k,f),this.a.Kc(f,k)):(this.a.Kc(a,e),this.a.Lc(e,a),this.a.Kc(k,f),this.a.Lc(f,k));return!0};f.prototype.IE=function(c,b,d,a,f,e){this.B_?this.TO():this.SO(c,b,d,a,f,e)};f.prototype.TO=function(){throw a.f.X("not implemented.");};f.prototype.SO=
function(c,b,d,a,f,e){if(c!=b)c?(this.a.Kc(d,f),this.a.Lc(f,d),this.a.Kc(e,a),this.a.Lc(a,e),this.po(f,d),this.Ri(f,!0),this.a.Mi(f,!0),this.yk(d),this.po(e,a),this.Ri(e,!0),this.a.Mi(e,!1)):(this.a.Kc(f,d),this.a.Lc(d,f),this.a.Kc(a,e),this.a.Lc(e,a),this.po(f,d),this.Ri(f,!0),this.a.Mi(f,!1),this.yk(d),this.po(e,a),this.Ri(e,!0),this.a.Mi(e,!0)),this.yk(a);else{var h=c?d:a,l=b?f:e;c=c?a:d;b=b?e:f;f=!1;this.a.Kc(h,l);this.a.Kc(l,h);this.a.Lc(c,b);this.a.Lc(b,c);for(e=b;e!=l;)d=this.a.Ra(e),a=this.a.U(e),
this.a.Lc(e,a),this.a.Kc(e,d),f=f||e==h,e=a;f||(d=this.a.Ra(l),a=this.a.U(l),this.a.Lc(l,a),this.a.Kc(l,d));this.po(l,h);this.Ri(l,!0);this.a.Mi(l,!1);this.yk(h);this.po(b,c);this.Ri(b,!0);this.a.Mi(b,!1);this.yk(c)}};f.prototype.vE=function(){for(var c=!1,b=this.a.Pb(this.Y);-1!=b;){for(var d=this.a.cb(b),a=0,f=this.a.Ka(b);a<f&&1<f;){var e=this.a.Ra(d),k=this.a.U(d);this.a.Tq(e,k)?(c=!0,this.Ri(d,!1),this.a.td(d,!0),this.Ri(k,!1),this.a.td(k,!0),d=e,a=0,f=this.a.Ka(b)):(d=k,a++)}if(2>this.a.Ka(b)){c=
this.a.cb(b);a=0;for(f=this.a.Ka(b);a<f;a++)this.Ri(c,!1),c=this.a.U(c);b=this.a.Qr(b);c=!0}else b=this.a.Sb(b)}return c};f.prototype.mq=function(c){for(var b=!1;;){var d=this.a.U(c),a=this.a.Ra(c);if(d==c)return this.Ri(c,!0),this.a.Mi(c,!1),!0;if(!this.a.Tq(d,a))break;b=!0;this.yk(a);this.yk(d);this.Ri(c,!0);this.a.Mi(c,!1);this.po(d,a);this.Ri(d,!0);this.a.Mi(d,!0);if(d==a)break;c=a}return b};f.prototype.MO=function(){for(var c=0,b=this.Me.xc(this.Me.Ge);-1!=b;b=this.Me.nb(b)){var d=this.Me.getData(b);
this.a.Aj(d,-1)}for(var a=0,f=this.a.Pb(this.Y);-1!=f;)if(b=this.a.cb(f),-1==b||-1!=this.a.ld(b))d=f,f=this.a.Sb(f),this.a.Rr(d);else{this.a.Aj(b,f);for(var e=1,d=this.a.U(b);d!=b;d=this.a.U(d))this.a.Aj(d,f),e++;this.a.Np(f,!1);this.a.mk(f,e);this.a.sh(f,this.a.Ra(b));a+=e;c++;f=this.a.Sb(f)}for(b=this.Me.xc(this.Me.Ge);-1!=b;b=this.Me.nb(b))d=this.Me.getData(b),-1==this.a.ld(d)&&(f=this.a.AH(this.Y,d,d,null),a+=this.a.Ka(f),c++);this.a.wm(this.Y,c);this.a.kk(this.Y,a);c=0;for(a=this.a.rd;-1!=a;a=
this.a.Ue(a))c+=this.a.D(a);this.a.yC(c)};f.prototype.Qm=function(c){for(var b=0,d=this.Xe.size-1;b<d;b++)if(c=(c+1)%this.Xe.size,-1!=this.Xe.get(c))return c;return-1};f.prototype.po=function(c,b){var d=this.a.Sa(b,this.Fr),a=this.a.Sa(b,this.Ug);this.a.IC(c,b);this.a.Va(b,this.Fr,d);this.a.Va(b,this.Ug,a)};f.prototype.yk=function(c){var b=this.a.Sa(c,this.Ug);-1!=b&&(this.Xe.set(b,-1),this.a.Va(c,this.Ug,-1))};f.V=function(c,b,d,a,e){var h=new f;h.a=c;h.Y=b;h.cB=d;h.Uw=a;h.je=e;return h.UO()};f.prototype.FO=
function(c,b){var d=this.vi.get(c),f=new a.b;this.a.Nc(d,f);var d=new a.b,e=this.vi.get(b);this.a.Nc(e,d);if(f.ub(d))return 0;c=this.ut.get(c);e=new a.b;this.a.Nc(c,e);b=this.ut.get(b);c=new a.b;this.a.Nc(b,c);b=new a.b;b.zc(f,e);f=new a.b;f.zc(d,c);return a.b.us(b,f)};return f}();a.lo=f})(C||(C={}));(function(a){(function(a){a[a.Local=0]="Local";a[a.Geographic=1]="Geographic";a[a.Projected=2]="Projected";a[a.Image=3]="Image";a[a.Unknown=4]="Unknown"})(a.YN||(a.YN={}));(function(a){a[a.Integer32=
0]="Integer32";a[a.Integer64=1]="Integer64";a[a.FloatingPoint=2]="FloatingPoint"})(a.IN||(a.IN={}));var f=function(){function f(){this.jq="";this.av=null;this.yg=0;this.kJ=this.tp=-1;this.Uh=null}f.prototype.yc=function(){return this.yg};f.prototype.Qs=function(){return 0};f.prototype.Rs=function(){return 0};f.prototype.Ss=function(){return 0};f.prototype.Ps=function(){return 0};f.prototype.Sz=function(){return 5.7295779513082306E10};f.prototype.Tz=function(){return 1E3};f.prototype.Rz=function(){return 1E3};
f.prototype.at=function(){return 1};f.prototype.re=function(){var c=.001;0!=this.yg?c=a.ts.tS(this.yg):null!=this.Uh&&(c=a.nE.uS(this.Uh));return c};f.prototype.lH=function(){return this.Uh};f.prototype.Od=function(){if(0!=this.yg)return a.oc.ze(a.ts.wG(this.yg));if(null!=this.Uh)return a.nE.vS(this.Uh)};f.Fb=function(c){if(0!=c.yg){if(!0===a.ts.RU(c.yg))return 1;if(!0===a.ts.TU(c.yg))return 2}return 4};f.prototype.Zs=function(){var c=this.yc();if(-1!=this.tp)return this.tp;this.tp=a.ts.rZ(c);return-1!=
this.tp?this.tp:c};f.create=function(c){if(0>=c)throw a.f.F("Invalid or unsupported wkid: "+c);var b=new f;b.yg=c;return b};f.nR=function(c){if(null==c||0==c.length)throw a.f.F("Cannot create SpatialReference from null or empty text.");var b=new f;b.Uh=c;return b};f.prototype.Eb=function(c){return this==c?!0:null==c||this.constructor!=c.constructor||this.yg!=c.yg||0==this.yg&&this.Uh!==c.Uh?!1:!0};f.OS=function(c,b){var d=Math.PI/180,f=new a.ea;a.oM.RS(c.w().x*d,c.w().y*d,b.w().x*d,b.w().y*d,f);return f.j};
f.prototype.toString=function(){return"[ tol: "+this.Bo()+"; wkid: "+this.yc()+"; wkt: "+this.lH()+"]"};f.prototype.jc=function(){if(""!==this.jq)return this.jq;var c=this.toString();if(Array.prototype.reduce)return this.jq="S"+c.split("").reduce(function(b,c){b=(b<<5)-b+c.charCodeAt(0);return b&b},0);var b=0;if(0===c.length)return"";for(var d=0;d<c.length;d++)b=(b<<5)-b+c.charCodeAt(d),b&=b;return this.jq="S"+b};f.prototype.Bo=function(){return this.re(0)};f.prototype.Ao=function(){return null!==
this.av?this.av:this.av=a.Nu.uR(this)};f.p_=!0;f.rv=2147483645;f.sv=9007199254740990;return f}();a.Td=f})(C||(C={}));(function(a){var f=function(f){function c(){f.apply(this,arguments);this.ij=null;this.lp=new a.dE;this.Ww=this.Er=null}N(c,f);c.uR=function(b){var d=new c;d.yg=b.yg;d.tp=b.tp;d.kJ=b.kJ;d.Uh=b.Uh;if(""!==d.Uh&&null!==d.Uh){b=c.OY(d.Uh);var f=c.kX(d.Uh);d.lp.Dy(b,f,a.ss.Integer64);d.Jy(b);d.yg=b.Zs()}else b=c.CX(d.yg),d.Jy(b),d.lp.Dy(b,null,a.ss.Integer64);return d};c.prototype.re=function(b){return this.lp.Bo(b)};
c.kX=function(b){if(0>=b.length)throw a.f.F();var d=null;try{d=a.PD.fromString(b)}catch(h){d=null}return null==d?null:c.rD(d,!0)};c.prototype.Jy=function(b){this.Qd=b;this.Er=this.Qd.Od()};c.prototype.Jc=function(){return 0==this.Fb()||3==this.Fb()?!1:this.Qd.Jc()};c.prototype.TH=function(){return 0==this.Fb()?!1:3==this.Fb()?this.ij.Fk().Jc():this.Qd.Jc()};c.prototype.Kg=function(){return null!=this.Qd?this.Qd.uf:null};c.prototype.cn=function(){return this.Qd.cn()};c.prototype.de=function(){return this.Qd.de()};
c.prototype.Ch=function(){return null!=this.Qd?this.Qd.ex:NaN};c.prototype.en=function(){return this.Qd.en()};c.prototype.Vs=function(){return this.Qd.Vs()};c.prototype.Sj=function(){return this.Qd.Sj()};c.prototype.gU=function(b){return a.SD.yz(this.Qd,b.Qd)};c.prototype.Lk=function(){return this.Qd.Lk()};c.prototype.Us=function(){return this.Qd.Us()};c.prototype.pi=function(){return 3==this.Fb()?this.ij.Fk().pi():this.Qd.pi()};c.prototype.Bh=function(){if(!this.Jc())throw a.f.F("!isPannable()");
var b=new a.h;this.Qd.Bh(b);return b};c.prototype.qe=function(){if(!this.Jc())throw a.f.F("!isPannable()");return this.Qd.gp};c.prototype.zT=function(){if(!this.Jc())throw a.f.F("!isPannable()");var b=new a.h;this.Qd.yT(b);return b};c.prototype.aw=function(){if(!this.Jc())throw a.f.F("!isPannable()");return this.Qd.aw()};c.prototype.$v=function(){if(!this.Jc())throw a.f.F("!isPannable()");return this.Qd.$v()};c.prototype.Ws=function(){return null!=this.ij?this.ij.Fk().Ws():this.Qd.Ws()};c.prototype.CS=
function(){return this.Qd.Tv()};c.prototype.hX=function(b){b.assign(this.lp)};c.prototype.Yi=function(){return this.Er.getUnitFactor()};c.prototype.eA=function(b){return this.lp.eA(b)};c.prototype.kc=function(){var b=this.Fb();if(1==b)return this;if(3==b)return this.ij.Fk().kc();if(0==b)throw a.f.X("invalid call");if(4===b)throw a.f.X("invalid call");if(null!==this.Ww)return this.Ww;b=this.Kg().getGeogcs();if(null==b)throw a.f.ya();return this.Ww=c.hG(b,this.lp.at())};c.hG=function(b,d){if(null==
b)throw a.f.F("null pointer.");var f=new c;b=c.Ou(b,!0);f.lp.Dy(b,null,d);f.Jy(b);f.yg=b.Zs();return f};c.prototype.Fb=function(){var b=this.Kg();if(null!=b)switch(b.getType()){case a.Vc.PE_TYPE_GEOGCS:return 1;case a.Vc.PE_TYPE_PROJCS:return 2}return 4};c.prototype.cA=function(b){var c=new a.b;this.Qd.cA(b,c);return c};c.prototype.Tv=function(){return this.Qd.Tv()};c.Ou=function(b,d){var f=b.getCode();if(0>=f&&(f=a.Tf.getCode(b),0<f)){var e=a.Tf.coordsys(f);if(null==e)throw a.f.F("Text to wkid mapping had failed: "+
f);return c.Ou(e,d)}if(d&&0<f&&(e=c.Lv[f]))return e;e=a.Ib.hw(b,f,!1);if(d=c.yH[e])return d;d=0>=f?b:a.Tf.coordsys(f);d=new a.SD(d);c.yH[e]=d;0<f&&(c.Lv[f]=d);return d};c.CX=function(b){if(0>=b)throw a.f.F("Invalid or unsupported wkid: "+b);var d=c.Lv[b];if(null!=d)return d;d=a.Tf.coordsys(b);if(null==d)throw a.f.F("Invalid or unsupported wkid: "+b);d=c.Ou(d,!1);d.Zs()!=b&&(c.Lv[b]=d);return d};c.OY=function(b){if(null==b||void 0===b||0==b.length)throw a.f.F("Cannot create SpatialReference from null or empty text.");
var d=null;try{d=a.Tf.fromString(a.Vc.PE_TYPE_COORDSYS,b)}catch(h){throw a.f.F("Cannot create SpatialReference from text. "+h.message);}if(null===d)throw a.f.F("Cannot create SpatialReference from text. ");return c.Ou(d,!0)};c.rD=function(b,d){var f=b.getCode();if(0>=f&&(f=a.Tf.getCode(b),0<f)){f=a.Tf.vertcs(f);if(null===f)throw a.f.F();return c.rD(f,d)}if(d&&0<f&&(d=c.wH[f]))return d;b=a.Ib.hw(b,f,!1);if(d=c.XH[b])return d;var e;0>=f||(e=a.Tf.vertcs(f));if(null===e)throw a.f.F();d=new a.EN(e);c.XH[b]=
d;0<f&&(c.wH[f]=d);return d};c.iK=function(b,c){var d;if(null===c||c.u())return null;var f=new a.h,e;null!==c&&1!=b.Fb()?(d=b.kc(),e=d.Kg(),d=a.qs.Hs(b,d,null,null),d=a.ns.local().V(c,d,null),d.s(f)):(e=b.Kg(),c.s(f));d=e.getPrimem().getLongitude();e=e.getUnit().getUnitFactor();return new a.ND(f.o,f.A,f.v,f.B,d,e)};c.DE=function(b){var c={name:"",steps:[],_pt:null,_entry:null},a=0;for(b=b.getEntries();a<b.length;a++){var f=b[a],e={x_:!1,X_:"",W_:-1,geogtran:null};0===f.getDirection()?e.isInverse=
!1:e.isInverse=!0;var k=f.getGeogtran().getCode();-1<k?e.wkid=k:e.wkt=f.getGeogtran().toString();c.steps.push(e)}return c};c.PT=function(b,d,f,e){void 0===f&&(f=null);f=c.iK(e,f);b=a.fq.getGTlist(b.Kg(),d.Kg(),2,a.fq.PE_GTLIST_OPTS_COMMON,f,1);d=null;b&&0<b.length&&(d=this.DE(b[0]),a.vy.destroy(b));null!==f&&f.destroy();return d};c.QT=function(b,d,f,e){var h;void 0===f&&(f=null);void 0===e&&(e=null);void 0===h&&(h=30);f=c.iK(e,f);b=a.fq.getGTlist(b.Kg(),d.Kg(),2,a.fq.PE_GTLIST_OPTS_COMMON,f,h);d=
[];if(b&&0<b.length){for(h=0;h<b.length;h++)d.push(this.DE(b[h]));a.vy.destroy(b)}null!==f&&f.destroy();return d};c.Lv={};c.yH={};c.wH={};c.XH={};return c}(a.Td);a.Nu=f})(C||(C={}));(function(a){(function(c){c[c.Integer32=0]="Integer32";c[c.Integer64=1]="Integer64";c[c.FloatingPoint=2]="FloatingPoint"})(a.ss||(a.ss={}));var f=a.ss,e=function(){function c(){this.kq()}c.prototype.assign=function(b){this.Xl=b.Xl;this.Yl=b.Yl;this.uj=b.uj;this.Sw=b.Sw;this.Kn=b.Kn;this.Rw=b.Rw;this.qx=b.qx;this.jl=b.jl;
this.Br=b.Br;this.Ar=b.Ar;this.Fn=b.Fn};c.prototype.Qs=function(){return this.Xl};c.prototype.Rs=function(){return this.Yl};c.prototype.Ss=function(){return this.Sw};c.prototype.Ps=function(){return this.Rw};c.prototype.Sz=function(){return this.uj};c.prototype.Tz=function(){return this.Kn};c.prototype.Rz=function(){return this.qx};c.prototype.at=function(){return this.Fn};c.prototype.kq=function(){this.Yl=this.Xl=0;this.uj=1;this.Sw=0;this.Kn=1;this.Rw=0;this.qx=1;this.Ar=this.Br=this.jl=2.220446049250313E-14;
this.Fn=f.FloatingPoint};c.prototype.Dy=function(b,c,h){this.kq();this.Fn=h;if(h!=f.FloatingPoint){var d=new a.h;b.YS(d);this.Xl=d.o;this.Yl=d.A}else this.Yl=this.Xl=-1.7976931348623157E308;d=b.uf.getType();d==a.Vc.PE_TYPE_GEOGCS?(d=(h==f.Integer64?1E-9:1/18E5)*b.de(),this.uj=1/d):d==a.Vc.PE_TYPE_PROJCS&&(d=(h==f.Integer64?1E-4:.001)*b.cn(),this.uj=1/d);null!=c?(d=(h==f.Integer32?.001:1E-4)*c.WI,this.Kn=1/d):this.Kn=1E4;this.qx=1E4;this.VO();this.jl=b.ex;this.Br=null!=c?.001*c.WI:.001;this.Ar=2.220446049250313E-14};
c.prototype.VO=function(){if(this.Fn!=f.FloatingPoint){var b=this.Fn==f.Integer64?a.Td.sv:a.Td.rv,c=b/this.uj,h=this.Xl+c,e=a.J.truncate((h-this.Xl)*this.uj);e>b&&(this.uj=b/(h-this.Xl));c=this.Yl+c;e=a.J.truncate((c-this.Yl)*this.uj);e>b&&(this.uj=b/(c-this.Yl))}};c.prototype.xC=function(b,c){switch(b){case 0:this.jl=c;case 1:this.Br=c;case 2:this.Ar=c}};c.prototype.Bo=function(b){switch(b){case 0:return this.jl;case 1:return this.Br;case 2:return this.Ar}return 0};c.prototype.VT=function(){var b=
new a.h;switch(this.at()){case f.Integer32:var c=a.Td.rv/this.Sz();b.I(this.Qs(),this.Rs(),this.Qs()+c,this.Rs()+c);break;case f.Integer64:c=a.Td.sv/this.Sz();b.I(this.Qs(),this.Rs(),this.Qs()+c,this.Rs()+c);break;case f.FloatingPoint:b.I(-1.7976931348623157E308,-1*1.7976931348623157E308,1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.f.X("internal error");}return b};c.prototype.WT=function(){var b=new a.Ac;switch(this.at()){case f.Integer32:var c=a.Td.rv/this.Tz();b.I(this.Ss(),
this.Ss()+c);break;case f.Integer64:c=a.Td.sv/this.Tz();b.I(this.Ss(),this.Ss()+c);break;case f.FloatingPoint:b.I(-1*1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.f.X("internal error");}return b};c.prototype.rT=function(){var b=new a.Ac;switch(this.at()){case f.Integer32:var c=a.Td.rv/this.Rz();b.I(this.Ps(),this.Ps()+c);break;case f.Integer64:c=a.Td.sv/this.Rz();b.I(this.Ps(),this.Ps()+c);break;case f.FloatingPoint:b.I(-1*1.7976931348623157E308,1.7976931348623157E308);break;
default:throw a.f.X("internal error");}return b};c.prototype.eA=function(b){if(this.Fn==f.FloatingPoint)return 0;switch(b){case 0:return 1/this.uj;case 1:return 1/this.Kn;case 2:return 1/this.Kn;default:return 0}};c.prototype.toString=function(){var b;b="SRPD [m_toleranceXY: "+this.jl.toString();b=b+";m_falseX: "+this.Xl.toString();b=b+";m_falseY: "+this.Yl.toString();b=b+";m_unitsXY: "+this.uj.toString();b=b+";m_falseZ: "+this.Sw.toString();b=b+";m_unitsZ: "+this.Kn.toString();b=b+";m_falseM: "+
this.Rw.toString();b=b+";m_toleranceZ: "+this.Br.toString();b=b+";m_toleranceM: "+this.Ar.toString();b=b+";m_precision: "+this.Fn.toString();return b+"] "};return c}();a.dE=e})(C||(C={}));(function(a){function f(b,c){89.99999<c?c=89.99999:-89.99999>c&&(c=-89.99999);c*=.017453292519943;return[111319.49079327169*b,3189068.5*Math.log((1+Math.sin(c))/(1-Math.sin(c)))]}function e(b,c,d){b=b/6378137*57.29577951308232;return d?[b,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*c/6378137)))]:
[b-360*Math.floor((b+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*c/6378137)))]}function c(b,c){var d=b.Vf();if(33===b.G()){var f=c(d.Be(),d.nf());d.rb(f[0],f[1])}else if(197===b.G())f=c(b.R.o,b.R.A,!0),b=c(b.R.v,b.R.B,!0),d.I(f[0],f[1],b[0],b[1]);else for(f=new a.b,b=0;b<d.D();b++){d.w(b,f);var h=c(f.x,f.y,!0);f.ka(h[0],h[1]);d.rb(b,f)}return d}function b(b){return c(b,e)}function d(b){return c(b,f)}var h=Math.PI/180,l=function(){function b(){}b.Qu=function(b){var c=Math.sqrt(.006694379990197414),
d=Math.sin(b.y*h);return a.b.pa(6378137*b.x*h,3167719.6636462314*(d/(1-.006694379990197414*d*d)-1/(2*c)*Math.log((1-c*d)/(1+c*d))))};b.CA=function(b,c,d,f){var e=1/298.257223563,l=Math.sin(d);d=Math.cos(d);var k=(1-e)*Math.tan(b);b=1/Math.sqrt(1+k*k);for(var p=k*b,q=Math.atan2(k,d),k=b*l,g=k*k,n=1-g,u=2.7233160610754688E11*n/4.040829998466145E13,z=1+u/16384*(4096+u*(-768+u*(320-175*u))),r=u/1024*(256+u*(-128+u*(74-47*u))),u=f/(6356752.31424518*z),t=2*Math.PI,v,A,w,m;1E-12<Math.abs(u-t);)w=Math.cos(2*
q+u),v=Math.sin(u),A=Math.cos(u),m=r*v*(w+r/4*(A*(-1+2*w*w)-r/6*w*(-3+4*v*v)*(-3+4*w*w))),t=u,u=f/(6356752.31424518*z)+m;f=p*v-b*A*d;n=e/16*n*(4+e*(4-3*n));return a.b.pa((c+(Math.atan2(v*l,b*A-p*v*d)-(1-n)*e*k*(u+n*v*(w+n*A*(-1+2*w*w)))))/h,Math.atan2(p*A+b*v*d,(1-e)*Math.sqrt(g+f*f))/h)};b.AM=function(b,c,d,a){var f=1/298.257223563,h=a-c,e=Math.atan((1-f)*Math.tan(b)),l=Math.atan((1-f)*Math.tan(d)),k=Math.sin(e),e=Math.cos(e),p=Math.sin(l),l=Math.cos(l),q=h,g,n=1E3,u,z,r,t,v,A,w;do{r=Math.sin(q);
t=Math.cos(q);z=Math.sqrt(l*r*l*r+(e*p-k*l*t)*(e*p-k*l*t));if(0===z)return 0;t=k*p+e*l*t;v=Math.atan2(z,t);A=e*l*r/z;u=1-A*A;r=t-2*k*p/u;isNaN(r)&&(r=0);w=f/16*u*(4+f*(4-3*u));g=q;q=h+(1-w)*f*A*(v+w*z*(r+w*t*(-1+2*r*r)))}while(1E-12<Math.abs(q-g)&&0<--n);if(0===n)return k=a-c,{azimuth:Math.atan2(Math.sin(k)*Math.cos(d),Math.cos(b)*Math.sin(d)-Math.sin(b)*Math.cos(d)*Math.cos(k)),geodesicDistance:6371008.771415059*Math.acos(Math.sin(b)*Math.sin(d)+Math.cos(b)*Math.cos(d)*Math.cos(a-c))};b=2.7233160610754688E11*
u/4.040829998466145E13;c=b/1024*(256+b*(-128+b*(74-47*b)));return{azimuth:Math.atan2(l*Math.sin(q),e*p-k*l*Math.cos(q)),NS:6356752.31424518*(1+b/16384*(4096+b*(-768+b*(320-175*b))))*(v-c*z*(r+c/4*(t*(-1+2*r*r)-c/6*r*(-3+4*z*z)*(-3+4*r*r)))),P_:Math.atan2(e*Math.sin(q),e*p*Math.cos(q)-k*l)}};b.zR=function(b){var c=b.hasAttribute(1),d=b.hasAttribute(2),f=[],h=b.aa(),e=null,l=null;c&&(e=b.Pa(1));d&&(l=b.Pa(2));for(var k=new a.b,p=0;p<h;p++){for(var q=b.wa(p),g=b.Ka(p),n=0,u=0,z=NaN,r=NaN,t=NaN,v=NaN,
A=b.Qb(p),w=[],m=q;m<q+g;m++){b.w(m,k);var v=t=NaN,x=[k.x,k.y];c&&(t=e.get(m),x.push(t));d&&(h=l.get(m),x.push(v));m==q&&A&&(n=k.x,u=k.y,z=t,r=v);w.push(x)}!A||n==k.x&&u==k.y&&(!c||isNaN(z)&&isNaN(t)||z==t)&&(!d||isNaN(r)&&isNaN(v)||r==v)||w.push(w[0].slice(0));f.push(w)}return f};b.Dz=function(c,d){c=b.zR(c);637.100877141506>d&&(d=637.100877141506);for(var a=[],f,e=0;e<c.length;e++){var l=c[e];a.push(f=[]);f.push([l[0][0],l[0][1]]);var k,p,q,g,n,u;k=l[0][0]*h;p=l[0][1]*h;for(n=0;n<l.length-1;n++)if(q=
l[n+1][0]*h,g=l[n+1][1]*h,k!==q||p!==g){g=b.AM(p,k,g,q);q=g.azimuth;g=g.NS;var z=g/d;if(1<z){for(u=1;u<=z-1;u++){var r=b.CA(p,k,q,u*d);f.push([r.x,r.y])}u=b.CA(p,k,q,(g+Math.floor(z-1)*d)/2);f.push([u.x,u.y])}p=b.CA(p,k,q,g);f.push([p.x,p.y]);k=p.x*h;p=p.y*h}}return{fK:a}};b.MS=function(c){for(var d=[],f=0;f<c.length;f++){var h=c[f],h=b.Dz(h,1E4);d.push(h)}c=[];for(var e=0;e<d.length;e++){for(var h=d[e],l=0,f=0;f<h.fK.length;f++){var k=h.fK[f],p=b.Qu(a.b.pa(k[0][0],k[0][1])),q=b.Qu(a.b.pa(k[k.length-
1][0],k[k.length-1][1])),g=q.x*p.y-p.x*q.y,n;for(n=0;n<k.length-1;n++)p=b.Qu(a.b.pa(k[n+1][0],k[n+1][1])),q=b.Qu(a.b.pa(k[n][0],k[n][1])),g+=q.x*p.y-p.x*q.y;l+=g}l/=1;c.push(l/-2)}return c};return b}();a.pM=l;l=function(){function c(){}c.WB=function(b,d,a,f,h,e,l){c.tD[b.jc()]=d;0==isNaN(a)&&(c.vD[b.jc()]=a);0==isNaN(f)&&(c.WD[b.jc()]=f);0==isNaN(h)&&(c.nD[b.jc()]=h);c.xD[b.jc()]=e;null!==l&&(c.zD[b.jc()]=l)};c.Hx=function(b,d,a){c.QD[b.jc()+"-"+d.jc()]=a};c.kc=function(b){b=c.tD[b.jc()];if(void 0==
b)throw a.f.df();return b};c.de=function(b){b=c.vD[b.jc()];if(void 0==b)throw a.f.df();return b};c.gw=function(b){b=c.WD[b.jc()];if(void 0==b)throw a.f.df();return b};c.Rv=function(b){b=c.nD[b.jc()];if(void 0==b)throw a.f.df();return b};c.Bh=function(b){b=c.zD[b.jc()];if(void 0==b)throw a.f.df();return a.h.pa(b[0],b[1],b[2],b[3])};c.Jc=function(b){b=c.xD[b.jc()];if(void 0==b)throw a.f.df();return b};c.Xg=function(b,d,f){if(d.Eb(f))return b;var h=c.QD[d.jc()+"-"+f.jc()];if(void 0!==h)return h(b,d,
f);throw a.f.df();};c.ku=function(){throw a.f.df();};c.SS=function(){throw a.f.df();};c.TW=function(){throw a.f.df();};c.Lk=function(){throw a.f.df();};c.qX=function(){var c=a.Td.create(102100),f=a.Td.create(3857),h=a.Td.create(4326);a.fb.WB(c,h,NaN,NaN,NaN,!1,null);a.fb.WB(h,h,1,.0033528106647474805,6378137,!0,[-180,-90,180,90]);a.fb.WB(f,h,NaN,NaN,NaN,!1,null);a.fb.Hx(c,h,b);a.fb.Hx(h,c,d);a.fb.Hx(f,h,b);a.fb.Hx(h,f,d)};c.tD=[];c.vD=[];c.WD=[];c.nD=[];c.xD=[];c.zD=[];c.QD=[];return c}();a.fb=l})(C||
(C={}));C.fb.qX();(function(a){var f=function(){function f(c){this.g=null;this.kh=-1;this.xd=this.size=this.Jf=0;this.ed=c}f.prototype.kd=function(c){c<this.Jf?(this.g[c*this.ed]=this.kh,this.kh=c):this.Jf--;this.size--};f.prototype.S=function(c,b){return this.g[c*this.ed+b]};f.prototype.P=function(c,b,d){this.g[c*this.ed+b]=d};f.prototype.Pe=function(){var c=this.kh;if(-1==c){if(this.Jf==this.xd){c=0!=this.xd?a.J.truncate(3*(this.xd+1)/2):1;2147483647<c&&(c=2147483647);if(c==this.xd)throw a.f.vd();
this.Co(c)}c=this.Jf;this.Jf++}else this.kh=this.g[c*this.ed];this.size++;for(var b=c*this.ed+this.ed,d=c*this.ed;d<b;d++)this.g[d]=-1;return c};f.prototype.nl=function(c){var b=this.kh;if(-1==b){if(this.Jf==this.xd){b=0!=this.xd?a.J.truncate(3*(this.xd+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.xd)throw a.f.vd();this.Co(b)}b=this.Jf;this.Jf++}else this.kh=this.g[b*this.ed];this.size++;for(var d=b*this.ed,f=this.ed,e=0;e<f;e++)this.g[d+e]=c[e];return b};f.prototype.Vi=function(c){this.kh=-1;
this.size=this.Jf=0;c&&(this.g=null,this.xd=0)};f.prototype.Qe=function(c){c>this.xd&&this.Co(c)};f.prototype.$x=function(c,b,d){var a=this.g[this.ed*b+d];this.g[this.ed*b+d]=this.g[this.ed*c+d];this.g[this.ed*c+d]=a};f.Jm=function(){return-2};f.jo=function(){return-3};f.AA=function(c){return 0<=c};f.prototype.Co=function(c){null==this.g&&(this.g=[]);this.xd=c};return f}();a.ad=f;f=function(){function f(c){this.g=new Int32Array(0);this.kh=-1;this.xd=this.size=this.Jf=0;this.ed=c}f.prototype.kd=function(c){c<
this.Jf?(this.g[c*this.ed]=this.kh,this.kh=c):this.Jf--;this.size--};f.prototype.S=function(c,b){return this.g[c*this.ed+b]};f.prototype.P=function(c,b,d){this.g[c*this.ed+b]=d};f.prototype.Pe=function(){var c=this.kh;if(-1==c){if(this.Jf==this.xd){c=0!=this.xd?a.J.truncate(3*(this.xd+1)/2):1;2147483647<c&&(c=2147483647);if(c==this.xd)throw a.f.vd();this.Co(c)}c=this.Jf;this.Jf++}else this.kh=this.g[c*this.ed];this.size++;for(var b=c*this.ed;b<c*this.ed+this.ed;b++)this.g[b]=-1;return c};f.prototype.nl=
function(c){var b=this.kh;if(-1==b){if(this.Jf==this.xd){b=0!=this.xd?a.J.truncate(3*(this.xd+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.xd)throw a.f.vd();this.Co(b)}b=this.Jf;this.Jf++}else this.kh=this.g[b*this.ed];this.size++;for(var d=b*this.ed,f=0;f<c.length;f++)this.g[d+f]=c[f];return b};f.prototype.Vi=function(c){this.kh=-1;this.size=this.Jf=0;c&&(this.g=null,this.xd=0)};f.prototype.Qe=function(c){c>this.xd&&this.Co(c)};f.prototype.$x=function(c,b,d){var a=this.g[this.ed*b+d];this.g[this.ed*
b+d]=this.g[this.ed*c+d];this.g[this.ed*c+d]=a};f.Jm=function(){return-2};f.jo=function(){return-3};f.AA=function(c){return 0<=c};f.prototype.Co=function(c){null==this.g&&(this.g=new Int32Array(0));var b=new Int32Array(this.ed*c);b.set(this.g,0);this.g=b;this.xd=c};return f}();a.ZN=f;!0===a.Xh.Bm&&(a.ad=a.ZN)})(C||(C={}));(function(a){var f;(function(b){b[b.enumInputModeBuildGraph=0]="enumInputModeBuildGraph";b[b.enumInputModeSimplifyAlternate=4]="enumInputModeSimplifyAlternate";b[b.enumInputModeSimplifyWinding=
5]="enumInputModeSimplifyWinding";b[b.enumInputModeIsSimplePolygon=7]="enumInputModeIsSimplePolygon"})(f||(f={}));var e=function(){function b(b){this.bf=b;this.Wh=NaN;this.pI=new a.Cg;this.qI=new a.Cg;this.ht=new a.Ac;this.it=new a.Ac}b.prototype.compare=function(b,c,a){b=b.ja(a);this.bf.PB(c,this.pI);this.bf.PB(b,this.qI);c=this.pI.get();b=this.qI.get();this.ht.I(c.ua,c.sa);this.it.I(b.ua,b.sa);if(this.ht.ha<this.it.ca)return-1;if(this.ht.ca>this.it.ha)return 1;a=c.ra==c.oa;var d=b.ra==b.oa;if(a||
d){if(a&&d)return 0;if(c.ra==b.ra&&c.ua==b.ua)return a?1:-1;if(c.oa==b.oa&&c.sa==b.sa)return a?-1:1}a=c.pf(this.Wh,this.ht.ca);d=b.pf(this.Wh,this.it.ca);a==d&&(a=Math.min(c.oa,b.oa),d=.5*(a+this.Wh),d==this.Wh&&(d=a),a=c.pf(d,this.ht.ca),d=b.pf(d,this.it.ca));return a<d?-1:a>d?1:0};b.prototype.QK=function(b){this.Wh=b};return b}(),c=function(){function b(b){this.bb=b;this.iJ=new a.Cg;this.cg=new a.b;this.bB=new a.Ac}b.prototype.dY=function(b){this.cg.L(b)};b.prototype.compare=function(b,c){this.bb.PB(b.ja(c),
this.iJ);b=this.iJ.get();this.bB.I(b.ua,b.sa);if(this.cg.x<this.bB.ca)return-1;if(this.cg.x>this.bB.ha)return 1;b=b.pf(this.cg.y,this.cg.x);return this.cg.x<b?-1:this.cg.x>b?1:0};return b}();f=function(){function b(){this.sI=this.cj=this.fj=this.SA=this.No=this.Ye=this.Rc=this.Eh=this.De=null;this.sp=this.Tg=-1;this.rI=!0;this.WA=!1;this.TA=NaN;this.mj=new a.$d;this.bQ=2147483647;this.aQ=a.J.truncate(-2147483648);this.xg=this.xe=this.km=this.qr=this.rn=this.pr=this.It=this.rf=-1;this.qa=0}b.prototype.dz=
function(b){this.TA=b};b.prototype.Nn=function(){null==this.De&&(this.De=new a.ad(8));var b=this.De.Pe();this.De.P(b,1,0);return b};b.prototype.eW=function(){null==this.Rc&&(this.Rc=new a.ad(8));var b=this.Rc.Pe();this.Rc.P(b,2,0);this.Rc.P(b,3,0);var c=this.Rc.Pe();this.Rc.P(c,2,0);this.Rc.P(c,3,0);this.yK(b,c);this.yK(c,b);return b};b.prototype.uJ=function(){null==this.Ye&&(this.Ye=new a.ad(8));var b=this.Ye.Pe();this.Ye.P(b,2,0);return b};b.prototype.PX=function(b,c){this.De.P(b,7,c)};b.prototype.co=
function(b,c){this.De.P(b,2,c)};b.prototype.OX=function(b,c){this.De.P(b,1,c)};b.prototype.eY=function(b,c){this.De.P(b,3,c)};b.prototype.bY=function(b,c){this.De.P(b,4,c)};b.prototype.Ur=function(b,c){this.De.P(b,5,c)};b.prototype.VS=function(b){return this.De.S(b,5)};b.prototype.NX=function(b,c){this.De.P(b,6,c)};b.prototype.$O=function(b,c){this.NX(c,b)};b.prototype.xK=function(b,c){this.Rc.P(b,1,c)};b.prototype.yK=function(b,c){this.Rc.P(b,4,c)};b.prototype.ym=function(b,c){this.Rc.P(b,5,c)};
b.prototype.xm=function(b,c){this.Rc.P(b,6,c)};b.prototype.UX=function(b,c){this.Rc.P(b,2,c)};b.prototype.Mx=function(b,c){this.Rc.P(b,3,c)};b.prototype.VG=function(b){return this.Rc.S(b,3)};b.prototype.tu=function(b,c){this.Rc.P(b,7,c)};b.prototype.wL=function(b,c){if(-1!=this.an(b))for(c=c?-1:b,b=this.an(b);-1!=b;b=this.ft(b))this.a.Va(this.Uj(b),this.qr,c)};b.prototype.dy=function(b,c){-1!=b&&(this.wL(b,c),this.wL(this.za(b),c))};b.prototype.ru=function(b,c){this.Ye.P(b,1,c)};b.prototype.rh=function(b,
c){this.Ye.P(b,2,c)};b.prototype.$n=function(b,c){this.Ye.P(b,3,c);this.LX(b,this.US(c));this.KX(c,b)};b.prototype.KX=function(b,c){this.Ye.P(b,4,c)};b.prototype.LX=function(b,c){this.Ye.P(b,5,c)};b.prototype.sK=function(b,c){this.Ye.P(b,6,c)};b.prototype.qK=function(b,c){this.Ye.P(b,7,c)};b.prototype.pK=function(b,c){this.No.write(b,c)};b.prototype.rK=function(b,c){this.SA.write(b,c)};b.prototype.gZ=function(b){var c=0,d=0,f=this.LG(b),e=new a.b,k=new a.b,p=new a.b;this.Xs(f,e);k.L(e);var g=f;do this.$m(g,
p),d+=a.b.Cb(k,p),this.Ef(this.za(g))!=b&&(c+=(p.x-e.x-(k.x-e.x))*(p.y-e.y+(k.y-e.y))*.5),k.L(p),g=this.qc(g);while(g!=f);this.No.write(b,c);this.SA.write(b,d)};b.prototype.AW=function(b){var d=new e(this),f=new a.tk;f.Qe(a.J.truncate(this.qa/2));f.Ep(d);for(var k=new a.ia(0),p=this.xh(),g=null,n=0,u=new a.b,z=this.rf;-1!=z;z=this.og(z)){n++;var r=this.kf(z);if(-1!=r){k.yf(0);if(!this.$Y(f,p,k,r)){this.w(z,u);d.QK(u.y);var t=r;do{var A=this.Kb(t,p);-1!=A&&(f.Ld(A,-1),this.Ob(t,p,-2));t=this.qc(this.za(t))}while(r!=
t);t=r;do A=this.Kb(t,p),-1==A&&(A=f.addElement(t,-1),k.add(A)),t=this.qc(this.za(t));while(r!=t)}for(r=k.size-1;0<=r;r--)A=k.get(r),t=f.ja(A),this.Ob(this.za(t),p,A),this.zW(f,A,b)}else-1==this.Jz(z)&&(null==g&&(g=new c(this)),this.w(z,u),g.dY(u),t=f.GX(g),r=this.km,-1!=t&&(A=f.ja(t),this.Ef(A)==this.Ef(this.za(A))&&(A=this.XG(f,t)),-1!=A&&(r=this.Ef(A))),this.$O(r,z))}this.ni(p)};b.prototype.zW=function(b,c,a){var d=b.ja(c),f=this.Ef(d);if(-1==this.vo(f)){var h=this.XG(b,c),e=this.za(d),l=this.Ef(e);
this.Dq(f);this.Dq(l);var k=this.vo(f),p=this.vo(l);-1==h&&-1==k&&(l==f?(this.$n(l,this.km),k=p=this.km):(-1==p&&(this.$n(l,this.km),p=this.km),this.$n(f,l),k=l));if(-1!=h){var g=this.Ef(h);-1==p&&(0>=this.Dq(g)?(p=this.vo(g),this.$n(l,p)):(this.$n(l,g),p=g),l==f&&(k=p))}-1==k&&this.aZ(f,l);0==a?this.ZW(b,c,d,h,f,l):5==a?this.$W(b,c,d,e,f,l):4==a&&this.YW(d,h,f,l)}};b.prototype.ZW=function(b,c,a,f,e,k){var d=this.Hk(e);if(-1!=f){var h=this.Hk(k),l=this.Hk(this.Ef(f));f=d&h&l;l^=l&this.Ah(a);l|=f;
0!=l&&(this.rh(k,h|l),this.rh(e,l|d),d=d||l)}for(c=b.nb(c);-1!=c;c=b.nb(c)){f=b.ja(c);a=this.Ef(this.za(f));e=this.Hk(a);k=this.Ah(f);h=this.Ef(f);l=this.Hk(h);f=e&l&d;d^=d&k;d|=f;if(0==d)break;this.rh(a,e|d);this.rh(h,l|d)}};b.prototype.$W=function(b,c,f,e,k,p){if(k!=p){f=this.Kb(f,this.xg);f+=this.Kb(e,this.xg);e=0;var d=new a.ia(0),h=new a.ia(0);h.add(0);for(var l=b.xc(-1);l!=c;l=b.nb(l)){var q=b.ja(l),g=this.za(q),n=this.Ef(q),u=this.Ef(g);if(n!=u){q=this.Kb(q,this.xg);q+=this.Kb(g,this.xg);e+=
q;g=!1;0!=d.size&&d.Fc()==u&&(h.Pf(),d.Pf(),g=!0);if(-1==this.vo(u))throw a.f.ya();g&&this.vo(u)==n||(h.add(e),d.add(n))}}e+=f;0!=d.size&&d.Fc()==p&&(h.Pf(),d.Pf());0!=e?0==h.Fc()&&(b=this.a.rd,b=this.Ha(b),this.rh(k,b)):0!=h.Fc()&&(b=this.a.rd,b=this.Ha(b),this.rh(k,b))}};b.prototype.YW=function(b,c,a,f){var d=this.Ha(this.a.rd);if(-1==c)this.rh(f,this.sp),b=this.Kb(b,this.Tg),0!=(b&1)?this.rh(a,d):this.rh(a,this.sp);else{var h=this.Hk(f);0==h&&(h=this.Hk(this.Ef(c)),this.rh(f,h));b=this.Kb(b,this.Tg);
0!=(b&1)?this.rh(a,h==d?this.sp:d):this.rh(a,h)}};b.prototype.$Y=function(b,c,a,f){var d=f,h=-1,e=-1,l=0;do{if(2==l)return!1;var k=this.Kb(d,c);if(-1!=k){if(-1!=h)return!1;h=k}else{if(-1!=e)return!1;e=d}l++;d=this.qc(this.za(d))}while(f!=d);if(-1==e||-1==h)return!1;this.Ob(b.ja(h),c,-2);b.jk(h,e);a.add(h);return!0};b.prototype.aZ=function(b,c){var d=this.Dq(b);if(0!=d){var a=this.Dq(c);0<d&&0>a?this.$n(b,c):0>d&&0<a?this.$n(b,c):(d=this.vo(c),-1!=d&&this.$n(b,d))}};b.prototype.sR=function(b,c){this.qr=
this.a.Vd();for(var d=0,f=c.size;d<f;d++){var h=c.get(d),e=this.a.Sa(h,this.rn),k=this.a.ng(this.a.ld(h)),p=this.a.hc(k);if(a.T.Ic(p)){var g=this.a.U(h);if(-1!=g){var n=this.a.Sa(g,this.rn);if(e!=n){var u=this.eW(),z=this.za(u),r=this.Eh.Pe();this.Eh.P(r,0,h);this.Eh.P(r,1,-1);this.tu(u,r);this.xK(u,e);r=this.kf(e);-1==r?(this.co(e,u),this.ym(u,z),this.xm(z,u)):(e=this.Te(r),this.ym(r,z),this.xm(z,r),this.xm(e,u),this.ym(u,e));this.xK(z,n);e=this.kf(n);-1==e?(this.co(n,z),this.xm(u,z),this.ym(z,u)):
(n=this.Te(e),this.ym(e,u),this.xm(u,e),this.xm(n,z),this.ym(z,n));k=this.Ha(k);0==b?(this.Ob(z,this.xe,0),this.Ob(u,this.xe,1736==p?k:0)):5==b?(n=new a.b,this.a.w(h,n),h=new a.b,this.a.w(g,h),e=g=0,0>n.compare(h)?g=1:e=-1,this.Ob(z,this.xe,0),this.Ob(u,this.xe,0),this.Ob(u,this.xg,g),this.Ob(z,this.xg,e)):7==b?(this.Ob(z,this.xe,this.sp),this.Ob(u,this.xe,1736==p?k:0)):4==b&&(this.Ob(z,this.xe,0),this.Ob(u,this.xe,0),this.Ob(u,this.Tg,1),this.Ob(z,this.Tg,1));p=1736==p?this.aQ:0;this.Mx(u,k|p);this.Mx(z,
k|p)}}}}};b.prototype.TV=function(b,c){var d=this.an(c);if(-1!=d){var a=this.an(b);this.Eh.P(d,1,a);this.tu(b,d);this.tu(c,-1)}b=this.za(b);c=this.za(c);d=this.an(c);-1!=d&&(a=this.an(b),this.Eh.P(d,1,a),this.tu(b,d),this.tu(c,-1))};b.prototype.BY=function(b){function c(b,c){return f.JQ(b,c)}var d=new a.ia(0);d.yb(10);for(var f=this,e=this.rf;-1!=e;e=this.og(e)){d.clear(!1);var k=this.kf(e);if(-1!=k){var p=k;do d.add(p),p=this.qc(this.za(p));while(p!=k);if(1<d.size){p=!0;if(2<d.size)d.Gd(0,d.size,
c),d.add(d.get(0));else if(0<this.IQ(d.get(0),d.get(1))){var g=d.get(0);d.set(0,d.get(1));d.set(1,g)}else p=!1;for(var n=g=d.get(0),u=this.Xf(n),z=this.za(n),r=-1,t=1,A=d.size;t<A;t++){var w=d.get(t),m=this.za(w),x=this.Jk(m);if(x==u&&w!=n){if(0==b)r=this.VG(n)|this.VG(w),this.Mx(n,r),this.Mx(z,r),this.Ob(n,this.xe,this.Kb(n,this.xe)|this.Kb(w,this.xe)),this.Ob(z,this.xe,this.Kb(z,this.xe)|this.Kb(m,this.xe));else if(-1!=this.xg)r=this.Kb(n,this.xg)+this.Kb(w,this.xg),m=this.Kb(z,this.xg)+this.Kb(m,
this.xg),this.Ob(n,this.xg,r),this.Ob(z,this.xg,m);else{if(7==b){this.mj=new a.$d(5,e,-1);return}-1!=this.Tg&&(r=this.Kb(n,this.Tg)+this.Kb(w,this.Tg),m=this.Kb(z,this.Tg)+this.Kb(m,this.Tg),this.Ob(n,this.Tg,r),this.Ob(z,this.Tg,m))}this.TV(n,w);this.rz(w);r=n;d.set(t,-1);w==g&&(d.set(0,-1),g=-1)}else this.dy(r,!1),r=-1,n=w,u=x,z=m}this.dy(r,!1);r=-1;if(p){g=-1;t=0;for(A=d.size;t<A;t++)if(w=d.get(t),-1!=w)if(-1==g)n=g=w,u=this.Xf(n),z=this.za(n);else if(w!=n&&(m=this.za(w),x=this.Jk(m),this.xm(z,
w),this.ym(w,z),n=w,u=x,z=m,7==b&&(this.Kb(w,this.xe)|this.Kb(this.Te(w),this.xe))==(this.sp|1))){this.mj=new a.$d(5,e,-1);return}this.co(e,g)}else{g=-1;t=0;for(A=d.size;t<A;t++)if(w=d.get(t),-1!=w){g=w;break}k!=g&&this.co(e,g)}}}}};b.prototype.YP=function(){for(var b=-1,c=this.xh(),f=this.rf;-1!=f;f=this.og(f)){var e=this.kf(f);if(-1!=e){var k=e;do{if(1!=this.Kb(k,c)){var p=this.uJ();this.ru(p,k);this.qK(p,b);-1!=b&&this.sK(b,p);var b=p,g=0,n=k;do g|=this.Kb(n,this.xe),this.UX(n,p),this.Ob(n,c,1),
n=this.qc(n);while(n!=k);this.rh(p,g)}k=this.qc(this.za(k))}while(k!=e)}}p=this.uJ();this.ru(p,-1);this.qK(p,b);-1!=b&&this.sK(b,p);this.km=p;this.No=a.Sd.yd(this.Ye.size,NaN);this.SA=a.Sd.yd(this.Ye.size,NaN);this.pK(this.km,Infinity);this.rK(this.km,Infinity);this.ni(c)};b.prototype.hT=function(b,c,a){c=-1!=c?c:this.kf(b);if(-1==c)return-1;for(b=c;;){if(1!=this.Kb(c,a))return c;c=this.qc(this.za(c));if(c==b)return-1}};b.prototype.uX=function(){for(var b=this.xh(),c=this.rf;-1!=c;c=this.og(c))for(var a=
-1;;){var f=this.hT(c,a,b);if(-1==f)break;for(var a=this.qc(this.za(f)),e=f;;){var k=this.qc(e),p=this.Te(e),g=this.za(e);if(p==g){this.DR(e);if(a==e||a==g)a=-1;if(e==f||p==f){f=k;if(e==f||p==f)break;e=k;continue}}else this.Ob(e,b,1);e=k;if(e==f)break}}};b.prototype.lC=function(b,c,f,e){this.qh();this.rI=e;this.a=b;this.pr=this.a.gG();b=new a.ia(0);b.yb(null!=f?this.a.D(f.get(0)):this.a.ud);var d=0,h=1,l=null!=f?f.get(0):this.a.rd;for(e=1;-1!=l;){this.a.wK(l,this.pr,h);for(var h=h<<1,k=this.a.Pb(l);-1!=
k;k=this.a.Sb(k))for(var p=this.a.cb(k),g=0,q=this.a.Ka(k);g<q;g++)b.add(p),p=this.a.U(p);a.T.Jo(this.a.hc(l))||(d+=this.a.aa(l));null!=f?(l=e<f.size?f.get(e):-1,e++):l=this.a.Ue(l)}this.sp=h;this.qa=b.size;this.a.Wx(b,this.qa);null==this.Eh&&(this.Eh=new a.ad(2),this.De=new a.ad(8),this.Rc=new a.ad(8),this.Ye=new a.ad(8));this.Eh.Qe(this.qa);this.De.Qe(this.qa+10);this.Rc.Qe(2*this.qa+32);this.Ye.Qe(Math.max(32,d));this.rn=this.a.Vd();f=new a.b;e=0;d=new a.b;f.$c();for(h=0;h<=this.qa;h++)if(h<this.qa?
(p=b.get(h),this.a.w(p,d)):d.$c(),!f.ub(d)){if(e<h){p=this.Nn();for(q=g=-1;e<h;e++)q=b.get(e),this.a.Va(q,this.rn,p),l=this.Eh.Pe(),this.Eh.P(l,0,q),this.Eh.P(l,1,g),g=l,k=this.a.ld(q),l=this.a.ng(k),l=this.Ha(l),this.OX(p,this.Nd(p)|l);this.PX(p,g);this.Ur(p,this.a.Za(q));-1!=this.It&&this.bY(this.It,p);this.eY(p,this.It);this.It=p;-1==this.rf&&(this.rf=p)}e=h;f.L(d)}this.xe=this.xh();5==c&&(this.xg=this.xh());4==c&&(this.Tg=this.xh());this.sR(c,b);0==this.mj.Ii&&(this.BY(c),0==this.mj.Ii&&(isNaN(this.TA)||
this.zQ()?(this.YP(),0==this.mj.Ii&&(this.ni(this.xe),this.xe=-1,this.rI&&this.AW(c))):this.WA=!0))};b.prototype.rz=function(b){var c=this.qc(b),d=this.Te(b),a=this.za(b),f=this.qc(a),e=this.Te(a);c!=a&&(this.xm(e,c),this.ym(c,e));d!=a&&(this.xm(d,f),this.ym(f,d));d=this.Jk(b);this.kf(d)==b&&(f!=b?this.co(d,f):this.co(d,-1));f=this.Jk(a);this.kf(f)==a&&(c!=a?this.co(f,c):this.co(f,-1));this.Rc.kd(b);this.Rc.kd(a)};b.prototype.XG=function(b,c){for(;;)if(c=b.Ve(c),-1!=c){var d=b.ja(c);if(this.Ef(d)!=
this.Ef(this.za(d)))return d}else return-1};b.prototype.Vr=function(b,c,a){void 0===a&&(a=!0);this.lC(b,0,null,a)};b.prototype.lK=function(b,c){var d=new a.ia(0);d.add(c);this.lC(b,4,d,1736==b.hc(c))};b.prototype.mK=function(b,c){var d=new a.ia(0);d.add(c);this.lC(b,5,d,!0)};b.prototype.qh=function(){null!=this.a&&(-1!=this.pr&&(this.a.tX(this.pr),this.pr=-1),-1!=this.rn&&(this.a.ke(this.rn),this.rn=-1),-1!=this.qr&&(this.a.ke(this.qr),this.qr=-1),-1!=this.xe&&(this.ni(this.xe),this.xe=-1),-1!=this.xg&&
(this.ni(this.xg),this.xg=-1),-1!=this.Tg&&(this.ni(this.Tg),this.Tg=-1),this.a=null,this.De.Vi(!0),this.Eh.Vi(!0),this.It=this.rf=-1,null!=this.Rc&&this.Rc.Vi(!0),null!=this.fj&&(this.fj.length=0),null!=this.cj&&(this.cj.length=0),null!=this.sI&&(this.sI.length=0),null!=this.Ye&&this.Ye.Vi(!0),this.km=-1,this.No=null)};b.prototype.kf=function(b){return this.De.S(b,2)};b.prototype.w=function(b,c){this.a.oH(this.VS(b),c)};b.prototype.Nd=function(b){return this.De.S(b,1)};b.prototype.og=function(b){return this.De.S(b,
4)};b.prototype.Jz=function(b){return this.De.S(b,6)};b.prototype.Zm=function(b){return this.De.S(b,7)};b.prototype.ft=function(b){return this.Eh.S(b,1)};b.prototype.Uj=function(b){return this.Eh.S(b,0)};b.prototype.Hg=function(b,c){c=this.cj[c];return c.size<=b?-1:c.read(b)};b.prototype.eo=function(b,c,a){c=this.cj[c];c.size<=b&&c.resize(this.De.size,-1);c.write(b,a)};b.prototype.wq=function(){null==this.cj&&(this.cj=[]);for(var b=a.ia.yd(this.De.xd,-1),c=0,f=this.cj.length;c<f;c++)if(null==this.cj[c])return this.cj[c]=
b,c;this.cj.push(b);return this.cj.length-1};b.prototype.xq=function(b){this.cj[b]=null};b.prototype.Jk=function(b){return this.Rc.S(b,1)};b.prototype.Xf=function(b){return this.Jk(this.za(b))};b.prototype.za=function(b){return this.Rc.S(b,4)};b.prototype.Te=function(b){return this.Rc.S(b,5)};b.prototype.qc=function(b){return this.Rc.S(b,6)};b.prototype.Ef=function(b){return this.Rc.S(b,2)};b.prototype.Ff=function(b){return this.Hk(this.Rc.S(b,2))};b.prototype.an=function(b){return this.Rc.S(b,7)};
b.prototype.Xs=function(b,c){this.w(this.Jk(b),c)};b.prototype.$m=function(b,c){this.w(this.Xf(b),c)};b.prototype.Ah=function(b){return this.Rc.S(b,3)&this.bQ};b.prototype.Kb=function(b,c){c=this.fj[c];return c.size<=b?-1:c.read(b)};b.prototype.Ob=function(b,c,a){c=this.fj[c];c.size<=b&&c.resize(this.Rc.size,-1);c.write(b,a)};b.prototype.xh=function(){null==this.fj&&(this.fj=[]);for(var b=a.ia.yd(this.Rc.xd,-1),c=0,f=this.fj.length;c<f;c++)if(null==this.fj[c])return this.fj[c]=b,c;this.fj.push(b);
return this.fj.length-1};b.prototype.ni=function(b){this.fj[b]=null};b.prototype.DR=function(b){var c=this.Ef(b),d=this.qc(b);d==this.za(b)&&(d=this.qc(d),d==b&&(d=-1));this.LG(c)==b&&this.ru(c,d);d=this.No.read(c);isNaN(d)||(this.pK(c,NaN),this.rK(c,NaN));this.dy(b,!0);this.rz(b)};b.prototype.ER=function(b){for(var c=0,d=b.size;c<d;c++){var a=b.get(c),f=this.Ef(this.za(a));this.ru(this.Ef(a),-1);this.ru(f,-1);this.dy(a,!0);this.rz(a)}};b.prototype.LG=function(b){return this.Ye.S(b,1)};b.prototype.Hk=
function(b){return this.Ye.S(b,2)};b.prototype.vo=function(b){return this.Ye.S(b,3)};b.prototype.US=function(b){return this.Ye.S(b,4)};b.prototype.Dq=function(b){var c=this.No.read(b);isNaN(c)&&(this.gZ(b),c=this.No.read(b));return c};b.prototype.Ha=function(b){return this.a.UG(b,this.pr)};b.prototype.jf=function(b){return this.a.Sa(b,this.rn)};b.prototype.kT=function(b){return this.a.Sa(b,this.qr)};b.prototype.jT=function(b,c){var d=this.kf(b);if(-1==d)return-1;var a=d,f=-1,h=-1;do{if(this.Xf(a)==
c)return a;if(-1==f){f=this.kf(c);if(-1==f)break;h=f}if(this.Xf(h)==b)return a=this.za(h);a=this.qc(this.za(a));h=this.qc(this.za(h))}while(a!=d&&h!=f);return-1};b.prototype.PB=function(b,c){c.Is();c=c.get();var d=new a.b;this.Xs(b,d);c.Mc(d);this.$m(b,d);c.Zc(d)};b.prototype.JQ=function(b,c){if(b==c)return 0;var d=new a.b;this.$m(b,d);var f=new a.b;this.$m(c,f);if(d.ub(f))return 0;c=new a.b;this.Xs(b,c);b=new a.b;b.zc(d,c);d=new a.b;d.zc(f,c);return a.b.us(b,d)};b.prototype.IQ=function(b,c){if(b==
c)return 0;var d=new a.b;this.$m(b,d);var f=new a.b;this.$m(c,f);if(d.ub(f))return 0;c=new a.b;this.Xs(b,c);b=new a.b;b.zc(d,c);d=new a.b;d.zc(f,c);return 0<=d.y&&0<b.y?a.b.us(b,d):0};b.prototype.zQ=function(){for(var b=a.Ub.Xx(this.TA),c=new a.b,f=new a.b,e=new a.b,k=new a.b,p=new a.b,g=this.rf;-1!=g;g=this.og(g)){var n=this.kf(g);if(-1!=n){var u=n;this.Xs(u,c);this.$m(u,f);p.zc(f,c);var z=p.pk();do{var r=u,u=this.qc(this.za(u));if(u!=r){this.$m(u,e);k.zc(e,c);var r=k.pk(),t=k.Ui(p);if(t*t/(r*z)*
Math.min(r,z)<=b)return!1;p.L(k);z=r;f.L(e)}}while(u!=n)}}return!0};return b}();a.Pu=f})(C||(C={}));(function(a){var f=function(){function f(){this.i=null;this.zI=new a.b;this.AI=new a.b;this.Mh=null;this.ot=!1;this.Wo=-1}f.prototype.Gf=function(c){return c<this.Mh.length?this.Mh[c]:!1};f.prototype.Hl=function(c,b,d,f){var h=a.T.lf(this.i.a.hc(d));if(2==a.T.lf(this.i.a.hc(b))&&1==h)this.yR(c,b,d,f);else throw a.f.ya();};f.prototype.Vr=function(c,b){null==this.i&&(this.i=new a.Pu);this.i.Vr(c,b)};
f.prototype.Wr=function(c,b,d){a.rk.V(c,b,d,!0);for(b=c.rd;-1!=b;b=c.Ue(b))1736==c.hc(b)&&a.lo.V(c,b,-1,this.ot,d);this.Vr(c,d)};f.prototype.RF=function(c,b,d,a,f){var h=this.i.a;if(1736==h.hc(c))for(c=h.Pb(c);-1!=c;c=h.Sb(c)){var e=h.cb(c);this.i.jf(e);this.i.jf(h.U(e));var l=this.i.kT(e);if(-1!=l){var k=this.i.Kb(l,d);if(1!=k&&2!=k)if(this.Gf(this.i.Ff(l))){this.i.Ob(l,d,1);var k=h.Yf(b,-1),p=l,g=this.i.jf(e),n=1;do{var u=this.hn(e,f);h.Kj(k,u);-1!=a&&this.i.eo(g,a,1);this.i.Ob(p,d,1);var p=this.i.qc(p),
z;do u=1==n?h.U(e):h.Ra(e),z=-1!=u?this.i.jf(u):-1;while(z==g);var r=this.i.Jk(p);if(r!=z){do u=1==n?h.Ra(e):h.U(e),z=-1!=u?this.i.jf(u):-1;while(z==g);r!=z?(z=r,u=this.i.Uj(this.i.Zm(z))):n=-n}g=z;e=u}while(p!=l);h.ao(k,!0)}else this.i.Ob(l,d,2)}}};f.prototype.mG=function(){for(var c=this.i.xh(),b=new a.ia(0),d=this.i.rf;-1!=d;d=this.i.og(d)){var f=this.i.kf(d),e=f;if(-1!=f){do{if(1!=this.i.Kb(e,c)){var k=this.i.za(e);this.i.Ob(k,c,1);this.i.Ob(e,c,1);this.Gf(this.i.Ff(e))&&this.Gf(this.i.Ff(k))&&
b.add(e)}e=this.i.qc(this.i.za(e))}while(e!=f)}}this.i.ni(c);this.i.ER(b)};f.prototype.hn=function(c,b){return-1==b?c:this.UT(c,b)};f.prototype.UT=function(c,b){var d=this.i.a,a,f,e=this.i.Zm(this.i.jf(c));do{a=this.i.Uj(e);f=d.ng(d.ld(a));if(f==b)return a;e=this.i.ft(e)}while(-1!=e);return c};f.prototype.ds=function(c,b,d){this.mG();var f=this.i.a,e=f.bh(1736),k=this.i.xh();this.gL(c,b,e,d,k,-1);this.i.ni(k);a.lo.V(f,e,1,this.ot,null);return e};f.prototype.gL=function(c,b,d,a,f,e){this.RF(c,d,f,
e,a);-1!=b&&this.RF(b,d,f,e,a);c=this.i.a;for(b=this.i.rf;-1!=b;b=this.i.og(b)){var h=this.i.kf(b);if(-1!=h){var l=h;do{var k=this.i.Kb(l,f);if(1!=k&&2!=k)if(this.Gf(this.i.Ff(l))){var k=c.Yf(d,-1),p=l;do{var g=this.i.an(p);-1!=g?g=this.i.Uj(g):(g=this.i.Uj(this.i.an(this.i.za(p))),g=this.i.a.U(g));g=this.hn(g,a);c.Kj(k,g);this.i.Ob(p,f,1);-1!=e&&(g=this.i.jf(g),this.i.eo(g,e,1));p=this.i.qc(p)}while(p!=l);c.ao(k,!0)}else this.i.Ob(l,f,2);l=this.i.qc(this.i.za(l))}while(l!=h)}}};f.prototype.TY=function(c,
b,d){var f=this.i.a,e=f.bh(1736),k=f.bh(1607),p=f.bh(550);this.mG();var g=-1,n=this.i.xh(),u=this.i.wq();this.gL(c,b,e,d,n,u);for(c=this.i.rf;-1!=c;c=this.i.og(c))if(b=this.i.kf(c),-1!=b){var z=b;do{var r=this.i.Kb(z,n),t=this.i.Kb(this.i.za(z),n),r=r|t;if(2==r)if(r=this.i.Ah(z),this.Gf(r)){var A=f.Yf(k,-1),w=z,r=this.Ix(c,f),r=this.hn(r,d);f.Kj(A,r);this.i.eo(c,u,1);do{r=this.i.Xf(w);t=this.Ix(r,f);t=this.hn(t,d);f.Kj(A,t);this.i.Ob(w,n,1);this.i.Ob(this.i.za(w),n,1);this.i.eo(r,u,1);w=this.i.qc(w);
r=this.i.Kb(w,n);t=this.i.Kb(this.i.za(w),n);r|=t;if(2!=r)break;r=this.i.Ah(w);if(!this.Gf(r)){this.i.Ob(w,n,1);this.i.Ob(this.i.za(w),n,1);break}}while(w!=z)}else this.i.Ob(z,n,1),this.i.Ob(this.i.za(z),n,1);z=this.i.qc(this.i.za(z))}while(z!=b)}for(c=this.i.rf;-1!=c;c=this.i.og(c))r=this.i.Hg(c,u),1!=r&&(r=this.i.Nd(c),this.Gf(r)&&(-1==g&&(g=f.Yf(p,-1)),b=this.i.Zm(c),-1!=b&&(b=this.i.Uj(b),r=this.hn(b,d),f.Kj(g,r))));this.i.xq(u);this.i.ni(n);a.lo.V(f,e,1,this.ot,null);d=[];d[0]=p;d[1]=k;d[2]=
e;return d};f.prototype.Ix=function(c,b){var d=-1;for(c=this.i.Zm(c);-1!=c;c=this.i.ft(c)){var a=this.i.Uj(c);-1==d&&(d=a);var f=this.i.Ha(b.ng(b.ld(a)));if(this.Gf(f)){d=a;break}}return d};f.prototype.MB=function(c,b){for(var d=this.i.Jk(b),f=this.i.Xf(b),e=0,k=0,p=this.i.Zm(d);-1!=p;p=this.i.ft(p)){var g=this.i.Uj(p),n=c.ld(g),u=this.i.Ha(c.ng(n)),z=c.U(g),r=c.Ra(g),n=c.cb(n);n==g&&(this.Wo=b);-1!=z&&this.i.jf(z)==f?(e++,this.Gf(u)&&(n==z&&(this.Wo=this.i.qc(b)),k++)):-1!=r&&this.i.jf(r)==f&&(e--,
this.Gf(u)&&(n==r&&(this.Wo=this.i.qc(b)),k--))}this.i.w(d,this.zI);this.i.w(f,this.AI);d=a.b.Cb(this.zI,this.AI);return(0!=k?k:e)*d};f.prototype.Fq=function(c){return this.i.Ah(c)|this.i.Ff(c)|this.i.Ff(this.i.za(c))};f.prototype.lL=function(c){for(var b=this.i.za(this.i.Te(c)),d=-1;b!=c;){if(this.Gf(this.Fq(b))){if(-1!=d)return-1;d=b}b=this.i.za(this.i.Te(b))}return-1!=d?this.i.za(d):-1};f.prototype.mL=function(c){for(var b=this.i.za(this.i.qc(c)),d=-1;b!=c;){if(this.Gf(this.Fq(b))){if(-1!=d)return-1;
d=b}b=this.i.za(this.i.qc(b))}return-1!=d?this.i.za(d):-1};f.prototype.bK=function(c,b,d,f,e){var h=this.i.a,l=c,k=this.i.za(l);this.i.Ob(l,d,1);this.i.Ob(k,d,1);var p=this.MB(h,l);this.Wo=-1;for(var g=l,n=-1,u=!1,z=1;;){var r=this.i.Te(l);if(r==k)break;k=this.i.qc(k);if(this.i.za(r)!=k)if(l=this.lL(l),-1==l)break;else u=!0,k=this.i.za(l);else l=r;if(l==c){n=c;break}r=this.Fq(l);if(!this.Gf(r))break;this.i.Ob(l,d,1);this.i.Ob(k,d,1);g=l;p+=this.MB(h,l);z++}if(-1==n)for(l=c,k=this.i.za(l),n=l;;){c=
this.i.qc(l);if(c==k)break;k=this.i.Te(k);if(this.i.za(c)!=k)if(l=this.mL(l),-1==l){u=!0;break}else k=this.i.za(l);else l=c;r=this.Fq(l);if(!this.Gf(r))break;this.i.Ob(l,d,1);this.i.Ob(k,d,1);n=l;p+=this.MB(h,l);z++}else if(-1!=this.Wo&&(g=this.Wo,n=this.i.Te(this.Wo),this.i.za(n)!=this.i.qc(this.i.za(g))&&(n=this.lL(g),-1==n)))throw a.f.ya();0<=p||(l=n,n=this.i.za(g),g=this.i.za(l));d=h.Yf(b,-1);l=g;g=this.i.Jk(g);u=this.i.Xf(n)==g&&u;p=this.Ix(g,h);p=this.hn(p,e);h.Kj(d,p);-1!=f&&this.i.eo(g,f,
1);g=0;for(z=u?a.J.truncate((z+1)/2):-1;;){c=this.i.Xf(l);p=this.Ix(c,h);p=this.hn(p,e);h.Kj(d,p);g++;-1!=f&&this.i.eo(c,f,1);u&&g==z&&(d=h.Yf(b,-1),h.Kj(d,p));if(l==n)break;c=this.i.qc(l);if(this.i.Te(this.i.za(l))!=this.i.za(c)){if(l=this.mL(l),-1==l)throw a.f.ya();}else l=c}};f.prototype.es=function(c){for(var b=this.i.a.bh(1607),d=this.i.xh(),a=this.i.rf;-1!=a;a=this.i.og(a)){var f=this.i.kf(a),e=f;do 1!=this.i.Kb(e,d)&&this.Gf(this.Fq(e))&&this.bK(e,b,d,-1,c),e=this.i.qc(this.i.za(e));while(e!=
f)}this.i.ni(d);return b};f.prototype.UY=function(c){for(var b=this.i.a,d=b.bh(1607),a=b.bh(550),f=this.i.xh(),e=this.i.wq(),k=-1,p=this.i.rf;-1!=p;p=this.i.og(p)){var g=this.i.kf(p),n=g;do{var u=this.i.Kb(n,f);1!=u&&(u=this.Fq(n),this.Gf(u)&&this.bK(n,d,f,e,c));n=this.i.qc(this.i.za(n))}while(n!=g)}for(p=this.i.rf;-1!=p;p=this.i.og(p))u=this.i.Hg(p,e),1!=u&&(u=this.i.Nd(p),this.Gf(u)&&(-1==k&&(k=b.Yf(a,-1)),g=this.i.Zm(p),-1!=g&&(g=this.i.Uj(g),g=this.hn(g,c),b.Kj(k,g))));this.i.ni(f);this.i.xq(e);
c=[];c[0]=a;c[1]=d;return c};f.prototype.Qp=function(){for(var c=this.i.a,b=c.bh(550),d=c.Yf(b,-1),a=this.i.rf;-1!=a;a=this.i.og(a))if(this.Gf(this.i.Nd(a))){for(var f=-1,e=this.i.Zm(a);-1!=e;e=this.i.ft(e)){var k=this.i.Uj(e);-1==f&&(f=k);var p=this.i.Ha(c.ng(c.ld(k)));if(this.Gf(p)){f=k;break}}c.Kj(d,f)}return b};f.prototype.Do=function(c){this.Mh=[];for(var b=0;b<c;b++)this.Mh[b]=!1};f.uD=function(c,b,d,f){var h=c.Ja(),e=Array(1E3);a.J.Mv(e,null);var k=a.J.gf(1E3,0),p=c.D(),g=!0,n=2==b.tb();if(1!=
b.tb()&&2!=b.tb())throw a.f.ya();for(var u=0;u<p;){var z=a.J.truncate(c.dX(e,u)-u);n?a.gd.eL(b,e,z,d,k):a.gd.fL(b,e,z,d,k);for(var r=0,t=0;t<z;t++){var A=0==k[t];f||(A=!A);A&&(g&&(g=!1,h.Jd(c,0,u)),r!=t&&h.Jd(c,u+r,u+t),r=t+1)}g||r==z||h.Jd(c,u+r,u+z);u+=z}return g?c:h};f.LH=function(c,b,d){return c instanceof a.Ed?f.uD(c,b,d,!0):b instanceof a.Wa?c.u()||b.u()?c.Ja():a.rk.xJ(d,c,b)?a.rk.EQ(c,b):c.Ja():f.wD(c,b,d,!0)};f.mw=function(c,b,d,h){var e=new a.h;c.s(e);var k=new a.h;b.s(k);var p=new a.h;p.I(e);
p.Nb(k);d=a.ma.be(d,p,!0);p=new a.h;p.I(k);k=a.ma.Bs(d);p.O(k,k);if(!e.Yb(p)){if(c.tb()<=b.tb())return f.bd(f.Bb(c.Ja()),c,"\x26");if(c.tb()>b.tb())return f.bd(f.Bb(b.Ja()),c,"\x26")}k=new f;e=new a.fd;p=e.Jb(f.Bb(c));b=e.Jb(f.Bb(b));k.Wr(e,d,h);h=k.mw(p,b);c=f.bd(e.Se(h),c,"\x26");a.T.Ic(c.G())&&(c.Zg(2,d),1736==c.G()&&c.Al());return c};f.wD=function(c,b,d,f){if(c.u())return c.Ja();if(b.u())return f?c.Ja():null;var h=[null],e=[0],k=2==b.tb();if(1!=b.tb()&&2!=b.tb())throw a.f.ya();h[0]=c.w();k?a.gd.eL(b,
h,1,d,e):a.gd.fL(b,h,1,d,e);b=0==e[0];f||(b=!b);return b?c.Ja():c};f.SZ=function(c,b,d){return c instanceof a.Ed?f.uD(c,b,d,!1):b instanceof a.Wa?c.u()?c.Ja():b.u()?c:a.rk.xJ(d,c,b)?c.Ja():c:f.wD(c,b,d,!1)};f.prototype.CJ=function(c,b,d,f,e){if(c.u())return c;var h=new a.fd;c=h.Jb(c);return this.ol(h,c,b,d,f,e)};f.prototype.yW=function(c,b,d,f,e,k){if(e&&550!=c.hc(b)){var h=new a.VD;h.LY(c,d);h.ih?(a.rk.V(c,d,k,!0),e=!1):this.i.dz(d)}else a.rk.V(c,d,k,!0),e=!1;f&&550!=c.hc(b)?this.i.mK(c,b):this.i.lK(c,
b);if(this.i.WA)return this.i.qh(),this.i=null,this.ol(c,b,d,f,!1,k);this.i.dz(NaN);k=this.i.Ha(b);this.Do(k+1);this.Mh[k]=!0;if(1736==c.hc(b)||f&&550!=c.hc(b))return c.Hp(b,0),b=this.ds(b,-1,-1),c=c.Se(b),c.Hp(0),e?c.Zg(1,0):(c.Zg(2,d),c.Al()),c;if(1607==c.hc(b))return b=this.es(-1),c=c.Se(b),e||c.Zg(2,d),c;if(550==c.hc(b))return b=this.Qp(),c=c.Se(b),e||c.Zg(2,d),c;throw a.f.ya();};f.prototype.ol=function(c,b,d,f,e,k){this.i=new a.Pu;try{return this.yW(c,b,d,f,e,k)}finally{this.i.qh()}};f.ol=function(c,
b,d,a,e){return(new f).CJ(c,b,d,a,e)};f.prototype.xW=function(c,b,d){this.ot=c;this.i=new a.Pu;c=b.xo(d);var f=b.hc(d);1!=c||550==f?this.i.lK(b,d):this.i.mK(b,d);if(!this.i.WA)if(this.i.dz(NaN),f=this.i.Ha(d),this.Do(f+1),this.Mh[f]=!0,1736==b.hc(d)||1==c&&550!=b.hc(d))b.Hp(d,0),c=this.ds(d,-1,-1),b.DC(c,d),b.$B(c);else if(1607==b.hc(d))c=this.es(-1),b.DC(c,d),b.$B(c);else if(550==b.hc(d))c=this.Qp(),b.DC(c,d),b.$B(c);else throw a.f.X("internal error");};f.CC=function(c,b,d,a){var h=new f;h.ot=!0;
return h.CJ(c,b,!1,d,a)};f.prototype.Wm=function(c,b){var d=a.T.lf(this.i.a.hc(c)),f=a.T.lf(this.i.a.hc(b));if(d>f)return c;var e=this.i.Ha(c),k=this.i.Ha(b);this.Do((e|k)+1);this.Mh[this.i.Ha(c)]=!0;if(2==d&&2==f)return this.ds(c,b,-1);if(1==d&&2==f||1==d&&1==f)return this.es(-1);if(0==d)return this.Qp();throw a.f.ya();};f.prototype.lG=function(c,b){var d=a.T.lf(this.i.a.hc(c)),f=a.T.lf(this.i.a.hc(b));if(d>f)return c;if(d<f)return b;var e=this.i.Ha(c),k=this.i.Ha(b);this.Do((e|k)+1);this.Mh[this.i.Ha(c)]=
!0;this.Mh[this.i.Ha(b)]=!0;this.Mh[this.i.Ha(c)|this.i.Ha(b)]=!0;if(2==d&&2==f)return this.ds(c,b,-1);if(1==d&&1==f)return this.es(-1);if(0==d&&0==f)return this.Qp();throw a.f.ya();};f.prototype.mw=function(c,b){var d=a.T.lf(this.i.a.hc(c)),f=a.T.lf(this.i.a.hc(b)),e=this.i.Ha(c),k=this.i.Ha(b);this.Do((e|k)+1);this.Mh[this.i.Ha(c)|this.i.Ha(b)]=!0;e=-1;1<this.i.a.Gr.Ea&&(e=c);if(2==d&&2==f)return this.ds(c,b,e);if(1==d&&0<f||1==f&&0<d)return this.es(e);if(0==d||0==f)return this.Qp();throw a.f.ya();
};f.prototype.uA=function(c,b){var d=a.T.lf(this.i.a.hc(c)),f=a.T.lf(this.i.a.hc(b)),e=this.i.Ha(c),k=this.i.Ha(b);this.Do((e|k)+1);this.Mh[this.i.Ha(c)|this.i.Ha(b)]=!0;e=-1;1<this.i.a.Gr.Ea&&(e=c);if(2==d&&2==f)return this.TY(c,b,e);if(1==d&&0<f||1==f&&0<d)return this.UY(e);if(0==d||0==f)return d=[],d[0]=this.Qp(),d;throw a.f.ya();};f.prototype.Pp=function(c,b){var d=a.T.lf(this.i.a.hc(c)),f=a.T.lf(this.i.a.hc(b)),e=this.i.Ha(c),k=this.i.Ha(b);this.Do((e|k)+1);this.Mh[this.i.Ha(c)]=!0;this.Mh[this.i.Ha(b)]=
!0;if(2==d&&2==f)return this.ds(c,b,-1);if(1==d&&1==f)return this.es(-1);if(0==d&&0==f)return this.Qp();throw a.f.ya();};f.Bb=function(c){var b=c.G();return 197==b?(b=new a.Ia(c.description),c.u()||b.jd(c,!1),b):33==b?(b=new a.Ed(c.description),c.u()||b.add(c),b):322==b?(b=new a.Ua(c.description),c.u()||b.dc(c,!0),b):c};f.bd=function(c,b,d){var f=c.G();return 197==f?(b=new a.Ia(c.description),c.u()||b.jd(c,!1),b):33!=f||"|"!=d&&"^"!=d?322==f?(b=new a.Ua(c.description),c.u()||b.dc(c,!0),b):33==f&&
"-"==d&&33==b.G()||550==f&&"\x26"==d&&33==b.G()?(b=new a.Wa(c.description),c.u()||c.Ae(0,b),b):c:(b=new a.Ed(c.description),c.u()||b.add(c),b)};f.Wm=function(c,b,d,h){if(c.u()||b.u()||c.tb()>b.tb())return f.bd(f.Bb(c),c,"-");var e=new a.h;c.s(e);var k=new a.h;b.s(k);if(!e.Yb(k))return f.bd(f.Bb(c),c,"-");var p=new a.h;p.I(e);p.Nb(k);d=a.ma.be(d,p,!0);k=new f;e=new a.fd;p=e.Jb(f.Bb(c));b=e.Jb(f.Bb(b));k.Wr(e,d,h);h=k.Wm(p,b);h=e.Se(h);c=f.bd(h,c,"-");a.T.Ic(c.G())&&(c.Zg(2,d),1736==c.G()&&c.Al());
return c};f.lG=function(c,b,d,h){if(c.tb()>b.tb())return f.bd(f.Bb(c),c,"|");if(c.tb()<b.tb()||c.u())return f.bd(f.Bb(b),c,"|");if(b.u())return f.bd(f.Bb(c),c,"|");var e=new a.h;c.s(e);var k=new a.h;b.s(k);var p=new a.h;p.I(e);p.Nb(k);d=a.ma.be(d,p,!0);if(!e.Yb(k.mT(d,d)))switch(c=f.Bb(c),b=f.Bb(b),c.G()){case 550:return c=a.T.ne(c),c.Jd(b,0,-1),c;case 1607:return c=a.T.ne(c),c.add(b,!1),c;case 1736:return c=a.T.ne(c),c.add(b,!1),c;default:throw a.f.ya();}k=new f;e=new a.fd;p=e.Jb(f.Bb(c));b=e.Jb(f.Bb(b));
k.Wr(e,d,h);b=k.lG(p,b);c=f.bd(e.Se(b),c,"|");a.T.Ic(c.G())&&(c.Zg(2,d),1736==c.G()&&c.Al());return c};f.QR=function(c,b,d){if(2>c.length)throw a.f.F("not enough geometries to dissolve");for(var h=0,e=0,k=c.length;e<k;e++)h=Math.max(c[e].tb(),h);var p=new a.h;p.Oa();for(var g=new a.fd,n=-1,u=0,z=-1,e=0,k=c.length;e<k;e++)if(c[e].tb()==h)if(c[e].u())-1==z&&(z=e);else{z=e;-1==n?n=g.Jb(f.Bb(c[e])):g.vP(n,f.Bb(c[e]));var r=new a.h;c[e].ac(r);p.Nb(r);u++}if(2>u)return f.Bb(c[z]);c=2==h;b=a.ma.be(0==h?
b:null,p,!0);return(new f).ol(g,n,b,c,!0,d)};f.uA=function(c,b,d,h){var e=[null,null,null],k=new a.h;c.s(k);var p=new a.h;b.s(p);var g=new a.h;g.I(k);g.Nb(p);d=a.ma.be(d,g,!0);g=new a.h;g.I(p);p=a.ma.Bs(d);g.O(p,p);if(!k.Yb(g)){if(c.tb()<=b.tb())return c=f.bd(f.Bb(c.Ja()),c,"\x26"),e[c.tb()]=c,e;if(c.tb()>b.tb())return c=f.bd(f.Bb(b.Ja()),c,"\x26"),e[c.tb()]=c,e}p=new f;k=new a.fd;g=k.Jb(f.Bb(c));b=k.Jb(f.Bb(b));p.Wr(k,d,h);h=p.uA(g,b);for(b=0;b<h.length;b++)p=f.bd(k.Se(h[b]),c,"\x26"),a.T.Ic(p.G())&&
(p.Zg(2,d),1736==p.G()&&p.Al()),e[p.tb()]=p;return e};f.Pp=function(c,b,d,h){if(c.tb()>b.tb())return f.bd(f.Bb(c),c,"^");if(c.tb()<b.tb()||c.u())return f.bd(f.Bb(b),c,"^");if(b.u())return f.bd(f.Bb(c),c,"^");var e=new a.h;c.s(e);var k=new a.h;b.s(k);var p=new a.h;p.I(e);p.Nb(k);d=a.ma.be(d,p,!0);k=new f;e=new a.fd;p=e.Jb(f.Bb(c));b=e.Jb(f.Bb(b));k.Wr(e,d,h);h=k.Pp(p,b);c=f.bd(e.Se(h),c,"^");a.T.Ic(c.G())&&(c.Zg(2,d),1736==c.G()&&c.Al());return c};f.M_=function(c,b,d){b=b.G();d=d.G();return 550==c.G()&&
(33==b||33==d)&&1>=c.D()?(d=new a.Wa(c.description),c.u()||c.Ae(0,d),d):c};f.prototype.zS=function(c,b){var d=this.i.a;c=d.Yf(c,-1);for(var a=b.size,f=0;f<a;f++){var e=b.get(f);d.Kj(c,e)}d.ao(c,!0)};f.prototype.VX=function(c,b){for(var d=this.i.a,a=d.rd;-1!=a;a=d.Ue(a))if(a==b)for(var f=d.Pb(a);-1!=f;f=d.Sb(f)){var e=d.cb(f);if(-1!=e)for(var k=d.U(e);-1!=k;){var e=this.i.jf(e),p=this.i.jf(k),e=this.i.jT(e,p);-1!=e&&(p=this.i.za(e),this.i.Ob(e,c,1),this.i.Ob(p,c,2));e=k;k=d.U(e)}}};f.prototype.SW=
function(c,b,d,f){d=this.i.Ha(d);f=this.i.Ha(f);var h=new a.ia(0);h.yb(256);for(var e=this.i.a,k=this.i.xh(),p=this.i.rf;-1!=p;p=this.i.og(p)){var g=this.i.kf(p);if(-1!=g){var n=g;do{if(1!=this.i.Kb(n,k)){var u=n,z=n,r=!1,t=0;do{this.i.Ob(u,k,1);if(!r){var A=this.i.Ah(u);0!=(A&f)&&0!=(this.i.Ff(u)&d)&&(z=u,r=!0)}r&&(h.add(this.i.Uj(this.i.Zm(this.i.Jk(u)))),-1!=c&&(A=this.i.Ah(u),0!=(A&f)&&(A=this.i.Kb(u,c),t|=A)));u=this.i.qc(u)}while(u!=z);r&&0<this.i.Dq(this.i.Ef(z))&&(u=e.bh(1736),this.zS(u,h),
-1!=b&&e.wK(u,b,t));h.clear(!1)}n=this.i.qc(this.i.za(n))}while(n!=g)}}this.i.ni(k)};f.prototype.yR=function(c,b,d,a){this.i.uX();var f=-1;-1!=c&&(f=this.i.xh(),this.VX(f,d));this.SW(f,c,b,d);var h=this.i.a;c=0;for(f=h.rd;-1!=f;f=h.Ue(f))f!=b&&f!=d&&(a.add(f),c++);a.Gd(0,c,function(b,c){b=h.fA(h.Pb(b));c=h.fA(h.Pb(c));return b<c?-1:b==c?0:1})};f.prototype.qh=function(){null!=this.i&&(this.i.qh(),this.i=null)};return f}();a.Dg=f})(C||(C={}));(function(a){var f=function(){function f(c){void 0!==c?this.Op(c):
this.oC()}f.prototype.Ux=function(){this.bc=this.Wb=this.zb=this.sb=this.gb=this.lb=0};f.prototype.Eb=function(c){return this==c?!0:c instanceof f?this.lb==c.lb&&this.sb==c.sb&&this.Wb==c.Wb&&this.zb==c.zb&&this.gb==c.gb&&this.bc==c.bc:!1};f.prototype.jc=function(){a.J.Zi();a.J.Zi();a.J.Zi();a.J.Zi();a.J.Zi();return a.J.Zi()};f.prototype.$h=function(c,b){var d=this.zb*c.x+this.gb*c.y+this.bc;b.x=this.lb*c.x+this.sb*c.y+this.Wb;b.y=d};f.prototype.WY=function(c,b,d,a,f){var h=2*b;a*=2;for(b=2*(b+f);h<
b;h+=2,a+=2){f=c[h];var e=c[h+1];d[a]=this.lb*f+this.sb*e+this.Wb;d[a+1]=this.zb*f+this.gb*e+this.bc}};f.prototype.YY=function(c,b,d){for(var f=0;f<b;f++){var e=c[f].x,k=c[f].y,p=this.lb*e+this.sb*k+this.Wb,e=this.zb*e+this.gb*k+this.bc;null!=d[f]?d[f].ka(p,e):d[f]=a.b.pa(p,e)}};f.prototype.multiply=function(c){f.multiply(this,c,this)};f.multiply=function(c,b,d){var a,f,e,k,p;a=c.lb*b.lb+c.zb*b.sb;f=c.sb*b.lb+c.gb*b.sb;e=c.Wb*b.lb+c.bc*b.sb+b.Wb;k=c.lb*b.zb+c.zb*b.gb;p=c.sb*b.zb+c.gb*b.gb;c=c.Wb*
b.zb+c.bc*b.gb+b.bc;d.lb=a;d.sb=f;d.Wb=e;d.zb=k;d.gb=p;d.bc=c};f.prototype.Vf=function(){var c=new f;c.lb=this.lb;c.sb=this.sb;c.Wb=this.Wb;c.zb=this.zb;c.gb=this.gb;c.bc=this.bc;return c};f.prototype.JC=function(c){if(!c.u()){for(var b=[],d=0;4>d;d++)b[d]=new a.b;c.OB(b);this.ZY(b,b);c.Lx(b,4)}};f.prototype.ZY=function(c,b){for(var d=0;d<c.length;d++){var f=new a.b,e=c[d];f.x=this.lb*e.x+this.sb*e.y+this.Wb;f.y=this.zb*e.x+this.gb*e.y+this.bc;b[d]=f}};f.prototype.jU=function(c,b){c.u()||b.u()||0==
c.N()||0==c.fa()?this.Ux():(this.sb=this.zb=0,this.lb=b.N()/c.N(),this.gb=b.fa()/c.fa(),this.Wb=b.o-c.o*this.lb,this.bc=b.A-c.A*this.gb)};f.prototype.XY=function(c){var b=new a.b,d=new a.b;b.ka(this.lb,this.zb);d.ka(this.sb,this.gb);b.sub(b);var f=.5*b.pk();b.ka(this.lb,this.zb);d.ka(this.sb,this.gb);b.add(d);b=.5*b.pk();return c*(f>b?Math.sqrt(f):Math.sqrt(b))};f.prototype.oC=function(){this.lb=1;this.zb=this.Wb=this.sb=0;this.gb=1;this.bc=0};f.prototype.Ho=function(c){if(void 0!==c){var b=a.b.pa(0,
1);this.$h(b,b);b.sub(a.b.pa(0,1));if(b.pk()>c*c)return!1;b.ka(0,0);this.$h(b,b);if(b.pk()>c*c)return!1;b.ka(1,0);this.$h(b,b);b.sub(a.b.pa(1,0));return b.pk()<=c*c}return 1==this.lb&&1==this.gb&&0==this.sb&&0==this.Wb&&0==this.zb&&0==this.bc};f.prototype.fh=function(c){return Math.abs(this.lb*this.gb-this.zb*this.sb)<=2*c*(Math.abs(this.lb*this.gb)+Math.abs(this.zb*this.sb))};f.prototype.Ag=function(c,b){this.lb=1;this.sb=0;this.Wb=c;this.zb=0;this.gb=1;this.bc=b};f.prototype.Op=function(c,b){void 0!==
b?(this.lb=c,this.zb=this.Wb=this.sb=0,this.gb=b,this.bc=0):this.Op(c,c)};f.prototype.wC=function(){this.lb=0;this.sb=1;this.Wb=0;this.zb=1;this.bc=this.gb=0};f.prototype.iY=function(c){this.jY(Math.cos(c),Math.sin(c))};f.prototype.jY=function(c,b){this.lb=c;this.sb=-b;this.Wb=0;this.zb=b;this.gb=c;this.bc=0};f.prototype.shift=function(c,b){this.Wb+=c;this.bc+=b};f.prototype.scale=function(c,b){this.lb*=c;this.sb*=c;this.Wb*=c;this.zb*=b;this.gb*=b;this.bc*=b};f.prototype.rotate=function(c){var b=
new f;b.iY(c);this.multiply(b)};f.prototype.inverse=function(c){if(void 0!==c){var b=this.lb*this.gb-this.sb*this.zb;0==b?c.Ux():(b=1/b,c.Wb=(this.sb*this.bc-this.Wb*this.gb)*b,c.bc=(this.Wb*this.zb-this.lb*this.bc)*b,c.lb=this.gb*b,c.sb=-this.sb*b,c.zb=-this.zb*b,c.gb=this.lb*b)}else this.inverse(this)};return f}();a.Hd=f})(C||(C={}));(function(a){var f=function(){function f(){}f.prototype.Ux=function(){this.bi=this.bc=this.Wb=this.Df=this.Af=this.zf=this.Cf=this.gb=this.sb=this.Sf=this.zb=this.lb=
0};f.prototype.Op=function(c,b,d){this.lb=c;this.sb=this.Sf=this.zb=0;this.gb=b;this.Af=this.zf=this.Cf=0;this.Df=d;this.bi=this.bc=this.Wb=0};f.prototype.JC=function(c){if(c.u())return c;for(var b=new a.qd[8],d=0;8>d;d++)b[d]=new a.qd;c.OB(b);this.transform(b,8,b);c.Lx(b);return c};f.prototype.transform=function(c,b,d){for(var f=0;f<b;f++){var e=new a.qd,k=c[f];e.x=this.lb*k.x+this.sb*k.y+this.zf*k.z+this.Wb;e.y=this.zb*k.x+this.gb*k.y+this.Af*k.z+this.bc;e.z=this.Sf*k.x+this.Cf*k.y+this.Df*k.z+
this.bi;d[f]=e}};f.prototype.Rp=function(c){var b=new a.qd;b.x=this.lb*c.x+this.sb*c.y+this.zf*c.z+this.Wb;b.y=this.zb*c.x+this.gb*c.y+this.Af*c.z+this.bc;b.z=this.Sf*c.x+this.Cf*c.y+this.Df*c.z+this.bi;return b};f.prototype.Vg=function(c){f.multiply(this,c,this)};f.multiply=function(c,b,d){var a,f,e,k,p,g,n,u,z,r,t;a=c.lb*b.lb+c.zb*b.sb+c.Sf*b.zf;f=c.lb*b.zb+c.zb*b.gb+c.Sf*b.Af;e=c.lb*b.Sf+c.zb*b.Cf+c.Sf*b.Df;k=c.sb*b.lb+c.gb*b.sb+c.Cf*b.zf;p=c.sb*b.zb+c.gb*b.gb+c.Cf*b.Af;g=c.sb*b.Sf+c.gb*b.Cf+c.Cf*
b.Df;n=c.zf*b.lb+c.Af*b.sb+c.Df*b.zf;u=c.zf*b.zb+c.Af*b.gb+c.Df*b.Af;z=c.zf*b.Sf+c.Af*b.Cf+c.Df*b.Df;r=c.Wb*b.lb+c.bc*b.sb+c.bi*b.zf+b.Wb;t=c.Wb*b.zb+c.bc*b.gb+c.bi*b.Af+b.bc;c=c.Wb*b.Sf+c.bc*b.Cf+c.bi*b.Df+b.bi;d.lb=a;d.zb=f;d.Sf=e;d.sb=k;d.gb=p;d.Cf=g;d.zf=n;d.Af=u;d.Df=z;d.Wb=r;d.bc=t;d.bi=c};f.inverse=function(c,b){var d=c.lb*(c.gb*c.Df-c.Cf*c.Af)-c.zb*(c.sb*c.Df-c.Cf*c.zf)+c.Sf*(c.sb*c.Af-c.gb*c.zf);if(0!=d){var f,e,k,p,g,n,u,z,r,t;z=1/d;d=(c.gb*c.Df-c.Cf*c.Af)*z;k=-(c.sb*c.Df-c.Cf*c.zf)*z;n=
(c.sb*c.Af-c.gb*c.zf)*z;f=-(c.zb*c.Df-c.Af*c.Sf)*z;p=(c.lb*c.Df-c.Sf*c.zf)*z;u=-(c.lb*c.Af-c.zb*c.zf)*z;e=(c.zb*c.Cf-c.Sf*c.gb)*z;g=-(c.lb*c.Cf-c.Sf*c.sb)*z;z*=c.lb*c.gb-c.zb*c.sb;r=-(c.Wb*d+c.bc*k+c.bi*n);t=-(c.Wb*f+c.bc*p+c.bi*u);c=-(c.Wb*e+c.bc*g+c.bi*z);b.lb=d;b.zb=f;b.Sf=e;b.sb=k;b.gb=p;b.Cf=g;b.zf=n;b.Af=u;b.Df=z;b.Wb=r;b.bc=t;b.bi=c}else throw a.f.X("math singularity");};f.prototype.Vf=function(){var c=new f;c.lb=this.lb;c.zb=this.zb;c.Sf=this.Sf;c.sb=this.sb;c.gb=this.gb;c.Cf=this.Cf;c.zf=
this.zf;c.Af=this.Af;c.Df=this.Df;c.Wb=this.Wb;c.bc=this.bc;c.bi=this.bi;return c};return f}();a.dO=f})(C||(C={}));(function(a){var f=function(c){function b(b){if(void 0!==b)c.call(this,b.jc(),b);else{c.call(this);this.wg=[];this.wg[0]=0;this.Ea=1;this.Sh=[];for(b=0;10>b;b++)this.Sh[b]=-1;this.Sh[this.wg[0]]=0}this.Yq=!0}N(b,c);b.prototype.Ud=function(b){this.hasAttribute(b)||(this.Sh[b]=0,this.BE())};b.prototype.removeAttribute=function(b){if(0==b)throw a.f.F("Position attribue cannot be removed");
this.hasAttribute(b)&&(this.Sh[b]=-1,this.BE())};b.prototype.reset=function(){this.wg[0]=0;this.Ea=1;for(var b=0;b<this.Sh.length;b++)this.Sh[b]=-1;this.Sh[this.wg[0]]=0;this.Yq=!0};b.prototype.Nz=function(){return e.zo().add(this)};b.Ig=function(){return e.zo().ST()};b.eq=function(){return e.zo().TT()};b.prototype.IO=function(){var b=this.jc();return new a.na(b,this)};b.prototype.BE=function(){for(var b=this.Ea=0,c=0;10>b;b++)0<=this.Sh[b]&&(this.wg[c]=b,this.Sh[b]=c,c++,this.Ea++);this.Yq=!0};b.prototype.jc=
function(){this.Yq&&(this.bm=this.zk(),this.Yq=!1);return this.bm};b.prototype.Eb=function(c){if(null==c)return!1;if(c==this)return!0;if(!(c instanceof b)||c.Ea!=this.Ea)return!1;for(var d=0;d<this.Ea;d++)if(this.wg[d]!=c.wg[d])return!1;return this.Yq!=c.Yq?!1:!0};b.prototype.RH=function(b){if(b.Ea!=this.Ea)return!1;for(var c=0;c<this.Ea;c++)if(this.wg[c]!=b.wg[c])return!1;return!0};b.ux=function(b,c){for(var d=[],a=0;a<b.Ea;a++)d[a]=-1;for(var a=0,f=b.Ea;a<f;a++)d[a]=c.mg(b.zd(a));return d};b.tT=
function(c,a){c=new b(c);c.Ud(a);return c.Nz()};b.uT=function(c,a){for(var d=null,f=0;10>f;f++)!c.hasAttribute(f)&&a.hasAttribute(f)&&(null==d&&(d=new b(c)),d.Ud(f));return null!=d?d.Nz():c};b.rs=function(c,a){c=new b(c);c.removeAttribute(a);return c.Nz()};return b}(a.na);a.ye=f;var e=function(){function c(){this.map=[];var b=new f;this.add(b);b=new f;b.Ud(1);this.add(b)}c.zo=function(){return c.hV};c.prototype.ST=function(){return c.aq};c.prototype.TT=function(){return c.bq};c.prototype.add=function(b){var d=
b.jc();if(null!=c.aq&&c.aq.jc()==d&&b.RH(c.aq))return c.aq;if(null!=c.bq&&c.bq.jc()==d&&b.RH(c.bq))return c.bq;var a=null;void 0!==this.map[d]&&(a=this.map[d]);null==a&&(a=b.IO(),1==a.Ea?c.aq=a:2==a.Ea&&1==a.zd(1)?c.bq=a:this.map[d]=a);return a};c.hV=new c;return c}()})(C||(C={}));var S=0==y.version.indexOf("4."),U;(function(a){a[a.Linear=0]="Linear";a[a.Angular=1]="Angular";a[a.Area=2]="Area";a[a.LinearOrAngular=3]="LinearOrAngular"})(U||(U={}));var X={feet:9002,kilometers:9036,meters:9001,miles:9035,
"nautical-miles":9030,yards:9096},W={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109413,"square-yards":109442},V={degrees:9102,radians:9101};void 0===x.prototype.getCacheValue&&A.extend(x,{cache:null,getCacheValue:function(a){if(null===this.cache||void 0===this.cache)this.cache={};return this.cache[a]},setCacheValue:function(a,e){if(null===this.cache||void 0===this.cache)this.cache={};this.cache[a]=e}});var Y=C.Td.create(4326),
Z=C.Td.create(102100);B=function(){function f(){}f.extendedSpatialReferenceInfo=function(a){if(null===a)return null;a=M(a);var f=a.Od();return{tolerance:a.Bo(),unitType:null==f?-1:f.nd,unitID:null==f?-1:f.yc(),unitBaseFactor:null==f?0:f.Ai,unitSquareDerivative:null==f?0:C.oc.kH(f).yc()}};f.clip=function(a,f){if(null===a)return null;f=C.cc.clip(I(a),I(f),L(a));return u(f,a.spatialReference)};f.cut=function(a,f){f=I(f);f=C.cc.Hl(I(a),f,L(a));for(var c=[],b=0;b<f.length;b++)c.push(u(f[b],a.spatialReference));
return c};f.contains=function(a,f){if(null===a||null===f)throw Error("Illegal Argument Exception");return C.cc.contains(I(a),I(f),L(a))};f.crosses=function(a,f){if(null===a||null===f)throw Error("Illegal Argument Exception");return C.cc.xR(I(a),I(f),L(a))};f.distance=function(a,f,c){if(null===a||null===f)throw Error("Illegal Argument Exception");return C.cc.Cb(I(a),I(f),L(a),C.oc.ze(e(c,3)))};f.equals=function(a,f){return null===a&&null!==f||null===f&&null!==a?!1:C.cc.Eb(I(a),I(f),L(a))};f.intersects=
function(a,f){if(null===a||null===f)throw Error("Illegal Argument Exception");return C.cc.MU(I(a),I(f),L(a))};f.touches=function(a,f){if(null===a||null===f)throw Error("Illegal Argument Exception");return C.cc.touches(I(a),I(f),L(a))};f.within=function(a,f){if(null===a||null===f)throw Error("Illegal Argument Exception");return C.cc.qZ(I(a),I(f),L(a))};f.disjoint=function(a,f){if(null===a||null===f)throw Error("Illegal Argument Exception");return C.cc.PR(I(a),I(f),L(a))};f.overlaps=function(a,f){if(null===
a||null===f)throw Error("Illegal Argument Exception");return C.cc.nW(I(a),I(f),L(a))};f.relate=function(a,f,c){if(null===a||null===f)throw Error("Illegal Argument Exception");return C.cc.XB(I(a),I(f),L(a),c)};f.isSimple=function(a){if(null===a)throw Error("Illegal Argument Exception");return C.cc.XU(I(a),L(a))};f.simplify=function(a){if(null===a)throw Error("Illegal Argument Exception");var f=C.cc.BC(I(a),L(a));return u(f,a.spatialReference)};f.convexHull=function(a,e){void 0===e&&(e=!1);if(null===
a)throw Error("Illegal Argument Exception");return!1===P(a)?(e=C.cc.gR(I(a),L(a)),u(e,a.spatialReference)):f.jZ(a,e)};f.jZ=function(a,f){for(var c=[],b=0;b<a.length;b++)c.push(I(a[b]));c=C.cc.hR(c,f);for(b=0;b<c.length;b++)c[b]=u(c[b],a[0].spatialReference);return c};f.difference=function(a,e){if(null===a||null===e)throw Error("Illegal Argument Exception");return!1===P(a)?(e=C.cc.Wm(I(a),I(e),L(a)),u(e,a.spatialReference)):f.gM(a,e)};f.gM=function(a,f){for(var c=[],b=0;b<a.length;b++)c.push(I(a[b]));
c=C.cc.MR(c,I(f),L(f));for(b=0;b<c.length;b++)c[b]=u(c[b],f.spatialReference);return c};f.symmetricDifference=function(a,e){if(null===a||null===e)throw Error("Illegal Argument Exception");return!1===P(a)?(e=C.cc.Pp(I(a),I(e),L(a)),u(e,a.spatialReference)):f.JM(a,e)};f.JM=function(a,f){for(var c=[],b=0;b<a.length;b++)c.push(I(a[b]));c=C.cc.NY(c,I(f),L(f));for(b=0;b<c.length;b++)c[b]=u(c[b],f.spatialReference);return c};f.intersect=function(a,e){if(null===a||null===e)throw Error("Illegal Argument Exception");
return!1===P(a)?(e=C.cc.Ma(I(a),I(e),L(a)),u(e,a.spatialReference)):f.vM(a,e)};f.vM=function(a,f){for(var c=[],b=0;b<a.length;b++)c.push(I(a[b]));c=C.cc.KU(c,I(f),L(f));for(b=0;b<c.length;b++)c[b]=u(c[b],f.spatialReference);return c};f.union=function(a,f){void 0===f&&(f=null);if(null===a)return null;!1===P(a)&&(a=[a],null!==f&&a.push(f));if(0===a.length)return null;f=[];for(var c=0;c<a.length;c++)f.push(I(a[c]));return u(C.cc.fZ(f,L(a[0])),a[0].spatialReference)};f.offset=function(a,k,c,b,d,h){var l=
0;if(null!=b&&void 0!=b)switch(b){case "round":l=0;break;case "bevel":l=1;break;case "miter":l=2;break;case "square":l=3}return!1===P(a)?(k=C.cc.offset(I(a),L(a),k,l,d,h,C.oc.ze(e(c,3))),u(k,a.spatialReference)):f.FM(a,k,c,l,d,h)};f.FM=function(a,f,c,b,d,h){if(null===a)return null;if(0===a.length)return[];for(var k=[],p=0;p<a.length;p++)k.push(I(a[p]));f=C.cc.lW(k,L(a[0]),f,b,d,h,C.oc.ze(e(c,3)));for(p=0;p<f.length;p++)f[p]=u(f[p],a[0].spatialReference);return f};f.buffer=function(a,k,c,b){void 0===
b&&(b=!1);if(!1===P(a))return k=C.cc.buffer(I(a),L(a),k,C.oc.ze(e(c,3)),!1,0,NaN),u(k,a.spatialReference);if("[object Array]"!==Object.prototype.toString.call(k)){for(var d=[],h=0;h<a.length;h++)d.push(k);k=d}if(k.length!=a.length){if(0==k.length)throw Error("Illegal Argument Exception");for(var d=[],l=0,h=0;h<a.length;h++)void 0===k[h]?d.push(l):(d.push(k[h]),l=k[h]);k=d}return f.pD(a,k,c,!1,b,"geodesic",NaN)};f.geodesicBuffer=function(a,k,c,b,d,h){if(!1===P(a))return void 0===d&&(d=NaN),k=C.cc.buffer(I(a),
L(a),k,C.oc.ze(e(c,0)),!0,p(b),d),u(k,a.spatialReference);if("[object Array]"!==Object.prototype.toString.call(k)){for(var l=[],g=0;g<a.length;g++)l.push(k);k=l}if(k.length!=a.length){if(0==k.length)throw Error("Illegal Argument Exception");for(var l=[],n=0,g=0;g<a.length;g++)void 0===k[g]?l.push(n):(l.push(k[g]),n=k[g]);k=l}return f.pD(a,k,c,!0,b,d,h)};f.pD=function(a,f,c,b,d,h,k){if(null===a)return null;if(0===a.length)return[];void 0===k&&(k=NaN);for(var l=[],g=0;g<a.length;g++)l.push(I(a[g]));
f=C.cc.PP(l,L(a[0]),f,C.oc.ze(e(c,0)),b,d,p(h),k);for(g=0;g<f.length;g++)f[g]=u(f[g],a[0].spatialReference);return f};f.nearestCoordinate=function(a,f,c){void 0===c&&(c=!0);f=C.cc.Yz(I(a),I(f),c);return{coordinate:u(f.Mz(),a.spatialReference),distance:f.Pz(),isRightSide:f.yA(),vertexIndex:f.Za(),isEmpty:f.u()}};f.nearestVertex=function(a,f){f=C.cc.Zz(I(a),I(f));return{coordinate:u(f.Mz(),a.spatialReference),distance:f.Pz(),isRightSide:f.yA(),vertexIndex:f.Za(),isEmpty:f.u()}};f.nearestVertices=function(a,
f,c,b){f=I(f);c=C.cc.$z(I(a),f,c,b);b=[];for(f=0;f<c.length;f++)!1===c[f].u()&&b.push({coordinate:u(c[f].Mz(),a.spatialReference),distance:c[f].Pz(),isRightSide:c[f].yA(),vertexIndex:c[f].Za(),isEmpty:c[f].u()});return b};f.generalize=function(a,f,c,b){f=C.cc.FS(I(a),L(a),f,c,C.oc.ze(e(b,3)));return u(f,a.spatialReference)};f.densify=function(a,f,c){f=C.cc.Ks(I(a),L(a),f,C.oc.ze(e(c,3)));return u(f,a.spatialReference)};f.geodesicDensify=function(a,f,c,b){void 0===b&&(b=0);f=C.cc.Dz(I(a),L(a),f,C.oc.ze(e(c,
3)),b);return u(f,a.spatialReference)};f.rotate=function(f,e,c){if(void 0===c||null===c)void 0!==f.x?c=f:void 0!==f.xmin?(!1===f instanceof x&&(f=S?k(f):a(f)),c=S?f.get("center"):f.getCenter()):(!1===f instanceof x&&(f=S?k(f):a(f)),c=S?f.get("extent").get("center"):f.getExtent().getCenter());e=S?C.Wp.rotate(f.toJSON?f.toJSON():f,e,c.toJSON?c.toJSON():c):C.Wp.rotate(f.toJson?f.toJson():f,e,c.toJson?c.toJson():c);S?(e=k(e),e.set("spatialReference",f.spatialReference)):(e=a(e),e.setSpatialReference(f.spatialReference));
return e};f.flipHorizontal=function(f,e){if(void 0===e||null===e)void 0!==f.x?e=f:void 0!==f.xmin?(!1===f instanceof x&&(f=S?k(f):a(f)),e=S?f.get("center"):f.getCenter()):(!1===f instanceof x&&(f=S?k(f):a(f)),e=S?f.get("extent").get("center"):f.getExtent().getCenter());e=S?C.Wp.yG(f.toJSON?f.toJSON():f,e.toJSON?e.toJSON():e):C.Wp.yG(f.toJson?f.toJson():f,e.toJson?e.toJson():e);S?(e=k(e),e.set("spatialReference",f.spatialReference)):(e=a(e),e.setSpatialReference(f.spatialReference));return e};f.flipVertical=
function(f,e){if(void 0===e||null===e)void 0!==f.x?e=f:void 0!==f.xmin?(!1===f instanceof x&&(f=S?k(f):a(f)),e=S?f.get("center"):f.getCenter()):(!1===f instanceof x&&(f=S?k(f):a(f)),e=S?f.get("extent").get("center"):f.getExtent().getCenter());e=S?C.Wp.zG(f.toJSON?f.toJSON():f,e.toJSON?e.toJSON():e):C.Wp.zG(f.toJson?f.toJson():f,e.toJson?e.toJson():e);S?(e=k(e),e.set("spatialReference",f.spatialReference)):(e=a(e),e.setSpatialReference(f.spatialReference));return e};f.planarArea=function(a,f){if(null===
a)throw Error("Illegal Argument Exception");return C.cc.vW(I(a),L(a),C.oc.ze(e(f,2)))};f.planarLength=function(a,f){if(null===a)throw Error("Illegal Argument Exception");return C.cc.wW(I(a),L(a),C.oc.ze(e(f,3)))};f.geodesicArea=function(a,f,c){if(null===a)throw Error("Illegal Argument Exception");return C.cc.LS(I(a),L(a),C.oc.ze(e(f,2)),p(c))};f.geodesicLength=function(a,f,c){if(null===a)throw Error("Illegal Argument Exception");return C.cc.PS(I(a),L(a),C.oc.ze(e(f,0)),p(c))};f._enableProjection=
function(a){f.EE=!0;C.zN.bind(a)};f.Mg=function(a){return M(a).Ao()};f._getTransformation=function(a,f,c){void 0===c&&(c=null);var b=null,d=null;if(c){if(!c.spatialReference)throw C.f.F("AOI missing Spatial Reference");b=I(c);d=M(c.spatialReference).Ao()}a=C.Nu.PT(M(a).Ao(),M(f).Ao(),b,d);return null!==a?a:null};f._getTransformationBySuitability=function(a,f,c){void 0===c&&(c=null);var b=null,d=null;if(c){if(!c.spatialReference)throw C.f.F("AOI missing Spatial Reference");b=I(c);d=M(c.spatialReference).Ao()}return C.Nu.QT(M(a).Ao(),
M(f).Ao(),b,d)};f.bZ=function(a,e,c){var b=null;if(c){var d=c.getGTListEntry();if(null!==d){for(var b=new C.my(null),h=0,k=d.steps;h<k.length;h++){var d=k[h],p=new C.io(d.geogtran);d.isInverse&&p.jt();b.add(p)}b=C.qs.Hs(f.Mg(a),f.Mg(e),b);c.assignCachedGe(a,e,b);return b}}if(null===b&&c&&c.steps&&0<c.steps.length){b=new C.my(null);h=0;for(k=c.steps;h<k.length;h++)d=k[h],-1!=d.wkid&&null!==d.wkid&&void 0!==d.wkid?b.add(C.io.create(d.wkid,d.isInverse)):b.add(C.io.eG(d.wkt,d.isInverse));b=C.qs.Hs(f.Mg(a),
f.Mg(e),b);c.assignCachedGe(a,e,b);return b}return C.qs.Hs(f.Mg(a),f.Mg(e),b)};f._project=function(a,e,c,b,d){void 0===b&&(b=null);void 0===d&&(d=!1);if(!1===this.EE)throw Error("Projection Engine must be enabled using enableProjection");if(0===a.length)return[];if(b){var h=b.getCachedGeTransformation(e,c);h||(h=f.bZ(e,c,b));e=[];var k=0}else h=C.qs.Hs(f.Mg(e),f.Mg(c),null),e=[],k=0;for(;k<a.length;k++)b=a[k],e.push(f.lD(b,c,h,d));return e};f.lD=function(a,f,c,b){a=C.cc.Xg(I(a),c);return b?K(a):u(a,
f)};f.EE=!1;return f}();void 0===x.prototype.getCacheValue&&A.extend(x,{cache:null,getCacheValue:function(a){if(null===this.cache||void 0===this.cache)this.cache={};return this.cache[a]},setCacheValue:function(a,e){if(null===this.cache||void 0===this.cache)this.cache={};this.cache[a]=e}});return B})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(B,m,y,x,g,w,
t,r){B=B(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var g=y.map(this.geometries,function(a){return a.toJson()}),A={};return A.outSR=this.outSR.wkid||x.toJson(this.outSR.toJson()),A.inSR=this.geometries[0].spatialReference.wkid||x.toJson(this.geometries[0].spatialReference.toJson()),A.geometries=x.toJson({geometryType:r.getJsonType(this.geometries[0]),geometries:g}),this.transformation&&(A.transformation=
this.transformation.wkid||x.toJson(this.transformation)),t.isDefined(this.transformForward)&&(A.transformForward=this.transformForward),A}});return g("extend-esri")&&m.setObject("tasks.ProjectParameters",B,w),B})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang","jimu/shared/basePortalUrlUtils"],function(B,m){var y=B.clone(m);y.declaredClass="jimu.portalUrlUtils";y.getPortalUrlFromLocation=function(){return y.getPortalServerFromLocation()+y.getDeployContextFromLocation()};y.getPortalSignInUrlFromLocation=
function(){var m=y.getPortalUrlFromLocation();return y.setHttpsProtocol(m+"home/signin.html")};y.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};y.getDeployContextFromLocation=function(){var m=window.location.href.split("?")[0],g=m.indexOf("/home/");0>g&&(g=m.indexOf("/apps/"));m=m.substring(m.indexOf(window.location.host)+window.location.host.length+1,g);"/"!==m&&(m="/"+m+"/");return m};y.getRestBaseUrlFromLocation=function(){return window.location.protocol+
"//"+window.location.host+y.getDeployContextFromLocation()+"sharing/rest/"};return y})},"jimu/shared/basePortalUrlUtils":function(){define(function(){var B={declaredClass:"jimu.shared.basePortalUrlUtils"};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*/gi,"").replace(/\s*$/gi,"")});"function"!==typeof String.prototype.startWith&&(String.prototype.startWith=function(m){return this.substr(0,m.length)===m});"function"!==typeof String.prototype.endWith&&
(String.prototype.endWith=function(m){return this.substr(this.length-m.length,m.length)===m});B.getServerByUrl=function(m){m=(m||"").trim();m=m.replace(/^(http(s?):?)\/\//gi,"");0===m.indexOf("//")&&(m=m.slice(2));return m.split("/")[0]};B.getServerWithProtocol=function(m){var y="";if(m=(m||"").trim()){var x=B.getServerByUrl(m);if(!x)return y;var g=B.getProtocol(m);g?y=g+"://"+x:0===m.indexOf("//")&&(y="//"+x)}return y};B.isSameServer=function(m,y){m=B.getServerByUrl(m)||"";y=B.getServerByUrl(y)||
"";return m.toLowerCase()===y.toLowerCase()};B.getDomain=function(m){var y="";if(m=B.getServerByUrl(m))m=m.replace(/:\d+$/,""),m=m.match(/[^.]\w+\.\w+$/),null!==m&&(y=m[0],/^\d+\.\d+$/.test(y)&&(y=""));return y};B.isSameDomain=function(m,y){m=B.getDomain(m);y=B.getDomain(y);return""!==m&&m===y};B.isOrgOnline=function(m){return 0<=B.getServerByUrl(m).toLowerCase().indexOf(".maps.arcgis.com")};B.isOnline=function(m){return 0<=B.getServerByUrl(m).toLowerCase().indexOf(".arcgis.com")};B.isArcGIScom=function(m){m=
B.getServerByUrl(m).toLowerCase();return"www.arcgis.com"===m||"arcgis.com"===m};B.getStandardPortalUrl=function(m){var y=B.getServerByUrl(m);if(""===y)return"";B.isOnline(y)?(B.isArcGIScom(y)&&(y="www.arcgis.com"),m=B.addProtocol(m),m=B.getProtocol(m)+"://"+y):(m=(m||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),m=B.addProtocol(m),m.replace(new RegExp("http(s?)://"+y,"g"),"")||(m+="/arcgis"));return m};B.isSamePortalUrl=function(m,y){var x=/^http(s?):\/\//gi,g=/^\/\//gi;m=B.getStandardPortalUrl(m).toLowerCase().replace(x,
"").replace(g,"");y=B.getStandardPortalUrl(y).toLowerCase().replace(x,"").replace(g,"");return m===y};B.addProtocol=function(m){if(-1>=m.toLowerCase().indexOf("http://")&&-1>=m.toLowerCase().indexOf("https://")){var y="";"undefined"!==typeof window&&window.location?(y=window.location.protocol,m=m.startWith("//")?y+m:m.startWith("/")?y+"//"+window.location.host+m:y+"//"+m):(y="http:",m=m.startWith("//")?y+m:y+"//"+m)}return m};B.getProtocol=function(m){var y="";m=m.toLowerCase();0===m.indexOf("https://")?
y="https":0===m.indexOf("http://")&&(y="http");return y};B.updateUrlProtocolByOtherUrl=function(m,y){y=y.toLowerCase();0===y.indexOf("https://")?m=B.setHttpsProtocol(m):0===y.indexOf("http://")&&(m=B.setHttpProtocol(m));return m};B.removeProtocol=function(m){return m.replace(/^http(s?):\/\//i,"//")};B.setHttpProtocol=function(m){m=B.addProtocol(m);return m.replace(/^https:\/\//,"http://")};B.setHttpsProtocol=function(m){m=B.addProtocol(m);return m.replace(/^http:\/\//,"https://")};B.setProtocol=function(m,
y){return 0<=y.indexOf("https")?B.setHttpsProtocol(m):0<=y.indexOf("http")?B.setHttpProtocol(m):m};B.getSharingUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/sharing/rest");return y};B.getOAuth2Url=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/sharing/rest/oauth2");return y};B.getAppIdUrl=function(m,y){var x="";(m=B.getStandardPortalUrl(m))&&(x=m+"/sharing/rest/oauth2/apps/"+y);return x};B.getSignInUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/home/signin.html");
return y};B.getBaseSearchUrl=function(m){var y="";m=B.getStandardPortalUrl(m);(m=m.replace(/\/*$/g,""))&&(y=m+"/sharing/rest/search");return y};B.getBaseItemUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/sharing/rest/content/items");return y};B.getItemUrl=function(m,y){var x="";(m=B.getBaseItemUrl(m))&&y&&(x=m+"/"+y);return x};B.getItemDataUrl=function(m,y){var x="";(m=B.getItemUrl(m,y))&&(x=m+"/data");return x};B.getItemGroupsUrl=function(m,y){var x="";(m=B.getItemUrl(m,y))&&(x=m+
"/groups");return x};B.getGenerateTokenUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/sharing/generateToken");return y};B.getItemDetailsPageUrl=function(m,y){var x="";m&&y&&(m=B.getStandardPortalUrl(m),x=m+"/home/item.html?id\x3d"+y);return x};B.getUserProfilePageUrl=function(m,y){var x="";m&&y&&(m=B.getStandardPortalUrl(m),x=m+"/home/user.html?user\x3d"+y);return x};B.getBaseGroupUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/sharing/rest/community/groups");return y};
B.getPortalSelfInfoUrl=function(m){var y="";(m=B.getStandardPortalUrl(m||""))&&(y=m+"/sharing/rest/portals/self");return y};B.getCommunitySelfUrl=function(m){var y="";(m=B.getStandardPortalUrl(m||""))&&(y=m+"/sharing/rest/community/self");return y};B.getBaseUserUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/sharing/rest/community/users");return y};B.getUserUrl=function(m,y){var x="",g=B.getBaseUserUrl(m);m&&y&&(x=g+"/"+y);return x};B.getUserTagsUrl=function(m,y){var x="",g=B.getUserUrl(m,
y);m&&y&&(x=g+"/tags");return x};B.getUserThumbnailUrl=function(m,y,x){var g="";(m=B.getUserUrl(m,y))&&x&&(g=m+"/info/"+x);return g};B.getContentUrl=function(m){var y="";m&&(m=B.getStandardPortalUrl(m),y=m+"/sharing/rest/content");return y};B.getUserContentUrl=function(m,y,x){var g="",g="";m&&y&&(g=B.getContentUrl(m),g=x?g+"/users/"+y+"/"+x:g+"/users/"+y);return g};B.getUserContentItemUrl=function(m,y,x){var g="",g="";m&&y&&x&&(g=B.getUserContentUrl(m,y),g=g+"/items/"+x);return g};B.getItemResourceUrl=
function(m,y,x){var g="",g="";m&&y&&(g=B.getContentUrl(m),g=x?g+"/items/"+y+"/resources/"+x:g+"/items/"+y+"/resources");return g};B.getAddItemUrl=function(m,y,x){var g="",g="";m&&y&&(g=B.getUserContentUrl(m,y,x),g+="/addItem");return g};B.getDeleteItemUrl=function(m,y,x){var g="";(m=B.getUserItemsUrl(m,y))&&(g=m+"/"+x+"/delete");return g};B.getUserItemsUrl=function(m,y,x){var g="",g="";m&&y&&(g=B.getUserContentUrl(m,y,x),g+="/items");return g};B.getUpdateItemUrl=function(m,y,x,g){var w="",w="";m&&
y&&(w=B.getUserItemsUrl(m,y,g),w=w+"/"+x+"/update");return w};B.shareItemUrl=function(m,y,x,g){var w="",w="";m&&y&&(w=B.getUserItemsUrl(m,y,g),w=w+"/"+x+"/share");return w};B.getHomeIndexUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/home/index.html");return y};B.getHomeMapViewerUrl=function(m,y){var x="";if(m=B.getStandardPortalUrl(m))x=m+"/home/webmap/viewer.html",x=y?x+("?webmap\x3d"+y):x+"?useExisting\x3d1";return x};B.getHomeSceneViewerUrl=function(m,y){var x="";if(m=B.getStandardPortalUrl(m))x=
m+"/home/webscene/viewer.html",y&&(x+="?webscene\x3d"+y);return x};B.getHomeGalleryUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/home/gallery.html");return y};B.getHomeGroupsUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/home/groups.html");return y};B.getHomeMyContentUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/home/content.html");return y};B.getHomeMyOrganizationUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/home/organization.html");
return y};B.getHomeUserUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/home/user.html");return y};B.getPortalHelpUrl=function(m,y){var x="";(m=B.getStandardPortalUrl(m))&&(x=m+"/portalhelp/"+(y||"en")+"/portal/");return x};B.getPortalAdminHelpUrl=function(m,y){var x="";(m=B.getStandardPortalUrl(m))&&(x=m+"/portalhelp/"+(y||"en")+"/admin/help/");return x};B.getPortalProxyUrl=function(m){var y="";(m=B.getStandardPortalUrl(m))&&(y=m+"/sharing/proxy");return y};B.getOAuth2SignOutUrl=function(m){var y=
"";(m=B.getStandardPortalUrl(m))&&(y=m+"/sharing/rest/oauth2/signout");return y};B.getNewPrintUrl=function(m){var y="";if(m=B.getStandardPortalUrl(m))m=B.setHttpProtocol(m),y=m+"/sharing/tools/newPrint";return y};B.getSwitchAccoutnsUrl=function(m,y,x){var g="";if(m=B.getStandardPortalUrl(m))g=m+"/home/pages/Account/manage_accounts.html#client_id\x3d"+y,x&&(g+="\x26redirect_uri\x3d"+x);g&&(g=B.setHttpsProtocol(g));return g};return B})},"jimu/shared/utils":function(){define([],function(){function B(m,
g){function w(g,r){var n,t,a,k,e="widgetOnScreen"===g;if(m[g]){if(m[g].groups)for(n=0;n<m[g].groups.length;n++)if(a=m[g].groups[n],r(a,{index:n,isWidget:!1,groupId:a.id,isThemeWidget:!1,isOnScreen:e}),m[g].groups[n].widgets)for(t=0;t<m[g].groups[n].widgets.length;t++)k=m[g].groups[n].widgets[t],r(k,{index:t,isWidget:!0,groupId:a.id,isThemeWidget:k.uri&&-1<k.uri.indexOf("themes/"+m.theme.name),isOnScreen:e});if(m[g].widgets)for(n=0;n<m[g].widgets.length;n++)k=m[g].widgets[n],r(m[g].widgets[n],{index:n,
isWidget:!0,groupId:g,isThemeWidget:k.uri&&-1<k.uri.indexOf("themes/"+m.theme.name),isOnScreen:e})}}w("widgetOnScreen",g);w("widgetPool",g)}var m={},y="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwitched isController hasVersionManager isThemeWidget supportMultiInstance mirrorIconForRTL".split(" ");m.visitElement=B;m.getConfigElementById=function(m,g){var w;if("map"===g)return m.map;B(m,function(t){if(t.id===g)return w=
t,!0});return w};m.getConfigElementByLabel=function(m,g){var w;if("map"===g)return m.map;B(m,function(t){if(t.label||t.name===g)return w=t,!0});return w};m.getConfigElementsByName=function(m,g){var w=[];if("map"===g)return[m.map];B(m,function(t){t.name===g&&w.push(t)});return w};m.getWidgetNameFromUri=function(m){m=m.split("/");m.pop();return m.pop()};m.getAmdFolderFromUri=function(m){m=m.split("/");m.pop();return m.join("/")+"/"};m.widgetProperties=y;m.processWidgetProperties=function(m){"undefined"===
typeof m.properties.isController&&(m.properties.isController=!1);"undefined"===typeof m.properties.isThemeWidget&&(m.properties.isThemeWidget=!1);"undefined"===typeof m.properties.hasVersionManager&&(m.properties.hasVersionManager=!1);"undefined"===typeof m.properties.mirrorIconForRTL&&(m.properties.mirrorIconForRTL=!1);y.forEach(function(g){"undefined"===typeof m.properties[g]&&(m.properties[g]=!0)})};m.getControllerWidgets=function(m){var g=[];m.visitElement(function(w){w.isController&&g.push(w)});
return g};m.addI18NLabelToManifest=function(m,g,w){function t(g,a){a[r]&&(m.i18nLabels[g]=a[r]);"theme"===m.category&&(m.layouts&&m.layouts.forEach(function(k){m["i18nLabels_layout_"+k.name]||(m["i18nLabels_layout_"+k.name]={});m["i18nLabels_layout_"+k.name][g]=a["_layout_"+k.name]}),m.styles&&m.styles.forEach(function(k){m["i18nLabels_style_"+k.name]||(m["i18nLabels_style_"+k.name]={});m["i18nLabels_style_"+k.name][g]=a["_style_"+k.name]}));"widget"===m.category&&m.featureActions&&m.featureActions.forEach(function(k){m["i18nLabels_featureAction_"+
k.name]||(m["i18nLabels_featureAction_"+k.name]={});m["i18nLabels_featureAction_"+k.name][g]=a["_featureAction_"+k.name]})}m.i18nLabels={};var r="widget"===m.category?"_widgetLabel":"_themeLabel";g&&g.root&&g.root[r]&&(m.i18nLabels.defaultLabel=g.root[r],"theme"===m.category&&(m.layouts&&m.layouts.forEach(function(n){m["i18nLabels_layout_"+n.name]={};m["i18nLabels_layout_"+n.name].defaultLabel=g.root["_layout_"+n.name]}),m.styles&&m.styles.forEach(function(n){m["i18nLabels_style_"+n.name]={};m["i18nLabels_style_"+
n.name].defaultLabel=g.root["_style_"+n.name]})),"widget"===m.category&&m.featureActions&&m.featureActions.forEach(function(n){m["i18nLabels_featureAction_"+n.name]={};m["i18nLabels_featureAction_"+n.name].defaultLabel=g.root["_featureAction_"+n.name]}));for(var n in w)t(n,w[n])};m.isHostedService=function(m){if(!m)return!1;var g=-1!==m.indexOf(".arcgis.com/");m=-1!==m.indexOf("//services")||-1!==m.indexOf("//tiles")||-1!==m.indexOf("//features");return g&&m};return m})},"jimu/accessibleUtils":function(){define(["dojo/_base/lang",
"dojo/_base/html","dojo/query","dojo/keys","dojo/on"],function(B,m,y,x,g){var w={firstFocusNodeClass:"firstFocusNode",lastFocusNodeClass:"lastFocusNode",isInNavMode:function(){return m.hasClass(document.body,"jimu-nav-mode")?!0:!1},initTabIndexAndOrder:function(g){var r=w.getFirstFocusNode(g.domNode,g.inPanel),n=w.getLastFocusNode(g.domNode);r&&!n&&(n=r);g.isController&&(r=n=null);w.initFirstFocusNode(g.domNode,r);w.initLastFocusNode(g.domNode,n)},isCommonOnScreenWidget:function(g){return g.isOnScreen&&
!0!==g.closeable},preventMapNavigation:function(g){0<=[x.NUMPAD_PLUS,61,187,x.NUMPAD_MINUS,173,189,x.UP_ARROW,x.NUMPAD_8,x.RIGHT_ARROW,x.NUMPAD_6,x.DOWN_ARROW,x.NUMPAD_2,x.LEFT_ARROW,x.NUMPAD_4,x.PAGE_UP,x.NUMPAD_9,x.PAGE_DOWN,x.NUMPAD_3,x.END,x.NUMPAD_1,x.HOME,x.NUMPAD_7].indexOf(g.keyCode)&&g.stopPropagation()},initWidgetCancelEvent:function(t){m.setAttr(t.domNode,"role","application");g(t.domNode,"keydown",B.hitch(this,function(g){w.preventMapNavigation(g);var n=g.target;window.isMoveFocusFromMap=
!1;t.inPanel||0>[x.ENTER,x.ESCAPE].indexOf(g.keyCode)||(w.isCommonOnScreenWidget(t)?g.keyCode===x.ENTER&&m.hasClass(n,t.baseClass)?(g.preventDefault(),w.focusFirstFocusNode(t.domNode)):g.keyCode===x.ESCAPE&&(m.hasClass(n,t.baseClass)?(g="jimu-layout-manager"===m.getAttr(t.domNode.parentNode,"id")?t.domNode:t.domNode.parentNode,w.trapToNextFocusContainer(g,!1)):(g.stopPropagation(),t.domNode.focus())):g.keyCode!==x.ESCAPE||m.hasClass(n,t.baseClass)||(t.domNode.focus(),t.onClose(),g.preventDefault(),
g.stopPropagation()))}))},initFirstFocusNode:function(t,r){var n=w.getFirstFocusNode(t);n&&(m.removeClass(n,w.firstFocusNodeClass),n.firstNodeEvent&&n.firstNodeEvent.remove(),n===t&&m.setAttr(n,"tabindex",null));r&&(r===t&&m.setAttr(r,"tabindex",0),m.addClass(r,w.firstFocusNodeClass),r.firstNodeEvent=g(r,"keydown",B.hitch(this,function(g){if(m.hasClass(g.target,w.firstFocusNodeClass)&&g.keyCode===x.TAB)if(window.currentMsgPopup&&window.currentMsgPopup.firstFocusNode)window.currentMsgPopup.focusedNodeBeforeOpen=
g.target,g.preventDefault(),window.currentMsgPopup.firstFocusNode.focus();else{var a=y(".jimu-widget-splash",y("#jimu-layout-manager")[0])[0];a&&"none"!==m.getStyle(a,"display")&&a!==t?(g.preventDefault(),y("."+w.firstFocusNodeClass,a)[0].focus()):g.shiftKey&&(g.preventDefault(),w.getLastFocusNode(t).focus())}})))},initLastFocusNode:function(t,r){var n=w.getLastFocusNode(t);n&&(m.removeClass(n,w.lastFocusNodeClass),n.lastNodeEvent&&n.lastNodeEvent.remove(),n===t&&m.setAttr(n,"tabindex",null));r&&
(r===t&&m.setAttr(r,"tabindex",0),m.addClass(r,w.lastFocusNodeClass),r.lastNodeEvent=g(r,"keydown",B.hitch(this,function(g){if(!g.shiftKey&&g.keyCode===x.TAB)if(t===r)g.preventDefault(),this.focusFirstFocusNode(t);else{var a=this.getFocusNodesInDom(r);0===a.length?(g.preventDefault(),this.focusFirstFocusNode(t)):m.hasClass(g.target,w.lastFocusNodeClass)||a[a.length-1]!==g.target||(g.preventDefault(),this.focusFirstFocusNode(t))}})))},focusFirstFocusNode:function(g){var r=y("."+w.firstFocusNodeClass,
g)[0];(r?r:g).focus()},getFirstFocusNode:function(g,r){var n=m.hasClass(g,w.firstFocusNodeClass)?g:y("."+w.firstFocusNodeClass,g)[0];!n&&r&&(n=g,null===m.getAttr(n,"tabindex")&&m.setAttr(n,"tabindex",0));return n},getLastFocusNode:function(g){return m.hasClass(g,w.lastFocusNodeClass)?g:y("."+w.lastFocusNodeClass,g)[0]},traversalDom:function(g,r){r=r?r:[];for(var n=g.childNodes,t=0;t<n.length;t++)g=n[t],1===g.nodeType&&(r.push(g),w.traversalDom(g,r));return r},getFocusNodesInDom:function(g){var r=
["A","INPUT","BUTTON","FORM"];g=w.traversalDom(g);for(var n=[],t=0;t<g.length;t++){var a=g[t],k="presentation"!==m.getAttr(a,"role"),e="hidden"!==m.getAttr(a,"type"),p=!0!==m.getAttr(a,"disabled"),u=m.getAttr(a,"tabindex");k&&e&&p&&(0<=r.indexOf(a.tagName)&&-1!==u||"DIV"===a.tagName&&u&&0<=u)&&n.push(a)}return n},trapToNextFocusContainer:function(g,r){for(var n=g.parentNode.children,t=[],a=0;a<n.length;a++){var k=n[a];0<m.getAttr(k,"tabindex")&&"none"!==m.getStyle(k,"display")&&t.push(k)}t.sort(function(a,
k){a=m.getAttr(a,"tabindex");k=m.getAttr(k,"tabindex");return a<k?-1:a===k?0:1});n=null;if(r)n=t[0];else if("none"===m.getStyle(g,"display"))n=t[0];else for(g=m.getAttr(g,"tabindex"),r=0;r<t.length;r++)if(m.getAttr(t[r],"tabindex")===g){n=r===t.length-1?t[0]:t[r+1];break}n.focus();return n},addTooltipByDomNode:function(){}};return w})},"jimu/zoomToUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred esri/config esri/graphic esri/graphicsUtils esri/geometry/Extent esri/geometry/Point esri/SpatialReference esri/geometry/webMercatorUtils esri/tasks/ProjectParameters".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a){var k={zoomToFeatureSet:function(a,p,g){var e=p.features&&0<p.features.length&&p.features[0].getLayer&&p.features[0].getLayer(),e=e?e.id:null;p=k.graphicsExtent(p.features,g);return k.zoomToExtent(a,p,e)},zoomToExtent:function(a,p,g){var e;if(!a||!k.isValidExtent(p))return e=new y,e.reject(),e;g?(e=new y,require(["jimu/LayerStructure"],function(n){(n=n.getInstance().getNodeById(g))?n.zoomTo(p).then(function(){e.resolve()},function(){e.reject()}):k.projectToMapSpatialReference(a,
p).then(function(g){p.isSinglePoint&&(g=k.convertSinglePointExtent(a,g));a.setExtent(g,!0);e.resolve()},function(){e.reject()})})):e=k.projectToMapSpatialReference(a,p).then(function(e){p.isSinglePoint&&(e=k.convertSinglePointExtent(a,e));return a.setExtent(e,!0)});return e},isValidExtent:function(a){return a&&k.isTrueOrZero(a.xmin)&&k.isTrueOrZero(a.ymin)&&k.isTrueOrZero(a.xmax)&&k.isTrueOrZero(a.ymax)}};k.isVaildExtent=k.isValidExtent;k.isTrueOrZero=function(a){return 0===a?!0:!!a};k.convertSinglePointExtent=
function(a,p){var e=a.getScale();if(e=k.getMedianScale(a,e,0))p=k.adjustHeightToAspectRatio(a,p),p=k.getExtentForScale(p,a.width,e);return p};k.graphicsExtent=function(a,k){var e=null;try{if(a&&1===a.length&&"esri.geometry.Multipoint"===a[0].geometry.declaredClass&&1===a[0].geometry.points.length){var p=a[0].geometry.points[0],n=new r(p[0],p[1],a[0].geometry.spatialReference);a=[new g(n)]}if(a&&1===a.length&&"esri.geometry.Point"===a[0].geometry.declaredClass){var m=a[0].geometry,e=new t(m.x-1E-4,
m.y-1E-4,m.x+1E-4,m.y+1E-4,m.spatialReference);e.isSinglePoint=!0}else a&&0<a.length&&(e=w.graphicsExtent(a))&&"number"===typeof k&&0<k&&(e=e.expand(k))}catch(L){console.error(L)}return e};k.projectToMapSpatialReference=function(a,p){return k.projectToSpatialReference(p,a.spatialReference)};k.projectToSpatialReference=function(e,k){var p=new y,g=e;if(k&&e)if(k.equals(e.spatialReference))p.resolve(g);else if(k.isWebMercator()&&e.spatialReference.equals(new n(4326)))g=A.geographicToWebMercator(e),g.isSinglePoint=
e.isSinglePoint,p.resolve(g);else if(k.equals(new n(4326))&&e.spatialReference.isWebMercator())g=A.webMercatorToGeographic(e),g.isSinglePoint=e.isSinglePoint,p.resolve(g);else{var r=x&&x.defaults&&x.defaults.geometryService;if(r&&"esri.tasks.GeometryService"===r.declaredClass){var t=new a;t.geometries=[e];t.outSR=k;r.project(t).then(function(a){(g=a&&0<a.length&&a[0])?(g.isSinglePoint=e.isSinglePoint,p.resolve(g)):p.reject()},function(){})}else p.reject()}else p.reject();return p};k.getMapLods=function(a){var e=
null;a._params&&a._params.lods&&(e=m.map(a._params.lods,B.hitch(this,function(a){return a.toJson()})));return e};k.getMedianScale=function(a,p,g){return k.getTargetScale(a,2,p,g)};k.getTargetScale=function(a,p,g,n){a=k.getMapLods(a);var e=1;if(a){var u=[],z=[];m.forEach(a,function(a){0<g&&a.scale>g||(a.scale<n?z.push(a.scale):u.push(a.scale))});u.reverse();1<=u.length?(e=z.length?z.length/a.length:1,p=Math.floor((u.length-1)/(p/e)),p=u[p]):p=null}else p=0===g?null:(g-n)/p;return p};k.getScaleForNextTileLevel=
function(a,p,g){if(a=k.getMapLods(a)){if(g){for(g=0;g<a.length;g++)if(a[g].scale<p)return a[g].scale-1;return a[a.length-1].scale-1}for(g=a.length-1;0<=g;g--)if(a[g].scale>p)return a[g].scale+1;return a[0].scale+1}return g?p-1:p+1};k.adjustExtentToAspectRatio=function(a,k){a=a.width/a.height;var e=k.getWidth()/k.getHeight();e>a?(a=k.getWidth()/a/2,B.mixin(k,{ymin:k.getCenter().y-a,ymax:k.getCenter().y+a})):e<a&&(a=k.getHeight()*a/2,B.mixin(k,{xmin:k.getCenter().x-a,xmax:k.getCenter().x+a}));return k};
k.adjustHeightToAspectRatio=function(a,k){a=k.getWidth()*(a.height/a.width)/5;B.mixin(k,{ymin:k.getCenter().y-a,ymax:k.getCenter().y+a});return k};k.getExtentForScale=function(a,k,g){var e=20015077/180,p=esri.config.defaults,n=esri.WKIDUnitConversion,u,r,t=a.spatialReference;t&&(u=t.wkid,r=t.wkt);t=null;u?t=n.values[n[u]]:r&&-1!==r.search(/^PROJCS/i)&&(n=/UNIT\[([^\]]+)\]\]$/i.exec(r))&&n[1]&&(t=parseFloat(n[1].split(",")[1]));return a.expand(g*k/(39.37*(t||e)*p.screenDPI)/a.getWidth())};k.getScaleForExtent=
function(a,k){var e=20015077/180,p=esri.config.defaults,g=esri.WKIDUnitConversion,n,r,t=a.spatialReference;t&&(n=t.wkid,r=t.wkt);t=null;n?t=g.values[g[n]]:r&&-1!==r.search(/^PROJCS/i)&&(g=/UNIT\[([^\]]+)\]\]$/i.exec(r))&&g[1]&&(t=parseFloat(g[1].split(",")[1]));return a.getWidth()/k*(t||e)*39.37*p.screenDPI};return k})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dijit/Tooltip dojo/aspect dojo/json dojo/query dojo/request/xhr dojo/promise/all dijit/registry ./utils jimu/tokenUtils ./dijit/Message ./DataSourceManager".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I){var L=null,P=B(t,{constructor:function(){this.loaded=[];this.missedActions=[];this.activeWidget=null;window.isBuilder?(w.subscribe("app/mapLoaded",m.hitch(this,this._onMapLoaded)),w.subscribe("app/mapChanged",m.hitch(this,this._onMapChanged))):(w.subscribe("mapLoaded",m.hitch(this,this._onMapLoaded)),w.subscribe("mapChanged",m.hitch(this,this._onMapChanged)));window.isBuilder?(w.subscribe("app/sceneViewLoaded",m.hitch(this,this._onSceneViewLoaded)),w.subscribe("app/sceneViewChanged",
m.hitch(this,this._onSceneViewChanged))):(w.subscribe("sceneViewLoaded",m.hitch(this,this._onSceneViewLoaded)),w.subscribe("sceneViewChanged",m.hitch(this,this._onSceneViewChanged)));window.isBuilder?(w.subscribe("app/appConfigLoaded",m.hitch(this,this._onAppConfigLoaded)),w.subscribe("app/appConfigChanged",m.hitch(this,this._onAppConfigChanged))):(w.subscribe("appConfigLoaded",m.hitch(this,this._onAppConfigLoaded)),w.subscribe("appConfigChanged",m.hitch(this,this._onAppConfigChanged)));w.subscribe("userSignIn",
m.hitch(this,this._onUserSignIn));w.subscribe("userSignOut",m.hitch(this,this._onUserSignOut));w.subscribe("builder/actionTriggered",m.hitch(this,this._onActionTriggered));w.subscribe("/dnd/move/start",m.hitch(this,this._onMoveStart))},loadWidget:function(a){var k=new g,n;a=m.clone(a);(n=this.getWidgetById(a.id))?k.resolve(n):e([this.loadWidgetClass(a),this.loadWidgetManifest(a)]).then(m.hitch(this,function(a){var e=a[0],g=a[1];this.loadWidgetResources(g).then(m.hitch(this,function(a){try{var n=this.createWidget(g,
e,a);x.setAttr(n.domNode,"data-widget-name",g.name);console.log("widget ["+g.uri+"] created.")}catch(S){console.log("create ["+g.uri+"] error:"+S.stack),new M({message:window.jimuNls.widgetManager.createWidgetError+": "+g.uri}),p.byId(g.id)&&p.byId(g.id).destroy(),k.reject(S)}setTimeout(m.hitch(this,function(){k.resolve(n);this.emit("widget-created",n);w.publish("widgetCreated",n)}),50)}),function(a){k.reject(a)})}),function(a){k.reject(a)});return k},loadWidgetClass:function(a){var e=new g,k;k=a.isRemote?
a.uri+".js":a.uri;require(u.getRequireConfig(),[k],m.hitch(this,function(a){e.resolve(a)}));u.checkError(a.uri,e);return e},loadWidgetResources:function(a){var k=new g,p,n,u,z=[];u=m.clone(a);a=this.tryLoadWidgetConfig(u);p=this._tryLoadResource(u,"i18n");n=this._tryLoadResource(u,"style");u=this._tryLoadResource(u,"template");z.push(a);z.push(p);z.push(u);z.push(n);e(z).then(m.hitch(this,function(a){var e={};e.config=a[0];e.i18n=a[1];e.template=a[2];e.style=a[3];k.resolve(e)}),function(a){k.reject(a)});
return k},loadWidgetManifest:function(a){var e=new g,p=u.getUriInfo(a.uri),p=p.isRemote?p.folderUrl+"manifest.json?f\x3djson":p.folderUrl+"manifest.json";if(a.manifest)return e.resolve(a),e;k(p,{handleAs:"json",headers:{"X-Requested-With":null}}).then(m.hitch(this,function(k){if(k.error&&k.error.code)return e.reject(k.error);k.category="widget";m.mixin(k,u.getUriInfo(a.uri));u.manifest.addI18NLabel(k).then(m.hitch(this,function(){this._processManifest(k);u.widgetJson.addManifest2WidgetJson(a,k);e.resolve(a)}))}),
function(a){e.reject(a)});return e},getWidgetMarginBox:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return{};if(a._marginBox)return a._marginBox;var e={left:-9999,top:-9999,relativeTo:a.position.relativeTo};a._isTestSizeFlag=!0;a.setPosition(e);this.openWidget(a);a._marginBox=a.getMarginBox();this.closeWidget(a);"undefined"!==typeof a._isTestSizeFlag&&delete a._isTestSizeFlag;return a._marginBox},_processManifest:function(a){u.manifest.addManifestProperies(a);u.manifest.processManifestLabel(a,
window.dojoConfig.locale)},createWidget:function(a,e,k){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);k.config&&k.i18n&&(k.config=u.replacePlaceHolder(k.config,k.i18n));a.rawConfig=a.config;a.config=k.config||{};this.appConfig._appData&&this._mergeAgolConfig(a);a.nls=k.i18n||{};k.template&&(a.templateString=k.template);a["class"]="jimu-widget";a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;k={};for(var p in a)a.hasOwnProperty(p)&&(k[p]=a[p]);k.widgetManager=
this;a=new e(k);a.clazz=e;n.after(a,"startup",m.hitch(this,this._postWidgetStartup,a));n.before(a,"destroy",m.hitch(this,this._onDestroyWidget,a));a.domNode.addEventListener(this._getActiveEventName(),m.hitch(this,this._onClickWidget,a),{capture:!0});this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var a=y.map(this.loaded,function(a){return a.id});y.forEach(a,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var k=
new g;a=m.clone(a);a.id+="_setting";e([this.loadWidgetSettingClass(a)]).then(m.hitch(this,function(e){var g=e[0];this.loadWidgetSettingPageResources(a).then(m.hitch(this,function(e){var u;e={nls:e.i18n,templateString:e.template,appConfig:this.appConfig,"class":"jimu-widget-setting"};"HTML3D"===window.appInfo.appType?e.sceneView=this.sceneView:e.map=this.map;for(var z in a)a.hasOwnProperty(z)&&(e[z]=a[z]);try{u=new g(e),x.setAttr(u.domNode,"data-widget-name-setting",e.name),n.before(u,"destroy",m.hitch(this,
this._onDestroyWidgetSetting,u)),k.resolve(u)}catch(T){new M({message:window.jimuNls.widgetManager.createWidgetSettingPageError+":"+a.uri}),p.byId(e.id)&&p.byId(e.id).destroy(),k.reject(T)}}),function(a){console.log(a)})}),function(a){k.reject(a)});return k},loadWidgetSettingClass:function(a){var e=new g,k;k=a.isRemote?a.folderUrl+"setting/Setting.js":a.amdFolder+"setting/Setting";require(u.getRequireConfig(),[k],m.hitch(this,function(a){e.resolve(a)}));u.checkError(a.folderUrl+"setting/Setting.js",
e);return e},loadWidgetSettingPageResources:function(a){var k=new g,p,n,u=[];a=m.clone(a);p=this._tryLoadResource(a,"settingI18n");n=this._tryLoadResource(a,"settingTemplate");a=this._tryLoadResource(a,"settingStyle");u.push(p);u.push(n);u.push(a);e(u).then(m.hitch(this,function(a){var e={};e.i18n=a[0]||{};e.template=a[1];e.style=a[2];k.resolve(e)}),function(a){console.log(a)});return k},getWidgetById:function(a){var e;y.some(this.loaded,function(k){if(k.id===a)return e=k,!0},this);return e},getWidgetByLabel:function(a){var e;
y.some(this.loaded,function(k){if(k.label===a)return e=k,!0},this);return e},getWidgetsByName:function(a){var e=[];y.some(this.loaded,function(k){k.name===a&&e.push(k)},this);return e},changeWindowStateTo:function(a,e){"normal"===e?this.normalizeWidget(a):"minimized"===e?this.minimizeWidget(a):"maximized"===e?this.maximizeWidget(a):console.log("error state: "+e)},closeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if("closed"!==a.state){this.activeWidget&&this.activeWidget.id===
a.id&&(this.activeWidget.onDeActive(),this.activeWidget=null);x.setStyle(a.domNode,"display","none");a.setState("closed");try{a.onClose()}catch(N){console.log(console.error("fail to close widget "+a.name+". "+N.stack))}}this.appConfig.mode||this._removeDataSourceUsage(a)},openWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if(!a.started)try{a.started=!0,a.startup()}catch(N){console.error("fail to startup widget "+a.name+". "+N.stack)}if("closed"===a.state){x.setStyle(a.domNode,
"display","");a.setState("opened");try{a.onOpen()}catch(N){console.error("fail to open widget "+a.name+". "+N.stack)}u.isCommonOnScreenWidget(a)||(a.openAtStart&&!a._isNotOpenAtStart?a._isNotOpenAtStart=!0:u.focusFirstFocusNode(a.domNode));this.appConfig.mode||this._addDataSourceUsage(a)}},activateWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"opened"===a.state&&this._activeWidget(a)},maximizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;
"closed"===a.state&&this.openWidget(a);a.setWindowState("maximized");try{a.onMaximize()}catch(N){console.log(console.error("fail to maximize widget "+a.name+". "+N.stack))}},minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");try{a.onMinimize()}catch(N){console.log(console.error("fail to minimize widget "+a.name+". "+N.stack))}},normalizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),
!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(N){console.log(console.error("fail to normalize widget "+a.name+". "+N.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(N){console.log(console.error("fail to destroy widget "+a.name+". "+N.stack))}},tryLoadWidgetConfig:function(a){return this._tryLoadWidgetConfig(a).then(m.hitch(this,function(e){return this._upgradeWidgetConfig(a,
e).then(function(e){return a.config=e})}))},triggerWidgetOpen:function(a){function e(a){var e=n.after(a,"onOpen",function(){e.remove();k.resolve(a)})}var k=new g,p=this.getWidgetById(a);if(p){if("closed"!==p.state)return k.resolve(p),k;e(p)}else var u=w.subscribe("widgetCreated",m.hitch(this,function(e){e.id===a&&(u.remove(),k.resolve(e))}));w.publish("openWidget",a);return k},_tryLoadWidgetConfig:function(a){var e=new g;if(a.config&&m.isObject(a.config))return e.resolve(a.config),e;if(a.config){if(require.cache["url:"+
a.config])return e.resolve(A.parse(require.cache["url:"+a.config])),e;e=u.processUrlInAppConfig(a.config);e=e.split("/");e[e.length-1]=encodeURIComponent(e[e.length-1]);e=e.join("/");return k(e,{handleAs:"json",headers:{"X-Requested-With":null}})}return this._tryLoadResource(a,"config").then(function(e){a.isDefaultConfig=!0;return e})},_upgradeWidgetConfig:function(a,e){var k=new g,p=a.manifest.version,n=a.version,z;if(p===n)return k.resolve(e),k;if(!1===a.hasVersionManager)return a.version=p,k.resolve(e),
k;require(u.getRequireConfig(),[a.amdFolder+(a.isRemote?"VersionManager.js":"VersionManager")],m.hitch(this,function(g){g=new g;var u=g.getVersionIndex(n),r=g.getVersionIndex(p);if(u>r)k.reject("Bad widget version number, "+a.name+","+n);else try{z=g.upgrade(e,n,p),a.version=p,k.resolve(z)}catch(U){console.log("Read widget ["+a.name+"] old config error,"+U.stack),k.resolve(e)}}));return k},loadWidgetStyle:function(a){var e=this._getStyleIdFromWidgetJson(a,!1),k=new g;return x.byId(e)?(k.resolve("load"),
k):u.loadStyleLink(e,a.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(a){var e=this._getStyleIdFromWidgetJson(a,!0),k=new g;return x.byId(e)?(k.resolve("load"),k):u.loadStyleLink(e,a.settingStyleFile)},loadWidgetConfig:function(a){a=require(u.getRequireConfig()).toUrl(a.configFile);if(require.cache["url:"+a]){var e=new g;e.resolve(A.parse(require.cache["url:"+a]));return e}return k(a,{handleAs:"json",headers:{"X-Requested-With":null}})},loadWidgetI18n:function(a){var e=
new g;require(u.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){e.resolve(a)});return e},loadWidgetSettingI18n:function(a){var e=new g;require(u.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){e.resolve(a)});return e},loadWidgetTemplate:function(a){var e=new g;require(u.getRequireConfig(),["dojo/text!"+a.templateFile],function(a){e.resolve(a)});u.checkError(a.templateFile,e);return e},loadWidgetSettingTemplate:function(a){var e=new g;require(u.getRequireConfig(),["dojo/text!"+
a.settingTemplateFile],function(a){e.resolve(a)});u.checkError(a.settingTemplateFile,e);return e},removeWidgetStyle:function(a){this._removeStyle(this._getStyleIdFromWidgetJson(a,!1))},removeWidgetSettingStyle:function(a){this._removeStyle(this._getStyleIdFromWidgetJson(a,!0))},_removeStyle:function(a){if(x.byId(a)){var e=x.attr(a,"data-import-styles");if(e)for(var k=0;k<parseInt(e,10);k++)x.destroy(a+"_import_"+k);x.destroy(a)}},_getStyleIdFromWidgetJson:function(a,e){return this._replaceId("widget/style/"+
(a.itemId?a.itemId:a.uri)+(e?"/setting":""))},getControllerWidgets:function(){return y.filter(this.loaded,function(a){return a.isController})},getOffPanelWidgets:function(){return y.filter(this.loaded,function(a){return!a.inPanel})},getOnScreenOffPanelWidgets:function(){return y.filter(this.loaded,function(a){return a.isOnScreen&&!a.inPanel})},closeOtherWidgetsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;for(var e=0;e<this.loaded.length;e++)this.loaded[e].gid===
a.gid&&this.loaded[e].id!==a.id&&this.closeWidget(this.loaded[e])},closeAllWidgetsInGroup:function(a){for(var e=0;e<this.loaded.length;e++)this.loaded[e].gid===a&&this.closeWidget(this.loaded[e])},_addDataSourceUsage:function(a){y.forEach(this._getUsedDataSourceIdFromWidget(a),function(e){I.getInstance().addDataSourceUsage(e,a.id)})},_removeDataSourceUsage:function(a){y.forEach(this._getUsedDataSourceIdFromWidget(a),function(e){I.getInstance().removeDataSourceUsage(e,a.id)})},_getUsedDataSourceIdFromWidget:function(a){if((a=
this.appConfig.getConfigElementById(a.id))&&a.config){var e=A.stringify(a.config);return y.filter(Object.keys(this.appConfig.dataSource.dataSources),function(a){return-1<e.indexOf(a)},this)}},_mergeAgolConfig:function(a){var e=this.appConfig._appData.values,k="widgets["+a.id+"]",p;for(p in e){var g=p.replace(/\//g,"_").indexOf(k+"_config");0<=g&&u.template.setConfigValue(a,p.replace(/\//g,"_").substr(g,p.length).replace(k,"widget"),e[p])}},_onUserSignIn:function(a){y.forEach(this.loaded,function(e){e.onSignIn(a)},
this)},_onUserSignOut:function(){y.forEach(this.loaded,function(a){a.onSignOut()},this)},_activeWidget:function(a){if(this.activeWidget){if(this.activeWidget.id===a.id){!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&x.setStyle(this.activeWidget.domNode,"zIndex",101);return}"active"===this.activeWidget.state&&(this.activeWidget.setState("opened"),!1===this.activeWidget.inPanel&&x.setStyle(a.domNode,"zIndex","zIndex"in a.position?a.position.zIndex:"auto"),this.activeWidget.onDeActive())}this.activeWidget=
a;"opened"===this.activeWidget.state&&(this.activeWidget.setState("active"),!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&x.setStyle(this.activeWidget.domNode,"zIndex",101),this.activeWidget.onActive(),w.publish("widgetActived",a))},_onClickWidget:function(e,k){var p=a(".jimu-widget",e.domNode);if(0<p.length)for(var g=0;g<p.length;g++)if(k.target===p[g]||x.isDescendant(k.target,p[g]))return;this._activeWidget(e)},_onMoveStart:function(a){y.forEach(this.loaded,function(e){e.domNode===
a.node&&this._activeWidget(e)},this)},_onAppConfigLoaded:function(a){this.appConfig=a=m.clone(a);z.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=a},_onSceneViewLoaded:function(a){this.sceneView=a},_onSceneViewChanged:function(a){this.sceneView=a},_onAppConfigChanged:function(a,e,k,p){var g=m.clone(a);this.appConfig=g;y.forEach(this.loaded,function(a){a&&(a.onAppConfigChanged(g,e,k,p),"widgetChange"===e&&this._onConfigChanged(k.id,k.config,p))},
this)},_onConfigChanged:function(a,e){if(a=this.getWidgetById(a))a.onConfigChanged(e),m.mixin(a.config,e)},_onActionTriggered:function(a){if("map"!==a.elementId&&"app"!==a.elementId){var e=this.getWidgetById(a.elementId);if(e)e.onAction(a.action,a.data);else this.missedActions.push({id:a.elementId,action:{name:a.action,data:a.data}});y.forEach(this.getControllerWidgets(),function(e){if(e.widgetIsControlled(a.elementId))e.onAction(a.action,{widgetId:a.elementId,data:a.data})},this)}},_postWidgetStartup:function(a){a.started=
!0;u.setVerticalCenter(a.domNode);n.after(a,"resize",m.hitch(this,u.setVerticalCenter,a.domNode));u.initTabIndexAndOrder(a);u.initWidgetCancelEvent(a);this.openWidget(a);var e=z.getPortalCredential(this.appConfig.portalUrl);if(e)a.onSignIn(e);else a.onSignOut();this._triggerMissedAction(a);u.addTooltipByDomNode(r,a.domNode,a.label)},_triggerMissedAction:function(a){this.missedActions.forEach(function(e){if(e.id===a.id)a.onAction(e.action.name,e.action.data)})},_remove:function(a){return y.some(this.loaded,
function(e,k){if(e.id===a)return this.loaded.splice(k,1),!0},this)},_tryLoadResource:function(a,e){var k,p=new g;if("config"===e)k=a.amdFolder+"config.json",a.configFile=k,k="hasConfig";else if("style"===e)k=a.amdFolder+"css/style.css",a.styleFile=k,k="hasStyle";else if("i18n"===e)k=a.amdFolder+"nls/strings.js",a.i18nFile=a.isRemote?k:a.amdFolder+"nls/strings",k="hasLocale";else if("template"===e)k=a.amdFolder+"Widget.html",a.templateFile=k,k="hasUIFile";else if("settingTemplate"===e)k=a.amdFolder+
"setting/Setting.html",a.settingTemplateFile=k,k="hasSettingUIFile";else if("settingI18n"===e)k=a.amdFolder+"setting/nls/strings.js",a.settingI18nFile=a.isRemote?k:a.amdFolder+"setting/nls/strings",k="hasSettingLocale";else if("settingStyle"===e)k=a.amdFolder+"setting/css/style.css",a.settingStyleFile=k,k="hasSettingStyle";else return p;a[k]?function(){var k;if("config"===e)k=this.loadWidgetConfig(a);else if("style"===e)k=this.loadWidgetStyle(a);else if("i18n"===e)k=this.loadWidgetI18n(a);else if("template"===
e)k=this.loadWidgetTemplate(a);else if("settingTemplate"===e)k=this.loadWidgetSettingTemplate(a);else if("settingStyle"===e)k=this.loadWidgetSettingStyle(a);else if("settingI18n"===e)k=this.loadWidgetSettingI18n(a);else return p;k.then(function(a){p.resolve(a)},function(k){console.error("Load widget resource error. resource:",e);console.error(k);new M({message:window.jimuNls.widgetManager.loadWidgetResourceError+": "+a.uri});p.reject(k)})}.apply(this):p.resolve(null);return p},_replaceId:function(a){return a.replace(/\//g,
"_").replace(/\./g,"_")},_onDestroyWidget:function(a){"closed"!==a.state&&this.closeWidget(a);this._removeWidget(a);this.emit("widget-destroyed",a.id);w.publish("widgetDestroyed",a.id);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget=null);this._remove(a.id);0===this.getWidgetsByName(a.name).length&&
this.removeWidgetStyle(a)},_getActiveEventName:function(){var a="PointerEvent"in window?"pointer":"MSPointerEvent"in window?"MSPointer":!1,e=a&&"MS"===a.slice(0,2);return a?a+(e?"Down":"down"):"mousedown"}});P.getInstance=function(a){null===L&&(L=new P(a),window._widgetManager=L);return L};return P})},"jimu/tokenUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/config esri/request esri/urlUtils esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils esri/layers/vectorTiles/kernel".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M){"function"!==typeof g.getAll&&(g.getAll=function(a){var e=[];(a=g(a))&&e.push(a);return e});e={portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){return z.isInConfigOrPreviewWindow()},isStringStartWith:function(a,e){return a.substr(0,e.length)===e},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=u.getStandardPortalUrl(a))&&
(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(a){var e=new x,p=u.getStandardPortalUrl(a);a=p+"/sharing";var g=u.setHttpsProtocol(p+"/sharing/generateToken?f\x3djson"),z=u.setHttpsProtocol(a);r.get(g,{jsonp:"callback"}).then(B.hitch(this,function(a){a.token?(this.webTierPortalUrls.push(p),this.removeWabAuthCookie(),n.id.getCredential(z).then(B.hitch(this,function(n){function z(a){var e=a.creationTime||(new Date).getTime(),k=a.expires;0<e&&0<k&&k>
e&&setTimeout(function(){r.get(g,{jsonp:"callback"}).then(function(e){e.token&&(a.token=e.token,a.expires=e.expires,a.creationTime=(new Date).getTime(),a.refreshServerTokens(),z(a))},function(a){console.error(a)})},.8*(k-e))}n.token||(n.token=a.token);n.expires||(n.expires=a.expires);var t=k.canUseXhr(n.server,!0);-1<t&&A.defaults.io.corsEnabledServers.splice(t,1);this._pushCorsEnabledServerInfo({host:u.getServerByUrl(p),withCredentials:!0});e.resolve(!0);z(n)}),B.hitch(this,function(){e.resolve(!0)}))):
e.resolve(!1)}),B.hitch(this,function(a){console.error(a);e.reject(a)}));return e},addAuthorizedCrossOriginDomains:function(a){if(a&&0<a.length)for(var e=0;e<a.length;e++)this.addWithCredentialDomain(a[e])},addWithCredentialDomain:function(a){if(a&&"string"===typeof a){var e=A.defaults.io.corsEnabledServers,p=u.getServerByUrl(a);(a=u.getServerWithProtocol(a))||(a="http://"+p);a=k.canUseXhr(a,!0);-1<a&&e.splice(a,1);this._pushCorsEnabledServerInfo({host:p,withCredentials:!0})}},_pushCorsEnabledServerInfo:function(a){if(a){var e=
A.defaults.io.corsEnabledServers,k="charAt charCodeAt concat endsWith indexOf lastIndexOf localeCompare match replace search slice split startsWith substr substring toLocaleLowerCase toLocaleUpperCase toLowerCase toString toUpperCase trim trimLeft trimRight valueOf".split(" ");if("object"===typeof a&&"string"===typeof a.host){for(var p in a.host)a[p]="function"===typeof a.host[p]?function(){return a.host[p].apply(a.host,arguments)}:a.host[p];a.length=a.host.length;m.forEach(k,function(e){"function"===
typeof a.host[e]&&(a[e]=function(){return a.host[e].apply(a.host,arguments)})})}e.push(a)}},tryRegisterCredential:function(a){return this.isValidCredential(a)?m.some(n.id.credentials,B.hitch(this,function(e){return a.token===e.token}))?!1:(n.id.credentials.push(a),!0):!1},registerToken:function(a){var e=u.getSharingUrl(this.portalUrl);n.id.findCredential(e)&&m.some(n.id.credentials,B.hitch(this,function(a,e){if(this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a))return n.id.credentials.splice(e,
1),!0}));return this._getTokenInfo(a).then(function(a){a&&n.id.registerToken(a)})},_getTokenInfo:function(a){var e=u.getPortalSelfInfoUrl(this.portalUrl);return r.get(e+("?f\x3djson\x26token\x3d"+a),{jsonp:"callback"}).then(B.hitch(this,function(e){return e.user?{server:u.getSharingUrl(this.portalUrl),ssl:e.allSSL,token:a,userId:e.user.username}:null}),function(a){console.error(a);throw Error(window.jimuNls.urlParams.validateTokenError);})},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&
B.trim(a)},signInPortal:function(a){var e=new x;if(this._isInvalidPortalUrl(a)){a=u.getStandardPortalUrl(a);var k=u.getSharingUrl(a),p=this.getPortalCredential(a);p?setTimeout(B.hitch(this,function(){e.resolve(p)}),0):e=n.id.getCredential(k)}else setTimeout(B.hitch(this,function(){e.reject("Invalid portalurl.")}),0);return e},_loadPortalSelfInfo:function(e){e=u.getPortalSelfInfoUrl(e);return a({url:e,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(a,e){if(!a||
"string"!==typeof a||!e||"string"!==typeof e)return null;var k=n.id.findOAuthInfo(a);k||(k=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",k=new p({appId:e,expiration:20159,portalUrl:a,authNamespace:"/",popup:!0,popupCallbackUrl:k}),n.id.registerOAuthInfos([k]));k.appId=e;return k},signOutAll:function(){var a=u.getStandardPortalUrl(this.portalUrl),e=!!n.id.findCredential(a+"/sharing/rest");window.appInfo.isRunInPortal?this.removeEsriAuthCookieStorage():
this.removeWabAuthCookie();n.id.destroyCredentials();n.id._oAuthHash=null;e&&this._publishCurrentPortalUserSignOut(a)},userHaveSignInPortal:function(a){return!!this.getPortalCredential(B.trim(a||""))},isValidCredential:function(a){var e=!1;if(a){var e=a.token,k=a.server,p=a.scope,e=e&&"string"===typeof e&&B.trim(e),k=k&&"string"===typeof k&&B.trim(k),p="portal"===p||"server"===p,g=!0;a.expires&&(a=parseInt(a.expires,10),g=(new Date).getTime(),g=a>g);e=e&&k&&p&&g}return e},isValidPortalCredentialOfPortalUrl:function(a,
e){var k=!1;this.isValidCredential(e)&&(k="portal"===e.scope,a=u.isSameServer(a,e.server),k=k&&a);return k},getPortalCredential:function(a){var e=null;a=B.trim(a||"");if(!a)return null;a=u.getStandardPortalUrl(a);(e=this._filterPortalCredential(a,n.id.credentials))||this._tryConvertArcGIScomCrendentialToOrgCredential();return e},_tryConvertArcGIScomCrendentialToOrgCredential:function(){var a=this.portalUrl;if(a&&(a=u.getStandardPortalUrl(a),u.isOrgOnline(a)&&!this._filterPortalCredential(a,n.id.credentials))){var e=
this._filterPortalCredential("http://www.arcgis.com",n.id.credentials);e&&n.id.registerToken({token:e.token,scope:"portal",userId:e.userId,server:a+"/sharing/rest",expires:e.expires})}},saveAndRegisterCookieToCredential:function(a){a=B.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=!!a.isAdmin;this.saveWabCookie(a);var e=a.server+"/sharing/rest";a.server=e;n.id.registerToken(a);return n.id.findCredential(e,a.userId)},registerAuth2Hash:function(a){a=B.clone(a);var e=1E3*parseInt(a.expires_in,
10),e=(new Date).getTime()+e,k=u.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:k,token:a.access_token,expires:e,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");g("wab_auth",w.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");
window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,e){var k=null;a=u.getStandardPortalUrl(a);e&&0<e.length&&(e=m.filter(e,B.hitch(this,function(e){return this.isValidPortalCredentialOfPortalUrl(a,e)})),0<e.length&&(k=e[e.length-1]));return k},_removePortalCredential:function(a){var e=B.trim(a||"");if(e){e=u.getStandardPortalUrl(e);for(a=m.filter(n.id.credentials,B.hitch(this,
function(a){return this.isValidPortalCredentialOfPortalUrl(e,a)}));0<a.length;)a[0].destroy(),a.splice(0,1);n.id.credentials=m.filter(n.id.credentials,B.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(e,a)}))}},getUserIdByToken:function(e,k){var p=new x;if(e&&"string"===typeof e&&k&&"string"===typeof k){var g=u.getStandardPortalUrl(k);k=m.filter(n.id.credentials,B.hitch(this,function(a){var k=a.token===e&&a.userId;a=u.isSameServer(g,a.server);return k&&a}));if(0<k.length){var z=
k[0];setTimeout(B.hitch(this,function(){p.resolve(z.userId)}),0);return p}k=u.getCommunitySelfUrl(g);a({url:k,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(B.hitch(this,function(a){p.resolve(a&&a.username||"")}),B.hitch(this,function(a){console.error(a);p.reject("fail to get userId by token")}))}else setTimeout(B.hitch(this,function(){p.reject("invalid parameters")}),0);return p},xtGetCredentialFromCookie:function(a){var e=g("wab_auth"),k=null;if(e)try{k=w.parse(e)}catch(K){console.error(K)}if(!k||
"object"!==typeof k||!u.isSameServer(a,k.server)||window.location.host!==k.referer)return null;k.expires=parseInt(k.expires,10);e=(new Date).getTime();if(!(k.expires>e))return this.removeCookie("wab_auth"),null;a+="/sharing/rest";k.server=a;(e=n.id.findCredential(a))||n.id.registerToken(k);return e=n.id.findCredential(a)},removeCookie:function(a){var e=this.getCookiePath();z.removeCookie(a,e)},_getDomainsByServerName:function(a){var e=a.split("."),k=e.length;return m.map(e,B.hitch(this,function(a,
p){a=e.slice(p,k);var g="",n=a.length-1;m.forEach(a,B.hitch(this,function(a,e){g+=a;e!==n&&(g+=".")}));return g}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{t.publish("userSignIn",a)}catch(L){console.error(L)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{t.publish("anyUserSignIn",a)}catch(L){console.error(L)}},_publishCurrentPortalUserSignOut:function(a){try{t.publish("userSignOut",a)}catch(L){console.error(L)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,
a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a)}catch(L){console.error(L)}},_bindEvents:function(){y.after(n.id,"signIn",B.hitch(this,function(a,e){console.log(e[1]);y.after(a,"callback",B.hitch(this,function(a,e){this._signInSuccess(e[0],!1)}));return a}))},isStart:function(){return this._started},startup:function(){if(!this._started){if(this.isInConfigOrPreviewWindow()){var a=window.parent;if(a){var e=a.esri&&a.esri.id;e._wab="builder";if(e){n.id=e;var k=window.esriConfig.defaults.io,
a=a.esriConfig.defaults.io;k.corsEnabledServers=a.corsEnabledServers;k.webTierAuthServers=a.webTierAuthServers;k._processedCorsServers=a._processedCorsServers;k.corsStatus=a.corsStatus;Object.defineProperty(M,"id",{get:function(){return e},enumerable:!0,configurable:!0})}}}this._bindEvents();this._started=!0}}};e.startup();return e})},"esri/layers/vectorTiles/kernel":function(){define(["require","exports","esri/kernel","./identity/IdentityManager"],function(B,m,y,x){return function(){function g(){}
return Object.defineProperty(g,"id",{get:function(){return y.id?x:null},enumerable:!0,configurable:!0}),g.workerMessages={},g}()})},"esri/layers/vectorTiles/identity/IdentityManager":function(){define(["require","exports","esri/IdentityManager"],function(B,m,y){Object.defineProperty(m,"__esModule",{value:!0});m.findCredential=function(m){return y.findCredential(m)}})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "),
function(B,m,y,x,g,w){return B(w,{baseClass:"jimu-popup jimu-message",declaredClass:"jimu.dijit.Message",type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,customZIndex:null,postMixInProperties:function(){this.content=this.message;window.currentMsgPopup=this},_createTitleNode:function(){this.titleLabel&&(this.titleNode=y.create("div",{"class":"title"},this.domNode),this.titleLabeNode=y.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),
this.closeBtnNode=y.create("div",{"class":"close-btn jimu-icon jimu-icon-close jimu-float-trailing",tabindex:0},this.titleNode),this.own(g(this.closeBtnNode,"click",m.hitch(this,this.close))),this.own(g(this.closeBtnNode,"keydown",m.hitch(this,function(g){g.keyCode===x.ENTER&&(this.close(),this.focusLastActiveNode())}))))},_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:window.jimuNls.common.ok,key:x.ENTER,onClick:m.hitch(this,this.close)})},_increaseZIndex:function(){y.setStyle(this.domNode,
"zIndex",501);y.setStyle(this.overlayNode,"zIndex",500)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/keys dojo/sniff dojo/touch dojo/query dojo/dnd/move dijit/_WidgetBase jimu/utils".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p){var u=0;return B([e,y],{declaredClass:"jimu.dijit.Popup",baseClass:"jimu-popup",titleLabel:"",content:null,container:null,customZIndex:null,buttons:[],enabledButtons:[],
disabledButtons:[],onClose:null,_fixedHeight:!1,autoHeight:!1,isResize:!0,horizontalWidthRate:0,maxHeight:800,maxWidth:1024,enableMoveable:!0,hasTitle:!0,contentHasNoMargin:!1,hasOverlay:!0,moveToCenter:!0,customPosition:null,hiddenAfterInit:!1,useFocusLogic:!0,constructor:function(){this.buttons=[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},focusLastActiveNode:function(){this.focusedNodeBeforeOpen&&this.useFocusLogic&&this.focusedNodeBeforeOpen.focus()},
postCreate:function(){this.focusedNodeBeforeOpen=document.activeElement;this._preProcessing();this.inherited(arguments);this._initDomNode();this._addStylesByHeightType();this._calcAndSetPosition();g.place(this.domNode,this.container);setTimeout(m.hitch(this,function(){this._calcAndSetPosition(!0,!1);this.initFocusNodes()}),50);this.isResize&&this.own(t(window,"resize",m.hitch(this,function(){this._calcAndSetPosition(!0,!0)})));this.hasOverlay&&(this.overlayNode=g.create("div",{"class":"jimu-overlay"},
this.container));this.customZIndex||0===this.customZIndex?(g.setStyle(this.domNode,"zIndex",this.customZIndex+1),this.overlayNode&&g.setStyle(this.overlayNode,"zIndex",this.customZIndex)):this._increaseZIndex();this.hiddenAfterInit&&this.hide();w.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();g.setAttr(this.domNode,"role","application");this.own(t(this.domNode,"keydown",m.hitch(this,function(a){a.keyCode===r.ESCAPE&&this.close();p.preventMapNavigation(a)})))},initFocusNodes:function(){this.useFocusLogic&&
(this.firstFocusNode=this._getFirstFocusNode(),this.lastFocusNode=this._getLastFocusNode(),this.firstFocusNode&&(this.own(t(this.firstFocusNode,"keydown",m.hitch(this,function(a){a.shiftKey&&a.keyCode===r.TAB&&(a.preventDefault(),this.firstFocusNode.focus())}))),this.firstFocusNode.focus()),this.lastFocusNode&&this.own(t(this.lastFocusNode,"keydown",m.hitch(this,function(a){a.shiftKey||a.keyCode!==r.TAB||(a.preventDefault(),this.firstFocusNode.focus())}))))},_getFirstFocusNode:function(){var a=this.closeBtnNode;
if(!a)if("string"!==typeof this.content){var e;this.content.domNode?e=p.getFocusNodesInDom(this.content.domNode):1===this.content.nodeType&&(e=p.getFocusNodesInDom(this.content));0<e.length?a=e[0]:this.buttons.length&&(a=this._getFirstBtn())}else this.buttons.length&&(a=this._getFirstBtn());return a},_getLastFocusNode:function(){var a=this._getLastBtn();if(!a)if(this.content&&"string"!==typeof this.content){var e;this.content.domNode?e=p.getFocusNodesInDom(this.content.domNode):1===this.content.nodeType&&
(e=p.getFocusNodesInDom(this.content));a=0<e.length?e[e.length-1]:this.closeBtnNode}else a=this.closeBtnNode;return a},_getFirstBtn:function(){for(var e=null,k=a(".jimu-btn",this.buttonContainer),p=0;p<=k.length-1;p++)if("none"!==g.getStyle(k[p],"display")){e=k[p];break}return e},_getLastBtn:function(){for(var e=null,k=a(".jimu-btn",this.buttonContainer),p=k.length-1;0<=p;p--)if("none"!==g.getStyle(k[p],"display")){e=k[p];break}return e},_preProcessing:function(){"number"!==typeof this.width&&(this.width=
this.maxWidth);"number"===typeof this.height&&(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=g.create("div",{"class":"title"},this.domNode);this.titleLabeNode=g.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=g.create("div",{"class":"close-btn jimu-icon jimu-icon-close jimu-float-trailing",tabindex:0},this.titleNode);var a=null,a="ontouchstart"in
document?A.press:"click";this.own(t(this.closeBtnNode,a,m.hitch(this,this.close)));this.own(t(this.closeBtnNode,"keydown",m.hitch(this,function(a){a.keyCode===r.ENTER&&this.close()})))},_initDomNode:function(){this.hasTitle&&this._createTitleNode();this.contentContainerNode=g.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=
this):1===this.content.nodeType&&g.place(this.content,this.contentContainerNode));this.buttonContainer=g.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&g.setStyle(this.buttonContainer,"display","none");for(var a=0;a<=this.buttons.length-1;a++)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var a=this.enabledButtons.length;if(0!==a){var e=g.getContentBox(this.buttonContainer),k=g.getMarginExtents(this.enabledButtons[0]),
p=g.getPadBorderExtents(this.enabledButtons[0]),u=0,p=8===n("ie")?p.l+p.r:0,u=(e.w-(k.l+k.r+p)*a)/a;0<u&&(x.forEach(this.enabledButtons,m.hitch(this,function(a){g.setStyle(a,"maxWidth",u+"px")})),x.forEach(this.disabledButtons,m.hitch(this,function(a){g.setStyle(a,"maxWidth",u+"px")})))}},_moveableNode:function(a,e){this.moveable&&(this.moveable.destroy(),this.moveable=null);var p=g.getMarginBox(this.container);p.l=p.l-a+e;p.w+=2*(a-e);this.moveable=new k.boxConstrainedMoveable(this.domNode,{box:p,
handle:this.titleNode||this.contentContainerNode,within:!0});this.own(t(this.moveable,"Moving",m.hitch(this,this.onMoving)));this.own(t(this.moveable,"MoveStop",m.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===a("#header").length?{t:0,l:0,w:0,h:0}:g.getMarginBox("header")},_getFooterBox:function(){return 0===a(".footer",this.container).length?{t:0,l:0,w:0,h:0}:g.getMarginBox(a(".footer",this.container)[0])},_calcAndSetPosition:function(a,e){var k=g.getMarginBox(this.domNode);if("string"!==
typeof this.container||g.byId(this.container)){var p=g.getContentBox(this.container),n=this._getHeaderBox(),u=this._getFooterBox(),u=p.h-n.h-u.h-40,z=0,r=0;this.customPosition&&this.customPosition.height?(this.height=this.customPosition.height,r="number"===typeof this.height?this.height+"px":this.height):(this.height=this._fixedHeight?this.height>u?u:this.height:this.autoHeight?(k.h>u?u:k.h)||u-200:u>this.maxHeight?this.maxHeight:u,r=this.height+"px");this.customPosition&&this.customPosition.width?
(this.width=this.customPosition.width,z="number"===typeof this.width?this.width+"px":this.width):("number"===typeof this.horizontalWidthRate&&0<this.horizontalWidthRate?(z=g.getMarginBox(window.document.body).w*this.horizontalWidthRate,this.width=z=z>this.maxWidth?z:this.maxWidth):this.width=this.width||this.maxWidth,z=this.width+"px");var t=k=0;this.customPosition?(k="number"===typeof this.customPosition.left?this.customPosition.left+"px":this.customPosition.left,t="number"===typeof this.customPosition.top?
this.customPosition.top+"px":this.customPosition.top):this.moveToCenter&&(t=(u-this.height)/2+n.h+20,t=t<n.h?n.h:t,k=(p.w-this.width)/2+"px",t+="px");g.setStyle(this.domNode,{width:z,height:this.autoHeight?"auto":r,left:k,top:t});this.enableMoveable&&this._moveableNode(this.width,100);!this.moveToCenter&&a&&"block"===g.getStyle(this.domNode,"display")&&this.emit("popupHasInitedSuccessfully",e)}},setDomNodeStyls:function(a){g.setStyle(this.domNode,a)},setCustomPosition:function(a,e,k,p){this.width=
k||this.width||this.maxWidth;this.height=p||this.height||this.maxHeight;k="number"===typeof this.width?this.width+"px":this.width;p="number"===typeof this.height?this.height+"px":this.height;g.setStyle(this.domNode,{left:"number"===typeof a?a+"px":a,top:"number"===typeof e?e+"px":e,width:k,height:this.autoHeight?"auto":p})},_addStylesByHeightType:function(){this.autoHeight?(g.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&g.setStyle(this.contentContainerNode,{marginBottom:"15px"})):
(g.addClass(this.contentContainerNode,"content-absolute"),this.hasTitle||g.addClass(this.contentContainerNode,"no-popup-title-content-absolute"),g.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&g.setStyle(this.contentContainerNode,{bottom:"15px"}));this.contentHasNoMargin&&g.addClass(this.contentContainerNode,"content-fill-Popup")},_increaseZIndex:function(){g.setStyle(this.domNode,"zIndex",u+200+1);this.overlayNode&&g.setStyle(this.overlayNode,"zIndex",u+200);
u++},setTitleLabel:function(a){this.titleNode.innerHTML=p.stripHTML(a)},onMoving:function(a){g.setStyle(a.node,"opacity",.9)},onMoveStop:function(a){g.setStyle(a.node,"opacity",1)},show:function(){this.overlayNode&&g.setStyle(this.overlayNode,"display","block");g.setStyle(this.domNode,"display","block")},hide:function(){this.overlayNode&&g.setStyle(this.overlayNode,"display","none");g.setStyle(this.domNode,"display","none")},close:function(){if(!this.onClose||!1!==this.onClose()){var a=this.domNode.parentNode,
e=m.clone(this.domNode);g.setStyle(this.domNode,"display","none");this.overlayNode&&g.destroy(this.overlayNode);this.destroy();this.moveable&&this.moveable.destroy();g.place(e,a);w.animateProperty({node:e,properties:{opacity:0},duration:200,onEnd:function(){g.destroy(e)}}).play();this.focusLastActiveNode();window.currentMsgPopup=null}},addButton:function(a){this._createButton(a)},_createButton:function(a){var e=" ";a.classNames&&0<a.classNames.length&&"function"===typeof a.classNames.join&&(e+=a.classNames.join(" "));
var k=g.create("div",{"class":"jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1 "+e,innerHTML:a.label,tabindex:0,title:a.title||a.label},this.buttonContainer);this.enabledButtons.push(k);e=g.create("div",{"class":"jimu-btn jimu-state-disabled jimu-float-trailing jimu-trailing-margin1 "+e,title:a.title||a.label,innerHTML:a.label,tabindex:0,style:{display:"none"}},this.buttonContainer);this.disabledButtons.push(e);this.own(t(k,"click",m.hitch(this,function(e){if(a.onClick)a.onClick(e);
else this.close()})));this.own(t(k,"keydown",m.hitch(this,function(e){if(13===e.keyCode)if(a.onClick)a.onClick(e);else this.close()})))},setButtonProps:function(a,e){"number"===typeof a&&isFinite(a)||(e=a,a=0);if(e&&0!==this.enabledButtons.length)for(var k in e)"title"===k?(g.setAttr(this.enabledButtons[a],"title",e[k]),g.setAttr(this.disabledButtons[a],"title",e[k])):"label"===k&&(g.setProp(this.enabledButtons[a],"innerHTML",e[k]),g.setProp(this.disabledButtons[a],"innerHTML",e[k]))},enableButton:function(a){"number"===
typeof a&&isFinite(a)&&a<this.enabledButtons.length?(g.setStyle(this.enabledButtons[a],"display","inline-block"),g.setStyle(this.disabledButtons[a],"display","none")):(x.forEach(this.enabledButtons[a],m.hitch(this,function(a){g.setStyle(a,"display","inline-block")})),x.forEach(this.disabledButtons[a],m.hitch(this,function(a){g.setStyle(a,"display","none")})))},disableButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(g.setStyle(this.disabledButtons[a],"display","inline-block"),
g.setStyle(this.enabledButtons[a],"display","none")):(x.forEach(this.disabledButtons,m.hitch(this,function(a){g.setStyle(a,"display","inline-block")})),x.forEach(this.enabledButtons,m.hitch(this,function(a){g.setStyle(a,"display","none")})))},showButton:function(a){this.enableButton(a)},hideButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(g.setStyle(this.disabledButtons[a],"display","none"),g.setStyle(this.enabledButtons[a],"display","none")):(x.forEach(this.disabledButtons,
m.hitch(this,function(a){g.setStyle(a,"display","none")})),x.forEach(this.enabledButtons,m.hitch(this,function(a){g.setStyle(a,"display","none")})))},resize:function(a){a&&(this.width=a.w,this.height=a.h);this._calcAndSetPosition();this.content&&this.content.domNode&&this.content.resize&&this.content.resize()}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(B,m,y,x,g,w){x=B("dojo.dnd.move.constrainedMoveable",w,
{constraints:function(){},within:!1,constructor:function(g,r){r||(r={});this.constraints=r.constraints;this.within=r.within},onFirstMove:function(g){var r=this.constraintBox=this.constraints.call(this,g);r.r=r.l+r.w;r.b=r.t+r.h;this.within&&(g=m.getMarginSize(g.node),r.r-=g.w,r.b-=g.h)},onMove:function(g,r){var n=this.constraintBox,t=g.node.style;this.onMoving(g,r);r.l=r.l<n.l?n.l:n.r<r.l?n.r:r.l;r.t=r.t<n.t?n.t:n.b<r.t?n.b:r.t;t.left=r.l+"px";t.top=r.t+"px";this.onMoved(g,r)}});g=B("dojo.dnd.move.boxConstrainedMoveable",
x,{box:{},constructor:function(g,r){var n=r&&r.box;this.constraints=function(){return n}}});B=B("dojo.dnd.move.parentConstrainedMoveable",x,{area:"content",constructor:function(g,r){var n=r&&r.area;this.constraints=function(){var g=this.node.parentNode,a=y.getComputedStyle(g),k=m.getMarginBox(g,a);if("margin"==n)return k;var e=m.getMarginExtents(g,a);k.l+=e.l;k.t+=e.t;k.w-=e.w;k.h-=e.h;if("border"==n)return k;e=m.getBorderExtents(g,a);k.l+=e.l;k.t+=e.t;k.w-=e.w;k.h-=e.h;if("padding"==n)return k;e=
m.getPadExtents(g,a);k.l+=e.l;k.t+=e.t;k.w-=e.w;k.h-=e.h;return k}}});return{constrainedMoveable:x,boxConstrainedMoveable:g,parentConstrainedMoveable:B}})},"jimu/DataSourceManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Evented dojo/when ./utils jimu/LayerInfos/LayerInfos jimu/portalUtils jimu/portalUrlUtils jimu/filterUtils esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition ./Query".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,
u){var z=null,M=B(g,{constructor:function(){this._listeners=[];this._refreshTimers=[];this._dataStore={};this._jimuQueryObject={};this._dataSourceUsage={};this._itemsFilter={};this.filterUtils=new a;window.isBuilder?(x.subscribe("app/mapLoaded",m.hitch(this,this._onMapLoaded)),x.subscribe("app/mapChanged",m.hitch(this,this._onMapChanged))):(x.subscribe("mapLoaded",m.hitch(this,this._onMapLoaded)),x.subscribe("mapChanged",m.hitch(this,this._onMapChanged)));window.isBuilder?(x.subscribe("app/appConfigLoaded",
m.hitch(this,this._onAppConfigLoaded)),x.subscribe("app/appConfigChanged",m.hitch(this,this._onAppConfigChanged))):(x.subscribe("appConfigLoaded",m.hitch(this,this._onAppConfigLoaded)),x.subscribe("appConfigChanged",m.hitch(this,this._onAppConfigChanged)));x.subscribe("updateDataSourceData",m.hitch(this,this._onUpdataDataSourceData));window.isBuilder&&x.subscribe("app/dataSourceDataUpdated",m.hitch(this,this._onDataSourceDataUpdatedInApp))},getData:function(a){return this._dataStore[a]},getDataSourceConfig:function(a){return this.appConfig.dataSource.dataSources[a]},
parseDataSourceId:function(a){var e=a.split("~"),k={};if(2>e.length)return console.error("Bad data source id:",a),k;switch(e[0]){case "map":return e=a.lastIndexOf("~"),k={from:"map",layerId:a.substring(4,e)};case "widget":return k={from:"widget",widgetId:e[1]};case "external":return k={from:"external"};default:console.error("Bad data source id:",a)}},addDataSourceUsage:function(a,e){this._dataSourceUsage[a]?(0>this._dataSourceUsage[a].indexOf(e)&&this._dataSourceUsage[a].push(e),1===this._dataSourceUsage[a].length&&
this._startOneDataSource(this.appConfig.dataSource.dataSources[a])):(this._dataSourceUsage[a]=[e],this._startOneDataSource(this.appConfig.dataSource.dataSources[a]))},removeDataSourceUsage:function(a,e){this._dataSourceUsage[a]&&0<=this._dataSourceUsage[a].indexOf(e)&&(this._dataSourceUsage[a]=y.filter(this._dataSourceUsage[a],function(a){return a!==e}))},_onUpdataDataSourceData:function(a,e){this.appConfig.dataSource.dataSources[a]?"widget"!==this.parseDataSourceId(a).from?console.error("Please update data source from widget only.",
a):this._updateDataSourceData(a,e):console.error("Not found data source id:",a)},_updateDataSourceData:function(a,e){this._dataStore[a]=e;x.publish("dataSourceDataUpdated",a,e);this.emit("update",a,e)},_onDataSourceDataUpdatedInApp:function(a,e){this._updateDataSourceData(a,e)},_onMapLoaded:function(a){this.map=a;window.isBuilder||this._handleDataSourceConfigChange(this.appConfig,this.appConfig,"mapLoaded")},_onMapChanged:function(a){this.map=a;window.isBuilder||this._handleDataSourceConfigChange(this.appConfig,
this.appConfig,"mapChanged")},_onAppConfigLoaded:function(a){this.appConfig=m.clone(a)},_onAppConfigChanged:function(a,e){a=m.clone(a);window.isBuilder||("dataSourceChange"===e?this._handleDataSourceConfigChange(this.appConfig,a,e):"mapChange"===e&&this._cleanForConfigChangedDataSource(this.appConfig,a));this.appConfig=a},_handleDataSourceConfigChange:function(a,e,k){a&&(this._removeListeners(),this._removeTimers(),this._cleanForConfigChangedDataSource(a,e));y.forEach(Object.keys(e.dataSource.dataSources),
function(a){e.dataSource.dataSources[a].idObj=this.parseDataSourceId(a)},this);this._listenDataSourceChange(e.dataSource.dataSources);this._startRefreshTimer(e.dataSource,k);this._initStaticDataSource(e.dataSource)},_cleanForConfigChangedDataSource:function(a,e){var k=a.dataSource.dataSources,p=e.dataSource.dataSources;y.forEach(Object.keys(k),function(a){if(!p[a]||p[a]&&!t.isEqual(p[a],k[a]))delete this._jimuQueryObject[a],this._updateDataSourceData(a,{features:[]}),delete this._dataStore[a]},this)},
_isGlobalRefresh:function(a){return a.unifiedRefreshInterval&&0<a.unifiedRefreshInterval},_startOneDataSource:function(a){var e;e=this._isGlobalRefresh(this.appConfig.dataSource.settings)?this.appConfig.dataSource.settings.unifiedRefreshInterval:a.refreshInterval;if("map"===a.idObj.from)this._listenMapDataSourceChange(a);else if("external"===a.idObj.from&&a.filterByExtent){var k={};k.handle=this.map.on("extent-change",m.hitch(this,this._onLayerDataChange,a));k.dsId=a.id;this._listeners.push(k)}if("map"===
a.idObj.from||"external"===a.idObj.from)this._refeshDataSource(a),a.isDynamic&&(k={},k.handle=setInterval(m.hitch(this,this._refeshDataSource,a),6E4*e),k.dsId=a.id,this._refreshTimers.push(k))},_stopAndCleanOneDataSource:function(a){this._listeners=y.filter(this._listeners,function(e){return e.dsId===a.id?(e.handle.remove(),!1):!0},this);this._refreshTimers=y.filter(this._refreshTimers,function(e){return e.dsId===a.id?(clearInterval(e.handle),!1):!0},this);this._updateDataSourceData(a.id,{features:[]})},
_listenDataSourceChange:function(a){y.forEach(Object.keys(a),function(e){e=a[e];if("map"===e.idObj.from)this._listenMapDataSourceChange(e);else if("external"===e.idObj.from&&e.filterByExtent){var k={};k.handle=this.map.on("extent-change",m.hitch(this,this._onLayerDataChange,e));k.dsId=e.id;this._listeners.push(k)}},this)},_listenMapDataSourceChange:function(a){this._getLayerObject(a.idObj.layerId).then(m.hitch(this,function(e){if(e){var k={};k.handle=e.on("edits-complete",m.hitch(this,this._onLayerDataChange,
a));k.dsId=a.id;this._listeners.push(k);k={};k.handle=this._getLayerInfo(a.idObj.layerId).on("filterChanged",m.hitch(this,this._onLayerDataChange,a));k.dsId=a.id;this._listeners.push(k);a.filterByExtent&&(k={},k.handle=this.map.on("extent-change",m.hitch(this,this._onLayerDataChange,a)),k.dsId=a.id,this._listeners.push(k))}else console.error("Can not find layer that data source depends on.",a.id)}))},_onLayerDataChange:function(a){this._doQueryForDataSource(a)},_doQueryForDataSource:function(a){("config"===
this.appConfig.mode||this._dataSourceUsage[a.id]&&0!==this._dataSourceUsage[a.id].length)&&this.doQuery(a).then(m.hitch(this,function(e){this._updateDataSourceData(a.id,{features:e.features})}))},_getLayerObject:function(a){return(a=r.getInstanceSync().getLayerOrTableInfoById(a))?a.getLayerObject():w(null)},_getLayerInfo:function(a){return r.getInstanceSync().getLayerOrTableInfoById(a)},_startRefreshTimer:function(a,e){var k=a.dataSources,p=a.settings;y.forEach(Object.keys(k),function(g){g=k[g];if("widget"!==
g.idObj.from&&g.isDynamic&&g.url){var n;n=this._isGlobalRefresh(p)?p.unifiedRefreshInterval:g.refreshInterval;"dataSourceChange"===e?"external"!==g.idObj.from&&"map"!==g.idObj.from||this._refeshDataSource(g):"external"===g.idObj.from&&this._refeshDataSource(g);g={handle:setInterval(m.hitch(this,this._refeshDataSource,g),6E4*n),dsId:a.id};this._refreshTimers.push(g)}},this)},_initStaticDataSource:function(a){y.forEach(Object.keys(a.dataSources),function(e){e=a.dataSources[e];"widget"!==e.idObj.from&&
!e.isDynamic&&e.url&&this._doQueryForDataSource(e)},this)},_refeshDataSource:function(a){this._doQueryForDataSource(a)},_getDataSourceFilter:function(a){if("map"===a.idObj.from){var e=r.getInstanceSync().getLayerOrTableInfoById(a.idObj.layerId),k;e&&(k=e.getFilter());var e=a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1",p;p=k?"("+k+") and ("+e+")":e;return w(p)}return"external"===a.idObj.from?a.portalUrl&&a.itemId?this._getFilterFromItem(a.portalUrl,a.itemId,a.url).then(m.hitch(this,function(e){var k=
a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1";return p=e?"("+e+") and ("+k+")":k})):w(a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1"):w(a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1")},_getFilterExpr:function(a,e){return this.filterUtils.hasVirtualDate(a)?(this.filterUtils.isHosted=t.isHostedService(e),this.filterUtils.getExprByFilterObj(a)):a.expr},_getFilterFromItem:function(a,e,k){var p=A.getItemUrl(a,e);if(this._itemsFilter[p])return w(this._itemsFilter[p]);var g=n.getPortal(a);
return g.getItemById(e).then(m.hitch(this,function(a){return"Feature Service"!==a.type?this._itemsFilter[p]=null:g.getItemData(e).then(m.hitch(this,function(a){var e=k.split("/"),g=e.pop();g||(g=e.pop());if(!a.layers)return this._itemsFilter[p]=null;a=a.layers.filter(function(a){return a.id+""===g})[0];return a&&a.layerDefinition?this._itemsFilter[p]=a.layerDefinition.definitionExpression:this._itemsFilter[p]=null}))}))},doQuery:function(a){a.idObj||(a.idObj=this.parseDataSourceId(a.id));this.emit("begin-update",
a.id);return this._getQueryObjectFromDataSource(a).then(m.hitch(this,function(g){var n,z;if("Features"===a.type){if("serviceLimitation"===a.resultRecordType)return n=g,z=new e(a.url),z.execute(n);var r=this._jimuQueryObject[a.id];!r||r.url===a.url&&t.isEqual(r.query.toJson(),g.toJson())||(delete this._jimuQueryObject[a.id],r=null);r||(r={},r.url=a.url,r.query=g,"all"!==a.resultRecordType&&(r.pageSize=a.resultRecordCount),r=new u(r),this._jimuQueryObject[a.id]=r);return"all"===a.resultRecordType?r.getAllFeatures():
r.queryByPage(1)}z=new e(a.url);n=new k;return this._getDataSourceFilter(a).then(m.hitch(this,function(e){n.where=e;a.filterByExtent&&(n.geometry=this.map.extent);a.dataSchema.groupByFields&&0<a.dataSchema.groupByFields.length&&(n.groupByFieldsForStatistics=a.dataSchema.groupByFields);a.dataSchema.orderByFields&&0<a.dataSchema.orderByFields.length&&(n.orderByFields=a.dataSchema.orderByFields);n.outStatistics=a.dataSchema.statistics.map(function(a){var e=a.onStatisticField+"_"+a.statisticType;"count"===
a.statisticType&&(e="STAT_COUNT");var e=t.upperCaseString(e),k=new p;k.statisticType=a.statisticType;k.onStatisticField=a.onStatisticField;k.outStatisticFieldName=e;return k});return z.execute(n)}))}))},_getQueryObjectFromDataSource:function(a){return this._getDataSourceFilter(a).then(m.hitch(this,function(e){var p=new k;p.where=e;a.filterByExtent&&(p.geometry=this.map.extent);p.outFields=a.dataSchema.fields.map(function(a){return a.name});a.dataSchema.orderByFields&&0<a.dataSchema.orderByFields.length&&
(p.orderByFields=a.dataSchema.orderByFields);p.returnGeometry=!0;p.outSpatialReference=this.map.spatialReference;return w(p)}))},_removeListeners:function(){this._listeners.forEach(m.hitch(this,function(a){a.handle.remove()}));this._listeners=[]},_removeTimers:function(){this._refreshTimers.forEach(m.hitch(this,function(a){clearInterval(a.handle)}));this._refreshTimers=[]}});M.getInstance=function(){null===z&&(z=new M,window._datasourceManager=z);return z};return M})},"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/on dojo/topic dojo/Evented dojo/promise/all ./LayerInfoFactory".split(" "),
function(B,m,y,x,g,w,t,r,n){var A=B([t],{declaredClass:"jimu.LayerInfos",map:null,_operLayers:null,_layerInfos:null,_finalLayerInfos:null,_tableInfos:null,_basemapLayerInfos:null,_finalBasemapLayerInfos:null,_basemapLayers:null,_unreachableLayersTitleOfWebmap:null,_objectId:null,_layerInfoFactory:null,constructor:function(a,k){this._objectId=Math.random();this._unreachableLayersTitleOfWebmap=[];this._basemapLayers=k.baseMap.baseMapLayers;this._operLayers=k.operationalLayers;this._tables=k.tables;
this._layerInfoFactory=new n(a,this);this.map=a;this._initLayerInfos();this._initBasemapLayerInfos();this._initTablesInfos();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this._finalLayerInfos);this._clearAddedFlag(this._finalBasemapLayerInfos);this._initFinalLayerInfos();this._initFinalBasemapLayerInfos();this._markFirstOrLastNode()},getLayerInfoArrayOfWebmap:function(){var a=[];m.forEach(this.getLayerInfoArray(),function(e){for(var k=0;k<this._operLayers.length;k++)if(e.id===
this._operLayers[k].id){a.push(e);break}k===this._operLayers.length&&0<=this._removedLayerInfoIdsFromFeatureCollection.indexOf(e.id)&&a.push(e)},this);return a},getTableInfoArrayOfWebmap:function(){var a=[];m.forEach(this.getTableInfoArray(),function(e){for(var k=0;k<this._tables.length;k++)if(e.id===this._tables[k].id){a.push(e);break}},this);return a},getLayerInfoArray:function(){return m.filter(this._finalLayerInfos,function(a){y.getObject("_wabProperties.isTemporaryLayer",!1,a.layerObject)&&(a._flag._isTemporaryLayerInfo=
!0);return!a._flag._isTemporaryLayerInfo})},getTableInfoArray:function(){return this._tableInfos},getBasemapLayerInfoArray:function(){return this._finalBasemapLayerInfos},addFeatureCollection:function(a,k){var e=this._getUniqueTopLayerInfoId(k),p={layers:[]};m.forEach(a,function(a,k){a.id=e+"_"+k;p.layers.push({id:a.id,layerObject:a})},this);this.map.addLayers(a);var g;try{g=this._layerInfoFactory.create({featureCollection:p,title:k||e,id:e},this.map),g.init()}catch(I){console.warn(I.message),g=null}g&&
(g._extraOfWebmapLayerInfo=!0,this._layerInfos.push(g),this.update(),this._onLayersUpdated(g,g.getRootLayerInfo()))},addTable:function(a){a=this._addTables([a],this._tableInfos);return a[0]?a[0]:null},removeTable:function(a){var e=-1;m.forEach(this._tableInfos,function(k,p){a.id===k.id&&(e=p)});if(0<=e){var k=this._tableInfos[e];this._tableInfos.splice(e,1);k.destroy();this._onTableChange([a],A.REMOVED)}},_addTables:function(a,k){var e=[],p=[];m.forEach(a,function(a){var g;try{a.layerObject={url:a.url,
featureCollectionData:a.featureCollectionData,empty:!0},a.id=this._getUniqueTableId(a.id),a.selfType="table",g=this._layerInfoFactory.create(a),g.init()}catch(L){console.warn(L.message),g=null}g&&(e.push(g),k.push(g),p.push(g.getLayerObject()))},this);r(p).then(y.hitch(this,function(a){var k=[];m.forEach(a,function(a,p){p=e[p];a?k.push(p):(this.removeTable(p),p.destroy())},this);this._onTableChange(k,A.ADDED)}));return e},_getUniqueTableId:function(a){var e=this._tableInfos.concat(this._tableInfos||
[]);return this._getUniqueLayerOrTableId(a,e)},_getUniqueTopLayerInfoId:function(a){return this._getUniqueLayerOrTableId(a,this._finalLayerInfos)},_getUniqueLayerOrTableId:function(a,k){var e=1,p;a||(a="table");for(p=a;;){for(var g=0;g<k.length&&k[g].id!==p;g++);if(g===k.length)return p;p=a+"_"+e.toString();e++}},_traversal:function(a,k){for(var e=0;e<k.length;e++)if(k[e].traversal(a))return!0;return!1},traversal:function(a){var e=this.getLayerInfoArray();return this._traversal(a,e)},traversalLayerInfosOfWebmap:function(a){var e=
this.getLayerInfoArrayOfWebmap();return this._traversal(a,e)},traversalAll:function(a){var e=this.getLayerInfoArray(),k=this.getBasemapLayerInfoArray(),g=this.getTableInfoArray(),e=e.concat(k.concat(g));return this._traversal(a,e)},_traversalAllWithSpecialLayerInfo:function(a){return this._traversal(a,this._finalLayerInfos.concat(this._tableInfos))},getLayerInfoById:function(a){return this._findLayerInfoById(a)},getTableInfoById:function(a){var e=null;m.some(this.getTableInfoArray(),function(k){if(k.id===
a)return e=k,!0});return e},getLayerOrTableInfoById:function(a){var e=null;this.traversalAll(function(k){if(k.id===a)return e=k,!0});return e},getLayerInfoByTopLayerId:function(a){return this._findTopLayerInfoById(a)},moveUpLayer:function(a,k){var e=null;k=k?k:1;a=this._getTopLayerInfoIndexById(a.id);0<=a-k&&(e=this._finalLayerInfos[a-k].obtainLayerIndexesInMap().length,this._finalLayerInfos[a].moveLayerByIndex(this._finalLayerInfos[a-k].obtainLayerIndexesInMap()[e-1].index),e=this._finalLayerInfos[a-
k],w.publish("layerInfos/layerReorder",a,k,"moveup"));return e},_reorderLayerInfosArray:function(a,k,g){"moveup"===g?(g=this._finalLayerInfos[a],this._finalLayerInfos.splice(a,1),this._finalLayerInfos.splice(a-k,0,g)):(g=this._finalLayerInfos[a],this._finalLayerInfos.splice(a+k+1,0,g),this._finalLayerInfos.splice(a,1));this._markFirstOrLastNode();return g},moveDownLayer:function(a,k){var e=null;k=k?k:1;a=this._getTopLayerInfoIndexById(a.id);a+k<=this._finalLayerInfos.length-1&&(this._finalLayerInfos[a].moveLayerByIndex(this._finalLayerInfos[a+
k].obtainLayerIndexesInMap()[0].index),e=this._finalLayerInfos[a+k],w.publish("layerInfos/layerReorder",a,k,"movedown"));return e},getBasemapLayers:function(){var a=[];m.forEach(this.map.layerIds.concat(this.map.graphicsLayerIds||[]),function(e){e=this.map.getLayer(e);"basemap"!==e._basemapGalleryLayerType&&"reference"!==e._basemapGalleryLayerType||a.push(e)},this);return a.reverse()},getMapNotesLayerInfoArray:function(){return m.filter(this.getLayerInfoArray(),function(a){return a.isMapNotesLayerInfo()},
this)},restoreState:function(a){var e=a&&a.layerOptions?a.layerOptions:null;m.forEach(this._finalLayerInfos,function(a){a.resetLayerObjectVisibility(e)},this)},getUnreachableLayersTitle:function(){return this._unreachableLayersTitleOfWebmap},getObjectId:function(){return this._objectId},_initLayerInfos:function(){this._layerInfos=[];this._initSpecifiedLayerInfos(this._operLayers,this._layerInfos)},_initBasemapLayerInfos:function(){this._basemapLayerInfos=[];this._initSpecifiedLayerInfos(this._basemapLayers,
this._basemapLayerInfos)},_initSpecifiedLayerInfos:function(a,k){var e;m.forEach(a,function(a){try{e=this._layerInfoFactory.create(a),e.init()}catch(M){console.warn(M.message),e=null,this._unreachableLayersTitleOfWebmap.push(a.title)}e&&k.push(e)},this)},_extraSetLayerInfos:function(){this._removedLayerInfoIdsFromFeatureCollection=[];m.forEach(this._finalLayerInfos||this._layerInfos,function(a,k){var e;if(a._needToRenew()){try{e=this._layerInfoFactory.create(a.originOperLayer),e.init()}catch(M){console.warn(M.message),
e=null}e&&(a.destroy(),this._finalLayerInfos[k]=e)}else if(a.originOperLayer.featureCollection){var p=[];m.forEach(a.getSubLayers(),function(a){p.push(a.id)});m.forEach(p,function(e){this.map.getLayer(e)||a.removeSubLayerById(e)},this);1===a.getSubLayers().length&&(k=a.getSubLayers()[0],this.map.getLayer(k.id).title=a.title,a.removeSubLayerById(k.id),this._removedLayerInfoIdsFromFeatureCollection.push(k.id),a.id+="_logically_removed")}},this)},_refineFinalLayerInfos:function(){this._finalLayerInfos&&
(this._finalLayerInfos=m.filter(this._finalLayerInfos,function(a){return!a._flag._invalid}))},_initFinalLayerInfos:function(){var a,k,g=this._finalLayerInfos||this._layerInfos;this._finalLayerInfos=[];for(a=this.map.graphicsLayerIds.length-1;0<=a;a--)k=this.map.graphicsLayerIds[a],this._isBasemap(k)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(k,g),k,!0);for(a=this.map.layerIds.length-1;0<=a;a--)k=this.map.layerIds[a],this._isBasemap(k)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(k,
g),k,!1);this._refineFinalLayerInfos()},_initTablesInfos:function(){this._tableInfos=[];var a=this._tables&&this._tables.reverse();a&&this._addTables(a,this._tableInfos)},_initFinalBasemapLayerInfos:function(){var a=this._finalBasemapLayerInfos||this._basemapLayerInfos;this._finalBasemapLayerInfos=[];m.forEach(this.getBasemapLayers(),function(e){var k;m.some(a,function(a){if(a.id===e.id)return k=a,!0},this);this._addToFinalBasemapLayerInfos(k,e.id,!1)},this)},_isBasemap:function(a){for(var e=!1,k=
this.getBasemapLayers(),g=0;g<k.length;g++)k[g].id===a&&(e=!0);return e},_addToFinalBasemapLayerInfos:function(a,k,g){this._addToSpecifiedLayerInfos(a,k,g,this._finalBasemapLayerInfos)},_addToFinalLayerInfos:function(a,k,g){this._addToSpecifiedLayerInfos(a,k,g,this._finalLayerInfos)},_addToSpecifiedLayerInfos:function(a,k,g,n){var e;if(a)a._addedFlag||a.isGraphicLayer()!==g||(n.push(a),a._addedFlag=!0);else{a=this.map.getLayer(k);if("esri.layers.GraphicsLayer"!==a.declaredClass&&"esri.layers.LabelLayer"!==
a.declaredClass){try{var p={layerObject:a,title:this._getLayerTitle(a),id:a.id||" "};y.mixin(p,y.getObject("_wabProperties.originOperLayer",!1,a));e=this._layerInfoFactory.create(p,this.map);e.init()}catch(L){console.warn(L.message),e=null}e&&(y.getObject("_wabProperties.isTemporaryLayer",!1,a)&&(e._flag._isTemporaryLayerInfo=!0),n.push(e))}("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass)&&e&&e._getServiceDefinition().then(y.hitch(this,
function(a){var k=[];m.forEach(a.tables,function(a){a.url=e.getUrl()+"/"+a.id;a.id=e.id+"_"+a.id;a.title=this._getLayerTitle(a);k.push(a)},this);this._addTables(k,this._tableInfos)}))}},_getLayerTitle:function(a){if(a.title)return a.title;if(y.getObject("_wabProperties.originalLayerName",!1,a))return a.name||a.id;var e=a.label||a.name||"";if(a.url&&!y.getObject("_wabProperties.itemLayerInfo",!1,a)){var k;k=a.url.indexOf("/FeatureServer");-1===k&&(k=a.url.indexOf("/MapServer"));-1===k&&(k=a.url.indexOf("/service"));
-1<k&&(k=a.url.substring(0,k),k=k.substring(k.lastIndexOf("/")+1,k.length),e=e?k+" - "+e:k)}return e||a.id},_findLayerInfoByIdAndReturnTopLayer:function(a,k){var e,p=null;k||(k=this._finalLayerInfos);for(e=0;e<k.length;e++)if(p=k[e].findLayerInfoById(a)){p=k[e];break}return p},_findLayerInfoById:function(a,k){var e,p=null;k||(k=this._finalLayerInfos);for(e=0;e<k.length&&!(p=k[e].findLayerInfoById(a));e++);return p},_findTopLayerInfoById:function(a){var e,k=null,g=this._finalLayerInfos.concat(this._tableInfos);
for(e=0;e<g.length;e++)if(g[e].id===a){k=g[e];break}return k},_getTopLayerInfoIndexById:function(a){var e,k=-1;for(e=0;e<this._finalLayerInfos.length;e++)if(this._finalLayerInfos[e].id===a){k=e;break}return k},_clearAddedFlag:function(a){m.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;if(this._finalLayerInfos.length){for(a=0;a<this._finalLayerInfos.length;a++)this._finalLayerInfos[a].isFirst=!1,this._finalLayerInfos[a].isLast=!1;this._finalLayerInfos[0].isFirst=!0;
this._finalLayerInfos[this._finalLayerInfos.length-1].isLast=!0;for(a=0;a<this._finalLayerInfos.length;a++)if(!this._finalLayerInfos[a].isGraphicLayer()){a&&(this._finalLayerInfos[a-1].isLast=!0);this._finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(a,k,g){"BasemapGallery"===a&&(this._basemapLayers.length=0,m.forEach(g,y.hitch(this,function(a){this._basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},_onBasemapChange:function(a){var e;
for(e=this._basemapLayers.length=0;e<a.layers.length;e++)this._basemapLayers.push({layerObject:a.layer[e],id:a.layers[e].id})},_destroyLayerInfos:function(){m.forEach(this._finalLayerInfos,y.hitch(this,function(a){a.destroy()}))},_bindEvents:function(){var a,k,n,r,t,m,x,P,K,B,C;a=g(this.map,"layer-add-result",y.hitch(this,this._onLayersChange,A.ADDED));k=g(this.map,"layer-remove",y.hitch(this,this._onLayersChange,A.REMOVED));x=w.subscribe("layerInfos/layerReorder",y.hitch(this,this._onLayerReorder));
r=w.subscribe("layerInfos/layerInfo/isShowInMapChanged",y.hitch(this,this._onShowInMapChanged));t=w.subscribe("layerInfos/layerInfo/visibleChanged",y.hitch(this,this._onVisibleChanged));m=w.subscribe("layerInfos/layerInfo/filterChanged",y.hitch(this,this._onFilterChanged));P=w.subscribe("layerInfos/layerInfo/rendererChanged",y.hitch(this,this._onRendererChanged));K=w.subscribe("layerInfos/layerInfo/opacityChanged",y.hitch(this,this._onOpacityChanged));C=w.subscribe("layerInfos/layerInfo/scaleRangeChanged",
y.hitch(this,this._onScaleRangeChanged));B=w.subscribe("layerInfos/layerInfo/timeExtentChanged",y.hitch(this,this._onTimeExtentChanged));n=g(this.map,"before-unload",y.hitch(this,function(){a.remove();k.remove();x.remove();r.remove();t.remove();m.remove();P.remove();n.remove();K.remove();C.remove();B.remove();this._destroyLayerInfos()}))},_emitEvent:function(){try{this.emit.apply(this,arguments)}catch(e){console.warn(e)}},_emitEventForEveryLayerInfo:function(a,k,g){try{m.forEach(k,function(e){e.emitEvent(a,
g)},this)}catch(z){console.warn(z)}},_onLayersChange:function(a,k){var e=null,p;k.error||"esri.layers.GraphicsLayer"===k.layer.declaredClass||"esri.layers.LabelLayer"===k.layer.declaredClass||(a===A.ADDED?(this.update(),e=a=this._findLayerInfoById(k.layer.id,k.layer._basemapGalleryLayerType?this._finalBasemapLayerInfos:this._finalLayerInfos),p=A.ADDED,a&&!a.isRootLayer()&&(e=a.getRootLayerInfo(),p=A.SUBLAYER_ADDED)):(e=a=this._findLayerInfoById(k.layer.id,k.layer._basemapGalleryLayerType?this._finalBasemapLayerInfos:
this._finalLayerInfos),p=A.REMOVED,a&&!a.isRootLayer()&&(e=a.getRootLayerInfo(),p=A.SUBLAYER_REMOVED),a&&a.destroy(),this.update()),e&&(k.layer._basemapGalleryLayerType?(this._emitEvent("basemapLayersChanged"),this._emitEvent("basemapLayerInfosChanged",e,p,a)):this._emitEvent("layerInfosChanged",e,p,a)))},_onTableChange:function(a,k){this._emitEvent("tableInfosChanged",a,k,a)},_onLayersUpdated:function(a,k){a.isTable?this._emitEvent("tableInfosChanged",[a],A.UPDATED,[k]):this._emitEvent("layerInfosChanged",
a,A.UPDATED,k)},_onShowInMapChanged:function(a){this._emitEvent("layerInfosIsShowInMapChanged",a);this._emitEventForEveryLayerInfo("isShowInMapChanged",a)},_onVisibleChanged:function(a){this._emitEvent("layerInfosIsVisibleChanged",a);this._emitEventForEveryLayerInfo("isVisibleChanged",a)},_onFilterChanged:function(a,k){this._emitEvent("layerInfosFilterChanged",a,k);this._emitEventForEveryLayerInfo("filterChanged",a,k)},_onLayerReorder:function(a,k,g){a=this._reorderLayerInfosArray(a,k,g);this._emitEvent("layerInfosReorder",
a,A.REORDERED,a)},_onRendererChanged:function(a){this._emitEvent("layerInfosRendererChanged",a);this._emitEventForEveryLayerInfo("rendererChanged",a)},_onOpacityChanged:function(a){this._emitEvent("layerInfosOpacityChanged",a);this._emitEventForEveryLayerInfo("opacityChanged",a)},_onScaleRangeChanged:function(a){this._emitEvent("layerInfosScaleRangeChanged",a);this._emitEventForEveryLayerInfo("scaleRangeChanged",a)},_onTimeExtentChanged:function(a){this._emitEvent("layerInfosTimeExtentChanged",a);
this._emitEventForEveryLayerInfo("timeExtentChanged",a)}});A.getLayerInfoArrayByType=function(a,k){var e=new x,p=[],g=[];A.getInstance(a,a.iteminfo).then(function(a){a.traversal(function(a){var e=a.getLayerType();e.layerInfo=a;p.push(e)});r(p).then(function(a){m.forEach(a,function(a,e){k===a&&g.push(p[e].layerInfo)});e.resolve(g)})});return e};var a=null,k=null;A.getInstance=function(a,k){var e=new x;e.resolve(A.getInstanceSyncForInit(a,k));return e};A.getInstanceSyncForInit=function(e,p){a&&a!==
e&&(k=a=null);k||(k=new A(e,p.itemData),a=e);return k};A.getInstanceSync=function(){return k};A.setInstance=function(e,p){a=e;k=p};A.createInstance=function(a){var e=null;return e=new A(a,a.itemInfo.itemData)};y.mixin(A,{ADDED:"added",REMOVED:"removed",SUBLAYER_ADDED:"subLayerAdded",SUBLAYER_REMOVED:"subLayerRemoved",UPDATED:"updated",REORDERED:"reordered"});return A})},"jimu/LayerInfos/LayerInfoFactory":function(){define("dojo/_base/declare jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS jimu/LayerInfos/LayerInfoForDefaultTable jimu/LayerInfos/LayerInfoForDefaultImage jimu/LayerInfos/LayerInfoForDefaultStream jimu/LayerInfos/LayerInfoForDefaultKML".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p){return B(null,{constructor:function(a,e){this.map=a;this.layerInfos=e},create:function(u){var z=null;if(u.featureCollection)z=new m(u,this.map,this,this.layerInfos);else if("esri.layers.KMLLayer"===u.layerObject.declaredClass)z=new x(u,this.map,this,this.layerInfos);else if("esri.layers.GeoRSSLayer"===u.layerObject.declaredClass)z=new g(u,this.map,this,this.layerInfos);else if("esri.layers.WMSLayer"!==u.layerObject.declaredClass||u.selfType)if("esri.layers.ArcGISDynamicMapServiceLayer"===
u.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===u.layerObject.declaredClass)z=new y(u,this.map,this,this.layerInfos);else if("esri.layers.ArcGISImageServiceLayer"===u.layerObject.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===u.layerObject.declaredClass)z=new k(u,this.map,this,this.layerInfos);else if("esri.layers.StreamLayer"===u.layerObject.declaredClass)z=new e(u,this.map,this,this.layerInfos);else switch("Table"===u.layerObject.type&&(u.selfType="table"),
u.selfType){case "mapservice_dynamic_group":case "mapservice_dynamic":z=new r(u,this.map,this,this.layerInfos);break;case "mapservice_tiled_group":case "mapservice_tiled":z=new n(u,this.map,this,this.layerInfos);break;case "wms":z=new A(u,this.map,this,this.layerInfos);break;case "kml":z=new p(u,this.map,this,this.layerInfos);break;case "table":z=new a(u,this.map,this,this.layerInfos);break;default:z=new w(u,this.map,this,this.layerInfos)}else z=new t(u,this.map,this,this.layerInfos);return z}})})},
"jimu/LayerInfos/LayerInfoForCollection":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all esri/lang jimu/utils ./LayerInfo".split(" "),function(B,m,y,x,g,w,t){return B(t,{constructor:function(){this.layerObject={declaredClass:"esri.layers.FeatureCollection",type:"FeatureCollection",empty:!0}},_getExtent:function(){var g=null,n=[];m.forEach(this.getSubLayers(),function(g){n.push(g._getExtent())},this);return x(n).then(y.hitch(this,function(n){m.forEach(n,function(a){w.isValidExtent(a)&&
(g=g?g.union(a):a)},this);return g}))},_resetLayerObjectVisiblity:function(g){var n=g?g[this.id]:null;if(n){var r={},a;for(a in g)g.hasOwnProperty(a)&&"function"!==typeof g[a]&&(r[a]=g[a].visible);this._setSubLayerVisibleByCheckedInfo(r);this._setTopLayerVisible(n.visible)}},_setSubLayerVisibleByCheckedInfo:function(r){m.forEach(this.newSubLayers,function(n){g.isDefined(r[n.id])&&n.layerObject.setVisibility(r[n.id])},this)},_initVisible:function(){var g=!1,n;for(n=0;n<this.newSubLayers.length;n++)g=
g||this.newSubLayers[n].layerObject.visible;g&&(this._visible=!0)},_setTopLayerVisible:function(g){this._visible=g?!0:!1;m.forEach(this.newSubLayers,function(g){g.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var g=[];m.forEach(this.originOperLayer.featureCollection.layers,function(n){this._getLayerIndexesInMapByLayerId(n.layerObject.id)&&(y.setObject("_wabProperties.originOperLayer.showLegend",this.originOperLayer.featureCollection.showLegend,n.layerObject),
n=this._layerInfoFactory.create({layerObject:n.layerObject,title:n.layerObject.label||n.layerObject.title||n.layerObject.name||n.layerObject.id||" ",id:n.id||"-",subId:n.id||"-",collection:{layerInfo:this},selfType:"collection",showLegend:!0,parentLayerInfo:this}),g.push(n),n.init())},this);g.reverse();return g},_obtainLayerIndexesInMap:function(){var g=[],n,t;for(t=0;t<this.newSubLayers.length;t++)(n=this._getLayerIndexesInMapByLayerId(this.newSubLayers[t].layerObject.id))&&g.push(n);return g},moveLeftOfIndex:function(g){var n;
for(n=this.newSubLayers.length-1;0<=n;n--)this.map.reorderLayer(this.newSubLayers[n].layerObject,g)},moveRightOfIndex:function(g){var n;for(n=0;n<this.newSubLayers.length;n++)this.map.reorderLayer(this.newSubLayers[n].layerObject,g)},_getShowLegendOfWebmap:function(){return void 0!==this.originOperLayer.featureCollection.showLegend?this.originOperLayer.featureCollection.showLegend:!0},getOpacity:function(){var g,n=0;for(g=0;g<this.newSubLayers.length;g++)if(this.newSubLayers[g].layerObject.opacity)n=
this.newSubLayers[g].layerObject.opacity>n?this.newSubLayers[g].layerObject.opacity:n;else return 1;return n},setOpacity:function(g){m.forEach(this.newSubLayers,function(n){n.layerObject.setOpacity&&n.layerObject.setOpacity(g)})},getScaleRange:function(){var g=this.getSubLayers();return g[0]?g[0].getScaleRange():{minScale:0,maxScale:0}}})})},"jimu/LayerInfos/LayerInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/dom-construct dojo/topic dojo/aspect dojo/Evented dojo/request/script jimu/portalUrlUtils jimu/portalUtils jimu/LayerNode jimu/utils ./RequestBuffer esri/kernel esri/tasks/query esri/request".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I){var L=B([n],{declaredClass:"jimu.LayerInfo",originOperLayer:null,layerObject:null,map:null,title:null,id:null,subId:null,newSubLayers:null,parentLayerInfo:null,isTable:null,isTiled:null,_oldIsShowInMap:null,_oldFilter:null,_eventHandles:null,_subLayerInfoIndex:null,_serviceDefinitionBuffer:null,_flag:null,_objectId:null,_itemInfo:null,_adaptor:null,constructor:function(a,k,p,g){this.originOperLayer=a;this.layerObject=a.layerObject;this.map=k;this.title=
this.originOperLayer.title||this.originOperLayer.id||"";this.id=this.originOperLayer.id;this.subId=void 0!==this.originOperLayer.subId?this.originOperLayer.subId:this.id;this.parentLayerInfo=a.parentLayerInfo?a.parentLayerInfo:null;this.isTiled=this.isTable=!1;this._eventHandles=[];this._layerInfoFactory=p;this._layerInfos=g;this._flag={};this._objectId=Math.random();this._adaptor=new e(this)},init:function(){this.newSubLayers=this.obtainNewSubLayers();this._initSubLayerInfoIndex();this._initVisible();
this.originOperLayer.popupInfo&&(this.popupVisible=!0);this._oldIsShowInMap=this.isShowInMap();this._initOldFilter();this._initServiceDefinitionBuffer();this._bindEvent()},_initOldFilter:function(){this._oldFilter=null},_initServiceDefinitionBuffer:function(){this._serviceDefinitionBuffer=new u(y.hitch(this,this._serviceDefinitionRequest))},isGraphicLayer:function(){var a=this._obtainLayerIndexesInMap();return a.length?a[0].isGraphicLayer:!1},obtainLayerIndexesInMap:function(){return this._obtainLayerIndexesInMap()},
getObjectId:function(){return this._objectId},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},moveLayerByIndex:function(a){this.map.reorderLayer(this.layerObject,a)},traversal:function(a){if(a(this))return!0;for(var e=this.getSubLayers(),k=0;k<e.length;k++)if(e[k].traversal(a))return!0},findLayerInfoById:function(a){var e=null,k=0;if(this.id&&this.id===a)return this;for(k=0;k<this.newSubLayers.length&&
!(e=this.newSubLayers[k].findLayerInfoById(a));k++);return e},setTopLayerVisible:function(a){this._setTopLayerVisible(a)},_setTopLayerVisible:function(a){},_setSubLayerVisible:function(a,e){},setLayerVisiblefromTopLayer:function(){},_resetLayerObjectVisiblity:function(){},resetLayerObjectVisibility:function(a){var e=a?a[this.id]:null;this.isRootLayer()&&e&&this._resetLayerObjectVisiblity(a)},_initVisible:function(){},isVisible:function(){return this._visible?!0:!1},show:function(){this._setTopLayerVisible(!0)},
hide:function(){this._setTopLayerVisible(!1)},_obtainLayerIndexesInMap:function(){var a=[],e;(e=this._getLayerIndexesInMapByLayerId(this.id))&&a.push(e);return a},_getLayerIndexesInMapByLayerId:function(a){var e;for(e=0;e<this.map.graphicsLayerIds.length;e++)if(this.map.graphicsLayerIds[e]===a)return{isGraphicLayer:!0,index:e};for(e=0;e<this.map.layerIds.length;e++)if(this.map.layerIds[e]===a)return{isGraphicLayer:!1,index:e};return null},_isShowInMapChanged:function(){var a=!1,e=this.isShowInMap();
!1===e&&this.map.infoWindow.hide();this._oldIsShowInMap!==e&&(this._oldIsShowInMap=e,a=!0);return a},_isShowInMapChanged2:function(){var a=[];this.traversal(function(e){e._isShowInMapChanged()&&a.push(e)});t.publish("layerInfos/layerInfo/isShowInMapChanged",a)},_visibleChanged:function(){t.publish("layerInfos/layerInfo/visibleChanged",[this])},_initSubLayerInfoIndex:function(){var a={};this.isRootLayer()&&this.traversal(function(e){e.isRootLayer()||(a[e.subId]=e)});this._subLayerInfoIndex=a},_getLayerInfosObj:function(){return this._layerInfos},
obtainNewSubLayers:function(){return[]},createLegendsNode:function(){return w.create("div",{"class":"legends-div"})},drawLegends:function(a,e){},_getLayerTypesOfSupportTable:function(){return"FeatureLayer,CSVLayer,Table,ArcGISImageServiceLayer,StreamLayer,ArcGISImageServiceVectorLayer"},_getShowLegendOfWebmap:function(){return void 0!==this.originOperLayer.showLegend?this.originOperLayer.showLegend:!0},_needToRenew:function(){return!1},_getServiceDefinition:function(){var a=new x;a.resolve(null);
return a},_serviceDefinitionRequest:function(a){return this._normalRequest(a,{f:"json"},"json")},getServiceDefinition:function(){return this._getServiceDefinition()},_normalRequest:function(a,e,k){return I({url:a,content:e,handleAs:k,callbackParamName:"callback"})},getLayerObject:function(){var a=new x;this.layerObject?a.resolve(this.layerObject):a.resolve(null);return a},getLayerObjectTryUsingFeatureService:function(){return this.getLayerObject()},getSubLayers:function(){return this.newSubLayers},
isLeaf:function(){return 0===this.getSubLayers().length?!0:!1},isRootLayer:function(){return this.parentLayerInfo?!1:!0},getLayerLevel:function(){for(var a=0,e=this;e.parentLayerInfo;)a++,e=e.parentLayerInfo;return a},getRootLayerInfo:function(){for(var a=this;a.parentLayerInfo;)a=a.parentLayerInfo;return a},isShowInMap:function(){for(var a=!0,e=this;e;)a=a&&e.isVisible(),e=e.parentLayerInfo;return a},getLayerType:function(){var a=[null],e=new x;this.layerObject.declaredClass&&(a=this.layerObject.declaredClass.split("."));
e.resolve(a[a.length-1]);return e},getPopupInfo:function(){return this.originOperLayer.popupInfo},getPopupInfoFromLayerObject:function(){var a=this.getInfoTemplate(),e=null;a&&(e=a.info);return e},loadPopupInfo:function(){var a=new x;this.loadInfoTemplate().then(y.hitch(this,function(e){var k=null;e&&(k=e.info);a.resolve(k)}));return a},loadInfoTemplate:function(){var a=new x;a.resolve(null);return a},getInfoTemplate:function(){return null},getFilterOfWebmap:function(){return this.originOperLayer.layerDefinition?
this.originOperLayer.layerDefinition.definitionExpression:null},getFilter:function(){return null},setFilter:function(){},getShowLegendOfWebmap:function(){for(var a=this,e=!0;a;)e=e&&a._getShowLegendOfWebmap(),a=a.parentLayerInfo;return e},getUrl:function(){return this.layerObject.url||this.layerObject._url},hasLayerTypes:function(a){},getSupportTableInfo:function(){var a=new x,e={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},k=this.getLayerType(),p=this.getLayerObject();g({type:k,layerObject:p}).then(y.hitch(this,
function(k){var p=k.type;k=k.layerObject;e.layerType=p;0<=this._getLayerTypesOfSupportTable().indexOf(p)&&(e.isSupportedLayer=!0);if(!k)e.isSupportQuery=!1;else if(this.parentLayerInfo&&this.parentLayerInfo.isMapNotesLayerInfo())e.isSupportQuery=!1;else if(!k.url||k.capabilities&&k.capabilities.indexOf&&0<=k.capabilities.indexOf("Query"))e.isSupportQuery=!0;a.resolve(e)}),function(){a.resolve(e)});return a},getRelatedTableInfoArray:function(a){a=new x;a.resolve([]);return a},getRelatedRecords:function(a,
e){a=new x;a.resolve([]);return a},removeSubLayerById:function(a){var e=[];m.forEach(this.newSubLayers,function(k){k.id!==a?e.push(k):k.destroy()});this.newSubLayers=e},releaseResource:function(){m.forEach(this._eventHandles,function(a){a.remove()});this.destroyLabelLayer();this._adaptor&&this._adaptor.destroy()},destroy:function(){m.forEach(this.newSubLayers,function(a){a.destroy()});this.releaseResource();this.inherited(arguments)},update:function(){m.forEach(this.newSubLayers,function(a){a.destroy()});
this.releaseResource();this.init()},isMapNotesLayerInfo:function(){return this.originOperLayer.featureCollection&&0===this.id.indexOf("mapNotes_")&&"ArcGISFeatureLayer"===this.originOperLayer.layerType&&!this.map.getLayer(this.id)?!0:!1},_getExtent:function(){var a=new x;a.resolve(this.layerObject.fullExtent||this.layerObject.initialExtent);return a},getExtent:function(){var a=new x;this._getExtent().then(y.hitch(this,function(e){p.projectToMapSpatialReference(this.map,e).then(y.hitch(this,function(e){a.resolve(e)}),
y.hitch(this,function(){a.resolve(null)}))}),y.hitch(this,function(){a.resolve(null)}));return a},_requerySelectdFeatures:function(){var a=new x;this.getLayerObject().then(y.hitch(this,function(e){var k=[],p;if(e&&e.isEditable&&!e.isEditable()){p=e.objectIdField;var k=e.getSelectedFeatures(),g=e.on("update-end",y.hitch(this,function(){var n=new M,u=[];m.forEach(k,function(a){u.push(a.attributes[p])},this);n.objectIds=u;n.maxAllowableOffset=0;e.queryFeatures(n,y.hitch(this,function(e){m.forEach(e.features,
function(a){m.some(k,function(e){return e.attributes[p]===a.attributes[p]?(e.setGeometry(a.geometry),!0):!1})},this);a.resolve()}),y.hitch(this,function(){a.resolve()}));g&&g.remove&&g.remove()}))}}));return a},zoomTo:function(a){this._requerySelectdFeatures();return a?p.projectToMapSpatialReference(this.map,a).then(y.hitch(this,function(a){return this._zoomTo(a)})):this.getExtent().then(y.hitch(this,function(a){return this._zoomTo(a)}))},_zoomTo:function(a){if(p.isValidExtent(a)){a=y.clone(a);var e=
this.getLayerScaleRange(),k=e.minScale,e=e.maxScale;if(a.isSinglePoint){if(k=p.getTargetScale(this.map,3,k,e))a=p.adjustHeightToAspectRatio(this.map,a),a=p.getExtentForScale(a,this.map.width,k),this.map.setExtent(a)}else{a=p.adjustExtentToAspectRatio(this.map,a);var g=p.getScaleForExtent(a,this.map.width);0<k&&g>k?(k=p.getScaleForNextTileLevel(this.map,k,!0),a=p.adjustHeightToAspectRatio(this.map,a),a=p.getExtentForScale(a,this.map.width,k),this.map.setExtent(a)):g<e?(e=p.getScaleForNextTileLevel(this.map,
e,!1),a=p.adjustHeightToAspectRatio(this.map,a),a=p.getExtentForScale(a,this.map.width,e),this.map.setExtent(a)):this.map.setExtent(a,!0)}}},mergeScale:function(a,e,k,p){var g=0,n=0;0===a&&0<k?g=k:0<a&&0===k?g=a:0<a&&0<k&&(g=Math.min(a,k));n=Math.max(e,p);return{minScale:g,maxScale:n}},unionScale:function(a,e,k,p){var g=0,n=0,g=0===a||0===k?0:Math.max(a,k),n=Math.min(e,p);return{minScale:g,maxScale:n}},getScaleRange:function(){return this.layerObject&&0<=this.layerObject.minScale&&0<=this.layerObject.maxScale?
{minScale:this.layerObject.minScale,maxScale:this.layerObject.maxScale}:{minScale:0,maxScale:0}},setScaleRange:function(a,e){this.layerObject&&this.layerObject.setScaleRange&&this.layerObject.setScaleRange(a,e)},getLayerScaleRange:function(){var a,e=this.getScaleRange();this.traversal(y.hitch(this,function(e){e.id!==this.id&&(e=e.getScaleRange(),a=a?this.unionScale(a.minScale,a.maxScale,e.minScale,e.maxScale):e)}));return a?this.mergeScale(e.minScale,e.maxScale,a.minScale,a.maxScale):e},isCurrentScaleInTheScaleRange:function(){var a=
this.getScaleRange(),e=this.map.getScale();return 0===a.minScale&&0===a.maxScale?!0:(0===a.minScale||a.minScale>=e)&&(0===a.maxScale||e>=a.maxScale)?!0:!1},isInScale:function(){for(var a=!0,e=this;e&&(a=e.isCurrentScaleInTheScaleRange(),e=e.parentLayerInfo,a););return a},enablePopup:function(){},disablePopup:function(){},isPopupEnabled:function(){return!1},getCapabilitiesOfWebMap:function(){return this.originOperLayer.capabilities},isItemLayer:function(){return this._getBasicItemInfo()},isPublicService:function(){var e=
new x,k=this.getUrl()+"?f\x3djson";k?("https"===a.getProtocol(window.location.href)&&(k=a.setHttpsProtocol(k)),A.get(k,{jsonp:"callback"}).then(y.hitch(this,function(a){a&&a.error?e.resolve(!1):e.resolve(!0)}),y.hitch(this,function(){e.resolve(!1)}))):e.resolve(!0);return e},isEditable:function(){var a=!1,e=!0,p=k.getPortal(window.portalUrl),n=this.isPublicService(),u=new x,r=new x;p.getUser().then(y.hitch(this,function(a){r.resolve(a)}),y.hitch(this,function(){r.resolve(null)}));g({user:r,isPublicService:n}).then(y.hitch(this,
function(k){var p=k.user&&k.user.privileges;k=k.isPublicService;p&&-1===m.indexOf(p,"features:user:edit")&&z.id&&!k&&(e=!1);a=this.layerObject&&this.layerObject.isEditable?this.layerObject.isEditable()&&e?!0:!1:!1;u.resolve(a)}),y.hitch(this,function(){u.resolve(!1)}));return u},_getBasicItemInfo:function(){var e=null,k=this.getRootLayerInfo(),p=window.appConfig||window.getAppConfig(),g=y.getObject("_wabProperties.itemLayerInfo",!1,k.layerObject);k.originOperLayer.itemId?(e={},e.itemId=k.originOperLayer.itemId,
e.portalUrl=a.getStandardPortalUrl(p.map.portalUrl||p.portalUrl)):g&&g.portalUrl&&g.itemId&&(e={},e.itemId=g.itemId,e.portalUrl=a.getStandardPortalUrl(g.portalUrl));return e},getItemInfo:function(){var a=new x,e=this.getRootLayerInfo();e.isItemLayer()?(e._itemInfo||(e._itemInfo=new L.ItemInfo(this,e)),e._itemInfo.onLoad().then(y.hitch(this,function(){a.resolve(e._itemInfo)}),y.hitch(this,function(){a.resolve(null)}))):a.resolve(null);return a},isHostedService:function(){var a=new x;this._getServiceDefinition().then(y.hitch(this,
function(e){a.resolve(e&&e.serviceItemId?!0:!1)}));return a},isHostedLayer:function(){var a;this.isItemLayer()?a=this.isHostedService():(a=new x,a.resolve(!1));return a},obtainLabelControl:function(){},restoreLabelControl:function(){},destroyRealtedLabelLayer:function(){},destroyLabelLayer:function(){},canShowLabel:function(){},isShowLabels:function(){},showLabels:function(){},hideLabels:function(){},isBasemap:function(){return this.getRootLayerInfo().layerObject._basemapGalleryLayerType?!0:!1},emitEvent:function(){try{this.emit.apply(this,
arguments),this._adaptor&&this._adaptor.emitEvent.apply(this._adaptor,arguments)}catch(P){console.error(P)}},_bindEvent:function(){var a;this.layerObject&&!this.layerObject.empty&&(a=this.layerObject.on("visibility-change",y.hitch(this,this._onVisibilityChanged)),this._eventHandles.push(a),a=r.after(this.layerObject,"setDefinitionExpression",y.hitch(this,this._onFilterChanged)),this._eventHandles.push(a),a=r.after(this.layerObject,"setRenderer",y.hitch(this,this._onRendererChanged)),this._eventHandles.push(a),
this.isRootLayer()&&(a=this.layerObject.on("opacity-change",y.hitch(this,this._onOpacityChanged)),this._eventHandles.push(a)),a=this.layerObject.on("scale-range-change",y.hitch(this,this._onScaleRangeChanged)),this._eventHandles.push(a),this.isRootLayer()&&(a=this.map.on("time-extent-change",y.hitch(this,function(){this.layerObject&&this.layerObject.useMapTime&&this._onTimeExtentChanged()})),this._eventHandles.push(a)),this.isRootLayer()&&(a=r.after(this.layerObject,"setTimeDefinition",y.hitch(this,
function(){this.layerObject&&this.layerObject.timeInfo&&this.layerObject.mode===esri.layers.FeatureLayer.MODE_SNAPSHOT&&this._onTimeExtentChanged()})),this._eventHandles.push(a)))},_onVisibilityChanged:function(){this._initVisible();this._visibleChanged();this._isShowInMapChanged2()},_onFilterChanged:function(){var a=this._oldFilter?this._oldFilter:null,e=this.layerObject.getDefinitionExpression(),e=e?e:null;a!==e&&(t.publish("layerInfos/layerInfo/filterChanged",[this],y.getObject("_wabProperties.objectPassWithFilterChangeEvent",
!0,this.layerObject)),this._oldFilter=e,y.setObject("_wabProperties.objectPassWithFilterChangeEvent",{},this.layerObject))},_onRendererChanged:function(){t.publish("layerInfos/layerInfo/rendererChanged",[this])},_onOpacityChanged:function(){t.publish("layerInfos/layerInfo/opacityChanged",[this])},_onScaleRangeChanged:function(){t.publish("layerInfos/layerInfo/scaleRangeChanged",[this])},_onTimeExtentChanged:function(){var a=[],e=[];this.traversal(function(k){var p=k.getServiceDefinition().then(function(e){e&&
e.timeInfo&&a.push(k)});e.push(p)});g(e).then(y.hitch(this,function(){t.publish("layerInfos/layerInfo/timeExtentChanged",a)}))}});L.ItemInfo=B(null,{_currentLayerInfo:null,_rootLayerInfo:null,_portalUrl:null,_itemId:null,_item:null,_itemData:null,_serviceDefinition:null,_itemInfoLoadedDef:null,constructor:function(a,e){this._currentLayerInfo=a;this._rootLayerInfo=e;this._loadResource()},_loadResource:function(){this._itemInfoLoadedDef=new x;var a=this._rootLayerInfo.isItemLayer();if(a){this._portalUrl=
a.portalUrl;this._itemId=a.itemId;var e=k.getPortal(this._portalUrl),a=e.getItemById(this._itemId),e=e.getItemData(this._itemId),p=this._currentLayerInfo._getServiceDefinition();g({item:a,itemData:e,serviceDefinition:p}).then(y.hitch(this,function(a){this._item=a.item;this._itemData=a.itemData;this._serviceDefinition=a.serviceDefinition;this._itemInfoLoadedDef.resolve(this)}),y.hitch(this,function(a){a&&a.message&&console.log(a.message);this._itemInfoLoadedDef.reject()}))}else this._itemInfoLoadedDef.reject()},
onLoad:function(){return this._itemInfoLoadedDef},getPortalUrl:function(){return this._portalUrl},getItemId:function(){return this._itemId},getItem:function(){return this._item},getItemData:function(){return this._itemData},isHostedLayer:function(){return this._serviceDefinition&&this._serviceDefinition.serviceItemId?!0:!1}});return L})},"jimu/portalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic dojo/json dojo/request/xhr esri/request ./Role ./utils ./portalUrlUtils ./tokenUtils ./ServiceDefinitionManager".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p){var u=B([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,constructor:function(a){this.portalUrl=k.getStandardPortalUrl(a);this.selfUrl=k.getPortalSelfInfoUrl(a)},loadSelfInfo:function(){var a=this.selfUrl;this.isValidCredential()&&(a=-1<a.indexOf("?")?a+("\x26token\x3d"+this.credential.token):a+("?token\x3d"+this.credential.token));return p.getInstance().getServiceDefinition(a).then(m.hitch(this,function(a){var e=
a.user;delete a.user;m.mixin(this,a);a.user=e;return a}))},_checkCredential:function(){var a=e.isValidCredential(this.credential);a||this.clearCredentialAndUser();return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=e.getPortalCredential(this.portalUrl))},signIn:function(){var a=new g;this.updateCredential();this.isValidCredential()?setTimeout(m.hitch(this,function(){a.resolve(this.credential)}),
0):a=e.signInPortal(this.portalUrl);return a},haveSignIn:function(){return e.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var a=new g;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(m.hitch(this,function(){this.user.updateCredential();a.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(m.hitch(this,function(e){this.user=
e;a.resolve(this.user)}),m.hitch(this,function(e){console.error(e);a.reject(e)})):e.getUserIdByToken(this.credential.token,this.portalUrl).then(m.hitch(this,function(e){this.credential.userId=e;this._getUser(this.credential.userId).then(m.hitch(this,function(e){this.user=e;a.resolve(this.user)}),m.hitch(this,function(e){console.error(e);a.reject(e)}))}),m.hitch(this,function(e){console.error(e);a.reject(e)})):setTimeout(m.hitch(this,function(){a.reject("credential is null.")}),0);return a},queryItems:function(a){this.updateCredential();
var e=new g,p=k.getBaseSearchUrl(this.portalUrl),u={f:"json"};a&&(u=m.mixin(u,a));this.isValidCredential()&&(u.token=this.credential.token);u.sortField||u.sortOrder||(u.sortField="title",u.sortOrder="asc");n({url:p,handleAs:"json",content:u,callbackParamName:"callback"}).then(m.hitch(this,function(a){a.results=y.map(a.results,m.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new I(a)}));e.resolve(a)}),m.hitch(this,function(a){console.error(a);e.reject(a)}));
return e},getItemData:function(a){this.updateCredential();a={url:k.getItemDataUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};return n(a)},_getItemById:function(a,e){a={url:k.getItemUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};e&&(a.content.token=e);return n(a).then(m.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new I(a)}))},getItemById:function(a,e){this.updateCredential();
return this._getItemById(a).then(m.hitch(this,function(k){return e&&k.owner&&this.isValidCredential()&&this.credential&&this.credential.userId===k.owner?this._getItemById(a,this.credential.token):k}))},getAppById:function(a){var e=new g;this.updateCredential();this.isValidCredential()?(a=k.getAppIdUrl(this.portalUrl,a),e=n({url:a,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(m.hitch(this,function(){e.reject("token is null.")}),0);return e},queryGroups:function(a){this.updateCredential();
var e=new g,p=k.getBaseGroupUrl(this.portalUrl),u={f:"json"};a&&(u=m.mixin(u,a));this.isValidCredential()&&(u.token=this.credential.token);n({url:p,handleAs:"json",content:u,callbackParamName:"callback"}).then(m.hitch(this,function(a){a.results=y.map(a.results,m.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new M(a)}));e.resolve(a)}),m.hitch(this,function(a){console.error(a);e.reject(a)}));return e},registerApp:function(a,e,p){var u=new g;this.updateCredential();
if(this.isValidCredential())var r=this.credential&&this.credential.token,z=k.getOAuth2Url(this.portalUrl),u=n({url:z+"/registerApp",content:{itemId:a,appType:e,redirect_uris:t.stringify(p),token:r,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(m.hitch(this,function(){u.reject("token is null.")}),0);return u},createAndRegisterApp:function(a){var e=new g;this.updateCredential();this.isValidCredential()?this.getUser().then(m.hitch(this,function(k){k.addItem({title:"Web AppBuilder for ArcGIS",
type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(m.hitch(this,function(k){k.success?this.registerApp(k.id,"browser",a).then(m.hitch(this,function(a){e.resolve(a)}),m.hitch(this,function(a){console.error(a);e.reject(a)})):e.reject("create app failed")}),m.hitch(this,function(a){console.error(a);e.reject(a)}))}),m.hitch(this,function(a){console.error(a);e.reject(a)})):setTimeout(m.hitch(this,function(){e.reject("token is null.")}),0);return e},_getUser:function(a){this.updateCredential();
var e=new g;a={url:k.getUserUrl(this.portalUrl,a),content:{f:"json"},handleAs:"json",callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential&&this.credential.token);n(a).then(m.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;this.user=new z(a);e.resolve(this.user)}),m.hitch(this,function(a){console.error(a);e.reject(a)}));return e}}),z=B([],{declaredClass:"jimu.PortalUser",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&
m.mixin(this,a)},_checkCredential:function(){var a=e.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},canCreateItem:function(){var a=new A({id:this.roleId?this.roleId:this.role,role:this.role});this.privileges&&a.setPrivileges(this.privileges);return a.canCreateItem()},
getGroups:function(){var a=[];this.groups&&(a=y.map(this.groups,m.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this.portal;return new M(a)})));return a},getItemsByKeywords:function(a,e){return this.portal.queryItems({start:e||1,num:100,q:"owner:"+this.username+' AND typekeywords:"'+a+'"'})},getContent:function(){this.updateCredential();var a={url:k.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};
this.isValidCredential&&(a.content.token=this.credential.token);return n(a)},getTags:function(){this.updateCredential();var a={url:k.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return n(a)},addItem:function(a,e){this.updateCredential();var p=new g;if(this.isValidCredential()){var u={f:"json",token:this.credential.token};a&&(u=m.mixin(u,a));n({url:k.getAddItemUrl(this.portalUrl,
this.username,e),handleAs:"json",callbackParamName:"callback",content:u},{usePost:!0}).then(m.hitch(this,function(a){p.resolve(a)}),m.hitch(this,function(a){console.error(a);p.reject(a)}))}else setTimeout(m.hitch(this,function(){p.reject("token is null.")}),0);return p},deleteItem:function(a){this.updateCredential();var e=new g;this.isValidCredential()?(a=k.getDeleteItemUrl(this.portalUrl,this.username,a),e=n({url:a,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(m.hitch(this,
function(){e.reject("token is null.")}),0);return e},getItemById:function(a,e){this.updateCredential();var p=new g;a={url:k.getUserItemsUrl(this.portalUrl,this.username,e)+"/"+a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};n(a).then(m.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new I(a);p.resolve(a)}),m.hitch(this,function(a){console.error(a);p.reject(a)}));return p},shareItem:function(a,e,p){this.updateCredential();var u=new g;
this.isValidCredential()?(e={url:k.shareItemUrl(this.portalUrl,this.username,e,p),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},a&&(e.content=m.mixin(e.content,a)),n(e,{usePost:!0}).then(m.hitch(this,function(a){u.resolve(a)}),m.hitch(this,function(a){console.error(a);u.reject(a)}))):setTimeout(m.hitch(this,function(){u.reject("token is null.")}),0);return u},updateItem:function(a,e){this.updateCredential();var p=new g;this.isValidCredential()?this.portal.getItemById(a).then(m.hitch(this,
function(g){var u={f:"json",token:this.credential.token};e&&(u=m.mixin(u,e));n({url:k.getUpdateItemUrl(this.portalUrl,g.owner,a,g.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:u},{usePost:!0}).then(m.hitch(this,function(a){p.resolve(a)}),m.hitch(this,function(a){console.error(a);p.reject(a)}))}),m.hitch(this,function(a){console.error(a);p.reject(a)})):setTimeout(m.hitch(this,function(){p.reject("token is null.")}),0);return p},isAdminRole:function(){return"org_admin"===
this.role||"account_admin"===this.role},isPublisherRole:function(){return"org_publisher"===this.role||"account_publisher"===this.role},isUserRole:function(){return"org_user"===this.role||"account_user"===this.role},getRegisteredAppInfo:function(a,e){var p=new g;this.updateCredential();e=k.getUserItemsUrl(this.portalUrl,this.username,e);return p=n({url:e+"/"+a+"/registeredAppInfo",content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})},getRegisteredAppInfoWithXhr:function(a,
e){var p=new g;this.updateCredential();e=k.getUserItemsUrl(this.portalUrl,this.username,e);return p=r(e+"/"+a+"/registeredAppInfo",{data:{token:this.credential.token,f:"json"},method:"POST",handleAs:"json"})}}),M=B([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&m.mixin(this,a)},_checkCredential:function(){var a=e.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},
updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),I=B([],{declaredClass:"jimu.PortalItem",itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,portal:null,token:null,constructor:function(a){a&&m.mixin(this,a);this.itemUrl=k.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&this.thumbnail&&this.itemUrl&&
(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=k.getItemDetailsPageUrl(this.portalUrl,this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=k.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=e.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();
return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)},getItemGroups:function(){this.updateCredential();var a={url:k.getItemGroupsUrl(this.portalUrl,this.id),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return n(a)}}),L={portals:[],webMapQueryStr:" "+
a.getItemQueryStringByTypes(["Web Map"])+" ",webSceneQueryStr:" "+a.getItemQueryStringByTypes(["Web Scene"])+" ",_findPortal:function(a){for(var e=0;e<this.portals.length;e++){var p=this.portals[e];if(k.isSamePortalUrl(a,p.portalUrl))return p.updateCredential(),p}return null},getPortal:function(a){if(!a||"string"!==typeof a||!m.trim(a))return null;a=k.getStandardPortalUrl(a);var p=this._findPortal(a);p||(p=new u(a),p.credential=e.getPortalCredential(p.portalUrl),p.updateCredential(),this.portals.push(p));
return p},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var e="english",k="",p=new g;this.getPortal(a).getUser().then(m.hitch(this,function(a){a&&a.units?e=a.units:(k=x.locale,e=k.startWith("en")?"english":"metric");p.resolve(e)}),m.hitch(this,function(g){console.warn(g);
this.getPortalSelfInfo(a).then(m.hitch(this,function(a){var e=null;a&&a.units?e=a.units:(k=a&&a.culture||x.locale,e=k.startWith("en")?"english":"metric");p.resolve(e)}),m.hitch(this,function(a){console.warn(a);k=x.locale;e=k.startWith("en")?"english":"metric";p.resolve(e)}))}));return p.promise},_getPortalSelfGroup:function(a,e){var k=new g,p=this.getPortal(a);p||setTimeout(m.hitch(this,function(){k.reject()}),0);this.getPortalSelfInfo(a).then(m.hitch(this,function(a){p.queryGroups({f:"json",q:a[e]}).then(m.hitch(this,
function(a){0<a.results.length?(a=a.results[0],a.portalUrl=p.portalUrl,a.credential=p.credential,a.portal=p,a=new M(a),k.resolve(a)):k.reject("Can't find portal self group.")}),m.hitch(this,function(a){console.error(a);k.reject(a)}))}),m.hitch(this,function(a){console.error(a);k.reject(a)}));return k},getWebMapsFromBasemapGalleryGroup:function(a){var e=new g;this.getBasemapGalleryGroup(a).then(m.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(m.hitch(this,
function(a){e.resolve(a)}),m.hitch(this,function(a){console.error(a);e.reject(a)})):e.reject()}),m.hitch(this,function(a){console.error(a);e.reject(a)}));return e},getDefaultWebScene:function(a){var e=k.getStandardPortalUrl(a);return this._searchWABDefaultWebScene(e).then(m.hitch(this,function(a){return a?a:this._createWABDefaultWebScene(e).then(m.hitch(this,function(a){return this.getPortal(e).getUser().then(m.hitch(this,function(e){var k=!1;e&&e.privileges&&0<e.privileges.length&&(k=y.some(e.privileges,
function(a){return 0<=a.indexOf("shareToPublic")}));return k?e.shareItem({everyone:!0},a).then(m.hitch(this,function(){return a}),m.hitch(this,function(){return a})):a}),m.hitch(this,function(e){console.error(e);return a}))}))}))},_searchWABDefaultWebScene:function(a){var e=new g;a=k.getStandardPortalUrl(a);a=this.getPortal(a);a.queryItems({q:'typekeywords:"WABDefaultWebScene" orgid:'+a.user.orgId+" access:public "+this.webSceneQueryStr}).then(m.hitch(this,function(a){a&&a.results&&0<a.results.length?
e.resolve(a.results[0].id):e.resolve(null)}),m.hitch(this,function(a){console.error("_searchWABDefaultWebScene error:",a);e.reject(a)}));return e},_createWABDefaultWebScene:function(a){var e=new g;a=k.getStandardPortalUrl(a);this.getPortal(a).getUser().then(m.hitch(this,function(a){var k={title:"Default Web Scene",type:"Web Scene",typeKeywords:"WABDefaultWebScene",tags:"default",text:t.stringify({operationalLayers:[],baseMap:{id:"basemap",title:"Topographic",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",
id:"worldTopoBase",layerType:"ArcGISTiledMapServiceLayer",title:"Topo"}],elevationLayers:[{url:"https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",id:"globalElevation",listMode:"hide",layerType:"ArcGISTiledElevationServiceLayer",title:"Elevation"}]},ground:{layers:[{url:"https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",id:"globalElevation",listMode:"hide",layerType:"ArcGISTiledElevationServiceLayer",title:"Elevation"}]},
viewingMode:"global",spatialReference:{latestWkid:3857,wkid:102100},version:"1.13",authoringApp:"WebAppBuilder",authoringAppVersion:"2.11"}),snippet:""};a.addItem(k,"").then(m.hitch(this,function(a){a.success?e.resolve(a.id):(console.error("Can't create default web scene:",a),e.reject())}))}),m.hitch(this,function(a){console.error("Can't create default web scene");e.reject(a)}));return e},getDefaultWebMap:function(a){var e=new g;this.getPortalSelfInfo(a).then(m.hitch(this,function(k){var p=k.defaultBasemap&&
k.defaultBasemap.id;p?e.resolve(p):this._getDefaultWebMapByBasemapGallery(a,k).then(m.hitch(this,function(k){k?e.resolve(k):this._getMostNumViewsWebMap(a).then(m.hitch(this,function(a){a?e.resolve(a):e.reject()}),m.hitch(this,function(a){console.error(a);e.reject(a)}))}),m.hitch(this,function(a){console.error(a);e.reject(a)}))}),m.hitch(this,function(a){console.error(a);e.reject(a)}));return e},_getDefaultWebMapByBasemapGallery:function(a,e){var k=new g,p=this.getPortal(a),n=e.defaultBasemap&&e.defaultBasemap.title;
p.queryGroups({f:"json",q:e.basemapGalleryGroupQuery}).then(m.hitch(this,function(a){a=a.results;0<a.length?p.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+a[0].id+" AND title:"+n}).then(m.hitch(this,function(a){a=a.results;a=y.filter(a,m.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?k.resolve(a[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),p.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+
n}).then(m.hitch(this,function(a){a=a.results;a=y.filter(a,m.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));if(0<a.length){var e=a[0];p.getItemData(e.id).then(m.hitch(this,function(a){a&&(a.operationalLayers||a.baseMap||a.version)?k.resolve(e.id):k.resolve(null)}),m.hitch(this,function(){k.resolve(null)}))}else console.log("Can't find web map by defaultBasemap.title."),k.resolve(null)}),m.hitch(this,function(a){console.error(a);k.reject(a)})))}),m.hitch(this,function(a){console.error(a);
k.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),k.resolve(null))}),m.hitch(this,function(a){console.error(a);k.reject(a)}));return k},_getMostNumViewsWebMap:function(a){var e=new g;this.getPortal(a).queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND access:public AND owner:esri_en",sortField:"numViews",sortOrder:"desc"}).then(m.hitch(this,function(a){a=a.results;a=y.filter(a,m.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?
e.resolve(a[0].id):e.reject("Can't find most-num-views web map.")}),m.hitch(this,function(a){console.error(a);e.reject(a)}));return e},comparePortalVersion:function(a,e){var k=a.split(".");a=parseInt(k[0],10);var k=1<k.length?parseInt(k[1],10):0,p=e.split(".");e=parseInt(p[0],10);p=1<p.length?parseInt(p[1],10):0;return a>e?1:a<e?-1:k>p?1:k<p?-1:0},getItemResources:function(a,e,p){p||(p=100);a=k.getStandardPortalUrl(a);a=k.getItemResourceUrl(a,e);return n({url:a,content:{f:"json",num:p}}).then(function(a){if(a&&
a.resources)return a.resources})},addResource:function(a,e,p,g,u){a=k.getStandardPortalUrl(a);var r=this.getPortal(a),z=new FormData;z.append("file",p,g);z.append("fileName",g);z.append("f","json");var t="";u?(z.append("resourcesPrefix",u),t=u+"/"+g):t=g;return r.getItemById(e,!0).then(function(p){p=k.getUserContentItemUrl(a,p.owner,e);return n({url:p+"/addResources",form:z}).then(function(e){var p="";e&&e.success&&(p=k.getItemResourceUrl(a,"${itemId}",t));return p},function(a){console.error(a.message||
a);return a})})},removeResources:function(a,e,p,g){var u={resource:g?g+"/"+p:p,f:"json"};a=k.getStandardPortalUrl(a);return this.getPortal(a).getItemById(e,!0).then(function(p){p=k.getUserContentItemUrl(a,p.owner,e);return n({url:p+"/removeResources",content:u},{usePost:!0}).then(function(a){return a},function(a){console.error(a.message||a);return a})})}};w.subscribe("userSignOut",function(a){(a=L._findPortal(a))&&a.clearCredentialAndUser()});return L})},"jimu/Role":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo/json","esri/lang"],function(B,m,y,x,g){return B(null,{id:null,baseRole:null,name:null,description:null,privileges:[],privilegeObj:null,constructor:function(g){g=g||{};this.id=g.id;this.baseRole=g.role;this.name=g.name;this.description=g.description},_initPrivilegesObject:function(){this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,
assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,
demographics:!1,elevation:!1}},marketplace:{admin:{manage:!1,purchase:!1,startTrial:!1}}}},_readPrivileges:function(w){g.isDefined(w)&&w instanceof Array&&y.forEach(w,m.hitch(this,function(g){this._readPrivilege(g)}))},_readPrivilege:function(g){this._applyEffectToAction(!0,g)},_applyEffectToAction:function(g,t){switch(t){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=g;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=g;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=
g;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=g;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=g;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=g;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=g;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=g;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=
g;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=g;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=g;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=g;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=g;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=g;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=
g;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=g;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=g;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=g;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=g;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=g;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=
g;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=g;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=g;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=g;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=g;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=g;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=g;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=
g;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=g;break;case "features:user:edit":this.privilegeObj.features.user.edit=g;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=g;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=g;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=g;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=g;
break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=g;break;case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=g;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=g;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=g;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=g;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=
g;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=g;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=g}},_applyToAll:function(g){this.privilegeObj.portal.admin.inviteUsers=g;this.privilegeObj.portal.admin.disableUsers=g;this.privilegeObj.portal.admin.viewUsers=g;this.privilegeObj.portal.admin.updateUsers=g;this.privilegeObj.portal.admin.deleteUsers=g;this.privilegeObj.portal.admin.changeUserRoles=g;this.privilegeObj.portal.admin.viewGroups=
g;this.privilegeObj.portal.admin.updateGroups=g;this.privilegeObj.portal.admin.deleteGroups=g;this.privilegeObj.portal.admin.reassignGroups=g;this.privilegeObj.portal.admin.assignToGroups=g;this.privilegeObj.portal.admin.manageEnterpriseGroups=g;this.privilegeObj.portal.admin.viewItems=g;this.privilegeObj.portal.admin.updateItems=g;this.privilegeObj.portal.admin.deleteItems=g;this.privilegeObj.portal.admin.reassignItems=g;this.privilegeObj.portal.admin.manageLicenses=g;this.privilegeObj.portal.publisher.publishFeatures=
g;this.privilegeObj.portal.publisher.publishTiles=g;this.privilegeObj.portal.publisher.publishScenes=g;this.privilegeObj.portal.user.createGroup=g;this.privilegeObj.portal.user.joinGroup=g;this.privilegeObj.portal.user.joinNonOrgGroup=g;this.privilegeObj.portal.user.createItem=g;this.privilegeObj.portal.user.shareToGroup=g;this.privilegeObj.portal.user.shareToOrg=g;this.privilegeObj.portal.user.shareToPublic=g;this.privilegeObj.portal.user.shareGroupToOrg=g;this.privilegeObj.portal.user.shareGroupToPublic=
g;this.privilegeObj.features.user.edit=g;this.privilegeObj.opendata.user.openDataAdmin=g;this.privilegeObj.opendata.user.designateGroup=g;this.privilegeObj.premium.user.geocode=g;this.privilegeObj.premium.user.networkanalysis=g;this.privilegeObj.premium.user.spatialanalysis=g;this.privilegeObj.premium.user.geoenrichment=g;this.privilegeObj.premium.user.demographics=g;this.privilegeObj.premium.user.elevation=g;this.privilegeObj.marketplace.admin.purchase=g;this.privilegeObj.marketplace.admin.manage=
g;this.privilegeObj.marketplace.admin.startTrial=g},_buildPrivilegesArray:function(){var g=[];!0===this.privilegeObj.portal.admin.inviteUsers&&g.push("portal:admin:inviteUsers");!0===this.privilegeObj.portal.admin.disableUsers&&g.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&g.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&g.push("portal:admin:updateUsers");!0===this.privilegeObj.portal.admin.deleteUsers&&g.push("portal:admin:deleteUsers");
!0===this.privilegeObj.portal.admin.changeUserRoles&&g.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&g.push("portal:admin:viewGroups");!0===this.privilegeObj.portal.admin.updateGroups&&g.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&g.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&g.push("portal:admin:reassignGroups");!0===this.privilegeObj.portal.admin.assignToGroups&&g.push("portal:admin:assignToGroups");
!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&g.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&g.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&g.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&g.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&g.push("portal:admin:reassignItems");!0===this.privilegeObj.portal.admin.manageLicenses&&g.push("portal:admin:manageLicenses");
!0===this.privilegeObj.portal.publisher.publishFeatures&&g.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&g.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&g.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.user.createGroup&&g.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&g.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&
g.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&g.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&g.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&g.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&g.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&g.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&
g.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.features.user.edit&&g.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&g.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&g.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&g.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&g.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&
g.push("premium:user:networkanalysis");!0===this.privilegeObj.premium.user.spatialanalysis&&g.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&g.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&g.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&g.push("premium:user:elevation");!0===this.privilegeObj.marketplace.admin.purchase&&g.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&
g.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&g.push("marketplace:admin:startTrial");return g},isUser:function(){return g.isDefined(this.id)&&("org_user"===this.id||"account_user"===this.id)},isPublisher:function(){return g.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)},isAdmin:function(){return g.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)},isBasedOnUser:function(){return this.isUser()||g.isDefined(this.baseRole)&&
("org_user"===this.baseRole||"account_user"===this.baseRole)},isBasedOnPublisher:function(){return this.isPublisher()||g.isDefined(this.baseRole)&&("org_publisher"===this.baseRole||"account_publisher"===this.baseRole)},isBasedOnAdmin:function(){return this.isAdmin()||g.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)},isCustom:function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&g.isDefined(this.id)&&0<this.id.length},canInviteUsers:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.inviteUsers},canDisableUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers},canViewUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers},canUpdateUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers},canDeleteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers},canChangeUserRoles:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles},
canViewOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups},canUpdateOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateGroups},canDeleteOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups},canReassignOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups},canAssignUsersToOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups},
canManageEnterpriseGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups},canViewOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewItems},canUpdateOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems},canDeleteOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems},canReassignOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems},
canManageLicenses:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses},canCreateGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup},canJoinOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup},canJoinNonOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup},canPublishFeatures:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures},
canPublishTiles:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles},canPublishScenes:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes},canCreateItem:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem},canShareItemToGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup},canShareItemToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg},canShareItemToPublic:function(){return this.privilegeObj&&
this.privilegeObj.portal.user.shareToPublic},canShareGroupToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg},canShareGroupToPublic:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToPublic},canEditFeatures:function(){return this.privilegeObj&&this.privilegeObj.features.user.edit},canEditFeaturesFullControl:function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit},canManageOpenData:function(){return this.privilegeObj&&
this.privilegeObj.opendata.user.openDataAdmin},canDesignateOpenDataGroups:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup},canUseGeocode:function(){return this.privilegeObj&&this.privilegeObj.premium.user.geocode},canUseNetworkAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis},canUseSpatialAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis},canUseGeoenrichment:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.geoenrichment},canUseDemographics:function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics},canUseElevation:function(){return this.privilegeObj&&this.privilegeObj.premium.user.elevation},canPurchaseMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase},canManageMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage},canTrialMarketplace:function(){return this.privilegeObj&&
this.privilegeObj.marketplace.admin.startTrial},setPrivileges:function(m){this.privileges=m;this._initPrivilegesObject();g.isDefined(m)&&this._readPrivileges(m)},stringify:function(){return x.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})},stringifyRole:function(){return x.stringify({id:this.id,name:this.name,description:this.description})},stringifyPrivileges:function(){return x.stringify({privileges:this._buildPrivilegesArray()})},stringifyPretty:function(){return x.stringify({id:this.id,
name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")}})})},"jimu/ServiceDefinitionManager":function(){define(["dojo/_base/declare","esri/request"],function(B,m){var y=null,x=B(null,{cache:{},getServiceDefinition:function(g,w){w||(w="json");var t=this.cache[g];0>=this._getDefStatus(t)&&(t=m({url:g,handleAs:w,content:{f:w},callbackParamName:"callback"}),this.cache[g]=t);return t},_getDefStatus:function(g){return g?g.isFulfilled()?g.isResolved()?2:-1:1:0}});
x.getInstance=function(){y||(y=new x,window._serviceDefinitionManager=y);return y};return x})},"jimu/LayerNode":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Deferred","dojo/Evented"],function(B,m,y,x,g){var w=B([g],{declaredClass:"jimu.LayerNode",_layerInfo:null,map:null,title:null,id:null,subId:null,layerObject:null,constructor:function(g){this._layerInfo=g;this.map=g.map;this.title=g.title;this.id=g.id;this.subId=g.subId},isLeaf:function(){return this._layerInfo.isLeaf()},
isRoot:function(){return this._layerInfo.isRootLayer()},toggle:function(){this._layerInfo.setTopLayerVisible(!this.isToggledOn())},isToggledOn:function(){return this._layerInfo.isVisible()},show:function(){this._layerInfo.show()},hide:function(){this._layerInfo.hide()},isVisible:function(){return this._layerInfo.isShowInMap()},traversal:function(g){return this._layerInfo.traversal(function(r){return g(r._adaptor)})},getNodeById:function(g){var r=null;if(g=this._layerInfo.findLayerInfoById(g))r=g._adaptor;
return r},getExtent:function(){return this._layerInfo.getExtent()},getOpacity:function(){return this._layerInfo.getOpacity()},setOpacity:function(g){this._layerInfo.setOpacity(g)},getServiceDefinition:function(){return this._layerInfo.getServiceDefinition()},getLayerObject:function(){return this._layerInfo.getLayerObject()},getRootNode:function(){return this._layerInfo.getRootLayerInfo()._adaptor},getParentNode:function(){var g=this._layerInfo.parentLayerInfo;return g?g._adaptor:null},getSubNodes:function(){return this._getNodesArrayFromInfosArray(this._layerInfo.getSubLayers())},
getNodeLevel:function(){return this._layerInfo.getLayerLevel()},getLayerType:function(){return this._layerInfo.getLayerType()},getPopupInfoFromWebmap:function(){return this._layerInfo.getPopupInfo()},getPopupInfo:function(){return this._layerInfo.getPopupInfoFromLayerObject()},loadPopupInfo:function(){return this._layerInfo.loadPopupInfo()},getInfoTemplate:function(){return this._layerInfo.getInfoTemplate()},loadInfoTemplate:function(){return this._layerInfo.loadInfoTemplate()},getFilterFromWebmap:function(){return this._layerInfo.getFilterOfWebmap()},
getFilter:function(){return this._layerInfo.getFilter()},setFilter:function(g){this._layerInfo.setFilter(g)},isShowLegend:function(){return this.isShowLegendFromWebmap()},isShowLegendFromWebmap:function(){return this._layerInfo.getShowLegendOfWebmap()},isToggledOnLegendFromWebMap:function(){return this._layerInfo._getShowLegendOfWebmap()},getUrl:function(){return this._layerInfo.getUrl()},getRelatedNodes:function(){var g=new x;this._layerInfo.getRelatedTableInfoArray().then(y.hitch(this,function(r){g.resolve(this._getNodesArrayFromInfosArray(r))}));
return g},isVisibleAtMapScale:function(){return this._layerInfo.isInScale()},enablePopup:function(){return this._layerInfo.enablePopup()},disablePopup:function(){return this._layerInfo.disablePopup()},isPopupEnabled:function(){return this._layerInfo.isPopupEnabled()},isItemLayer:function(){return this._layerInfo.isItemLayer()},getItemInfo:function(){return this._layerInfo.getItemInfo()},isHostedService:function(){return this._layerInfo.isHostedService()},isHostedLayer:function(){return this._layerInfo.isHostedLayer()},
canShowLabel:function(){return this._layerInfo.canShowLabel()},isLabelVisble:function(){return this._layerInfo.isShowLabels()},showLabel:function(){this._layerInfo.showLabels()},hideLabel:function(){this._layerInfo.hideLabels()},isTable:function(){return!!this._layerInfo.isTable},isTiled:function(){return!!this._layerInfo.isTiled},isBasemap:function(){return this._layerInfo.isBasemap()},isEditable:function(g){return this._layerInfo.isEditable(g)},zoomTo:function(g){return this._layerInfo.zoomTo(g)},
emitEvent:function(g){try{var r=null;switch(g){case "isVisibleChanged":r=w.EVENT_TOOGLE_CHANGE;break;case "isShowInMapChanged":r=w.EVENT_VISIBILITY_CHANGE;break;case "filterChanged":r=w.EVENT_FILTER_CHANGE;break;case "rendererChanged":r=w.EVENT_RENDERER_CHANGE;break;case "opacityChanged":r=w.EVENT_OPACITY_CHANGE;break;case "timeExtentChanged":r=w.EVENT_TIME_EXTENT_CHANGE}r&&this.emit(r)}catch(n){console.error(n)}},destroy:function(){this.inherited(arguments)},_getNodesArrayFromInfosArray:function(g){var r=
[];m.forEach(g,function(g){r.push(g._adaptor)},this);return r}});y.mixin(w,{EVENT_TOOGLE_CHANGE:"toggle-change",EVENT_VISIBILITY_CHANGE:"visibility-change",EVENT_FILTER_CHANGE:"filter-change",EVENT_RENDERER_CHANGE:"renderer-change",EVENT_OPACITY_CHANGE:"opacity-change",EVENT_TIME_EXTENT_CHANGE:"time-extent-change"});return w})},"jimu/LayerInfos/RequestBuffer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(B,m,y){var x=B(null,{_realRequest:null,_buffer:null,constructor:function(g){this._buffer=
{};this._realRequest=g?g:function(){return new y}},getRequest:function(g){this._buffer[g]||(this._buffer[g]=new x.RequestProxy(this._realRequest,g));return this._buffer[g]},request:function(g){var m=Array.prototype.slice.apply(arguments);m.splice(0,1);var t=this.getRequest(g);return t.request.apply(t,m)},setResponse:function(g,m){this.getRequest(g).setResponse(m)},isResolved:function(g){return this.getRequest(g).isResolved()}});x.RequestProxy=B(null,{_key:null,_deferred:null,_realRequest:null,constructor:function(g,
m){this._realRequest=g;this._key=m},request:function(){this._deferred||(this._deferred=new y,this._realRequest.apply(null,arguments).then(m.hitch(this,function(g){this._deferred.resolve(g)}),m.hitch(this,function(g){g&&console.warn(g.message||g);g=this._deferred;this._deferred=null;g.resolve(null)})));return this._deferred},fakeRequest:function(){this._deferred||(this._deferred=new y);return this._deferred},setResponse:function(g,m){this._deferred||(this._deferred=new y);null===g||void 0===g?(this._deferred.resolve(null),
m&&(this._deferred=null)):this._deferred.resolve(g)},isResolved:function(){return this._deferred&&this._deferred.isResolved()}});return x})},"jimu/LayerInfos/LayerInfoForMapService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/json dojo/aspect dojo/topic ./LayerInfo esri/request esri/lang".split(" "),function(B,m,y,x,g,w,t,r,n,A){return B(r,{_legendInfo:null,_sublayerIdent:null,controlPopupInfo:null,_jsapiLayerInfos:null,_oldFilter:null,_subLayerVisible:null,
constructor:function(){},init:function(){this._initJsapiLayerInfos();this._initSubLayerVisible();this._initSubLayerIdent();this._initControlPopup();this.inherited(arguments);this._needToRefresh().then(y.hitch(this,function(a){a&&(this.update(),this._getLayerInfosObj()._onLayersUpdated(this,this))}))},_needToRefresh:function(){var a=new x;this.layerObject.dynamicLayerInfos&&this.isRootLayer()&&this.isItemLayer()&&!this.originOperLayer.thematicGroup?this.getItemInfo().then(y.hitch(this,function(k){(k=
(k=k.getItemData())&&k.thematicGroup)?(this.originOperLayer.thematicGroup=k,a.resolve(!0)):a.resolve(!1)})):a.resolve(!1);return a},_initOldFilter:function(){this._oldFilter=this.layerObject&&this.layerObject.layerDefinitions?this.layerObject.layerDefinitions:[]},_initJsapiLayerInfos:function(){var a=m.filter(this.originOperLayer.layers,function(a){return A.isDefined(a.id)&&A.isDefined(a.name)&&A.isDefined(a.minScale)&&A.isDefined(a.maxScale)&&A.isDefined(a.parentLayerId)&&A.isDefined(a.defaultVisibility)});
this._jsapiLayerInfos=this.layerObject.dynamicLayerInfos?this.originOperLayer.thematicGroup&&this.originOperLayer.thematicGroup.layerIds&&0<=this.originOperLayer.thematicGroup.layerIds.length?m.filter(this.layerObject.dynamicLayerInfos,function(a){return-1<this.originOperLayer.thematicGroup.layerIds.indexOf(a.id)?!0:!1},this):this.layerObject.dynamicLayerInfos:0<a.length?a:this.layerObject.layerInfos},_cloneInfoTemplates:function(a){var k={},e;for(e in a)if(a.hasOwnProperty(e)&&"function"!==typeof a[e]){var g=
a[e];g.infoTemplate&&g.infoTemplate.toJson&&(k[e]={infoTemplate:new g.infoTemplate.constructor(g.infoTemplate.toJson()),layerUrl:g.layerUrl,resourceInfo:g.resourceInfo})}return k},_initControlPopup:function(){this.controlPopupInfo={enablePopup:void 0,infoTemplates:this._cloneInfoTemplates(this.layerObject.infoTemplates)};this.layerObject._infoTemplates=this._cloneInfoTemplates(this.layerObject.infoTemplates);w.after(this.layerObject,"setInfoTemplates",y.hitch(this,function(){this.layerObject._infoTemplates=
this._cloneInfoTemplates(this.layerObject.infoTemplates);this.controlPopupInfo.infoTemplates=this._cloneInfoTemplates(this.layerObject.infoTemplates);this.traversal(function(a){a._afterSetInfoTemplates&&a._afterSetInfoTemplates()})}))},_initSubLayerIdent:function(){this._sublayerIdent={definitions:{},empty:!0,defLoad:new x}},_initSubLayerVisible:function(a){this._subLayerVisible={};for(var k=0;k<this._jsapiLayerInfos.length;k++)this._subLayerVisible[this._jsapiLayerInfos[k].id]=!1;a?m.forEach(a,function(a){this._subLayerVisible[a]=
!0},this):this.originOperLayer.visibleLayers?m.forEach(this.originOperLayer.visibleLayers,function(a){this._subLayerVisible[a]=!0},this):m.forEach(this._jsapiLayerInfos,function(a){a.defaultVisibility&&(this._subLayerVisible[a.id]=!0)},this)},_initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(a){this.originOperLayer.layerObject.setVisibility(a);this._visible=a},_setSubLayerVisible:function(a){var k=[-1,-1,-1],e,g=[],n=m.filter(this.originOperLayer.layerObject.visibleLayers,
function(a){return-1!==a});m.forEach(n,function(a){if(!this._isGroupLayerBySubId(a)){var e=this._subLayerInfoIndex[a];e&&e._isAllSubLayerVisibleOnPath()&&g.push(a)}},this);var n=g,r;for(r in a)if(a.hasOwnProperty(r)&&"function"!==typeof a[r]){var t=Number(r);a[r]?(e=m.indexOf(n,t),0>e&&n.push(t)):(e=m.indexOf(n,t),0<=e&&n.splice(e,1))}k=k.concat(n);this.originOperLayer.layerObject.setVisibleLayers(k)},_resetLayerObjectVisiblity:function(a){var k=a?a[this.id]:null,e=!1;if(a&&(k&&this.layerObject.setVisibility(k.visible),
"esri.layers.ArcGISDynamicMapServiceLayer"===this.layerObject.declaredClass)){var k={},g;for(g in a)a.hasOwnProperty(g)&&"function"!==typeof a[g]&&(e=!0,k[g]=a[g].visible);e&&this._setSubLayerVisibleByCheckedInfo(k)}},_setSubLayerVisibleByCheckedInfo:function(a){var k=[];m.forEach(this._jsapiLayerInfos,function(e){var g=this.id+"_"+e.id;A.isDefined(a[g])?a[g]&&k.push(e.id):this._subLayerVisible[e.id]&&k.push(e.id)},this);this._initSubLayerVisible(k);this.traversal(function(a){a._initVisible()});var e=
{};this.traversal(function(a){0===a.getSubLayers().length&&(e[a.originOperLayer.mapService.subId]=a._isAllSubLayerVisibleOnPath())});this._setSubLayerVisible(e)},_subLayerVisibleChanged:function(){var a=[];this.traversal(function(k){a.push(k)});t.publish("layerInfos/layerInfo/visibleChanged",a)},obtainNewSubLayers:function(){var a=[],k=this.originOperLayer.layerObject,e=null,e="esri.layers.ArcGISDynamicMapServiceLayer"===k.declaredClass?"dynamic":"tiled";m.forEach(this._jsapiLayerInfos,function(g){var p=
null,p=k.url+"/"+g.id,n=k.id+"_"+g.id;g.subLayerIds&&0<g.subLayerIds.length?(p={url:p,empty:!0},this._addNewSubLayer(a,p,n,g,e+"_group")):(p={url:p,empty:!0},this._addNewSubLayer(a,p,n,g,e))},this);var g=[];m.forEach(this._jsapiLayerInfos,function(e,k){e=e.parentLayerId;if(-1!==e){for(var g=null,p=0;p<a.length;p++)if(a[p].mapService.subId===e){g=a[p];break}(e=g)&&e.subLayers.push(a[k])}},this);m.forEach(this._jsapiLayerInfos,function(e,k){-1===e.parentLayerId&&(e=this._layerInfoFactory.create(a[k]),
g.push(e),e.init())},this);return g},_addNewSubLayer:function(a,k,e,g,n){var p=g.source&&g.source.mapLayerId;if(void 0===p||null===p)p=g.id;a.push({layerObject:k,title:g.name||g.id||" ",id:e||"-",subId:g.id,subLayers:[],mapService:{layerInfo:this,subId:g.id,mapServiceSubId:p},selfType:"mapservice_"+n,parentLayerInfo:this})},_handleErrorSubLayer:function(a,k,e,g,n,r){a[k]={layerObject:null,title:r.name||r.id||" ",id:e||" ",subLayers:[],mapService:{layerInfo:this,subId:g}}},getLegendInfo:function(a){var k=
new x;this._legendInfo?k.resolve(this._legendInfo):this._legendRequest(a).then(y.hitch(this,function(a){this._legendInfo=a.layers;k.resolve(this._legendInfo)}),function(){k.reject()});return k},_legendRequest:function(a){return 10.01<=this.layerObject.version?this._legendRequestServer():this._legendRequestTools(a)},_legendRequestServer:function(){var a=this.layerObject.url+"/legend",k={f:"json"};this.layerObject._params.dynamicLayers&&(k.dynamicLayers=g.stringify(this._createDynamicLayers(this.layerObject)),
"[{}]"===k.dynamicLayers&&(k.dynamicLayers="[]"));return n({url:a,content:k,handleAs:"json",callbackParamName:"callback"})},_legendRequestTools:function(a){return n({url:a+"sharing/tools/legend?soapUrl\x3d"+this.layerObject.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})},_createDynamicLayers:function(a){var k=[],e;m.forEach(a.dynamicLayerInfos||a.layerInfos,function(g){e={id:g.id};e.source=g.source&&g.source.toJson();var p;a.layerDefinitions&&a.layerDefinitions[g.id]&&(p=a.layerDefinitions[g.id]);
p&&(e.definitionExpression=p);var n;a.layerDrawingOptions&&a.layerDrawingOptions[g.id]&&(n=a.layerDrawingOptions[g.id]);n&&(e.drawingInfo=n.toJson());e.minScale=g.minScale||0;e.maxScale=g.maxScale||0;k.push(e)});return k},_getServiceDefinition:function(){var a=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(a)},_getSubserviceDefinition:function(a){return 10.11<=this.layerObject.version?this._getAllLayerAndTable(a):this._getLayerAndTable(a)},_getAllLayerAndTable:function(a){var k=
this.layerObject.url+"/layers",e=this._serviceDefinitionBuffer.getRequest("_all_layer_and_table_request");e.isResolved()||e.request(k).then(y.hitch(this,function(a){a||(a={layers:[]});this.traversal(y.hitch(this,function(e){if(!e.isRootLayer()){var k=e.originOperLayer.mapService.mapServiceSubId;e=this._serviceDefinitionBuffer.getRequest(k);var g=null;m.some(a.layers,function(a){if(a.id===k)return g=a,!0},this);e.setResponse(g)}}))}));return this._serviceDefinitionBuffer.getRequest(a).fakeRequest()},
_getLayerAndTable:function(a){var k=this.layerObject.url+"/"+a;return this._serviceDefinitionBuffer.getRequest(a).request(k)},_getSublayerSettingOfWebmap:function(a){var k=m.filter(this.originOperLayer.layers,function(e){return e.id===a});return 1===k.length?k[0]:null},_getSublayerShowLegendOfWebmap:function(a){return(a=this._getSublayerSettingOfWebmap(a))?void 0!==a.showLegend?a.showLegend:!0:!0},_idIsInJsapiLayerInfos:function(a){return null===this._getJsapiLayerInfoById(a)?!1:!0},_getJsapiLayerInfoById:function(a){for(var k=
null,e=0;e<this._jsapiLayerInfos.length;e++)if(this._jsapiLayerInfos[e].id===a){k=this._jsapiLayerInfos[e];break}return k},_isGroupLayerBySubId:function(a){return(a=this._getJsapiLayerInfoById(a))&&a.subLayerIds&&0<a.subLayerIds.length?!0:!1},_bindEvent:function(){var a;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(a=this.layerObject.on("visible-layers-change",y.hitch(this,this._onVisibleLayersChanged)),this._eventHandles.push(a),a=w.after(this.layerObject,"setLayerDefinitions",
y.hitch(this,this._onFilterChanged)),this._eventHandles.push(a))},_onVisibleLayersChanged:function(a){var k=a.visibleLayers;if(-1===k[0]&&-1===k[1]&&-1===k[2])this._subLayerVisibleChanged(),this._isShowInMapChanged2();else{a=[];var e=[-1,-1,-1],k=this._converVisibleLayers(k);a=k.visibleLayersForUpdateSubLayerVisible;e=e.concat(k.visibleLayersForSetVisibleLayers);this._initSubLayerVisible(a);this.traversal(function(a){a._initVisible()});this.layerObject.setVisibleLayers(e)}},_converVisibleLayers:function(a){var k=
{visibleLayersForUpdateSubLayerVisible:[],visibleLayersForSetVisibleLayers:[]};m.forEach(a,function(e){var k=this.findLayerInfoById(this.id+"_"+e);if(this._isGroupLayerBySubId(e))k.traversal(function(e){a.push(e.originOperLayer.mapService.subId)});else for(;k&&k.originOperLayer.mapService;)a.push(k.originOperLayer.mapService.subId),k=k.parentLayerInfo},this);m.forEach(a,function(a){0<=a&&0>k.visibleLayersForUpdateSubLayerVisible.indexOf(a)&&k.visibleLayersForUpdateSubLayerVisible.push(a)},this);m.forEach(k.visibleLayersForUpdateSubLayerVisible,
function(a){this._isGroupLayerBySubId(a)||k.visibleLayersForSetVisibleLayers.push(a)},this);return k},_onFilterChanged:function(){for(var a,k=[],e=this.layerObject.layerDefinitions,g=e.length>this._oldFilter.length?e.length:this._oldFilter.length,n=0;n<g;n++)(e[n]?e[n]:null)!==(this._oldFilter[n]?this._oldFilter[n]:null)&&(a=this.findLayerInfoById(this.id+"_"+n))&&a.isLeaf()&&k.push(a);0<k.length&&(t.publish("layerInfos/layerInfo/filterChanged",k,y.getObject("_wabProperties.objectPassWithFilterChangeEvent",
!0,this.layerObject)),this._oldFilter=e,y.setObject("_wabProperties.objectPassWithFilterChangeEvent",{},this.layerObject))}})})},"jimu/LayerInfos/LayerInfoForKML":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect dojo/topic ./LayerInfo ./LayerInfoForDefault jimu/utils dojo/Deferred esri/lang".split(" "),function(B,m,y,x,g,w,t,r,n,A,a){return B(t,{constructor:function(){},_getExtentAsync:function(){var a=this.layerObject.getLayers(),e=null,g=null;
if(0<a.length&&"esri.layers.KMLLayer"===a[0].declaredClass){var u=[];this.traversal(y.hitch(this,function(a){a.id!==this.id&&"esri.layers.KMLLayer"===a.layerObject.declaredClass&&u.push(a)}));m.forEach(u,function(a){g=a._getExtentAsync();e=e?e.union(g):g},this)}else m.forEach(a,function(a){g=n.graphicsExtent(a.graphics);e=e?e.union(g):g},this);return e},_getExtent:function(){var a=new A;a.resolve(this._getExtentAsync());return a},_resetLayerObjectVisiblity:function(a){var e=a?a[this.id]:null;if(e){var k=
{},g;for(g in a)a.hasOwnProperty(g)&&"function"!==typeof a[g]&&(k[g]=a[g].visible);this._setSubLayerVisibleByCheckedInfo(k);this._setTopLayerVisible(e.visible)}},_setSubLayerVisibleByCheckedInfo:function(k){this.traversal(y.hitch(this,function(e){a.isDefined(k[e.id])&&e._setTopLayerVisible(k[e.id])}))},_initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(a){a?this.layerObject.show():this.layerObject.hide()},obtainNewSubLayers:function(){var a=
[];m.forEach(this._getOperLayerByParentFolderId(-1,this),function(e){e=this._layerInfoFactory.create(e);a.push(e);e.init()},this);return a},_getOperLayerByParentFolderId:function(a,e){var k=[],g=this.layerObject.getLayers()||[],n=m.filter(this.layerObject.folders||[],function(e){return e.parentFolderId===a?!0:!1}),r=[],r=0===n.length?m.filter(g,function(a){return this._flag.kmzSubLayersWereHandled?!1:!0},this):n;m.forEach(r,function(a){var g;"esri.layers.KMLFolder"===a.declaredClass?g={layerObject:a,
title:a.label||a.title||a.name||"\x26lt;no name\x26gt;",id:this._getSubLayerInfoIdForSubFolder(a),subId:a.id,kml:{layerInfo:this,currentFolder:a},selfType:"kml",parentLayerInfo:e}:"esri.layers.KMLLayer"===a.declaredClass?(g=y.getObject("linkInfo.name",!1,a),g={layerObject:a,title:a.label||a.title||g||a.name||a.id||" ",id:a.id||"-",subId:a.id||"-",kml:{layerInfo:this,currentFolder:null},selfType:"kml",parentLayerInfo:e},y.setObject("_wabProperties.kmllayerWasHandled",!0,a),this._flag.kmzSubLayersWereHandled=
!0):(y.setObject("_wabProperties.kmllayerWasHandled",!0,a),y.setObject("_wabProperties.isTemporaryLayer",!0,a));g&&k.push(g)},this);return k},_getAllSubLayerObject:function(){var a=[];this.traversal(y.hitch(this,function(e){e.layerObject&&e.layerObject.getLayers&&(a=a.concat(e.layerObject.getLayers()))}));return a},_getSubLayerInfoIdForSubFolder:function(a){return this.id+"_folder_"+a.id},_needToRenew:function(){return m.some(this._getAllSubLayerObject(),function(a){if(!y.getObject("_wabProperties.kmllayerWasHandled",
!1,a))return!0},this)},_bindEvent:function(){var a;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(a=g.after(this.layerObject,"setFolderVisibility",y.hitch(this,this._onSubFolderVisibleChanged),!0),this._eventHandles.push(a))},_onSubFolderVisibleChanged:function(a){a=this._getSubLayerInfoIdForSubFolder(a);(a=this.findLayerInfoById(a))&&w.publish("layerInfos/layerInfo/visibleChanged",[a])}})})},"jimu/LayerInfos/LayerInfoForDefault":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all ./LayerInfo dojox/gfx dojo/dom-construct dojo/dom-attr dojo/dom-class dojo/aspect jimu/portalUrlUtils jimu/portalUtils jimu/utils esri/symbols/jsonUtils esri/layers/LabelLayer esri/layers/LabelClass esri/dijit/PopupTemplate esri/dijit/Legend esri/graphic esri/geometry/Point esri/tasks/query esri/tasks/RelationshipQuery esri/tasks/QueryTask".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C,J){return B(w,{_legendsNode:null,controlPopupInfo:null,constructor:function(){this._initControlPopup();this._updateLayerObjectName();try{this._initToShowLabels()}catch(O){console.warn(O.message)}},_updateLayerObjectName:function(){this.layerObject&&!this.layerObject.empty&&this.layerObject.name&&!y.getObject("_wabProperties.originalLayerName",!1,this.layerObject)&&(y.setObject("_wabProperties.originalLayerName",this.layerObject.name,this.layerObject),
this.layerObject.name=this.title,y.setObject("arcgisProps.title",this.title,this.layerObject))},_initToShowLabels:function(){var a=y.getObject("_wabProperties.itemLayerInfo",!1,this.layerObject);a&&!this.layerObject.empty&&e.getPortal(a.portalUrl).getItemData(a.itemId).then(y.hitch(this,function(a){var e;a&&a.layers&&(m.some(a.layers,function(a){return a.id===this.layerObject.layerId?(e=a,!0):!1},this),e&&e.showLabels&&((a=y.getObject("layerDefinition.drawingInfo.labelingInfo",!1,e))&&!this.layerObject.labelingInfo&&
this.layerObject.setLabelingInfo&&(a=m.map(a,function(a){return new M(a)},this),this.layerObject.setLabelingInfo(a)),this.showLabels()))}),y.hitch(this,function(a){a&&a.message&&console.log(a.message)}))},_initOldFilter:function(){this._oldFilter=this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():null},_getLayerOptionsForCreateLayerObject:function(){var a={};a.id=this.id;var e=[],k=this.getInfoTemplate();k&&k.info&&k.info.fieldInfos?
m.forEach(k.info.fieldInfos,function(a){a.visible&&e.push(a.fieldName)},this):e=["*"];a.outFields=e;return a},_getExtent:function(){var a=new x,e;e=this.layerObject.graphics&&0<this.layerObject.graphics.length?p.graphicsExtent(this.layerObject.graphics):this.layerObject.fullExtent||this.layerObject.initialExtent;this.layerObject.url?"esri.layers.FeatureLayer"===this.layerObject.declaredClass?this.getServiceDefinition().then(y.hitch(this,function(k){var g=new J(this.layerObject.url),n=new N,u=this.getFilter();
n.where=u?u:"1\x3d1";n.outSpatialReference=this.map.spatialReference;n.returnGeometry=!0;k&&k.advancedQueryCapabilities&&k.advancedQueryCapabilities.supportsReturningQueryExtent?g.executeForExtent(n,y.hitch(this,function(e){var k=e.extent;1===e.count&&"esriGeometryPoint"===this.layerObject.geometryType&&(e=new K(e.extent.xmin,e.extent.ymin,e.extent.spatialReference),k=p.graphicsExtent([new P(e)]));a.resolve(k)}),y.hitch(this,function(){a.resolve(e);console.log("executeForExtent failed.")})):g.execute(n).then(y.hitch(this,
function(e){e=p.graphicsExtent(e.features);a.resolve(e)}),y.hitch(this,function(){a.resolve(e);console.log("query execute failed.")}))})):a.resolve(e):a.resolve(e);return a},_resetLayerObjectVisiblity:function(a){a=a?a[this.id]:null;!this.originOperLayer.collection&&a&&(this.layerObject.setVisibility(a.visible),this._visible=this.layerObject.visible)},_initVisible:function(){var a=!1;if(this.originOperLayer.collection&&this._notFirstInitVisilbeFlag){var a=this.originOperLayer.collection.layerInfo,
e=this.layerObject.visible;if(a._oldIsShowInMap!==a.isShowInMap())return;this._visible=e?!0:!1;a._onVisibilityChanged()}else this._visible=a=this.originOperLayer.layerObject.visible;this._notFirstInitVisilbeFlag=!0},_setTopLayerVisible:function(a){this.originOperLayer.collection?this.originOperLayer.collection.layerInfo._visible?a?(this.layerObject.show(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):a?(this.layerObject.hide(),this._visible=!0):(this.layerObject.hide(),this._visible=
!1):(a?this.layerObject.show():this.layerObject.hide(),this._visible=a)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.collection.layerInfo._visible?this._visible&&this.layerObject.show():this.layerObject.hide()},_prepareCheckedInfoForShowOrHide:function(a){for(var e={},k=this;k.parentLayerInfo;)e[k.id]=a,k=k.parentLayerInfo;return e},show:function(){if(this.isRootLayer())this._setTopLayerVisible(!0);else{var a=this.getRootLayerInfo();if(a._setSubLayerVisibleByCheckedInfo){var e=this._prepareCheckedInfoForShowOrHide(!0);
a._setSubLayerVisibleByCheckedInfo(e);a.show()}}},_initControlPopup:function(){this.controlPopupInfo={enablePopup:this.layerObject.infoTemplate?!0:!1,infoTemplate:this.layerObject.infoTemplate};this.layerObject._infoTemplate=this.layerObject.infoTemplate;var e=a.after(this.layerObject,"setInfoTemplate",y.hitch(this,function(){this.layerObject._infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.enablePopup||(this.layerObject.infoTemplate=
null)}));this._eventHandles.push(e)},_getServiceDefinition:function(){var a;(a=this.getUrl())&&this.isRootLayer()&&"esri.layers.FeatureLayer"===this.layerObject.declaredClass?a=this._serviceDefinitionBuffer.getRequest(this.subId).request(a):(a=new x,a.resolve(null));return a},createLegendsNode:function(){var a=r.create("div",{"class":"legends-div jimu-legends-div-flag jimu-leading-margin1",legendsDivId:this.id},document.body);r.create("img",{"class":"legends-loading-img",src:require.toUrl("jimu")+
"/images/loading.gif"},a);return a},drawLegends:function(a){this._initLegendsNodeByLegendDijit(a)},_initLegendsNodeByLegendDijit:function(a){if(this.layerObject&&!this.layerObject.empty&&(!this.originOperLayer.subLayer||0===this.originOperLayer.subLayers.length)&&this.layerObject.loaded){r.empty(a);A.remove(a,"jimu-legends-div-flag");var e=new L({map:this.map,layerInfos:[{layer:this.layerObject}],arrangement:L.ALIGN_LEFT,respectCurrentMapScale:!1,respectVisibility:!1},r.create("div",{},a));e.startup();
a._legendDijit=e}},_initLegendsNode:function(a){var e=[],k=this.layerObject;!this.layerObject||this.layerObject.empty||this.originOperLayer.subLayer&&0!==this.originOperLayer.subLayers.length||(r.empty(a),k.renderer&&(k.renderer.infos?e=y.clone(k.renderer.infos):e.push({label:k.renderer.label,symbol:k.renderer.symbol}),k.renderer&&k.renderer.defaultSymbol&&0<e.length&&e.push({label:k.renderer.defaultLabel||"others",symbol:k.renderer.defaultSymbol}),m.forEach(e,function(e){e.legendDiv=r.create("div",
{"class":"legend-div"},a);e.symbolDiv=r.create("div",{"class":"legend-symbol jimu-float-leading"},e.legendDiv);e.labelDiv=r.create("div",{"class":"legend-label jimu-float-leading",innerHTML:e.label||" "},e.legendDiv);if("textsymbol"===e.symbol.type)n.set(e.symbolDiv,"innerHTML",e.symbol.text);else{var k=t.createSurface(e.symbolDiv,50,50);e=u.getShapeDescriptors(e.symbol);k.createShape(e.defaultShape).setFill(e.fill).setStroke(e.stroke).setTransform(t.matrix.translate(25,25))}},this)))},obtainNewSubLayers:function(){var a=
[];m.forEach(this.originOperLayer.subLayers,function(e){e.parentLayerInfo=this;e=this._layerInfoFactory.create(e);a.push(e);e.init()},this);return a},_isAllSubLayerVisibleOnPath:function(){for(var a=!0,e=this;!e.isRootLayer();)a=a&&e.isVisible(),e=e.parentLayerInfo;return a},_getCustomPopupInfo:function(a,e){var k=null;a&&a.fields&&(k={title:a.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]},m.forEach(a.fields,function(a){var g=!1;e?m.some(e,y.hitch(this,function(e){return e&&
a.name.toLowerCase()===e.toLowerCase()}))&&(g=!0):g=!0;g&&(g=p.getDefaultPortalFieldInfo(a),g.visible=!0,g.isEditable=a.editable,k.fieldInfos.push(g))},this));return k},_getDefaultPopupInfo:function(a){if(a=this._getCustomPopupInfo(a))a.fieldInfos=m.filter(a.fieldInfos,y.hitch(this,function(a){a=a.fieldName.toLowerCase();return 0>a.indexOf("object")&&0>a.indexOf("globalid")&&0>a.indexOf("shape")&&0>a.indexOf("perimeter")?!0:!1}));return a},_getDefaultPopupTemplate:function(a){var e=null;(a=this.getPopupInfo()||
this._getDefaultPopupInfo(a))&&(e=new I(a));return e},enablePopup:function(){return this.loadInfoTemplate().then(y.hitch(this,function(){return this.controlPopupInfo.infoTemplate?(this.controlPopupInfo.enablePopup=!0,this.layerObject.infoTemplate=this.controlPopupInfo.infoTemplate,!0):!1}))},disablePopup:function(){this.controlPopupInfo.enablePopup=!1;this.layerObject.infoTemplate=null},isPopupEnabled:function(){return this.controlPopupInfo&&this.controlPopupInfo.enablePopup?!0:!1},loadInfoTemplate:function(){var a=
new x;this.controlPopupInfo.infoTemplate?a.resolve(this.controlPopupInfo.infoTemplate):this.getLayerObject().then(y.hitch(this,function(){this.controlPopupInfo.infoTemplate=this._getDefaultPopupTemplate(this.layerObject);a.resolve(this.controlPopupInfo.infoTemplate)}),y.hitch(this,function(){a.resolve(null)}));return a},getInfoTemplate:function(){return this.controlPopupInfo.infoTemplate},_getRelatedUrls:function(a,e){var k=[];if(!a||!a.url||!a.relationships)return k;var g=a.url.lastIndexOf("/"),
p=a.url.slice(0,g);m.forEach(a.relationships,function(a){e&&a.role&&"esriRelCardinalityManyToMany"!==a.cardinality&&e!==a.role||k.push(p+"/"+a.relatedTableId.toString())},this);return k},getRelatedTableInfoArray:function(a){var e=[],g=new x;this.getLayerObject().then(y.hitch(this,function(p){var n=this._getRelatedUrls(p,a);0!==n.length&&this._getLayerInfosObj().traversalAll(y.hitch(this,function(a){var g=-1;if(0===n.length)return!0;m.forEach(n,function(p,n){y.getObject("layerObject.url",!1,a)&&k.removeProtocol(p.toString().toLowerCase()).replace(/\/+/g,
"/")===k.removeProtocol(a.layerObject.url.toString().toLowerCase()).replace(/\/+/g,"/")&&(e.push(a),g=n)},this);0<=g&&n.splice(g,1);return!1}));g.resolve(e)}),y.hitch(this,function(){g.resolve(e)}));return g},_getOrderByFields:function(a){var e=null;if(void 0===a||null===a)return e;var k=this.getPopupInfo();k&&k.relatedRecordsInfo&&k.relatedRecordsInfo.orderByFields&&m.some(k.relatedRecordsInfo.orderByFields,function(k){var g=k.field.split("/");if(g[1]===a.toString())return e=[g[2]+" "+k.order],!0},
this);return e},_getOriRelationshipByDestLayer:function(a,e){var k=null;m.some(a.relationships,function(a){if(a.relatedTableId===e.layerId)return k=a,!0},this);return k},getRelatedRecords:function(a,e){var k=new x,p=new C,n=this.getLayerObject(),u=e.getLayerObject();g({originalLayerObject:n,relatedLayerObject:u}).then(y.hitch(this,function(g){g.originalLayerObject&&g.relatedLayerObject||k.resolve([]);g=this._getOriRelationshipByDestLayer(this.layerObject,g.relatedLayerObject);p.outFields=["*"];p.relationshipId=
g&&g.id;var n=a.attributes[this.layerObject.objectIdField];p.objectIds=[n];p.definitionExpression=e.getFilter();p.orderByFields=this._getOrderByFields(g&&g.id);this.layerObject.queryRelatedFeatures(p,y.hitch(this,function(a){(a=a[n]&&a[n].features)?k.resolve(a):k.resolve([])}),y.hitch(this,function(){k.resolve([])}))}));return k},getFilter:function(){return this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():null},setFilter:function(a,
e){this.layerObject&&!this.layerObject.empty&&this.layerObject.setDefinitionExpression&&(e=y.mixin({},e),y.setObject("_wabProperties.objectPassWithFilterChangeEvent",e,this.layerObject),this.layerObject.setDefinitionExpression(a))},_isAlreadyInLabelLayerOfMap:function(a){var e=!1;a&&(e=m.some(a.getFeatureLayers(),function(a){return this.id===a.id},this));return e},_addToLabelLayerOfMap:function(){var a=this.getLabelLayerOfMap();a&&!this._isAlreadyInLabelLayerOfMap(a)&&(a.addFeatureLayer(this.layerObject),
this.map.removeLayer(a),this.map.addLayer(a))},_removeFromLabelLayerOfMap:function(){this.getLabelLayerOfMap().removeFeatureLayer(this.id)},_isSupportLabelControl:function(){return this.isRootLayer()&&!this.layerObject.empty&&"esri.layers.FeatureLayer"===this.layerObject.declaredClass&&this.layerObject.labelingInfo&&0<this.layerObject.labelingInfo.length?!0:!1},getLabelLayerOfMap:function(){var a;this.map._labels?a=this.map._labels:(a=this.map.getLayer("labels"),a||(a=new z({id:"labels"}),this.map.addLayer(a)));
return a},obtainLabelControl:function(){var a=this.id+"_labelLayer",e=this.map.getLayer(a);if(!e&&this._isSupportLabelControl()){var k=this.getLabelLayerOfMap();k&&this._isAlreadyInLabelLayerOfMap(k)&&(e=new z({id:a}),e.addFeatureLayer(this.layerObject),this.map.addLayer(e),this._removeFromLabelLayerOfMap())}return e?e:null},restoreLabelControl:function(){this._isSupportLabelControl()&&(this.destroyRealtedLabelLayer(),this._addToLabelLayerOfMap())},destroyRealtedLabelLayer:function(){var a=this.map.getLayer(this.id+
"_labelLayer");a&&this.map.removeLayer(a)},destroyLabelLayer:function(){this.map.getLayer(this.id)||(this._removeFromLabelLayerOfMap(),this.destroyRealtedLabelLayer())},canShowLabel:function(){return this._isSupportLabelControl()},isShowLabels:function(){var a=this.map.getLayer(this.id+"_labelLayer"),e=this.getLabelLayerOfMap();return this._isSupportLabelControl()&&(a||e&&this._isAlreadyInLabelLayerOfMap(e))?this.layerObject.showLabels:!1},showLabels:function(){this._isSupportLabelControl()&&this.layerObject.setShowLabels&&
(this.map.getLayer(this.id+"_labelLayer")||this._addToLabelLayerOfMap(),this.layerObject.setShowLabels(!0))},hideLabels:function(){this._isSupportLabelControl()&&this.layerObject.setShowLabels&&this.layerObject.setShowLabels(!1)}})})},"esri/layers/LabelLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/i18n!dojo/cldr/nls/number dojo/number dojo/has dojox/gfx/_base ../kernel ../lang ../graphic ../PopupInfo ../ArcadeExpression ../core/timerUtils ../symbols/TextSymbol ../symbols/ShieldLabelSymbol ../geometry/Extent ../geometry/Point ../geometry/webMercatorUtils ../renderers/SimpleRenderer ../arcadeProfiles/labelingProfile ./labelLayerUtils/DynamicLabelClass ./labelLayerUtils/StaticLabelClass ./GraphicsLayer ./LabelClass".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C,J,O){function R(a){return"sizeInfo"===a.type}B=B(J,{declaredClass:"esri.layers.LabelLayer",constructor:function(a){this._refreshLabels=m.hitch(this,this._refreshLabels);this.id="labels";this.featureLayers=[];this._featureLayerInfos=[];this._preparedLabels=[];this._engineType="STATIC";this._mapEventHandlers=[];a&&(a.id&&(this.id=a.id),a.mode&&(this._engineType="DYNAMIC"===a.mode.toUpperCase()?"DYNAMIC":"STATIC"))},_setMap:function(a){this._mapEventHandlers.push(a.on("extent-change",
m.hitch(this,"_handleLevelChange")));var e=this.inherited(arguments);return this.refresh(),e},_unsetMap:function(){var a;for(a=0;a<this._mapEventHandlers.length;a++)x.disconnect(this._mapEventHandlers[a]);this.refresh();p.clearTimeout(this._refreshHandle);this._refreshHandle=null;this.inherited(arguments)},setAlgorithmType:function(a){this._engineType=a&&"DYNAMIC"===a.toUpperCase()?"DYNAMIC":"STATIC";this.refresh()},addFeatureLayer:function(a,e,k,g){if(!this.getFeatureLayer(a.layerId)){var p=[];p.push(a.on("update-end",
m.hitch(this,"refresh")));p.push(a.on("suspend",m.hitch(this,"refresh")));p.push(a.on("resume",m.hitch(this,"refresh")));p.push(a.on("edits-complete",m.hitch(this,"refresh")));p.push(a.on("labeling-info-change",m.hitch(this,"refresh")));p.push(a.on("time-extent-change",m.hitch(this,"refresh")));p.push(a.on("show-labels-change",m.hitch(this,"refresh")));p.push(a.on("feature-reduction-change",m.hitch(this,"refresh")));this._featureLayerInfos.push({FeatureLayer:a,LabelExpressionInfo:k,LabelingOptions:g,
LabelRenderer:e,EventHandlers:p});this.featureLayers.push(a);this.refresh()}},getFeatureLayer:function(a){var e,k;for(e=0;e<this.featureLayers.length;e++)if(void 0!==(k=this.featureLayers[e])&&k.id==a)return k;return null},removeFeatureLayer:function(a){var e,k;if(void 0!==(e=this.getFeatureLayer(a))&&-1<(k=y.indexOf(this.featureLayers,e))){this.featureLayers.splice(k,1);for(a=0;a<this._featureLayerInfos[k].EventHandlers.length;a++)x.disconnect(this._featureLayerInfos[k].EventHandlers[a]);this._featureLayerInfos.splice(k,
1);this.refresh()}},removeAllFeatureLayers:function(){var a;for(a=0;a<this.featureLayers.length;a++){for(var e=0;e<this._featureLayerInfos[a].EventHandlers.length;e++)x.disconnect(this._featureLayerInfos[a].EventHandlers[e]);this.featureLayers=[];this._featureLayerInfos=[]}this.refresh()},getFeatureLayers:function(){return this.featureLayers},getFeatureLayerInfo:function(a){var e,k;for(e=0;e<this.featureLayers.length;e++)if(void 0!==(k=this.featureLayers[e])&&k.id==a)return this._featureLayerInfos[e];
return null},refresh:function(){null==this._refreshHandle&&(this._refreshHandle=p.setTimeout(this._refreshLabels,p.priority.LOW))},_handleLevelChange:function(a){a.levelChange&&this.clear();this.refresh()},_refreshLabels:function(a){this._refreshHandle=null;var e,k,g,p,n,u,r,z=[],f="DYNAMIC"===this._engineType?new N:new C;if(this._map){f.setMap(this._map,this);this._preparedLabels=[];for(a=0;a<this.featureLayers.length;a++)if(k=this.featureLayers[a],k.visible&&k.showLabels&&k.visibleAtMapScale&&!k._suspended)if(g=
this._featureLayerInfos[a],u=this._convertOptions(null),g.LabelRenderer){if(z=k.labelingInfo,z&&(r=z[0])&&(n=this._getLabelExpression(r),u=this._convertOptions(r)),p=g.LabelRenderer,g.LabelExpressionInfo&&(n=g.LabelExpressionInfo),g.LabelingOptions){if(u=this._convertOptions(null),void 0!==g.LabelingOptions.pointPriorities)e=g.LabelingOptions.pointPriorities,u.pointPriorities="above-center"==e||"AboveCenter"==e||"esriServerPointLabelPlacementAboveCenter"==e?"AboveCenter":"above-left"==e||"AboveLeft"==
e||"esriServerPointLabelPlacementAboveLeft"==e?"AboveLeft":"above-right"==e||"AboveRight"==e||"esriServerPointLabelPlacementAboveRight"==e?"AboveRight":"below-center"==e||"BelowCenter"==e||"esriServerPointLabelPlacementBelowCenter"==e?"BelowCenter":"below-left"==e||"BelowLeft"==e||"esriServerPointLabelPlacementBelowLeft"==e?"BelowLeft":"below-right"==e||"BelowRight"==e||"esriServerPointLabelPlacementBelowRight"==e?"BelowRight":"center-center"==e||"CenterCenter"==e||"esriServerPointLabelPlacementCenterCenter"==
e?"CenterCenter":"center-left"==e||"CenterLeft"==e||"esriServerPointLabelPlacementCenterLeft"==e?"CenterLeft":"center-right"==e||"CenterRight"==e||"esriServerPointLabelPlacementCenterRight"==e?"CenterRight":"AboveRight";void 0!==g.LabelingOptions.lineLabelPlacement&&(u.lineLabelPlacement=g.LabelingOptions.lineLabelPlacement);void 0!==g.LabelingOptions.lineLabelPosition&&(u.lineLabelPosition=g.LabelingOptions.lineLabelPosition);void 0!==g.LabelingOptions.labelRotation&&(u.labelRotation=g.LabelingOptions.labelRotation);
void 0!==g.LabelingOptions.howManyLabels&&(u.howManyLabels=g.LabelingOptions.howManyLabels)}p instanceof O&&(n=this._getLabelExpression(p),p=new P(p.symbol),u=this._convertOptions(p));this._addLabels(k,p,n,u)}else if(z=k.labelingInfo)for(e=z.length-1;0<=e;e--)(r=z[e])&&(p=new O(r instanceof O?r.toJson():r),n=this._getLabelExpression(r),u=this._convertOptions(r),this._addLabels(k,p,n,u));k=f._process(this._preparedLabels);this.clear();this.drawLabels(this._map,k)}},drawLabels:function(e,k){this._scale=
(e.extent.xmax-e.extent.xmin)/e.width;var g;for(g=0;g<k.length;g++){var p=k[g],n=p.x,r=p.y,z=p.text,t=p.angle,m=p.layer.labelSymbol;"polyline"==p.layer.geometry.type&&p.layer.options.labelRotation&&m.setAngle(180/Math.PI*t);m.setText(z);m instanceof u&&(z=m.getHeight(),n-=.25*z*this._scale*Math.sin(t),r-=.33*z*this._scale);t=new a(new I(n,r,e.extent.spatialReference));t.setParentGraphic(p.layer.graphic);t.setSymbol(m);this.add(t)}},_addLabels:function(a,e,k,g){var p,n,u,r;if(this._isWithinScaleRange(e.minScale,
e.maxScale)&&k&&""!==k){var z=this._map,f=!a.url&&!z.spatialReference.equals(a.spatialReference);for(p=0;p<a.graphics.length;p++)if(n=a.graphics[p],!1!==n.visible&&!n._suspended){if(u=n.geometry,f){if(!L.canProject(u,z))continue;u=L.project(u,z)}u&&this._isWhere(e.where,n.attributes)&&this._isWithinScreenArea(u)&&(r=this._buildLabelText(k,n,a.fields,g),this._addLabel(r,e,a.renderer,n,g,u,z))}}},_isWithinScreenArea:function(a){if(void 0===(a="point"===a.type?new M(a.x,a.y,a.x,a.y,a.spatialReference):
a.getExtent()))return!1;a=this._intersects(this._map,a);return null!==a&&0!==a.length},_isWithinScaleRange:function(a,e){var k=this._map.getScale();return!(0<a&&k>=a)&&!(0<e&&k<e)},_isWhere:function(a,e){try{if(!a)return!0;if(a){var k=a.split(" ");if(3===k.length)return this._sqlEquation(e[this._removeQuotes(k[0])],k[1],this._removeQuotes(k[2]));if(7===k.length){var g=this._sqlEquation(e[this._removeQuotes(k[0])],k[1],this._removeQuotes(k[2])),p=k[3],n=this._sqlEquation(e[this._removeQuotes(k[4])],
k[5],this._removeQuotes(k[6]));switch(p){case "AND":return g&&n;case "OR":return g||n}}}return!1}catch(V){console.log("Error.: can't parse \x3d "+a)}},_sqlEquation:function(a,e,k){switch(e){case "\x3d":return a==k;case "\x3c\x3e":return a!=k;case "\x3e":return a>k;case "\x3e\x3d":return a>=k;case "\x3c":return a<k;case "\x3c\x3d":return a<=k}return!1},_removeQuotes:function(a){var e=a.indexOf('"'),k=a.lastIndexOf('"');return-1!=e&&-1!=k?a.substr(1,a.length-2):(e=a.indexOf("'"),k=a.lastIndexOf("'"),
-1!=e&&-1!=k?a.substr(1,a.length-2):a)},_getSizeInfo:function(a){return a?a.sizeInfo||y.filter(a.visualVariables,R)[0]:null},_addLabel:function(a,e,k,g,p,n,t){var A,w,f,x;if(a&&""!==m.trim(a)&&e){a=a.replace(/\s+/g," ");A=e.getSymbol(g);A instanceof u?(A=new u(A.toJson()),A.setVerticalAlignment("baseline"),A.setHorizontalAlignment("center")):A=A instanceof z?new z(A.toJson()):new u;A.setText(a);e.symbol=A;f=this._getProportionalSize(e.sizeInfo,g.attributes);if(f&&(A instanceof u?A.setSize(f):A instanceof
z&&(A.setWidth(f),A.setHeight(f))),f=0,x=0,k){w=k.getSymbol(g);var C=this._getSizeInfo(k);(k=C?k.getSize(g,{sizeInfo:C,resolution:t.getResolutionInMeters()}):g.size)&&null!==k?f=x=k:w&&("simplemarkersymbol"==w.type?(f=w.size,x=w.size):"picturemarkersymbol"==w.type?(f=w.width,x=w.height):"simplelinesymbol"!=w.type&&"cartographiclinesymbol"!=w.type||(f=w.width))}k={};k.graphic=g;k.options=p;k.geometry=n;k.labelRenderer=e;k.labelSymbol=A;k.labelWidth=A.getWidth()/2;k.labelHeight=A.getHeight()/2;k.symbolWidth=
r.normalizedLength(f)/2;k.symbolHeight=r.normalizedLength(x)/2;k.text=a;k.angle=A.angle;this._preparedLabels.push(k)}},_buildLabelText:function(a,e,p,n){if(n.hasExpression)return a=K.getEvalOptions({expression:n.arcadeExpr,feature:e,layer:e.getLayer(),spatialReference:this._map.spatialReference}),e=e.evaluateExpression(n.arcadeExpr,a),A.isDefined(e)?""+e:"";var u=e.attributes;return a.replace(/{[^}]*}/g,function(a){var e,r=a;for(e=0;e<p.length;e++){if("{"+p[e].name+"}"==a){var r=u[p[e].name],z=p[e].domain;
if(z&&m.isObject(z)){if("codedValue"==z.type&&n.useCodedValues)for(e=r,a=0;a<z.codedValues.length;a++)if(z.codedValues[a].code==e){r=z.codedValues[a].name;break}break}z=p[e].type;if(n.fieldInfos){var f=n.fieldInfos;for(e=0;e<f.length;e++)if("{"+f[e].fieldName+"}"==a){a=f[e].format;"esriFieldTypeDate"==z?(a="DateFormat"+k.prototype._dateFormats[a.dateFormat?a.dateFormat:"shortDate"])&&(r=A.substitute({myKey:r},"${myKey:"+a+"}")):"esriFieldTypeInteger"!=z&&"esriFieldTypeSingle"!=z&&"esriFieldTypeSmallInteger"!=
z&&"esriFieldTypeLong"!=z&&"esriFieldTypeDouble"!=z||a&&(r=w.format(r,{places:a.places}),a.digitSeparator||g.group&&(r=r.replace(new RegExp("\\"+g.group,"g"),"")));break}}break}r=""}return null==r?"":r})},_getLabelExpression:function(a){var e="";return a.labelExpressionInfo?e=a.labelExpressionInfo.value||a.labelExpressionInfo.expression:this._validSyntax(a.labelExpression)&&(e=this._convertLabelExpression(a.labelExpression)),e},_validSyntax:function(a){return/^(\s*\[[^\]]+\]\s*)+$/i.test(a)},_convertLabelExpression:function(a){return a.replace(/\[/g,
"{").replace(/\]/g,"}")},_getProportionalSize:function(a,e){if(!a)return null;e=A.substitute(e,"${"+a.field+"}",{first:!0});return a.minSize&&a.maxSize&&a.minDataValue&&a.maxDataValue&&e&&!(0>=a.maxDataValue-a.minDataValue)?(a.maxSize-a.minSize)/(a.maxDataValue-a.minDataValue)*(e-a.minDataValue)+a.minSize:null},_convertOptions:function(a){var k,g,p=!0,n="shortDate",u=null,r=null,z="",t="AboveRight",f="PlaceAtCenter",m="Above",A=!0;if(a&&(a.format&&(n=a.format.dateFormat,u={places:a.format.places,
digitSeparator:a.format.digitSeparator}),r=a.fieldInfos,z=a.labelPlacement,null!=a.useCodedValues&&(p=a.useCodedValues),a=a.labelExpressionInfo)){var c=a.expression;c&&!a.value&&(g=!0,k=new e({expression:c,returnType:"string",profile:K}))}return t="above-center"==z||"esriServerPointLabelPlacementAboveCenter"==z?"AboveCenter":"above-left"==z||"esriServerPointLabelPlacementAboveLeft"==z?"AboveLeft":"above-right"==z||"esriServerPointLabelPlacementAboveRight"==z?"AboveRight":"below-center"==z||"esriServerPointLabelPlacementBelowCenter"==
z?"BelowCenter":"below-left"==z||"esriServerPointLabelPlacementBelowLeft"==z?"BelowLeft":"below-right"==z||"esriServerPointLabelPlacementBelowRight"==z?"BelowRight":"center-center"==z||"esriServerPointLabelPlacementCenterCenter"==z?"CenterCenter":"center-left"==z||"esriServerPointLabelPlacementCenterLeft"==z?"CenterLeft":"center-right"==z||"esriServerPointLabelPlacementCenterRight"==z?"CenterRight":"AboveRight",f="above-start"==z||"below-start"==z||"center-start"==z?"PlaceAtStart":"above-end"==z||
"below-end"==z||"center-end"==z?"PlaceAtEnd":"PlaceAtCenter",m="above-after"==z||"esriServerLinePlacementAboveAfter"==z||"above-along"==z||"esriServerLinePlacementAboveAlong"==z||"above-before"==z||"esriServerLinePlacementAboveBefore"==z||"above-start"==z||"esriServerLinePlacementAboveStart"==z||"above-end"==z||"esriServerLinePlacementAboveEnd"==z?"Above":"below-after"==z||"esriServerLinePlacementBelowAfter"==z||"below-along"==z||"esriServerLinePlacementBelowAlong"==z||"below-before"==z||"esriServerLinePlacementBelowBefore"==
z||"below-start"==z||"esriServerLinePlacementBelowStart"==z||"below-end"==z||"esriServerLinePlacementBelowEnd"==z?"Below":"center-after"==z||"esriServerLinePlacementCenterAfter"==z||"center-along"==z||"esriServerLinePlacementCenterAlong"==z||"center-before"==z||"esriServerLinePlacementCenterBefore"==z||"center-start"==z||"esriServerLinePlacementCenterStart"==z||"center-end"==z||"esriServerLinePlacementCenterEnd"==z?"OnLine":"Above","always-horizontal"!=z&&"esriServerPolygonPlacementAlwaysHorizontal"!=
z||(A=!1),{useCodedValues:p,dateFormat:n,numberFormat:u,fieldInfos:r,pointPriorities:t,lineLabelPlacement:f,lineLabelPosition:m,labelRotation:A,howManyLabels:"OneLabel",hasExpression:g,arcadeExpr:k}}});return t("extend-esri")&&m.setObject("layers.LabelLayer",B,n),B})},"esri/layers/labelLayerUtils/DynamicLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Polygon".split(" "),function(B,m,y,x,g,w){B=B(null,{declaredClass:"esri.layers.labelLayerUtils.DynamicLabelClass",
constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._y1=this._x1=this._y0=this._x0=this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1},setMap:function(g,r){this._labelLayer=r;this._xmin=g.extent.xmin;this._xmax=g.extent.xmax;this._ymin=g.extent.ymin;this._ymax=g.extent.ymax;this._scale=(this._xmax-this._xmin)/g.width},_process:function(g){this._preparedLabels=g;this._placedLabels=[];var r;for(g=this._preparedLabels.length-1;0<=g;g--){var n=this._preparedLabels[g],
t=Math.min(n.labelWidth,n.labelHeight),a=n.labelWidth+0*t,t=n.labelHeight+0*t,k=(r=n.options)&&void 0!==r.lineLabelPlacement?r.lineLabelPlacement:"PlaceAtCenter",e=r&&void 0!==r.lineLabelPosition?r.lineLabelPosition:"Above",p=r&&void 0!==r.pointPriorities?r.pointPriorities:"AboveRight",u=[2,2,1,3,0,2,3,3,2];"AboveLeft"==p?u=[1,2,2,2,0,3,2,3,3]:"AboveCenter"==p?u=[2,1,2,2,0,2,3,3,3]:"AboveRight"==p?u=[2,2,1,3,0,2,3,3,2]:"CenterLeft"==p?u=[2,2,3,1,0,3,2,2,3]:"CenterCenter"==p?u=[0,0,0,0,1,0,0,0,0]:
"CenterRight"==p?u=[3,2,2,3,0,1,3,2,2]:"BelowLeft"==p?u=[2,3,3,2,0,3,1,2,2]:"BelowCenter"==p?u=[3,3,3,2,0,2,2,1,2]:"BelowRight"==p&&(u=[3,3,2,3,0,2,2,2,1]);var z=!r||void 0===r.labelRotation||r.labelRotation,p=Math.PI/180*n.angle;if(r=r&&void 0!==r.howManyLabels?r.howManyLabels:"OneLabel","point"==n.geometry.type)this._generatePointPositions(n,n.geometry.x,n.geometry.y,n.text,p,a,t,n.symbolWidth,n.symbolHeight,u);else if("multipoint"==n.geometry.type)for(e=n.geometry,k=0;k<e.points.length;k++)this._generatePointPositions(n,
e.points[k][0],e.points[k][1],n.text,p,a,t,n.symbolWidth,n.symbolHeight,u);else"polyline"==n.geometry.type?this._generateLinePositions(n,n.geometry,n.text,a,t,2*n.symbolHeight+t,k,e,z):"polygon"==n.geometry.type&&this._generatePolygonPositions(n,r,n.geometry,n.text,p,a,t)}return this._placedLabels},_generatePointPositions:function(g,r,n,m,a,k,e,p,u,z){var t;p=(p+k)*this._scale;var A=(u+e)*this._scale;for(u=1;3>=u;u++)for(t=1;9>=t;t++)if(z[t-1]==u)switch(t){case 1:if(this._findPlace(g,m,r-p,n+A,a,
k,e))return;break;case 2:if(this._findPlace(g,m,r,n+A,a,k,e))return;break;case 3:if(this._findPlace(g,m,r+p,n+A,a,k,e))return;break;case 4:if(this._findPlace(g,m,r-p,n,a,k,e))return;break;case 5:if(this._findPlace(g,m,r,n,a,k,e))return;break;case 6:if(this._findPlace(g,m,r+p,n,a,k,e))return;break;case 7:if(this._findPlace(g,m,r-p,n-A,a,k,e))return;break;case 8:if(this._findPlace(g,m,r,n-A,a,k,e))return;break;case 9:if(this._findPlace(g,m,r+p,n-A,a,k,e))return}},_generateLinePositions:function(g,r,
n,m,a,k,e,p,u){var z,t,A,w=m*this._scale*m*this._scale;for(z=0;z<r.paths.length;z++){var x=r.paths[z],y=x.length,B=Math.floor((y-1)/2),C=0!=(y-1)%2?1:-1;"PlaceAtStart"==e&&(B=0,C=1);for("PlaceAtEnd"==e&&(B=y-2,C=-1);0<=B&&B<y-1;){for(t=B;t<y;t++){var J=x[B][0],O=x[B][1],R=x[t][0]-J,Q=x[t][1]-O;if(R*R+Q*Q>w){for(var T=Math.atan2(Q,R);T>Math.PI/2;)T-=Math.PI;for(;T<-Math.PI/2;)T+=Math.PI;var S=Math.sin(T),U=Math.cos(T),X=0,W=0;if("Above"==p&&(X=k*S*this._scale,W=k*U*this._scale),"Below"==p&&(X=-k*S*
this._scale,W=-k*U*this._scale),1==t-B){if(this._clipLine(J,O,x[t][0],x[t][1])&&(t=this._x1-this._x0,A=this._y1-this._y0,t*t+A*A>w)){var V,Y,J=Math.atan2(A,t),R=m/2+2*a,O=R*this._scale*Math.cos(J),R=R*this._scale*Math.sin(J);if("PlaceAtStart"==e?(V=this._x0+O,Y=this._y0+R):"PlaceAtEnd"==e?(V=this._x1-O,Y=this._y1-R):(V=this._x0+t/2,Y=this._y0+A/2),this._findPlace(g,n,V-X,Y+W,u?-J:0,m,a))return}}else{var Z=0;for(A=B;A<=t;A++)Z=Math.max(Z,Math.abs((x[A][1]-O)*U-(x[A][0]-J)*S));if(Z<a&&this._findPlace(g,
n,J+R/2-X,O+Q/2+W,u?-T:0,m,a))return}break}}B+=C}}},_generatePolygonPositions:function(g,r,n,m,a,k,e){var p;if("ManyLabels"==r)for(r=0;r<n.rings.length;r++){var u=n.rings[r];w.prototype.isClockwise(u)&&(p=this._findCentroid(u,this._xmin,this._ymin,this._xmax,this._ymax),this._findPlace(g,m,p[0],p[1],a,k,e))}else{p=this._findCentroidForFeature(n,this._xmin,this._ymin,this._xmax,this._ymax);var u=p[1],z=0;for(r=0;10>r&&(z+=e/4,p=this._findCentroidForFeature(n,this._xmin,u+(z-e/4),this._xmax,u+(z+e/
4)),!this._findPlace(g,m,p[0],p[1],a,k,e))&&(p=this._findCentroidForFeature(n,this._xmin,u-(z+e/4),this._xmax,u-(z-e/4)),!this._findPlace(g,m,p[0],p[1],a,k,e));r++);}},_findCentroid:function(g,r,n,m,a){var k=g.length,e=[0,0],p=0,u=g[0][0],z=g[0][1];u>m&&(u=m);u<r&&(u=r);z>a&&(z=a);z<n&&(z=n);for(var t=1;t<k-1;t++){var A=g[t][0],w=g[t][1],x=g[t+1][0],y=g[t+1][1];A>m&&(A=m);A<r&&(A=r);w>a&&(w=a);w<n&&(w=n);x>m&&(x=m);x<r&&(x=r);y>a&&(y=a);y<n&&(y=n);var B=(A-u)*(y-z)-(x-u)*(w-z);e[0]+=B*(u+A+x);e[1]+=
B*(z+w+y);p+=B}if(e[0]/=3*p,e[1]/=3*p,isNaN(e[0])||isNaN(e[1]))return e;n=[];return this._fillBuffer(g,n,e),e[0]=this._sortBuffer(n,e[0],r,m),e},_findCentroidForFeature:function(g,r,n,m,a){for(var k,e=0,p=[0,0],u=0;u<g.rings.length;u++){var z=g.rings[u],t=z.length,A=z[0][0],w=z[0][1];A>m&&(A=m);A<r&&(A=r);w>a&&(w=a);w<n&&(w=n);for(k=1;k<t-1;k++){var x=z[k][0],y=z[k][1],B=z[k+1][0],C=z[k+1][1];x>m&&(x=m);x<r&&(x=r);y>a&&(y=a);y<n&&(y=n);B>m&&(B=m);B<r&&(B=r);C>a&&(C=a);C<n&&(C=n);var J=(x-A)*(C-w)-
(B-A)*(y-w);p[0]+=J*(A+x+B);p[1]+=J*(w+y+C);e+=J}}if(p[0]/=3*e,p[1]/=3*e,isNaN(p[0])||isNaN(p[1]))return p;n=[];for(k=0;k<g.rings.length;k++)this._fillBuffer(g.rings[k],n,p);return p[0]=this._sortBuffer(n,p[0],r,m),p},_fillBuffer:function(g,r,n){for(var t=g.length-1,a=g[0][1]>=g[t][1]?1:-1,k=0;k<=t;k++){var e=k,p=k+1;k==t&&(p=0);var u=g[e][0],e=g[e][1],z=g[p][0],p=g[p][1],m=p>=e?1:-1;if(e<=n[1]&&n[1]<=p||p<=n[1]&&n[1]<=e)n[1]!=e&&n[1]!=p?(r.push((n[1]-e)*(z-u)/(p-e)+u),a=m):n[1]==e&&n[1]!=p?(a!=m&&
r.push(u),a=m):n[1]!=e&&n[1]==p?(r.push(z),a=m):n[1]==e&&n[1]==p&&(1==a&&r.push(u),r.push(z),a=m)}},_sortBuffer:function(g,r,n,m){var a=g.length;if(g.sort(),0<a){for(var k=0,e=r=0;e<a-1;e+=2){var p=Math.abs(g[e+1]-g[e]);g[e]<=n&&g[e+1]<=n||g[e]>=m&&g[e+1]>=m||p>k&&(k=p,r=e)}a=g[r];g=g[r+1];a>m&&(a=m);a<n&&(a=n);g>m&&(g=m);g<n&&(g=n);r=(a+g)/2}return r},_findPlace:function(t,r,n,m,a,k,e){if(isNaN(n)||isNaN(m))return!1;for(var p=0;p<this._placedLabels.length;p++){var u=this._placedLabels[p].angle,z=
this._placedLabels[p].width*this._scale,A=this._placedLabels[p].height*this._scale,x=this._placedLabels[p].x-n,y=this._placedLabels[p].y-m;if(0===a&&0===u){if(this._findPlace2(-k*this._scale,-e*this._scale,k*this._scale,e*this._scale,x-z,y-A,x+z,y+A))return!1}else{var B=new g(-k*this._scale,-e*this._scale,k*this._scale,e*this._scale,null),K=0,N=1;0!==a&&(K=Math.sin(a),N=Math.cos(a));var C=x*N-y*K,x=x*K+y*N,u=u-a,K=Math.sin(u),N=Math.cos(u),J=-z*N- -A*K,y=-z*K+-A*N,u=+z*N- -A*K,O=+z*K+-A*N,z=C+J,A=
x-y,K=C+u,N=x-O,J=C-J,y=x+y,C=C-u,x=x+O,u=new w;if(u.addRing([[z,A],[K,N],[J,y],[C,x],[z,A]]),B.intersects(u))return!1}}for(;a>Math.PI/2;)a-=Math.PI;for(;a<-Math.PI/2;)a+=Math.PI;p={};return p.layer=t,p.text=r,p.angle=a,p.x=n,p.y=m,p.width=k,p.height=e,this._placedLabels.push(p),!0},_findPlace2:function(g,r,n,m,a,k,e,p){return(g>=a&&g<=e||n>=a&&n<=e||g<=a&&n>=e)&&(r>=k&&r<=p||m>=k&&m<=p||r<=k&&m>=p)},_clipLine:function(g,r,n,m){for(var a=this._code(g,r),k=this._code(n,m);0!==a||0!==k;){if(0!=(a&k))return!1;
var e=n-g,p=m-r;0!==a?(g<this._xmin?(r+=p*(this._xmin-g)/e,g=this._xmin):g>this._xmax?(r+=p*(this._xmax-g)/e,g=this._xmax):r<this._ymin?(g+=e*(this._ymin-r)/p,r=this._ymin):r>this._ymax&&(g+=e*(this._ymax-r)/p,r=this._ymax),a=this._code(g,r)):(n<this._xmin?(m+=p*(this._xmin-n)/e,n=this._xmin):n>this._xmax?(m+=p*(this._xmax-n)/e,n=this._xmax):m<this._ymin?(n+=e*(this._ymin-m)/p,m=this._ymin):m>this._ymax&&(n+=e*(this._ymax-m)/p,m=this._ymax),k=this._code(n,m))}return this._x0=g,this._y0=r,this._x1=
n,this._y1=m,!0},_code:function(g,r){var n=0;return g<this._xmin&&(n+=8),g>this._xmax&&(n+=4),r<this._ymin&&(n+=2),r>this._ymax&&(n+=1),n}});return y("extend-esri")&&m.setObject("layers.labelLayerUtils.DynamicLabelClass",B,x),B})},"esri/layers/labelLayerUtils/StaticLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Point ../../geometry/Polygon".split(" "),function(B,m,y,x,g,w,t){return B(null,{declaredClass:"esri.layers.labelLayerUtils.StaticLabel",
constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1;this._LINE_STEP_CONST=1.5;this._POLYGON_X_STEP_CONST=1;this._POLYGON_Y_STEP_CONST=.75;this._OVERRUN=2},setMap:function(g,n){this._labelLayer=n;this._map=g;this._xmin=g.extent.xmin;this._xmax=g.extent.xmax;this._ymin=g.extent.ymin;this._ymax=g.extent.ymax;this._scale=(this._xmax-this._xmin)/g.width},_process:function(g){var n,r,a,k,e,p,u,z,m;this._preparedLabels=
g;this._placedLabels=[];for(g=this._preparedLabels.length-1;0<=g;g--){n=this._preparedLabels[g];e=n.labelWidth;p=n.labelHeight;z=(u=n.options)&&u.lineLabelPlacement?u.lineLabelPlacement:"PlaceAtCenter";m=u&&u.lineLabelPosition?u.lineLabelPosition:"Above";r=!u||!u.labelRotation||u.labelRotation;a=Math.PI/180*n.angle;k=u&&u.howManyLabels?u.howManyLabels:"OneLabel";var x=[];if("point"===n.geometry.type)this._generatePointPositions(n.geometry.x,n.geometry.y,n.text,a,e,p,n.symbolWidth,n.symbolHeight,u,
x);else if("multipoint"===n.geometry.type)for(r=0;r<n.geometry.points.length;r++)this._generatePointPositions(n.geometry.points[r][0],n.geometry.points[r][1],n.text,a,e,p,n.symbolWidth,n.symbolHeight,u,x);else if("polyline"===n.geometry.type)if("PlaceAtStart"===z)this._generateLinePositionsPlaceAtStart(n.geometry,!0,n.text,e,p,2*n.symbolHeight+p,z,m,r,x);else if("PlaceAtEnd"===z)this._generateLinePositionsPlaceAtEnd(n.geometry,!0,n.text,e,p,2*n.symbolHeight+p,z,m,r,x);else{u=[];var y=n.geometry.getExtent(),
B=this._map.extent;if(y.getWidth()<e*this._scale/this._OVERRUN&&y.getHeight()<e*this._scale/this._OVERRUN)continue;.5*y.getWidth()<B.getWidth()&&.5*y.getHeight()<B.getHeight()?this._generateLinePositionsPlaceAtCenter(n.geometry,!1,.1*Math.min(this._map.width,this._map.height)*this._scale,n.text,e,p,2*n.symbolHeight+p,z,m,r,u):this._generateLinePositionsPlaceAtCenter(n.geometry,!0,.2*Math.min(this._map.width,this._map.height)*this._scale,n.text,e,p,2*n.symbolHeight+p,z,m,r,u);this._postSorting(B,u,
x)}else if("polygon"===n.geometry.type){z=[];for(r=0;r<n.geometry.rings.length;r++)m=n.geometry.rings[r],1<n.geometry.rings.length&&!t.prototype.isClockwise(m)||(u=this._calcRingExtent(m),u.xmax-u.xmin<4*e*this._scale/this._OVERRUN&&u.ymax-u.ymin<4*p*this._scale/this._OVERRUN||z.push(m));z.sort(function(a,e){return e.length-a.length});for(r=0;r<z.length;r++)this._generatePolygonPositionsForManyLabels(z[r],n.geometry.spatialReference,n.text,a,e,p,x)}for(r=0;r<x.length&&(z=x[r].x,m=x[r].y,void 0!==
x[r].angle&&(a=x[r].angle),u=this._findPlace(n,n.text,z,m,a,e,p),"OneLabel"!==k||!u||!this._labelLayer._isWithinScreenArea(new w(z,m,n.geometry.spatialReference)));r++);}return this._placedLabels},_generatePointPositions:function(g,n,m,a,k,e,p,u,z,t){var r;switch(r=z&&z.pointPriorities?z.pointPriorities:"AboveRight",m=(p+k)*this._scale,e=(u+e)*this._scale,r.toLowerCase()){case "aboveleft":g-=m;n+=e;break;case "abovecenter":n+=e;break;case "aboveright":g+=m;n+=e;break;case "centerleft":g-=m;break;
case "centercenter":break;case "centerright":g+=m;break;case "belowleft":g-=m;n-=e;break;case "belowcenter":n-=e;break;case "belowright":g+=m;n-=e;break;default:return}t.push({x:g,y:n})},_generateLinePositionsPlaceAtStart:function(g,n,m,a,k,e,p,u,z,t){var r,A,w,x,y,C,J,M=a*this._scale,B=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale;for(p=0;p<g.paths.length;p++){var Q=g.paths[p],T=M,S=0;for(r=0;r<Q.length-1;r++)A=Q[r][0],w=Q[r][1],x=Q[r+1][0],y=Q[r+1][1],C=x-A,J=y-w,
C=Math.sqrt(C*C+J*J),S+C>T?(S=this._generatePositionsOnLine(g.spatialReference,n,T,B,S,A,w,x,y,m,a,k,e,u,z,t),T=B):S+=C}},_generateLinePositionsPlaceAtEnd:function(g,n,m,a,k,e,p,u,z,t){var r,A,w,x,y,C,J,M=a*this._scale,B=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale;for(p=0;p<g.paths.length;p++){var Q=g.paths[p],T=M,S=0;for(r=Q.length-2;0<=r;r--)A=Q[r+1][0],w=Q[r+1][1],x=Q[r][0],y=Q[r][1],C=x-A,J=y-w,C=Math.sqrt(C*C+J*J),S+C>T?(S=this._generatePositionsOnLine(g.spatialReference,
n,T,B,S,A,w,x,y,m,a,k,e,u,z,t),T=B):S+=C}},_generateLinePositionsPlaceAtCenter:function(g,n,m,a,k,e,p,u,z,t,w){var r,A,x,y,C,J,M,I;for(u=0;u<g.paths.length;u++){var B=g.paths[u];if(!(2>B.length)){if(2==B.length){y=B[0];r=B[1];x=y[0];y=y[1];B=r[0];J=r[1];C=(B-x)*(B-x)+(J-y)*(J-y);M=Math.atan2(J-y,B-x);J=Math.cos(M);M=Math.sin(M);B=[];I=x;for(var T=y;(I-x)*(I-x)+(T-y)*(T-y)<C;)B.push([I,T]),I+=m/2*J,T+=m/2*M;B.push(r)}var S=0;for(r=0;r<B.length-1;r++)x=B[r][0],y=B[r][1],C=B[r+1][0],J=B[r+1][1],M=C-
x,I=J-y,S+=Math.sqrt(M*M+I*I);for(r=T=0;r<B.length-1;r++){x=B[r][0];y=B[r][1];C=B[r+1][0];J=B[r+1][1];M=C-x;I=J-y;M=Math.sqrt(M*M+I*I);if(T+M>S/2)break;T+=M}r==B.length-1&&r--;x=B[r][0];y=B[r][1];C=B[r+1][0];J=B[r+1][1];M=C-x;I=J-y;T=S/2-T;M=Math.atan2(I,M);I=x+T*Math.cos(M);M=y+T*Math.sin(M);C=this._angleAndShifts(x,y,C,J,p,z,t);w.push({x:I+C.shiftX,y:M+C.shiftY,angle:C.angle});var S=I,U=M,T=0;for(A=r;A<B.length-1;A++)A==r?(x=S,y=U):(x=B[A][0],y=B[A][1]),C=B[A+1][0],J=B[A+1][1],M=C-x,I=J-y,M=Math.sqrt(M*
M+I*I),T+M>m?T=this._generatePositionsOnLine(g.spatialReference,n,m,m,T,x,y,C,J,a,k,e,p,z,t,w):T+=M;T=0;for(A=r;0<=A;A--)A==r?(x=S,y=U):(x=B[A+1][0],y=B[A+1][1]),C=B[A][0],J=B[A][1],M=C-x,I=J-y,M=Math.sqrt(M*M+I*I),T+M>m?T=this._generatePositionsOnLine(g.spatialReference,n,m,m,T,x,y,C,J,a,k,e,p,z,t,w):T+=M}}},_generatePositionsOnLine:function(r,n,m,a,k,e,p,u,z,t,w,x,y,B,N,C){t=Math.atan2(z-p,u-e);w=e;x=p;for(var A=w,M=x;;){k=m-k;if(w+=k*Math.cos(t),x+=k*Math.sin(t),!this._belongs(w,x,e,p,u,z))return r=
u-A,z-=M,Math.sqrt(r*r+z*z);k=this._angleAndShifts(e,p,u,z,y,B,N);m=w+k.shiftX;M=x+k.shiftY;n?this._labelLayer._isWithinScreenArea(new g(m,M,m,M,r))&&C.push({x:m,y:M,angle:k.angle}):C.push({x:m,y:M,angle:k.angle});A=w;M=x;k=0;m=a}},_postSorting:function(g,n,m){if(g&&0<n.length){var a=.5*(g.xmin+g.xmax);g=.5*(g.ymin+g.ymax);for(var k=n[0].x,e=n[0].y,p=Math.sqrt((k-a)*(k-a)+(e-g)*(e-g)),u=n[0].angle,r=0;r<n.length;r++){var t=n[r].x,A=n[r].y,w=Math.sqrt((t-a)*(t-a)+(A-g)*(A-g));w<p&&(r,k=t,e=A,p=w,u=
n[r].angle)}m.push({x:k,y:e,angle:u})}},_belongs:function(g,n,m,a,k,e){if(k==m&&e==a)return!1;if(k>m){if(g>k||g<m)return!1}else if(g<k||g>m)return!1;if(e>a){if(n>e||n<a)return!1}else if(n<e||n>a)return!1;return!0},_angleAndShifts:function(g,n,m,a,k,e,p){for(g=Math.atan2(a-n,m-g);g>Math.PI/2;)g-=Math.PI;for(;g<-Math.PI/2;)g+=Math.PI;a=Math.sin(g);var u=Math.cos(g);m=n=0;"Above"==e&&(n=k*a*this._scale,m=k*u*this._scale);"Below"==e&&(n=-k*a*this._scale,m=-k*u*this._scale);k=[];return k.angle=p?-g:0,
k.shiftX=-n,k.shiftY=m,k},_generatePolygonPositionsForManyLabels:function(g,n,m,a,k,e,p){k=this._findCentroidForRing(g);a=k[0];var u=k[1],r=this._calcRingExtent(g);k=r.xmin;e=r.ymin;var t=r.xmax,r=r.ymax,A=(r-e)/(this._map.height*this._scale);if(!(10<(t-k)/(this._map.width*this._scale)&&10<A)){var w=!0;(t-k>this._map.width*this._scale||r-e>this._map.height*this._scale)&&(w=!1);var A=this._map.width*this._scale*(w?.1875:.5),w=this._map.height*this._scale*(w?.1875:.5),x=!0,y=!0,B=0;do{if(u+=(B%2?-1:
1)*B*w,this._scanRingByX(m,n,g,a,u,k,t,A,p))break;u<e&&(x=!1);u>r&&(y=!1);B++}while(x||y)}},_scanRingByX:function(r,n,m,a,k,e,p,u,z){var t=!0,A=!0,w=0,x=1E3;do{a+=(w%2?-1:1)*w*u;var y=this._movePointInsideRing(m,a,k),B=this._labelLayer._isWithinScreenArea(new g(y,k,y,k,n)),C=this._isPointWithinRing(r,m,y,k);if(B&&C)return z.push({x:y,y:k}),!0;if(a<e&&(t=!1),a>p&&(A=!1),w++,0>=--x)return!0}while(t||A);return!1},_movePointInsideRing:function(g,n,m){for(var a=[],k=g.length-1,e=g[0][1]>=g[k][1]?1:-1,
p=0;p<=k;p++){var u=p,r=p+1;p==k&&(r=0);var t=g[u][0],u=g[u][1],A=g[r][0],r=g[r][1],w=r>=u?1:-1;if(u<=m&&m<=r||r<=m&&m<=u)m!=u&&m!=r?(a.push((m-u)*(A-t)/(r-u)+t),e=w):m==u&&m!=r?(e!=w&&a.push(t),e=w):m!=u&&m==r?(a.push(A),e=w):m==u&&m==r&&(1==e&&a.push(t),a.push(A),e=w)}a.sort(function(a,e){return a-e});g=a.length;if(0<g){for(p=m=n=0;p<g-1;p+=2)k=Math.abs(a[p+1]-a[p]),k>n&&(n=k,m=p);n=(a[m]+a[m+1])/2}return n},_calcRingExtent:function(r){var n,m;m=new g;for(n=0;n<r.length-1;n++){var a=r[n][0],k=r[n][1];
(void 0===m.xmin||a<m.xmin)&&(m.xmin=a);(void 0===m.ymin||k<m.ymin)&&(m.ymin=k);(void 0===m.xmax||a>m.xmax)&&(m.xmax=a);(void 0===m.ymax||k>m.ymax)&&(m.ymax=k)}return m},_isPointWithinPolygon:function(g,n,m,a){var k;for(k=0;k<n.rings.length;k++)if(this._isPointWithinRing(g,n.rings[k],m,a))return!0;return!1},_isPointWithinRing:function(g,n,m,a){var k,e,p,u,r=[],t=n.length;for(g=0;g<t-1;g++)if(k=n[g][0],e=n[g][1],p=n[g+1][0],u=n[g+1][1],k!=p||e!=u){if(e==u){if(a!=e)continue;r.push(k)}if(k==p)e<u&&a>=
e&&a<u&&r.push(k),e>u&&a<=e&&a>u&&r.push(k);else{var A=(p-k)/(u-e)*(a-e)+k;k<p&&A>=k&&A<p&&r.push(A);k>p&&A<=k&&A>p&&r.push(A)}}r.sort(function(a,e){return a-e});for(g=0;g<r.length-1;g++)if(k=r[g],p=r[g+1],m>=k&&m<p)return!(g%2);return!1},_findCentroidForRing:function(g){for(var n=g.length,r=[0,0],a=0,k=g[0][0],e=g[0][1],p=1;p<n-1;p++){var u=g[p][0],z=g[p][1],m=g[p+1][0],t=g[p+1][1],w=(u-k)*(t-e)-(m-k)*(z-e);r[0]+=w*(k+u+m);r[1]+=w*(e+z+t);a+=w}return r[0]/=3*a,r[1]/=3*a,r},_findCentroidForFeature:function(g){for(var n=
0,r=[0,0],a=0;a<g.rings.length;a++)for(var k=g.rings[a],e=k.length,p=k[0][0],u=k[0][1],z=1;z<e-1;z++){var m=k[z][0],t=k[z][1],w=k[z+1][0],x=k[z+1][1],y=(m-p)*(x-u)-(w-p)*(t-u);r[0]+=y*(p+m+w);r[1]+=y*(u+t+x);n+=y}return r[0]/=3*n,r[1]/=3*n,r},_findPlace:function(r,n,m,a,k,e,p){if(isNaN(m)||isNaN(a))return!1;for(var u=0;u<this._placedLabels.length;u++){var z=this._placedLabels[u].angle,w=this._placedLabels[u].width*this._scale,A=this._placedLabels[u].height*this._scale,x=this._placedLabels[u].x-m,
y=this._placedLabels[u].y-a;if(0===k&&0===z){if(this._findPlace2(-e*this._scale,-p*this._scale,e*this._scale,p*this._scale,x-w,y-A,x+w,y+A))return!1}else{var B=new g(-e*this._scale,-p*this._scale,e*this._scale,p*this._scale,null),N=0,C=1;0!==k&&(N=Math.sin(k),C=Math.cos(k));var J=x*C-y*N,x=x*N+y*C,z=z-k,N=Math.sin(z),C=Math.cos(z),O=-w*C- -A*N,y=-w*N+-A*C,z=+w*C- -A*N,R=+w*N+-A*C,w=J+O,A=x-y,N=J+z,C=x-R,O=J-O,y=x+y,J=J-z,x=x+R,z=new t;if(z.addRing([[w,A],[N,C],[O,y],[J,x],[w,A]]),B.intersects(z))return!1}}for(;k>
Math.PI/2;)k-=Math.PI;for(;k<-Math.PI/2;)k+=Math.PI;u={};return u.layer=r,u.text=n,u.angle=k,u.x=m,u.y=a,u.width=e,u.height=p,this._placedLabels.push(u),!0},_findPlace2:function(g,n,m,a,k,e,p,u){return(g>=k&&g<=p||m>=k&&m<=p||g<=k&&m>=p)&&(n>=e&&n<=u||a>=e&&a<=u||n<=e&&a>=u)}})})},"esri/dijit/Legend":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/debounce dojo/has dojo/sniff dojo/Deferred dojo/DeferredList dojo/json dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../numberUtils ../renderers/utils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../renderers/VectorFieldRenderer ../renderers/HeatmapRenderer ../symbols/PictureFillSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/utils ../symbols/jsonUtils ../renderers/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C,J,O,R,Q,T,S,U,X,W,V,Y,Z,f,aa,E,c,b,d,h,l){var q=Q.getClassValuesForRelationship(),v={defaultShape:{type:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15"},stroke:{width:1,color:"#555555"}},D={HH:315,HL:45,LL:135,LH:225},H=m([h,I],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:!1,layers:null,alignRight:!1,hoverLabelShowing:!1,_preserveCacheOnDestroy:!1,dotDensitySwatchSize:26,dotCoverage:75,gradientHeight:30,transparencyRampColor:new t([64,64,64]),
defaultText:"Aa",sizeRampLightColor:new t([255,255,255]),sizeRampDarkColor:new t([128,128,128]),layerConnects:[],gradientWidth:34,colorRampBorder:"1px solid",_specialChars:{lt:"\x3c",gt:"\x3e"},_ieTimer:100,_isRightToLeft:!1,_align:null,_legendAlign:null,constructor:function(b,c){return y.mixin(this,l.widgets.legend),this._i18n=l.widgets.legend,b=b||{},b.map?c?(this.map=b.map,this.layerInfos=b.layerInfos,this._respectCurrentMapScale=!1!==b.respectCurrentMapScale,this._respectVisibility=!1!==b.respectVisibility,
this._preserveCacheOnDestroy=!!b.preserveCacheOnDestroy,this.arrangement=b.arrangement===H.ALIGN_RIGHT?H.ALIGN_RIGHT:H.ALIGN_LEFT,this.arrangement===H.ALIGN_RIGHT&&(this.alignRight=!0),this.autoUpdate=!1!==b.autoUpdate,this._surfaceItems=[],this.hideLayersInLegend={},void(this.refresh=r(this.refresh,0))):void console.error("esri.dijit.Legend: must specify a container for the legend"):void console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")},postMixInProperties:function(){this.inherited(arguments);
var b,c,a=["ar","he"];for(b=0;b<a.length;b+=1)c=a[b],B.locale&&-1!==B.locale.indexOf(c)&&(-1!==B.locale.indexOf("-")?-1!==B.locale.indexOf(c+"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0);this._isRightToLeft?(this._align=this.alignRight?"left":"right",this._legendAlign=this.alignRight?"esriLegendLeft":"esriLegendRight"):(this._align=this.alignRight?"right":"left",this._legendAlign=this.alignRight?"esriLegendRight":"esriLegendLeft")},startup:function(){this.inherited(arguments);this._initialize();
9>n("ie")&&(this._repaintItems=y.hitch(this,this._repaintItems),setTimeout(this._repaintItems,this._ieTimer))},destroy:function(){this._deactivate();this._removeCachedLegendResponses();this._removeHoverHandlers();this.inherited(arguments)},_removeCachedLegendResponses:function(){this._preserveCacheOnDestroy||x.forEach(this.layers,function(b){delete b.legendResponse})},refresh:function(b){if(this.domNode){b?(this.layerInfos=b,this.layers=[],x.forEach(this.layerInfos,function(b){this._isSupportedLayerType(b.layer)&&
(b.title&&(b.layer._titleForLegend=b.title),b.layer._hideDefaultSymbol=!1===b.defaultSymbol,b.hideLayers?(this.hideLayersInLegend[b.layer.id]=b.hideLayers,this._addSubLayersToHide(b)):this.hideLayersInLegend[b.layer.id]=[],b.hoverLabel&&(b.layer._hoverLabel=b.hoverLabel),b.hoverLabels&&(b.layer._hoverLabels=b.hoverLabels),this.layers.push(b.layer))},this)):this.useAllMapLayers&&(this.layerInfos=null,this.layers=null);for(b=this.domNode.children.length-1;0<=b;b--)u.destroy(this.domNode.children[b]);
this._removeHoverHandlers();this.startup()}},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){if(this.layerInfos&&(this.layers=[],x.forEach(this.layerInfos,function(b){this._isSupportedLayerType(b.layer)&&(b.title&&(b.layer._titleForLegend=b.title),b.layer._hideDefaultSymbol=!1===b.defaultSymbol,b.hideLayers?(this.hideLayersInLegend[b.layer.id]=b.hideLayers,this._addSubLayersToHide(b)):this.hideLayersInLegend[b.layer.id]=[],b.hoverLabel&&(b.layer._hoverLabel=b.hoverLabel),
b.hoverLabels&&(b.layer._hoverLabels=b.hoverLabels),this.layers.push(b.layer))},this)),this.useAllMapLayers=!1,!this.layers){this.useAllMapLayers=!0;this.layers=[];var b=[],c=[];x.forEach(this.map.layerIds,function(a){var d;a=this.map.getLayer(a);this._isSupportedLayerType(a)&&(a.arcgisProps&&a.arcgisProps.title&&(a._titleForLegend=a.arcgisProps.title),this.layers.push(a));"esri.layers.KMLLayer"==a.declaredClass&&(d=a.getLayers(),x.forEach(d,function(c){b.push(c.id)},this));"esri.layers.GeoRSSLayer"==
a.declaredClass&&(d=a.getFeatureLayers(),x.forEach(d,function(b){c.push(b.id)},this))},this);x.forEach(this.map.graphicsLayerIds,function(a){var d=this.map.getLayer(a);-1==x.indexOf(b,a)&&-1==x.indexOf(c,a)&&this._isSupportedLayerType(d)&&this._isLayerDrawingEnabled(d)&&(d.arcgisProps&&d.arcgisProps.title&&(d._titleForLegend=d.arcgisProps.title),this.layers.push(d))},this)}this._createLegend()},_isLayerDrawingEnabled:function(b){return b&&(b._params&&b._params.drawMode||b.isFeatureReductionActive&&
b.isFeatureReductionActive())},_activate:function(){this._deactivate();this.autoUpdate&&(this._respectCurrentMapScale&&(this._ozeConnect=g.connect(this.map,"onZoomEnd",this,"_refreshLayers")),this.useAllMapLayers&&(this._olaConnect=g.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers"),this._olrConnect=g.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers"),this._olroConnect=g.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers")),x.forEach(this.layers,function(b){var c={};
c.oarcConnect=g.connect(b,"onFeatureReductionRendererChange",this,"_refreshLayers");c.oaicConnect=g.connect(b,"onFeatureReductionChange",this,"_refreshLayers");c.ovcConnect=g.connect(b,"onVisibilityChange",this,"_refreshLayers");c.oocConnect=g.connect(b,"onOpacityChange",this,"_refreshLayers");c.oscConnect=g.connect(b,"onScaleRangeChange",this,"_refreshLayers");"esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass&&b.supportsDynamicLayers&&(c.odcConnect=g.connect(b,"_onDynamicLayersChange",
y.hitch(this,"_updateDynamicLayers",b)));"esri.layers.ArcGISImageServiceLayer"===b.declaredClass&&(c.oirConnect=g.connect(b,"onRenderingChange",y.partial(this._updateImageServiceLayers,this,b)),c.oivrConnect=g.connect(b,"onRendererChange",y.partial(this._updateImageServiceLayers,this,b)));"esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass&&(c.oivrConnect=g.connect(b,"onRendererChange",y.hitch(this,"_refreshLayers")));this.layerConnects[b.id]=c},this))},_deactivate:function(){this._ozeConnect&&
g.disconnect(this._ozeConnect);this._olaConnect&&g.disconnect(this._olaConnect);this._olroConnect&&g.disconnect(this._olroConnect);this._olrConnect&&g.disconnect(this._olrConnect);x.forEach(this.layers,function(b){b=this.layerConnects[b.id]||{};b.oarcConnect&&g.disconnect(b.oarcConnect);b.oaicConnect&&g.disconnect(b.oaicConnect);b.ovcConnect&&g.disconnect(b.ovcConnect);b.oocConnect&&g.disconnect(b.oocConnect);b.oscConnect&&g.disconnect(b.oscConnect);b.odcConnect&&g.disconnect(b.odcConnect);b.oirConnect&&
g.disconnect(b.oirConnect);b.oivrConnect&&g.disconnect(b.oivrConnect)},this);this.layerConnects=[]},_updateDynamicLayers:function(b){delete b.legendResponse;this._refreshLayers()},_updateImageServiceLayers:function(b,c){delete c.legendResponse;b._refreshLayers()},_refreshLayers:function(){this.refresh()},_updateAllMapLayers:function(){this.layers=[];x.forEach(this.map.layerIds,function(b){b=this.map.getLayer(b);this._isSupportedLayerType(b)&&this.layers.push(b)},this);x.forEach(this.map.graphicsLayerIds,
function(b){b=this.map.getLayer(b);this._isSupportedLayerType(b)&&this._isLayerDrawingEnabled(b)&&this.layers.push(b)},this);this.refresh()},_createLegend:function(){var b=!1,c=!1;z.set(this.domNode,"position","relative");u.create("div",{id:this.id+"_msg",className:"esriLegendMsg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var a=[];x.forEach(this.layers,function(d){if("esri.layers.KMLLayer"==d.declaredClass||"esri.layers.GeoRSSLayer"==d.declaredClass){var f;d.loaded?("esri.layers.KMLLayer"==
d.declaredClass?f=d.getLayers():"esri.layers.GeoRSSLayer"==d.declaredClass&&(f=d.getFeatureLayers(),this.hideLayersInLegend[d.id]&&(f=x.filter(f,function(b){return-1==x.indexOf(this.hideLayersInLegend[d.id],b.id)},this))),x.forEach(f,function(b){"esri.layers.FeatureLayer"==b.declaredClass&&d._titleForLegend&&(b._titleForLegend=d._titleForLegend+" - ","esriGeometryPoint"==b.geometryType?b._titleForLegend+=this.NLS_points:"esriGeometryPolyline"==b.geometryType?b._titleForLegend+=this.NLS_lines:"esriGeometryPolygon"==
b.geometryType&&(b._titleForLegend+=this.NLS_areas),a.push(b))},this)):g.connect(d,"onLoad",y.hitch(this,function(){this.refresh(this.layerInfos)}))}else if("esri.layers.WMSLayer"===d.declaredClass)if(d.loaded){if((!this._respectVisibility||this._respectVisibility&&d.visible)&&0<d.layerInfos.length&&x.some(d.layerInfos,function(b){return b.legendURL})){var h=!1;x.forEach(d.layerInfos,function(c){if(c.legendURL&&-1<x.indexOf(d.visibleLayers,c.name)){h||(u.create("div",{innerHTML:"\x3cspan class\x3d'esriLegendServiceLabel'\x3e"+
(d._titleForLegend||d.name||d.id)+"\x3c/span\x3e"},this.domNode),h=!0);var a;c=c.legendURL;if(d.customParameters||d.customLayerParameters){var f=y.clone(d.customParameters||{});y.mixin(f,d.customLayerParameters||{});for(a in f)c+=(-1===c.indexOf("?")?"?":"\x26")+a+"\x3d"+f[a]}u.create("div",{innerHTML:"\x3cimg src\x3d'"+c+"'/\x3e"},this.domNode);b=!0}},this)}}else g.connect(d,"onLoad",y.hitch(this,function(){this.refresh(this.layerInfos)}));else"esri.layers.WFSLayer"!==d.declaredClass||d.renderer?
a.push(d):(f=u.create("div",{id:this.id+"_"+d.id,class:"esriLegendService"}),u.create("span",{innerHTML:this._getServiceTitle(d),class:"esriLegendServiceLabel"},u.create("td",{align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%"},f))))),u.place(f,this.id,"first"),f=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},f),f=u.create("tbody",{},f),"esriGeometryComplex"===d.geometryType?(this._buildRow_Renderer(d,d._pointSymbol,null,this.NLS_points,
null,f),this._buildRow_Renderer(d,d._lineSymbol,null,this.NLS_lines,null,f),this._buildRow_Renderer(d,d._polygonSymbol,null,this.NLS_areas,null,f)):"esriGeometryPoint"===d.geometryType?this._buildRow_Renderer(d,d._pointSymbol,null,"",null,f):"esriGeometryPolyline"===d.geometryType?this._buildRow_Renderer(d,d._lineSymbol,null,"",null,f):"esriGeometryPolygon"===d.geometryType&&this._buildRow_Renderer(d,d._polygonSymbol,null,"",null,f),c=!0)},this);var d=[];(x.forEach(a,function(b){if(b.loaded){if((!this._respectVisibility||
this._respectVisibility&&b.visible)&&(b.layerInfos||b.renderer||"esri.layers.ArcGISImageServiceLayer"==b.declaredClass)){var c=u.create("div",{id:this.id+"_"+b.id,style:{display:"none"},class:"esriLegendService"});if(u.create("span",{innerHTML:this._getServiceTitle(b),class:"esriLegendServiceLabel"},u.create("td",{align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%"},c))))),u.place(c,this.id,"first"),b.legendResponse||b.renderer&&"esri.renderer.StretchRenderer"!==
b.renderer.declaredClass)this._createLegendForLayer(b);else{if(this.isHostedTileService(b))return void this._getLayerInfos(b).then(y.hitch(this,function(b){this._createLegendForLayer(b)}),y.hitch(this,function(b){d.push(this._legendRequest(b))}));d.push(this._legendRequest(b))}}}else var a=g.connect(b,"onLoad",this,function(b){g.disconnect(a);a=null;this.refresh()})},this),0!==d.length||b||c)?(new k(d)).addCallback(y.hitch(this,function(a){p.byId(this.id+"_msg").innerHTML=b||c?"":this.NLS_noLegend;
this._activate()})):(p.byId(this.id+"_msg").innerHTML=this.NLS_noLegend,this._activate())},_createLegendForLayer:function(b){if(b.legendResponse||b.renderer||this.isHostedTileService(b)){var c=!1;if(b.legendResponse||this.isHostedTileService(b)){var a=b.dynamicLayerInfos||b.layerInfos;a&&a.length?x.forEach(a,function(a,d){this.hideLayersInLegend[b.id]&&-1!==x.indexOf(this.hideLayersInLegend[b.id],a.id)||(a=this._buildLegendItems(b,a,d),c=c||a)},this):"esri.layers.ArcGISImageServiceLayer"==b.declaredClass&&
(c=this._buildLegendItems(b,{id:0,name:null,title:b.name,subLayerIds:null,parentLayerId:-1},0))}else b.renderer&&(a=b.url?b.url.substring(b.url.lastIndexOf("/")+1,b.url.length):"fc_"+b.id,c=this._buildLegendItems(b,{id:a,name:null,subLayerIds:null,parentLayerId:-1},0));c&&(z.set(p.byId(this.id+"_"+b.id),"display","block"),z.set(p.byId(this.id+"_msg"),"display","none"))}},_legendRequest:function(b){return b.loaded?10.01<=b.version?this._legendRequestServer(b):this._legendRequestTools(b):void g.connect(b,
"onLoad",y.hitch(this,"_legendRequest"))},_legendRequestServer:function(b){var c=b.url,a=c.indexOf("?");-1<a?c=c.substring(0,a)+"/legend"+c.substring(a):c+="/legend";(a=b._getToken())&&(c+="?token\x3d"+a);var d=y.hitch(this,"_processLegendResponse"),f={};return f.f="json",b._params.dynamicLayers&&(f.dynamicLayers=e.stringify(this._createDynamicLayers(b)),"[{}]"===f.dynamicLayers&&(f.dynamicLayers="[]")),b._params.bandIds&&(f.bandIds=b._params.bandIds),b._params.renderingRule?f.renderingRule=b._params.renderingRule:
b.rasterFunctionInfos&&0<b.rasterFunctionInfos.length&&x.forEach(b.rasterFunctionInfos,function(b){b&&b.name&&"none"===b.name.toLowerCase()&&(f.renderingRule=e.stringify({rasterFunction:b.name}))}),J({url:c,content:f,callbackParamName:"callback",load:function(c,a){d(b,c,a)},error:C.defaults.io.errorHandler})},_legendRequestTools:function(b){var c=b.url.toLowerCase().indexOf("/rest/"),c=b.url.substring(0,c)+b.url.substring(c+5,b.url.length),c=this._legendUrl+"?soapUrl\x3d"+window.escape(c);(!n("ie")||
8<n("ie"))&&(c+="\x26returnbytes\x3dtrue");var a=y.hitch(this,"_processLegendResponse"),d={};return d.f="json",J({url:c,content:d,callbackParamName:"callback",load:function(c,d){a(b,c,d)},error:C.defaults.io.errorHandler})},_processLegendResponse:function(b,c){c&&c.layers?(b.legendResponse=c,p.byId(this.id+"_"+b.id)&&u.empty(p.byId(this.id+"_"+b.id)),u.create("span",{innerHTML:this._getServiceTitle(b),class:"esriLegendServiceLabel"},u.create("td",{align:this._align},u.create("tr",{},u.create("tbody",
{},u.create("table",{width:"95%"},p.byId(this.id+"_"+b.id)))))),this._createLegendForLayer(b)):console.log("Legend could not get generated for "+b.url+": "+w.toJson(c))},_buildLegendItems:function(b,c,a){var d=!1,f=p.byId(this.id+"_"+b.id),h=c.parentLayerId;if(c.subLayerIds)b=u.create("div",{id:this.id+"_"+b.id+"_"+c.id+"_group",style:{display:"none"},class:-1==h?0<a?"esriLegendGroupLayer":"":this._legendAlign},-1==h?f:p.byId(this.id+"_"+b.id+"_"+h+"_group")),u.create("td",{innerHTML:K.encode(c.name),
align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%",class:"esriLegendLayerLabel"},b))));else{if(this._respectVisibility&&b.visibleLayers)if(a=b.dynamicLayerInfos||b.layerInfos)if(b._params&&b._params.layers){if(-1===x.indexOf(b.visibleLayers,c.id))return d}else{if(a=this._getReallyVisibleLayers(a,b.visibleLayers),-1===x.indexOf(a,c.id))return d}else if(-1===x.indexOf(b.visibleLayers,c.id))return d;f=u.create("div",{id:this.id+"_"+b.id+"_"+c.id,style:{display:"none"},
class:-1<h?this._legendAlign:""},-1==h?f:p.byId(this.id+"_"+b.id+"_"+h+"_group"));u.create("td",{innerHTML:K.encode(c.name)||"",align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%",class:"esriLegendLayerLabel"},f))));a=b.dynamicLayerInfos||b.layerInfos;h=!1;a&&a.length&&(h=x.some(a,function(b){return!!b.drawingInfo}));b.legendResponse?d=d||this._buildLegendItems_Tools(b,c,f):(b.renderer||h)&&(d=d||this._buildLegendItems_Renderer(b,c,f))}return d},_getReallyVisibleLayers:function(b,
c){if(!b||!c||!c.length)return[];var a,d=[],f=[];for(a=0;a<b.length;a++)b[a].subLayerIds?(-1===x.indexOf(c,b[a].id)||-1<x.indexOf(f,b[a].id))&&(f=f.concat(b[a].subLayerIds)):-1<x.indexOf(c,b[a].id)&&-1===x.indexOf(f,b[a].id)&&d.push(b[a].id);return d},_buildLegendItems_Tools:function(b,c,a){var d=c.parentLayerId,f=this.map.getScale(),h=!1;if(!this._respectCurrentMapScale||this._respectCurrentMapScale&&this._isLayerInScale(b,c,f)){var e=!0;if(this._respectCurrentMapScale&&("esri.layers.ArcGISDynamicMapServiceLayer"===
b.declaredClass||"esri.layers.ArcGISMapServiceLayer"===b.declaredClass)){var k=this._getEffectiveScale(b,c);(k.minScale&&k.minScale<f||k.maxScale&&k.maxScale>f)&&(e=!1)}if(e){var f=function(b,c){var a,d;for(a=0;a<b.length;a++)if(c.dynamicLayerInfos)for(d=0;d<c.dynamicLayerInfos[d].length;d++){if(c.dynamicLayerInfos[d].mapLayerId==b[a].layerId)return b[a]}else if(c.id==b[a].layerId)return b[a];return{}}(b.legendResponse.layers,c),g=f.legendType,l=f.layerType,n=f.legend;if(n){"esri.layers.ArcGISImageServiceLayer"!==
b.declaredClass&&this._sanitizeLegendResponse(b,f,c);a=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},a);var q=u.create("tbody",{},a);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(a,b,c);var r=[];x.forEach(n,function(a){if(!(10.1<=b.version&&!a.values&&1<n.length)||!b._hideDefaultSymbol&&"\x3call other values\x3e"!==a.label&&(a.label||"esri.layers.ArcGISImageServiceLayer"===b.declaredClass&&10.3<=b.version||"Raster Layer"===l)){var d=a.label;(a.url&&
0===a.url.indexOf("http")||a.imageData&&0<a.imageData.length)&&(h=!0,d&&-1!==x.indexOf(r,d)||(r.push(d),this._buildRow_Tools(a,q,b,c.id,g)))}},this)}}}return h&&(z.set(p.byId(this.id+"_"+b.id+"_"+c.id),"display","block"),-1<d&&(z.set(p.byId(this.id+"_"+b.id+"_"+d+"_group"),"display","block"),this._findParentGroup(b.id,b,d))),h},_getLayerInfos:function(b){var c=new a,d=b.dynamicLayerInfos||b.layerInfos;if(d&&d.length)if(x.some(d,function(b){return!!b.drawingInfo}))c.resolve(b);else{var f=b.url,h=f.indexOf("?");
-1==h?f+="/layers":f=f.substring(0,h)+"/layers"+f.substring(h,f.length);J({url:f,content:{f:"json"},callbackParamName:"callback",load:function(a,f){a.layers?(x.forEach(d,function(b){var c=x.filter(a.layers,function(c){return b.source?c.id===b.source.mapLayerId:c.id===b.id});c&&c[0]&&c[0].drawingInfo&&(b.drawingInfo=c[0].drawingInfo,b.fields=c[0].fields)}),c.resolve(b)):c.reject(b)},error:function(a){c.reject(b)}})}return c},_sanitizeLegendResponse:function(b,c,a){var d=c.legend;if(10.1<=b.version&&
1<d.length&&!c._sanitized){var f,h;(b=y.getObject("layerDefinition.drawingInfo.renderer",!1,a))||(b=y.getObject("drawingInfo.renderer",!1,a));x.some(d,function(b){if(b.values)return!0})&&x.some(d,function(b,c){return b.values||(h=c,f=b),!!f});b?"uniqueValue"===b.type?f&&(d.splice(h,1),d.push(f)):"classBreaks"===b.type&&(f&&d.splice(h,1),d.reverse(),f&&d.push(f)):f&&(d.splice(h,1),d.push(f));c._sanitized=!0}},_buildRow_Tools:function(b,c,a,d,f){var h,e;c=u.create("tr",{},c);this.alignRight?(h=u.create("td",
{align:this._isRightToLeft?"left":"right"},c),e=u.create("td",{align:this._isRightToLeft?"left":"right",width:35},c)):(e=u.create("td",{width:35,align:"center"},c),h=u.create("td",{},c));c=b.url;(!n("ie")||9<=n("ie")||9>n("ie")&&"esri.layers.ArcGISImageServiceLayer"===a.declaredClass)&&b.imageData&&0<b.imageData.length?c="data:image/png;base64,"+b.imageData:0!==b.url.indexOf("http")&&(c=a.url+"/"+d+"/images/"+b.url,(d=a._getToken())&&(c+="?token\x3d"+d));e=u.create("img",{src:c,border:0,style:"opacity:"+
a.opacity},e);b=u.create("td",{innerHTML:K.encode(b.label),align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%",dir:"ltr"},h))));f&&"Stretched"===f&&10.3<=a.version&&"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&(b.style.verticalAlign="top",b.style.lineHeight="1",e.style.marginBottom="-1px",e.style.display="block",h.style.verticalAlign="top");9>n("ie")&&(e.style.filter="alpha(opacity\x3d"+100*a.opacity+")")},_getVariable:function(b,c,a){var d,f;return b&&
(d=b.getVisualVariablesForType(c,a),f=d&&d[0]),f},_getVariables:function(b,c,a){b=[this._getVariable(b,"colorInfo",!1),this._getVariable(b,"opacityInfo",!1),this._getVariable(b,"sizeInfo",!1)];return c?x.filter(b,function(b){return!(!b||b.field!==c||b.normalizationField!=a)}):b},_getFieldAlias:function(b,c,a){var d=c.infoTemplate||(c.infoTemplates&&a&&c.infoTemplates[a.id]?c.infoTemplates[a.id].infoTemplate:null),d=d&&d.getFieldInfo&&d.getFieldInfo(b);b=y.isFunction(b)?null:this.getField(c,b,a);c=
d||b;a="";return c&&(a=d&&d.label||b&&b.alias||c.name||c.fieldName),a},_getDomainName:function(b,c,a,d){var f;b&&!y.isFunction(b)&&(f=(a=(b=this.getField(a,b,d))&&a.getDomain?a.getDomain(b.name):null)&&a.codedValues?a.getName(c):null);return f},_getRampTitle:function(b,c,a){var d,f=b.field,h=b.normalizationField,e=!1,k=!1,g=!1;if(f=y.isFunction(f)?null:f,h=y.isFunction(h)?null:h,b.legendOptions&&b.legendOptions.title)d=b.legendOptions.title;else if(b.valueExpressionTitle)d=b.valueExpressionTitle;
else{if(c.renderer&&c.renderer.authoringInfo&&c.renderer.authoringInfo.visualVariables){var l=c.renderer.authoringInfo.visualVariables;for(b=0;b<l.length;b++){var p=l[b];if("colorInfo"===p.type&&"ratio"===p.style){e=!0;break}if("colorInfo"===p.type&&"percent"===p.style){k=!0;break}if("colorInfo"===p.type&&"percentTotal"===p.style){g=!0;break}}}(e=g&&"showRatioPercentTotal"||k&&"showRatioPercent"||e&&"showRatio"||h&&"showNormField"||f&&"showField"||null)&&(d=O.substitute({field:f&&this._getFieldAlias(f,
c,a),normField:h&&this._getFieldAlias(h,c,a)},"showField"===e?"${field}":this._i18n[e]))}return d},_getRendererTitle:function(b,c,a){var d;if(b){var f,h,e,k;"esri.renderer.ClassBreaksRenderer"===b.declaredClass&&(f=b.attributeField,h=b.normalizationField,e="percent-of-total"===b.normalizationType);f=y.isFunction(f)?null:f;h=y.isFunction(h)?null:h;b.legendOptions&&b.legendOptions.title?d=b.legendOptions.title:b.valueExpressionTitle?d=b.valueExpressionTitle:(k=h&&"showNormField"||(e?"showNormPct":null)||
f&&"showField"||null)&&(d=O.substitute({field:f&&this._getFieldAlias(f,c,a),normField:h&&this._getFieldAlias(h,c,a)},"showField"===k?"${field}":this._i18n[k]))}return d},_buildLegendItems_Renderer:function(b,c,a){var f,h=c.parentLayerId,e=this.map,k=e.getScale(),g=!1;if(!this._respectCurrentMapScale||this._isLayerInScale(b,c,k)){var l,n,q,r,m,t,w,A,C,J;if(q="esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass?b.renderer.renderer:c&&c.drawingInfo?d.fromJson(y.clone(c.drawingInfo.renderer)):
b.isFeatureReductionActive&&b.isFeatureReductionActive()?b.getFeatureReductionRenderer():b.renderer,"esri.renderer.ScaleDependentRenderer"===q.declaredClass&&(r="zoom"===q.rangeType?q.getRendererInfoByZoom(e.getZoom()):q.getRendererInfoByScale(k),!(q=r&&r.renderer)))return!1;var M,I,B,F,G;J=q&&q.authoringInfo&&"relationship"===q.authoringInfo.type;r=this._getVariables(q);var U=x.filter(r,function(b){return!!b}).length,k=r[0],e=r[1];r=r[2];if(k&&(m=this._getMedianColor(q,k),k.field&&(w=y.isFunction(k.field)?
null:this.getField(b,k.field,c)),M=!(k.legendOptions&&!1===k.legendOptions.showLegend)),e&&(e.field&&(C=y.isFunction(e.field)?null:this.getField(b,e.field,c)),I=!(e.legendOptions&&!1===e.legendOptions.showLegend)),r&&(r.field&&(A=y.isFunction(r.field)?null:this.getField(b,r.field,c)),B=!(r.legendOptions&&!1===r.legendOptions.showLegend)),"esri.renderer.HeatmapRenderer"===q.declaredClass)f=g=!0,this._showHeatRamp(b,c,q,a);else if("esri.renderer.DotDensityRenderer"===q.declaredClass)f=g=!0,this._showDotDensityLegend(b,
c,q,a);else if("esri.renderer.TemporalRenderer"===q.declaredClass)f=g=!0,n=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},a),l=u.create("tbody",{},n),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(n,b,c),q.latestObservationRenderer&&"esri.renderer.SimpleRenderer"===q.latestObservationRenderer.declaredClass&&this._buildRow_Renderer(b,q.latestObservationRenderer.symbol,m,K.encode(q.latestObservationRenderer.label)||this.NLS_currentObservations,null,l),q.observationRenderer&&
"esri.renderer.SimpleRenderer"===q.observationRenderer.declaredClass&&this._buildRow_Renderer(b,q.observationRenderer.symbol,m,K.encode(q.observationRenderer.label)||this.NLS_previousObservations,null,l);else if("esri.renderer.UniqueValueRenderer"===q.declaredClass){if(q.infos&&0<q.infos.length){if(f=g=!0,q.legendOptions&&q.legendOptions.title||q.valueExpressionTitle)n=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},a),l=u.create("tbody",{},n),U=q.legendOptions&&
q.legendOptions.title?q.legendOptions.title:q.valueExpressionTitle,this._buildRow_Renderer(b,null,m,K.encode(U),null,l);if(n=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},a),l=u.create("tbody",{},n),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(n,b,c),q.attributeField&&r&&this._addSubHeader(l,this._getFieldAlias(q.attributeField,b,c)),J){var W=q.authoringInfo;G=W.focus;n=W.numClasses;var L=W.field1.field,U=W.field2.field;if(n&&L&&U){var E=W.field1.normalizationField,
W=W.field2.normalizationField,D=E&&this._i18n.showNormField||L&&"${field}",V=W&&this._i18n.showNormField||U&&"${field}",L=O.substitute({field:this._getFieldAlias(L,b,c),normField:E&&this._getFieldAlias(E,b,c)},D),U=O.substitute({field:this._getFieldAlias(U,b,c),normField:W&&this._getFieldAlias(W,b,c)},V),E={shapeDescriptor:v,rotation:this._getRotationAngleForFocus(G)||0};this._buildRow_Renderer(b,null,null,K.encode(L),null,l,null,E);E.rotation+=90;this._buildRow_Renderer(b,null,null,K.encode(U),null,
l,null,E);this._drawRelationshipLegend(a,{numClasses:n,focus:G,uvInfos:q.infos})}}else{var R=[];x.forEach(q.infos,function(a){var d=null;this._isLayerEditable(b)&&b.types&&(d=this._getTemplateFromTypes(b.types,a.value));var f=a.label;null==f&&(f=this._getDomainName(q.attributeField,a.value,b,c)||a.value);-1===x.indexOf(R,f)&&(R.push(f),this._buildRow_Renderer(b,a.symbol,m,K.encode(f),d,l))},this)}}G=!J&&this._displayDefaultSymbol(b,q,a)}else if("esri.renderer.ClassBreaksRenderer"===q.declaredClass){if(q.infos&&
0<q.infos.length||"esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass)(f=g=!0,F=this._isUnclassedRenderer(q),k||1!==q.infos.length)||(t=(t=q.infos[0])&&t.symbol),F||(n=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},a),l=u.create("tbody",{},n),U=this._getRendererTitle(q,b,c),this._buildRow_Renderer(b,null,m,K.encode(U),null,l)),n=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},a),l=u.create("tbody",{},n),(b._hoverLabel||
b._hoverLabels)&&this._createHoverAction(n,b,c),F&&r&&B||(J=q.infos.slice(0).reverse(),x.forEach(J,function(c){var a=c.label;null!=a||F||(a=c.minValue+" - "+c.maxValue);this._buildRow_Renderer(b,c.symbol,m,K.encode(a),null,l)},this)),"esri.layers.ArcGISImageServiceVectorLayer"!==b.declaredClass||b.renderer.style!==Y.STYLE_SCALAR&&b.renderer.style!==Y.STYLE_SINGLE_ARROW||(this._buildRow_Renderer(b,q.defaultSymbol,null,"",null,l),b._hideDefaultSymbol=!0);F||(G=this._displayDefaultSymbol(b,q,a))}else"esri.renderer.SimpleRenderer"===
q.declaredClass&&(f=g=!0,n=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},a),l=u.create("tbody",{},n),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(n,b,c),t=null,this._isLayerEditable(b)&&b.templates&&0<b.templates.length&&(t=b.templates[0]),J=1<U?null:w&&M||C&&I||A&&B,this._buildRow_Renderer(b,q.symbol,m,K.encode(J?this._getRampTitle(1<U?null:k||e||r,b,c):q.label),t,l),t=k?null:q.symbol,J&&(w=C=A=null));if(f){var T;if(k&&M&&(k.field||k.valueExpression)&&
(T=!(!r||!B),this._showGradientRamp(b,c,q,null,a,k,w,null,T)),r&&B&&(r.field||r.valueExpression)&&(T=!(k&&M||"esri.renderer.UniqueValueRenderer"===q.declaredClass),this._showSizeLegend(b,c,q,r,m,a,A,null,T)),e&&I&&(e.field||e.valueExpression))f=t&&!t.url&&t.color?t.color:this.transparencyRampColor,this._showGradientRamp(b,c,q,f,a,e,C,null,!1)}G||F&&!M&&!B&&!I||(G=this._displayDefaultSymbol(b,q,a));g=g||G}return g&&(z.set(p.byId(this.id+"_"+b.id+"_"+c.id),"display","block"),-1<h&&(z.set(p.byId(this.id+
"_"+b.id+"_"+h+"_group"),"display","block"),this._findParentGroup(b.id,h))),g},_isLayerEditable:function(b){return"function"==typeof b.isEditable&&b.isEditable()},_isUnclassedRenderer:function(b,c){var a;if("esri.renderer.ClassBreaksRenderer"===b.declaredClass&&b.infos&&1===b.infos.length){a=b.attributeField;var d=b.normalizationField;a=c?a===c:!!this._getVariables(b,a,d).length}return a},_displayDefaultSymbol:function(b,c,a){var d;!b._hideDefaultSymbol&&c.defaultSymbol&&(d=!0,a=u.create("table",
{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},a),a=u.create("tbody",{},a),this._buildRow_Renderer(b,c.defaultSymbol,null,K.encode(c.defaultLabel)||"others",null,a));return d},_showGradientRamp:function(b,c,a,d,f,h,e,k,g){g=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"+(g?"":" esriLegendSubFragment")},f);f=u.create("tbody",{},g);(b._hoverLabel||b._hoverLabels||k)&&this._createHoverAction(g,b,c,k);(e||h.valueExpression||h.legendOptions&&h.legendOptions.title)&&
this._addSubHeader(f,this._getRampTitle(h,b,c));var l;(e=h.field)&&(l=y.isFunction(e)?null:this.getField(b,e,c));(c=this._getRampStops(a,h,d,l&&"esriFieldTypeDate"===l.type))&&c.length&&this._drawGradientRamp(f,c,!0,b,this._getRampBorderColor(a),!!d)},_getMedianColor:function(b,c){var a,d;c.colors?(a=c.minDataValue,d=c.maxDataValue):c.stops&&(a=c.stops[0].value,d=c.stops[c.stops.length-1].value);return b.getColor(a+(d-a)/2,{colorInfo:c})},_getRampStops:function(b,c,a,d){var f,h,e,k,g,l=!1;c.colors||
c.opacityValues?(e=c.maxDataValue-c.minDataValue,f=x.map([0,.25,.5,.75,1],function(b){return k=c.minDataValue+b*e,Number(k.toFixed(6))}),this._checkPrecision(0,4,f)):c.stops&&(f=x.map(c.stops,function(b){return b.value}),(l=x.some(c.stops,function(b){return!!b.label}))&&(g=x.map(c.stops,function(b){return b.label})));var p,n,q=f[0];return e=f[f.length-1]-q,h=x.map(f,function(h,k){a?(p=new t(a.toRgba()),null!=(n=b.getOpacity(h,{opacityInfo:c}))&&(p.a=n)):p=b.getColor(h,{colorInfo:c});var u="";if(l)u=
g[k];else{var u=d?Q.formatDate(h,Q.timelineDateFormatOptions):R.format(h),r="";0===k?r=this._specialChars.lt+" ":k===f.length-1&&(r=this._specialChars.gt+" ");u=r+u}return{value:h,color:p,offset:1-(h-q)/e,label:u}},this),h.reverse()},_checkPrecision:function(b,c,a){var d=b+(c-b)/2,f=a[b],h=a[d],e=a[c],k=Math.floor(f),g=Math.floor(h),l=Math.floor(e);k===f&&l===e&&g!==h&&k!==g&&l!==g&&(a[d]=g);b+1!==d&&this._checkPrecision(b,d,a);d+1!==c&&this._checkPrecision(d,c,a)},_getRampBorderColor:function(b){var c,
a;return"esri.renderer.SimpleRenderer"===b.declaredClass?c=b.symbol:"esri.renderer.UniqueValueRenderer"!==b.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==b.declaredClass||(c=b.infos[0].symbol),a=c&&-1===c.type.indexOf("linesymbol")?c.getStroke():null,a&&a.color},_drawGradientRamp:function(b,c,a,d,f,h){var e,k,g,l,p,q,r,m,w=u.create("tr",{},b),A=c.length-1;b=0;this.alignRight?(e=u.create("td",{align:this._isRightToLeft?"left":"right"},w),k=u.create("td",{align:this._isRightToLeft?"left":"right",
width:this.gradientWidth},w)):(k=u.create("td",{width:this.gradientWidth,align:"center"},w),e=u.create("td",{},w));w=f&&0<f.a&&!(240<=f.r&&240<=f.g&&240<=f.b);g=u.create("div",{class:w?"":"esriLegendBorderLessColorRamp",style:"position: relative; width:"+this.gradientWidth+"px;"},k);k=u.create("div",{class:"esriLegendColorRamp"+(h?" esriLegendTransparencyRamp":"")},g);h=z.get(k,"width");w&&(f=9>n("ie")?f.toHex():"rgba("+f.toRgba().join(",")+")",z.set(k,"border",this.colorRampBorder+" "+f));a?(r=this.gradientHeight*
A,z.set(k,"height",r+"px")):r=z.get(k,"height");z.set(g,"height",r+"px");f=L.createSurface(k,h,r);9>n("ie")&&(p=f.getEventSource(),z.set(p,"position","relative"),z.set(p.parentNode,"position","relative"),b=1);try{a&&x.forEach(c,function(b,c){b.offset=c/A}),q=f.createRect({x:-b,y:-b,width:h+b,height:r+b}),q.setFill({type:"linear",x1:0,y1:0,x2:0,y2:r,colors:c}).setStroke(null),f.createRect({width:h,height:r}).setFill(new t([255,255,255,1-d.opacity])).setStroke(null),this._surfaceItems.push(f)}catch(ma){f.clear(),
f.destroy()}x.forEach(c,function(b,a){b.label&&(m="top:"+100*b.offset+"%;",b="",0===a&&(b+=" esriLegendColorRampTickFirst"),a===c.length-1&&(b+=" esriLegendColorRampTickLast"),u.create("div",{class:"esriLegendColorRampTick"+b,innerHTML:"\x26nbsp;",style:m},g))});l=u.create("div",{class:"esriLegendColorRampLabels",style:{height:r+this.gradientHeight+"px"}},e);a?x.forEach(c,function(b){u.create("div",{class:"esriLegendColorRampLabel",innerHTML:K.encode(b.label)||"\x26nbsp;"},l)}):(u.create("div",{class:"esriLegendColorRampLabel",
innerHTML:this._i18n.high},l),u.create("div",{class:"esriLegendColorRampLabel",innerHTML:this._i18n.low,style:"top: "+(r+this.gradientHeight-2*this.gradientHeight)+"px;"},l))},_showHeatRamp:function(b,c,a,d,f){var h,e=a.field;h=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},d);d=u.create("tbody",{},h);(b._hoverLabel||b._hoverLabels||f)&&this._createHoverAction(h,b,c,f);(e=e&&this.getField(b,e,c))&&this._addSubHeader(d,this._getFieldAlias(e.name,b,c));c=this._getHeatmapStops(a);
c.length&&this._drawGradientRamp(d,c,!1,b)},_getHeatmapStops:function(b){var c,a,d,f,h=b.colorStops;b=b.colors;h&&h[0]?(c=h.length-1,h[0]&&null!=h[0].ratio)?(b=h[c])&&1!==b.ratio&&(h=h.slice(0),h.push({ratio:1,color:b.color}),c++):(a=h[0].value,d=h[c].value-a,h=x.map(h,function(b){return{color:b.color,ratio:(b.value-a)/d}})):b&&b[0]&&(c=b.length-1,f=1/(b.length-1),h=x.map(b,function(b,c){return{color:b,ratio:c*f}}));return h=x.map(h,function(b,a){var d="";return 0===a?d="Low":a===c&&(d="High"),{color:b.color,
label:d,offset:1-b.ratio}}),h.reverse()},_showDotDensityLegend:function(b,c,a,d){var h,e,k,g,l,p,n,q=a.legendOptions,r=this.dotDensitySwatchSize,z=Math.round(r/2);q&&(e=q.backgroundColor,k=q.outline,g=q.valueUnit,l=q.dotCoverage);l=(l||this.dotCoverage)/100;n=Math.round(r*r/Math.pow(a.dotSize,2)*l);d=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},d);p=u.create("tbody",{},d);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(d,b,c);this._addSubHeader(p,O.substitute({value:a.dotValue,
unit:g||""},this.NLS_dotValue));x.forEach(a.fields,function(d){d=y.mixin({},d);d.numPoints=n;h=new f(a._generateImageSrc(r,r,[d],{x:0,y:0},{x:r,y:r},e),k||a.outline,r,r);d=this.getField(b,d.name,c)||d;this._buildRow_Renderer(b,h,null,K.encode(this._getFieldAlias(d.name,b,c)),null,p,{type:"path",path:"M "+-z+","+-z+" L "+z+","+-z+" L "+z+","+z+" L "+-z+","+z+" L "+-z+","+-z+" E"})},this)},_showSizeLegend:function(c,a,d,f,h,e,k,g,l){var p;p=(p=f.legendOptions)&&p.customValues;h=this._getSizeSymbol(d,
h);if((!f.valueUnit||"unknown"===f.valueUnit)&&h&&(p||null!=f.minSize&&null!=f.maxSize&&null!=f.minDataValue&&null!=f.maxDataValue||f.stops&&!(1>=f.stops.length))){l=u.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"+(l?"":" esriLegendSubFragment")},e);e=u.create("tbody",{},l);(c._hoverLabel||c._hoverLabels||g)&&this._createHoverAction(l,c,a,g);(k||f.valueExpression||f.legendOptions&&f.legendOptions.title)&&this._addSubHeader(e,this._getRampTitle(f,c,a));var n;k=f.field;
g=y.isFunction(k);k&&(n=g?null:c.isFeatureReductionActive&&c.isFeatureReductionActive()?c.getFeatureReductionField(k):this.getField(c,k,a));a=n&&"esriFieldTypeDate"===n.type;p=p||this._getDataValues(d,h,f,a);var q,r=p.length-1;for(n=r;0<=n;n--)l=p[n],h=b.fromJson(h.toJson()),this._applySize(h,d,f,l),l=a?Q.formatDate(l,Q.timelineDateFormatOptions):R.format(l),q="",n===r?q=this._specialChars.gt+" ":0===n&&(q=k&&!g&&"cluster_count"===k.toLowerCase()&&1===p[n]?"":this._specialChars.lt+" "),q="\x3cspan class\x3d'esriLegendSizeRampLabel'\x3e"+
K.encode(q+l)+"\x3c/span\x3e",this._buildRow_Renderer(c,h,null,q,null,e)}},_getSizeSymbol:function(c,a){var d,f;if("esri.renderer.SimpleRenderer"===c.declaredClass?d=c.symbol:"esri.renderer.VectorFieldRenderer"===c.declaredClass?d=c.defaultSymbol:"esri.renderer.UniqueValueRenderer"!==c.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==c.declaredClass||(d=c.infos[0].symbol,f=1<c.infos.length),(d=d&&-1!==d.type.indexOf("fillsymbol")?null:d)&&(d=b.fromJson(d.toJson()),a||f))if(-1!==d.type.indexOf("linesymbol"))d.setColor(new t(this.sizeRampDarkColor));
else if(d.setColor(new t(this.sizeRampLightColor)),d.setOutline)c=new E,c.setColor(new t(this.sizeRampDarkColor)),c.setWidth(1.5),d.setOutline(c);return d},_getDataValues:function(b,c,a,d,f,h){f=null==f?5:f;h=null==h?20:h;var e=b.getSizeRangeAtScale(a,this.map.getScale());f=this._interpolateSizeRange(e,f);var k=this._getDataRange(a),g=x.map(f,function(b){return this._getDataValueFromSize(b,k,e)},this);if(!d){var l,g=R.round(g);for(d=1;d<g.length-1;d++)(l=this._roundDataValue(b,c,a,g[d],g[d-1],h))&&
(g[d]=l[0],f[d]=l[1])}return g},_getDataRange:function(b){var c=b.stops;return c?{min:c[0].value,max:c[c.length-1].value}:{min:b.minDataValue,max:b.maxDataValue}},_interpolateSizeRange:function(b,c){var a=b.minSize,d=(b.maxSize-a)/(c-1),f=[];for(b=0;b<c;b++)f.push(a+d*b);return f},_getDataValueFromSize:function(b,c,a){var d,f,h=a.minSize;a=a.maxSize;var e=c.min;c=c.max;return b<=h?f=e:b>=a?f=c:(d=(b-h)/(a-h),f=d*(c-e)+e),f},_roundDataValue:function(b,c,a,d,f,h){var e,k,g,l,p,n,q,u,r,z,m,t,w,A,x,v=
this._getSize(c,b,a,d);f=this._getSize(c,b,a,f);var y=R.getDigits(d);k=y.integer;y=y.fractional;0<d&&1>d&&(e=Math.pow(10,y),d*=e,k=R.getDigits(d).integer);for(--k;0<=k&&(g=Math.pow(10,k),l=Math.floor(d/g)*g,p=Math.ceil(d/g)*g,null!=e&&(l/=e,p/=e),n=(l+p)/2,n=R.round([l,n,p],{indexes:[1]})[1],q=this._getSize(c,b,a,l),u=this._getSize(c,b,a,p),r=this._getSize(c,b,a,n),z=R.getPctChange(v,q,f,null),m=R.getPctChange(v,u,f,null),t=R.getPctChange(v,r,f,null),w=z.prev<=h,A=m.prev<=h,w&&A&&(z.prev<=m.prev?
(w=!0,A=!1):(A=!0,w=!1)),w?x=[l,q]:A?x=[p,u]:t.prev<=h&&(x=[n,r]),!x);k--);return x},_applySize:function(b,c,a,d){var f;f=b.type;c=this._getSize(b,c,a,d);switch(f){case "simplemarkersymbol":b.setSize(c);break;case "picturemarkersymbol":f=b.width;a=b.height;b.setHeight(c);b.setWidth(f/a*c);break;case "simplelinesymbol":case "cartographiclinesymbol":b.setWidth(c);break;case "textsymbol":b.font&&b.font.setSize(c)}},_getSize:function(b,c,a,d){return c.getSize(d,{sizeInfo:a,scale:this.map.getScale(),shape:-1!==
b.type.indexOf("markersymbol")?b.style:null})},_buildRow_Renderer:function(b,c,a,d,f,h,e,k){var g,l,p=!!k;h=u.create("tr",{},h);this.alignRight?(g=u.create("td",{align:this._isRightToLeft?"left":"right"},h),(c||p)&&(l=u.create("td",{align:this._isRightToLeft?"left":"right",width:35},h))):((c||p)&&(l=u.create("td",{width:35,align:"center"},h)),g=u.create("td",{},h));var n,q=h=30;if(c)if("simplemarkersymbol"==c.type)h=Math.min(Math.max(h,c.size+12),125),q=Math.min(Math.max(q,c.size+12),125);else if("picturemarkersymbol"==
c.type)h=Math.min(Math.max(h,c.width),125),q=Math.min(c.height||q,125);else if("textsymbol"==c.type){var r,z;c.text||(r=c.text,z=!0,c.setText(this.defaultText));h=Math.min(Math.max(h,c.getWidth()+12),125);q=Math.min(Math.max(q,c.getHeight()+12),125);z&&c.setText(r)}if((c||p)&&(n=u.create("div",{style:"width:"+h+"px;height:"+q+"px;"},l)),O.isDefined(d)&&"number"==typeof d&&(d=""+d),u.create("td",{innerHTML:d||"",align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%"},
g)))),c||p)b=this._drawSymbol(n,c,a,h,q,f,b,e,k),this._surfaceItems.push(b)},_addSubHeader:function(b,c){b=u.create("tr",{},b);b=u.create("td",{align:this._align,colspan:2},b);u.create("td",{innerHTML:K.encode(c)||"",align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%"},b))))},_drawSymbol:function(c,a,d,f,h,e,k,g,l){var p,q=a&&b.fromJson(a.toJson()),u=k.opacity;a=!!l;if(q)if(d&&q.setColor(new t(d.toRgba())),"simplelinesymbol"===q.type||"cartographiclinesymbol"===q.type||
"textsymbol"===q.type){if(!q.color)return;p=q.color.toRgba();p[3]*=u;q.color.setColor(p)}else"simplemarkersymbol"===q.type||"simplefillsymbol"===q.type?(q.color&&(p=q.color.toRgba(),p[3]*=u,q.color.setColor(p)),q.outline&&q.outline.color&&(p=q.outline.color.toRgba(),p[3]*=u,q.outline.color.setColor(p))):"picturemarkersymbol"===q.type&&(c.style.opacity=u,c.style.filter="alpha(opacity\x3d("+100*u+"))");var r;c=L.createSurface(c,f,h);9>n("ie")&&(r=c.getEventSource(),z.set(r,"position","relative"),z.set(r.parentNode,
"position","relative"));var m;e=a?l.shapeDescriptor:this._getDrawingToolShape(q,e)||b.getShapeDescriptors(q);d=(r=e.defaultShape)&&"text"===r.type;try{d&&!r.text&&(r.text=this.defaultText),m=c.createShape(g||r).setFill(e.fill).setStroke(e.stroke),d&&m.setFont(e.font)}catch(pa){return c.clear(),void c.destroy()}p=m.getBoundingBox();g=p.width;e=p.height;d=-(p.x+g/2);u=-(p.y+e/2);r=c.getDimensions();d={dx:d+r.width/2,dy:u+r.height/2};if(q&&"simplemarkersymbol"===q.type&&"path"===q.style)f=k._getScaleMatrix(p,
q.size),m.applyTransform(P.scaleAt(f.xx,f.yy,{x:r.width/2,y:r.height/2}));else if(g>f||e>h)k=g/f>e/h,f=((k?f:h)-5)/(k?g:e),y.mixin(d,{xx:f,yy:f});return m.applyTransform(d),a&&m.applyTransform(P.rotategAt(l.rotation,g/2,e/2)),c},_getDrawingToolShape:function(b,c){switch(c?c.drawingTool||null:null){case "esriFeatureEditToolArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 Z"};break;case "esriFeatureEditToolTriangle":c={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 Z"};
break;case "esriFeatureEditToolRectangle":c={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"};break;case "esriFeatureEditToolCircle":c={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":c={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:c,fill:b.getFill(),stroke:b.getStroke()}},_drawRelationshipLegend:function(b,a){var d=a.focus,f=a.numClasses,h=q[f],e=!!d,k=Math.sqrt(Math.pow(75,2)+Math.pow(75,2)),g={};a.uvInfos.forEach(function(b){g[b.value]=
{label:b.label,fill:this._getSymbolColor(b.symbol)}},this);a=[];for(var l=0;l<f;l++){for(var p=[],n=0;n<f;n++)p.push(g[h[l][n]].fill);a.push(p)}h=this._getRelationshipCornerLabels(d,g);b=this._drawRampLayout(b,h,k,e);b=L.createSurface(b,k,k);e||(b.rawNode.style.margin="-15px -15px -18px -15px");a=c.create2DColorRamp({surface:b,colors:a,numClasses:f,size:75});f=(k-75)/2;k=(k-75)/2;a.applyTransform(P.translate(f,k));e&&a.applyTransform(P.rotategAt(this._getRotationAngleForFocus(d),37.5,37.5));a=b.createGroup();
h={width:1,color:"#555555"};l=b.defNode;this._createArrowMarker(l,"start");this._createArrowMarker(l,"end");l=a.createLine({x1:-10,y1:60,x2:-10,y2:15}).setStroke(h);h=a.createLine({x1:15,y1:85,x2:60,y2:85}).setStroke(h);this._setLineArrow(l.rawNode,"left",d);this._setLineArrow(h.rawNode,"right",d);a.applyTransform(P.translate(f,k));e&&a.applyTransform(P.rotategAt(-45,37.5,37.5));this._surfaceItems.push(b)},_drawRampLayout:function(b,c,a,d){var f=u.create("div",{style:{padding:"10px"}},b);b=a+"px";
a+="px";if(d)return d=u.create("div",{style:{display:"flex"}},f),f=(u.create("div",{class:"esriLegendRelationshipLabel",style:{alignSelf:"center",maxWidth:b,textAlign:"right"},innerHTML:c.left},d),u.create("div",{style:{display:"flex",flexDirection:"column",textAlign:"center"}},d)),d=(u.create("div",{class:"esriLegendRelationshipLabel",style:{alignSelf:"center",maxWidth:b},innerHTML:c.right},d),u.create("div",{class:"esriLegendRelationshipLabel",style:{alignSelf:"center",maxWidth:b},innerHTML:c.top},
f)),d=u.create("div",{style:{height:a,width:a}},f),f=u.create("div",{class:"esriLegendRelationshipLabel",style:{alignSelf:"center",maxWidth:b},innerHTML:c.bottom},f),d;f=u.create("div",{style:{display:"table",color:"#555555"}},f);d=u.create("div",{style:{display:"table-row"}},f);a=u.create("div",{style:{display:"table-row"}},f);f=u.create("div",{style:{display:"table-row"}},f);d=(u.create("div",{class:"esriLegendRelationshipLabel",style:{display:"table-cell",maxWidth:b,textAlign:"right",verticalAlign:"bottom"},
innerHTML:c.left},d),u.create("div",{style:{display:"table-cell"}},d),u.create("div",{class:"esriLegendRelationshipLabel",style:{display:"table-cell",maxWidth:b,textAlign:"left",verticalAlign:"bottom"},innerHTML:c.top},d),u.create("div",{style:{display:"table-cell"}},a),u.create("div",{style:{display:"table-cell"}},a));u.create("div",{style:{display:"table-cell"}},a);u.create("div",{class:"esriLegendRelationshipLabel",style:{display:"table-cell",maxWidth:b,textAlign:"right",verticalAlign:"top"},innerHTML:c.bottom},
f);u.create("div",{style:{display:"table-cell"}},f);u.create("div",{class:"esriLegendRelationshipLabel",style:{display:"table-cell",maxWidth:b,textAlign:"left",verticalAlign:"top"},innerHTML:c.right},f);return d},_getSymbolColor:function(b){if(b)return"simplelinesymbol"===b.type||"simplemarkersymbol"===b.type&&(b.style===aa.STYLE_X||b.style===aa.STYLE_CROSS)?(b=b.getStroke())&&b.color:b.getFill()},_getRotationAngleForFocus:function(b){var c=D[b];return b&&null==c&&(c=D.HH),c},_setLineArrow:function(b,
c,a){var d=this.id+"_arrowStart",f=this.id+"_arrowEnd";c="left"===c;switch(a){case "HL":b.setAttribute(c?"marker-start":"marker-end","url(#"+(c?f:d)+")");break;case "LL":b.setAttribute("marker-start","url(#"+f+")");break;case "LH":b.setAttribute(c?"marker-end":"marker-start","url(#"+(c?d:f)+")");break;default:b.setAttribute("marker-end","url(#"+d+")")}},_createArrowMarker:function(b,c){var a="start"===c,d=this.id+(a?"_arrowStart":"_arrowEnd");c=a?"0,0 5,5 0,10":"5,0 0,5 5,10";var f=a?5:0,a=document.createElementNS("http://www.w3.org/2000/svg",
"marker");a.setAttribute("id",d);a.setAttribute("markerWidth","10");a.setAttribute("markerHeight","10");a.setAttribute("refX",f);a.setAttribute("refY","5");a.setAttribute("markerUnits","strokeWidth");a.setAttribute("orient","auto");d=document.createElementNS("http://www.w3.org/2000/svg","polyline");d.setAttribute("points",c);d.setAttribute("fill","none");d.setAttribute("stroke","#555555");d.setAttribute("stroke-width","1");a.appendChild(d);b.appendChild(a)},_getRelationshipCornerLabels:function(b,
c){var a=c.HH.label,d=c.LL.label,f=c.HL.label;c=c.LH.label;switch(b){case "HH":return{top:a,bottom:d,left:f,right:c};case "HL":return{top:f,bottom:c,left:d,right:a};case "LL":return{top:d,bottom:a,left:c,right:f};case "LH":return{top:c,bottom:f,left:a,right:d};default:return{top:a,bottom:d,left:f,right:c}}},_repaintItems:function(){x.forEach(this._surfaceItems,function(b){this._repaint(b)},this)},_repaint:function(b){if(b){b.getStroke&&b.setStroke&&b.setStroke(b.getStroke());try{b.getFill&&b.setFill&&
b.setFill(b.getFill())}catch(G){}b.children&&y.isArray(b.children)&&x.forEach(b.children,this._repaint,this)}},_createHoverAction:function(b,c,a,d){(d=c._hoverLabel||c._hoverLabels&&c._hoverLabels[a.id]||d)&&(d=K.encode(d),c.mouseMoveHandler=c.mouseMoveHandler||{},c.mouseMoveHandler[a.id]=g.connect(b,"onmousemove",y.hitch(this,function(b,c){this.mouseX=c.clientX;this.mouseY=c.clientY;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,z.set(p.byId(this.id+"_hoverLabel"),"display","none"));setTimeout(y.hitch(this,
function(b,c,a){if(b==this.mouseX&&c==this.mouseY&&!this.hoverLabelShowing)if(this.hoverLabelShowing=!0,p.byId(this.id+"_hoverLabel")){var d=p.byId(this.id+"_hoverLabel");d.innerHTML="\x3cspan\x3e"+a+"\x3c/span\x3e";z.set(d,"top",c+"px");z.set(d,"left",b+15+"px");z.set(d,"display","")}else u.create("div",{innerHTML:"\x3cspan\x3e"+a+"\x3c/span\x3e",id:this.id+"_hoverLabel",class:"esriLegendHoverLabel",style:{top:c+"px",left:b+15+"px"}},document.body)},c.clientX,c.clientY,b),500)},d)),c.mouseOutHandler=
c.mouseOutHandler||{},c.mouseOutHandler[a.id]=g.connect(b,"onmouseout",y.hitch(this,function(b){this.mouseY=this.mouseX=-1;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,z.set(p.byId(this.id+"_hoverLabel"),"display","none"))})))},_removeHoverHandlers:function(){var b;x.forEach(this.layers,function(c){if(c.mouseMoveHandler)for(b in c.mouseMoveHandler)g.disconnect(c.mouseMoveHandler[b]);if(c.mouseOutHandler)for(b in c.mouseOutHandler)g.disconnect(c.mouseOutHandler[b])})},_createDynamicLayers:function(b){var c,
a=[];return x.forEach(b.dynamicLayerInfos||b.layerInfos,function(d){c={id:d.id};c.source=d.source&&d.source.toJson();var f;b.layerDefinitions&&b.layerDefinitions[d.id]&&(f=b.layerDefinitions[d.id]);f&&(c.definitionExpression=f);var h;b.layerDrawingOptions&&b.layerDrawingOptions[d.id]&&(h=b.layerDrawingOptions[d.id]);h&&(c.drawingInfo=h.toJson());c.minScale=d.minScale||0;c.maxScale=d.maxScale||0;a.push(c)}),a},_getTemplateFromTypes:function(b,c){var a;for(a=0;a<b.length;a++)if(b[a].id==c&&b[a].templates&&
0<b[a].templates.length)return b[a].templates[0];return null},_findParentGroup:function(b,c,a){var d,f=c.dynamicLayerInfos||c.layerInfos;for(d=0;d<f.length;d++)if(a==f[d].id){-1<f[d].parentLayerId&&(z.set(p.byId(this.id+"_"+b+"_"+f[d].parentLayerId+"_group"),"display","block"),this._findParentGroup(b,c,f[d].parentLayerId));break}},_addSubLayersToHide:function(b){function c(a,d){var f,h,e=b.layer.dynamicLayerInfos||b.layer.layerInfos;for(f=0;f<e.length;f++)if(e[f].id===a&&e[f].subLayerIds)for(h=0;h<
e[f].subLayerIds.length;h++){var k=e[f].subLayerIds[h];-1===x.indexOf(d,k)&&(d.push(k),c(k,d))}}b.layer.layerInfos&&x.forEach(this.hideLayersInLegend[b.layer.id],function(a){c(a,this.hideLayersInLegend[b.layer.id])},this)},_isLayerInScale:function(b,c,a){var d,f=!0;if(b.legendResponse&&b.legendResponse.layers)for(d=0;d<b.legendResponse.layers.length;d++){var h=b.legendResponse.layers[d];if(c.id==h.layerId){var e,k;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==b.maxScale?(0==h.minScale&&b.tileInfo&&
(e=b.tileInfo.lods[0].scale),0==h.maxScale&&b.tileInfo&&(k=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(e=Math.min(b.minScale,h.minScale)||b.minScale||h.minScale,k=Math.max(b.maxScale,h.maxScale));(0<e&&e<a||k>a)&&(f=!1);break}}else(b.minScale||b.maxScale)&&(b.minScale&&b.minScale<a||b.maxScale&&b.maxScale>a)&&(f=!1);return f},_getServiceTitle:function(b){var c=b._titleForLegend;if(c||(c=b.url,b.url?-1<b.url.indexOf("/MapServer")?(c=b.url.substring(0,b.url.indexOf("/MapServer")),c=c.substring(c.lastIndexOf("/")+
1,c.length)):-1<b.url.indexOf("/ImageServer")?(c=b.url.substring(0,b.url.indexOf("/ImageServer")),c=c.substring(c.lastIndexOf("/")+1,c.length)):-1<b.url.indexOf("/FeatureServer")&&(c=b.url.substring(0,b.url.indexOf("/FeatureServer")),c=c.substring(c.lastIndexOf("/")+1,c.length)):c="",b.name&&(0<c.length?c+=" - "+b.name:c=b.name)),"esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass&&b.vectorFieldPixelFilter)b=b.vectorFieldPixelFilter.outputUnit?this["NLS_"+b.vectorFieldPixelFilter.outputUnit]:
this["NLS_"+b.vectorFieldPixelFilter.inputUnit],O.isDefined(b)&&(c+=" ("+b+")");return K.encode(c)},_getEffectiveScale:function(b,c){var a=c.minScale,d=c.maxScale;if(O.isDefined(c.parentLayerId)){b=b.layerInfos;var f=c.parentLayerId;for(c=b.length-1;0<=c;c--)if(b[c].id==f){if(0==a&&0<b[c].minScale?a=b[c].minScale:0<a&&0==b[c].minScale||0<a&&0<b[c].minScale&&(a=Math.min(a,b[c].minScale)),d=Math.max(d||0,b[c].maxScale||0),!(-1<b[c].parentLayerId))break;f=b[c].parentLayerId}}return{minScale:a,maxScale:d}},
_isSupportedLayerType:function(b){return!(!b||!("esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass||"esri.layers.ArcGISImageServiceLayer"===b.declaredClass&&10.2<=b.version||"esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===b.declaredClass||"esri.layers.FeatureLayer"===b.declaredClass||"esri.layers.StreamLayer"===b.declaredClass||"esri.layers.KMLLayer"===b.declaredClass||"esri.layers.GeoRSSLayer"===b.declaredClass||"esri.layers.WMSLayer"===
b.declaredClass||"esri.layers.WFSLayer"===b.declaredClass||"esri.layers.CSVLayer"===b.declaredClass))},isHostedTileService:function(b){var c=/(https?:)?\/\/services.*\.arcgis\.com/i;return!("esri.layers.ArcGISTiledMapServiceLayer"!==b.declaredClass||!c.test(b.url))},getField:function(b,c,a){if(b.getField)return b.getField(c);if(a&&a.fields){var d;return x.forEach(a.fields,function(b){b.name===c&&(d=b)}),d}return null}});return y.mixin(H,{ALIGN_LEFT:0,ALIGN_RIGHT:1}),n("extend-esri")&&y.setObject("dijit.Legend",
H,N),H})},"dojo/debounce":function(){define([],function(){return function(B,m){var y;return function(){y&&clearTimeout(y);var x=this,g=arguments;y=setTimeout(function(){B.apply(x,g)},m)}}})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(B,m,y,x){var g=function(g,r){return g-r},w={_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(g){var r=String(g),n=r.match(w._reNumber);g={integer:0,fractional:0};if(n&&n[1])g.integer=n[1].split("").length,
g.fractional=n[3]?n[3].split("").length:0;else if(-1<r.toLowerCase().indexOf("e")){var m,a,n=r.split("e"),r=n[0],n=n[1];r&&n&&(r=Number(r),n=Number(n),a=0<n,a||(n=Math.abs(n)),m=w.getDigits(r),a?(m.integer+=n,n>m.fractional?m.fractional=0:m.fractional-=n):(m.fractional+=n,n>m.integer?m.integer=1:m.integer-=n),g=m)}return g},getFixedNumbers:function(g,r){var n,m;return n=Number(g.toFixed(r)),n<g?m=n+1/Math.pow(10,r):(m=n,n-=1/Math.pow(10,r)),n=Number(n.toFixed(r)),m=Number(m.toFixed(r)),[n,m]},getPctChange:function(g,
r,n,m){var a,k,e,p={prev:null,next:null};return null!=n&&(a=g-n,k=r-n,e=k-a,p.prev=Math.floor(Math.abs(100*e/a))),null!=m&&(a=m-g,k=m-r,e=k-a,p.next=Math.floor(Math.abs(100*e/a))),p},round:function(m,r){var n,t,a,k,e,p,u,z,x;m=m.slice(0);var y=r&&null!=r.tolerance?r.tolerance:2,B=r&&r.indexes,P=!(!r||null==r.strictBounds)&&r.strictBounds;if(B)B.sort(g);else for(B=[],p=0;p<m.length;p++)B.push(p);for(p=0;p<B.length;p++)if(x=B[p],n=m[x],r=0===x?null:m[x-1],t=x===m.length-1?null:m[x+1],a=w.getDigits(n),
k=a.fractional){u=0;for(z=!1;u<=k&&!z;)e=w.getFixedNumbers(n,u),e=P&&0===p?e[1]:e[0],z=w.hasMinimalChange(n,e,r,t,y),u++;z&&(m[x]=e)}return m},hasMinimalChange:function(g,r,n,m,a){var k,e;g=w.getPctChange(g,r,n,m);return k=null==g.prev||g.prev<=a,e=null==g.next||g.next<=a,k&&e||g.prev+g.next<=2*a},_reAllZeros:new RegExp("\\"+y.decimal+"0+$","g"),_reSomeZeros:/(\d)0*$/g,format:function(g,r){r=r||{places:20,round:-1};g=m.format(g,r);return g&&(g=g.replace(w._reSomeZeros,"$1").replace(w._reAllZeros,
"")),g}};return B("extend-esri")&&(x.numberUtils=w),w})},"esri/renderers/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/has dojo/date/locale ../kernel ../numberUtils ../Color dojo/i18n!dojo/cldr/nls/gregorian".split(" "),function(B,m,y,x,g,w,t,r){function n(a){return a&&m.map(a,function(a){return new t(a)})}function A(a,e,g){var p="";return 0===e?p=k.lt+" ":e===g&&(p=k.gt+" "),p+a}var a={},k={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%"},e={millisecond:0,second:1,minute:2,
hour:3,day:4,month:5,year:6},p={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},day:{selector:"date",dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},year:{selector:"date",dateOptions:{selector:"year"}}},
u={formatLength:"short",fullYear:!0},z={formatLength:"short"};return B.mixin(a,{timelineDateFormatOptions:{selector:"date",dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(a,e){var k,g=[];null==a||a instanceof Date||(a=new Date(a));e=e||{};e=B.mixin({},e);var p=e.selector?e.selector.toLowerCase():null,n=!p||-1<p.indexOf("time"),p=!p||-1<p.indexOf("date");return n&&(e.timeOptions=e.timeOptions||z,e.timeOptions&&(e.timeOptions=B.mixin({},e.timeOptions),e.timeOptions.selector=e.timeOptions.selector||
"time",g.push(e.timeOptions))),p&&(e.dateOptions=e.dateOptions||u,e.dateOptions&&(e.dateOptions=B.mixin({},e.dateOptions),e.dateOptions.selector=e.dateOptions.selector||"date",g.push(e.dateOptions))),g&&g.length?(g=m.map(g,function(e){return x.format(a,e)}),k=1==g.length?g[0]:r["dateTimeFormat-medium"].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,e){return g[e]})):k=x.format(a),k},createColorStops:function(e){var k=e.values,g=e.colors,p=e.labelIndexes,n=e.isDate,u=e.dateFormatOptions;return m.map(k,
function(e,r){var z=null;if(!p||-1<m.indexOf(p,r)){var t;(t=n?a.formatDate(e,u):w.format(e))&&(z=A(t,r,k.length-1))}return{value:e,color:g[r],label:z}})},updateColorStops:function(e){var k,g=e.stops,p=e.changes,n=e.isDate,u=e.dateFormatOptions,r=[],z=m.map(g,function(a){return a.value});m.forEach(p,function(a){r.push(a.index);z[a.index]=a.value});k=w.round(z,{indexes:r});m.forEach(g,function(e,p){if(e.value=z[p],null!=e.label){var r,m=null;(r=n?a.formatDate(k[p],u):w.format(k[p]))&&(m=A(r,p,g.length-
1));e.label=m}})},createClassBreakLabel:function(a){var e=a.minValue,g=a.maxValue,p=a.isFirstBreak?"":k.gt+" ";a="percent-of-total"===a.normalizationType?k.pct:"";return e=null==e?"":w.format(e),g=null==g?"":w.format(g),p+e+a+" \u2013 "+g+a},setLabelsForClassBreaks:function(e){var k=e.classBreaks,g=e.classificationMethod,p=e.normalizationType,n=[];k&&k.length&&("standard-deviation"===g?console.log("setLabelsForClassBreaks: cannot set labels for class breaks generated using 'standard-deviation' method."):
e.round?(n.push(k[0].minValue),m.forEach(k,function(a){n.push(a.maxValue)}),n=w.round(n),m.forEach(k,function(e,k){e.label=a.createClassBreakLabel({minValue:0===k?n[0]:n[k],maxValue:n[k+1],isFirstBreak:0===k,normalizationType:p})})):m.forEach(k,function(e,k){e.label=a.createClassBreakLabel({minValue:e.minValue,maxValue:e.maxValue,isFirstBreak:0===k,normalizationType:p})}))},updateClassBreak:function(e){var k,g=e.classBreaks,p=e.normalizationType,n=e.change,u=n.index,n=n.value,r=-1,z=-1,m=g.length;
if("standard-deviation"===e.classificationMethod)return void console.log("updateClassBreak: cannot update labels for class breaks generated using 'standard-deviation' method.");0===u?r=u:u===m?z=u-1:(z=u-1,r=u);-1<r&&r<m&&(k=g[r],k.minValue=n,k.label=a.createClassBreakLabel({minValue:k.minValue,maxValue:k.maxValue,isFirstBreak:0===r,normalizationType:p}));-1<z&&z<m&&(k=g[z],k.maxValue=n,k.label=a.createClassBreakLabel({minValue:k.minValue,maxValue:k.maxValue,isFirstBreak:0===z,normalizationType:p}))},
calculateDateFormatInterval:function(a){var k,g,p,n,u,r,z,t,w,A=a.length,x=1/0;a=m.map(a,function(a){return new Date(a)});for(k=0;k<A-1;k++){p=a[k];u=[];z=1/0;t="";for(g=k+1;g<A;g++)n=a[g],n=p.getFullYear()!==n.getFullYear()&&"year"||p.getMonth()!==n.getMonth()&&"month"||p.getDate()!==n.getDate()&&"day"||p.getHours()!==n.getHours()&&"hour"||p.getMinutes()!==n.getMinutes()&&"minute"||p.getSeconds()!==n.getSeconds()&&"second"||"millisecond",r=e[n],r<z&&(z=r,t=n),u.push(n);z<x&&(x=z,w=t)}return w},createUniqueValueLabel:function(e){var k=
e.value,g=e.fieldInfo,n=e.domain;e=e.dateFormatInterval;var u=String(k),n=n&&n.codedValues?n.getName(k):null;return n?u=n:"number"==typeof k&&(u=g&&"esriFieldTypeDate"===g.type?a.formatDate(k,e&&p[e]):w.format(k)),u},cloneColorInfo:function(a){var e;return a&&(e=B.mixin({},a),e.colors=n(e.colors),e.stops=e.stops&&m.map(e.stops,function(a){return a=B.mixin({},a),a.color&&(a.color=new t(a.color)),a}),e.legendOptions&&(e.legendOptions=B.mixin({},e.legendOptions))),e},cloneOpacityInfo:function(a){var e;
a&&(e=B.mixin({},a),(a=e.opacityValues)&&(e.opacityValues=a.slice(0)),(a=e.stops)&&(e.stops=m.map(a,function(a){return B.mixin({},a)})),(a=e.legendOptions)&&(e.legendOptions=B.mixin({},a)));return e},cloneSizeInfo:function(e){var k;e&&(k=B.mixin({},e),k.stops&&(k.stops=m.map(k.stops,function(a){return B.mixin({},a)})),(e=k.minSize)&&"object"==typeof e&&(k.minSize=a.cloneSizeInfo(e)),(e=k.maxSize)&&"object"==typeof e&&(k.maxSize=a.cloneSizeInfo(e)),(e=k.legendOptions)&&(k.legendOptions=B.mixin({},
e),(e=e.customValues)&&(k.legendOptions.customValues=e.slice(0))));return k},getClassCodesForRelationship:function(){return B.clone({2:["L","H"],3:["L","M","H"],4:["L","M1","M2","H"]})},getClassValuesForRelationship:function(){return B.clone({2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]})}}),y("extend-esri")&&B.setObject("renderer.utils",a,g),a})},"jimu/LayerInfos/LayerInfoForGeoRSS":function(){define("dojo/_base/declare dojo/_base/array dojo/Deferred esri/lang jimu/utils ./LayerInfo".split(" "),
function(B,m,y,x,g,w){return B(w,{constructor:function(){},_getExtent:function(){var m=new y,r=this.layerObject.items,n=this.layerObject.fullExtent||this.layerObject.initialExtent;0===r.length?m.resolve(n):m.resolve(g.graphicsExtent(r));return m},_resetLayerObjectVisiblity:function(g){var r=g?g[this.id]:null;if(r){var n={},m;for(m in g)g.hasOwnProperty(m)&&"function"!==typeof g[m]&&(n[m]=g[m].visible);this._setSubLayerVisibleByCheckedInfo(n);this._setTopLayerVisible(r.visible)}},_setSubLayerVisibleByCheckedInfo:function(g){m.forEach(this.newSubLayers,
function(r){x.isDefined(g[r.id])&&r.layerObject.setVisibility(g[r.id])},this)},_initVisible:function(){var g=!1,r;for(r=0;r<this.newSubLayers.length;r++)g=g||this.newSubLayers[r].layerObject.visible;g&&(this._visible=!0)},_setTopLayerVisible:function(g){this._visible=g?!0:!1;m.forEach(this.newSubLayers,function(g){g.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var g=[],r=this.layerObject.getFeatureLayers();m.forEach(r,function(n){n=this._layerInfoFactory.create({layerObject:n,
title:n.label||n.title||n.name||n.id||" ",id:n.id||" ",subId:n.id||" ",collection:{layerInfo:this},selfType:"geo_rss",parentLayerInfo:this});g.push(n);n.init()},this);this._markInvalidSubLayerInfoThatAsRootLayer(r);return g},_markInvalidSubLayerInfoThatAsRootLayer:function(g){var r;m.forEach(g,function(g){if(r=this._getLayerInfosObj()._findTopLayerInfoById(g.id))r._flag._invalid=!0},this)},_needToRenew:function(){var g=this.layerObject.getFeatureLayers();return(g?g.length:0)===this.newSubLayers.length?
!1:!0},_obtainLayerIndexesInMap:function(){var g=[],r,n;for(n=0;n<this.newSubLayers.length;n++)(r=this._getLayerIndexesInMapByLayerId(this.newSubLayers[n].layerObject.id))&&g.push(r);return g},moveLeftOfIndex:function(g){var r;for(r=this.newSubLayers.length-1;0<=r;r--)this.map.reorderLayer(this.newSubLayers[r].layerObject,g)},moveRightOfIndex:function(g){var r;for(r=0;r<this.newSubLayers.length;r++)this.map.reorderLayer(this.newSubLayers[r].layerObject,g)}})})},"jimu/LayerInfos/LayerInfoForWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/topic dojo/Deferred esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefaultWMS esri/layers/FeatureLayer esri/lang".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a){return B(r,{constructor:function(a,e){},_getExtent:function(){var a=new g;a.resolve(this.layerObject.extent||this.layerObject.fullExtent);return a},_initVisible:function(){this._visible=this.layerObject.visible},_setTopLayerVisible:function(a){this._visible=a;this.layerObject.setVisibility(a)},_setSubLayerVisible:function(a){var e=[],k,e=y.clone(this.originOperLayer.layerObject.visibleLayers),g;for(g in a)if(a.hasOwnProperty(g)&&"function"!==typeof a[g]){var n=a[g],
r=g.toString();k=m.indexOf(e,r);n?0>k&&e.push(r):0<=k&&e.splice(k,1)}this._setVisibleLayersBySelfFlag=!0;this.layerObject.setVisibleLayers(e)},_resetLayerObjectVisiblity:function(a){var e=a?a[this.id]:null,k=!1;if(a){e&&this.layerObject.setVisibility(e.visible);var e={},g;for(g in a)a.hasOwnProperty(g)&&"function"!==typeof a[g]&&(k=!0,e[g]=a[g].visible);k&&this._setSubLayerVisibleByCheckedInfo(e)}},_setSubLayerVisibleByCheckedInfo:function(k){var e={};this.traversal(function(e){e.isRootLayer()||a.isDefined(k[e.id])&&
e._setVisible(k[e.id])});this.traversal(function(a){0===a.getSubLayers().length&&(e[a.subId]=a._isAllSubLayerVisibleOnPath())});this._setSubLayerVisible(e)},_getServiceDefinition:function(){var a=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(a)},_serviceDefinitionRequest:function(a){return this._normalRequest(a,{SERVICE:"WMS",REQUEST:"GetCapabilities"},"xml")},obtainNewSubLayers:function(){var a=[];m.forEach(this.layerObject.layerInfos,function(e,k){e=this._getOperLayerFromWMSLayerInfo(e,
this);e=this._layerInfoFactory.create(e);a.push(e);e.init()},this);return a},_getOperLayerFromWMSLayerInfo:function(a,e){return{layerObject:this.layerObject,title:a.label||a.title||a.name||" ",id:this.id+"_"+(a.name||a.title+"-"+Math.random()),subId:a.name||"-",wms:{layerInfo:this,subId:a.name||"-",wmsLayerInfo:a},selfType:"wms",parentLayerInfo:e}},_bindEvent:function(){this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&t.after(this.layerObject,"setVisibleLayers",y.hitch(this,this._onVisibleLayersChanged))},
_onVisibleLayersChanged:function(){var a=[];this._setVisibleLayersBySelfFlag||(this.traversal(function(a){a.isRootLayer()||a._initVisible()}),this._setVisibleLayersBySelfFlag=!1);this.traversal(function(e){e.isRootLayer()||a.push(e)});this._setVisibleLayersBySelfFlag=!1;x.publish("layerInfos/layerInfo/visibleChanged",a);this._isShowInMapChanged2()}})})},"jimu/LayerInfos/LayerInfoForDefaultWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/dom-construct dojo/on ./LayerInfoForDefault".split(" "),
function(B,m,y,x,g,w){return B(w,{constructor:function(g,r){this.layerObject=g.layerObject},_resetLayerObjectVisiblity:function(){},_initVisible:function(){var g=!1;this.traversal(function(r){if(0<=m.indexOf(r.layerObject.visibleLayers,r.subId))return g=!0});this._visible=g},_setVisible:function(g){this._visible=g?!0:!1},_setTopLayerVisible:function(g){var r=this.originOperLayer.wms;this._visible=g?!0:!1;var n={};this.traversal(function(g){0===g.getSubLayers().length&&(n[g.subId]=g._isAllSubLayerVisibleOnPath())});
r.layerInfo._setSubLayerVisible(n)},_getServiceDefinition:function(){var g=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(g)},_serviceDefinitionRequest:function(g){return this._normalRequest(g,{SERVICE:"WMS",REQUEST:"GetCapabilities"},"xml")},obtainNewSubLayers:function(){var g=[],r=this.originOperLayer.wms;m.forEach(r.wmsLayerInfo.subLayers,function(n){n=r.layerInfo._getOperLayerFromWMSLayerInfo(n,this);n=this._layerInfoFactory.create(n);g.push(n);n.init()},this);
return g},drawLegends:function(g){this._initLegendsNode(g)},_initLegendsNode:function(m){if(this.originOperLayer.wms.wmsLayerInfo.legendURL){var r=x.create("img",{"class":"legend-div-image",src:this.originOperLayer.wms.wmsLayerInfo.legendURL});g(r,"load",function(){x.empty(m);var g=x.create("div",{"class":"legend-div"},m);y.place(r,g)})}else x.empty(m)},getOpacity:function(){},setOpacity:function(g){},_bindEvent:function(){},_onVisibleLayersChanged:function(){},getScaleRange:function(){return this.originOperLayer.wms.layerInfo.getScaleRange()}})})},
"jimu/LayerInfos/LayerInfoForDefaultDynamic":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(B,m){return B(m,{constructor:function(m,x){},_initVisible:function(){var m=!1,x=this.originOperLayer.mapService;x&&x.layerInfo._subLayerVisible[x.subId]&&(m=!0);this._visible=m},_setTopLayerVisible:function(m){var x=this.originOperLayer.mapService;if(x){x.layerInfo._subLayerVisible[x.subId]=m?!0:!1;this._visible=m;var g={};this.traversal(function(m){0===m.getSubLayers().length&&
(g[m.originOperLayer.mapService.subId]=m._isAllSubLayerVisibleOnPath())});x.layerInfo._setSubLayerVisible(g)}}})})},"jimu/LayerInfos/LayerInfoForDefaultService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/topic dojo/dom-construct ./LayerInfoForDefault ./LayerObjectFacory".split(" "),function(B,m,y,x,g,w,t,r){return B(t,{_legendsNode:null,_layerObjectFacory:null,constructor:function(){this._layerObjectFacory=new r(this)},_resetLayerObjectVisiblity:function(){},
_loadLegends:function(g){var n=new x;this.originOperLayer.mapService.layerInfo.getLegendInfo(g).then(y.hitch(this,function(a){n.resolve(a)}));return n},drawLegends:function(g,r){this._loadLegends(r).then(y.hitch(this,function(a){this._initLegendsNode(a,g)}))},_initLegendsNode:function(g,r){var a=this.originOperLayer.mapService;if(g){w.empty(r);for(var k=null,e=0;e<g.length;e++)if(g[e].layerId===a.subId){k=g[e];break}if(k){var p=w.create("table",{"class":"legend-table",style:"font-size: 12px"},r);
m.forEach(k.legend,function(a){if("\x3call other values\x3e"!==a.label){var e=w.create("tr",{"class":"legend-tr",style:"border: 1px solid"},p),k=w.create("td",{"class":"legend-symbol-td",style:""},e),g=null,g=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;w.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;top:0;left:0;bottom:0;right:0",src:g},k);w.create("td",{"class":"legend-label-td",innerHTML:a.label||" ",style:"padding-left: 5px"},e)}},this)}}},_initControlPopup:function(){var g=
this.originOperLayer.mapService.layerInfo.layerObject,r=this.originOperLayer.mapService.subId;this.controlPopupInfo={enablePopup:g.infoTemplates&&g.infoTemplates[r]?!0:!1,infoTemplates:void 0}},_afterSetInfoTemplates:function(){var g=this.originOperLayer.mapService.layerInfo.layerObject,r=this.originOperLayer.mapService.subId;!this.controlPopupInfo.enablePopup&&g.infoTemplates&&delete g.infoTemplates[r]},_getShowLegendOfWebmap:function(){return this.originOperLayer.mapService.layerInfo._getSublayerShowLegendOfWebmap(this.originOperLayer.mapService.subId)},
_getServiceDefinition:function(){return this.originOperLayer.mapService.layerInfo._getSubserviceDefinition(this.originOperLayer.mapService.mapServiceSubId)},_getLayerObject:function(g){var n=new x;(g?this._layerObjectFacory.getLayerObjectWithUrl(g):this._layerObjectFacory.getLayerObject()).then(y.hitch(this,function(a){this.layerObject.empty&&a&&(this.layerObject=a);n.resolve(a)}));return n},getLayerObject:function(){return this._getLayerObject()},getLayerObjectTryUsingFeatureService:function(){var g;
return this.isItemLayer()?this.getItemInfo().then(y.hitch(this,function(n){n&&n.getItemData()&&n.getItemData().layers&&m.some(n.getItemData().layers,function(a){if(a.id===this.subId)return g=a.layerUrl,!0},this);return g?this._getLayerObject(g):this._getLayerObject()})):this.getLayerObject()},getPopupInfo:function(){var g=null,r=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(r)for(var a=0;a<r.length;a++)if(r[a].id===this.originOperLayer.mapService.subId){g=r[a].popupInfo;break}return g},
getFilterOfWebmap:function(){var g=null,r=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(r)for(var a=0;a<r.length;a++)if(r[a].id===this.originOperLayer.mapService.subId){g=r[a].layerDefinition?r[a].layerDefinition.definitionExpression:null;break}return g},getFilter:function(){var g=this.originOperLayer.mapService;return g.layerInfo.layerObject&&g.layerInfo.layerObject.layerDefinitions?g.layerInfo.layerObject.layerDefinitions[g.subId]:null},setFilter:function(g,r){var a,k=this.originOperLayer.mapService;
k.layerInfo.layerObject&&k.layerInfo.layerObject.setLayerDefinitions&&(a=k.layerInfo.layerObject.layerDefinitions?m.map(k.layerInfo.layerObject.layerDefinitions,function(a){return a}):[],r=y.mixin({},r),y.setObject("_wabProperties.objectPassWithFilterChangeEvent",r,k.layerInfo.layerObject),a[k.subId]=g,k.layerInfo.layerObject.setLayerDefinitions(a))},getLayerType:function(){var g=new x;0<this.getSubLayers().length?g.resolve("GroupLayer"):this._getServiceDefinition().then(y.hitch(this,function(n){n?
g.resolve(n.type.replace(/\ /g,"")):g.resolve(null)}),function(){g.resolve(null)});return g},getSupportTableInfo:function(){var g=new x,r={isSupportedLayer:!1,isSupportQuery:!1,layerType:null};this.getLayerType().then(y.hitch(this,function(a){r.layerType=a;0<=this._getLayerTypesOfSupportTable().indexOf(a)&&(r.isSupportedLayer=!0);this._getServiceDefinition().then(y.hitch(this,function(a){a&&0<=a.capabilities.indexOf("Data")&&(r.isSupportQuery=!0);g.resolve(r)}),function(){g.resolve(r)})}),function(){g.resolve(r)});
return g},enablePopup:function(){var g=this.originOperLayer.mapService.layerInfo,r=g.layerObject,a=this.originOperLayer.mapService.subId;return this.loadInfoTemplate().then(y.hitch(this,function(){return g.controlPopupInfo.infoTemplates&&g.controlPopupInfo.infoTemplates[a]?(this.controlPopupInfo.enablePopup=!0,r.infoTemplates||(r.infoTemplates={}),r.infoTemplates[a]=g.controlPopupInfo.infoTemplates[a],!0):!1}))},disablePopup:function(){var g=this.originOperLayer.mapService.layerInfo.layerObject,r=
this.originOperLayer.mapService.subId;this.controlPopupInfo.enablePopup=!1;g.infoTemplates&&delete g.infoTemplates[r]},loadInfoTemplate:function(){var g=new x,r=this.originOperLayer.mapService.layerInfo,a=this.originOperLayer.mapService.subId;r.controlPopupInfo.infoTemplates&&r.controlPopupInfo.infoTemplates[a]&&r.controlPopupInfo.infoTemplates[a].infoTemplate?g.resolve(r.controlPopupInfo.infoTemplates[a].infoTemplate):(r.controlPopupInfo.infoTemplates||(r.controlPopupInfo.infoTemplates={}),this.getLayerObject().then(y.hitch(this,
function(k){k=this._getDefaultPopupTemplate(k);r.controlPopupInfo.infoTemplates[a]={infoTemplate:k,layerUrl:null};g.resolve(k)}),y.hitch(this,function(){g.resolve(null)})));return g},getInfoTemplate:function(){var g=this.originOperLayer.mapService.layerInfo,r=this.originOperLayer.mapService.subId;return g.controlPopupInfo.infoTemplates&&g.controlPopupInfo.infoTemplates[r]&&g.controlPopupInfo.infoTemplates[r].infoTemplate?g.controlPopupInfo.infoTemplates[r].infoTemplate:null},getScaleRange:function(){var g=
this.originOperLayer.mapService;return(g=g.layerInfo._getJsapiLayerInfoById(g.subId))&&0<=g.minScale&&0<=g.maxScale?{minScale:g.minScale,maxScale:g.maxScale}:{minScale:0,maxScale:0}},setScaleRange:function(n,r){var a=this.originOperLayer.mapService,k=a.layerInfo._getJsapiLayerInfoById(a.subId);a.layerInfo.layerObject&&a.layerInfo.layerObject.supportsDynamicLayers&&a.layerInfo.layerObject.setDynamicLayerInfos&&k&&(k.minScale!==n||k.maxScale!==r)&&(k.minScale=n,k.maxScale=r,a.layerInfo.layerObject.setDynamicLayerInfos(a.layerInfo._jsapiLayerInfos),
g.publish("layerInfos/layerInfo/scaleRangeChanged",[this]))},_onVisibilityChanged:function(){}})})},"jimu/LayerInfos/LayerObjectFacory":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred ./RequestBuffer esri/layers/FeatureLayer esri/layers/RasterLayer esri/layers/StreamLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISImageServiceVectorLayer".split(" "),function(B,m,y,x,g,w,t,r,n,A){return B(null,{_layerInfo:null,_layerObjectBuffer:null,constructor:function(a){this._layerInfo=
a;this._initLayerObjectBuffer()},_initLayerObjectBuffer:function(){this._layerObjectBuffer=new g(m.hitch(this,this._getLayerObject))},getLayerObject:function(){var a=this._layerInfo.getUrl();return this._layerObjectBuffer.getRequest(this._layerInfo.subId).request(a)},getLayerObjectWithUrl:function(a){return this._layerObjectBuffer.getRequest(this._layerInfo.subId+"_url").request(a)},_getLayerObject:function(a){var k,e=new x;this._layerInfo.getLayerType().then(m.hitch(this,function(g){var p=m.mixin(this._getLayerOptionsForCreateLayerObject(),
this._layerInfo.originOperLayer.options||{})||{};switch(g){case "FeatureLayer":k=new w(a,p);break;case "RasterLayer":k=new t(a);break;case "StreamLayer":k=new r(a);break;case "ArcGISImageServiceLayer":k=new n(a);break;case "ArcGISImageServiceVectorLayer":k=new A(a);break;case "Table":if(this._layerInfo.layerObject&&!this._layerInfo.layerObject.empty)return this._setLayerObjectProperties(this._layerInfo.layerObject),e.resolve(this._layerInfo.layerObject),e;if(this._layerInfo.layerObject&&this._layerInfo.layerObject.url)k=
new w(a,p);else return this._layerInfo.layerObject&&this._layerInfo.layerObject.featureCollectionData?(k=new w(this._layerInfo.layerObject.featureCollectionData,p),this._setLayerObjectProperties(k),e.resolve(k)):e.resolve(null),e;break;case "GroupLayer":return e=this._getGroupLayerObject();default:return e.resolve(null),e}var z=k.on("load",m.hitch(this,function(){this._setLayerObjectProperties(k);e.resolve(k);z.remove&&z.remove()})),x=k.on("error",m.hitch(this,function(a){e.reject(a);x.remove&&x.remove()}))}),
m.hitch(this,function(){e.reject()}));return e},_getGroupLayerObject:function(){var a=new x;this._layerInfo._getServiceDefinition().then(m.hitch(this,function(k){if(null===k)a.reject();else{var e=this._layerInfo.getUrl();k.url=e;k.id=this._layerInfo.id;a.resolve(k)}}));return a},_getLayerOptionsForCreateLayerObject:function(){var a={},k=[],e=this._layerInfo.getInfoTemplate();e&&e.info&&e.info.fieldInfos?y.forEach(e.info.fieldInfos,function(a){a.visible&&k.push(a.fieldName)},this):k=["*"];a.outFields=
k;return a},_setLayerObjectProperties:function(a){a.name&&!m.getObject("_wabProperties.originalLayerName",!1,a)&&(m.setObject("_wabProperties.originalLayerName",a.name,a),a.name=this._layerInfo.title);a.id=this._layerInfo.id;this._layerInfo.loadInfoTemplate().then(m.hitch(this,function(k){a.infoTemplate=k}))}})})},"esri/layers/RasterLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojo/number ../lang ../domUtils ./BaseRasterLayer ./ImageServiceLayerMixin ./pixelFilters/StretchFilter ../SpatialReference ../geometry/Point".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u){return B([a,k],{declaredClass:"esri.layers.RasterLayer",constructor:function(a,e){this.pixelData=null;null!==this.format&&void 0!==this.format||this.setImageFormat("LERC",!0)},_setDefaultFilter:function(){if(this.loaded&&this.drawType&&!this._isVectorData()&&(!this.pixelFilter||this._isDefaultPixelFilter)){if("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))return void(this._isDefaultPixelFilter&&
(this.pixelFilter=null,this._isDefaultPixelFilter=!1));var a,k;if(this.minValues&&this.maxValues&&this.stdvValues&&this.meanValues){a=[];for(k=0;k<this.minValues.length;k++)a.push([this.minValues[k],this.maxValues[k],this.meanValues[k],this.stdvValues[k]]);this.bandCount!==a.length&&(a=null)}k=0;var g=!1;"U8"===this.pixelType?(k=5,g=!a):a?(k=5,g=!1):(k=6,g=!0);this.renderingRule&&(k=5,g=!0);this.pixelFilter=(new e({stretchType:k,min:0,max:255,dra:g,minPercent:.25,maxPercent:.25,useGamma:!1,computeGamma:!1,
statistics:a,numberOfStandardDeviations:2.5})).filter;this._isDefaultPixelFilter=!0}}})})},"esri/layers/BaseRasterLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../lang ../domUtils ../geometry/Point ./layer".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p){var u=A.defaults.map.zoomDuration;return B([p],{declaredClass:"esri.layers.BaseRasterLayer",managedSuspension:!0,
opacity:1,constructor:function(a,e){this.drawMode=!e||void 0===e.drawMode||e.drawMode;this.drawType=e&&e.drawType?e.drawType:"2d";this.pixelData=null;this._initialize(a,e)},setDrawMode:function(a){this.drawMode=a},setOpacity:function(a){this.opacity!==a&&(this.opacity=a,this.onOpacityChange(a))},onOpacityChange:function(){},refresh:function(){if(!this._canDraw()||10>g("ie"))return void this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));this._map&&this._extentChangeHandler(this._map.extent)},
clear:function(){this._canDraw()&&"2d"===this.drawType&&this._context.clearRect(0,0,this._mapWidth,this._mapHeight)},getContext:function(){return this._context},onResume:function(){if(this.inherited(arguments),this._toggleTime(),"css-transforms"===this._map.navigationMode){var a=this._map.__visibleDelta;this._left=this._tdx=a.x;this._top=this._tdy=a.y;t.set(this._div,n._css.names.transform,n._css.translate(this._left,this._top))}this._displayTimer=this._displayTimer||setTimeout(m.hitch(this,function(){this._extentChangeHandler(this._map.extent,
null,!0)}),0)},onSuspend:function(){this.inherited(arguments);this._toggleTime();clearTimeout(this._displayTimer);this._displayTimer=null},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},getCurrentResolution:function(){var a=this._map.extent;return new e((a.xmax-a.xmin)/this._map.width,(a.ymax-a.ymin)/this._map.height,a.spatialReference)},setPixelFilter:function(a,e){this.pixelFilter=a;e||this.redraw()},_toggleTime:function(){},_setMap:function(e,k){this.inherited(arguments);
this._dragOrigin={x:0,y:0};var g=this._div=w.create("div",null,k),p={width:e.width+"px",height:e.height+"px",position:"absolute"};if("css-transforms"===e.navigationMode?(p[n._css.names.transform]=n._css.translate(e.__visibleDelta.x,e.__visibleDelta.y),this._left=e.__visibleDelta.x,this._top=e.__visibleDelta.y):this._left=this._top=0,t.set(g,p),this._canvas=w.create("canvas",{id:"canvas",width:e.width+"px",height:e.height+"px",style:"position: absolute;"},g),a.isDefined(this.opacity)&&t.set(g,"opacity",
this.opacity),this._context=this._canvas.getContext(this.drawType),this._context||console.error("Unable to create the context. This browser might not support \x3ccanvas\x3e elements."),this._mapWidth=e.width,this._mapHeight=e.height,this._connects=[],this._connects.push(y.connect(e,"onPan",this,this._panHandler)),this._connects.push(y.connect(e,"onPanEnd",this,this._panEndHandler)),"css-transforms"===e.navigationMode?this._connects.push(y.connect(e,"onScale",this,this._onScaleHandler)):(this._connects.push(y.connect(e,
"onZoom",this,this._onZoomHandler)),this._connects.push(y.connect(e,"onZoomEnd",this,this._onZoomEndHandler))),this._connects.push(y.connect(e,"onResize",this,this._onResizeHandler)),this._connects.push(y.connect(e,"onExtentChange",this,this._extentChangeHandler)),this._connects.push(y.connect(this,"onVisibilityChange",this,this._visibilityChangeHandler)),this._connects.push(y.connect(this,"onOpacityChange",this,this._opacityChangeHandler)),this._startRect={left:0,top:0,width:e.width,height:e.height},
this.evaluateSuspension(),this.suspended&&!e.loaded)var r=y.connect(e,"onLoad",this,function(){y.disconnect(r);r=null;this.evaluateSuspension()});return g},_unsetMap:function(a,e){x.forEach(this._connects,y.disconnect,this);var k=this._div;k&&(e.removeChild(k),w.destroy(k));this._map=this._canvas=this._context=this.data=this._connects=null;clearTimeout(this._displayTimer);this._displayTimer=null;this.inherited(arguments)},_canDraw:function(){return!!(this._map&&this._canvas&&this._context)},_requestDataErrorHandler:function(a){"CancelError"!==
a.name&&(this.clear(),this.onError(a))},_drawPixelData:function(){this._startRect={left:0,top:0,width:this._map.width,height:this._map.height};var a=this._useBrowserDecoding();if(!a&&this.drawMode||"css-transforms"===this._map.navigationMode&&(this._tdx=this._left,this._tdy=this._top,this._multiply=null,t.set(this._div,n._css.names.transform,n._css.translate(this._left,this._top)),t.set(this._canvas,n._css.names.transform,n._css.translate(-this._left,-this._top)),this._dragOrigin={x:0,y:0}),this._canDraw&&
this.drawMode){if(a)return void this._fireUpdateEnd();if(this.drawMode){if(!this.pixelData||!this.pixelData.pixelBlock)return void this.clear();var a=this.pixelData.pixelBlock,e=this._context,k=e.createImageData(a.width,a.height);k.data.set(a.getAsRGBA());var g=this.pixelData.extent,p=this._map.extent,r=this.getCurrentResolution(),u=0,m=0;Math.abs(g.xmin-p.xmin)>r.x&&(u=Math.round((g.xmin-p.xmin)/r.x));Math.abs(p.ymax-g.ymax)>r.y&&(m=Math.round((p.ymax-g.ymax)/r.y));this.clear();"css-transforms"===
this._map.navigationMode?(this._tdx=this._left,this._tdy=this._top,this._multiply=null,t.set(this._div,n._css.names.transform,n._css.translate(this._left,this._top)),t.set(this._canvas,n._css.names.transform,n._css.translate(-this._left,-this._top))):(t.set(this._div,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}),t.set(this._canvas,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}));this._dragOrigin={x:0,y:0};e.putImageData(k,u,m,0,0,a.width,
a.height);this._fireUpdateEnd()}}},_panHandler:function(a,e){"css-transforms"===this._map.navigationMode?(this._left=this._map.__visibleDelta.x+e.x,this._top=this._map.__visibleDelta.y+e.y,t.set(this._div,n._css.names.transform,n._css.translate(this._left,this._top))):t.set(this._div,{left:this._startRect.left+e.x+"px",top:this._startRect.top+e.y+"px"})},_panEndHandler:function(a,e){e&&(this._startRect.left+=e.x,this._startRect.top+=e.y)},_onScaleHandler:function(a,e){var k={},g=n._css.names;t.set(this._canvas,
g.transition,e?"none":g.transformName+" "+u+"ms ease");this._matrix=a;a=this._multiply?r.multiply(a,this._multiply):a;(this._tdx||this._tdy)&&(a=r.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:-this._tdx,dy:-this._tdy}));k[g.transform]=n._css.matrix(a);t.set(this._canvas,k)},_onZoomHandler:function(a,e,k){var g=this._startRect;a=g.width*e;e*=g.height;var p=g.left-(a-g.width)*(k.x-g.left)/g.width;k=g.top-(e-g.height)*(k.y-g.top)/g.height;t.set(this._canvas,{left:p+"px",top:k+"px",width:a+"px",height:e+"px"});
this._endRect={left:p,top:k,width:a,height:e}},_onZoomEndHandler:function(){this._endRect&&(this._startRect=this._endRect)},_onResizeHandler:function(a,e,k){t.set(this._div,{width:e+"px",height:k+"px"});t.set(this._canvas,{width:e+"px",height:k+"px"});this._startRect.width=this._canvas.width=e;this._startRect.height=this._canvas.height=k},_extentChangeHandler:function(a,e,k,g){this.suspended||e&&0===e.x&&0===e.y&&!k||("css-transforms"===this._map.navigationMode&&(e&&(this._dragOrigin.x+=e.x,this._dragOrigin.y+=
e.y),k||(this._left=this._map.__visibleDelta.x,this._top=this._map.__visibleDelta.y,t.set(this._div,n._css.names.transform,n._css.translate(this._left,this._top))),k&&(t.set(this._canvas,n._css.names.transition,"none"),this._multiply=this._multiply?r.multiply(this._matrix,this._multiply):this._matrix)),this._fireUpdateStart(),a=this._map,this._requestData(a.extent,a.width,a.height))},_visibilityChangeHandler:function(a){a?k.show(this._div):k.hide(this._div)},_opacityChangeHandler:function(a){t.set(this._div,
"opacity",a)}})})},"esri/layers/ImageServiceLayerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/json dojo/_base/config dojo/_base/connect dojo/has dojo/io-query dojo/DeferredList ../kernel ../config ../lang ../request ../deferredUtils ../urlUtils ../geometry/Extent ../geometry/Point ../geometry/Polygon ./MosaicRule ./RasterFunction ./DimensionalDefinition ./Raster ./PixelBlock ./pixelFilters/VectorFieldPixelFilter ./rasterFormats/ImageCanvasDecoder ./TimeInfo ./Field ../graphic ../tasks/ImageServiceIdentifyTask ../tasks/ImageServiceIdentifyParameters".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C,J,O,R,Q,T,S,U,X){B=B(null,{declaredClass:"esri.layers.ImageServiceLayerMixin",_rasterFieldPrefix:"Raster.",_renderingRuleFieldSubPrefix:"ServicePixelValue.",_rasterFunctionServiceInfoProps:"bandCount pixelType hasRasterAttributeTable hasHistograms minValues maxValues meanValues stdvValues serviceDataType".split(" "),_rasterFunctionTemplateInfos:{},_customRenderingRuleId:{},_pixelTypeRanges:{U1:[0,1],U2:[0,3],U4:[0,15],U8:[0,255],S8:[-128,127],
U16:[0,65535],S16:[-32768,32767]},_eventMap:{"rendering-change":!0,"mosaic-rule-change":!0,"spatial-reference-change":!0,"renderer-change":!0},constructor:function(a,e){this.useMapTime=!e||!e.hasOwnProperty("useMapTime")||!!e.useMapTime},_initialize:function(a,e){this._url=z.urlToObject(a);this.raster=new C(this._url.path);this.infoTemplate=e&&e.infoTemplate;this.format=(a=e&&e.imageServiceParameters)&&a.format;this.compressionTolerance=a&&a.compressionTolerance?a.compressionTolerance:.01;this.interpolation=
a?a.interpolation:null;this.compressionQuality=a?a.compressionQuality:null;this.bandIds=a?a.bandIds:null;this.mosaicRule=a?a.mosaicRule:null;this.renderingRule=a?a.renderingRule:null;this.renderer=a?a.renderer:null;this.useMapDimensionValue=!e||!e.hasOwnProperty("useMapDimensionValue")||!!e.useMapDimensionValue;this.hasImageFilter=e&&e.hasImageFilter;this.activeMapDimensions=e&&e.activeMapDimensions;this._params=m.mixin({},this._url.query,{f:"image",interpolation:this.interpolation,format:this.format,
compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null},a?a.toJson():{});this.pixelFilter=e&&e.pixelFilter;this.originalPixelData=this.pixelData=null;this.hasDataChanged=!0;this._requestDataHandler=m.hitch(this,this._requestDataHandler);this._requestDataErrorHandler=m.hitch(this,this._requestDataErrorHandler);this._rasterReadPromise=null;this._initLayer=m.hitch(this,this._initLayer);this._queryVisibleRastersHandler=m.hitch(this,this._queryVisibleRastersHandler);
this._visibleRasters=[];this._rasterAttributeTableFields=[];this._rasterAttributeTableFeatures=[];this._renderingRuleAttributeTable={};this._useRenderingRuleAttributeTable=!1;this._loadCallback=e&&e.loadCallback;(e=e&&e.resourceInfo)?this._initLayer(e):p({url:this._url.path,content:m.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});this.registerConnectEvents()},disableClientCaching:!1,_initLayer:function(a,k){if(null!==a&&void 0!==a){this._findCredential();
(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();k=this.minScale;var g=this.maxScale;m.mixin(this,a);this.minScale=k;this.maxScale=g;this.initialExtent=this.fullExtent=this.extent=new M(a.extent);this.spatialReference=this.initialExtent.spatialReference;this.pixelSizeX=parseFloat(this.pixelSizeX);this.pixelSizeY=parseFloat(this.pixelSizeY);var p=this.minValues,f=this.maxValues,n=this.meanValues,r=this.stdvValues,c=this.bands=[];k=0;for(g=this.bandCount;k<g;k++)c[k]={min:p[k],max:f[k],
mean:n[k],stddev:r[k]};this.timeInfo=(k=this.timeInfo)&&k.timeExtent?new Q(k):null;g=this.fields=[];if(p=a.fields)for(k=0;k<p.length;k++)g.push(new T(p[k]));(this._updateInfoTemplateFields(this.fields),this.version=a.currentVersion,this.version)||(this.version="fields"in a||"objectIdField"in a||"timeInfo"in a?10:9.3);e.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);e.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale);k={};(a.defaultMosaicMethod?(k.method=a.defaultMosaicMethod,
k.operation=a.mosaicOperator,k.sortField=a.sortField,k.sortValue=a.sortValue):k.method=P.METHOD_NONE,this.defaultMosaicRule=new P(k),this.defaultMosaicRule.ascending=!0,this._useRenderingRuleAttributeTable=10<this.version&&"esriImageServiceDataTypeThematic"===this.serviceDataType,this._setDefaultRenderingRule(!0),this.renderingRule&&this.getRenderingRuleServiceInfo(this.renderingRule).then(m.hitch(this,function(b){b.hasRasterAttributeTable&&this.getRenderingRuleAttributeTable({renderingRule:this.renderingRule}).then(m.hitch(this,
function(){!this.renderer||"esri.renderer.ClassBreaksRenderer"!==this.renderer.declaredClass&&"esri.renderer.UniqueValueRenderer"!==this.renderer.declaredClass||this.refresh()}))})),this._isScientificData()&&(!this.mosaicRule||this.mosaicRule&&!this.mosaicRule.multidimensionalDefinition)&&this._setDefaultMultidimensionalDefinition(!0),10<this.version&&this.hasRasterAttributeTable)&&this.getRasterAttributeTable().then(m.hitch(this,function(b){b&&(b.features&&b.fields&&(this.rasterAttributeTable=m.clone(b)),
b.features&&0<b.features.length&&(this._rasterAttributeTableFeatures=m.clone(b.features)),b.fields&&0<b.fields.length&&(this._rasterAttributeTableFields=m.clone(b.fields)),this.renderingRule||!this.renderer||"esri.renderer.ClassBreaksRenderer"!==this.renderer.declaredClass&&"esri.renderer.UniqueValueRenderer"!==this.renderer.declaredClass||this.refresh())}));this._initVectorPixelFilter();10.3<=this.version&&this.rasterFunctionInfos&&this.rasterFunctionInfos.length&&this.getRasterFunctionInfos().then(m.hitch(this,
function(b){if(b&&b.length){this.rasterFunctionInfos=b;var c,a=[];x.forEach(b,function(b){if(b){var d=b.functionType;c=c||1===d||2===d;a.push(b.name)}},this);this._hasItemLevelRFT=c;this._rasterFunctionNames=a;c&&(this._initVectorPixelFilter(),this.refresh())}}));this.loaded=!0;this._setDefaultFilter();this.onLoad(this);(a=this._loadCallback)&&(delete this._loadCallback,a(this))}},_updateInfoTemplateFields:function(a){if(a&&!(1>a.length)&&this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.fieldInfos&&
!(1>this.infoTemplate.info.fieldInfos.length)){var e,k,g,f;f=this.infoTemplate.info.fieldInfos;for(e=0;e<a.length;e++)for(g=a[e],k=0;k<f.length;k++)if(f[k].fieldName.toLowerCase()===g.name.toLowerCase()&&f[k].fieldName!==g.name){f[k].fieldName=g.name;break}}},getKeyProperties:function(a){var e=this._url.path+"/keyProperties",k=new y(u._dfdCanceller),n={f:"json"};(a&&a.renderingRule&&(n.renderingRule=g.toJson(a.renderingRule.toJson())),10<this.version)?(k._pendingDfd=p({url:e,content:n,handleAs:"json",
callbackParamName:"callback"}),k._pendingDfd.then(function(a){k.callback(a)},function(a){k.errback(a)})):(a=Error("Layer does not have key properties"),a.log=!!w.isDebug,k.errback(a));return k},getRasterAttributeTable:function(a){var e=this._url.path+"/rasterAttributeTable",k=new y(u._dfdCanceller),n={f:"json"},f=this.hasRasterAttributeTable;(a&&a.renderingRule&&(n.renderingRule=g.toJson(a.renderingRule.toJson()),f=!0),10<this.version&&f)?(k._pendingDfd=p({url:e,content:n,handleAs:"json",callbackParamName:"callback"}),
k._pendingDfd.then(function(a){k.callback(a)},function(a){k.errback(a)})):(a=Error("Layer does not support raster attribute table"),a.log=!!w.isDebug,k.errback(a));return k},getRenderingRuleAttributeTable:function(a){var e=new y(u._dfdCanceller);if(!a||!a.renderingRule)return e.errback(Error("Rendering rule is not specified")),e;a=a.renderingRule;var k=this._getRenderingRuleId(a);return this._renderingRuleAttributeTable&&k&&this._renderingRuleAttributeTable.hasOwnProperty(k)?e.resolve(this._renderingRuleAttributeTable[k]):
e=this.getRasterAttributeTable({renderingRule:a}).then(m.hitch(this,function(a){var f;return a&&a.features&&a.features.length&&a.fields&&a.fields.length&&(f={features:m.clone(a.features),fields:m.clone(a.fields)},k&&(this._renderingRuleAttributeTable[k]=f)),f})),e},_initVectorPixelFilter:function(){var a,k;if(this._hasItemLevelRFT&&this.renderingRule&&(a=this._getItemLevelRenderingRule(this.renderingRule)),k=a||this.renderingRule)return this.getRenderingRuleServiceInfo(k).then(m.hitch(this,function(a){a&&
this._isVectorData(a)&&!e.isDefined(this.pixelFilter)&&"esri.layers.ArcGISImageServiceVectorLayer"===this.declaredClass&&(this.vectorFieldPixelFilter=new O,this.vectorFieldPixelFilter.isDataUV="esriImageServiceDataTypeVector-UV"===a.serviceDataType,this.pixelFilter=this.vectorFieldPixelFilter.computeMagnitudeAndDirection,this.getKeyProperties().then(m.hitch(this,this._setFlowRepresentation)),this._applyVectorResamplingType(a.serviceDataType))}))},_applyVectorResamplingType:function(a){if(a){var e=
this.renderingRule;e&&"Resample"===e.functionName&&((e.functionArguments||{}).ResamplingType="esriImageServiceDataTypeVector-UV"===a?7:10,this.setRenderingRule(new K(e.toJson())))}},_getRasterAttributeTableFeatures:function(){var a=new y;return this._rasterAttributeTableFeatures&&0<this._rasterAttributeTableFeatures.length?(a.resolve(this._rasterAttributeTableFeatures),a):10<this.version&&this.hasRasterAttributeTable?(a=this.getRasterAttributeTable(),a.then(m.hitch(this,function(a){a&&a.features&&
0<a.features.length&&(this._rasterAttributeTableFeatures=m.clone(a.features))})),a):(a.resolve(this._rasterAttributeTableFeatures),a)},_getRenderingRuleAttributeTableFeatures:function(a){a=a&&a.renderingRule;return a?this.getRenderingRuleAttributeTable({renderingRule:a}).then(function(a){return a&&a.features}):(a=new y,a.errback(Error("Rendering rule is not specified")),a)},getCustomRasterFields:function(a){var k=a?a.rasterAttributeTableFieldPrefix:this._rasterFieldPrefix;a=10.3<=this.version?"esriFieldTypeDouble":
"esriFieldTypeString";var g={name:this._rasterFieldPrefix+"ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:a},p={name:this._rasterFieldPrefix+"ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:a},f={name:this._rasterFieldPrefix+"ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"},n=this.fields?m.clone(this.fields):[];a=n.length;(n[a]=p,10.4<=this.version&&"esri.layers.ArcGISImageServiceLayer"===
this.declaredClass&&(!this.rasterFunctionInfos||!this.rasterFunctionInfos.length||this._isRenderingRuleAProcessingTemplate({functionName:"none"}))&&(a++,n[a]=f),(this.capabilities&&-1<this.capabilities.toLowerCase().indexOf("catalog")||this.fields&&0<this.fields.length)&&(a++,n[a]=g),!e.isDefined(this.pixelFilter)||"esriImageServiceDataTypeVector-UV"!==this.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.serviceDataType)||(g={name:this._rasterFieldPrefix+"Magnitude",alias:"Magnitude",
domain:null,editable:!1,type:"esriFieldTypeDouble"},p={name:this._rasterFieldPrefix+"Direction",alias:"Direction",domain:null,editable:!1,type:"esriFieldTypeDouble"},a++,n[a]=g,a++,n[a]=p);a=this._rasterAttributeTableFields;g=this.renderingRule&&this._getRenderingRuleId(this.renderingRule);if(g&&this._renderingRuleAttributeTable&&this._renderingRuleAttributeTable.hasOwnProperty(g)&&(a=this._renderingRuleAttributeTable[g].fields),a&&0<a.length)a=x.filter(a,function(c){return"esriFieldTypeOID"!==c.type&&
"value"!==c.name.toLowerCase()}),a=x.map(a,function(c){var b=m.clone(c);return b.name=k+c.name,b}),n=n.concat(a);var r=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;return 10.4<=this.version&&this.rasterFunctionInfos&&x.forEach(this.rasterFunctionInfos,function(c){c&&c.name&&"none"!==c.name.toLowerCase()&&(c={name:r+c.name.replace(/ /gi,"_"),alias:c.name,domain:null,editable:!1,type:"esriFieldTypeDouble"},n.push(c))}),n},_prepareGetImageParameters:function(a,k,p,n){if(n=e.isDefined(n)?
n:this._params,this.renderer||this._hasItemLevelRFT&&this.renderingRule){var f=this.getExportImageRenderingRule();n.renderingRule=f?g.toJson(f.toJson()):null;f=this.getExportImageMosaicRule(n);n.mosaicRule=f?g.toJson(f.toJson()):null}f=a.spatialReference.wkid||g.toJson(a.spatialReference.toJson(!1));delete n._ts;m.mixin(n,{bbox:a.xmin+","+a.ymin+","+a.xmax+","+a.ymax,imageSR:f,bboxSR:f,size:k+","+p},this.disableClientCaching?{_ts:(new Date).getTime()}:{});delete n.compressionTolerance;n.format&&"LERC"===
n.format.toUpperCase()&&(n.compressionTolerance=this.compressionTolerance);n.token=this._getToken()},getImageUrl:function(a,g,r,u,f){f=e.isDefined(f)?f:this._params;this._prepareGetImageParameters(a,g,r,f);a=m.clone(f);this._cleanupRequestParams(a);g=this._url.path+"/exportImage?";r=z.addProxy(g+n.objectToQuery(m.mixin(a,{f:"image"})));var t=a.token;r.length>k.defaults.io.postLength||this.useMapImage?this._jsonRequest=p({url:g,content:m.mixin(a,{f:"json"}),callbackParamName:"callback",load:function(a,
c){a=a.href;t&&(a+=-1===a.indexOf("?")?"?token\x3d"+t:"\x26token\x3d"+t);u(z.addProxy(a))},error:this._errorHandler}):u(r)},onRenderingChange:function(){},onMosaicRuleChange:function(){},onRendererChange:function(){},setInterpolation:function(a,e){this.interpolation=this._params.interpolation=a;e||this.refresh(!0)},setCompressionQuality:function(a,e){this.compressionQuality=this._params.compressionQuality=a;e||this.refresh(!0)},setCompressionTolerance:function(a,e){this.compressionTolerance=a;e||
this.refresh(!0)},setBandIds:function(a,e){var k=!1;this.bandIds!==a&&(k=!0);this.bandIds=a;this._params.bandIds=a.join(",");k&&!e&&this.onRenderingChange();e||this.refresh(!0)},setDefaultBandIds:function(a){this.bandIds=this._params.bandIds=null;a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setMosaicRule:function(a,e){var k=!1;this.mosaicRule!==a&&(k=!0);this.mosaicRule=a;this._params.mosaicRule=g.toJson(a.toJson());k&&!e&&this.onMosaicRuleChange();e||this.refresh(!0)},
getRasterFunctionInfos:function(){return 10.3>this.version||!this.rasterFunctionInfos||!this.rasterFunctionInfos.length?void console.log("Layer doesn't support /rasterFunctionInfos resource."):p({url:this._url.path+"/rasterFunctionInfos",content:{f:"json"},handleAs:"json",load:function(a){return a&&a.rasterFunctionInfos}})},setRenderingRule:function(a,e){var k=!1;this.renderingRule!==a&&(k=!0);this.renderingRule=a;this._params.renderingRule=a?g.toJson(a.toJson()):null;this._useRenderingRuleAttributeTable&&
this.getRenderingRuleAttributeTable({renderingRule:a});k&&this.onRenderingChange();this._setDefaultFilter();e||this.refresh(!0)},setImageFormat:function(a,e){this.format=this._params.format=a;this._setDefaultFilter();e||this.refresh(!0)},setInfoTemplate:function(a){this.infoTemplate=a;this._updateInfoTemplateFields(this.fields)},setDefinitionExpression:function(a,e){var k=this.mosaicRule?this.mosaicRule.toJson():{};this.mosaicRule||(this.defaultMosaicRule?k=this.defaultMosaicRule.toJson():k.method=
P.METHOD_NONE);k.where=a;a=new P(k);return this.setMosaicRule(a,e),this},getDefinitionExpression:function(){return this.mosaicRule?this.mosaicRule.where:null},setPixelFilter:function(a){this.pixelFilter=a;this._isDefaultPixelFilter=!1},getPixelData:function(a){return a?(this._useBrowserDecoding()&&(this.originalPixelData={pixelBlock:this._getPixelBlockFromCanvas(this._context,this._map.width,this._map.height),extent:this._map.extent}),this.originalPixelData):this.pixelData},getExportImageRenderingRule:function(){var a;
return this._hasItemLevelRFT&&this.renderingRule&&(a=this._getServiceLevelRenderingRule(this.renderingRule)),a=a||this.renderingRule,this._combineRenderingRule(this._convertRendererToRenderingRule(this.renderer),a)},getExportImageMosaicRule:function(){var a,e=this.mosaicRule;return this._hasItemLevelRFT&&this.renderingRule&&(a=this._getItemLevelRenderingRule(this.renderingRule)),a?(e=e||this.defaultMosaicRule||new P,e.itemRenderingRule=a,e):e},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},
getHistograms:function(){var a=new y(u._dfdCanceller);if(this.hasHistograms)a._pendingDfd=p({url:this._url.path+"/histograms",content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),a._pendingDfd.then(function(e){a.callback(e)},function(e){a.errback(e)});else{var e=Error("Layer does not have histograms.");e.log=!!w.isDebug;a.errback(e)}return a},computeHistograms:function(a){var e=new y(u._dfdCanceller);if(10.1<=this.currentVersion){a=a||{};var k=a.geometry||this.fullExtent,g=(a.geometry||
this.fullExtent).toJson(),k="extent"===k.type?"esriGeometryEnvelope":"esriGeometryPolygon",f=a.renderingRule||this.renderingRule||this.defaultRenderingRule,f=f?f.toJson():null,n=a.mosaicRule||this.mosaicRule||this.defaultMosaicRule,n=n?n.toJson():null;a=a.pixelSize||{x:this.pixelSizeX,y:this.pixelSizeY};e._pendingDfd=p({url:this._url.path+"/computeHistograms",content:m.mixin({f:"json",geometry:JSON.stringify(g),geometryType:k,renderingRule:JSON.stringify(f),mosaicRule:JSON.stringify(n),pixelSize:JSON.stringify(a),
callbackParamName:"callback"}),handleAs:"json"});e._pendingDfd.then(function(a){e.callback(a)},function(a){e.errback(a)})}else g=Error("Layer doesn't support computeHistograms."),g.log=!!w.isDebug,e.errback(g);return e},getRenderingRuleServiceInfo:function(a){var e=new u._fixDfd(new y(u._dfdCanceller));if(!a)return e.errback(Error("Rendering rule is not specified")),e;var k=this._getRenderingRuleId(a);return k&&this._rasterFunctionTemplateInfos[k]?(e.resolve(this._rasterFunctionTemplateInfos[k]),
e):p({url:this._url.path,content:m.mixin(m.mixin({f:"json",renderingRule:JSON.stringify(a.toJson())},this._url.query)),callbackParamName:"callback",load:m.hitch(this,function(a){var f={};return x.forEach(this._rasterFunctionServiceInfoProps,function(e){f[e]=a[e]}),this._rasterFunctionTemplateInfos[k]=f,f}),error:this._errorHandler})},queryVisibleRasters:function(a,e,k,g){var f,p=this._map,n=u._fixDfd(new y(u._dfdCanceller));this._visibleRasters=[];var c,b,d=!0,h=!0,l=null,q=this.infoTemplate?this.infoTemplate.info:
null,r=q?m.clone(this.infoTemplate.info.fieldInfos):null;if(e=e||{},q&&this.infoTemplate.info.mediaInfos&&this.infoTemplate.info.mediaInfos.length){var z=[];x.forEach(this.infoTemplate.info.mediaInfos,function(b){z=z.concat(b&&b.value&&b.value.fields||[])});z.length&&x.forEach(r,function(b){b&&-1<z.indexOf(b.fieldName)&&(b.visible=!0)})}if(r&&0<r.length)for(d=!1,c=0;c<r.length;c++)if((b=r[c])&&b.fieldName.toLowerCase()!==this._rasterFieldPrefix.toLowerCase()+"servicepixelvalue"&&(b.visible||q.title&&
-1<q.title.toLowerCase().indexOf(b.fieldName.toLowerCase()))){d=!0;break}this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.layerOptions&&this.infoTemplate.info.layerOptions.hasOwnProperty("returnTopmostRaster")&&(l=this.infoTemplate.info.layerOptions.returnTopmostRaster?1:null);r&&0<r.length&&(h=!1,x.some(r,function(b){if(b&&b.fieldName.toLowerCase()===this._rasterFieldPrefix.toLowerCase()+"itempixelvalue"&&b.visible)return h=!0,!0},this));var t=(b=this._removeVisualizationStretchFunction(this.renderingRule))&&
b.functionName,w=[];if(10.4<=this.version){var A=!1;if(this.rasterFunctionInfos&&r){var C=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;x.forEach(this.rasterFunctionInfos,function(b){var c=C+b.name.replace(/ /gi,"_");x.some(r,function(b){return b.visible&&b.fieldName===c})&&(A=A||t&&t===b.name,w.push(new K({rasterFunction:b.name})))})}b&&!A&&w.push(b)}c=new X;if(c.geometry=a.geometry,c.returnGeometry=this._map.spatialReference.equals(this.spatialReference),c.returnCatalogItems=d,c.timeExtent=
a.timeExtent,c.returnPixelValues=h,c.maxItemCount=l||a.maxItemCount,this._params.time&&this.mosaicRule?(f=m.clone(this.mosaicRule),f=this._filterOutTimeDimension(f),c.mosaicRule=f):c.mosaicRule=this.mosaicRule||null,c.renderingRule=10.4>this.version&&b||null,c.renderingRules=w||null,10.61>this.version&&(c.returnPixelValues=void 0,c.maxItemCount=void 0),p)a=new I((p.extent.xmax-p.extent.xmin)/p.width,(p.extent.ymax-p.extent.ymin)/p.height,p.extent.spatialReference),c.pixelSize=a;e.requestParams=c;
var J=this;a=new U(this.url);return(n._pendingDfd=a.execute(c)).addCallbacks(function(b){J._queryVisibleRastersHandler(b,e,k,g,n)},function(b){J._resolve([b],null,g,n,!0)}),n},_queryVisibleRastersHandler:function(a,k,n,r,f){function u(){var b,a,d,g,p,q,r,u,t,w,A,v=this.getCustomRasterFields(k),C=this._getDomainFields(v),B=!!k&&k.returnDomainValues,I=k&&k.rasterAttributeTableFieldPrefix,v=(v=this._getRenderingRuleId(this.renderingRule))&&this._rasterFunctionTemplateInfos[v];this.renderingRule&&(this._useRenderingRuleAttributeTable||
v)?(w=this._getRenderingRuleAttributeTableFeatures({renderingRule:this.renderingRule}),A=h):w=this._getRasterAttributeTableFeatures();w.then(m.hitch(this,function(k){for(b=0;b<c.length;b++){if(K=c[b],K.setInfoTemplate(this.infoTemplate),K._layer=this,h){if(t=h.replace(/ /gi,"").split(","),a=h,d=t,z&&z.length>=b&&(a=z[b].replace(/ /gi,", "),d=z[b].split(" ")),K.attributes[this._rasterFieldPrefix+"ItemPixelValue"]=d,K.attributes[this._rasterFieldPrefix+"ServicePixelValue"]=t,l&&(K.attributes[this._rasterFieldPrefix+
"ServicePixelValue.Raw"]=l.replace(/ /gi,"").split(",")),this.pixelFilter){var w=new J({height:1,width:1,pixelType:"F32",pixels:[],statistics:[]});x.forEach(d,function(b){w.addData({pixels:[b],statistics:{minValue:b,maxValue:b,noDataValue:null}})});this.pixelFilter({pixelBlock:w,extent:new M(0,0,0,0,this._map.spatialReference)});"esriImageServiceDataTypeVector-UV"!==this.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.serviceDataType||(K.attributes[this._rasterFieldPrefix+"Magnitude"]=
w.pixels[0][0],K.attributes[this._rasterFieldPrefix+"Direction"]=w.pixels[1][0])}x.forEach(y,function(b){K.attributes[b.name]=b.value});var v=A||a;if(k&&0<k.length&&(g=x.filter(k,function(b){if(b&&b.attributes)return b.attributes.hasOwnProperty("Value")?b.attributes.Value==v:b.attributes.VALUE==v}),0<g.length&&(p=m.clone(g[0]),I&&p))){u={};for(q in p.attributes)p.attributes.hasOwnProperty(q)&&(r=I+q,u[r]=p.attributes[q]);p.attributes=u;K.attributes=m.mixin(K.attributes,p.attributes)}}B&&C&&0<C.length&&
x.forEach(C,function(b){if(b){var c=K.attributes[b.name];e.isDefined(c)&&(c=this._getDomainValue(b.domain,c),e.isDefined(c)&&(K.attributes[b.name]=c))}},this);N.push(K);this._visibleRasters.push(K)}this._resolve([N,null,!0],null,n,f)}))}var z,c,b,d,h=a.value,l=a.value,q=0,t=0,w=this,A=this.objectIdField,y=[];r=k.requestParams.renderingRules;var C=a.processedValues,B=this.renderingRule&&g.toJson(this._removeVisualizationStretchFunction(this.renderingRule).toJson());if(r&&C&&r.length===C.length){var I=
this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;x.forEach(r,function(b,c){if(b.functionName){var a={name:I+b.functionName.replace(/ /gi,"_"),value:C[c].replace(/ /gi,"").split(",")};y.push(a);B&&B===g.toJson(b.toJson())&&(h=C[c])}})}if(r=!(this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.layerOptions&&this.infoTemplate.info.layerOptions.hasOwnProperty("showNoDataRecords"))||this.infoTemplate.info.layerOptions.showNoDataRecords,a.catalogItems){var O,U,R=0,T=a.catalogItems.features.length;
d=0;if(c=Array(T),z=Array(T),b=Array(T),a.properties&&a.properties.Values){T=a.properties.Values.length;for(q=0;q<T;q++)-1<a.properties.Values[q].toLowerCase().indexOf("nodata")&&d++;O=T-d;for(q=0;q<T;q++)d=!0,-1<a.properties.Values[q].toLowerCase().indexOf("nodata")?(U=O++,r||(d=!1,c.length--,z.length--,b.length--)):U=R++,d&&(c[U]=a.catalogItems.features[q],z[U]=a.properties.Values[q],b[U]=c[U].attributes[A])}else{for(q=0;q<T;q++)c[q]=a.catalogItems.features[q],b[q]=c[q].attributes[A];z=null}}this._visibleRasters=
[];var K;a=-1<h.toLowerCase().indexOf("nodata");(a&&!r&&(c=[],z=[],b=[]),!h||c||a)||(A="ObjectId",c=[],K=new S(new M(this.fullExtent),null,{ObjectId:0}),c.push(K));var N=[];if(!c)return void this._resolve([N,null,null],null,n,f);!this._map.spatialReference.equals(this.spatialReference)&&b&&0<b.length?p({url:this._url.path+"/query",content:{f:"json",objectIds:b.join(","),returnGeometry:!0,outSR:g.toJson(w._map.spatialReference.toJson()),outFields:A},handleAs:"json",callbackParamName:"callback",load:function(b){if(0===
b.features.length)return void w._resolve([N,null,null],null,n,f);for(q=0;q<b.features.length;q++)for(t=0;t<c.length;t++)c[t].attributes[A]==b.features[q].attributes[A]&&(c[t].geometry=new L(b.features[q].geometry),c[t].geometry.setSpatialReference(w._map.spatialReference));u.call(w)},error:function(b){w._resolve([N,null,null],null,n,f)}}):u.call(this)},getVisibleRasters:function(){var a,e=this._visibleRasters,k=[];for(a in e)e.hasOwnProperty(a)&&k.push(e[a]);return k},_getDomainFields:function(a){if(a){var e=
[];return x.forEach(a,function(a){if(a.domain){var k={};k.name=a.name;k.domain=a.domain;e.push(k)}}),e}},_getDomainValue:function(a,e){if(a&&a.codedValues){var k;return x.some(a.codedValues,function(a){return a.code===e&&(k=a.name,!0)}),k}},_requestData:function(a,e,k){this._rasterReadPromise&&this._rasterReadPromise.cancel();a=m.clone(a);var g=a._normalize(!0);this._prepareGetImageParameters(g,e,k);e=m.clone(this._params);this._cleanupRequestParams(e);e.extent=a;e.format=e.format||(10.3<=this.version?
"lerc":"jpgpng");"lerc"===e.format.toLowerCase()&&!e.lercVersion&&10.5<=this.version&&(e.lercVersion=2);k=null;this._useBrowserDecoding()&&(k=new R({ctx:this._context}));e={imageServiceParameters:e,nBands:Math.min(this.bandCount,3),pixelType:this.pixelType,decodeFunc:k?m.hitch(k,"decode"):null};this._rasterReadPromise=this.raster.read(e,this._requestDataHandler,this._requestDataErrorHandler)},_requestDataHandler:function(a){this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this.originalPixelData=
a,this.hasDataChanged=!0,this._setPixelData(a))},_setPixelData:function(a){a=this._clonePixelData(a);this.pixelFilter&&this.pixelFilter(a);this.pixelData=a;this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this._drawPixelData(),this._rasterReadPromise=null)},_clonePixelData:function(a){if(null===a||void 0===a)return a;var e={};a.extent&&(e.extent=m.clone(a.extent));a=a.pixelBlock;return null===a||void 0===a?e:(e.pixelBlock=a.clone(),e)},_setDefaultFilter:function(){},_getPixelBlockFromCanvas:function(a,
e,k){for(var g,f,p=a.getImageData(0,0,e,k).data,n=e*k,c=0,b=0,d=new Uint8Array(n),h=new Uint8Array(n),l=new Uint8Array(n),q=new Uint8Array(n),r=1/0,u=1/0,m=1/0,z=-1/0,t=-1/0,w=-1/0,c=0;c<n;c++)a=p[b++],g=p[b++],f=p[b++],r=r<a?r:a,z=z>a?z:a,u=u<g?u:g,t=t>g?t:g,m=m<f?m:f,w=w>f?w:f,d[c]=a,h[c]=g,l[c]=f,q[c]=1&p[b++];return new J({width:e,height:k,pixels:[d,h,l],pixelType:"U8",mask:q,statistics:[{minValue:r,maxValue:z},{minValue:u,maxValue:t},{minValue:m,maxValue:w}]})},_useBrowserDecoding:function(){return(void 0===
this.pixelFilter||null===this.pixelFilter)&&("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))},getMultidimensionalInfo:function(){var a=this._url.path+"/multiDimensionalInfo",e=new y(u._dfdCanceller);if(this._multidimensionalInfo)return e.resolve(this._multidimensionalInfo),e;10.3<=this.version&&this.hasMultidimensions?(e._pendingDfd=p({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),e._pendingDfd.then(m.hitch(this,
function(a){this._multidimensionalInfo=a.multidimensionalInfo;e.callback(a.multidimensionalInfo)}),function(a){e.errback(a)})):(a=Error("Layer does not support multidimensional info"),a.log=!!w.isDebug,e.errback(a));return e},getDefaultMultidimensionalDefinition:function(){var a,e,k,g,f=[],p=new y(u._dfdCanceller);return this._defaultMultidimensionalDefinition?(p.resolve(m.clone(this._defaultMultidimensionalDefinition)),p):(p._pendingDfd=this.getMultidimensionalInfo(),p._pendingDfd.then(m.hitch(this,
function(n){a=n;e=a.variables[0].dimensions;for(k in e)e.hasOwnProperty(k)&&"StdTime"!==e[k].name&&(g=e[k],f.push(new N({variableName:"",dimensionName:g.name,isSlice:!g.hasRanges,values:[this._getDefaultDimensionValue(g)]})));this._defaultMultidimensionalDefinition=f;p.callback(m.clone(f))}),function(a){p.errback(a)}),p)},_getDefaultDimensionValue:function(a){if(a&&a.values&&a.values.length){var e,k,g,f,p=1/0;if(a.hasRanges)return a.values[0];if(a.name&&"stdz"===a.name.toLowerCase()){for(f=0;f<a.values.length&&
(g=a.values[f],k=Math.abs(g-0),k<p&&(p=k,e=g),0!==k);f++);return e}return a.extent[0]}},_setDefaultMultidimensionalDefinition:function(a){var e,k={};this.getDefaultMultidimensionalDefinition().then(m.hitch(this,function(g){e=g;0<e.length&&(this.mosaicRule?(k=m.clone(this.mosaicRule),k.multidimensionalDefinition=e):this.defaultMosaicRule?(k=m.clone(this.defaultMosaicRule),k.multidimensionalDefinition=e):k=new P({multidimensionalDefinition:e}),this.setMosaicRule(k,a))}))},_setDefaultRenderingRule:function(a){var e=
{},k=this.renderingRule;if(!k&&"esri.layers.ArcGISImageServiceVectorLayer"!==this.declaredClass&&!this.bandIds&&this.rasterFunctionInfos&&this.rasterFunctionInfos.length&&"none"!==this.rasterFunctionInfos[0].name.toLowerCase())e.rasterFunction=this.rasterFunctionInfos[0].name;else if("esri.layers.ArcGISImageServiceVectorLayer"===this.declaredClass&&10.3<this.version&&(!k||"Resample"!==k.functionName)){var g="esriImageServiceDataTypeVector-UV"===this.serviceDataType?7:10;e.rasterFunction="Resample";
e.rasterFunctionArguments={ResamplingType:g,InputCellSize:{x:this.pixelSizeX,y:this.pixelSizeY}};k&&(e.rasterFunctionArguments.Raster=k.toJson())}e.hasOwnProperty("rasterFunction")&&(this.defaultRenderingRule=new K(e),this.setRenderingRule(this.defaultRenderingRule,a))},_cleanupRequestParams:function(a){if(!a)return a;if(a.time&&a.mosaicRule){var e=new P(g.fromJson(a.mosaicRule)),e=this._filterOutTimeDimension(e);a.mosaicRule=g.toJson(e.toJson())}var k,e="displayOnPan drawMode styling id opacity visible resourceInfo useMapDimensionValue extent renderer".split(" ");
for(k in e)a.hasOwnProperty(e[k])&&delete a[e[k]];return a},_filterOutTimeDimension:function(a){if(a&&a.multidimensionalDefinition&&0<a.multidimensionalDefinition.length){var e=x.filter(a.multidimensionalDefinition,function(a){return"StdTime"!==a.dimensionName});a.multidimensionalDefinition=e}return a},_removeVisualizationStretchFunction:function(a){var e=a&&a.functionName;if(!e||"stretch"!==e.toLowerCase())return a;var k=a.functionArguments.Raster;return k&&k.functionName&&x.some(this.rasterFunctionInfos,
function(a){return k.functionName===a.name})?k:a},_isScientificData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType||"esriImageServiceDataTypeScientific"===this.serviceDataType},_isVectorData:function(a){a=(a=a||this)&&a.serviceDataType;return"esriImageServiceDataTypeVector-UV"===a||"esriImageServiceDataTypeVector-MagDir"===a},_isRenderingRuleAProcessingTemplate:function(a){var e=a&&a.functionName;return!(!e||
a.functionArguments)&&x.some(e&&(this.rasterFunctionInfos||[]),function(a){return a&&a.name&&a.name.toLowerCase()===e.toLowerCase()})},_getRenderingRuleId:function(a){var e=a&&a.functionName;if(e){if(this._isRenderingRuleAProcessingTemplate(a))return e;var k=this._customRenderingRuleId[e];if(k){if(k!==a){for(var g in this._customRenderingRuleId)if(this._customRenderingRuleId[g]===a)return g;for(k=0;this._customRenderingRuleId[f];)k+=1;var f;this._customRenderingRuleId[e+k]=a}}else this._customRenderingRuleId[e]=
a;return e}},_createPixelData:function(a){a=new J({width:2,height:2,pixels:a,pixelType:this.pixelType,statistics:a});var e=this.fullExtent.getCenter();return{pixelBlock:a,extent:new M(e.x,e.y,e.x+this.pixelSizeX,e.y+this.pixelSizeY,this.spatialReference)}},_convertRendererToRenderingRule:function(a){var e=a&&a.declaredClass;if(!e||"esri.renderer.UniqueValueRenderer"!==e&&"esri.renderer.ClassBreaksRenderer"!==e&&"esri.renderer.StretchRenderer"!==e)return null;var k=null;return"esri.renderer.StretchRenderer"===
e?k=a.toRenderingRule({convertToColormap:10.6>this.version}):"esri.renderer.ClassBreaksRenderer"===e?k=this._convertClassifyRenderer(a):"esri.renderer.UniqueValueRenderer"===e&&(k=this._convertUniqueValueRenderer(a)),k},_getValueField:function(a){if(a&&a.length){var e,k;return x.some(a,function(a){if((k=a.name)&&"value"===k.toLowerCase())return e=k,!0}),e}},_convertClassifyRenderer:function(a){var e,k,g,f,p,n,c=[],b=[],d=[],h=[],l=this.renderingRule&&this._getRenderingRuleId(this.renderingRule),q=
this.hasRasterAttributeTable;(l&&(q=this._rasterFunctionTemplateInfos[l]?this._rasterFunctionTemplateInfos[l].hasRasterAttributeTable:this.hasRasterAttributeTable,e=this._renderingRuleAttributeTable[l],n=this._rasterFunctionTemplateInfos[l]),g=e&&e.features?e.features:this._rasterAttributeTableFeatures,f=e&&e.fields?e.fields:this._rasterAttributeTableFields,p=this._getValueField(f),q&&g)?(x.forEach(a.infos,function(b,c){var d,f=b.symbol.color;f.a&&x.forEach(g,function(e){((d=e.attributes[a.attributeField])>=
b.minValue&&d<b.maxValue||c===a.infos.length-1&&d>=b.minValue)&&h.push([e.attributes[p],f.r,f.g,f.b])},this)},this),e=n&&n.pixelType||this.pixelType,this._adjustColormapToPixelTypeRange(h,e),e=new K,e.functionName="Colormap",e.functionArguments={},e.functionArguments.Colormap=h,e.variableName="Raster"):(x.forEach(a.infos,function(a,f){k=a.symbol&&a.symbol.color;k.a?(0===f?c.push.call(c,a.minValue,a.maxValue+1E-6):c.push.call(c,a.minValue+1E-6,a.maxValue+1E-6),b.push(f),h.push([f,k.r,k.g,k.b])):d.push(a.minValue,
a.maxValue)}),e=n&&n.pixelType||this.pixelType,this._adjustColormapToPixelTypeRange(h,e),e=new K,e.functionName="Remap",e.functionArguments={InputRanges:c,OutputValues:b,NoDataRanges:d},e.variableName="Raster",f=new K,f.functionName="Colormap",f.functionArguments={Colormap:h,Raster:e},e=f);return e},_convertUniqueValueRenderer:function(a){var e,k,g,f,p=[],n=this.renderingRule&&this._getRenderingRuleId(this.renderingRule);n&&(this._rasterFunctionTemplateInfos[n]?this._rasterFunctionTemplateInfos[n].hasRasterAttributeTable:
this.hasRasterAttributeTable,k=this._renderingRuleAttributeTable[n],f=this._rasterFunctionTemplateInfos[n]);e=k&&k.features?k.features:this._rasterAttributeTableFeatures;g=this._getValueField(k&&k.fields?k.fields:this._rasterAttributeTableFields);x.forEach(a.infos,function(c){var b=c.symbol.color;b.a&&(a.attributeField!==g&&e?x.forEach(e,function(d){d.attributes[a.attributeField]==c.value&&p.push([d.attributes[g],b.r,b.g,b.b])},this):p.push([c.value,b.r,b.g,b.b]))},this);this._adjustColormapToPixelTypeRange(p,
f&&f.pixelType||this.pixelType);k=new K;return k.functionName="Colormap",k.functionArguments={},k.functionArguments.Colormap=p,k.variableName="Raster",k},_adjustColormapToPixelTypeRange:function(a,e){e=this._pixelTypeRanges[e];return e&&a.push([Math.floor(e[0]-1),0,0,0],[Math.ceil(e[1]+1),0,0,0]),a},_combineRenderingRule:function(a,e){if(!a||!e)return a||e;var k=function(a){var f=a.Raster;return f=f&&"esri.layers.RasterFunction"===f.declaredClass?k(f.functionArguments):a};a=m.clone(a);"none"!==e.functionName.toLocaleLowerCase()&&
(k(a.functionArguments).Raster=e);return a},_isItemLevelRasterFunction:function(a){var e=a&&a.functionName;if(!e||!this._hasItemLevelRFT)return!1;var k=!1;return x.some(this.rasterFunctionInfos,function(a){if(a&&a.name===e)return 1!==a.functionType&&2!==a.functionType||(k=!0),!0}),k},_getServiceLevelRenderingRule:function(a){if(!this._hasItemLevelRFT||!a)return a;var e;a=new K(a.toJson());var k;for(k=a.functionArguments;;){if(!((e=k&&k.Raster)&&e.functionArguments&&e.functionArguments.Raster)){this._isItemLevelRasterFunction(e)&&
delete k.Raster;break}k=e;k=k.functionArguments}return a},_getItemLevelRenderingRule:function(a){if(!this._hasItemLevelRFT||!a)return null;var e;a=new K(a.toJson());for(a=a.functionArguments;;){if(!((e=a&&a.Raster)&&e.functionArguments&&e.functionArguments.Raster)){if(this._isItemLevelRasterFunction(e))return e;break}a=e;a=a.functionArguments}},_resolve:function(a,e,k,g,f){e&&this[e].apply(this,a);k&&k.apply(null,a);g&&u._resDfd(g,a,f)},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&
a&&!this.suspended?(this._timeConnect||(this._timeConnect=t.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(t.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},setUseMapTime:function(a,e){this.useMapTime=a;this._toggleTime();!e&&this._map&&this.refresh(!0)},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):null)},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},
handleSpatialReferenceChange:function(){this.onSpatialReferenceChange()}});return r("extend-esri")&&m.setObject("layers.ImageServiceLayerMixin",B,a),B})},"esri/layers/MosaicRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../geometry/Point ./RasterFunction".split(" "),function(B,m,y,x,g,w,t){var r=B(null,{declaredClass:"esri.layers.MosaicRule",method:null,where:null,sortField:null,sortValue:null,ascending:!1,lockRasterIds:null,viewpoint:null,objectIds:null,operation:null,
multidimensionalDefinition:[],itemRenderingRule:null,constructor:function(g){m.isObject(g)&&(m.mixin(this,g),g.mosaicMethod&&(this.method=g.mosaicMethod),this.method&&"esri"!==this.method.toLowerCase().substring(0,4)&&(this.method=this._getMethodEnum(this.method)),g.mosaicOperation&&(this.operation=g.mosaicOperation),this.operation&&"MT_"!==this.operation.toUpperCase().substring(0,3)&&(this.operation=this._getOperatorEnum(this.operation)),g.fids&&(this.objectIds=g.fids),g.viewpoint&&(this.viewpoint=
new w(g.viewpoint)),g.itemRenderingRule&&(this.itemRenderingRule=new t(g.itemRenderingRule)),this.multidimensionalDefinition=g.multidimensionalDefinition||[])},toJson:function(){var n=null,r=this.multidimensionalDefinition?this.multidimensionalDefinition.length:0;if(r)for(var n=[],a=0;a<r;a++)n.push("esri.layers.DimensionalDefinition"===this.multidimensionalDefinition[a].declaredClass?this.multidimensionalDefinition[a].toJson():this.multidimensionalDefinition[a]);n={mosaicMethod:this.method,where:this.where,
sortField:this.sortField,sortValue:this.sortValue,ascending:this.ascending,lockRasterIds:m.clone(this.lockRasterIds),viewpoint:this.viewpoint?this.viewpoint.toJson():null,fids:m.clone(this.objectIds),mosaicOperation:this.operation,multidimensionalDefinition:n,itemRenderingRule:this.itemRenderingRule?this.itemRenderingRule.toJson():null};return g.filter(n,function(a){if(null!==a)return!0})},_getMethodEnum:function(g){if(g){var n=r.METHOD_NONE;switch(g.toLowerCase()){case "byattribute":n=r.METHOD_ATTRIBUTE;
break;case "center":n=r.METHOD_CENTER;break;case "lockraster":n=r.METHOD_LOCKRASTER;break;case "nadir":n=r.METHOD_NADIR;break;case "northwest":n=r.METHOD_NORTHWEST;break;case "seamline":n=r.METHOD_SEAMLINE;break;case "viewpoint":n=r.METHOD_VIEWPOINT}return n}},_getOperatorEnum:function(g){if(g)switch(g.toLowerCase()){case "first":return r.OPERATION_FIRST;case "last":return r.OPERATION_LAST;case "max":return r.OPERATION_MAX;case "min":return r.OPERATION_MIN;case "blend":return r.OPERATION_BLEND;case "mean":return r.OPERATION_MEAN;
case "sum":return r.OPERATION_SUM}}});return m.mixin(r,{METHOD_NONE:"esriMosaicNone",METHOD_CENTER:"esriMosaicCenter",METHOD_NADIR:"esriMosaicNadir",METHOD_VIEWPOINT:"esriMosaicViewpoint",METHOD_ATTRIBUTE:"esriMosaicAttribute",METHOD_LOCKRASTER:"esriMosaicLockRaster",METHOD_NORTHWEST:"esriMosaicNorthwest",METHOD_SEAMLINE:"esriMosaicSeamline",OPERATION_FIRST:"MT_FIRST",OPERATION_LAST:"MT_LAST",OPERATION_MIN:"MT_MIN",OPERATION_MAX:"MT_MAX",OPERATION_MEAN:"MT_MEAN",OPERATION_BLEND:"MT_BLEND",OPERATION_SUM:"MT_SUM"}),
y("extend-esri")&&m.setObject("layers.MosaicRule",r,x),r})},"esri/layers/DimensionalDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(B,m,y,x,g){B=B(null,{declaredClass:"esri.layers.DimensionalDefinition",variableName:null,dimensionName:null,values:[],isSlice:!1,constructor:function(g){m.isObject(g)&&m.mixin(this,g)},toJson:function(){var w={variableName:this.variableName,dimensionName:this.dimensionName,values:m.clone(this.values),isSlice:this.isSlice};
return g.filter(w,function(g){return null!==g})}});return y("extend-esri")&&m.setObject("layers.DimensionalDefinition",B,x),B})},"esri/layers/Raster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/json dojo/sniff ../kernel ../Evented ../request ../geometry/Extent ../SpatialReference ../deferredUtils ./PixelBlock ./rasterFormats/LercCodec ./rasterFormats/Lerc2Codec".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M){var I,
L,P,K,N,C;m=m(A,{declaredClass:"esri.layers.Raster",imageServiceUrl:null,validPixelTypes:"U1 U2 U4 U8 U16 U32 S8 S16 S32 F32".split(" "),validFormats:"lerc jpeg jpg jpgpng png png8 png24 png32 bip bsq tiff".split(" "),_eventMap:{"raster-read-complete":["pixelData","params"]},constructor:function(a){this.imageServiceUrl=a;this.registerConnectEvents();this._loadRasterFormatModules()},read:function(e,k,n){var u=this,m=new x(p._dfdCanceller);if(10>r("ie"))throw"This browser is not supported.";if(!e.imageServiceParameters)throw"Insufficient parameters to read data";
var z=y.clone(e.imageServiceParameters),t=e.pixelType;g.some(this.validPixelTypes,function(b){return b===t})||(z.pixelType="F32");g.some(this.validFormats,function(b){return b.toLowerCase()===z.format.toLowerCase()})||(z.format="lerc");var w,f=e.decodeFunc;this._prepareGetImageParameters(z);var A=z.width,C=z.height,c=z.extent;return delete z.width,delete z.height,delete z.extent,m._pendingDfd=a({url:this.imageServiceUrl+"/exportImage",handleAs:"arraybuffer",content:y.mixin(z,{f:"image"}),load:function(b){u.decode(b,
{width:A,height:C,planes:null,pixelType:t,noDataValue:z.noData,format:z.format,decodeFunc:f}).then(function(b){w={pixelBlock:b,extent:c};u._resolve([w,z],"onRasterReadComplete",k,m)},function(b){u._resolve([b],null,n,m,!0)})},error:function(b){u._resolve([b],null,n,m,!0)}}),m.promise},decode:function(a,e){if(void 0===e||null===e)throw"missing decode options";var k,g;return e.format&&(k=e.format.toUpperCase()),"BSQ"!==k&&"BIP"!==k&&(k=this._getFormat(a)),g=e.decodeFunc,void 0!==g&&null!==g||(g=this._getFormatDecoderDfd(k)),
g(a,e)},onRasterReadComplete:function(){},_prepareGetImageParameters:function(a){if(a.size&&a.bbox){var g=a.size.split(",");(a.width=parseFloat(g[0]),a.height=parseFloat(g[1]),a.extent)||(g=a.bbox.split(","),a.extent=new k(parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]),new e(a.bboxSR)))}else{if(!a.width||Math.floor(a.width)!==a.width||!a.height||Math.floor(a.height)!==a.height)throw"Incorrect Image Dimensions";if(!a.extent||"esri.geometry.Extent"!==a.extent.declaredClass)throw"Incorrect extent";
var g=a.extent,p=g.spatialReference.wkid||t.toJson(g.spatialReference.toJson());delete a._ts;y.mixin(a,{bbox:g.xmin+","+g.ymin+","+g.xmax+","+g.ymax,imageSR:p,bboxSR:p,size:a.width+","+a.height},a.disableClientCaching?{_ts:(new Date).getTime()}:{})}},_adjustExtent:function(a,e,k){var g=a.ymax-a.ymin,p=a.xmax-a.xmin;return k>=e?(g=p*e/k,a.ymax=a.ymin+g):(p=g*k/e,a.xmax=a.xmin+p),a},_resolve:function(a,e,k,g,n){e&&this[e].apply(this,a);k&&k.apply(null,a);g&&p._resDfd(g,a,n)},_getFormatDecoderDfd:function(a){var e=
null;switch(a){case "LERC":e=this._decodeLerc;break;case "LERC2":e=this._decodeLerc2;break;case "JPEG":e=this._decodeJpeg;break;case "PNG":e=this._decodePng;break;case "BSQ":e=this._decodeBsq;break;case "BIP":e=this._decodeBip;break;case "TIFF":e=this._decodeTiff;break;default:e=function(a,e){throw"The raster format is not supported";}}return e=y.hitch(this,e),function(k,g){var p=new x;try{var n;"LERC"===a||!0===N?(n=e(k,g),p.resolve(n)):C.then(function(){n=e(k,g);p.resolve(n)})}catch(Y){p.reject(Y)}return p}},
_getFormat:function(a){a=new Uint8Array(a,0,10);var e="";return 255===a[0]&&216===a[1]?e="JPEG":137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]?e="PNG":67===a[0]&&110===a[1]&&116===a[2]&&90===a[3]&&73===a[4]&&109===a[5]&&97===a[6]&&103===a[7]&&101===a[8]&&32===a[9]?e="LERC":76===a[0]&&101===a[1]&&114===a[2]&&99===a[3]&&50===a[4]&&32===a[5]?e="LERC2":-1<String.fromCharCode.apply(null,a).toLowerCase().indexOf("error")?e="ERROR":(73===a[0]&&73===a[1]&&42===a[2]&&0===a[3]||77===a[0]&&77===a[1]&&0===a[2]&&
42===a[3])&&(e="TIFF"),e},_validateDecodeParams:function(a){if(!a.height||Math.floor(a.height)!==a.height)throw"Height not provided.";if(!a.width||Math.floor(a.width)!==a.width)throw"Width not provided.";},_decodeJpeg:function(a,e){if(!I)throw"The jpeg decoder module is not loaded.";this._validateDecodeParams(e);a=(new I).decode(a);if(!Q(a,e))throw"The decoded image dimensions are incorrect.";var k,g=[];for(e=0;e<a.pixels.length;e++)k=a.pixels[e],g.push(this._calculateBandStatistics(k));return new u({width:a.width,
height:a.height,pixels:a.pixels,pixelType:"U8",mask:a.mask,statistics:g})},_decodePng:function(a,e){if(!L)throw"The png decoder module is not loaded.";this._validateDecodeParams(e);a=new Uint8Array(a);var k=new L(a);a=new Uint8Array(e.width*e.height*4);k.copyToImageData(a,k.decodePixels());var g,p=k=0;g=new Uint8Array(e.width*e.height);for(k=0;k<e.width*e.height;k++)g[k]=a[4*k+3];for(var n=new u({width:e.width,height:e.height,pixels:[],pixelType:"U8",mask:g,statistics:[]}),k=0;3>k;k++){g=new Uint8Array(e.width*
e.height);for(p=0;p<e.width*e.height;p++)g[p]=a[4*p+k];n.addData({pixels:g,statistics:this._calculateBandStatistics(g)})}return n},_decodeBsq:function(a,e){if(!P)throw"The bsq decoder module is not loaded.";this._validateDecodeParams(e);O=e.noDataValue;e.pixelType=R(e.pixelType);var k=P.decodeBSQ(a,{bandCount:e.planes,width:e.width,height:e.height,pixelType:J,noDataValue:O}),g=[],p=null;for(a=0;a<k.pixels.length;a++)p=k.pixels[a],g.push(this._calculateBandStatistics(p));return new u({width:e.width,
height:e.height,pixels:k.pixels,pixelType:e.pixelType,mask:k.maskData,statistics:g})},_decodeBip:function(a,e){this._validateDecodeParams(e);O=e.noDataValue;e.pixelType=R(e.pixelType);var k=P.decodeBIP(a,{bandCount:e.planes,width:e.width,height:e.height,pixelType:J,noDataValue:O}),g=[],p=null;for(a=0;a<k.pixels.length;a++)p=k.pixels[a],g.push(this._calculateBandStatistics(p));return new u({width:e.width,height:e.height,pixels:k.pixels,pixelType:e.pixelType,mask:k.maskData,statistics:g})},_decodeTiff:function(a,
e){this._validateDecodeParams(e);O=e.noDataValue;e.pixelType=R(e.pixelType);e=K.decode(a);var k=[],g=null;for(a=0;a<e.pixels.length;a++)g=e.pixels[a],k.push(this._calculateBandStatistics(g,e.maskData));return new u({width:e.width,height:e.height,pixels:e.pixels,pixelType:e.pixelType,mask:e.maskData,statistics:k})},_decodeLerc:function(a,e){this._validateDecodeParams(e);O=e.noDataValue;e.pixelType=R(e.pixelType);for(var k,g,p=0,n=0,r=a.byteLength-10;n<r;){var m=z.decode(a,{inputOffset:n,encodedMaskData:k,
returnMask:0===p,returnEncodedMask:0===p,returnFileInfo:!0,pixelType:J,noDataValue:O});if(n=m.fileInfo.eofOffset,0===p&&(k=m.encodedMaskData,g=new u({width:e.width,height:e.height,pixels:[],pixelType:e.pixelType,mask:m.maskData,statistics:[]})),p++,!Q(m,e))throw"The decoded image dimensions are incorrect";g.addData({pixels:m.pixelData,statistics:{minValue:m.minValue,maxValue:m.maxValue,noDataValue:m.noDataValue}})}return g},_decodeLerc2:function(a,e){this._validateDecodeParams(e);O=e.noDataValue;
e.pixelType=R(e.pixelType);for(var k,g,p,n=0,r=0,m=a.byteLength-10,f=[];r<m;){if(g=M.decode(a,{inputOffset:r,maskData:k,returnFileInfo:!0}),r=g.fileInfo.eofOffset,0===n&&(k=g.maskData,p=new u({width:e.width,height:e.height,pixels:[],pixelType:g.fileInfo.pixelType,mask:g.maskData,statistics:[]})),g.fileInfo.mask&&0<g.fileInfo.mask.numBytes&&f.push(g.maskData),n++,!Q(g,e))throw"The decoded image dimensions are incorrect";p.addData({pixels:g.pixelData,statistics:{minValue:g.minValue,maxValue:g.maxValue,
noDataValue:g.noDataValue}})}if(1<f.length){n=p.width*p.height;p.bandMasks=f;k=new Uint8Array(n);k.set(f[0]);for(e=1;e<f.length;e++)for(a=f[e],g=0;g<n;g++)k[g]&=a[g];p.maskData=k}return p},_calculateBandStatistics:function(a,e){var k,g=1/0,p=-1/0,n=a.length,r=0;if(e)for(k=0;k<n;k++)e[k]&&(r=a[k],g=r<g?r:g,p=r>p?r:p);else for(k=0;k<n;k++)r=a[k],g=r<g?r:g,p=r>p?r:p;return{minValue:g,maxValue:p}},_loadRasterFormatModules:function(){N||(C||(C=new x),10>r("ie")?C.isRejected()||C.reject("unsupported browser version"):
B(["./rasterFormats/JpgPlus","./rasterFormats/Png","./rasterFormats/Raw","./rasterFormats/TiffDecoder","./rasterFormats/Zlib"],function(a,e,k,g){I=a;L=e;P=k;K=g;N=!0;C.isResolved()||C.resolve(!0)}))}});var J=null,O=null,R=function(a){return"U1"===a||"U2"===a||"U4"===a||"U8"===a?(a="U8",O=Math.pow(2,8)-1,J=Uint8Array,a):"U16"===a?(O=O||Math.pow(2,16)-1,J=Uint16Array,a):"U32"===a?(O=O||Math.pow(2,32)-1,J=Uint32Array,a):"S8"===a?(O=O||0-Math.pow(2,7),J=Int8Array,a):"S16"===a?(O=O||0-Math.pow(2,15),J=
Int16Array,a):"S32"===a?(O=O||0-Math.pow(2,31),J=Int32Array,a):(J=Float32Array,a)},Q=function(a,e){return a.height===e.height&&a.width===e.width};return r("extend-esri")&&y.setObject("layers.Raster",m,n),m})},"esri/layers/PixelBlock":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(B,m,y,x){B=B([],{declaredClass:"esri.layers.PixelBlock",planes:null,width:null,height:null,pixelType:null,pixels:[],statistics:[],maskIsAlpha:!1,validPixelCount:null,constructor:function(g){if(g){if(!g.width||
Math.floor(g.width)!==g.width)throw"PixelBlock: incorrect width";if(!g.height||Math.floor(g.height)!==g.height)throw"PixelBlock: incorrect height";if(!g.pixels)throw"PixelBlock: pixel data not present";this.width=g.width;this.height=g.height;this.pixels=g.pixels;this.pixelType=g.pixelType||null;this.statistics=g.statistics;this.mask=g.mask||null;this.maskIsAlpha=g.maskIsAlpha||!1;g=g.validPixelCount;null==g&&(g=this.mask?this._getValidPixelCount(this.mask):this.width*this.height);this.validPixelCount=
g}},getPlaneCount:function(){return this.pixels.length!==this.statistics.length?console.error("Inconsistent pixel data and statistics"):this.statistics.length},addData:function(g){if(!g.pixels||!g.statistics)throw"Pixel data or statistics are not present";if(g.pixels.length!==this.width*this.height)throw"Inconsistent pixel data size";this.statistics.push(g.statistics);this.pixels.push(g.pixels)},getAsRGBA:function(){var g=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "S8":case "S16":case "U16":case "S32":case "U32":case "F32":case "F64":this._fillFromNon8Bit(g);
break;default:this._fillFrom8Bit(g)}return new Uint8ClampedArray(g)},getAsRGBAFloat:function(){var g=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(g),g},clone:function(g){g=g||this;var w=new this.constructor;w.width=g.width;w.height=g.height;w.pixelType=g.pixelType;w.maskIsAlpha=g.maskIsAlpha;g.mask&&(w.mask=new Uint8Array(g.mask));var t,r,n;if(g.pixels)for(w.pixels=[],n=(r=g.pixels.length)&&g.pixels[0].slice,t=0;t<r;t++)w.pixels[t]=n?g.pixels[t].slice(0,g.pixels[t].length):
new g.pixels[t].constructor(g.pixels[t]);if(g.statistics)for(w.statistics=[],r=g.statistics.length,t=0;t<r;t++)w.statistics[t]=m.clone(g.statistics[t]);g=g.validPixelCount;return null==g&&(g=w.mask?this._getValidPixelCount(w.mask):w.width*w.height),w},clamp:function(g){if("F64"!==g&&"F32"!==g){var m;switch(g){case "U8":m=[0,255];break;case "U16":m=[0,65535];break;case "U32":m=[0,4294967295];break;case "S8":m=[-128,127];break;case "S16":m=[-32768,32767];break;case "S32":m=[-2147483648,2147483647];
break;default:m=[-3.4E39,3.4E39]}var t,r,n,A,a=m[0],k=m[1],e=this.pixels,p=this.width*this.height,u=e.length,z=[];for(n=0;n<u;n++){r=this._createEmptyBand(g,p);m=e[n];for(A=0;A<p;A++)t=m[A],r[A]=t>k?k:t<a?a:t;z.push(r)}this.pixels=z;this.pixelType=g}},calculateStatistics:function(){var g,m,t=[],r=this.mask;for(g=0;g<this.pixels.length;g++)m=this.pixels[g],t.push(this._calculateBandStatistics(m,r));this.statistics=t},_getValidPixelCount:function(g){var m,t=0;for(m=0;m<g.length;m++)g[m]&&t++;return t},
_createEmptyBand:function(g,m){switch(g){case "U8":g=new Uint8Array(m);break;case "U16":g=new Uint16Array(m);break;case "U32":g=new Uint32Array(m);break;case "S8":g=new Int8Array(m);break;case "S16":g=new Int16Array(m);break;case "S32":g=new Int32Array(m);break;case "U32":g=new Uint32Array(m);break;case "F32":g=new Float32Array(m);break;case "F64":g=new Float64Array(m);break;default:g=new Float32Array(m)}return g},_fillFrom8Bit:function(g){var m=this.pixels,t=this.mask;if(!g||!m||!m.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var r,n,A;r=n=A=m[0];3<=m.length&&(n=m[1],A=m[2]);var m=new Uint32Array(g),a=this.width*this.height;if(r.length!==a)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(t&&t.length===a)if(this.maskIsAlpha)for(g=0;g<a;g++)t[g]&&(m[g]=t[g]<<24|A[g]<<16|n[g]<<8|r[g]);else for(g=0;g<a;g++)t[g]&&(m[g]=-16777216|A[g]<<16|n[g]<<8|r[g]);else for(g=0;g<a;g++)m[g]=-16777216|A[g]<<16|n[g]<<8|r[g]},_fillFromNon8Bit:function(g){var m=this.pixels,t=this.mask,r=this.statistics;if(!g||
!m||!m.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var n=1,A=0,n=1;r&&0<r.length?(A=r.map(function(a){return a.minValue}).reduce(function(a,e){return Math.min(a,e)}),n=r.map(function(a){return a.maxValue-a.minValue}).reduce(function(a,e){return Math.max(a,e)}),n=255/n):(n=255,"S8"===this.pixelType?(A=-128,n=127):"U16"===this.pixelType?n=65535:"S16"===this.pixelType?(A=-32768,n=32767):"U32"===this.pixelType?n=4294967295:"S32"===this.pixelType?(A=-2147483648,
n=2147483647):"F32"===this.pixelType?(A=-3.4E39,n=3.4E39):"F64"===this.pixelType&&(A=-Number.MAX_VALUE,n=Number.MAX_VALUE),n=255/(n-A));var a,k,e;g=new Uint32Array(g);r=this.width*this.height;if(a=m[0],a.length!==r)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(3<=m.length)if(k=m[1],e=m[2],t&&t.length===r)for(m=0;m<r;m++)t[m]&&(g[m]=-16777216|(e[m]-A)*n<<16|(k[m]-A)*n<<8|(a[m]-A)*n);else for(m=0;m<r;m++)g[m]=-16777216|(e[m]-A)*n<<16|(k[m]-A)*n<<8|(a[m]-A)*n;else if(t&&
t.length===r)for(m=0;m<r;m++)k=(a[m]-A)*n,t[m]&&(g[m]=-16777216|k<<16|k<<8|k);else for(m=0;m<r;m++)k=(a[m]-A)*n,g[m]=-16777216|k<<16|k<<8|k},_fillFrom32Bit:function(g){var m=this.pixels,t=this.mask;if(!g||!m||!m.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var r,n,A;r=n=A=m[0];3<=m.length&&(n=m[1],A=m[2]);var a=this.width*this.height;if(r.length!==a)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");var k=0;if(t&&t.length===a)for(m=
0;m<a;m++)g[k++]=r[m],g[k++]=n[m],g[k++]=A[m],g[k++]=1&t[m];else for(m=0;m<a;m++)g[k++]=r[m],g[k++]=n[m],g[k++]=A[m],g[k++]=1},_calculateBandStatistics:function(g,m){var t,r=1/0,n=-1/0,w=g.length,a=0;if(m)for(t=0;t<w;t++)m[t]&&(a=g[t],r=a<r?a:r,n=a>n?a:n);else for(t=0;t<w;t++)a=g[t],r=a<r?a:r,n=a>n?a:n;return{minValue:r,maxValue:n}}});return y("extend-esri")&&m.setObject("layers.PixelBlock",B,x),B})},"esri/layers/rasterFormats/LercCodec":function(){define([],function(){var B={defaultNoDataValue:-3.4027999387901484E38,
decode:function(y,x){var g;x=x||{};var w=x.inputOffset||0,t=x.encodedMaskData||null===x.encodedMaskData,r={},n=new Uint8Array(y,w,10);if(r.fileIdentifierString=String.fromCharCode.apply(null,n),"CntZImage"!=r.fileIdentifierString.trim())throw"Unexpected file identifier string: "+r.fileIdentifierString;w+=10;n=new DataView(y,w,24);r.fileVersion=n.getInt32(0,!0);r.imageType=n.getInt32(4,!0);r.height=n.getUint32(8,!0);r.width=n.getUint32(12,!0);r.maxZError=n.getFloat64(16,!0);var w=w+24,A;if(!t)if(n=
new DataView(y,w,16),r.mask={},r.mask.numBlocksY=n.getUint32(0,!0),r.mask.numBlocksX=n.getUint32(4,!0),r.mask.numBytes=n.getUint32(8,!0),r.mask.maxValue=n.getFloat32(12,!0),w+=16,0<r.mask.numBytes){A=new Uint8Array(Math.ceil(r.width*r.height/8));var n=new DataView(y,w,r.mask.numBytes),t=n.getInt16(0,!0),a=2,k=0;do{if(0<t)for(;t--;)A[k++]=n.getUint8(a++);else for(var e=n.getUint8(a++),t=-t;t--;)A[k++]=e;t=n.getInt16(a,!0);a+=2}while(a<r.mask.numBytes);if(-32768!==t||k<A.length)throw"Unexpected end of mask RLE encoding";
r.mask.bitset=A;w+=r.mask.numBytes}else 0==(r.mask.numBytes|r.mask.numBlocksY|r.mask.maxValue)&&(A=new Uint8Array(Math.ceil(r.width*r.height/8)),r.mask.bitset=A);n=new DataView(y,w,16);r.pixels={};r.pixels.numBlocksY=n.getUint32(0,!0);r.pixels.numBlocksX=n.getUint32(4,!0);r.pixels.numBytes=n.getUint32(8,!0);r.pixels.maxValue=n.getFloat32(12,!0);w+=16;A=r.pixels.numBlocksX;n=r.pixels.numBlocksY;A+=0<r.width%A?1:0;t=n+(0<r.height%n?1:0);r.pixels.blocks=Array(A*t);for(k=a=0;k<t;k++)for(e=0;e<A;e++){var p=
0,n=new DataView(y,w,Math.min(10,y.byteLength-w)),u={};r.pixels.blocks[a++]=u;var z=n.getUint8(0);if(p++,u.encoding=63&z,3<u.encoding)throw"Invalid block encoding ("+u.encoding+")";if(2!==u.encoding){if(0!==z&&2!==z){if(z>>=6,u.offsetType=z,2===z)u.offset=n.getInt8(1),p++;else if(1===z)u.offset=n.getInt16(1,!0),p+=2;else{if(0!==z)throw"Invalid block offset type";u.offset=n.getFloat32(1,!0);p+=4}if(1===u.encoding)if(z=n.getUint8(p),p++,u.bitsPerPixel=63&z,z>>=6,u.numValidPixelsType=z,2===z)u.numValidPixels=
n.getUint8(p),p++;else if(1===z)u.numValidPixels=n.getUint16(p,!0),p+=2;else{if(0!==z)throw"Invalid valid pixel count type";u.numValidPixels=n.getUint32(p,!0);p+=4}}if(w+=p,3!=u.encoding)if(0===u.encoding){z=(r.pixels.numBytes-1)/4;if(z!==Math.floor(z))throw"uncompressed block has invalid length";n=new ArrayBuffer(4*z);p=new Uint8Array(n);p.set(new Uint8Array(y,w,4*z));n=new Float32Array(n);u.rawData=n;w+=4*z}else 1===u.encoding&&(z=Math.ceil(u.numValidPixels*u.bitsPerPixel/8),n=new ArrayBuffer(4*
Math.ceil(z/4)),p=new Uint8Array(n),p.set(new Uint8Array(y,w,z)),u.stuffedData=new Uint32Array(n),w+=z)}else w++}y=(r.eofOffset=w,r);w=null!=x.noDataValue?x.noDataValue:B.defaultNoDataValue;A=x.encodedMaskData;var z=x.returnMask,M,t=0,a=y.pixels.numBlocksX,k=y.pixels.numBlocksY,e=Math.floor(y.width/a),u=Math.floor(y.height/k),p=2*y.maxZError,r=Number.MAX_VALUE;A=A||(y.mask?y.mask.bitset:null);n=new (x.pixelType||Float32Array)(y.width*y.height);z&&A&&(g=new Uint8Array(y.width*y.height));for(var I,
L,z=new Float32Array(e*u),P=0;P<=k;P++){var K=P!==k?u:y.height%k;if(0!==K)for(var N=0;N<=a;N++){var C=N!==a?e:y.width%a;if(0!==C){var J,O,R,Q=P*y.width*u+N*e,T=y.width-C,S=y.pixels.blocks[t];if(2>S.encoding){if(0===S.encoding)J=S.rawData;else{J=S.stuffedData;O=S.bitsPerPixel;I=S.numValidPixels;L=S.offset;var U=p,X=z,W=y.pixels.maxValue,V=void 0,Y=void 0,Z=void 0,f=(1<<O)-1,aa=0,E=0,c=Math.ceil((W-L)/U);J[J.length-1]<<=8*(4*J.length-Math.ceil(O*I/8));for(V=0;V<I;V++)(0===E&&(Z=J[aa++],E=32),E>=O)?
(Y=Z>>>E-O&f,E-=O):(E=O-E,Y=(Z&f)<<E&f,Z=J[aa++],E=32-E,Y+=Z>>>E),X[V]=Y<c?L+Y*U:W;J=z}O=0}else R=2===S.encoding?0:S.offset;var b;if(A)for(L=0;L<K;L++){7&Q&&(b=A[Q>>3],b<<=7&Q);for(I=0;I<C;I++)7&Q||(b=A[Q>>3]),128&b?(g&&(g[Q]=1),M=2>S.encoding?J[O++]:R,r=r>M?M:r,n[Q++]=M):(g&&(g[Q]=0),n[Q++]=w),b<<=1;Q+=T}else if(2>S.encoding)for(L=0;L<K;L++){for(I=0;I<C;I++)M=J[O++],r=r>M?M:r,n[Q++]=M;Q+=T}else for(r=r>R?R:r,L=0;L<K;L++){for(I=0;I<C;I++)n[Q++]=R;Q+=T}if(1===S.encoding&&O!==S.numValidPixels)throw"Block and Mask do not match";
t++}}}M={width:y.width,height:y.height,pixelData:n,minValue:r,maxValue:y.pixels.maxValue,noDataValue:w};g&&(M.maskData=g);x.returnEncodedMask&&y.mask&&(M.encodedMaskData=y.mask.bitset?y.mask.bitset:null);if(x.returnFileInfo&&(M.fileInfo=m(y),x.computeUsedBitDepths)){x=M.fileInfo;g=y.pixels.numBlocksX*y.pixels.numBlocksY;R={};for(b=0;b<g;b++)J=y.pixels.blocks[b],0===J.encoding?R.float32=!0:1===J.encoding?R[J.bitsPerPixel]=!0:R[0]=!0;g=Object.keys(R);x.bitDepths=g}return M}},m=function(m){return{fileIdentifierString:m.fileIdentifierString,
fileVersion:m.fileVersion,imageType:m.imageType,height:m.height,width:m.width,maxZError:m.maxZError,eofOffset:m.eofOffset,mask:m.mask?{numBlocksX:m.mask.numBlocksX,numBlocksY:m.mask.numBlocksY,numBytes:m.mask.numBytes,maxValue:m.mask.maxValue}:null,pixels:{numBlocksX:m.pixels.numBlocksX,numBlocksY:m.pixels.numBlocksY,numBytes:m.pixels.numBytes,maxValue:m.pixels.maxValue,noDataValue:this.noDataValue}}};return B})},"esri/layers/rasterFormats/Lerc2Codec":function(){define([],function(){var B={unstuff:function(m,
g,w,t,r,n,A,a){var k,e,p,u,z=(1<<w)-1,x=0,y=0;if(m[m.length-1]<<=8*(4*m.length-Math.ceil(w*t/8)),r)for(k=0;k<t;k++)0===y&&(p=m[x++],y=32),y>=w?(e=p>>>y-w&z,y-=w):(u=w-y,e=(p&z)<<u&z,p=m[x++],y=32-u,e+=p>>>y),g[k]=r[e];else for(r=Math.ceil((a-n)/A),k=0;k<t;k++)0===y&&(p=m[x++],y=32),y>=w?(e=p>>>y-w&z,y-=w):(u=w-y,e=(p&z)<<u&z,p=m[x++],y=32-u,e+=p>>>y),g[k]=e<r?n+e*A:a},unstuffLUT:function(m,g,w,t,r,n){var A,a=(1<<g)-1,k=0,e=0,p=0,u=0,z=0,x=[];m[m.length-1]<<=8*(4*m.length-Math.ceil(g*w/8));for(var y=
Math.ceil((n-t)/r),e=0;e<w;e++)0===u&&(A=m[k++],u=32),u>=g?(z=A>>>u-g&a,u-=g):(p=g-u,z=(A&a)<<p&a,A=m[k++],u=32-p,z+=A>>>u),x[e]=z<y?t+z*r:n;return x.unshift(t),x},unstuff2:function(m,g,w,t,r,n,A,a){var k,e,p,u,z=(1<<w)-1,x=0,y=0,B=0;if(r)for(k=0;k<t;k++)0===y&&(p=m[x++],y=32,B=0),y>=w?(e=p>>>B&z,y-=w,B+=w):(u=w-y,e=p>>>B&z,p=m[x++],y=32-u,e|=(p&(1<<u)-1)<<w-u,B=u),g[k]=r[e];else for(r=Math.ceil((a-n)/A),k=0;k<t;k++)0===y&&(p=m[x++],y=32,B=0),y>=w?(e=p>>>B&z,y-=w,B+=w):(u=w-y,e=p>>>B&z,p=m[x++],y=
32-u,e|=(p&(1<<u)-1)<<w-u,B=u),g[k]=e<r?n+e*A:a;return g},unstuffLUT2:function(m,g,w,t,r,n){for(var A,a=(1<<g)-1,k=0,e=0,p=0,u=0,z=0,x=0,y=[],B=Math.ceil((n-t)/r),e=0;e<w;e++)0===u&&(A=m[k++],u=32,x=0),u>=g?(z=A>>>x&a,u-=g,x+=g):(p=g-u,z=A>>>x&a,A=m[k++],u=32-p,z|=(A&(1<<p)-1)<<g-p,x=p),y[e]=z<B?t+z*r:n;return y.unshift(t),y},originalUnstuff:function(m,g,w,t){var r,n,A,a,k=(1<<w)-1,e=0,p=0;m[m.length-1]<<=8*(4*m.length-Math.ceil(w*t/8));for(r=0;r<t;r++)0===p&&(A=m[e++],p=32),p>=w?(n=A>>>p-w&k,p-=
w):(a=w-p,n=(A&k)<<a&k,A=m[e++],p=32-a,n+=A>>>p),g[r]=n;return g},originalUnstuff2:function(m,g,w,t){var r,n,A,a,k=(1<<w)-1,e=0,p=0,u=0;for(r=0;r<t;r++)0===p&&(A=m[e++],p=32,u=0),p>=w?(n=A>>>u&k,p-=w,u+=w):(a=w-p,n=A>>>u&k,A=m[e++],p=32-a,n|=(A&(1<<a)-1)<<w-a,u=a),g[r]=n;return g}},m={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(m){for(var g=65535,w=65535,t=m.length,r=Math.floor(t/2),n=0;r;){var A=359<=r?359:r,r=r-A;do g+=m[n++]<<8,w+=g+=m[n++];while(--A);g=(65535&g)+(g>>>16);w=(65535&
w)+(w>>>16)}return 1&t&&(w+=g+=m[n]<<8),g=(65535&g)+(g>>>16),((w=(65535&w)+(w>>>16))<<16|g)>>>0},readHeaderInfo:function(m,g){var w=g.ptr,t=new Uint8Array(m,w,6),r={};if(r.fileIdentifierString=String.fromCharCode.apply(null,t),0!==r.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+r.fileIdentifierString;var w=w+6,t=new DataView(m,w,8),n=t.getInt32(0,!0);r.fileVersion=n;w+=4;3<=n&&(r.checksum=t.getUint32(4,!0),w+=4);t=new DataView(m,w,12);r.height=
t.getUint32(0,!0);r.width=t.getUint32(4,!0);w+=8;4<=n?(r.numDims=t.getUint32(8,!0),w+=4):r.numDims=1;t=new DataView(m,w,40);r.numValidPixel=t.getUint32(0,!0);r.microBlockSize=t.getInt32(4,!0);r.blobSize=t.getInt32(8,!0);r.imageType=t.getInt32(12,!0);r.maxZError=t.getFloat64(16,!0);r.zMin=t.getFloat64(24,!0);r.zMax=t.getFloat64(32,!0);w+=40;g.headerInfo=r;g.ptr=w;var A;if(3<=n&&(A=4<=n?52:48,this.computeChecksumFletcher32(new Uint8Array(m,w-A,r.blobSize-14))!==r.checksum))throw"Checksum failed.";return!0},
checkMinMaxRanges:function(m,g){var w=g.headerInfo,t=this.getDataTypeArray(w.imageType),r=w.numDims*this.getDataTypeSize(w.imageType),n=this.readSubArray(m,g.ptr,t,r);m=this.readSubArray(m,g.ptr+r,t,r);g.ptr+=2*r;r=!0;for(g=0;g<w.numDims;g++)if(n[g]!==m[g]){r=!1;break}return w.minValues=n,w.maxValues=m,r},readSubArray:function(m,g,w,t){if(w===Uint8Array)m=new Uint8Array(m,g,t);else{var r=new ArrayBuffer(t);(new Uint8Array(r)).set(new Uint8Array(m,g,t));m=new w(r)}return m},readMask:function(m,g){var w=
g.ptr,t=g.headerInfo,r=t.width*t.height,n=t.numValidPixel,A=new DataView(m,w,4),t={};if(t.numBytes=A.getUint32(0,!0),w+=4,(0===n||r===n)&&0!==t.numBytes)throw"invalid mask";if(0===n)n=new Uint8Array(Math.ceil(r/8)),t.bitset=n,A=new Uint8Array(r),g.pixels.resultMask=A,w+=t.numBytes;else if(0<t.numBytes){n=new Uint8Array(Math.ceil(r/8));A=new DataView(m,w,t.numBytes);m=A.getInt16(0,!0);var a=2,k=0,e=0;do{if(0<m)for(;m--;)n[k++]=A.getUint8(a++);else for(e=A.getUint8(a++),m=-m;m--;)n[k++]=e;m=A.getInt16(a,
!0);a+=2}while(a<t.numBytes);if(-32768!==m||k<n.length)throw"Unexpected end of mask RLE encoding";A=new Uint8Array(r);for(a=a=m=0;a<r;a++)7&a?(m=n[a>>3],m<<=7&a):m=n[a>>3],128&m&&(A[a]=1);g.pixels.resultMask=A;t.bitset=n;w+=t.numBytes}return g.ptr=w,g.mask=t,!0},readDataOneSweep:function(x,g,w){var t=g.ptr,r=g.headerInfo,n=r.numDims,A=r.width*r.height,r=r.numValidPixel*m.getDataTypeSize(r.imageType)*n,a=g.pixels.resultMask;if(w===Uint8Array)x=new Uint8Array(x,t,r);else{var k=new ArrayBuffer(r);(new Uint8Array(k)).set(new Uint8Array(x,
t,r));x=new w(k)}if(x.length===A*n)g.pixels.resultPixels=x;else{g.pixels.resultPixels=new w(A*n);var e=k=w=0,p=0;if(1<n)for(e=0;e<n;e++)for(p=e*A,k=0;k<A;k++)a[k]&&(g.pixels.resultPixels[p+k]=x[w++]);else for(k=0;k<A;k++)a[k]&&(g.pixels.resultPixels[k]=x[w++])}return t+=r,g.ptr=t,!0},readHuffmanTree:function(x,g){var w=this.HUFFMAN_LUT_BITS_MAX,t=new DataView(x,g.ptr,16);if(g.ptr+=16,2>t.getInt32(0,!0))throw"unsupported Huffman version";var r=t.getInt32(4,!0),n=t.getInt32(8,!0),t=t.getInt32(12,!0);
if(n>=t)return!1;var A=new Uint32Array(t-n);m.decodeBits(x,g,A);var a,k,e,p=[];for(a=n;a<t;a++)k=a-(a<r?0:r),p[k]={first:A[a-n],second:null};a=x.byteLength-g.ptr;A=new ArrayBuffer(4*Math.ceil(a/4));(new Uint8Array(A)).set(new Uint8Array(x,g.ptr,a));var u;x=new Uint32Array(A);A=g=0;u=x[0];for(a=n;a<t;a++)k=a-(a<r?0:r),0<(e=p[k].first)&&(p[k].second=u<<g>>>32-e,32-g>=e?32===(g+=e)&&(g=0,A++,u=x[A]):(g+=e-32,A++,u=x[A],p[k].second|=u>>>32-g));var z=u=0,B=new y;for(a=0;a<p.length;a++)void 0!==p[a]&&(u=
Math.max(u,p[a].first));z=u>=w?w:u;30<=u&&console.log("WARning, large NUM LUT BITS IS "+u);var I,L,P,w=[];for(a=n;a<t;a++)if(k=a-(a<r?0:r),0<(e=p[k].first))if(n=[e,k],e<=z)for(I=p[k].second<<z-e,L=1<<z-e,e=0;e<L;e++)w[I|e]=n;else for(I=p[k].second,L=B,--e;0<=e;e--)(P=I>>>e&1)?(L.right||(L.right=new y),L=L.right):(L.left||(L.left=new y),L=L.left),0!==e||L.val||(L.val=n[1]);return{decodeLut:w,numBitsLUTQick:z,numBitsLUT:u,tree:B,stuffedData:x,srcPtr:A,bitPos:g}},readHuffman:function(m,g,w){var t,r,
n,A,a,k,e,p,u,z=g.headerInfo,x=z.numDims,y=g.headerInfo.height,B=g.headerInfo.width,P=B*y;k=this.readHuffmanTree(m,g);m=k.decodeLut;var K=k.tree,N=k.stuffedData,C=k.srcPtr,J=k.bitPos,O=k.numBitsLUTQick,R=k.numBitsLUT,Q=0===g.headerInfo.imageType?128:0,T=g.pixels.resultMask,S=0;0<J&&(C++,J=0);var U,X=N[C],W=1===g.encodeMode,V=new w(P*x),Y=V;for(U=0;U<z.numDims;U++){if(1<x&&(Y=new w(V.buffer,P*U,P),S=0),g.headerInfo.numValidPixel===B*y)for(k=p=0;k<y;k++)for(e=0;e<B;e++,p++){if(r=0,n=X<<J>>>32-O,A=n,
32-J<O&&(n|=N[C+1]>>>64-J-O,A=n),m[A])r=m[A][1],J+=m[A][0];else for(A=n=X<<J>>>32-R,32-J<R&&(n|=N[C+1]>>>64-J-R,A=n),t=K,u=0;u<R;u++)if(a=n>>>R-u-1&1,t=a?t.right:t.left,!t.left&&!t.right){r=t.val;J=J+u+1;break}32<=J&&(J-=32,C++,X=N[C]);t=r-Q;W?(t+=0<e?S:0<k?Y[p-B]:S,t&=255,Y[p]=t,S=t):Y[p]=t}else for(k=p=0;k<y;k++)for(e=0;e<B;e++,p++)if(T[p]){if(r=0,n=X<<J>>>32-O,A=n,32-J<O&&(n|=N[C+1]>>>64-J-O,A=n),m[A])r=m[A][1],J+=m[A][0];else for(A=n=X<<J>>>32-R,32-J<R&&(n|=N[C+1]>>>64-J-R,A=n),t=K,u=0;u<R;u++)if(a=
n>>>R-u-1&1,t=a?t.right:t.left,!t.left&&!t.right){r=t.val;J=J+u+1;break}32<=J&&(J-=32,C++,X=N[C]);t=r-Q;W?(0<e&&T[p-1]?t+=S:0<k&&T[p-B]?t+=Y[p-B]:t+=S,t&=255,Y[p]=t,S=t):Y[p]=t}g.ptr=g.ptr+4*(C+1)+(0<J?4:0)}g.pixels.resultPixels=V},decodeBits:function(m,g,w,t,r){var n=g.headerInfo,A=n.fileVersion,a=0,k=new DataView(m,g.ptr,5),e=k.getUint8(0);a++;var p=e>>6,u=0===p?4:3-p,z=0<(32&e),p=31&e,e=0;if(1===u)e=k.getUint8(a),a++;else if(2===u)e=k.getUint16(a,!0),a+=2;else{if(4!==u)throw"Invalid valid pixel count type";
e=k.getUint32(a,!0);a+=4}var x,y,L,P,K,u=2*n.maxZError;r=1<n.numDims?n.maxValues[r]:n.zMax;if(z){g.counter.lut++;n=k.getUint8(a);p;a++;P=Math.ceil((n-1)*p/8);K=Math.ceil(P/4);y=new ArrayBuffer(4*K);L=new Uint8Array(y);g.ptr+=a;L.set(new Uint8Array(m,g.ptr,P));a=new Uint32Array(y);g.ptr+=P;for(k=0;n-1>>>k;)k++;P=Math.ceil(e*k/8);K=Math.ceil(P/4);y=new ArrayBuffer(4*K);L=new Uint8Array(y);L.set(new Uint8Array(m,g.ptr,P));x=new Uint32Array(y);g.ptr+=P;m=3<=A?B.unstuffLUT2(a,p,n-1,t,u,r):B.unstuffLUT(a,
p,n-1,t,u,r);3<=A?B.unstuff2(x,w,k,e,m):B.unstuff(x,w,k,e,m)}else g.counter.bitstuffer++,k=p,g.ptr+=a,0<k&&(P=Math.ceil(e*k/8),K=Math.ceil(P/4),y=new ArrayBuffer(4*K),L=new Uint8Array(y),L.set(new Uint8Array(m,g.ptr,P)),x=new Uint32Array(y),g.ptr+=P,3<=A?null==t?B.originalUnstuff2(x,w,k,e):B.unstuff2(x,w,k,e,!1,t,u,r):null==t?B.originalUnstuff(x,w,k,e):B.unstuff(x,w,k,e,!1,t,u,r))},readTiles:function(x,g,w){var t=g.headerInfo,r=t.width,n=t.height,A=t.microBlockSize,a=t.imageType,k=m.getDataTypeSize(a),
e=Math.ceil(r/A),p=Math.ceil(n/A);g.pixels.numBlocksY=p;g.pixels.numBlocksX=e;g.pixels.ptr=0;for(var u,z,y,B,L,P,K,N=P=0,C=0,J=0,O=0,R=0,Q=0,T=0,S=N=0,U=0,X=0,W=0,V=z=0,Y=new w(A*A),Z=n%A||A,f=r%A||A,aa=t.numDims,E=g.pixels.resultMask,c=g.pixels.resultPixels,C=0;C<p;C++)for(O=C!==p-1?A:Z,J=0;J<e;J++)for(R=J!==e-1?A:f,S=C*r*A+J*A,U=r-R,t=0;t<aa;t++){if(1<aa&&(c=new w(g.pixels.resultPixels.buffer,r*n*t*k,r*n)),Q=x.byteLength-g.ptr,u=new DataView(x,g.ptr,Math.min(10,Q)),z={},V=0,T=u.getUint8(0),V++,
N=T>>6&255,(T>>2&15)!==(J*A>>3&15))throw"integrity issue";if(3<(P=3&T))throw g.ptr+=V,"Invalid block encoding ("+P+")";if(2!==P)if(0===P){if(g.counter.uncompressed++,g.ptr+=V,X=O*R*k,W=x.byteLength-g.ptr,X=X<W?X:W,y=new ArrayBuffer(0==X%k?X:X+k-X%k),B=new Uint8Array(y),B.set(new Uint8Array(x,g.ptr,X)),L=new w(y),z=0,E)for(P=0;P<O;P++){for(N=0;N<R;N++)E[S]&&(c[S]=L[z++]),S++;S+=U}else for(P=0;P<O;P++){for(N=0;N<R;N++)c[S++]=L[z++];S+=U}g.ptr+=z*k}else if(K=m.getDataTypeUsed(a,N),z=m.getOnePixel(z,
V,K,u),V+=m.getDataTypeSize(K),3===P)if(g.ptr+=V,g.counter.constantoffset++,E)for(P=0;P<O;P++){for(N=0;N<R;N++)E[S]&&(c[S]=z),S++;S+=U}else for(P=0;P<O;P++){for(N=0;N<R;N++)c[S++]=z;S+=U}else if(g.ptr+=V,m.decodeBits(x,g,Y,z,t),V=0,E)for(P=0;P<O;P++){for(N=0;N<R;N++)E[S]&&(c[S]=Y[V++]),S++;S+=U}else for(P=0;P<O;P++){for(N=0;N<R;N++)c[S++]=Y[V++];S+=U}else g.counter.constant++,g.ptr+=V}},formatFileInfo:function(x){return{fileIdentifierString:x.headerInfo.fileIdentifierString,fileVersion:x.headerInfo.fileVersion,
imageType:x.headerInfo.imageType,height:x.headerInfo.height,width:x.headerInfo.width,numValidPixel:x.headerInfo.numValidPixel,microBlockSize:x.headerInfo.microBlockSize,blobSize:x.headerInfo.blobSize,maxZError:x.headerInfo.maxZError,pixelType:m.getPixelType(x.headerInfo.imageType),eofOffset:x.eofOffset,mask:x.mask?{numBytes:x.mask.numBytes}:null,pixels:{numBlocksX:x.pixels.numBlocksX,numBlocksY:x.pixels.numBlocksY,maxValue:x.headerInfo.zMax,minValue:x.headerInfo.zMin,noDataValue:x.noDataValue}}},
constructConstantSurface:function(m){var g=m.headerInfo.zMax,w=m.headerInfo.numDims,t=m.headerInfo.height*m.headerInfo.width,r=t*w,n=0,A=0,a=0,k=m.pixels.resultMask;if(k)if(1<w)for(n=0;n<w;n++)for(a=n*t,A=0;A<t;A++)k[A]&&(m.pixels.resultPixels[a+A]=g);else for(A=0;A<t;A++)k[A]&&(m.pixels.resultPixels[A]=g);else if(m.pixels.resultPixels.fill)m.pixels.resultPixels.fill(g);else for(A=0;A<r;A++)m.pixels.resultPixels[A]=g},getDataTypeArray:function(m){switch(m){case 0:m=Int8Array;break;case 1:m=Uint8Array;
break;case 2:m=Int16Array;break;case 3:m=Uint16Array;break;case 4:m=Int32Array;break;case 5:m=Uint32Array;break;case 6:m=Float32Array;break;case 7:m=Float64Array;break;default:m=Float32Array}return m},getPixelType:function(m){switch(m){case 0:m="S8";break;case 1:m="U8";break;case 2:m="S16";break;case 3:m="U16";break;case 4:m="S32";break;case 5:m="U32";break;case 6:m="F32";break;case 7:m="F64";break;default:m="F32"}return m},isValidPixelValue:function(m,g){if(null==g)return!1;switch(m){case 0:m=-128<=
g&&127>=g;break;case 1:m=0<=g&&255>=g;break;case 2:m=-32768<=g&&32767>=g;break;case 3:m=0<=g&&65536>=g;break;case 4:m=-2147483648<=g&&2147483647>=g;break;case 5:m=0<=g&&4294967296>=g;break;case 6:m=-3.4027999387901484E38<=g&&3.4027999387901484E38>=g;break;case 7:m=4.9E-324<=g&&1.7976931348623157E308>=g;break;default:m=!1}return m},getDataTypeSize:function(m){var g=0;switch(m){case 0:case 1:g=1;break;case 2:case 3:g=2;break;case 4:case 5:case 6:g=4;break;case 7:g=8;break;default:g=m}return g},getDataTypeUsed:function(m,
g){var w=m;switch(m){case 2:case 4:w=m-g;break;case 3:case 5:w=m-2*g;break;case 6:w=0===g?m:1===g?2:1;break;case 7:w=0===g?m:m-2*g+1;break;default:w=m}return w},getOnePixel:function(m,g,w,t){m=0;switch(w){case 0:m=t.getInt8(g);break;case 1:m=t.getUint8(g);break;case 2:m=t.getInt16(g,!0);break;case 3:m=t.getUint16(g,!0);break;case 4:m=t.getInt32(g,!0);break;case 5:m=t.getUInt32(g,!0);break;case 6:m=t.getFloat32(g,!0);break;case 7:m=t.getFloat64(g,!0);break;default:throw"the decoder does not understand this pixel type";
}return m}},y=function(m,g,w){this.val=m;this.left=g;this.right=w};return{decode:function(x,g){g=g||{};var w=g.noDataValue,t=0,r={};if(r.ptr=g.inputOffset||0,r.pixels={},m.readHeaderInfo(x,r)){var t=r.headerInfo,n=t.fileVersion,A=m.getDataTypeArray(t.imageType);m.readMask(x,r);t.numValidPixel===t.width*t.height||r.pixels.resultMask||(r.pixels.resultMask=g.maskData);var a=t.width*t.height;if(r.pixels.resultPixels=new A(a*t.numDims),r.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,
constantoffset:0},0!==t.numValidPixel)if(t.zMax===t.zMin)m.constructConstantSurface(r);else if(4<=n&&m.checkMinMaxRanges(x,r))m.constructConstantSurface(r);else{var k=new DataView(x,r.ptr,2),e=k.getUint8(0);if(r.ptr++,e)m.readDataOneSweep(x,r,A);else if(1<n&&1>=t.imageType&&1E-5>Math.abs(t.maxZError-.5)){k=k.getUint8(1);if(r.ptr++,r.encodeMode=k,2<k||4>n&&1<k)throw"Invalid Huffman flag "+k;k?m.readHuffman(x,r,A):m.readTiles(x,r,A)}else m.readTiles(x,r,A)}r.eofOffset=r.ptr;var p;g.inputOffset?(p=r.headerInfo.blobSize+
g.inputOffset-r.ptr,1<=Math.abs(p)&&(r.eofOffset=g.inputOffset+r.headerInfo.blobSize)):(p=r.headerInfo.blobSize-r.ptr,1<=Math.abs(p)&&(r.eofOffset=r.headerInfo.blobSize));x={width:t.width,height:t.height,pixelData:r.pixels.resultPixels,minValue:t.zMin,maxValue:t.zMax,validPixelCount:t.numValidPixel,dimCount:t.numDims,dimStats:{minValues:t.minValues,maxValues:t.maxValues},maskData:r.pixels.resultMask};if(r.pixels.resultMask&&m.isValidPixelValue(t.imageType,w)){p=r.pixels.resultMask;for(t=0;t<a;t++)p[t]||
(x.pixelData[t]=w);x.noDataValue=w}return r.noDataValue=w,g.returnFileInfo&&(x.fileInfo=m.formatFileInfo(r)),x}},getBandCount:function(x){for(var g=0,w=0,t={ptr:0,pixels:{}};w<x.byteLength-58;)m.readHeaderInfo(x,t),w+=t.headerInfo.blobSize,g++,t.ptr=w;return g}}})},"esri/layers/pixelFilters/VectorFieldPixelFilter":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../lang dojo/_base/array".split(" "),function(B,m,y,x,g,w){B=B(null,{declaredClass:"esri.layers.pixelFilters.VectorFieldPixelFilter",
speedUnits:["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"],constructor:function(g){m.mixin(this,g);this.isDataUV=!(!g||!g.isDataUV)&&g.isDataUV;this.computeMagnitudeAndDirection=m.hitch(this,this.computeMagnitudeAndDirection);this.unitConversionFactor=1;this._updateUnitConvFactor()},setUnits:function(g,r){this.inputUnit=g;this.outputUnit=r;this.unitConversionFactor=1;this._updateUnitConvFactor()},_updateUnitConvFactor:function(){var g=w.indexOf(this.speedUnits,
this.inputUnit),r=w.indexOf(this.speedUnits,this.outputUnit);if(this.inputUnit&&this.outputUnit&&0<=g&&0<=r){var n=[1,.277778,.514444,.3048,.44704,0];this.unitConversionFactor=n[g]/n[r]}},computeMagnitudeAndDirection:function(m){if(!g.isDefined(m))throw"Could not compute magnitude and direction. No pixel data is available.";var r=m.pixelBlock;if(!g.isDefined(r)||2!==r.getPlaneCount())throw"Could not compute magnitude and direction. Pixel data does not contain two bands.";var n=m.extent,t=(n.xmax-
n.xmin)/r.width,a=(n.ymax-n.ymin)/r.height,k=n.xmin+t/2,n=n.ymax-a/2;r.statistics[0].minValue=0;r.statistics[0].maxValue=0;var e,p,u,z,w,x,y,B,K=180/Math.PI,N=[],C=0,J=0,O=0,R=!g.isDefined(r.mask);w=y=1/0;x=B=-1/0;for(C=0;C<r.height;C++)for(J=0;J<r.width;J++,O++)N.push([k+t*J,n-a*C]),(R||r.mask[O])&&(u=e=r.pixels[0][O]*this.unitConversionFactor,z=p=r.pixels[1][O],this.isDataUV&&(u=Math.sqrt(e*e+p*p),z=90-K*Math.atan2(p,e),r.pixels[0][O]=u*this.unitConversionFactor,r.pixels[1][O]=z),u>x&&(x=u),u<w&&
(w=u),z>B&&(B=z),z<y&&(y=z));return r.statistics[0].maxValue=x,r.statistics[0].minValue=w,r.statistics[1].maxValue=B,r.statistics[1].minValue=y,m.locations=N,m}});return y("extend-esri")&&m.setObject("layers.pixelFilters.VectorFieldPixelFilter",B,x),B})},"esri/layers/rasterFormats/ImageCanvasDecoder":function(){define(["require","dojo/_base/declare","dojo/Deferred","dojo/sniff"],function(B,m,y,x){var g;return m(null,{constructor:function(g){this.ctx=g.ctx;this._loadRasterFormatModule()},decode:function(g,
m){if(!m.width||!m.height)throw"Native decoding requires the image format, width and height";var r,n=new y,t=new Uint8Array(g);g=this._getFormat(g);if("error"===g)throw"invalid format";"jpeg"===g&&(r=this._getMask(t,m));var a,k,e="";for(a=0;a<t.length;a+=65535)k=t.subarray(a,a+65535>t.length-1?t.length-1:a+65535),e+=String.fromCharCode.apply(null,k);var p,t="data:image/"+g+";base64,"+window.btoa(e),u=new Image;u.src=t;var z=this;return u.onload=function(){z.ctx.clearRect(0,0,m.width,m.height);z.ctx.drawImage(u,
0,0);var e=z.ctx.getImageData(0,0,u.width,u.height);if(p=e.data,r)for(a=0;a<r.length;a++)r[a]?p[4*a+3]=255:p[4*a+3]=0;z.ctx.putImageData(e,0,0);n.resolve(null)},u.onerror=function(){n.reject("cannot load image")},n},_getFormat:function(g){g=new Uint8Array(g,0,10);var m="error";return 255===g[0]&&216===g[1]?m="jpeg":137===g[0]&&80===g[1]&&78===g[2]&&71===g[3]&&(m="png"),m},_getMask:function(m,t){var r;try{if(!g)throw"The zlib decoder module is not loaded.";var n=0,w=0,a=Math.round(m.length/2);1==a%
2&&(a+=1);for(var k=m.length-2,n=a;n<k&&(255!==m[n]||217!==m[n+1]);n++);a=n+=2;if(a<m.length-1){var e=(new g(m.subarray(a))).getBytes();r=new Uint8Array(t.width*t.height);for(n=m=0;n<e.length;n++)for(w=7;0<=w;w--)r[m++]=e[n]>>w&1}}catch(p){}return r},_loadRasterFormatModule:function(){10>x("ie")||B(["./Zlib"],function(m){g=m})}})})},"esri/tasks/ImageServiceIdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./ImageServiceIdentifyResult".split(" "),
function(B,m,y,x,g,w,t,r){B=B(t,{declaredClass:"esri.tasks.ImageServiceIdentifyTask",constructor:function(g){this._url.path+="/identify";this._handler=m.hitch(this,this._handler)},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(g,m,a,k,e){try{var p=new r(g);this._successHandler([p],"onComplete",a,e)}catch(u){this._errorHandler(u,k,e)}},execute:function(n,r,a,k){var e=k.assembly;n=this._encode(m.mixin({},this._url.query,{f:"json"},n.toJson(e&&e[0])));var p=this._handler,
u=this._errorHandler;return g({url:this._url.path,content:n,callbackParamName:"callback",load:function(e,g){p(e,g,r,a,k.dfd)},error:function(e){u(e,a,k.dfd)}})},onComplete:function(){}});return w._createWrappers(B),y("extend-esri")&&m.setObject("tasks.ImageServiceIdentifyTask",B,x),B})},"esri/tasks/ImageServiceIdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/jsonUtils ./FeatureSet".split(" "),function(B,m,y,x,g,w){B=B(null,{declaredClass:"esri.tasks.ImageServiceIdentifyResult",
constructor:function(m){m.catalogItems&&(this.catalogItems=new w(m.catalogItems));m.location&&(this.location=g.fromJson(m.location));this.catalogItemVisibilities=m.catalogItemVisibilities;this.name=m.name;this.objectId=m.objectId;this.value=m.value;this.processedValues=m.processedValues;this.properties=m.properties}});return y("extend-esri")&&m.setObject("tasks.ImageServiceIdentifyResult",B,x),B})},"esri/tasks/ImageServiceIdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
function(B,m,y,x,g,w,t,r){B=B(null,{declaredClass:"esri.tasks.ImageServiceIdentifyParameters",geometry:null,mosaicRule:null,renderingRule:null,renderingRules:null,pixelSizeX:null,pixelSizeY:null,pixelSize:null,returnGeometry:!1,returnCatalogItems:!0,timeExtent:null,maxItemCount:null,returnPixelValues:!0,toJson:function(g){var n=g&&g.geometry||this.geometry;g={geometry:n,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,mosaicRule:this.mosaicRule?y.toJson(this.mosaicRule.toJson()):
null,renderingRule:this.renderingRule?y.toJson(this.renderingRule.toJson()):null};n&&(g.geometryType=r.getJsonType(n));n=this.timeExtent;return g.time=n?n.toJson().join(","):null,t.isDefined(this.pixelSizeX)&&t.isDefined(this.pixelSizeY)?g.pixelSize=y.toJson({x:parseFloat(this.pixelSizeX),y:parseFloat(this.pixelSizeY)}):this.pixelSize&&(g.pixelSize=this.pixelSize?y.toJson(this.pixelSize.toJson()):null),this.renderingRules&&(g.renderingRules=y.toJson(x.map(this.renderingRules,function(a){return a.toJson()}))),
t.isDefined(this.returnPixelValues)&&(g.returnPixelValues=this.returnPixelValues),t.isDefined(this.maxItemCount)&&(g.maxItemCount=this.maxItemCount),g}});return g("extend-esri")&&m.setObject("tasks.ImageServiceIdentifyParameters",B,w),B})},"esri/layers/pixelFilters/StretchFilter":function(){define(["dojo/_base/declare","dojo/_base/lang","../PixelBlock"],function(B,m,y){var x;return B(null,{stretchType:0,min:0,max:255,numberOfStandardDeviations:2,statistics:null,histograms:null,dra:!1,minPercent:.25,
maxPercent:.5,useGamma:!1,gamma:null,raster:null,outputPixelType:"U8",computeGamma:!1,constructor:function(g){this.stretchType=g.stretchType||g.StretchType||this.stretchType;this.min=g.min||g.Min||this.min;this.max=g.max||g.Max||this.max;this.numberOfStandardDeviations=g.numberOfStandardDeviations||g.NumberOfStandardDeviations||this.numberOfStandardDeviations;this.statistics=g.statistics||g.Statistics||this.statistics;this.dra=g.dra||g.DRA||g.dRA||this.dra;this.minPercent=g.minPercent||g.MinPercent||
this.minPercent;this.maxPercent=g.maxPercent||g.MaxPercent||this.maxPercent;this.useGamma=g.useGamma||g.UseGamma||this.useGamma;this.gamma=g.gamma||g.Gamma||this.gamma;this.computeGamma=g.computeGamma||g.ComputeGamma||this.computeGamma;this.raster=g.raster||g.Raster||this.raster;this.outputPixelType=g.outputPixelType||g.OutputPixelType||this.outputPixelType;this.raster=g.raster||g.Raster||this.raster;x=this},filter:function(g){if(null!==g&&null!==g.pixelBlock&&null!==g.pixelBlock.pixels){var m,t;
t=g.pixelBlock;var r=t.pixels,n=t.width*t.height,A=r.length;m=6===x.stretchType||3===x.stretchType&&x.dra;if(m&&x._calculateStatisticsHistograms(g),x.dra)if(m)x._statistics=t.statistics,x._histograms=t.histograms;else{var a=t.statistics;x._statistics=[];for(m=0;m<A;m++)x._statistics[m]=[a[m].minValue,a[m].maxValue,0,0]}else x._statistics=x.statistics,x._histograms=x.histograms;if(x.computeGamma&&(x.gamma=x._computeGammaValues(t.pixelType),x.useGamma=!0),x._createLUT(g),void 0===x.LUT||null===x.LUT)return x._filterNoLUT(g);
var k,e=x.LUT,p=x.LUTOffset;for(m=0;m<A;m++)for(k=e[m],t=0;t<n;t++)a=r[m][t],r[m][t]=k[a-p];return g.pixelBlock.pixelType="U8",g}},_calculateStatisticsHistograms:function(g){var w,t,r,n,A,a,k,e,p,u=g.pixelBlock,z=u.pixelType,x=u.pixels,y=u.mask,B=x.length,P=function(a){this.min=-.5;this.max=255.5;this.size=256;m.mixin(this,a);this.counts=this.counts||new Uint32Array(this.size)},K=[];for(g=0;g<B;g++){if(A=new P,a=A.counts,e=x[g],"U8"===z)if(y)for(n=0;n<u.width*u.height;n++)y[n]&&a[e[n]]++;else for(n=
0;n<u.width*u.height;n++)a[e[n]]++;else{if(w=u.statistics[g].minValue,t=u.statistics[g].maxValue,A.min=w,A.max=t,r=(t-w)/256,k=new Uint32Array(257),y)for(n=0;n<u.width*u.height;n++)y[n]&&k[Math.floor((e[n]-w)/r)]++;else for(n=0;n<u.width*u.height;n++)k[Math.floor((e[n]-w)/r)]++;for(n=0;255>n;n++)a[n]=k[n];a[255]=k[255]+k[256]}K.push(A);r=[];w=u.statistics[g].minValue;t=u.statistics[g].maxValue;for(n=e=p=k=0;n<A.size;n++)k+=a[n],p+=n*a[n];p/=k;for(n=0;n<A.size;n++)e+=a[n]*Math.pow(n-p,2);a=Math.sqrt(e/
(k-1));n=(p+.5)*(A.max-A.min)/A.size+A.min;a=a*(A.max-A.min)/A.size;r.push(w);r.push(t);r.push(n);r.push(a);u.statistics[g]=r}u.histograms=K},_getCutOffPoints:function(g){var m,t,r,n,A,a=g.pixelBlock.pixels.length,k=[],e=[];switch(x.stretchType){case 5:for(n=0;n<a;n++)k[n]=x._statistics[n][0],e[n]=x._statistics[n][1];break;case 3:for(n=0;n<a;n++)k[n]=x._statistics[n][2]-x.numberOfStandardDeviations*x._statistics[n][3],e[n]=x._statistics[n][2]+x.numberOfStandardDeviations*x._statistics[n][3],k[n]<
x._statistics[n][0]&&(k[n]=x._statistics[n][0]),e[n]>x._statistics[n][1]&&(e[n]=x._statistics[n][1]);break;case 6:for(n=0;n<a;n++){g=x._histograms[n];r=new Uint32Array(g.size);t=g.counts;for(A=m=0;A<g.size;A++)m+=t[A],r[A]=m;t=x.minPercent*m/100;for(A=1;A<g.size;A++)if(r[A]>t){k[n]=g.min+(g.max-g.min)/g.size*(A-.5);break}t=(1-x.maxPercent/100)*m;for(A=g.size-2;0<=A;A--)if(r[A]<t){e[n]=g.min+(g.max-g.min)/g.size*(A+.5);break}}break;default:for(n=0;n<a;n++)k[n]=0,e[n]=255}return{minCutOff:k,maxCutOff:e}},
_createLUT:function(g){var m=g.pixelBlock,t=m.pixelType;if("U8"===t||"U16"===t||"S8"===t||"S16"===t){if(x._LUTSignature&&(t=x._computeLutSignature(),t.length===x._LUTSignature.length&&!t.some(function(a,e){return a!==x._LUTSignature[e]})))return;var r,n,A,a,t=m.pixels.length,k=[],e=[],p=[],u=x.max,z=x.min,y=x.gamma,B=u-z,L=x._getCutOffPoints(g);g=L.minCutOff;var L=L.maxCutOff,P=0,K=256;"S8"===m.pixelType?P=-127:"S16"===m.pixelType&&(P=-32767);"U16"!==m.pixelType&&"S16"!==m.pixelType||(K=65536);for(m=
0;m<t;m++)k[m]=L[m]-g[m];if(x.useGamma&&null!==y&&y.length===t)for(m=0;m<t;m++)1<y[m]?2<y[m]?p[m]=6.5+Math.pow(y[m]-2,2.5):p[m]=6.5+100*Math.pow(2-y[m],4):p[m]=1;if(x.useGamma)for(var N,m=0;m<t;m++){a=[];for(r=0;r<K;r++)n=r+P,N=(n-g[m])/k[m],A=1,1<y[m]&&(A-=Math.pow(1/B,N*p[m])),n<L[m]&&n>g[m]?a[r]=Math.floor(A*B*Math.pow(N,1/y[m]))+z:n>L[m]?a[r]=u:n<g[m]&&(a[r]=z);e[m]=a}else for(m=0;m<t;m++){a=[];for(r=0;r<K;r++)n=r+P,n<g[m]?a[r]=z:n>L[m]?a[r]=u:a[r]=Math.floor((n-g[m])/k[m]*B)+z;e[m]=a}x.LUT=e;
x.LUTOffset=P;x._LUTSignature=x._computeLutSignature()}},_computeLutSignature:function(){var g,m,t=[];if(t.push(x.stretchType),t.push(x.min),t.push(x.max),t.push(x.numberOfStandardDeviations),x._statistics)for(g=0;g<x._statistics.length;g++)for(m=0;m<x._statistics[g].length;m++)t.push(x._statistics[g][m]);if(t.push(x.dra?1:0),t.push(x.minPercent),t.push(x.maxPercent),x.gamma)for(g=0;g<x._statistics.length;g++)t.push(x.gamma[g]);return t.push(x.useGamma?1:0),t},_filterNoLUT:function(g){if(null!==g&&
null!==g.pixelBlock&&null!==g.pixelBlock.pixels){var m,t,r,n,A,a=g.pixelBlock,k=a.pixels,e=a.mask,a=a.width*a.height,p=k.length,u=[],z=[],y=x.max,B=x.min,L=x.gamma,P=y-B;m=x._getCutOffPoints(g);var K=m.minCutOff,N=m.maxCutOff;for(m=0;m<p;m++)u[m]=N[m]-K[m];if(x.useGamma&&null!==L&&L.length===p)for(m=0;m<p;m++)1<L[m]?2<L[m]?z[m]=6.5+Math.pow(L[m]-2,2.5):z[m]=6.5+100*Math.pow(2-L[m],4):z[m]=1;if(x.useGamma)if(void 0!==e&&null!==e)for(t=0;t<a;t++){if(e[t])for(m=0;m<p;m++)r=k[m][t],A=(r-K[m])/u[m],n=
1,1<L[m]&&(n-=Math.pow(1/P,A*z[m])),r<N[m]&&r>K[m]?k[m][t]=Math.floor(n*P*Math.pow(A,1/L[m]))+B:r>N[m]?k[m][t]=y:r<K[m]&&(k[m][t]=B)}else for(t=0;t<a;t++)for(m=0;m<p;m++)r=k[m][t],A=(r-K[m])/u[m],n=1,1<L[m]&&(n-=Math.pow(1/P,A*z[m])),r<N[m]&&r>K[m]?k[m][t]=Math.floor(n*P*Math.pow(A,1/L[m]))+B:r>N[m]?k[m][t]=y:r<K[m]&&(k[m][t]=B);else if(void 0!==e&&null!==e)for(t=0;t<a;t++){if(e[t])for(m=0;m<p;m++)r=k[m][t],r<N[m]&&r>K[m]?k[m][t]=Math.floor((r-K[m])/u[m]*P)+B:r>N[m]?k[m][t]=y:r<K[m]&&(k[m][t]=B)}else for(t=
0;t<a;t++)for(m=0;m<p;m++)r=k[m][t],r<N[m]&&r>K[m]?k[m][t]=Math.floor((r-K[m])/u[m]*P)+B:r>N[m]?k[m][t]=y:r<K[m]&&(k[m][t]=B);return g.pixelBlock.pixelType="U8",g}},_computeGammaValues:function(g){var m,t,r=this._statistics.length,n=[];for(m=0;m<r;m++)t=this._statistics[m][2],"U8"!==g&&(t=255*(t-this._statistics[m][0])/(this._statistics[m][1]-this._statistics[m][0])),n.push(this._computeGammaValue(t));return n},_computeGammaValue:function(g){if(0!==g&&!(255<g||0>g)){var m=0;0<g&&150!=g&&255>g&&(m=
150>=g?45*Math.cos(.01047*g):17*Math.sin(.021*g));var t=Math.log(g/255);g=Math.log((g+m)/255);if(0!==g&&(t/=g,!isNaN(t)))return Math.min(9.9,Math.max(.01,t))}}})})},"esri/layers/StreamLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/Deferred dojo/has dojo/io-query dojo/on dojo/aspect ../kernel ../request ../graphic ./FeatureLayer ./StreamMode ./StreamTrackManager ../geometry/jsonUtils ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../renderers/SimpleRenderer ./PurgeOptions".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N){B=B([p],{declaredClass:"esri.layers.StreamLayer",_preventInit:!0,constructor:function(a,e){if(e=e||{},e.mode&&e.mode!==p.MODE_STREAM||(this._isStream=!0,this.mode=p.MODE_STREAM,this.currentMode=p.MODE_STREAM,this._mode=new u(this)),this.purgeOptions=new N(this,e.purgeOptions||{}),this.purgeInterval=e.purgeInterval||0,this._reconnectAttempts=0,this.maxReconnectAttempts=10,this._reconnectTimeoutId=null,this.socket=null,this._keepLatestQueried=!1,
this._keepLatestUrl=null,this._relatedQueried=!1,this._relatedUrl=null,this._joinField=null,this._refreshing=!1,this._attemptReconnect=g.hitch(this,this._attemptReconnect),this._purge=g.hitch(this,this._purge),this._processServiceJson=g.hitch(this,this._processServiceJson),g.isObject(a)&&a.layerDefinition)this._initFeatureLayer(a,e);else{var n=this;k({url:a,content:g.mixin({f:"json"}),callbackParamName:"callback"}).then(function(a){n._processServiceJson(a,e)},function(a){n._errorHandler(a)})}},_processServiceJson:function(a,
e){var g=this;a.relatedFeatures&&a.relatedFeatures.featuresUrl&&a.relatedFeatures.joinField?(this._relatedUrl=a.relatedFeatures.featuresUrl,this._joinField=a.relatedFeatures.joinField,this.objectIdField=this._joinField,k({url:this._relatedUrl,content:{f:"json"},callbackParamName:"callback"}).then(function(k){k=k.fields||[];var p=y.map(a.fields,function(a){return a.name.toLowerCase()});y.forEach(k,function(e){-1===y.indexOf(p,e.name.toLowerCase())&&a.fields.push(e)});e.resourceInfo=a;g._initFeatureLayer(g._url,
e)},function(a){g.onError({error:a})})):(e.resourceInfo=a,this._initFeatureLayer(this._url,e))},_initLayer:function(a,e){if(this.inherited(arguments),a){var k;if(a.layerDefinition)this.purgeOptions=new N(this,this._params.purgeOptions||{}),this.socketUrl=this._params.socketUrl||a.layerDefinition.socketUrl||void 0;else{if(this._params.socketUrl)this.socketUrl=this._params.socketUrl;else{var g,p=this._getWebsocketConnectionInfo(a),n=p.urls;n&&n.length?(this._socketUrls=n,this.socketUrl=n[0],this.socketDirection=
"broadcast"===this._params.socketDirection?"broadcast":"subscribe",this.socketUrl+="/"+this.socketDirection,this._websocketToken=p.token,n.length>this.maxReconnectAttempts&&(this.maxReconnectAttempts=n.length)):(this.socketUrl=void 0,g="No web socket urls were retrieved from the Stream Service. Layer will not attempt to connect.","https:"===location.protocol&&(g+=" An insecure web socket connection cannot be made from a secure web page."),this.onError(Error(g)))}if(this._params.filter)try{this._filter=
k=this._makeFilter(this._params.filter)}catch(S){this.onError(Error("Error trying to create filter object: "+S+". Layer will not have filter applied")),this._filter=null}if(this._params.geometryDefinition||this._outFields||this._defnExpr){k=k||{};k.geometry=this._params.geometryDefinition;k.outFields=this._outFields;k.where=this._defnExpr;try{this._filter=k=this._makeFilter(k)}catch(S){this.onError(Error("Error trying to create filter object: "+S+". Layer will not have filter applied")),this._filter=
null}}}this.maximumTrackPoints=this._params.maximumTrackPoints||0===this._params.maximumTrackPoints?this._params.maximumTrackPoints:1;(this._params.refreshRate||0===this._params.refreshRate)&&this._mode&&this._mode._setRefreshRate&&this._mode._setRefreshRate(this._params.refreshRate);this._keepLatestUrl=a.keepLatestArchive?a.keepLatestArchive.featuresUrl:null;a.relatedFeatures&&a.relatedFeatures.featuresUrl&&a.relatedFeatures.joinField&&(this._relatedUrl=a.relatedFeatures.featuresUrl,this._joinField=
a.relatedFeatures.joinField,this.objectIdField=this._joinField);this.objectIdField||this._makeObjectIdField();this._map&&this.socketUrl&&!this._connected&&this.connect()}},_isWebGLCompatible:function(){return!1},_setMap:function(a){var e=this.inherited(arguments),k=this._getRenderer();return this.timeInfo&&(this._trackIdField||k&&(k.latestObservationRenderer||k.trackRenderer))&&(this._trackManager=new z(this),this._trackManager.initialize(a)),this.socketUrl&&!this._connected&&this._map&&this.connect(),
e},_unsetMap:function(a,e){y.forEach(this._connects,m.disconnect);(this._connected||this._reconnecting||this.socket)&&this.disconnect();this._togglePurgeT();this.inherited(arguments);this._map=null},_suspend:function(){this._togglePurgeT();this.inherited(arguments)},_resume:function(){this.inherited(arguments);this._togglePurgeT(!0)},clear:function(){try{this._mode&&this._mode._clearDrawBuffer&&this._mode._clearDrawBuffer(),this._mode&&this._mode._clearTimeBin&&this._mode._clearTimeBin(),this._mode&&
this._mode._clearFeatureMap&&this._mode._clearFeatureMap(),this._trackManager&&this._trackManager.clearTracks()}catch(C){}this.inherited(arguments);this._trackManager&&this._trackManager.createTracklineContainer()},redraw:function(){this._mode&&this._mode._flushDrawBuffer&&this._mode._flushDrawBuffer();this.inherited(arguments)},setDefinitionExpression:function(a){this.setFilter({where:a})},getDefinitionExpression:function(){var a;return this._filter&&(a=this._filter.where),a},destroy:function(){this.disconnect();
this.inherited(arguments)},onResume:function(a){this.inherited(arguments)},setGeometryDefinition:function(a){this.setFilter({geometry:a})},getGeometryDefinition:function(){var a;return this._filter&&(a=this._filter.geometry),a},connect:function(a){var e,k,g,p=new w,n={},m=this._filter,u=this.socketUrl;try{this._connected||this._connecting?p.reject(Error("Cannot start new connection process. Layer is connecting.")):(this._connecting=!0,this._getRelatedFeatures().then(function(){return this._getKeepLatestFeatures()}.bind(this)).then(function(){if(this._websocketToken&&
(n.token=this._websocketToken),this._map&&this._map.spatialReference&&this.spatialReference&&this._map.spatialReference.wkid!==this.spatialReference.wkid&&(n.outSR=this._map.spatialReference.wkid),m)for(k in m)null!==m[k]&&(e="geometry"===k?JSON.stringify(m[k]):m[k],n[k]=e);u+="?"+r.objectToQuery(n);g=this._createConnection(u,a);p.resolve(g)}.bind(this)).otherwise(function(a){p.reject(a)}))}catch(X){a&&(a(X,!1),p.reject(X)),this.onConnectionError({error:X})}return p.promise},disconnect:function(a){var e=
this._refreshing?"Disconnecting as part of layer refresh cycle":"Connection closed from client",k=!!this._refreshing;this._reconnectTimeoutId&&clearTimeout(this._reconnectTimeoutId);this._refreshing=this._reconnecting=this._connecting=this._connected=!1;this.socket&&this.socket.close();this.onDisconnect({willReconnect:k,message:e});a&&a(null,!0)},setFilter:function(a){var e,k,g;if(this._collection)return this.onError("Filter can only be set when the source of the layer is a Stream Service"),!1;try{if(void 0!==
a.outFields)return g=Error("Outfields property cannot be changed after layer is created"),this.onFilterChange({filter:this.getFilter(),error:g}),!1;e=this._makeFilter(a)}catch(Q){return g=Error(Q),this.onFilterChange({filter:this.getFilter(),error:g}),!1}return this.socket?(k={filter:e},this.socket.send(JSON.stringify(k))):n.once(this,"connect",function(a){this.setFilter(e)}),!0},getFilter:function(){var a=this._filter,e={},k=["geometry","outFields","where"];return a&&y.forEach(k,function(k){var g=
a[k];g&&("geometry"===k?g=M.fromJson(g):"outFields"===k&&(g=g.split(",")),e[k]=g)}),e},setMaximumTrackPoints:function(a){if(!a&&0!==a)return!1;this.maximumTrackPoints=a;this._mode.propertyChangeHandler(3)},getUniqueValues:function(a){var e,k,g={},p=[];return(e=this._getField(a,!0))?(a=e.name,k=this.graphics||[],y.forEach(k,function(e){e=(e.attributes||{})[a];void 0!==e&&(g[e]||(g[e]=1,p.push(e)))}),p.sort(function(a,e){return a<e?-1:a>e?1:0}),p):p},getLatestObservations:function(){return this._trackManager?
this._trackManager.getLatestObservations():this.graphics},setPurgeInterval:function(a){var e=this.purgeInterval;return this.purgeInterval=a,this._togglePurgeT(),a&&this._togglePurgeT(!0),e!==a&&this.onPurgeIntervalChange(),this},_togglePurgeT:function(a){if(a&&this.purgeInterval){var e=this;clearTimeout(this._purgeT);this._mode&&this._mode._flushDrawBuffer&&(this._purgeT=setTimeout(function(){e.updating||e.suspended||(e._mode._flushDrawBuffer(),e._togglePurgeT(!0))},6E4*this.purgeInterval))}else this._purgeT&&
(clearTimeout(this._purgeT),this._purgeT=null)},onMessage:function(){},onConnect:function(){},onDisconnect:function(){},onFilterChange:function(){},onAttemptReconnect:function(){},onConnectionError:function(){},onPurgeIntervalChange:function(){},_createConnection:function(a,e){var k=this,g=new WebSocket(a);return g.onopen=function(){k.socket=g;k._connected=!0;k._connecting=!1;k._reconnecting=!1;k._reconnectAttempts=0;k._bind();k.onConnect();e&&e(null,!0)},g.onclose=function(a){var e,g=!0,p=k._connected,
n=null;k._connected||k._reconnecting?(a.code&&(e="Connection failed: ",1001===a.code?(e+=a.reason||"Service is going away.",g=!1):4400===a.code?(e+=a.reason||"Invalid url parameters. Check filter properties.",g=!1):4404===a.code?(e+="Service not found",g=!1):4401!==a.code&&4403!==a.code||(e+="Not authorized",g=!1)),g&&(k._reconnectAttempts+=1,k._reconnectAttempts>k.maxReconnectAttempts&&(e="Maximum reconnect attempts exceeded",g=!1,p=!0)),k._connected=!1,p&&(e&&(n=Error(e)),k.onDisconnect({error:n,
willReconnect:g})),g?k._attemptReconnect():k.socket=null):(k.socket||(n=Error("Could not make connection to service"),k.onConnectionError({error:n})),k.socket=null,k._connected=!1)},g.onerror=function(a){console.log("Socket error")},g},_getKeepLatestFeatures:function(){var a=new w;return this._map&&this._keepLatestUrl&&!this._keepLatestQueried&&this._mode._fetchArchive?this._mode._fetchArchive(this._keepLatestUrl).then(function(){a.resolve()}.bind(this)).otherwise(function(e){a.reject(e)}).always(function(){this._keepLatestQueried=
!0}.bind(this)):a.resolve(),a.promise},_getRelatedFeatures:function(){var a=new w;return this._map&&this._relatedUrl&&!this._relatedQueried&&this._mode._fetchArchive?this._mode._fetchArchive(this._relatedUrl).then(function(){a.resolve()}.bind(this)).otherwise(function(e){a.reject(e)}).always(function(){this._relatedQueried=!0}.bind(this)):a.resolve(),a.promise},_purge:function(){var a,e,k=[];if(this.purgeOptions.displayCount&&this.graphics.length>this.purgeOptions.displayCount)for(a=0;a<this.graphics.length-
this.purgeOptions.displayCount;a++)e=this.graphics[a],k.push(e);0<k.length&&(this._mode._removeFeatures(k),this._trackManager&&this._trackManager.removeFeatures(k))},_bind:function(){var a=this;this.socket.onmessage=function(e){a._onMessage(JSON.parse(e.data))}},_onMessage:function(a){var e=this;this.onMessage(a);var k={create:function(a){e._create(a)},update:function(a){e._update(a)},delete:function(a){e._delete(a)}};a.type?k[a.type](a.feature):a.hasOwnProperty("filter")?e._handleFilterMessage(a):
this._create(a)},_create:function(a){function k(a){if(!g._featureHasOID(a,p)){if(!a.geometry)return!1;a.attributes=a.attributes||{};a.attributes[p]=g._nextId++}a=a.declaredClass?a:new e(a);g._mode.drawFeature(a)}var g=this,p=g.objectIdField;a.length?a.forEach(function(a){a&&k(a)}):a&&k(a)},_delete:function(a){var e=this,k=a[e.objectIdField]||a.attributes[e.objectIdField],g=!1;this.graphics.forEach(function(a){a.attributes[e.objectIdField]==k&&(g=a)});g&&this.remove(g)},_update:function(a){var e=this,
k=!1;this.graphics.forEach(function(g){g.attributes[e.objectIdField]==a.attributes[e.objectIdField]&&(k=g)});k&&(a.attributes&&k.setAttributes(a.attributes),a.geometry&&k.setGeometry(M.fromJson(a.geometry)))},_makeFilter:function(a){var e,k,g,p=null;if(a=a||{},void 0!==a.geometry)if(p=p||{},null===a.geometry)p.geometry=null;else{if(!(e="string"==typeof a.geometry?M.fromJson(JSON.parse(a.geometry)):a.geometry.declaredClass?a.geometry:M.fromJson(a.geometry))||"point"===e.type)throw"Query object contains invalid geometry";
if("extent"!==e.type&&(e=e.getExtent()),!e||0===e.getHeight()&&0===e.getWidth())throw"Invalid filter geometry: Extent cannot have a height and width of 0";p.spatialRel="esriSpatialRelIntersects";p.geometryType="esriGeometryEnvelope";p.geometry=e.toJson()}if(void 0!==a.where&&(p=p||{},p.where=a.where),void 0!==a.outFields&&(p=p||{},k="string"==typeof a.outFields?"*"===a.outFields?null:a.outFields.replace(/,\s+/g,",").split(","):null===a.outFields?null:a.outFields,g=this._makeOutFields(k))){if(g.errors&&
0<g.errors.length)throw"Invalid filter outFields. "+g.errors.join(",");p.outFields=g.fields?g.fields.join(","):null}return p},_makeOutFields:function(a){var e,k=this,g=[],p=[],n={fields:null};return a&&0!==a.length?(y.forEach(a,function(a){if("*"===a)return n;var e=k._getField(a,!0);e?g.push(e.name):p.push("Field named "+a+" not found in schema.")}),e=k._getOutFields(),y.forEach(e,function(a){k._getField(a)&&-1===y.indexOf(g,a)&&g.push(a)}),n.fields=g,n.errors=p,n):n},_handleFilterMessage:function(a){var e,
k;a.error?(k=Error(a.error.join(",")),this.onFilterChange({filter:this.getFilter(),error:k})):(e=a.filter,e.geometry&&"string"==typeof e.geometry&&(e.geometry=JSON.parse(e.geometry)),this._filter=e,this.onFilterChange({filter:this.getFilter()}))},_getWebsocketConnectionInfo:function(a){var e,k,g,p,n={urls:[]},m=[],r=[];if(a.streamUrls&&y.forEach(a.streamUrls,function(a){"ws"===a.transport&&(e=a.urls,n.token=a.token)}),!e)return n;if(y.forEach(e,function(a){0===a.lastIndexOf("wss",0)?r.push(a):m.push(a)}),
k="https:"===location.protocol||0===this.url.lastIndexOf("https:",0)?r:0===m.length?r:m,1<k.length)for(a=0;a<k.length-1;a++)g=a+Math.floor(Math.random()*(k.length-a)),p=k[g],k[g]=k[a],k[a]=p;return n.urls=k,n},_attemptReconnect:function(){var a,e,k,g=this;return this._reconnectTimeoutId=null,g._connected=!1,!!g._socketUrls&&(!g._collection&&!g._reconnecting&&g.socket&&g.credential?(g._reconnecting=!0,g._getServiceConnectionMetadata(g._attemptReconnect),!1):(g._reconnecting=!0,g.socket=null,g._reconnectAttempts>
g.maxReconnectAttempts?(g._reconnecting=!1,!1):(a=g._reconnectAttempts>g._socketUrls.length-1?g._reconnectAttempts%g._socketUrls.length:g._reconnectAttempts,g.socketUrl=g._socketUrls[a],g.socketUrl+="/"+g.socketDirection,k=g._randomIntFromInterval(0,1E3),e=1E3*g._reconnectAttempts+k,void(this._reconnectTimeoutId=setTimeout(function(){g.onAttemptReconnect({count:g._reconnectAttempts,url:g.socketUrl});g.connect()},e)))))},_getServiceConnectionMetadata:function(a){var e=this,p=e._url.path;a="function"==
typeof a?a:null;k({url:p,content:g.mixin({f:"json"},this._url.query),callbackParamName:"callback"}).then(function(k){k=e._getWebsocketConnectionInfo(k);e._websocketToken=k.token;a&&a()},function(a){e.onError(Error(a))})},_setDefaultRenderer:function(){var a,e=this.geometryType,k=new x([5,112,176,.8]),g=new x([255,255,255]),p=new L(L.STYLE_SOLID,g,1);"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?a=new P(P.STYLE_CIRCLE,10,p,k):"esriGeometryPolyline"===e?a=new L(L.STYLE_SOLID,k,2):"esriGeometryPolygon"!==
e&&"esriGeometryEnvelope"!==e||(k=new x([5,112,176,.2]),g=new x([5,112,176,.8]),p=new L(L.STYLE_SOLID,g,1),a=new I(I.STYLE_SOLID,p,k));a&&this.setRenderer(new K(a))},_makeObjectIdField:function(){var a,e,k=1,g=[];if(!this.objectIdField){a=this.fields.length;for(e=0;e<a;e++)g.push(this.fields[e].name.toLowerCase());for(;-1!==y.indexOf(g,"objectid_"+k);)k+=1;this.objectIdField="objectid_"+k;this.fields.push({name:"objectid_"+k,type:"esriFieldTypeOID",alias:"objectid_"+k,nullable:!1})}},_featureHasOID:function(a,
e){return a.attributes&&(a.attributes[e]||0===a.attributes[e])},_randomIntFromInterval:function(a,e){return Math.floor(Math.random()*(e-a+1)+a)}});return t("extend-esri")&&g.setObject("layers.StreamLayer",B,a),B})},"esri/layers/StreamTrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Point ../geometry/Polyline ./TrackManager".split(" "),function(B,m,y,x,g,w,t,r,n){B=B([n],{declaredClass:"esri.layers._StreamTrackManager",constructor:function(g){this.inherited(arguments);
var a=g.getMap().spatialReference;this.isWebMercator=a.isWebMercator();this.canWrap=a._isWrappable();this.wrapThreshold=this.isWebMercator?2.0037508342788905E7:180},initialize:function(g){this.inherited(arguments)},addFeatures:function(g,a){var k,e,p,n,m,r,t={},A={};if(a)return this.inherited(arguments),t;k=this.trackMap;e=this.layer;p=e._trackIdField;n=e.maximumTrackPoints||0;y.forEach(g,function(a){var e=a.attributes[p];a.visible&&(A[e]||(A[e]=[]),A[e].push(a))});for(r in A)A.hasOwnProperty(r)&&
(m=function(a,e){var g,p,m;k[a]||(k[a]=[]);a=k[a];0<n&&(e.length>n&&e.splice(0,e.length-n),(p=e.length+a.length)>n&&(g=a.splice(0,p-n)));p=e.length;for(m=0;m<p;m+=1)a.push(e[m]);return{deletes:g,adds:e}}(r,A[r]),t[r]=m);return t},removeFeatures:function(g){var a=[],k=this.layer.objectIdField,e=this.layer._trackIdField;g&&(g.length,y.forEach(g,function(g){var p,n,m,r;if(n=g.attributes[e],p=g.attributes[k],m=this.trackMap[n])for(g=0;g<m.length;g+=1)if(r=m[g],r.attributes[k]===p){this.trackMap[n].splice(g,
1);-1===y.indexOf(n)&&a.push(n);break}},this),0<g.length&&this.refreshTracks(a))},drawTracks:function(g){function a(a){var g=k[a],n=g&&1<g.length,u=m.trackLineMap[a];if(u&&!n&&(A.remove(u),delete m.trackLineMap[a],u=null),!n)return!1;for(var z,x,n=[],y=[],B=g.length,M=0;M<B;M++)if(x=g[M].geometry){x=x.normalize();var I=x.x,T=0,S=!1;z&&m.canWrap&&(T=I-z.x,Math.abs(T)>m.wrapThreshold&&(S=!0));S?(y.push([m.getWrappedX(I),x.y]),n.push(y.slice(0)),y=[[I,x.y]]):y.push([I,x.y]);z=new t(I,x.y,e)}1<y.length&&
n.push(y);g={};if(g[p]=a,n.length)if(u){for(var U=u.geometry;U.paths.length;)U.removePath(U.paths.length-1);n.forEach(function(a){U.addPath(a)});u.setGeometry(U)}else u=new w(new r({paths:n,spatialReference:e}),null,g),A.add(u),m.trackLineMap[a]=u}var k,e,p,n,m=this,A=this.container;if(A)if(k=this.trackMap,e=this.map.spatialReference,p=this.layer._trackIdField,g)y.forEach(g,function(e){a(e)});else for(n in k)k.hasOwnProperty(n)&&a(n)},refreshTracks:function(g){function a(a){var k,g;a=e[a]||[];k=a.length;
for(g=0;g<k;g++)p._repaint(a[g],null,!0)}var k,e=this.trackMap,p=this.layer;if(this.drawTracks(g),g)y.forEach(g,function(e){a(e)});else for(k in e)e.hasOwnProperty(k)&&a(k)},getLatestObservations:function(){var g,a,k=this.trackMap,e=[];for(g in k)k.hasOwnProperty(g)&&(a=k[g],e.push(a[a.length-1]));return e},destroy:function(){this.inherited(arguments);this.trackLineMap=null},getWrappedX:function(g){var a=this.isWebMercator,k=a?2.0037508342788905E7:180,a=a?-2.0037508342788905E7:-180;return(0<g?a:k)-
((0<g?k:a)-g)}});return x("extend-esri")&&m.setObject("layers._StreamTrackManager",B,g),B})},"esri/layers/PurgeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Stateful","dojo/has","../kernel"],function(B,m,y,x,g){B=B([y],{declaredClass:"esri.layers.PurgeOptions",constructor:function(g,m){this.parent=g;for(var r in m)this[r]=m[r]},_displayCountSetter:function(g){this.displayCount=g;this.parent.refresh()}});return x("extend-esri")&&m.setObject("layers.PurgeOptions",B,g),B})},
"esri/layers/ArcGISImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),function(B,m,y,x,g,w,t){B=B([w,t],{declaredClass:"esri.layers.ArcGISImageServiceLayer",constructor:function(g,n){this._initialize(g,n);this.useMapImage=n&&n.useMapImage||!1},refresh:function(g){if(g)this.inherited(arguments);else{var n=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=
n}},setRenderer:function(g,n){this.renderer=g;this.onRendererChange();n||this.refresh(!0)},exportMapImage:function(r,n){var t=g.defaults.map;r=m.mixin({size:t.width+","+t.height},this._params,r?r.toJson(this.normalization):{},{f:"json"});delete r._ts;this._exportMapImage(this._url.path+"/exportImage",r,n)}});return y("extend-esri")&&m.setObject("layers.ArcGISImageServiceLayer",B,x),B})},"esri/layers/ArcGISImageServiceVectorLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/sniff ../kernel ../lang ./GraphicsLayer ./ImageServiceLayerMixin ../renderers/VectorFieldRenderer ../geometry/Point ../geometry/Extent ../graphic dojox/gfx".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p){B=B([r,n],{declaredClass:"esri.layers.ArcGISImageServiceVectorLayer",constructor:function(a,e){this.symbolTileSize=e&&e.symbolTileSize?e.symbolTileSize:50;this._maxMag=this._minMag=null;var k=m.clone(this._params);(delete k.imageServiceParameters,delete k.pixelFilter,delete k.rendererStyle,delete k.symbolTileSize,this._initialize(a,e),this.renderer)||this.setVectorRendererStyle(e&&e.rendererStyle?e.rendererStyle:A.STYLE_SINGLE_ARROW);this.geometryType="esriGeometryPoint";
this.symbolTileSizeUnits="Pixels";m.mixin(this._params,k)},getField:function(a){return this._getField(a,!0)},setVectorRendererStyle:function(a){this.rendererStyle=a;this._updateVectorFieldRenderer();this.useDefaultRenderer=!0},setRenderer:function(){this.useDefaultRenderer=!1;this.inherited(arguments)},getFlowRepresentation:function(){return this._vectorFlowRepresentation},onResume:function(){this.inherited(arguments);this._toggleTime()},onSuspend:function(){this.inherited(arguments);this._toggleTime()},
_refresh:function(a){if(10>g("ie"))return void this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));if(this._map){this.setImageFormat("LERC",!0);a=this.fullExtent&&this.fullExtent.xmin;var e=this.fullExtent&&this.fullExtent.ymax,k=m.clone(this._map.extent),p=1/this.symbolTileSize*this._map.width,p=p?Math.ceil(p):50,n=1/this.symbolTileSize*this._map.height,n=n?Math.ceil(n):Math.ceil((k.ymax-k.ymin)/(k.xmax-k.xmin)*p),r=(k.xmax-k.xmin)/p,u=(k.ymax-k.ymin)/n;
k.xmin=a+Math.floor((k.xmin-a)/r)*r;k.xmax=a+Math.ceil((k.xmax-a)/r)*r;k.ymin=e+Math.floor((k.ymin-e)/u)*u;k.ymax=e+Math.ceil((k.ymax-e)/u)*u;this._requestData(k,p,n)}},_drawPixelData:function(){if(this.clear(),this.pixelData){var g=this.pixelData.pixelBlock,n=this.pixelData.extent,m=this.pixelData.locations,r=t.isDefined(g.mask)&&0<g.mask.length;if(g&&n&&m){if(this.useDefaultRenderer&&this.renderer&&(!t.isDefined(this._minMag)||!t.isDefined(this._maxMag))){var A=this._getServiceMinMaxStats();A?(this._minMag=
A.min,this._maxMag=A.max):(this._minMag=g.statistics[0].minValue,this._maxMag=g.statistics[0].maxValue);var A={type:"sizeInfo",minSize:p.px2pt(.2*this.symbolTileSize),maxSize:p.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},w=[];w.push(A);w.push({type:"colorInfo"});this.renderer.setVisualVariables(w)}for(var y,B,C=w=A=0,J=n.spatialReference?n.spatialReference._getInfo():null,A=0;A<g.height;A++)for(w=0;w<g.width;w++,C++)if(y=m[C],(!r||g.mask[C])&&y&&2===y.length){B=
new a(y[0],y[1],n.spatialReference);J&&(B.x=k.prototype._normalizeX(B.x,J).x);var O={Magnitude:g.pixels[0][C],Direction:g.pixels[1][C],Location:x.toJson(B.toJson())};B=new e(B,null,O);this.add(B)}}}},_getServiceMinMaxStats:function(){if(!t.isDefined(this.minValues)||!t.isDefined(this.maxValues)||2>this.minValues.length||2>this.maxValues.length)return null;var a=this.minValues[0],e=this.maxValues[0],k=this.minValues[1],g=this.maxValues[1];if(this.pixelFilter&&a&&e&&k&&g){var p=[];p.push([a,e]);p.push([k,
g]);k=this._createPixelData(p);this.pixelFilter(k);k&&k.pixelBlock&&k.pixelBlock.pixels&&0<k.pixelBlock.pixels.length&&(a=k.pixelBlock.pixels[0][0],e=k.pixelBlock.pixels[0][1])}return a&&e?{min:a,max:e}:null},_updateVectorFieldRenderer:function(){var a={type:"sizeInfo",minSize:p.px2pt(.2*this.symbolTileSize),maxSize:p.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},e=[];e.push(a);a=new A({style:this.rendererStyle,visualVariables:e,flowRepresentation:this._vectorFlowRepresentation});
this.setRenderer(a)},_getField:function(a,e){if(t.isDefined(a))return(e&&(a=a.toLowerCase()),"magnitude"!==a&&"direction"!==a)?null:{name:a,alias:a,domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"}},_requestDataErrorHandler:function(a){"CancelError"!==a.name&&(this.clear(),this.onError(a))},_setFlowRepresentation:function(a){a&&this.renderer&&t.isDefined(a.FlowDirection)&&(this._vectorFlowRepresentation="oceanographic"===a.FlowDirection.toLowerCase()?this.renderer.FLOW_TO:this.renderer.FLOW_FROM);
this.renderer&&(this.renderer.flowRepresentation=this._vectorFlowRepresentation)}});return g("extend-esri")&&m.setObject("layers.ArcGISImageServiceVectorLayer",B,w),B})},"jimu/LayerInfos/LayerInfoForDefaultTile":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(B,m){return B(m,{constructor:function(m,x){this.isTiled=!0},_initVisible:function(){},_setTopLayerVisible:function(m){},setLayerVisiblefromTopLayer:function(){},getOpacity:function(){},setOpacity:function(m){},
isShowInMap:function(){return this.originOperLayer.mapService.layerInfo.layerObject.visible}})})},"jimu/LayerInfos/LayerInfoForDefaultTable":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred dojo/aspect ./LayerInfoForDefault ./LayerObjectFacory esri/dijit/PopupTemplate".split(" "),function(B,m,y,x,g,w,t,r){return B(w,{_layerObjectFacory:null,constructor:function(){this.newSubLayers=[];this.isTable=!0;this._layerObjectFacory=new t(this)},init:function(){},_getLayerObject:function(){var g=
new x;this._layerObjectFacory.getLayerObject().then(m.hitch(this,function(n){this.layerObject.empty&&n&&(this.layerObject=n,this._bindEventAfterLayerObjectLoaded());g.resolve(n)}));return g},getLayerObject:function(){return this._getLayerObject()},getPopupInfoFromLayerObject:function(){var g=this.getPopupInfo();g||!this.layerObject||this.layerObject.empty||(g=this._getDefaultPopupInfo(this.layerObject));return g},loadPopupInfo:function(){var g=new x,r=this.getPopupInfo();r?g.resolve(r):this.getLayerObject().then(m.hitch(this,
function(){r=this._getDefaultPopupInfo(this.layerObject);g.resolve(r)}));return g},getLayerType:function(){var g=new x;g.resolve("Table");return g},isVisible:function(){return!1},isLeaf:function(){return!0},isRootLayer:function(){return!1},createLegendsNode:function(){return y.create("div",{"class":"legends-div"})},_initControlPopup:function(){this.inherited(arguments);this.controlPopupInfo={enablePopup:this.originOperLayer.popupInfo?!0:!1,infoTemplate:this.originOperLayer.popupInfo?new r(this.originOperLayer.popupInfo):
null}},_bindEventAfterLayerObjectLoaded:function(){var n=g.after(this.layerObject,"setDefinitionExpression",m.hitch(this,this._onFilterChanged));this._eventHandles.push(n)},getFilter:function(){var g;this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?(g=this.layerObject.getDefinitionExpression(),void 0===g&&(g=this.getFilterOfWebmap())):g=this.getFilterOfWebmap();return g}})})},"jimu/LayerInfos/LayerInfoForDefaultImage":function(){define("dojo/_base/declare dojo/dom-construct dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/aspect esri/request ./LayerInfoForDefault".split(" "),
function(B,m,y,x,g,w,t,r,n){return B(n,{constructor:function(){this._addImageServiceLayerType()},_addImageServiceLayerType:function(){this.layerObject.type=!this.layerObject.serviceDataType||"esriImageServiceDataTypeVector-UV"!==this.layerObject.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.layerObject.serviceDataType?"ArcGISImageServiceLayer":"ArcGISImageServiceVectorLayer"},_initLegendsNode:function(g){10.2<=this.layerObject.version?this._legendRequestServer().then(x.hitch(this,
function(a){m.empty(g);y.forEach(a.layers,function(a){y.forEach(a.legend,function(a){if("\x3call other values\x3e"!==a.label){var e=m.create("div",{"class":"legend-div"},g),k=m.create("div",{"class":"legend-symbol jimu-float-leading",style:"width:50px;height:50px;position:relative"},e),n=null,n=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;m.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0",src:n},k);m.create("div",
{"class":"legend-label jimu-float-leading",innerHTML:a.label||" "},e)}},this)},this)}),x.hitch(this,function(){m.empty(g)})):m.empty(g)},_legendRequestServer:function(){var g=this.layerObject.url+"/legend",a={f:"json"};this.layerObject._params.bandIds&&(a.bandIds=this.layerObject._params.bandIds);this.layerObject._params.renderingRule&&(a.renderingRule=this.layerObject._params.renderingRule);return r({url:g,content:a,handleAs:"json",callbackParamName:"callback"})},getSupportTableInfo:function(){var n=
new g,a={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},k=this.getLayerType(),e=this.getLayerObject();w({type:k,layerObject:e}).then(x.hitch(this,function(e){var k=e.type;e=e.layerObject;a.layerType=k;0<=this._getLayerTypesOfSupportTable().indexOf(k)&&(a.isSupportedLayer=!0);e.capabilities&&0<=e.capabilities.indexOf("Catalog")?a.isSupportQuery=!0:a.isSupportedLayer=!1;n.resolve(a)}),function(){n.resolve(a)});return n},_getServiceDefinition:function(){var g=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(g)},
_bindEvent:function(){var g;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(g=t.after(this.layerObject,"setRenderingRule",x.hitch(this,this._onRendererChanged)),this._eventHandles.push(g))}})})},"jimu/LayerInfos/LayerInfoForDefaultStream":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","dojo/promise/all","./LayerInfoForDefault"],function(B,m,y,x,g){return B(g,{getSupportTableInfo:function(){var g=new y,t={isSupportedLayer:!1,isSupportQuery:!0,layerType:null,
otherReasonCanNotSupport:!0},r=this.getLayerType(),n=this.getLayerObject();x({type:r,layerObject:n}).then(m.hitch(this,function(n){var a=n.type;n=n.layerObject;t.layerType=a;0<=this._getLayerTypesOfSupportTable().indexOf(a)&&(t.isSupportedLayer=!0);(a=n.getLatestObservations())&&0<a.length&&(t.otherReasonCanNotSupport=!1);g.resolve(t)}),function(){g.resolve(t)});return g}})})},"jimu/LayerInfos/LayerInfoForDefaultKML":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/dom-construct",
"./LayerInfoForDefault"],function(B,m,y,x){return B(x,{constructor:function(g,m){this.layerObject=g.layerObject},_resetLayerObjectVisiblity:function(){},_initVisible:function(){var g=this.originOperLayer.kml,m=g.layerInfo.originOperLayer.visibleFolders;g.layerInfo.isRootLayer()&&m?-1<m.indexOf(this.subId)?this._visible=!0:this._visible=!1:this._visible=this.originOperLayer.kml.currentFolder.visible},_setTopLayerVisible:function(g){var m=this.originOperLayer.kml.currentFolder;this._visible=g;this.originOperLayer.kml.layerInfo.layerObject.setFolderVisibility(m,
g)},obtainNewSubLayers:function(){var g=[],w=this.originOperLayer.kml;w.currentFolder&&m.forEach(w.layerInfo._getOperLayerByParentFolderId(w.currentFolder.id,this),function(m){m=this._layerInfoFactory.create(m);g.push(m);m.init()},this);return g},getOpacity:function(){},setOpacity:function(g){},drawLegends:function(g){y.empty(g)},_bindEvent:function(){},_onVisibleLayersChanged:function(){},getScaleRange:function(){return this.getRootLayerInfo().getScaleRange()}})})},"jimu/filterUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/date/locale dojo/number esri/lang dojo/data/ItemFileWriteStore jimu/utils moment/moment".split(" "),
function(B,m,y,x,g,w,t,r,n){var A=B([],{_stringFieldType:"esriFieldTypeString",_dateFieldType:"esriFieldTypeDate",_numberFieldTypes:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],_supportFieldTypes:[],dayInMS:86399E3,MinuteInMS:59E3,SecInMS:1E3,fieldsStore:null,isHosted:!1,constructor:function(){String.prototype.startsWith=function(a){return 0===this.indexOf(a)};String.prototype.endsWith=function(a){return this.substring(this.length-
a.length)===a};String.prototype.count=function(a){return this.split(a).length-1};String.prototype.trim||(String.prototype.trim=m.trim);this._supportFieldTypes=[];this._supportFieldTypes.push(this._stringFieldType);this._supportFieldTypes.push(this._dateFieldType);this._supportFieldTypes=this._supportFieldTypes.concat(this._numberFieldTypes)},OPERATORS:{stringOperatorIs:"stringOperatorIs",stringOperatorIsNot:"stringOperatorIsNot",stringOperatorStartsWith:"stringOperatorStartsWith",stringOperatorEndsWith:"stringOperatorEndsWith",
stringOperatorContains:"stringOperatorContains",stringOperatorDoesNotContain:"stringOperatorDoesNotContain",stringOperatorIsAnyOf:"stringOperatorIsAnyOf",stringOperatorIsNoneOf:"stringOperatorIsNoneOf",stringOperatorIsBlank:"stringOperatorIsBlank",stringOperatorIsNotBlank:"stringOperatorIsNotBlank",numberOperatorIs:"numberOperatorIs",numberOperatorIsNot:"numberOperatorIsNot",numberOperatorIsAtLeast:"numberOperatorIsAtLeast",numberOperatorIsLessThan:"numberOperatorIsLessThan",numberOperatorIsAtMost:"numberOperatorIsAtMost",
numberOperatorIsGreaterThan:"numberOperatorIsGreaterThan",numberOperatorIsBetween:"numberOperatorIsBetween",numberOperatorIsNotBetween:"numberOperatorIsNotBetween",numberOperatorIsAnyOf:"numberOperatorIsAnyOf",numberOperatorIsNoneOf:"numberOperatorIsNoneOf",numberOperatorIsBlank:"numberOperatorIsBlank",numberOperatorIsNotBlank:"numberOperatorIsNotBlank",dateOperatorIsOn:"dateOperatorIsOn",dateOperatorIsNotOn:"dateOperatorIsNotOn",dateOperatorIsBefore:"dateOperatorIsBefore",dateOperatorIsAfter:"dateOperatorIsAfter",
dateOperatorIsOnOrBefore:"dateOperatorIsOnOrBefore",dateOperatorIsOnOrAfter:"dateOperatorIsOnOrAfter",dateOperatorIsBetween:"dateOperatorIsBetween",dateOperatorIsNotBetween:"dateOperatorIsNotBetween",dateOperatorIsBlank:"dateOperatorIsBlank",dateOperatorIsNotBlank:"dateOperatorIsNotBlank",dateOperatorInTheLast:"dateOperatorInTheLast",dateOperatorNotInTheLast:"dateOperatorNotInTheLast",dateOperatorIsIn:"dateOperatorIsIn",dateOperatorIsNotIn:"dateOperatorIsNotIn",dateOperatorMinutes:"dateOperatorMinutes",
dateOperatorHours:"dateOperatorHours",dateOperatorDays:"dateOperatorDays",dateOperatorWeeks:"dateOperatorWeeks",dateOperatorMonths:"dateOperatorMonths",dateOperatorYears:"dateOperatorYears"},prepare:function(a,k){this.isHosted=r.isHostedService(a);k=k||[];this.setFieldsStoreByFieldInfos(k)},isPartsObjHasError:function(a){var k=!1;a&&(k=a.parts&&0<=a.parts.length?y.every(a.parts,m.hitch(this,function(a){return a.parts?0<a.parts.length?y.every(a.parts,m.hitch(this,function(a){return!a.error})):!1:!a.error})):
!1);return!k},isAskForValues:function(a){return A.isAskForValues(a)},hasVirtualDate:function(a){return A.hasVirtualDate(a)},setFieldsStoreByFieldInfos:function(a){a=y.filter(a,m.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)}));a=y.map(a,function(a,e){var k;switch(a.type){case "esriFieldTypeString":k="string";break;case "esriFieldTypeDate":k="date";break;default:k="number"}return{id:e,label:a.name,shortType:k,alias:a.alias,editable:a.editable,name:a.name,nullable:a.nullable,
type:a.type}},this);this.fieldsStore=new t({data:{identifier:"id",label:"label",items:a}});return a.length},_validatePartsObj:function(a){return a&&"object"===typeof a},_isObject:function(a){return a&&"object"===typeof a},_isString:function(a){return a&&"string"===typeof a},containsNonLatinCharacter:function(a){for(var k=0;k<a.length;k++)if(255<a.charCodeAt(k))return!0;return!1},containsNonLatinCharacterBatch:function(a){for(var k=!1,e=0;e<a.length;e++){var g=a[e],g=m.isObject(g)?g.value:g;k||(k=
this.containsNonLatinCharacter(g))}return k},getExprByFilterObj:function(a){if(!y.every(a.parts,function(a){return!!a}))return null;if(!this.isPartsObjReadyToBuild(a))return a.expr="",a.displaySQL="",a.expr;this._handleVirtualDate(a);var k="",e="",g,n;if(0===a.parts.length)e=k="1\x3d1";else if(1===a.parts.length)g=a.parts[0],g.valueObj&&m.isArray(g.valueObj.value)&&"multiple"!==g.valueObj.type?(n=this._checkIfValObjArrayAndChecked(g.valueObj.value))?(k=this.builtFilterString(g),e=g.displaySQL):e=
k="1\x3d1":(k=this.builtFilterString(g),e=g.displaySQL);else for(var r="",t=0;t<a.parts.length;t++){g=a.parts[t];g.valueObj&&m.isArray(g.valueObj.value)&&"multiple"!==g.valueObj.type?(n=this._checkIfValObjArrayAndChecked(g.valueObj.value))?(n=this.builtFilterString(g),g=g.displaySQL):g=n="1\x3d1":(n=this.builtFilterString(g),g=g.displaySQL);if(!w.isDefined(n))return null;k+=r+"("+n+")";e+=r+"("+g+")";r=r||" "+a.logicalOperator+" "}a.expr=k;a.displaySQL=e;return k},_checkIfValObjArrayAndChecked:function(a){var k=
!1,e;for(e in a)if(a[e].isChecked){k=!0;break}return k},_handleVirtualDate:function(a){this.hasVirtualDate(a)&&y.forEach(a.parts,m.hitch(this,function(a){a.parts?y.forEach(a.parts,m.hitch(this,function(a){this._updateRealDateByVirtualDate(a)})):this._updateRealDateByVirtualDate(a)}))},_updateRealDateByVirtualDate:function(a){var k;k=[this.OPERATORS.dateOperatorIsOn,this.OPERATORS.dateOperatorIsNotOn,this.OPERATORS.dateOperatorIsBefore,this.OPERATORS.dateOperatorIsAfter,this.OPERATORS.dateOperatorIsOnOrBefore,
this.OPERATORS.dateOperatorIsOnOrAfter];a.valueObj.virtualDate?a.operator===this.OPERATORS.dateOperatorIsIn||a.operator===this.OPERATORS.dateOperatorIsNotIn?(k=A.getRealDateByVirtualDate(a.valueObj.virtualDate),a.value1=k[0],a.value2=k[1],a.valueObj.value1=k[0].toDateString(),a.valueObj.value2=k[1].toDateString()):-1<k.indexOf(a.operator)&&(k=A.getRealDateByVirtualDate(a.valueObj.virtualDate),a.value=k,a.valueObj.value=k.toDateString()):(a.valueObj.virtualDate1&&(k=A.getRealDateByVirtualDate(a.valueObj.virtualDate1),
a.value1=k,a.valueObj.value1=k.toDateString()),a.valueObj.virtualDate2&&(k=A.getRealDateByVirtualDate(a.valueObj.virtualDate2),a.value2=k,a.valueObj.value2=k.toDateString()))},isPartsObjReadyToBuild:function(a){return y.every(a.parts,m.hitch(this,function(a){return a.parts?y.every(a.parts,m.hitch(this,function(a){return this._isPartReadyToBuild(a)})):this._isPartReadyToBuild(a)}))},_isPartReadyToBuild:function(a){var k=a.fieldObj.shortType,e=a.operator,g=a.valueObj;a=g.type||"value";var n=g.value,
m=g.value1,g=g.value2;if("value"===a){if("string"===k)return e===this.OPERATORS.stringOperatorIsBlank||e===this.OPERATORS.stringOperatorIsNotBlank?!0:r.isNotEmptyString(n);if("number"===k)return e===this.OPERATORS.numberOperatorIsBlank||e===this.OPERATORS.numberOperatorIsNotBlank?!0:e===this.OPERATORS.numberOperatorIsBetween||e===this.OPERATORS.numberOperatorIsNotBetween?r.isValidNumber(m)&&r.isValidNumber(g):r.isValidNumber(n);if("date"===k)return e===this.OPERATORS.dateOperatorIsBlank||e===this.OPERATORS.dateOperatorIsNotBlank?
!0:e===this.OPERATORS.dateOperatorIsBetween||e===this.OPERATORS.dateOperatorIsNotBetween||e===this.OPERATORS.dateOperatorIsIn||e===this.OPERATORS.dateOperatorIsNotIn?r.isNotEmptyString(m)&&r.isNotEmptyString(g):e===this.OPERATORS.dateOperatorInTheLast||e===this.OPERATORS.dateOperatorNotInTheLast?void 0!==n&&null!==n:r.isNotEmptyString(n)}else{if("field"===a)return r.isNotEmptyString(n);if("unique"===a){if("string"===k)return r.isNotEmptyString(n);if("number"===k)return r.isValidNumber(n);if("date"===
k)return r.isValidDate(n)}else if("multiple"===a){if("string"===k)return r.isNotEmptyStringArray(n);if("number"===k)return r.isValidNumberArray(n)}else if("values"!==a&&("uniquePredefined"===a||"multiplePredefined"===a)){if("string"===k)return r.isNotEmptyStringArray(n);if("number"===k)return r.isValidNumberArray(n)}}return!1},builtFilterString:function(a){var k="",e="";if(a.parts)for(var g="",n=0;n<a.parts.length;n++){var m=a.parts[n],r=this.builtSingleFilterString(m);m.expr=r.whereClause;if(!w.isDefined(r.whereClause))return null;
k+=g+r.whereClause;e+=g+m.displaySQL;g=" "+a.logicalOperator+" "}else a&&a.valueObj&&"multiple"===a.valueObj.type&&0===a.valueObj.value.length?k=e="1\x3d1":(k=this.builtSingleFilterString(a).whereClause,e=a.displaySQL);a.expr=k;a.displaySQL=e;return k},_preBuiltSingleFilterString:function(a){if("string"===a.fieldObj.shortType&&"\x3cNull\x3e"===a.valueObj.value){if(a.operator===this.OPERATORS.stringOperatorIs)return{whereClause:a.fieldObj.name+" IS NULL"};if(a.operator===this.OPERATORS.stringOperatorIsNot)return{whereClause:a.fieldObj.name+
" IS NOT NULL"}}if("number"===a.fieldObj.shortType&&"\x3cNull\x3e"===a.valueObj.value){if(a.operator===this.OPERATORS.numberOperatorIs)return{whereClause:a.fieldObj.name+" IS NULL"};if(a.operator===this.OPERATORS.numberOperatorIsNot)return{whereClause:a.fieldObj.name+" IS NOT NULL"}}return null},_handlePrefixStringsForIn:function(a,k){for(var e=[],g=0;g<k.length;g++){var n=k[g],n=n.replace(/\'/g,"''");e.push(n)}return""+a+"'"+e.join("',"+a+"'")+"'"},builtSingleFilterString:function(a,k){this.isHosted&&
(a.caseSensitive=!1);if(w.isDefined(a.valueObj.isValid)&&!a.valueObj.isValid)return{whereClause:null};var e=this._preBuiltSingleFilterString(a);if(e)return e;var g=a.valueObj.value,n=a.valueObj.value1,r=a.valueObj.value2,t=!1;a.interactiveObj&&w.isDefined(k)&&(t=!0,w.isDefined(a.valueObj.value)&&(g="{"+k+"}"),w.isDefined(a.valueObj.value1)&&(n="{"+k+"}"),w.isDefined(a.valueObj.value2)&&(r="{"+(k+1)+"}"));var A=e="",A="",x=[];if("string"===a.fieldObj.shortType){var B="";t&&this.isHosted?B="N":g&&"field"!==
a.valueObj.type&&this.isHosted&&(m.isArray(g)&&this.containsNonLatinCharacterBatch(g)||!m.isArray(g)&&this.containsNonLatinCharacter(g))&&(B="N");if(g&&"multiple"===a.valueObj.type){if(a.operator===this.OPERATORS.stringOperatorIsAnyOf||a.operator===this.OPERATORS.stringOperatorIsNoneOf)g=this._handlePrefixStringsForIn(B,g)}else!g||"multiplePredefined"!==a.valueObj.type&&"uniquePredefined"!==a.valueObj.type||(x=[],y.forEach(g,m.hitch(this,function(a){a.isChecked&&x.push(a.value)})),g=a.operator===
this.OPERATORS.stringOperatorIs||a.operator===this.OPERATORS.stringOperatorIsNot?x[0]:a.operator===this.OPERATORS.stringOperatorIsAnyOf||a.operator===this.OPERATORS.stringOperatorIsNoneOf?this._handlePrefixStringsForIn(B,x):x);var K=[];switch(a.operator){case this.OPERATORS.stringOperatorIs:"field"===a.valueObj.type?e=a.fieldObj.name+" \x3d "+g:"multiple"===a.valueObj.type?(A=g.join("','"),e=a.caseSensitive?a.fieldObj.name+" IN ("+B+"'"+A.replace(/\'/g,"'")+"')":"UPPER("+a.fieldObj.name+") IN ("+
B+"'"+A.replace(/\'/g,"'").toUpperCase()+"')"):e=a.caseSensitive?a.fieldObj.name+" \x3d "+B+"'"+g.replace(/\'/g,"''")+"'":"UPPER("+a.fieldObj.name+") \x3d "+B+"'"+g.replace(/\'/g,"''").toUpperCase()+"'";break;case this.OPERATORS.stringOperatorIsNot:"field"===a.valueObj.type?e=a.fieldObj.name+" \x3c\x3e "+g:"multiple"===a.valueObj.type?(A=g.join("','"),e=a.caseSensitive?a.fieldObj.name+" NOT IN ("+B+"'"+A.replace(/\'/g,"'")+"')":"UPPER("+a.fieldObj.name+") NOT IN ("+B+"'"+A.replace(/\'/g,"'").toUpperCase()+
"')"):e=a.caseSensitive?a.fieldObj.name+" \x3c\x3e "+B+"'"+g.replace(/\'/g,"''")+"'":"UPPER("+a.fieldObj.name+") \x3c\x3e "+B+"'"+g.replace(/\'/g,"''").toUpperCase()+"'";break;case this.OPERATORS.stringOperatorStartsWith:K=[];"multiple"===a.valueObj.type||"multiplePredefined"===a.valueObj.type||"uniquePredefined"===a.valueObj.type?(y.forEach(g,m.hitch(this,function(e){a.caseSensitive?K.push(a.fieldObj.name+" LIKE "+B+"'"+e.replace(/\'/g,"''")+"%'"):K.push("UPPER("+a.fieldObj.name+") LIKE "+B+"'"+
e.replace(/\'/g,"''").toUpperCase()+"%'")})),e="(("+K.join(") or (")+"))"):e=a.caseSensitive?a.fieldObj.name+" LIKE "+B+"'"+g.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") LIKE "+B+"'"+g.replace(/\'/g,"''").toUpperCase()+"%'";break;case this.OPERATORS.stringOperatorEndsWith:K=[];"multiple"===a.valueObj.type||"multiplePredefined"===a.valueObj.type||"uniquePredefined"===a.valueObj.type?(y.forEach(g,m.hitch(this,function(e){a.caseSensitive?K.push(a.fieldObj.name+" LIKE "+B+"'%"+e.replace(/\'/g,
"''")+"'"):K.push("UPPER("+a.fieldObj.name+") LIKE "+B+"'%"+e.replace(/\'/g,"''").toUpperCase()+"'")})),e="(("+K.join(") or (")+"))"):e=a.caseSensitive?a.fieldObj.name+" LIKE "+B+"'%"+g.replace(/\'/g,"''")+"'":"UPPER("+a.fieldObj.name+") LIKE "+B+"'%"+g.replace(/\'/g,"''").toUpperCase()+"'";break;case this.OPERATORS.stringOperatorContains:K=[];"multiple"===a.valueObj.type||"multiplePredefined"===a.valueObj.type||"uniquePredefined"===a.valueObj.type?(y.forEach(g,m.hitch(this,function(e){a.caseSensitive?
K.push(a.fieldObj.name+" LIKE "+B+"'%"+e.replace(/\'/g,"''")+"%'"):K.push("UPPER("+a.fieldObj.name+") LIKE "+B+"'%"+e.replace(/\'/g,"''").toUpperCase()+"%'")})),e="(("+K.join(") or (")+"))"):e=a.caseSensitive?a.fieldObj.name+" LIKE "+B+"'%"+g.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") LIKE "+B+"'%"+g.replace(/\'/g,"''").toUpperCase()+"%'";break;case this.OPERATORS.stringOperatorDoesNotContain:K=[];"multiple"===a.valueObj.type||"multiplePredefined"===a.valueObj.type||"uniquePredefined"===
a.valueObj.type?(y.forEach(g,m.hitch(this,function(e){a.caseSensitive?K.push(a.fieldObj.name+" NOT LIKE "+B+"'%"+e.replace(/\'/g,"''")+"%'"):K.push("UPPER("+a.fieldObj.name+") NOT LIKE "+B+"'%"+e.replace(/\'/g,"''").toUpperCase()+"%'")})),e="(("+K.join(") or (")+"))"):e=a.caseSensitive?a.fieldObj.name+" NOT LIKE "+B+"'%"+g.replace(/\'/g,"''")+"%'":"UPPER("+a.fieldObj.name+") NOT LIKE "+B+"'%"+g.replace(/\'/g,"''").toUpperCase()+"%'";break;case this.OPERATORS.stringOperatorIsAnyOf:e=a.fieldObj.name+
" IN ("+g+")";break;case this.OPERATORS.stringOperatorIsNoneOf:e=a.fieldObj.name+" NOT IN ("+g+")";break;case this.OPERATORS.stringOperatorIsBlank:e=a.fieldObj.name+" IS NULL";break;case this.OPERATORS.stringOperatorIsNotBlank:e=a.fieldObj.name+" IS NOT NULL"}}else if("number"===a.fieldObj.shortType)switch(!g||"uniquePredefined"!==a.valueObj.type&&"multiplePredefined"!==a.valueObj.type?g&&"multiple"===a.valueObj.type&&(g=g.join(",")):(x=[],y.forEach(g,m.hitch(this,function(a){a.isChecked&&x.push(a.value)})),
g=x.join(",")),a.operator){case this.OPERATORS.numberOperatorIs:e=a.fieldObj.name+" \x3d "+g;break;case this.OPERATORS.numberOperatorIsNot:e=a.fieldObj.name+" \x3c\x3e "+g;break;case this.OPERATORS.numberOperatorIsAtLeast:e=a.fieldObj.name+" \x3e\x3d "+g;break;case this.OPERATORS.numberOperatorIsLessThan:e=a.fieldObj.name+" \x3c "+g;break;case this.OPERATORS.numberOperatorIsAtMost:e=a.fieldObj.name+" \x3c\x3d "+g;break;case this.OPERATORS.numberOperatorIsGreaterThan:e=a.fieldObj.name+" \x3e "+g;break;
case this.OPERATORS.numberOperatorIsAnyOf:e=a.fieldObj.name+" IN ("+g+")";break;case this.OPERATORS.numberOperatorIsNoneOf:e=a.fieldObj.name+" NOT IN ("+g+")";break;case this.OPERATORS.numberOperatorIsBetween:e=a.fieldObj.name+" BETWEEN "+n+" AND "+r;break;case this.OPERATORS.numberOperatorIsNotBetween:e=a.fieldObj.name+" NOT BETWEEN "+n+" AND "+r;break;case this.OPERATORS.numberOperatorIsBlank:e=a.fieldObj.name+" IS NULL";break;case this.OPERATORS.numberOperatorIsNotBlank:e=a.fieldObj.name+" IS NOT NULL"}else switch(w.isDefined(g)&&
"field"!==a.valueObj.type&&"string"===typeof g&&(g=new Date(g)),"field"!==a.valueObj.type&&(g&&(g=new Date(g)),n&&(n=new Date(n)),r&&(r=new Date(r))),a.operator){case this.OPERATORS.dateOperatorIsOn:e="field"===a.valueObj.type?a.fieldObj.name+" \x3d "+g:t?a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+k+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(k+1)+"}'":a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(g)+"' AND "+(this.isHosted?"":"timestamp ")+
"'"+this.formatDate(this.addDay(g))+"'";break;case this.OPERATORS.dateOperatorIsNotOn:e="field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3e "+g:t?a.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+k+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(k+1)+"}'":a.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(g)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(g))+"'";break;case this.OPERATORS.dateOperatorIsBefore:e="field"===
a.valueObj.type?a.fieldObj.name+" \x3c "+g:a.fieldObj.name+" \x3c "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(g)+"'";break;case this.OPERATORS.dateOperatorIsAfter:e="field"===a.valueObj.type?a.fieldObj.name+" \x3e "+g:a.fieldObj.name+" \x3e "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(g))+"'";break;case this.OPERATORS.dateOperatorIsOnOrBefore:e="field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3d "+g:a.fieldObj.name+" \x3c\x3d "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(g))+
"'";break;case this.OPERATORS.dateOperatorIsOnOrAfter:e="field"===a.valueObj.type?a.fieldObj.name+" \x3e\x3d "+g:a.fieldObj.name+" \x3e\x3d "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(g)+"'";break;case this.OPERATORS.dateOperatorInTheLast:e=a.fieldObj.name+" BETWEEN CURRENT_TIMESTAMP - "+this._convertRangeToDays(a.valueObj.value,a.valueObj.range)+" AND CURRENT_TIMESTAMP";break;case this.OPERATORS.dateOperatorNotInTheLast:e=a.fieldObj.name+" NOT BETWEEN CURRENT_TIMESTAMP - "+this._convertRangeToDays(a.valueObj.value,
a.valueObj.range)+" AND CURRENT_TIMESTAMP";break;case this.OPERATORS.dateOperatorIsBetween:case this.OPERATORS.dateOperatorIsIn:e=t?a.fieldObj.name+" BETWEEN '"+n+"' AND '"+r+"'":a.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(n)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(r))+"'";break;case this.OPERATORS.dateOperatorIsNotBetween:case this.OPERATORS.dateOperatorIsNotIn:e=t?a.fieldObj.name+" NOT BETWEEN '"+n+"' AND '"+r+"'":a.fieldObj.name+
" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(n)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(r))+"'";break;case this.OPERATORS.dateOperatorIsBlank:e=a.fieldObj.name+" IS NULL";break;case this.OPERATORS.dateOperatorIsNotBlank:e=a.fieldObj.name+" IS NOT NULL"}"date"===a.fieldObj.shortType?(k=m.clone(a.valueObj),k.dateFormat=a.fieldObj.dateFormat,A=this.getDisplaySQL(a.fieldObj.name,k,a.operator)):A=e;a.displaySQL=A;return{whereClause:e}},_dateENUM:{dateOperatorIsOn:"is on ",
dateOperatorIsNotOn:"is not on ",dateOperatorIsIn:"is in ",dateOperatorIsNotIn:"is not in ",dateOperatorIsBefore:"is before ",dateOperatorIsAfter:"is after ",dateOperatorIsOnOrBefore:"is on or before ",dateOperatorIsOnOrAfter:"is on or after ",dateOperatorInTheLast:["is in the last "," from CURRENT_TIMESTAMP"],dateOperatorNotInTheLast:["is not in the last "," from CURRENT_TIMESTAMP"],dateOperatorIsBetween:["is between "," and "],dateOperatorIsNotBetween:["is not between "," and "],dateOperatorIsBlank:"is blank",
dateOperatorIsNotBlank:"is not blank"},_getDisplayDates:function(a){var k={value:a.virtualDate,value1:a.virtualDate1,value2:a.virtualDate2},e=""===a.dateFormat?{}:{format:{dateFormat:a.dateFormat}};if(""===a.virtualDate||void 0===a.virtualDate)k.value=r.localizeDateByFieldInfo(new Date(a.value),e);""===a.virtualDate1&&(k.value1=r.localizeDateByFieldInfo(new Date(a.value1),e));""===a.virtualDate2&&(k.value2=r.localizeDateByFieldInfo(new Date(a.value2),e));return k},getDisplaySQL:function(a,k,e){var g=
"",g=this._dateENUM[e];0<e.indexOf("InTheLast")?g=g[0]+k.value+" "+this._getDateRangeEnum(k.value,k.range)+g[1]:(k=this._getDisplayDates(k,e),g=0<e.indexOf("Between")?g[0]+k.value1+g[1]+k.value2:0<e.indexOf("Blank")?this._dateENUM[e]:this._dateENUM[e]+k.value);return a+" "+g},_getDateRangeEnum:function(a,k){k={dateOperatorYears:"year",dateOperatorDays:"day",dateOperatorMonths:"month",dateOperatorWeeks:"week",dateOperatorHours:"hour",dateOperatorMinutes:"minute"}[k];return 1<a?k+"s":k},_convertRangeToDays:function(a,
k){var e=a;k===this.OPERATORS.dateOperatorYears?e=365*a:k===this.OPERATORS.dateOperatorMonths?e=30*a:k===this.OPERATORS.dateOperatorWeeks?e=7*a:k===this.OPERATORS.dateOperatorHours?e=a/24:k===this.OPERATORS.dateOperatorMinutes&&(e=a/1440);return e=Math.round(1E6*e)/1E6},formatDate:function(a){a=new Date(a);return""+a.getUTCFullYear()+"-"+g.format(a.getUTCMonth()+1,{pattern:"00"})+"-"+g.format(a.getUTCDate(),{pattern:"00"})+" "+g.format(a.getUTCHours(),{pattern:"00"})+":"+g.format(a.getUTCMinutes(),
{pattern:"00"})+":"+g.format(a.getSeconds(),{pattern:"00"})},addDay:function(a){return new Date(a.getTime()+this.dayInMS)},addMinute:function(a){return new Date(a.getTime()+this.MinuteInMS)},addSec:function(a){return new Date(a.getTime()+this.SecInMS)},getFilterObjByExpr:function(a){if(a&&this.fieldsStore){var k=this.replaceStrings(a);a=k.defExpr;var e=this.findParts(a,"AND");1===e.parts.length&&(e=this.findParts(a,"OR"),1===e.parts.length&&(e.logicalOperator="AND"));y.forEach(e.parts,function(a){a.expr=
a.expr.trim();if(a.expr.startsWith("(")&&-1<a.expr.search(/\)$/)){var e=a.expr.substring(1,a.expr.length-1),k=e.indexOf("("),g=e.indexOf(")");if(-1===k&&-1===g||k<g)a.expr=e}e=this.findParts(a.expr,"AND");1===e.parts.length&&(e=this.findParts(a.expr,"OR"));1<e.parts.length&&(a.parts=e.parts,a.logicalOperator=e.logicalOperator)},this);this.parseExpr(e);this.reReplaceStrings(k,e,m.hitch(this,function(){e&&e.parts&&y.forEach(e.parts,m.hitch(this,function(a){a&&(a.parts?y.forEach(a.parts,m.hitch(this,
function(a){this._handleParsedValuesForSinglePart(a);this._addDefalutValueTypeForSinglePart(a)})):(this._handleParsedValuesForSinglePart(a),this._addDefalutValueTypeForSinglePart(a)))}))}));this.isPartsObjHasError(e)&&(e=null);return e}},_handleParsedValuesForSinglePart:function(a){a&&a.fieldObj&&"number"===a.fieldObj.shortType&&a.valueObj&&(a.valueObj.hasOwnProperty("value")&&(a.valueObj.value=parseFloat(a.valueObj.value)),a.valueObj.hasOwnProperty("value1")&&(a.valueObj.value1=parseFloat(a.valueObj.value1)),
a.valueObj.hasOwnProperty("value2")&&(a.valueObj.value2=parseFloat(a.valueObj.value2)))},_addDefalutValueTypeForSinglePart:function(a){a&&a.valueObj&&!a.valueObj.type&&(a.valueObj.type="value")},replaceStrings:function(a){for(var k=a,e=function(a,k,g){var p=-1,p=a.indexOf("'",g+1);return p===g+1?(p=a.indexOf("'",p+1),e(a,k,p)):g},g=[],n=a.indexOf("'");-1<n;){var m=n,n=a.indexOf("'",n+1),r=0,n=e(a,m,n);"%"===a[m+1]&&m++;"%"===a[n-1]&&(--n,r++);var t=a.substring(m+1,n);"N"===a[m-1]&&(a=a.substring(0,
m-1)+a.substring(m),--m,--n);this.isDateString(t)||-1!==t.indexOf("{")?n=a.indexOf("'",n+1+r):(g.push(t),a=a.substring(0,m+1)+"#"+(g.length-1)+"#"+a.substring(n),n=a.indexOf("'",a.lastIndexOf("#")+2+r))}return{origDefExpr:k,defExpr:a,savedStrings:g}},reReplaceStrings:function(a,k,e){var g=a.savedStrings;if(!g.length)e&&"function"===typeof e&&e();else if(g.length){var n=function(a,e){if(void 0===a.valueObj||null===a.valueObj||void 0===a.valueObj.value||null===a.valueObj.value||"string"!==a.fieldObj.shortType)return!1;
var k=a.valueObj.value.indexOf("#"),g=a.valueObj.value.lastIndexOf("#");return w.isDefined(a.valueObj.value)&&-1<k?(a.valueObj.value=e[parseInt(a.valueObj.value.substring(k+1,g),10)].replace(/\'\'/g,"'"),this.builtSingleFilterString(a),!0):!1},n=m.hitch(this,n),r=!1;y.forEach(k.parts,function(a){if(a.parts){var e=!1;y.forEach(a.parts,function(a){e=n(a,g)||e});e&&(r=e,a.expr=this.builtFilterString(a))}else(r=n(a,g)||r)&&this.builtFilterString(a)},this);e&&"function"===typeof e&&e();r&&(k.expr=null,
this.getExprByFilterObj(k))}},isDateString:function(a){return 19===a.length&&"-"===a.charAt(4)&&"-"===a.charAt(7)&&" "===a.charAt(10)&&":"===a.charAt(13)&&":"===a.charAt(16)?!0:!1},findParts:function(a,k){for(var e=a.toLowerCase(),g=" "+k.toLowerCase()+" ",n=[],m=0,r=e.indexOf(g);0<r;){var t=a.substring(m,r),A=t.toLowerCase(),x=t.count("("),w=t.count(")"),y=t.count("'");x!==w||1===y%2?r=e.indexOf(g,r+1):-1<A.indexOf(" between ")&&-1===A.indexOf(" and ")?r=e.indexOf(g,r+1):(n.push({expr:t}),m=r+g.length,
r=e.indexOf(g,m))}n.push({expr:a.substring(m)});for(e=n.length-1;0<=e;e--)!this.hasOperator(n[e].expr)&&0<e&&(n[e-1].expr+=" "+k+" "+n[e].expr,n.splice(e,1));return{expr:a,parts:n,logicalOperator:k}},hasOperator:function(a){a=a.toLowerCase();return-1<a.indexOf("{")&&-1<a.indexOf("}")||-1<a.indexOf(" \x3d ")||-1<a.indexOf(" \x3c ")||-1<a.indexOf(" \x3e ")||-1<a.indexOf(" \x3c\x3e ")||-1<a.indexOf(" \x3c\x3d ")||-1<a.indexOf(" \x3e\x3d ")||-1<a.indexOf(" like ")||-1<a.indexOf(" between ")||-1<a.indexOf(" date")||
-1<a.indexOf(" is null")||-1<a.indexOf(" is not null")?!0:!1},parseExpr:function(a){y.forEach(a.parts,function(a){a.parts?this.parseExpr(a):this.parseSingleExpr(a)},this)},_preParseSingleExpr:function(a){var k=null;try{if(k=m.clone(a),k.expr=k.expr.trim(),/^UPPER\((.*)\)(\s+|\s+NOT\s+)LIKE\s+UPPER\(N?'(.*)'\)$/i.test(k.expr)){var e=a="",g=k.expr.match(/^UPPER\((.*)\)\s+/i);if(g&&2<=g.length)a=g[1];else return null;var n=k.expr.match(/UPPER\(N?'(.*)'\)$/i);if(n&&2<=n.length)e="'"+n[1]+"'";else return null;
k.expr=k.expr.replace(/^UPPER\((.*)\)\s+/i,a+" ");k.expr=k.expr.replace(/UPPER\(N?'(.*)'\)$/i,e);k.caseSensitive=!1}else/^(.+)(\s+|\s+NOT\s+)LIKE\s+N?'(.*)'$/i.test(k.expr)&&(k.caseSensitive=!0)}catch(z){return console.log(z),null}k&&this.isHosted&&(k.caseSensitive=!1);return k},_removeOperator:function(a,k,e){k=k.substring(e).trim();"date"===a&&!this.isHosted&&k.toLowerCase().startsWith("timestamp ")&&(k=k.substring(10).trim());return k},parseSingleExpr:function(a){var k=this._preParseSingleExpr(a);
k&&(a=m.mixin(a,k));var k=a.expr.trim(),e=k.indexOf(" "),g=k.substring(0,e);a.fieldObj={name:g};a.valueObj={};this.getFieldItemByName({name:g},function(e){a.fieldObj.shortType=e.shortType[0];a.fieldObj.label=e.label[0]},function(){a.error={msg:"unknown field name ("+g+")",code:1}});k=k.substring(e+1).trim();e=k.toLowerCase();e.startsWith("\x3d ")?(k=this._removeOperator(a.fieldObj.shortType,k,2),this.storeValue(k,a),a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsOn:"string"===
a.fieldObj.shortType?this.OPERATORS.stringOperatorIs:this.OPERATORS.numberOperatorIs):e.startsWith("\x3c ")?(k=this._removeOperator(a.fieldObj.shortType,k,2),this.storeValue(k,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsBefore:"number"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsLessThan:a.error={msg:"operator ("+e+") not supported for string",code:3}):e.startsWith("\x3e ")?(k=this._removeOperator(a.fieldObj.shortType,k,2),this.storeValue(k,a),"date"===
a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsAfter:"number"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsGreaterThan:a.error={msg:"operator ("+e+") not supported for string",code:3}):e.startsWith("\x3c\x3e ")?(k=this._removeOperator(a.fieldObj.shortType,k,3),this.storeValue(k,a),a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotOn:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsNot:this.OPERATORS.numberOperatorIsNot):e.startsWith("\x3c\x3d ")?
(k=this._removeOperator(a.fieldObj.shortType,k,3),this.storeValue(k,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsOnOrBefore:"number"===a.fieldObj.shortType?a.operator=this.OPERATORS.numberOperatorIsAtMost:a.error={msg:"operator ("+e+") not supported for string",code:3}):e.startsWith("\x3e\x3d ")?(k=this._removeOperator(a.fieldObj.shortType,k,3),this.storeValue(k,a),"date"===a.fieldObj.shortType?a.operator=this.OPERATORS.dateOperatorIsOnOrAfter:"number"===a.fieldObj.shortType?
a.operator=this.OPERATORS.numberOperatorIsAtLeast:a.error={msg:"operator ("+e+") not supported for string",code:3}):e.startsWith("like ")?(k=k.substring(5).trim(),k.startsWith("N'")&&(k=k.substring(1,k.length)),k.startsWith("'%")&&k.endsWith("%'")?(this.storeValue(k.substring(2,k.length-2),a),a.operator=this.OPERATORS.stringOperatorContains):k.startsWith("'%")&&k.endsWith("'")?(this.storeValue(k.substring(2,k.length-1),a),a.operator=this.OPERATORS.stringOperatorEndsWith):k.startsWith("'")&&k.endsWith("%'")?
(this.storeValue(k.substring(1,k.length-2),a),a.operator=this.OPERATORS.stringOperatorStartsWith):a.error={msg:"value ("+e+") not supported for LIKE",code:3}):e.startsWith("not like ")?(k=k.substring(9).trim(),k.startsWith("N'")&&(k=k.substring(1,k.length)),k.startsWith("'%")&&k.endsWith("%'")?(this.storeValue(k.substring(2,k.length-2),a),a.operator=this.OPERATORS.stringOperatorDoesNotContain):a.error={msg:"value ("+e+") not supported for NOT LIKE",code:3}):e.startsWith("between ")?this._updatePartForBetween(k,
!0,a):e.startsWith("not between ")?this._updatePartForBetween(k,!1,a):"is null"===e?(a.valueObj.value=null,a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsBlank:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsBlank:this.OPERATORS.numberOperatorIsBlank):"is not null"===e?(a.valueObj.value=null,a.operator="date"===a.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotBlank:"string"===a.fieldObj.shortType?this.OPERATORS.stringOperatorIsNotBlank:this.OPERATORS.numberOperatorIsNotBlank):
a.error={msg:"unknown operator ("+e+")",code:2};if(w.isDefined(a.valueObj.value)&&"string"===typeof a.valueObj.value&&a.valueObj.value.startsWith("{")&&a.valueObj.value.endsWith("}")||w.isDefined(a.valueObj.value1)&&"string"===typeof a.valueObj.value1&&a.valueObj.value1.startsWith("{")&&a.valueObj.value1.endsWith("}"))a.isInteractive=!0},getFieldItemByName:function(a,k,e){this.fieldsStore.fetch({query:a,onComplete:m.hitch(this,function(a){a&&a.length?k(a[0]):e()})})},subtractDay:function(a){return new Date(a.getTime()-
this.dayInMS)},_updatePartForBetween:function(a,k,e){var g,n,m,r,t;a=this._removeOperator(e.fieldObj.shortType,a,(k?"between ":"not between ").length);g=a.toLowerCase().indexOf(" and ");if(-1<g)if(n=a.substring(0,g).trim(),n.startsWith("CURRENT_TIMESTAMP "))if(n=n.substring(18).trim(),n.startsWith("-")){e.operator=k?this.OPERATORS.dateOperatorInTheLast:this.OPERATORS.dateOperatorNotInTheLast;try{t=parseFloat(n.substring(1).trim()),1<=t?(m=this.OPERATORS.dateOperatorDays,r=t/365,1E-4>Math.abs(r-Math.round(r))?
(t=Math.round(r),m=this.OPERATORS.dateOperatorYears):(r=t/30,1E-4>Math.abs(r-Math.round(r))?(t=Math.round(r),m=this.OPERATORS.dateOperatorMonths):(r=t/7,1E-4>Math.abs(r-Math.round(r))&&(t=Math.round(r),m=this.OPERATORS.dateOperatorWeeks)))):(m=this.OPERATORS.dateOperatorMinutes,t*=24,1E-4>Math.abs(t-Math.round(t))?m=this.OPERATORS.dateOperatorHours:t*=60),e.valueObj.value=t,e.valueObj.range=m}catch(L){e.error={msg:"missing count for '"+(k?"":"not ")+"in the last'",code:3}}}else e.error={msg:"'"+(k?
"":"not ")+"in the next' not supported",code:3};else if(a=this._removeOperator(e.fieldObj.shortType,a.substring(g),5),this.storeValue1(n,e),this.storeValue2(a,e),"date"===e.fieldObj.shortType){if(e.operator=k?this.OPERATORS.dateOperatorIsBetween:this.OPERATORS.dateOperatorIsNotBetween,"object"===typeof e.valueObj.value1&&"object"===typeof e.valueObj.value2)try{1E3>Math.abs(this.subtractDay(e.valueObj.value2).getTime()-e.valueObj.value1.getTime())&&(e.valueObj.value=e.valueObj.value1,delete e.valueObj.value1,
delete e.valueObj.value2,e.operator=k?this.OPERATORS.dateOperatorIsOn:this.OPERATORS.dateOperatorIsNotOn)}catch(L){}}else"number"===e.fieldObj.shortType||"oid"===e.fieldObj.shortType?e.operator=k?this.OPERATORS.numberOperatorIsBetween:this.OPERATORS.numberOperatorIsNotBetween:e.error={msg:e.fieldObj.shortType+" field not supported for "+(k?"":"NOT ")+"BETWEEN",code:3};else e.error={msg:"missing AND operator for "+(k?"":"NOT ")+"BETWEEN",code:3}},storeValue:function(a,k){if(a.startsWith("{")&&a.endsWith("}"))k.valueObj.value=
a;else if(a.startsWith("'{")&&a.endsWith("}'"))k.valueObj.value=a.substring(1,a.length-1);else if("date"===k.fieldObj.shortType)if(a.startsWith("'")&&a.endsWith("'")){var e=a.substring(1,a.length-1);k.valueObj.value=this.parseDate(e)}else k.valueObj.value=a,k.valueObj.type="field";else"string"===k.fieldObj.shortType?(a.startsWith("#")||a.startsWith("%#"))&&(a.endsWith("#")||a.endsWith("#%"))?k.valueObj.value=a:a.startsWith("'")&&a.endsWith("'")?k.valueObj.value=a.substring(1,a.length-1).replace(/\'\'/g,
"'"):(k.valueObj.value=a,k.valueObj.type="field",this.getFieldItemByName({name:a},function(a){k.valueObj.label=a.label[0]},function(){k.error={msg:"unknown field name ("+a+")",code:1}})):(k.valueObj.value=a,isNaN(a)&&(k.valueObj.type="field",this.getFieldItemByName({name:a},function(a){k.valueObj.label=a.label[0]},function(){k.error={msg:"unknown field name ("+a+")",code:1}})))},storeValue1:function(a,k){a.startsWith("{")&&a.endsWith("}")?k.valueObj.value1=a:a.startsWith("'{")&&a.endsWith("}'")?k.valueObj.value1=
a.substring(1,a.length-1):"date"===k.fieldObj.shortType?a.startsWith("'")&&a.endsWith("'")?(a=a.substring(1,a.length-1),k.valueObj.value1=this.parseDate(a)):(k.valueObj.value1=a,k.valueObj.type="field"):(k.valueObj.value1=a,isNaN(a)&&(k.valueObj.type="field"))},storeValue2:function(a,k){a.startsWith("{")&&a.endsWith("}")?k.valueObj.value2=a:a.startsWith("'{")&&a.endsWith("}'")?k.valueObj.value2=a.substring(1,a.length-1):"date"===k.fieldObj.shortType?a.startsWith("'")&&a.endsWith("'")?(a=a.substring(1,
a.length-1),k.valueObj.value2=this.parseDate(a)):(k.valueObj.value2=a,k.valueObj.type="field"):(k.valueObj.value2=a,isNaN(a)&&(k.valueObj.type="field"))},parseDate:function(a){var k=x.parse(a,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});k||(k=x.parse(a.replace(" ",", "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}))||(k=x.parse(a.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return k}});A.VIRTUAL_DATE_TODAY="today";A.VIRTUAL_DATE_YESTERDAY="yesterday";A.VIRTUAL_DATE_TOMORROW=
"tomorrow";A.VIRTUAL_DATE_THIS_WEEK="thisWeek";A.VIRTUAL_DATE_THIS_MONTH="thisMonth";A.VIRTUAL_DATE_THIS_QUARTER="thisQuarter";A.VIRTUAL_DATE_THIS_YEAR="thisYear";A.isAskForValues=function(a){var k=!1;return k=y.some(a.parts,function(a){return a.parts?y.some(a.parts,function(a){return!!a.interactiveObj}):!!a.interactiveObj})};A.hasVirtualDate=function(a){var k=!1;return k=y.some(a.parts,function(a){return a.parts?y.some(a.parts,function(a){return!!a.valueObj.virtualDate||!!a.valueObj.virtualDate1||
!!a.valueObj.virtualDate2}):!!a.valueObj.virtualDate||!!a.valueObj.virtualDate1||!!a.valueObj.virtualDate2})};A.getRealDateByVirtualDate=function(a){var k=null,e=new Date,g=e.getTime();switch(a){case A.VIRTUAL_DATE_TODAY:k=e;break;case A.VIRTUAL_DATE_YESTERDAY:k=new Date(g-864E5);break;case A.VIRTUAL_DATE_TOMORROW:k=new Date(g+864E5);break;case A.VIRTUAL_DATE_THIS_WEEK:k=[n().startOf("week").toDate(),n().endOf("week").toDate()];break;case A.VIRTUAL_DATE_THIS_MONTH:k=[n().startOf("month").toDate(),
n().endOf("month").toDate()];break;case A.VIRTUAL_DATE_THIS_QUARTER:k=[n().startOf("quarter").toDate(),n().endOf("quarter").toDate()];break;case A.VIRTUAL_DATE_THIS_YEAR:k=[n().startOf("year").toDate(),n().endOf("year").toDate()]}return k};return A})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),function(B,m,y,x,g,w,t){return m("dojo.data.ItemFileWriteStore",w,{constructor:function(g){this._features["dojo.data.api.Write"]=
!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(g){return t.toISOString(g,{zulu:!0})});g&&!1===g.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(g){if(!g)throw Error("assertion failed in ItemFileWriteStore");},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},
newItem:function(g,n){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=typeof g&&"undefined"!=typeof g)throw Error("newItem() was passed something other than an object");var m=null,a=this._getIdentifierAttribute();if(a===Number)m=this._arrayOfAllItems.length;else{m=g[a];if("undefined"===typeof m)throw Error("newItem() was not passed an identity for the new item");if(B.isArray(m))throw Error("newItem() was not passed an single-valued identity");}this._itemsByIdentity&&
this._assert("undefined"===typeof this._itemsByIdentity[m]);this._assert("undefined"===typeof this._pending._newItems[m]);this._assert("undefined"===typeof this._pending._deletedItems[m]);var k={};k[this._storeRefPropName]=this;k[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[m]=k,k[a]=[m]);this._arrayOfAllItems.push(k);a=null;if(n&&n.parent&&n.attribute){var a={item:n.parent,attribute:n.attribute,oldValue:void 0},e=this.getValues(n.parent,n.attribute);
if(e&&0<e.length){var p=e.slice(0,e.length);a.oldValue=1===e.length?e[0]:e.slice(0,e.length);p.push(k);this._setValueOrValues(n.parent,n.attribute,p,!1);a.newValue=this.getValues(n.parent,n.attribute)}else this._setValueOrValues(n.parent,n.attribute,k,!1),a.newValue=k}else k[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(k);this._pending._newItems[m]=k;for(var r in g){if(r===this._storeRefPropName||r===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");
n=g[r];B.isArray(n)||(n=[n]);k[r]=n;if(this.referenceIntegrity)for(m=0;m<n.length;m++)e=n[m],this.isItem(e)&&this._addReferenceToMap(e,k,r)}this.onNew(k,a);return k},_removeArrayElement:function(g,n){n=y.indexOf(g,n);return-1!=n?(g.splice(n,1),!0):!1},deleteItem:function(g){this._assert(!this._saveInProgress);this._assertIsItem(g);var n=g[this._itemNumPropName],m=this.getIdentity(g);if(this.referenceIntegrity){var a=this.getAttributes(g);g[this._reverseRefMap]&&(g["backup_"+this._reverseRefMap]=B.clone(g[this._reverseRefMap]));
y.forEach(a,function(a){y.forEach(this.getValues(g,a),function(e){this.isItem(e)&&(g["backupRefs_"+this._reverseRefMap]||(g["backupRefs_"+this._reverseRefMap]=[]),g["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(e),attr:a}),this._removeReferenceFromMap(e,g,a))},this)},this);if(a=g[this._reverseRefMap])for(var k in a){var e=null;if(e=this._itemsByIdentity?this._itemsByIdentity[k]:this._arrayOfAllItems[k])for(var p in a[k]){var r=this.getValues(e,p)||[],z=y.filter(r,function(a){return!(this.isItem(a)&&
this.getIdentity(a)==m)},this);this._removeReferenceFromMap(g,e,p);z.length<r.length&&this._setValueOrValues(e,p,z,!0)}}}this._arrayOfAllItems[n]=null;g[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[m];this._pending._deletedItems[m]=g;g[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,g);this.onDelete(g);return!0},setValue:function(g,n,m){return this._setValueOrValues(g,n,m,!0)},setValues:function(g,n,m){return this._setValueOrValues(g,
n,m,!0)},unsetAttribute:function(g,n){return this._setValueOrValues(g,n,[],!0)},_setValueOrValues:function(g,n,m,a){this._assert(!this._saveInProgress);this._assertIsItem(g);this._assert(B.isString(n));this._assert("undefined"!==typeof m);var k=this._getIdentifierAttribute();if(n==k)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var k=this._getValueOrValues(g,n),e=this.getIdentity(g);if(!this._pending._modifiedItems[e]){var p={},r;for(r in g)p[r]=
r===this._storeRefPropName||r===this._itemNumPropName||r===this._rootItemPropName?g[r]:r===this._reverseRefMap?B.clone(g[r]):g[r].slice(0,g[r].length);this._pending._modifiedItems[e]=p}e=!1;if(B.isArray(m)&&0===m.length){if(e=delete g[n],m=void 0,this.referenceIntegrity&&k){r=k;B.isArray(r)||(r=[r]);for(var z=0;z<r.length;z++)p=r[z],this.isItem(p)&&this._removeReferenceFromMap(p,g,n)}}else{e=B.isArray(m)?m.slice(0,m.length):[m];if(this.referenceIntegrity)if(k){r=k;B.isArray(r)||(r=[r]);var t={};y.forEach(r,
function(a){this.isItem(a)&&(a=this.getIdentity(a),t[a.toString()]=!0)},this);y.forEach(e,function(a){if(this.isItem(a)){var e=this.getIdentity(a);t[e.toString()]?delete t[e.toString()]:this._addReferenceToMap(a,g,n)}},this);for(z in t)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[z]:this._arrayOfAllItems[z],g,n)}else for(z=0;z<e.length;z++)p=e[z],this.isItem(p)&&this._addReferenceToMap(p,g,n);g[n]=e;e=!0}if(a)this.onSet(g,n,k,m);return e},_addReferenceToMap:function(g,
n,m){n=this.getIdentity(n);var a=g[this._reverseRefMap];a||(a=g[this._reverseRefMap]={});(g=a[n])||(g=a[n]={});g[m]=!0},_removeReferenceFromMap:function(g,n,m){n=this.getIdentity(n);var a=g[this._reverseRefMap],k;if(a){for(k in a)k==n&&(delete a[k][m],this._isEmpty(a[k])&&delete a[k]);this._isEmpty(a)&&delete g[this._reverseRefMap]}},_dumpReferenceMap:function(){var g;for(g=0;g<this._arrayOfAllItems.length;g++){var n=this._arrayOfAllItems[g];n&&n[this._reverseRefMap]&&console.log("Item: ["+this.getIdentity(n)+
"] is referenced by: "+x.toJson(n[this._reverseRefMap]))}},_getValueOrValues:function(g,n){var m=void 0;this.hasAttribute(g,n)&&(g=this.getValues(g,n),m=1==g.length?g[0]:g);return m},_flatten:function(g){if(this.isItem(g))return{_reference:this.getIdentity(g)};if("object"===typeof g)for(var n in this._datatypeMap){var m=this._datatypeMap[n];if(B.isObject(m)&&!B.isFunction(m)){if(g instanceof m.type){if(!m.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+n+"]");
return{_type:n,_value:m.serialize(g)}}}else if(g instanceof m)return{_type:n,_value:g.toString()}}return g},_getNewFileContentString:function(){var g={},n=this._getIdentifierAttribute();n!==Number&&(g.identifier=n);this._labelAttr&&(g.label=this._labelAttr);g.items=[];for(n=0;n<this._arrayOfAllItems.length;++n){var m=this._arrayOfAllItems[n];if(null!==m){var a={},k;for(k in m)if(k!==this._storeRefPropName&&k!==this._itemNumPropName&&k!==this._reverseRefMap&&k!==this._rootItemPropName){var e=this.getValues(m,
k);if(1==e.length)a[k]=this._flatten(e[0]);else for(var p=[],u=0;u<e.length;++u)p.push(this._flatten(e[u])),a[k]=p}g.items.push(a)}}return x.toJson(g,!0)},_isEmpty:function(g){var n=!0;if(B.isObject(g))for(var m in g){n=!1;break}else B.isArray(g)&&0<g.length&&(n=!1);return n},save:function(m){this._assert(!this._saveInProgress);this._saveInProgress=!0;var n=this,r=function(){n._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};n._saveInProgress=!1;m&&m.onComplete&&m.onComplete.call(m.scope||
g.global)},a=function(a){n._saveInProgress=!1;m&&m.onError&&m.onError.call(m.scope||g.global,a)};if(this._saveEverything){var k=this._getNewFileContentString();this._saveEverything(r,a,k)}this._saveCustom&&this._saveCustom(r,a);this._saveEverything||this._saveCustom||r()},revert:function(){this._assert(!this._saveInProgress);for(var g in this._pending._modifiedItems){var n=this._pending._modifiedItems[g],m=null,m=this._itemsByIdentity?this._itemsByIdentity[g]:this._arrayOfAllItems[g];n[this._storeRefPropName]=
this;for(var a in m)delete m[a];B.mixin(m,n)}var k;for(g in this._pending._deletedItems)k=this._pending._deletedItems[g],k[this._storeRefPropName]=this,n=k[this._itemNumPropName],k["backup_"+this._reverseRefMap]&&(k[this._reverseRefMap]=k["backup_"+this._reverseRefMap],delete k["backup_"+this._reverseRefMap]),this._arrayOfAllItems[n]=k,this._itemsByIdentity&&(this._itemsByIdentity[g]=k),k[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(k);for(g in this._pending._deletedItems)k=this._pending._deletedItems[g],
k["backupRefs_"+this._reverseRefMap]&&(y.forEach(k["backupRefs_"+this._reverseRefMap],function(a){this._addReferenceToMap(this._itemsByIdentity?this._itemsByIdentity[a.id]:this._arrayOfAllItems[a.id],k,a.attr)},this),delete k["backupRefs_"+this._reverseRefMap]);for(g in this._pending._newItems)n=this._pending._newItems[g],n[this._storeRefPropName]=null,this._arrayOfAllItems[n[this._itemNumPropName]]=null,n[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,n),this._itemsByIdentity&&
delete this._itemsByIdentity[g];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(g){return g?(g=this.getIdentity(g),(new Boolean(this._pending._newItems[g]||this._pending._modifiedItems[g]||this._pending._deletedItems[g])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(g,n,m,a){},onNew:function(g,n){},onDelete:function(g){},close:function(g){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),function(B,m,y,x,g,w,t,r,n){y=y("dojo.data.ItemFileReadStore",[w],{constructor:function(g){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=g.url;this._jsonData=g.data;this.data=null;this._datatypeMap=g.typeMap||
{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(a){return n.fromISOString(a)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==g.urlPreventCache&&(this.urlPreventCache=g.urlPreventCache?!0:!1);void 0!==g.hierarchical&&(this.hierarchical=g.hierarchical?
!0:!1);g.clearOnClose&&(this.clearOnClose=!0);"failOk"in g&&(this.failOk=g.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(g){if(!this.isItem(g))throw Error(this.declaredClass+": Invalid item argument.");},_assertIsAttribute:function(g){if("string"!==typeof g)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(g,a,k){g=this.getValues(g,a);return 0<g.length?g[0]:k},getValues:function(g,
a){this._assertIsItem(g);this._assertIsAttribute(a);return(g[a]||[]).slice(0)},getAttributes:function(g){this._assertIsItem(g);var a=[],k;for(k in g)k!==this._storeRefPropName&&k!==this._itemNumPropName&&k!==this._rootItemPropName&&k!==this._reverseRefMap&&a.push(k);return a},hasAttribute:function(g,a){this._assertIsItem(g);this._assertIsAttribute(a);return a in g},containsValue:function(g,a,k){var e=void 0;"string"===typeof k&&(e=t.patternToRegExp(k,!1));return this._containsValue(g,a,k,e)},_containsValue:function(g,
a,k,e){return x.some(this.getValues(g,a),function(a){if(null!==a&&!m.isObject(a)&&e){if(a.toString().match(e))return!0}else if(k===a)return!0})},isItem:function(g){return g&&g[this._storeRefPropName]===this&&this._arrayOfAllItems[g[this._itemNumPropName]]===g?!0:!1},isItemLoaded:function(g){return this.isItem(g)},loadItem:function(g){this._assertIsItem(g.item)},getFeatures:function(){return this._features},getLabel:function(g){if(this._labelAttr&&this.isItem(g))return this.getValue(g,this._labelAttr)},
getLabelAttributes:function(g){return this._labelAttr?[this._labelAttr]:null},filter:function(g,a,k){var e=[],p,n;if(g.query){var m;p=g.queryOptions?g.queryOptions.ignoreCase:!1;var r={};for(n in g.query)m=g.query[n],"string"===typeof m?r[n]=t.patternToRegExp(m,p):m instanceof RegExp&&(r[n]=m);for(p=0;p<a.length;++p){var x=!0,w=a[p];if(null===w)x=!1;else for(n in g.query)m=g.query[n],this._containsValue(w,n,m,r[n])||(x=!1);x&&e.push(w)}}else for(p=0;p<a.length;++p)n=a[p],null!==n&&e.push(n);k(e,g)},
_fetchItems:function(n,a,k){var e=this;if(this._loadFinished)this.filter(n,this._getItemsArray(n.queryOptions),a);else if(this._jsonFileUrl!==this._ccUrl?(B.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:n,
filter:m.hitch(e,"filter"),findCallback:m.hitch(e,a)});else{this._loadInProgress=!0;var p=g.get({url:e._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});p.addCallback(function(g){try{e._getItemsFromLoadedData(g),e._loadFinished=!0,e._loadInProgress=!1,e.filter(n,e._getItemsArray(n.queryOptions),a),e._handleQueuedFetches()}catch(M){e._loadFinished=!0,e._loadInProgress=!1,k(M,n)}});p.addErrback(function(a){e._loadInProgress=!1;k(a,n)});var r=null;n.abort&&
(r=n.abort);n.abort=function(){var a=p;a&&-1===a.fired&&(a.cancel(),a=null);r&&r.call(n)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,e.filter(n,this._getItemsArray(n.queryOptions),a)}catch(z){k(z,n)}else k(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),n)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var g=0;g<this._queuedFetches.length;g++){var a=
this._queuedFetches[g],k=a.args,e=a.filter,a=a.findCallback;e?e(k,this._getItemsArray(k.queryOptions),a):this.fetchItemByIdentity(k)}this._queuedFetches=[]}},_getItemsArray:function(g){return g&&g.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(g){this.clearOnClose&&this._loadFinished&&!this._loadInProgress&&(""!=this._jsonFileUrl&&null!=this._jsonFileUrl||""!=this.url&&null!=this.url||null!=this.data||console.debug(this.declaredClass+": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"),
this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(g){function a(a){return null!==a&&"object"===typeof a&&(!m.isArray(a)||e)&&!m.isFunction(a)&&(a.constructor==Object||m.isArray(a))&&"undefined"===typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&p.hierarchical}function k(e){p._arrayOfAllItems.push(e);for(var g in e){var n=e[g];if(n)if(m.isArray(n))for(var r=
0;r<n.length;++r){var u=n[r];a(u)&&k(u)}else a(n)&&k(n)}}var e=!1,p=this;this._labelAttr=g.label;var n,r;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=g.items;for(n=0;n<this._arrayOfTopLevelItems.length;++n)r=this._arrayOfTopLevelItems[n],m.isArray(r)&&(e=!0),k(r),r[this._rootItemPropName]=!0;var t={},x;for(n=0;n<this._arrayOfAllItems.length;++n)for(x in r=this._arrayOfAllItems[n],r){if(x!==this._rootItemPropName){var w=r[x];null!==w?m.isArray(w)||(r[x]=[w]):r[x]=[null]}t[x]=x}for(;t[this._storeRefPropName];)this._storeRefPropName+=
"_";for(;t[this._itemNumPropName];)this._itemNumPropName+="_";for(;t[this._reverseRefMap];)this._reverseRefMap+="_";if(t=g.identifier)for(this._itemsByIdentity={},this._features["dojo.data.api.Identity"]=t,n=0;n<this._arrayOfAllItems.length;++n)if(r=this._arrayOfAllItems[n],g=r[t],g=g[0],Object.hasOwnProperty.call(this._itemsByIdentity,g)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+
t+"].  Value collided: ["+g+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+t+"].  Value collided: ["+g+"]");}else this._itemsByIdentity[g]=r;else this._features["dojo.data.api.Identity"]=Number;for(n=0;n<this._arrayOfAllItems.length;++n)r=this._arrayOfAllItems[n],r[this._storeRefPropName]=this,r[this._itemNumPropName]=n;for(n=0;n<this._arrayOfAllItems.length;++n)for(x in r=this._arrayOfAllItems[n],
r)for(g=r[x],t=0;t<g.length;++t)if(w=g[t],null!==w&&"object"==typeof w){if("_type"in w&&"_value"in w){var A=w._type,y=this._datatypeMap[A];if(y)if(m.isFunction(y))g[t]=new y(w._value);else if(m.isFunction(y.deserialize))g[t]=y.deserialize(w._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
A+"'");}if(w._reference){w=w._reference;if(m.isObject(w))for(A=0;A<this._arrayOfAllItems.length;++A){var y=this._arrayOfAllItems[A],B=!0,C;for(C in w)y[C]!=w[C]&&(B=!1);B&&(g[t]=y)}else g[t]=this._getItemByIdentity(w);this.referenceIntegrity&&(w=g[t],this.isItem(w)&&this._addReferenceToMap(w,r,x))}else this.isItem(w)&&this.referenceIntegrity&&this._addReferenceToMap(w,r,x)}},_addReferenceToMap:function(g,a,k){},getIdentity:function(g){var a=this._features["dojo.data.api.Identity"];return a===Number?
g[this._itemNumPropName]:(g=g[a])?g[0]:null},fetchItemByIdentity:function(n){var a,k;if(this._loadFinished)a=this._getItemByIdentity(n.identity),n.onItem&&(k=n.scope?n.scope:B.global,n.onItem.call(k,a));else{var e=this;this._jsonFileUrl!==this._ccUrl?(B.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:n}):(this._loadInProgress=!0,k=g.get({url:e._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),k.addCallback(function(k){var g=n.scope?n.scope:B.global;try{e._getItemsFromLoadedData(k),e._loadFinished=!0,e._loadInProgress=!1,a=e._getItemByIdentity(n.identity),n.onItem&&n.onItem.call(g,a),e._handleQueuedFetches()}catch(z){e._loadInProgress=
!1,n.onError&&n.onError.call(g,z)}}),k.addErrback(function(a){e._loadInProgress=!1;n.onError&&n.onError.call(n.scope?n.scope:B.global,a)})):this._jsonData&&(e._getItemsFromLoadedData(e._jsonData),e._jsonData=null,e._loadFinished=!0,a=e._getItemByIdentity(n.identity),n.onItem&&(k=n.scope?n.scope:B.global,n.onItem.call(k,a)))}},_getItemByIdentity:function(g){var a=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,g)&&(a=this._itemsByIdentity[g]):Object.hasOwnProperty.call(this._arrayOfAllItems,
g)&&(a=this._arrayOfAllItems[g]);void 0===a&&(a=null);return a},getIdentityAttributes:function(g){g=this._features["dojo.data.api.Identity"];return g===Number?null:[g]},_forceLoad:function(){var n=this;this._jsonFileUrl!==this._ccUrl?(B.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var a=g.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});a.addCallback(function(a){try{if(!0!==n._loadInProgress&&!n._loadFinished)n._getItemsFromLoadedData(a),n._loadFinished=!0;else if(n._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(e){throw console.log(e),e;}});a.addErrback(function(a){throw a;
})}else this._jsonData&&(n._getItemsFromLoadedData(n._jsonData),n._jsonData=null,n._loadFinished=!0)}});m.extend(y,r);return y})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(B){var m={};B.setObject("dojo.data.util.filter",m);m.patternToRegExp=function(m,x){for(var g="^",w=null,t=0;t<m.length;t++)switch(w=m.charAt(t),w){case "\\":g+=w;t++;g+=m.charAt(t);break;case "*":g+=".*";break;case "?":g+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":g+=
"\\";default:g+=w}g+="$";return x?new RegExp(g,"mi"):new RegExp(g,"m")};return m})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(B,m,y){var x={};B.setObject("dojo.data.util.simpleFetch",x);x.errorHandler=function(g,w){w.onError&&w.onError.call(w.scope||m.global,g,w)};x.fetchHandler=function(g,w){var t=w.abort||null,r=!1,n=w.start?w.start:0,x=w.count&&Infinity!==w.count?n+w.count:g.length;w.abort=function(){r=!0;t&&t.call(w)};var a=w.scope||
m.global;w.store||(w.store=this);w.onBegin&&w.onBegin.call(a,g.length,w);w.sort&&g.sort(y.createSortFunction(w.sort,this));if(w.onItem)for(var k=n;k<g.length&&k<x;++k){var e=g[k];r||w.onItem.call(a,e,w)}w.onComplete&&!r&&(k=null,w.onItem||(k=g.slice(n,x)),w.onComplete.call(a,k,w))};x.fetch=function(g){g=g||{};g.store||(g.store=this);this._fetchItems(g,B.hitch(this,"fetchHandler"),B.hitch(this,"errorHandler"));return g};return x})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(B){var m=
{};B.setObject("dojo.data.util.sorter",m);m.basicComparator=function(m,x){var g=-1;null===m&&(m=void 0);null===x&&(x=void 0);if(m==x)g=0;else if(m>x||null==m)g=1;return g};m.createSortFunction=function(y,x){function g(a,k,g,n){return function(e,p){e=n.getValue(e,a);p=n.getValue(p,a);return k*g(e,p)}}for(var w=[],t,r=x.comparatorMap,n=m.basicComparator,A=0;A<y.length;A++){t=y[A];var a=t.attribute;if(a){t=t.descending?-1:1;var k=n;r&&("string"!==typeof a&&"toString"in a&&(a=a.toString()),k=r[a]||n);
w.push(g(a,t,k,x))}}return function(a,k){for(var e=0;e<w.length;){var g=w[e++](a,k);if(0!==g)return g}return 0}};return m})},"jimu/Query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred jimu/utils jimu/ServiceDefinitionManager esri/tasks/query esri/tasks/QueryTask esri/tasks/FeatureSet".split(" "),function(B,m,y,x,g,w,t,r,n,A){var a=B(null,{queryType:0,nextPageIndex:1,pageSizeOption:null,layerDefinition:null,layerDefinitionDef:null,type1CountDef:null,
type2ObjectIdsDef:null,type3QueryDef:null,sdf:null,url:null,query:null,pageSize:1E3,constructor:function(a){this.sdf=t.getInstance();this.url=a.url;this.query=a.query;this.pageSizeOption=a.pageSize;this.query.outFields&&0!==this.query.outFields.length||(this.query.outFields=["*"]);this.pageSize=0<a.pageSize?a.pageSize:1E3;this.getFeatureCount()},getFeatureCount:function(){return this._getQueryType().then(m.hitch(this,function(a){return 1===a?this._getCountForQueryType1():2===a?this._getCountForQueryType2():
this._getCountForQueryType3()}))},getPageCount:function(){return this.getFeatureCount().then(m.hitch(this,function(a){return 0===a?0:Math.ceil(a/this.pageSize)}))},getAllFeatures:function(){return this.getPageCount().then(m.hitch(this,function(a){if(0<a){for(var e=[],k=1;k<=a;k++)e.push(this.queryByPage(k));return x(e).then(m.hitch(this,function(a){for(var e=[],k=0;k<a.length;k++)a[k].features&&0<a[k].features.length&&(e=e.concat(a[k].features));e=this._setOrderByFieldValue(e);a=a[0];a.features=e;
return a}))}this._getEmptyFeatureSet().then(m.hitch(this,function(a){return a}))}))},_setOrderByFieldValue:function(a){if(2===this.queryType||3===this.queryType){var e=this.query.outFields;a.sort(function(a,k){a=a.attributes[e];k=k.attributes[e];return"string"===typeof a&&"string"===typeof k?a.localeCompare(k):a<k?-1:a===k?0:1})}return a},_getEmptyFeatureSet:function(){var a=new g;this.layerDefinition&&this.layerDefinition.geometryType?a.resolve(this._getEmptyFeatureSetHandler()):this._getLayerDefinition().then(m.hitch(this,
function(){a.resolve(this._getEmptyFeatureSetHandler())}));return a},_getEmptyFeatureSetHandler:function(){var a=new A;a.features=[];a.geometryType=this.layerDefinition.geometryType;a.fields=[];var e=m.clone(this.layerDefinition.fields);0<=this.query.outFields.indexOf("*")?a.fields=e:a.fields=y.filter(e,m.hitch(this,function(a){return 0<=this.query.outFields.indexOf(a.name)}));return a},getCurrentPageIndex:function(){return this.nextPageIndex},queryNextPage:function(){var a=this.nextPageIndex;this.nextPageIndex++;
return this.queryByPage(a)},queryByPage:function(a){var e=null;0>=a?(e=new g,this._getEmptyFeatureSet().then(m.hitch(this,function(a){e.resolve(a)}))):e=this.getPageCount().then(m.hitch(this,function(e){a>e&&this._getEmptyFeatureSet().then(m.hitch(this,function(a){return a}));return 1===this.queryType?this._queryPageForType1(a):2===this.queryType?this._queryPageForType2(a):this._queryPageForType3(a)}));return e},_getQueryType:function(){var k=new g;if(0<this.queryType)k.resolve(this.queryType);else return this._getLayerDefinition().then(m.hitch(this,
function(e){return this.queryType=a.getQueryType(e)}));return k},_getDefStatus:function(a){return a?a.isFulfilled()?a.isResolved()?2:-1:1:0},_getLayerDefinition:function(){0>=this._getDefStatus(this.layerDefinitionDef)&&(this.layerDefinitionDef=this.sdf.getServiceDefinition(this.url).then(m.hitch(this,function(a){this.layerDefinition=a;var e=a.maxRecordCount;0<e&&(!(0<this.pageSizeOption)||this.pageSize>a.maxRecordCount)&&(this.pageSize=e);return this.layerDefinition})));return this.layerDefinitionDef},
_getCountForQueryType1:function(){0>=this._getDefStatus(this.type1CountDef)&&(this.type1CountDef=this._queryCount());return this.type1CountDef},_getCountForQueryType2:function(){return this._getObjectIdsForQueryType2().then(m.hitch(this,function(a){return a.length}))},_getObjectIdsForQueryType2:function(){0>=this._getDefStatus(this.type2ObjectIdsDef)&&(this.type2ObjectIdsDef=this._queryIds());return this.type2ObjectIdsDef},_getCountForQueryType3:function(){return this._doQueryForQueryType3().then(m.hitch(this,
function(a){return(a.features||[]).length}))},_doQueryForQueryType3:function(){0>=this._getDefStatus(this.type3QueryDef)&&(this.type3QueryDef=this._query());return this.type3QueryDef},_queryPageForType1:function(a){return this._queryWithPaginationAndOrder((a-1)*this.pageSize)},_queryPageForType2:function(a){return this._getObjectIdsForQueryType2().then(m.hitch(this,function(e){var k=(a-1)*this.pageSize;e=e.slice(k,k+this.pageSize);return this._queryByObjectIds(e)}))},_queryPageForType3:function(a){return this._doQueryForQueryType3().then(m.hitch(this,
function(e){var k=m.mixin({},e);k.features=[];var g=(a-1)*this.pageSize;k.features=(e.features||[]).slice(g,g+this.pageSize);return k}))},_tryLocaleNumber:function(a){var e=w.localizeNumber(a);if(null===e||void 0===e)e=a;return e},_tryLocaleDate:function(a){var e=w.localizeDate(a);e||(e=a.toLocaleDateString());return e},_getLayerIndexByLayerUrl:function(a){var e=a.lastIndexOf("/");a=a.slice(e+1,a.length);return parseInt(a,10)},_getServiceUrlByLayerUrl:function(a){var e=a.lastIndexOf("/");return a.slice(0,
e)},_isImageServiceLayer:function(a){return-1<a.indexOf("/ImageServer")},_isTable:function(a){return"Table"===a.type},_getObjectIdField:function(){return this.layerDefinition.objectIdField},_query:function(a){var e=new r;e.where=a||this.query.where;e.geometry=this.query.geometry;e.outSpatialReference=this.query.outSpatialReference;e.returnGeometry=this.query.returnGeometry;e.spatialRelationship=this.query.spatialRelationship;e.outFields=this.query.outFields;e.returnDistinctValues=this.query.returnDistinctValues;
return(new n(this.url)).execute(e)},_queryIds:function(){var a=new r;a.where=this.query.where;a.geometry=this.query.geometry;a.returnGeometry=!1;a.spatialRelationship=this.query.spatialRelationship;a.outSpatialReference=this.query.outSpatialReference;return(new n(this.url)).executeForIds(a).then(m.hitch(this,function(a){a||(a=[]);return a}))},_queryByObjectIds:function(a){var e=new g,k=new r;k.returnGeometry=this.query.returnGeometry;k.outSpatialReference=this.query.outSpatialReference;k.spatialRelationship=
this.query.spatialRelationship;k.outFields=this.query.outFields;k.objectIds=a;(new n(this.url)).execute(k).then(m.hitch(this,function(a){e.resolve(a)}),m.hitch(this,function(k){if(400===k.code){var g=this._getObjectIdField(),p="",n=a.length;y.forEach(a,m.hitch(this,function(a,e){p+=g+" \x3d "+a;e!==n-1&&(p+=" OR ")}));this._query(p).then(m.hitch(this,function(a){e.resolve(a)}),m.hitch(this,function(a){e.reject(a)}))}else e.reject(k)}));return e},_queryCount:function(){var a=new r;a.where=this.query.where;
a.geometry=this.query.geometry;a.outSpatialReference=this.query.outSpatialReference;a.spatialRelationship=this.query.spatialRelationship;a.returnGeometry=!1;return(new n(this.url)).executeForCount(a)},_queryWithPaginationAndOrder:function(a){var e=new r;e.where=this.query.where;e.geometry=this.query.geometry;e.outSpatialReference=this.query.outSpatialReference;e.returnGeometry=this.query.returnGeometry;e.spatialRelationship=this.query.spatialRelationship;e.outFields=this.query.outFields;e.returnDistinctValues=
this.query.returnDistinctValues;e.start=a;e.num=this.pageSize;(a=this.query.orderByFields)&&0<a.length&&(e.orderByFields=a,a=y.map(a,m.hitch(this,function(a){return a.split(" ")[0]})),y.forEach(a,m.hitch(this,function(a){0>e.outFields.indexOf(a)&&e.outFields.push(a)})));return(new n(this.url)).execute(e)}});a._isServiceSupportsOrderBy=function(a){var e=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(e=!0);return e};a._isServiceSupportsPagination=function(a){var e=!1;
a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsPagination&&(e=!0);return e};a._isSupportObjectIds=function(a){var e=0;a=a.currentVersion?a:a.toJson().layerDefinition;a.currentVersion&&(e=parseFloat(a.currentVersion));return 10<=e||a.hasOwnProperty("typeIdField")};a.getQueryType=function(k){var e=-1;return e=a._isServiceSupportsOrderBy(k)&&a._isServiceSupportsPagination(k)?1:a._isSupportObjectIds(k)?2:3};return a})},"jimu/shared/AppVersionManager":function(){define(["./BaseVersionManager",
"./utils"],function(B,m){function y(){this.versions=[{version:"1.0",description:"The version embedded in portal 10.3 final.",upgrader:function(m){return m},compatible:!0},{version:"1.1",description:"The version embedded in online3.6, and used in developer edition 1.0.",upgrader:function(m){m.widgetOnScreen&&m.widgetOnScreen.panel&&("themes/FoldableTheme/panels/TitlePanel/Panel"===m.widgetOnScreen.panel.uri||"jimu/BaseWidgetPanel"===m.widgetOnScreen.panel.uri)&&(m.widgetOnScreen.panel.uri="jimu/PreloadWidgetIconPanel");
return m},compatible:!0},{version:"1.2",description:"The version embedded in online3.7.",upgrader:function(m){var g=0;if(m.widgetOnScreen&&m.widgetOnScreen.widgets){for(var w=!1,g=0;g<m.widgetOnScreen.widgets.length;g++)"widgets/Splash/Widget"===m.widgetOnScreen.widgets[g].uri&&(w=!0);w||m.widgetOnScreen.widgets.push({uri:"widgets/Splash/Widget",visible:!1,positionRelativeTo:"browser",version:"1.2"});w=!1;for(g=0;g<m.widgetOnScreen.widgets.length;g++)"widgets/TimeSlider/Widget"===m.widgetOnScreen.widgets[g].uri&&
(w=!0);w||m.widgetOnScreen.widgets.push({uri:"widgets/TimeSlider/Widget",visible:!1,position:{bottom:55,left:7},version:"1.2"});w=!1;for(g=0;g<m.widgetOnScreen.widgets.length;g++)"widgets/Swipe/Widget"===m.widgetOnScreen.widgets[g].uri&&(w=!0);w||m.widgetOnScreen.widgets.push({uri:"widgets/Swipe/Widget",visible:!1,position:{top:145,left:7},version:"1.2"})}return m},compatible:!0},{version:"1.3",description:"The version embedded in online3.8 \x26 online3.9.",upgrader:function(x){(function(g){m.visitElement(g,
function(g){g.positionRelativeTo&&(g.position?g.position.relativeTo=g.positionRelativeTo:g.position={relativeTo:g.positionRelativeTo},g.panel&&(g.panel.position?g.panel.position.relativeTo=g.panel.positionRelativeTo:g.panel.position={relativeTo:g.panel.positionRelativeTo}))});var w=g.widgetOnScreen;w&&w.panel&&w.panel.positionRelativeTo&&(w.panel.position?w.panel.position.relativeTo=w.panel.positionRelativeTo:w.panel.position={relativeTo:w.panel.positionRelativeTo});(w=g.widgetPool)&&w.panel&&w.panel.positionRelativeTo&&
(w.panel.position?w.panel.position.relativeTo=w.panel.positionRelativeTo:w.panel.position={relativeTo:w.panel.positionRelativeTo})})(x);x.widgetOnScreen&&x.widgetOnScreen.panel&&"jimu/PreloadWidgetIconPanel"===x.widgetOnScreen.panel.uri&&(x.widgetOnScreen.panel.uri="jimu/OnScreenWidgetPanel");(function(g){if(g.widgetOnScreen&&g.widgetOnScreen.widgets&&g.theme&&"FoldableTheme"===g.theme.name){var m=null,t=null;if(m=g.widgetOnScreen.widgets[4])void 0!==m.position.top?(m={position:{left:205,top:45}},
t={position:{left:255,top:45}}):(m={position:{left:205,bottom:55}},t={position:{left:255,bottom:55}}),g.widgetOnScreen.widgets.splice(7,0,m,t)}})(x);(function(){for(var g=0,m=0,t=!1,g=0;g<x.widgetOnScreen.widgets.length;g++)if("widgets/Geocoder/Widget"===x.widgetOnScreen.widgets[g].uri){t=!0;break}for(var r=!1,m=0;m<x.widgetOnScreen.widgets.length;m++)if("widgets/Search/Widget"===x.widgetOnScreen.widgets[m].uri){r=!0;break}!r&&t&&(g=x.widgetOnScreen.widgets[g],g.uri="widgets/Search/Widget",g.name=
"Search")})(x);(function(g){for(var m=0,m=g.widgetOnScreen.widgets.length-1;0<=m;m--){var t=g.widgetOnScreen.widgets[m];if("widgets/Swipe/Widget"===t.uri&&!t.closeable&&(g.widgetOnScreen.widgets.splice(m,1),!1!==t.visible)){t.closeable=!0;var r;a:{for(r=r=0;r<g.widgetOnScreen.widgets.length;r++)if(!g.widgetOnScreen.widgets[r].uri)break a;r=-1}0<=r&&(t.position=g.widgetOnScreen.widgets[r].position,g.widgetOnScreen.widgets[r]=t)}"widgets/TimeSlider/Widget"===t.uri&&(!1===t.visible?g.widgetOnScreen.widgets.splice(m,
1):t.closeable=!0)}})(x);x.widgetOnScreen.widgets.push({uri:"widgets/ZoomSlider/Widget",position:{top:5,left:7},version:"1.3"});x.loadingPage||(x.loadingPage={backgroundColor:"#508dca",backgroundImage:{visible:!1},loadingGif:{visible:!0,uri:"configs/loading/images/predefined_loading_1.gif",width:58,height:58}});return x},compatible:!0},{version:"1.4",description:"The version embedded in online3.10.",upgrader:function(m){if(m.theme){var g=m.theme.name;if(("FoldableTheme"===g||"JewelryBoxTheme"===g)&&
m.widgetOnScreen){var w=m.widgetOnScreen.widgets;if(w&&0<w.length)for(var g="themes/"+g+"/widgets/HeaderController/Widget",t=null,r=0;r<w.length;r++)(t=w[r])&&t.uri===g&&t.position&&310===t.position.paddingRight&&(t.position.paddingRight=275)}}return m},compatible:!0},{version:"2.0beta",description:"The version for Developer Edition beta 2.0.",upgrader:function(m){m.keepAppState=!0;return m},compatible:!0},{version:"2.0",description:"The version for Online 4.1.",upgrader:function(m){return m},compatible:!0},
{version:"2.0.1",description:"The version for Developer Edition 2.0.",upgrader:function(m){return m},compatible:!0},{version:"2.1",description:"The version for Online 4.2.",upgrader:function(m){return m},compatible:!0},{version:"2.2",description:"The version for Online 4.3.",upgrader:function(m){return m},compatible:!0},{version:"2.3",description:"The version for Online 4.4.",upgrader:function(m){function g(m,n){if(!m||!n)return!1;for(var r in n)if(n.hasOwnProperty(r))if("object"===typeof n[r]){if(!g(m[r],
n[r]))return!1}else if(m[r]!==n[r])return!1;return!0}function w(m){function n(){var a=g(m[3],{uri:"widgets/MyLocation/Widget",position:{left:15,top:120}}),e=g(m[12],{position:{top:10,right:195}});return a&&e}function r(){var a=g(m[3],{uri:"widgets/MyLocation/Widget",position:{left:15,bottom:45}}),e=g(m[12],{position:{left:15,top:233}});return a&&e}function a(){var a=g(m[3],{uri:"widgets/MyLocation/Widget",position:{left:15,top:120}}),e=g(m[12],{position:{right:15,top:195}});return a&&e}(function(){var a=
g(m[3],{uri:"widgets/MyLocation/Widget",position:{left:15,top:120}}),e=g(m[12],{position:{left:240,top:53}});return a&&e})()?m.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{left:15,top:159},version:"2.3"}):n()?m.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{left:15,top:159},version:"2.3"}):r()?m.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{left:15,bottom:195},version:"2.3"}):a()&&m.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{left:15,
top:159},version:"2.3"})}function t(m){function n(){var a=g(m[9],{uri:"widgets/MyLocation/Widget",position:{left:7,top:110}}),k=g(m[2],{uri:"widgets/Search/Widget",position:{left:55,top:5}}),e=g(m[4],{position:{left:7,bottom:70}});return a&&k&&e}function r(){var a=g(m[9],{uri:"widgets/MyLocation/Widget",position:{left:7,top:110}}),k=g(m[2],{uri:"widgets/Search/Widget",position:{right:2,top:2,relativeTo:"browser"}}),e=g(m[4],{position:{left:7,bottom:70}});return a&&k&&e}(function(){var a=g(m[9],{uri:"widgets/MyLocation/Widget",
position:{left:7,top:110}}),k=g(m[2],{uri:"widgets/Search/Widget",position:{left:55,top:5}}),e=g(m[4],{position:{left:55,top:45}});return a&&k&&e}()||n()||r())&&m.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{top:148,left:7},version:"2.3"})}(function(m,n,x){m=m.theme&&m.theme.name;if("FoldableTheme"===m)if(g(n[11],{uri:"widgets/MyLocation/Widget",position:{left:7,top:110}}))n.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{top:150,left:7},version:"2.3"});else if(g(n[11],
{uri:"widgets/MyLocation/Widget",position:{left:12,bottom:164}}))n.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{left:12,bottom:203},version:"2.3"}),x&&x.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{right:12,top:211},version:"2.3"});else{if(g(n[11],{uri:"widgets/MyLocation/Widget",position:{left:164,bottom:14}})){n.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{left:203,bottom:14,height:30},version:"2.3"});for(m=0;m<n.length;m++){var a=n[m];g(a,{uri:"widgets/Scalebar/Widget",
position:{left:220,bottom:5}})&&(a.position.left=288);g(a,{uri:"widgets/Coordinate/Widget",position:{left:395,bottom:5}})&&(a.position.left=463)}x&&x.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{top:209,left:12},version:"2.3"})}}else if("BillboardTheme"===m)w(n);else if("BoxTheme"===m)n.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{left:10,top:131},version:"2.3"});else if("JewelryBoxTheme"===m)t(n);else if("LaunchpadTheme"===m){if(g(n[6],{uri:"widgets/MyLocation/Widget",
position:{left:25,top:215}})||g(n[6],{uri:"widgets/MyLocation/Widget",position:{left:25,top:215}}))n.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{top:255,left:25},version:"2.3"}),x&&x.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{right:10,bottom:238},version:"2.3"})}else"PlateauTheme"===m?(g(n[6],{uri:"widgets/MyLocation/Widget",position:{left:7,top:110}})&&n.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{top:149,left:7},version:2.3}),g(n[6],{uri:"widgets/MyLocation/Widget",
position:{left:12,bottom:164}})&&n.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{left:12,bottom:201},version:2.3})):"TabTheme"===m&&g(n[11],{uri:"widgets/MyLocation/Widget",position:{left:7,top:110}})&&n.push({uri:"widgets/ExtentNavigate/Widget",visible:!1,position:{top:149,left:7},version:"2.3"})})(m,m.widgetOnScreen.widgets,m.mobileLayout&&m.mobileLayout.widgetOnScreen&&m.mobileLayout.widgetOnScreen.widgets);return m},compatible:!0},{version:"2.4",description:"The version for Online 5.1.",
upgrader:function(m){return m},compatible:!0},{version:"2.5",description:"The version for Online 5.2.",upgrader:function(m){function g(m,t){if(!m||!t)return!1;for(var r in t)if(t.hasOwnProperty(r))if("object"===typeof t[r]){if(!g(m[r],t[r]))return!1}else if(m[r]!==t[r])return!1;return!0}(function(m,t){m=m.theme&&m.theme.name;if("BillboardTheme"===m){m=g(t[8],{position:{left:60,top:53}});var r=g(t[8],{position:{left:15,top:53}});m||r?t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,
top:8},version:"2.5"}):t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,bottom:55},version:"2.5"})}else if("BoxTheme"===m){a:{m=0;for(r=t.length;m<r;m++){var n=t[m];if(n&&n.uri&&"themes/BoxTheme/widgets/BoxController/Widget"===n.uri){m=n;break a}}m=null}g(m,{position:{right:0,bottom:0}})?t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,top:8},version:"2.5"}):t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,bottom:8},version:"2.5"})}else"DartTheme"===
m?t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,top:8},version:"2.5"}):"FoldableTheme"===m?t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,top:8},version:"2.5"}):"DashboardTheme"===m?t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,top:8},version:"2.5"}):"JewelryBoxTheme"===m?t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,top:8},version:"2.5"}):"LaunchpadTheme"===m?t.push({uri:"widgets/FullScreen/Widget",visible:!1,
position:{right:70,top:20},version:"2.5"}):"PlateauTheme"===m?t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,top:8},version:"2.5"}):"TabTheme"===m&&(g(t[7],{position:{left:45,top:45}})?t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,top:8},version:"2.5"}):t.push({uri:"widgets/FullScreen/Widget",visible:!1,position:{right:8,bottom:55},version:"2.5"}))})(m,m.widgetOnScreen.widgets);return m},compatible:!0},{version:"2.6",description:"The version for Online 5.3.",
upgrader:function(m){return m},compatible:!0},{version:"2.7",description:"The version for Online 5.4.",upgrader:function(m){return m},compatible:!0},{version:"2.8",description:"The version for Online 6.1.",upgrader:function(m){function g(g){var m=[];if("object"===typeof g)for(var r in g){var n=g[r];"FeatureStatistics"===n.type&&m.push(n)}return m}(function(m){(m=m.dataSource&&m.dataSource.dataSources)&&(m=g(m))&&m.length&&m.forEach(function(g){(g=g.dataSchema&&g.dataSchema.statistics)&&g.length&&
g.forEach(function(g){if(g&&"count"===g.statisticType&&"count"===g.outStatisticFieldName)g.outStatisticFieldName="STAT_COUNT";else{var n;n=(n=g.outStatisticFieldName)&&n.toUpperCase();g.outStatisticFieldName=n}})})})(m);return m},compatible:!0},{version:"2.9",description:"The version for Online 6.2.",upgrader:function(m){return m},compatible:!0},{version:"2.10",description:"The version for Online 6.3.",upgrader:function(m){return m},compatible:!0},{version:"2.11",description:"The version for Online 6.4.",
upgrader:function(m){return m},compatible:!0}];this.isCompatible=function(m,g){m=this.getVersionIndex(m);g=this.getVersionIndex(g);for(m+=1;m<=g;m++)if(!1===this.versions[m].compatible)return!1;return!0}}y.prototype=new B;return y.prototype.constructor=y})},"jimu/shared/BaseVersionManager":function(){define(function(){return function(){this.versions=[];this.upgrade=function(B,m,y){m=this.getVersionIndex(m);y=this.getVersionIndex(y);if(m>y)throw Error("New version should higher than old version.");
for(m+=1;m<=y;m++)this.versions[m].upgrader&&(B=this.versions[m].upgrader(B));return B};this.getVersionIndex=function(B){B=this.fixVersion(B);var m,y;for(y=0;y<this.versions.length;y++)this.versions[y].version===B&&(m=y);null===B&&(m=-1);void 0===m&&(m=this.versions.length-1);return m};this.fixVersion=function(B){return B?B:null}}})},"jimu/ConfigLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr ./utils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./appConfigResourceUtils ./portalUrlUtils ./AppStateManager esri/IdentityManager esri/config esri/urlUtils esri/arcgis/utils".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K){var N=null,C;C=B(null,{urlParams:null,appConfig:null,rawAppConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(e,k){this._removeHash(e);this.urlParams=e||{};this.widgetManager=a.getInstance();m.mixin(this,k)},loadConfig:function(){console.time("Load Config");return this._tryLoadConfig().then(m.hitch(this,function(a){var k=this.checkConfig(a);if(k)throw Error(k);this.rawAppConfig=m.clone(a);M.getInstance().setRawAppConfig(this.rawAppConfig);
a=this._upgradeAppConfig(a);this._processAfterTryLoad(a);this.appConfig=a;if(this.urlParams.id)return this.loadWidgetsManifest(a).then(m.hitch(this,function(){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(m.hitch(this,function(a){return this.updateNecessaryAttrOfResourceUrlInAppConfig(a,this.urlParams.id)})).then(m.hitch(this,function(){this._configLoaded=!0;this._setDocumentTitle(a);this._readAndSetSharedTheme(a);return this.getAppConfig()}));e.setPortalUrl(a.portalUrl);K.arcgisUrl=z.getBaseItemUrl(a.portalUrl);
return this._proesssWebTierAndSignin(a).then(m.hitch(this,function(){if(this.urlParams.appid){if(window.appInfo.isRunInPortal){var k=z.getStandardPortalUrl(a.portalUrl),k=p.getPortal(k);return A.checkEssentialAppsLicense(this.urlParams.appid,k,e.isInBuilderWindow()).then(m.hitch(this,function(){return this._getAppConfigFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(m.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)}))}),m.hitch(this,
function(a){console.error(a);throw Error(window.jimuNls.essentialAppsLicenseErrorForApp);}))}return this._processNotInPortalAppProtocol(a).then(m.hitch(this,function(a){return this._getAppDataAddTemplateDataFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(m.hitch(this,function(e){e.appData.appConfig&&(a=e.appData.appConfig);a._appData=e.appData;a.templateConfig=e.templateData;a.isTemplateApp=!0;return a}))}))}return this._processNotInPortalAppProtocol(a)})).then(m.hitch(this,function(a){this._processAfterTryLoad(a);
this.appConfig=a;return a.map.itemId?a:(a.map["3D"]?p.getDefaultWebScene(a.portalUrl):p.getDefaultWebMap(a.portalUrl)).then(function(e){a.map.itemId=e;return a})})).then(m.hitch(this,function(a){return this.loadWidgetsManifest(a)})).then(m.hitch(this,function(a){return a._appData?a._appData.values&&a._appData.values.webmap?p.getPortal(a.portalUrl).getItemById(a._appData.values.webmap).then(m.hitch(this,function(e){return A.template.mergeTemplateAppConfigToAppConfig(a,a._appData,e)})):A.template.mergeTemplateAppConfigToAppConfig(a,
a._appData):a})).then(m.hitch(this,function(a){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(m.hitch(this,function(a){return a._wabAppId?this.processResourceInAppConfigForConfigLoader(a,this.urlParams):a.appItemId&&-1<window.JSON.stringify(a).indexOf("${itemId}")?this.updateNecessaryAttrOfResourceUrlInAppConfig(a,a.appItemId):a})).then(m.hitch(this,function(a){this.appConfig=a;this._configLoaded=!0;this._setDocumentTitle(a);this._readAndSetSharedTheme(a);return this.getAppConfig()}))}),m.hitch(this,
function(a){var e=new t;e.reject(a);return e}))},processResourceInAppConfigForConfigLoader:function(a,e){var k=a.portalUrl,g=a.appItemId,n=e.appid,r=new t,z=m.clone(a);this.updateNecessaryAttrOfResourceUrlInAppConfig(z,n).then(function(){if("config"===e.mode){var m=this.getResourceUrlsOfAppConfig(a).result;0!==m.length?p.getItemResources(k,n).then(function(a){if(0===a.length)return m=m.map(function(a){return{resUrl:a}}),u.AddResourcesToItemForAppSave(k,m,g,n).then(function(){r.resolve(z)},function(a){console.warn("Add resource to template based app error:"+
a.message||a);r.resolve(z)});r.resolve(z)},function(a){console.warn("Get resource of template based item error:"+a.message||a);r.resolve(z)}):r.resolve(z)}else r.resolve(z)}.bind(this),function(a){console.warn("Insert appId to resource url of appConfig error:"+a.message||a);r.resolve(z)});return r},getResourceUrlsOfAppConfig:function(a){var e={test:function(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items\/(.)+\/resources\/inConfig\//.test(a)},func:m.hitch(this,function(a){return a.value})};
return A.processItemResourceOfAppConfig(a,e)},updateNecessaryAttrOfResourceUrlInAppConfig:function(a,e){function k(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items\/(.)+\/resources\/inConfig\//.test(a)}function g(a,e){a=r.processItemIDAndTokenOfResources(e.value,a);a=r.setResouceProtocolForHttps(a);var k=e.obj,g=e.key;"number"===typeof e.i?k[g][e.i]=a:k[g]=a;return!0}var n=a.portalUrl,r=this;return p.getPortal(n).getItemById(e).then(m.hitch(this,function(p){p={test:k,func:m.hitch(this,g,
{appId:e,isPublic:"public"===p.access,portalUrl:n})};return A.processItemResourceOfAppConfig(a,p).appConfig}))},setResouceProtocolForHttps:function(a){var e=a;"https:"===window.location.protocol&&(e=a.replace(/^http(s?):\/\//i,"https://"));return e},processItemIDAndTokenOfResources:function(a,k){0<a.indexOf("${itemId}")&&(a=a.replace("${itemId}",k.appId));/(\?|\&)token=.+/.test(a)&&(a=a.replace(/(\?|\&)token=.+/,""));k.isPublic||(k=e.getPortalCredential(k.portalUrl))&&(a+="?token\x3d"+k.token);return a},
_setDocumentTitle:function(a){!window.isBuilder&&a&&a.title&&(document.title=A.stripHTML(a.title))},getAppConfig:function(){var a=m.clone(this.appConfig);a.getConfigElementById=function(a){return A.getConfigElementById(this,a)};a.getConfigElementsByName=function(a){return A.getConfigElementsByName(this,a)};a.visitElement=function(a){A.visitElement(this,a)};this._addAuthorizedCrossOriginDomains(this.portalSelf,a);return a},_addAuthorizedCrossOriginDomains:function(a,k){a&&a.authorizedCrossOriginDomains&&
e.addAuthorizedCrossOriginDomains(a.authorizedCrossOriginDomains);k&&k.authorizedCrossOriginDomains&&e.addAuthorizedCrossOriginDomains(k.authorizedCrossOriginDomains)},checkConfig:function(){return!1},processProxy:function(a){L.defaults.io.alwaysUseProxy=a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.alwaysUseProxy;L.defaults.io.proxyUrl="";L.defaults.io.proxyRules=[];a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.url&&(L.defaults.io.proxyUrl=a.httpProxy.url);a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.rules&&
y.forEach(a.httpProxy.rules,function(a){P.addProxyRule(a)})},addNeedValues:function(a){this._processNoUriWidgets(a);this._processEmptyGroups(a);this._addElementId(a);this._fixRepeatedId(a)},showError:function(a){a&&a.message&&(x.create("div",{"class":"app-error",innerHTML:A.sanitizeHTML(a.message)},document.body),x.setStyle(jimuConfig.loadingId,"display","none"))},_tryLoadConfig:function(){"stemapp"===this.urlParams.id&&(this.urlParams.config=window.appInfo.appPath+"config.json",delete this.urlParams.id);
if(this.urlParams.config)return this.configFile=this.urlParams.config,n(this.configFile,{handleAs:"json",headers:{"X-Requested-With":null}}).then(m.hitch(this,function(a){e.setPortalUrl(a.portalUrl);a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?e.registerToken(this.urlParams.token).then(function(){return a}):a}));if(this.urlParams.id){window.appInfo.isRunInPortal=!0;var a=z.getPortalUrlFromLocation(),k=new t;e.setPortalUrl(a);window.portalUrl=a;K.arcgisUrl=z.getBaseItemUrl(a);
var g;this.urlParams.token?g=e.registerToken(this.urlParams.token):(g=new t,g.resolve());g.then(m.hitch(this,function(){var g=p.getPortal(a);g.loadSelfInfo().then(m.hitch(this,function(p){this.portalSelf=p;p.allSSL&&"http:"===window.location.protocol?(console.log("redirect from http to https"),window.location.href=z.setHttpsProtocol(window.location.href),k.reject()):this._processSignIn(a).then(m.hitch(this,function(){this._getAppConfigFromAppId(a,this.urlParams.id).then(m.hitch(this,function(a){return A.checkEssentialAppsLicense(this.urlParams.id,
g,e.isInBuilderWindow()).then(m.hitch(this,function(){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)}),m.hitch(this,function(a){console.error(a);throw Error(window.jimuNls.essentialAppsLicenseErrorForApp);}))})).then(function(a){k.resolve(a)},function(a){k.reject(a)})}))}))}),m.hitch(this,function(a){this.showError(a)}));return k}this.configFile="config.json";return n(this.configFile,{handleAs:"json"}).then(m.hitch(this,function(a){e.setPortalUrl(a.portalUrl);
a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?e.registerToken(this.urlParams.token).then(function(){return a}):a}))},_upgradeAppConfig:function(a){var e=window.wabVersion,k=a.wabVersion;a.configWabVersion=a.wabVersion;if(e===k)return a;var g=this.versionManager.getVersionIndex(k),p=this.versionManager.getVersionIndex(e);if(g>p)throw Error("Bad version number, "+k);a=this.versionManager.upgrade(a,k,e);a.wabVersion=e;return a},loadAndUpgradeAllWidgetsConfig:function(a){var e=
new t,g=[];k.visitElement(a,m.hitch(this,function(a){a.uri&&(a=this.widgetManager.tryLoadWidgetConfig(a),g.push(a))}));r(g).then(m.hitch(this,function(){e.resolve(a)}),function(a){e.reject(a)});return e},_processAfterTryLoad:function(a){this._setPortalUrl(a);this._tryUpdateAppConfigByLocationUrl(a);this._processUrlParams(a);this.addNeedValues(a);this.processProxy(a);I.tokenValidity=10080;return a},_readAndSetSharedTheme:function(a){a.theme.sharedTheme||(a.theme.sharedTheme={useHeader:!1,useLogo:!1},
a.theme.sharedTheme.isPortalSupport=this.portalSelf.portalProperties&&this.portalSelf.portalProperties.sharedTheme?!0:!1);a.theme.sharedTheme.useHeader&&(a.theme.sharedTheme.isPortalSupport&&this.portalSelf.portalProperties?(a.theme.customStyles={mainBackgroundColor:this.portalSelf.portalProperties.sharedTheme.header.background},a.titleColor=this.portalSelf.portalProperties.sharedTheme.header.text):console.error("Portal does not support sharedTheme."));a.theme.sharedTheme.useLogo&&(a.theme.sharedTheme.isPortalSupport&&
this.portalSelf.portalProperties?(a.logo=this.portalSelf.portalProperties.sharedTheme.logo.small?this.portalSelf.portalProperties.sharedTheme.logo.small:"images/app-logo.png",!a.logoLink&&this.portalSelf.portalProperties.sharedTheme.logo.link&&(a.logoLink=this.portalSelf.portalProperties.sharedTheme.logo.link)):(console.error("Portal does not support sharedTheme, use default logo."),a.logo="images/app-logo.png"))},_tryUpdateAppConfigByLocationUrl:function(a){if(!(this.urlParams.config&&-1<this.urlParams.config.indexOf("arcgis.com/sharing/rest/content/items/"))){var e=
z.getPortalUrlFromLocation(),e=z.getStandardPortalUrl(e);z.isOnline(e)&&(e=z.updateUrlProtocolByOtherUrl(e,a.portalUrl),a.map.portalUrl&&z.isSamePortalUrl(a.portalUrl,a.map.portalUrl)&&(a.map.portalUrl=e),a.portalUrl=e,a.httpProxy&&a.httpProxy.url&&(a.httpProxy.url=z.getPortalProxyUrl(e)))}},_processWidgetJsons:function(a){k.visitElement(a,function(a,e){e.isWidget&&a.uri&&A.widgetJson.processWidgetJson(a)})},_processNoUriWidgets:function(a){var e=0;k.visitElement(a,function(a,k){k.isWidget&&!a.uri&&
(e++,a.placeholderIndex=e)})},_processEmptyGroups:function(a){var e=0;a.widgetOnScreen.groups&&y.forEach(a.widgetOnScreen.groups,function(a){if(!a.widgets||a.widgets&&0===a.widgets.length)e++,a.placeholderIndex=e})},_addElementId:function(a){var e=0,g;k.visitElement(a,function(a){if(a.id){a.id=a.id.replace(/\//g,"_");var k=a.id.lastIndexOf("_");-1<k&&(g=a.id.substr(k+1),e=Math.max(e,g))}});k.visitElement(a,function(a){a.id||(e++,a.id=a.itemId?a.itemId+"_"+e:a.uri?a.uri.replace(/\//g,"_")+"_"+e:"_"+
e)})},_setPortalUrl:function(a){if(a.portalUrl){var e=z.getPortalUrlFromLocation(),k=z.isOnline(e);z.isSamePortalUrl(a.portalUrl,e)||k||(window.appInfo.isRunInPortal=!1)}else window.isXT&&w("wab_portalurl")?a.portalUrl=w("wab_portalurl"):(window.appInfo.isRunInPortal=!0,a.portalUrl=z.getPortalUrlFromLocation())},_changePortalUrlProtocol:function(a,e){a.portalUrl=z.setProtocol(a.portalUrl,e);a.map.portalUrl&&(a.map.portalUrl=z.setProtocol(a.map.portalUrl,e));a.httpProxy&&(a.httpProxy.url=z.setProtocol(a.httpProxy.url,
e),a.httpProxy&&a.httpProxy.rules&&y.forEach(a.httpProxy.rules,m.hitch(this,function(a){a.proxyUrl=z.setProtocol(a.proxyUrl,e)})))},_processInPortalAppProtocol:function(a){var e=new t,k=p.getPortal(a.portalUrl),g=m.hitch(this,function(k){if("https:"===window.location.protocol)this._changePortalUrlProtocol(a,"https");else{if(k){console.log("redirect from http to https");window.location.href=z.setHttpsProtocol(window.location.href);e.reject();return}this._changePortalUrlProtocol(a,"http")}this._checkLocale();
e.resolve(a)});k.loadSelfInfo().then(m.hitch(this,function(e){this.portalSelf=e;"private"===e.access?(e=0===a.portalUrl.toLowerCase().indexOf("https://"),g(e)):g(e.allSSL)}),m.hitch(this,function(a){e.reject(a)}));return e},_processNotInPortalAppProtocol:function(a){var k=new t;a.portalUrl?p.getPortal(a.portalUrl).loadSelfInfo().then(m.hitch(this,function(g){this.portalSelf=g;var p="https:"===window.location.protocol;(g.allSSL||p)&&this._changePortalUrlProtocol(a,"https");0!==a.portalUrl.toLowerCase().indexOf("https://")||
p||e.isInConfigOrPreviewWindow()?k.resolve(a):(console.log("redirect from http to https"),window.location.href=z.setHttpsProtocol(window.location.href),k.reject())}),m.hitch(this,function(a){k.reject(a)})):k.resolve(a);return k},_proesssWebTierAndSignin:function(a){var e=new t,k=!1,g=a.portalUrl;this._processWebTier(a).then(m.hitch(this,function(a){k=a;return p.getPortal(g).loadSelfInfo()})).then(m.hitch(this,function(a){this.portalSelf=a;return this._processSignIn(g,k)})).then(m.hitch(this,function(){e.resolve()}),
function(a){e.reject(a)});return e},_processWebTier:function(a){var k=new t,g=a.portalUrl;a.isWebTier?(e.addAuthorizedCrossOriginDomains([g]),e.isWebTierPortal(g).then(m.hitch(this,function(){var p=e.getPortalCredential(g);p&&p.ssl&&"http:"===window.location.protocol&&!e.isInConfigOrPreviewWindow()?(console.log("redirect from http to https"),window.location.href=z.setHttpsProtocol(window.location.href)):k.resolve(a.isWebTier)}),m.hitch(this,function(a){k.reject(a)}))):k.resolve(!1);return k},_processSignIn:function(a,
k){var g=new t,n=p.getPortal(a),r=z.getSharingUrl(a);window.appInfo.isRunInPortal?(k=I.checkSignInStatus(r),k.promise.always(m.hitch(this,function(){g.resolve()}))):(!e.isInBuilderWindow()&&!e.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&this.rawAppConfig&&this.rawAppConfig.appId&&!k&&e.registerOAuthInfo(a,this.rawAppConfig.appId),k=I.checkSignInStatus(r),k.promise.always(m.hitch(this,function(){e.xtGetCredentialFromCookie(a);n.loadSelfInfo().then(m.hitch(this,function(a){this.portalSelf=
a;this._checkLocale();g.resolve()}))})));return g},_checkLocale:function(){if(!e.isInConfigOrPreviewWindow()){var a=this.portalSelf.user&&this.portalSelf.user.culture||g.locale,a=a.toLowerCase();!this.urlParams.locale&&A.isLocaleChanged(g.locale,a)&&(w("wab_app_locale",a),window.location.reload())}},_getAppConfigFromTemplateAppId:function(a,e){var k=p.getPortal(a);return this._getWabAppIdAndDataFromTemplateAppId(a,e).then(m.hitch(this,function(e){var g=e.appId,p=e.appData;return r([this._getAppConfigFromAppId(a,
g),k.getItemData(p.source)]).then(m.hitch(this,function(a){var e;p.appConfig?(e=p.appConfig,delete p.appConfig):e=a[0];e=this._upgradeAppConfig(e);a=a[1];e._appData=p;e._wabAppId=g;e.templateConfig=a;e.isTemplateApp=!0;return e}))}))},_getAppDataAddTemplateDataFromTemplateAppId:function(a,e){var k=p.getPortal(a);return k.getItemData(e).then(function(a){return k.getItemData(a.source).then(function(e){return{appData:a,templateData:e}})})},_getWabAppIdAndDataFromTemplateAppId:function(a,e){var k=new t,
g=p.getPortal(a);g.getItemData(e).then(m.hitch(this,function(a){g.getItemById(a.source).then(m.hitch(this,function(e){e=P.urlToObject(e.url);k.resolve({appId:e.query.id,appData:a})}))}),function(a){k.reject(a)});return k},_getAppConfigFromAppId:function(a,e){return p.getPortal(a).getItemData(e)},_removeHash:function(a){for(var e in a)a[e]&&(a[e]=a[e].replace("#",""))},loadWidgetsManifest:function(a){function e(e,k,n){function m(k){return e.loadWidgetManifest(k).then(function(a){return a},function(e){console.log("Widget failed to load, it is removed.",
k.name);e.stack?console.error(e.stack):console.log(e);g(a,k)})}return k.itemId?p.getPortal(n).getItemById(k.itemId).then(function(a){k.uri=A.widgetJson.getUriFromItem(a);return m(k)},function(e){console.log("Widget is not loaded, it is removed.",k.name,e);g(a,k)}):m(k)}function g(a,e){function k(k){a[k]&&a[k].widgets&&(a[k].widgets=a[k].widgets.filter(function(a){if(e)return a.id!==e.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}));
a[k]&&a[k].groups&&a[k].groups.forEach(function(a){a.widgets&&(a.widgets=a.widgets.filter(function(a){if(e)return a.id!==e.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}))})}k("widgetOnScreen");k("widgetPool")}var n=[],u=new t;this.urlParams.manifest&&a._buildInfo&&a._buildInfo.widgetManifestsMerged&&delete a._buildInfo.widgetManifestsMerged;a._buildInfo&&a._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(m.hitch(this,
function(g){k.visitElement(a,m.hitch(this,function(k){k.widgets||!k.uri&&!k.itemId||(k.uri&&g[k.uri]?(this._addNeedValuesForManifest(g[k.uri],k.uri),A.widgetJson.addManifest2WidgetJson(k,g[k.uri])):n.push(e(this.widgetManager,k,a.portalUrl)))}));r(n).then(function(){u.resolve(a)})})):(k.visitElement(a,m.hitch(this,function(k){k.widgets||!k.uri&&!k.itemId||n.push(e(this.widgetManager,k,a.portalUrl))})),r(n).then(function(){u.resolve(a)}));setTimeout(function(){u.isResolved()||(g(a),u.resolve(a))},
6E4);return u},_addNeedValuesForManifest:function(a,e){m.mixin(a,A.getUriInfo(e));A.manifest.addManifestProperies(a);A.manifest.processManifestLabel(a,g.locale)},_loadMergedWidgetManifests:function(){return n(window.appInfo.appPath+"widgets/widgets-manifest.json",{handleAs:"json"})},_fixRepeatedId:function(a){var e=[];k.visitElement(a,function(a){0<=e.indexOf(a.id)&&(a.id+="_");e.push(a.id)})},_processUrlParams:function(a){var e=this.urlParams.itemid||this.urlParams.webmap;e&&a.map.itemId!==e&&(a.map.mapOptions&&
A.deleteMapOptions(a.map.mapOptions),a.map.itemId=e);this.urlParams.mode&&(a.mode=this.urlParams.mode);a.map.mapOptions||(a.map.mapOptions={});this.urlParams.scale&&(a.map.mapOptions.scale=this.urlParams.scale);if(this.urlParams.level||this.urlParams.zoom)a.map.mapOptions.zoom=this.urlParams.level||this.urlParams.zoom}});C.getInstance=function(a,e){null===N?N=new C(a,e):(N.urlParams=a||{},N.options=e);return N};return C})},"jimu/appConfigResourceUtils":function(){define(["dojo/Deferred","dojo/promise/all",
"jimu/portalUtils","jimu/utils"],function(B,m,y,x){return{AddResourcesToItemForAppSave:function(g,w,t,r){w=w||[];if(0===w.length){var n=new B;n.resolve(w);return n}w=w.map(function(g){var a=g.resUrl.split("resources/")[1],k=new B;g.b64?(g=x.b64toBlob(g.b64),k.resolve({blob:g,fileName:a.split("/")[1],prefixName:a.split("/")[0]})):(g=g.resUrl,0<g.indexOf("${itemId}")&&(g=g.replace("${itemId}",t)),x.resourcesUrlToBlob(g).then(function(e){k.resolve({blob:e,fileName:a.split("/")[1],prefixName:a.split("/")[0]},
function(a){console.error(a.message||a);k.reject(a)})}));return k});return m(w).then(function(n){if(n instanceof Array&&0<n.length)return n=n.map(function(a){var k=t;r&&(k=r);return y.addResource(g,k,a.blob,a.fileName,a.prefixName)}.bind(this)),m(n).then(function(a){return a})}.bind(this))}}})},"jimu/AppStateManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/json esri/geometry/Extent esri/SpatialReference libs/storejs/store libs/md5/md5 jimu/tokenUtils".split(" "),function(B,
m,y,x,g,w,t,r,n){var A=null,a=B(null,{rawAppConfig:null,mapMd5:null,appStateKey:null,setRawAppConfig:function(a){this.rawAppConfig=a},_getAppStateMd5:function(){if("string"!==typeof this.mapMd5){var a=x.stringify(this.rawAppConfig.map);this.mapMd5=r(a)}return this.mapMd5},_getAppStateKey:function(){return this.appStateKey?this.appStateKey:this.appStateKey="wab_appstate_"+this.urlParams.id||this.urlParams.appid||window.path},getWabAppState:function(){var a=new y,e={};if(n.isInConfigOrPreviewWindow()||
!this.rawAppConfig||!this.rawAppConfig.map)return a.resolve(e),a;var p=this._getAppStateKey(),m=t.get(p);m&&m.appStateMd5===this._getAppStateMd5()?(p=m.map&&m.map.extent,m=m.map&&m.map.layers,p&&(e.extent=new g(p.xmin,p.ymin,p.xmax,p.ymax,new w(p.spatialReference))),m&&(e.layers=m)):t.remove(p);a.resolve(e);return a},saveWabAppState:function(a,e){if(a&&!n.isInConfigOrPreviewWindow()){var k=this._getAppStateKey(),g={extent:{xmin:a.extent.xmin,xmax:a.extent.xmax,ymin:a.extent.ymin,ymax:a.extent.ymax,
spatialReference:{wkid:a.extent.spatialReference.wkid,wkt:a.extent.spatialReference.wkt}},layers:{}};e&&e.traversal&&e.traversal(m.hitch(this,function(a){g.layers[a.id]={visible:a.isVisible()}}));t.set(k,{map:g,appStateMd5:this._getAppStateMd5()})}}});a.getInstance=function(k){null===A&&(A=new a);A.urlParams=k;return A};return a})},"jimu/dijit/AGOLLoading":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/AGOLLoading.html","dojo/_base/html"],
function(B,m,y,x,g){return B([m,y],{baseClass:"jimu-agol-loading",declaredClass:"jimu.dijit.AGOLLoading",templateString:x,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&g.setStyle(this.domNode,"display","none");g.setStyle(this.domNode,{width:"100%",height:"100%"});this.showLoading||g.setStyle(this.imgDiv,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=
this.loadingText)},show:function(m){this.domNode&&this.hidden&&("string"===typeof m&&(this.textNode.innerHTML=m),g.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(g.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/LayoutManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dojo/topic dojo/on dojo/query dojo/Deferred dojo/promise/all dojo/debounce require ./MapManager ./utils".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e){var p=null,u;u=B([x],{constructor:function(a,k){this.own(g.subscribe("appConfigLoaded",m.hitch(this,this._onAppConfigLoaded)));this.own(g.subscribe("appConfigChanged",m.hitch(this,this._onAppConfigChanged)));this.own(g.subscribe("mapLoaded",m.hitch(this,this._onMapLoaded)));this.own(g.subscribe("mapChanged",m.hitch(this,this._onMapChanged)));this.own(g.subscribe("beforeMapDestory",m.hitch(this,this._onBeforeMapDestory)));this.own(g.subscribe("preloadModulesLoaded",
m.hitch(this,this._onPreloadModulesLoaded)));this.own(g.subscribe("openWidget",m.hitch(this,this._onOpenWidgetRequest)));this.own(g.subscribe("builder/actionTriggered",m.hitch(this,this._onActionTriggered)));e.isMobileUa()||this.own(w(window,"resize",A(m.hitch(this,this.resize),200)));this.id=k;this.preloadModulesLoadDef=new r},postCreate:function(){this.containerNode=this.domNode},map:null,mapId:"map",mapDiv:null,hlDiv:null,layoutManager:null,animTime:500,resize:function(){this.layoutManager&&this.layoutManager.resize()},
_onAppConfigLoaded:function(a){this.appConfig=m.clone(a);this.preloadModulesLoadDef.then(m.hitch(this,function(){this._loadLayoutManager(this.appConfig).then(m.hitch(this,function(a){this.layoutManager=a;this.layoutManager.onEnter(this.appConfig,this.mapId).then(m.hitch(this,function(){this.mapDiv=this.layoutManager.getMapDiv();this._loadMap(this.mapId);this.appConfig.theme&&this._loadTheme(this.appConfig.theme)}))}))}))},_loadLayoutManager:function(e){e=e.layoutDefinition?e.layoutDefinition.manager:
"jimu/layoutManagers/AbsolutePositionLayoutManager";var k=new r;a([e],m.hitch(this,function(a){a=a.getInstance();this.map&&a.setMap(this.map);k.resolve(a)}));return k},_loadMap:function(a){this.mapManager=k.getInstance({appConfig:this.appConfig,urlParams:this.urlParams},a);this.mapManager.showMap()},_onMapLoaded:function(a){this.map=a;this.layoutManager.setMap(a);this.layoutManager.loadAndLayout(this.appConfig)},_onPreloadModulesLoaded:function(){this.preloadModulesLoadDef.resolve()},_loadTheme:function(e){var k=
new r;a(["themes/"+e.name+"/main"],m.hitch(this,function(){n([this._loadThemeCommonStyle(e),this._loadThemeCurrentStyle(e)]).then(m.hitch(this,function(){this._addCustomStyle(e);this.layoutManager.onThemeLoad();k.resolve()}))}));return k},_loadThemeCommonStyle:function(a){y.addClass(this.domNode,a.name);return e.loadStyleLink(this._getThemeCommonStyleId(a),"themes/"+a.name+"/common.css")},_loadThemeCurrentStyle:function(a){y.addClass(this.domNode,a.styles[0]);return e.loadStyleLink(this._getThemeCurrentStyleId(a),
"themes/"+a.name+"/styles/"+a.styles[0]+"/style.css")},_addCustomStyle:function(a){var e=m.getObject("customStyles",!1,a);if(e){var k=".jimu-main-background{background-color: ${mainBackgroundColor} !important;}";(a=this._getFixedThemeStyles(a))&&(k+=a);k=m.replace(k,e,/\$\{([^\}]+)\}/g);e=y.create("style",{type:"text/css"});try{e.appendChild(document.createTextNode(k))}catch(L){e.styleSheet.cssText=k}e.setAttribute("source","custom");document.head.appendChild(e)}},_getFixedThemeStyles:function(k){var g=
".esriPopup .titlePane {background-color: ${mainBackgroundColor} !important;}";if(k.customStyles.mainBackgroundColor&&e.isLightColor(k.customStyles.mainBackgroundColor))var p=a.toUrl("jimu")+"/css/images/api_popup_light.png",g=g+(".esriPopup .titleButton {background: url("+p+") no-repeat}")+".esriPopup .titlePane {color: black}";"PlateauTheme"===k.name?g+=".jimu-widget-header-controller .jimu-title, .jimu-widget-header-controller .jimu-subtitle{color: ${mainBackgroundColor} !important;}.jimu-widget-header-controller .links .jimu-link{color: ${mainBackgroundColor} !important;}.jimu-widget-homebutton .HomeButton .home, .jimu-widget-mylocation, .jimu-widget-mylocation .place-holder, .jimu-widget-zoomslider.vertical .zoom-in, .jimu-widget-zoomslider.vertical .zoom-out, .jimu-widget-extent-navigate.vertical .operation{background-color: ${mainBackgroundColor} !important;}.jimu-preload-widget-icon-panel \x3e .jimu-panel-title, .jimu-foldable-panel \x3e .jimu-panel-title, .jimu-title-panel \x3e .title{color: ${mainBackgroundColor} !important;}.jimu-panel{border-color: ${mainBackgroundColor} !important;}.jimu-widget-header-controller{border-bottom-color: ${mainBackgroundColor} !important;}.jimu-tab\x3e.control\x3e.tab{color: ${mainBackgroundColor} !important; border-color: ${mainBackgroundColor} !important}":
"BillboardTheme"===k.name?g+=".jimu-widget-homebutton .HomeButton .home, .jimu-widget-mylocation .place-holder, .jimu-widget-zoomslider.vertical .zoom-in, .jimu-widget-zoomslider.vertical .zoom-out, .jimu-widget-extent-navigate .operation, .jimu-widget-fullScreen .fullScreen, .jimu-widget-mylocation .place-holder.nohttps:hover, .jimu-widget-extent-navigate .operation.jimu-state-disabled:hover{background-color: ${mainBackgroundColor} !important; opacity: 0.8;}.jimu-widget-onscreen-icon{background-color: ${mainBackgroundColor} !important; opacity: 0.8;}.jimu-widget-homebutton .HomeButton .home:hover, .jimu-widget-mylocation .place-holder:not(.nohttps):hover, .jimu-widget-zoomslider.vertical .zoom-in:hover, .jimu-widget-zoomslider.vertical .zoom-out:hover, .jimu-widget-extent-navigate .operation:not(.jimu-state-disabled):hover, .jimu-widget-fullScreen .fullScreen:hover, .jimu-widget-onscreen-icon:hover, .jimu-widget-onscreen-icon.jimu-state-selected{opacity: 1;}":
"BoxTheme"===k.name?g+=".jimu-widget-homebutton .HomeButton .home, .jimu-widget-mylocation .place-holder, .jimu-widget-zoomslider.vertical .zoom-in, .jimu-widget-zoomslider.vertical .zoom-out, .jimu-widget-extent-navigate .operation, .jimu-widget-fullScreen .fullScreen{background-color: ${mainBackgroundColor} !important; opacity: 0.8;}.jimu-main-background.jimu-widget-zoomslider{background-color: transparent !important}.jimu-widget-homebutton .HomeButton .home:hover, .jimu-widget-mylocation .place-holder:not(.nohttps):hover, .jimu-widget-zoomslider.vertical .zoom-in:hover, .jimu-widget-zoomslider.vertical .zoom-out:hover, .jimu-widget-zoomslider .zoom:hover, .jimu-widget-extent-navigate .operation:not(.jimu-state-disabled):hover, .jimu-widget-fullScreen .fullScreen:hover{background-color: ${mainBackgroundColor} !important; opacity: 1;}":
"TabTheme"===k.name?g+=".tab-widget-frame .title-label{color: ${mainBackgroundColor} !important;}":"DashboardTheme"===k.name?g+=".jimu-widget-dnd-header{background-color: ${mainBackgroundColor} !important;}":"DartTheme"===k.name?g+=".jimu-widget-fullScreen .fullScreen{background-color: ${mainBackgroundColor} !important;}.dart-controller-extent-navigate .jimu-widget-extent-navigate .operation.jimu-state-disabled,.dart-controller-extent-navigate .jimu-widget-extent-navigate .operation.jimu-state-disabled:hover{color: ${mainBackgroundColor} !important; opacity: 0.6;}.dart-controller-extent-navigate .jimu-widget-extent-navigate .operation,.dart-controller-extent-navigate .jimu-widget-extent-navigate .operation:hover{color: ${mainBackgroundColor} !important; opacity: 1;}":
"PocketTheme"===k.name&&(g+=".jimu-main-background, .jimu-widget-homebutton, .jimu-widget-mylocation, .jimu-widget-onscreen-icon, .jimu-widget-onscreen-icon.jimu-state-selected, .jimu-widget-zoomslider .zoom, .jimu-widget-homebutton .HomeButton .home, .jimu-widget-mylocation .place-holder, .jimu-widget-extent-navigate .operation, .jimu-widget-fullScreen .fullScreen, .esriPopup .titlePane, .esriPopupMobile .titlePane, .esriPopup .pointer.top{background-color: ${mainBackgroundColor} !important;}.esriMobileNavigationBar{background-color: ${mainBackgroundColor} !important; background-image: none !important;}");
return g},_onAppConfigChanged:function(a,e,k){a=m.clone(a);switch(e){case "themeChange":this._onThemeChange(a);break;case "styleChange":this._onStyleChange(a);break;case "layoutChange":this._onLayoutChange(a);break;case "widgetChange":this._onWidgetChange(a,k);break;case "groupChange":this._onGroupChange(a,k);break;case "widgetPoolChange":this._onWidgetPoolChange(a,k);break;case "resetConfig":this._onResetConfig(a);break;case "loadingPageChange":this._onLoadingPageChange(a,k);break;case "layoutDefinitionChange":this._onLayoutDefinitionChange(a,
k);break;case "onScreenGroupsChange":this._onOnScreenGroupsChange(a,k);break;case "onScreenOrderChange":this._onOnScreenOrderChange(a,k)}this.appConfig=a},_onMapChanged:function(a){this.map=a;this.layoutManager.setMap(a);this.layoutManager.loadAndLayout(this.appConfig)},_onBeforeMapDestory:function(){this.layoutManager.destroyOnScreenWidgetsAndGroups()},_onThemeChange:function(a){this.layoutManager.destroyOnScreenWidgetsAndGroups();this._removeThemeCommonStyle(this.appConfig.theme);this._removeThemeCurrentStyle(this.appConfig.theme);
this._removeCustomStyle();n([this._loadLayoutManager(a),this._loadTheme(a.theme)]).then(m.hitch(this,function(e){var k=e[0];this.layoutManager.name!==k.name?(this.layoutManager.onLeave(),k.onEnter(a,this.mapId).then(m.hitch(this,function(){this.layoutManager=k;this.layoutManager.loadAndLayout(a)}))):this.layoutManager.loadAndLayout(a)}))},_onResetConfig:function(a){var e=this.appConfig;g.publish("appConfigChanged",a,"mapChange",a);this.appConfig=e;this._loadLayoutManager(a).then(m.hitch(this,function(a){this.layoutManager=
a;this._removeThemeCommonStyle(this.appConfig.theme);this._removeThemeCurrentStyle(this.appConfig.theme);this._removeCustomStyle();this._loadTheme(this.appConfig.theme)}))},_onLoadingPageChange:function(a,e){"backgroundColor"in e?y.setStyle(jimuConfig.loadingId,"background-color",a.loadingPage.backgroundColor):"backgroundImage"in e?(a=a.loadingPage.backgroundImage,a.visible&&a.uri?(y.setStyle(jimuConfig.loadingImageId,"background-image","url('"+a.uri+"')"),y.setStyle(jimuConfig.loadingImageId,"width",
a.width+"px"),y.setStyle(jimuConfig.loadingImageId,"height",a.height+"px")):(y.setStyle(jimuConfig.loadingImageId,"background-image","url('')"),y.setStyle(jimuConfig.loadingImageId,"width","0px"),y.setStyle(jimuConfig.loadingImageId,"height","0px"))):"loadingGif"in e&&(a=a.loadingPage.loadingGif,a.visible&&a.uri?(y.setStyle(jimuConfig.loadingGifId,"background-image","url('"+a.uri+"')"),y.setStyle(jimuConfig.loadingGifId,"width",a.width+"px"),y.setStyle(jimuConfig.loadingGifId,"height",a.height+"px")):
(y.setStyle(jimuConfig.loadingGifId,"background-image","url('')"),y.setStyle(jimuConfig.loadingGifId,"width","0px"),y.setStyle(jimuConfig.loadingGifId,"height","0px")))},_onStyleChange:function(a){this._removeThemeCurrentStyle(this.appConfig.theme);this._loadThemeCurrentStyle(a.theme);this._removeCustomStyle();this._addCustomStyle(a.theme)},_onLayoutChange:function(a){this.layoutManager.onLayoutChange(a)},_onWidgetChange:function(a,e){this.layoutManager.onWidgetChange(a,e)},_onGroupChange:function(a,
e){this.layoutManager.onGroupChange(a,e)},_onWidgetPoolChange:function(a,e){this.layoutManager.onWidgetPoolChange(a,e)},_onActionTriggered:function(a){this.layoutManager.onActionTriggered(a)},_onLayoutDefinitionChange:function(a,e){this.layoutManager.onLayoutDefinitionChange(a,e)},_onOnScreenGroupsChange:function(a,e){this.layoutManager.onOnScreenGroupsChange(a,e)},_onOnScreenOrderChange:function(a,e){this.layoutManager.onOnScreenOrderChange(a,e)},_removeThemeCommonStyle:function(a){y.removeClass(this.domNode,
a.name);y.destroy(this._getThemeCommonStyleId(a))},_removeThemeCurrentStyle:function(a){y.removeClass(this.domNode,a.styles[0]);y.destroy(this._getThemeCurrentStyleId(a))},_removeCustomStyle:function(){t('style[source\x3d"custom"]',document.head).forEach(function(a){y.destroy(a)})},_getThemeCommonStyleId:function(a){return"theme_"+a.name+"_style_common"},_getThemeCurrentStyleId:function(a){return"theme_"+a.name+"_style_"+a.styles[0]},_doPostLoad:function(){a(["dynamic-modules/postload"])},_onOpenWidgetRequest:function(a){this.layoutManager.openWidget(a)}});
u.getInstance=function(a,e){null===p&&(p=new u(a,e),window._layoutManager=p);return p};return u})},"jimu/MapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/topic dojo/on dojo/aspect dojo/keys dojo/i18n dojo/_base/config esri/dijit/InfoWindow esri/dijit/PopupMobile esri/InfoTemplate esri/request esri/arcgis/utils esri/geometry/Extent esri/geometry/Point require ./utils jimu/LayerInfos/LayerInfos jimu/dijit/Message jimu/dijit/AppStatePopup ./MapUrlParamsHandler ./AppStateManager ./PopupManager ./FilterManager".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C,J,O,R,Q){var T=null,S=B(null,{appConfig:null,mapDivId:"",map:null,previousInfoWindow:null,mobileInfoWindow:null,isMobileInfoWindow:!1,layerInfosObj:null,constructor:function(a,e){this.appConfig=a.appConfig;this.urlParams=a.urlParams;this.id=this.mapDivId=e;this.appStateManager=O.getInstance(this.urlParams);this.popupManager=R.getInstance(this);this.filterManager=Q.getInstance();this.nls=window.jimuNls;w.subscribe("appConfigChanged",m.hitch(this,
this.onAppConfigChanged));w.subscribe("syncExtent",m.hitch(this,this.onSyncExtent));w.subscribe("mapContentModified",m.hitch(this,this.onMapContentModified));t(window,"resize",m.hitch(this,this.onWindowResize));t(window,"beforeunload",m.hitch(this,this.onBeforeUnload))},showMap:function(){this._showMap(this.appConfig)},_showMap:function(a){console.time("Load Map");a.map["3D"]?a.map.itemId?this._show3DWebScene(a):this._show3DLayersMap(a):a.map.itemId?this._show2DWebMap(a):console.log("No webmap found. Please set map.itemId in config.json.")},
onBeforeUnload:function(){this.appConfig.keepAppState&&this.appStateManager.saveWabAppState(this.map,this.layerInfosObj)},onWindowResize:function(){this.map&&this.map.resize&&(this.map.resize(),this.resetInfoWindow(!1))},getMapInfoWindow:function(){return{mobile:this._mapMobileInfoWindow,bigScreen:this._mapInfoWindow}},resetInfoWindow:function(a){a&&(this._mapInfoWindow=this.map.infoWindow,this._mapMobileInfoWindow&&(this._mapMobileInfoWindow.destroy(),g("div.esriMobileInfoView.esriMobilePopupInfoView").forEach(function(a){x.destroy(a)}),
g("div.esriMobileNavigationBar").forEach(function(a){x.destroy(a)})),this._mapMobileInfoWindow=new e(null,x.create("div",null,null,this.map.root)),this.isMobileInfoWindow=!1);P.inMobileSize()&&!this.isMobileInfoWindow?(this.map.infoWindow.hide(),this.map.setInfoWindow(this._mapMobileInfoWindow),this.isMobileInfoWindow=!0):!P.inMobileSize()&&this.isMobileInfoWindow&&(this.map.infoWindow.hide(),this.map.setInfoWindow(this._mapInfoWindow),this.isMobileInfoWindow=!1)},onSyncExtent:function(a){this.map&&
(a=new M(a.extent),this.map.setExtent(a))},_visitConfigMapLayers:function(a,e){y.forEach(a.map.basemaps,function(a,k){a.isOperationalLayer=!1;e(a,k)},this);y.forEach(a.map.operationallayers,function(a,k){a.isOperationalLayer=!0;e(a,k)},this)},_show3DLayersMap:function(a){L(["esri3d/Map"],m.hitch(this,function(e){var k;k=new e(this.mapDivId,{camera:a.map.mapOptions.camera});this._visitConfigMapLayers(a,m.hitch(this,function(a){this.createLayer(k,"3D",a)}));k.usePlugin=e.usePlugin;this._publishMapEvent(k)}))},
_show3DWebScene:function(a){this._getWebsceneData(a.map.itemId).then(m.hitch(this,function(e){L(["esri3d/Map"],m.hitch(this,function(k){var g=new k(this.mapDivId,a.map.mapOptions);y.forEach(e.itemData.operationalLayers,function(a){this.createLayer(g,"3D",a)},this);y.forEach(e.itemData.baseMap.baseMapLayers,function(a){a.type="tile";this.createLayer(g,"3D",a)},this);y.forEach(e.itemData.baseMap.elevationLayers,function(a){a.type="elevation";this.createLayer(g,"3D",a)},this);g.toc=e.itemData.toc;g.bookmarks=
e.itemData.bookmarks;g.tours=e.itemData.tours}))}))},_publishMapEvent:function(a){window._viewerMap=a;J.postProcessUrlParams(this.urlParams,a);console.timeEnd("Load Map");this.map?(this.map=a,this.resetInfoWindow(!0),console.log("map changed."),w.publish("mapChanged",this.map,this.layerInfosObj)):(this.map=a,this.resetInfoWindow(!0),w.publish("mapLoaded",this.map,this.layerInfosObj))},_getWebsceneData:function(a){return u({url:"http://184.169.133.166/sharing/rest/content/items/"+a+"/data",handleAs:"json"})},
_show2DWebMap:function(a){a.map.mapOptions||(a.map.mapOptions={});var e=this._processMapOptions(a.map.mapOptions)||{};e.isZoomSlider=!1;var k=a.map.portalUrl,g=a.map.itemId,e={mapOptions:e,bingMapsKey:a.bingMapsKey,usePopupManager:!0};if(!window.isBuilder&&!a.mode&&a.map.appProxy&&a.map.appProxy.mapItemId===a.map.itemId){var p=[];y.forEach(a.map.appProxy.proxyItems,function(a){a.useProxy&&a.proxyUrl&&p.push({url:a.sourceUrl,mixin:{url:a.proxyUrl}})});0<p.length&&(e.layerMixins=p)}this._createWebMapRaw(k,
g,this.mapDivId,e).then(m.hitch(this,function(e){var f=e.map;f.hideZoomSlider();f.infoWindow.resize(270,316);f.itemId=a.map.itemId;f.itemInfo=e.itemInfo;f.webMapResponse=e;f.enableSnapping({snapKey:n.copyKey});x.setStyle(f.root,"zIndex",0);f._initialExtent=f.extent;this.layerInfosObj=K.getInstanceSyncForInit(f,f.itemInfo);this.layerInfosObj.getLayerInfoArrayOfWebmap().forEach(function(a){a.getLayerObject().then(m.hitch(this,function(a){a&&m.setObject("_wabProperties.originalRefreshinterval",a.refreshInterval,
a)}),m.hitch(this,function(a){console.error("can't get layerObject",a)}))},this);a.map.mapRefreshInterval&&!a.map.mapRefreshInterval.useWebMapRefreshInterval&&this._updateRefreshInterval(a.map.mapRefreshInterval);this._showUnreachableLayersTitleMessage();this._publishMapEvent(f);setTimeout(m.hitch(this,this._checkAppState),500);this._addDataLoadingOnMapUpdate(f)}),m.hitch(this,function(a){console.error(a);this._showError(a);w.publish("mapCreatedFailed")}))},_handleRefreshLayer:function(a){var e=a._mode._drawFeatures,
k=a._mode._clearIIf,g=null;a._mode._drawFeatures=function(k,g){g&&"number"===typeof g.row&&"number"===typeof g.col&&a._mode._removeCell(g.row,g.col);e.apply(a._mode,arguments)};r.before(a,"refresh",function(){g=a._mode._cellMap;a._mode._clearIIf=function(){}});r.after(a,"refresh",function(){a._mode._cellMap=g;a._mode._clearIIf=k});t(a,"update-start",function(){a.isUpdating=!0});t(a,"update-end",function(){a.isUpdating=!1})},_showError:function(a){a&&a.message&&x.create("div",{"class":"app-error",
innerHTML:a.message},document.body)},_createWebMapRaw:function(e,k,g,p){return P.createWebMap(e,k,g,p).then(m.hitch(this,function(a){return a}),m.hitch(this,function(n){console.error(n);if(n&&n instanceof Error&&n.message){var r=m.getObject("arcgis.utils.baseLayerError",!1,A.cache["esri/nls/jsapi/"+a.locale]);if(r&&0<=n.message.indexOf(r))return new N({message:window.jimuNls.map.basemapNotAvailable+window.jimuNls.map.displayDefaultBasemap}),z.getItem(k).then(m.hitch(this,function(a){a.itemData.spatialReference=
{wkid:102100,latestWkid:3857};a.itemData.baseMap={baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",opacity:1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,id:"defaultBasemap_0"}],title:"Topographic"};return P.createWebMap(e,a,g,p)}))}throw n;}))},_showUnreachableLayersTitleMessage:function(){var a=this.layerInfosObj.getUnreachableLayersTitle(),e="",k=window.jimuNls.map.layerLoadedError||"The layer, ${layers} cannot be added to the map.";k&&
a&&0<a.length&&(y.forEach(a,m.hitch(this,function(a){e=e+a+", "})),new N({message:k.replace("${layers}",e)}))},_addDataLoadingOnMapUpdate:function(a){var e=x.toDom('\x3cdiv class\x3d"map-loading"\x3eLoading...\x3c/div\x3e');x.place(e,a.root);a.updating&&x.addClass(e,"loading");t(a,"update-start",m.hitch(this,function(){x.addClass(e,"loading")}));t(a,"update-end",m.hitch(this,function(){x.removeClass(e,"loading")}));t(a,"unload",m.hitch(this,function(){x.destroy(e);e=null}))},_checkAppState:function(){var a=
"extent center marker find query scale level".split(" "),e=this.appConfig.keepAppState;e&&y.forEach(a,function(a){a in this.urlParams&&(e=!1)},this);e&&this.appStateManager.getWabAppState().then(m.hitch(this,function(a){if(a.extent||a.layers){var e=new C({nls:{title:this.nls.appState.title,restoreMap:this.nls.appState.restoreMap}});e.placeAt("main-page");t(e,"applyAppState",m.hitch(this,function(){this._applyAppState(a,this.map)}));e.startup();e.show()}}))},_applyAppState:function(a,e){this.layerInfosObj.restoreState({layerOptions:a.layers||
null});a.extent&&e.setExtent(a.extent)},_processMapOptions:function(a){if(a)return a.lods||delete a.lods,a.lods&&0===a.lods.length&&delete a.lods,a=m.clone(a),a.extent&&(a.extent=new M(a.extent)),a.center&&!m.isArrayLike(a.center)&&(a.center=new I(a.center)),a.infoWindow&&(a.infoWindow=new k(a.infoWindow,x.create("div",{},this.mapDivId))),a},createLayer:function(a,e,k){L([{"2D_tiled":"esri/layers/ArcGISTiledMapServiceLayer","2D_dynamic":"esri/layers/ArcGISDynamicMapServiceLayer","2D_image":"esri/layers/ArcGISImageServiceLayer",
"2D_feature":"esri/layers/FeatureLayer","2D_rss":"esri/layers/GeoRSSLayer","2D_kml":"esri/layers/KMLLayer","2D_webTiled":"esri/layers/WebTiledLayer","2D_wms":"esri/layers/WMSLayer","2D_wmts":"esri/layers/WMTSLayer","3D_tiled":"esri3d/layers/ArcGISTiledMapServiceLayer","3D_dynamic":"esri3d/layers/ArcGISDynamicMapServiceLayer","3D_image":"esri3d/layers/ArcGISImageServiceLayer","3D_feature":"esri3d/layers/FeatureLayer","3D_elevation":"esri3d/layers/ArcGISElevationServiceLayer","3D_3dmodle":"esri3d/layers/SceneLayer"}[e+
"_"+k.type]],m.hitch(this,function(e){var g,n={};g="label url type icon infoTemplate isOperationalLayer".split(" ");for(var f in k)0>g.indexOf(f)&&(n[f]=k[f]);k.infoTemplate?(g=new p(k.infoTemplate.title,k.infoTemplate.content),n.infoTemplate=g,e=new e(k.url,n),k.infoTemplate.width&&k.infoTemplate.height&&r.after(e,"onClick",m.hitch(this,function(){a.infoWindow.resize(k.infoTemplate.width,k.infoTemplate.height)}),!0)):e=new e(k.url,n);e.isOperationalLayer=k.isOperationalLayer;e.label=k.label;e.icon=
k.icon;a.addLayer(e)}))},onAppConfigChanged:function(a,e,k){this.appConfig=a;"mapChange"===e?this._recreateMap(a):"mapOptionsChange"===e?k.lods&&this._recreateMap(a):"mapRefreshIntervalChange"===e&&this.map&&this.map.itemInfo.itemData&&this.layerInfosObj&&this._updateRefreshInterval(k)},onMapContentModified:function(){this._recreateMap(this.appConfig)},_updateRefreshInterval:function(a){var e=-1,e=a.useWebMapRefreshInterval?-1:a.minutes;this.layerInfosObj.getLayerInfoArrayOfWebmap().forEach(function(a){a.getLayerObject().then(m.hitch(this,
function(a){if(a){var k=m.getObject("_wabProperties.originalRefreshinterval",!1,a);0<k&&"function"===typeof a.setRefreshInterval&&(0>e?a.setRefreshInterval(k):a.setRefreshInterval(e))}}),m.hitch(this,function(a){console.error("can't get layerObject",a)}))},this)},_recreateMap:function(a){this.map&&(w.publish("beforeMapDestory",this.map),this.map.destroy());this._showMap(a)},disableWebMapPopup:function(){this.map.setInfoWindowOnClick(!1)},enableWebMapPopup:function(){this.map.setInfoWindowOnClick(!0)}});
S.getInstance=function(a,e){null===T&&(T=new S(a,e));return T};return S})},"esri/dijit/InfoWindow":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-style dijit/_Widget dijit/_Templated dijit/_Container ../kernel ../domUtils ../InfoWindowBase ./_EventedWidget dojo/text!./templates/InfoWindow.html".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L){var P=B([I,k,
e,p,M],{declaredClass:"esri.dijit.InfoWindow",isContainer:!0,templateString:L,anchor:"upperright",fixedAnchor:null,coords:null,isShowing:!0,isContentShowing:!0,isTitleBarShowing:!0,width:250,height:150,title:"Info Window",setMap:function(a){this.inherited(arguments);A.place(this.domNode,a.root)},startup:function(){if(!this._started){if(this.inherited(arguments),this._ANCHORS=[P.ANCHOR_UPPERRIGHT,P.ANCHOR_LOWERRIGHT,P.ANCHOR_LOWERLEFT,P.ANCHOR_UPPERLEFT],7>w("ie")){var e="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+
a.getComputedStyle(this._sprite).backgroundImage.replace(/url\(\"/i,"").replace(/\"\)/,"")+"')",k=A.create("div",null,x.body());a.set(k,{width:"1px",height:"1px",display:"none",backgroundImage:"none",filter:e});var p=setTimeout(function(){A.destroy(k);clearTimeout(p);p=k=null},100);g.query(".sprite",this.domNode).forEach(function(a){a.style.backgroundImage="none";a.style.filter=e})}this.resize(this.width,this.height);this.hide()}},destroy:function(){this._destroyed||(this.__unregisterMapListeners(),
this.destroyDijits(this._title),this.destroyDijits(this._content),this._title.innerHTML=this._content.innerHTML="",this.inherited(arguments))},resize:function(e,k){if(e&&k){var g=a.set;g(this._topleft,{height:k+"px",marginLeft:e+"px"});g(this._topright,{width:e+"px",height:k+"px"});g(this._user,"width",e-8+"px");g(this._hide,"marginLeft",e-22+"px");g(this._title,"width",e-25+"px");g(this._content,"height",k-37+"px");g(this._bottomleft,{marginLeft:e+"px",marginTop:k+"px"});g(this._bottomright,{width:e-
5+"px",marginTop:k+"px"});this.width=e;this.height=k;this.coords&&this._adjustPosition(this.coords,this.anchor);this.onResize(e,k)}},_adjustPosition:function(e,k){var g=a.set;g(this._infowindow,{left:Math.round(e.x)+"px",top:Math.round(e.y)+"px"});k===P.ANCHOR_UPPERLEFT?g(this._window,{left:null,right:this.width+18+"px",top:null,bottom:this.height+50+"px"}):k===P.ANCHOR_UPPERRIGHT?g(this._window,{left:"6px",right:null,top:null,bottom:this.height+50+"px"}):k===P.ANCHOR_LOWERRIGHT?g(this._window,{left:"6px",
right:null,top:"43px",bottom:null}):k===P.ANCHOR_LOWERLEFT&&g(this._window,{left:null,right:this.width+18+"px",top:"43px",bottom:null})},_getAnchor:function(a){var e=this.map;return e&&a?(a.y<e.height/2?"lower":"upper")+(a.x<e.width/2?"right":"left"):"upperright"},show:function(a,e,k){if(a){a.spatialReference?(this.mapCoords=a,a=this.coords=this.map.toScreen(a,!0)):(this.mapCoords=null,this.coords=a);var g=this.map._getFrameWidth();if(-1!==g&&(a.x%=g,0>a.x&&(a.x+=g),this.map.width>g))for(var p=(this.map.width-
g)/2;a.x<p;)a.x+=g;e&&-1!==y.indexOf(this._ANCHORS,e)||(e=this._getAnchor(a));n.remove(this._pointer,this.anchor);e=this.anchor=this.fixedAnchor||e;this._adjustPosition(a,e);n.add(this._pointer,e);z.show(this.domNode);this.isShowing=!0;k||this.onShow()}},hide:function(a,e){z.hide(this.domNode);this.isShowing=!1;e||this.onHide()},showTitleBar:function(){z.show(this._titlebar);z.show(this._border);this.isTitleBarShowing=!0},hideTitleBar:function(){z.hide(this._titlebar);z.hide(this._border);this.isTitleBarShowing=
!1},showContent:function(){z.show(this._content);z.show(this._border);this.isContentShowing=!0},hideContent:function(){z.hide(this._content);z.hide(this._border);this.isContentShowing=!1},move:function(e,k){k?e=this.coords.offset(e.x,e.y):(this.coords=e,this.mapCoords&&(this.mapCoords=this.map.toMap(e)));a.set(this._infowindow,{left:Math.round(e.x)+"px",top:Math.round(e.y)+"px"})},setFixedAnchor:function(a){a&&-1===y.indexOf(this._ANCHORS,a)||(this.fixedAnchor=a,this.isShowing&&this.show(this.mapCoords||
this.coords,a),this.onAnchorChange(a))},setTitle:function(a){return this.destroyDijits(this._title),this.__setValue("_title",a),this},setContent:function(a){return this.destroyDijits(this._content),this.__setValue("_content",a),this},onShow:function(){this.__registerMapListeners();this.startupDijits(this._title);this.startupDijits(this._content)},onHide:function(){this.__unregisterMapListeners()},onResize:function(){},onAnchorChange:function(){}});return m.mixin(P,{ANCHOR_UPPERRIGHT:"upperright",
ANCHOR_LOWERRIGHT:"lowerright",ANCHOR_LOWERLEFT:"lowerleft",ANCHOR_UPPERLEFT:"upperleft"}),w("extend-esri")&&m.setObject("dijit.InfoWindow",P,u),P})},"esri/dijit/PopupMobile":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style ../InfoWindowBase ../PopupBase ./InfoView ./NavigationBar ../kernel ../domUtils dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N){B=m([z,M],{declaredClass:"esri.dijit.PopupMobile",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:!0,popupNavigationBar:null,popupInfoView:null,location:null,xIcon:B.toUrl("./images/whitex.png"),dArrowIcon:B.toUrl("./images/whitedown.png"),lArrowIcon:B.toUrl("./images/whitel.png"),rArrowIcon:B.toUrl("./images/whiter.png"),constructor:function(e,g){this.initialize();y.mixin(this,e);this.domNode=A.byId(g);this._nls=y.mixin({},
N.widgets.popup);e=this.domNode;k.add(e,"esriPopupMobile");a.set(e,"innerHTML","\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv style\x3d'text-align:center'\x3e\x3cdiv class\x3d'titleButton prev hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'footer' style\x3d'display:inline-block;width:60px;height:15px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton arrow hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer top hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer bottom hidden'\x3e\x3c/div\x3e");
g=t.query(".titlePane",e)[0];this._arrowButton=t.query(".arrow",g)[0];this._pointerTop=t.query(".top",e)[0];this._pointerBottom=t.query(".bottom",e)[0];this._title=t.query(".title",g)[0];this._footer=t.query(".footer",g)[0];this._prev=t.query(".prev",g)[0];this._next=t.query(".next",g)[0];this._spinner=t.query(".spinner",g)[0];this._eventConnections=[x.connect(t.query(".close",g)[0],"onclick",this,this.hide),x.connect(this._arrowButton,"onclick",this,this._toggleView),x.connect(this._prev,"onclick",
this,function(){this.selectPrevious();this._updateUI()}),x.connect(this._next,"onclick",this,function(){this.selectNext();this._updateUI()})];this._initPopupNavigationBar();this._initPopupInfoView();K.hide(e);this.isShowing=!1},setMap:function(a){this.inherited(arguments);e.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a)},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a,e){this.destroyDijits(this._title);this.place(a,this._title);
this.destroyDijits(this._footer);this.place(e,this._footer);this.isShowing&&(this.startupDijits(this._title),this.startupDijits(this._footer))},setContent:function(a){this.destroyDijits(this._contentPane);this.place(a,this._contentPane);this.startupDijits(this._contentPane)},show:function(a){if(!a)return K.show(this.domNode),void(this.isShowing=!0);var e,k=this.map;a.spatialReference?(this.location=a,e=k.toScreen(a)):(this.location=k.toMap(a),e=a);this._maximized?this.restore():this._setPosition(e);
this.isShowing||(K.show(this.domNode),this.isShowing=!0,this.onShow())},hide:function(){this.isShowing&&(K.hide(this.domNode),this.isShowing=!1,this.onHide())},onShow:function(){this._followMap();this.startupDijits(this._title);this.showHighlight()},onHide:function(){this._unfollowMap();this.hideHighlight()},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._footer);g.forEach(this._eventConnections,x.disconnect);
e.destroy(this.domNode)},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("\x26nbsp;","\x26nbsp;");k.add(this._arrowButton,"hidden");this._updateUI();this.hideHighlight()},onSelectionChange:function(){var a=this.selectedIndex;this._updateUI();0<=a&&(this.setContent(this.features[a].getContent()),
this.updateHighlight(this.map,this.features[a]),this.isShowing&&this.showHighlight())},onDfdComplete:function(){this._updateUI()},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[x.connect(a,"onPanStart",this,this._onPanStart),x.connect(a,"onPan",this,this._onPan),x.connect(a,"onZoomStart",this,this._onZoomStart),x.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(g.forEach(a,x.disconnect),this._handles=null)},_onPanStart:function(){var a=
this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,e){var k=this._panOrigin;a=e.x;e=e.y;var g=k.left,p=k.top,n=k.right,k=k.bottom;g&&(g=parseFloat(g)+a+"px");p&&(p=parseFloat(p)+e+"px");n&&(n=parseFloat(n)-a+"px");k&&(k=parseFloat(k)-e+"px");u.set(this.domNode,{left:g,top:p,right:n,bottom:k})},_onZoomStart:function(){K.hide(this.domNode)},_onExtentChange:function(a,e,k){k&&(K.show(this.domNode),this.show(this._targetLocation||this.location),
this._targetLocation=null)},_setPosition:function(a){var e=a.x;a=a.y;var g=p.getContentBox(this.map.container),n=g.w,g=g.h,m=0,r=a+10,t=118,z=n-18;18<e&&e<z?(m=e-130,0>m?m=0:m>n-260&&(m=n-260)):18>=e?m=e-18:e>=z&&(m=n-260+(e-z));118<e&&e<n-130?t=118:118>=e?18<e?t=e-12:18>=e&&(t=6):e>=n-130&&(e<z?t=118+e-(n-130):e>=z&&(t=118+z-(n-130)));a<=g/2?(u.set(this.domNode,{left:m+"px",top:r+"px",bottom:null}),u.set(this._pointerTop,{left:t+"px"}),k.add(this._pointerBottom,"hidden"),k.remove(this._pointerTop,
"hidden")):(u.set(this.domNode,{left:m+"px",top:r-64+"px",bottom:null}),u.set(this._pointerBottom,{left:t+"px"}),k.add(this._pointerTop,"hidden"),k.remove(this._pointerBottom,"hidden"))},_showPointer:function(a){g.forEach(["topLeft","topRight","bottomRight","bottomLeft"],function(e){e===a?t.query(".pointer."+e,this.domNode).removeClass("hidden"):t.query(".pointer."+e,this.domNode).addClass("hidden")},this)},_toggleView:function(){this.popupNavigationBar||this._initPopupNavigationBar();this.popupInfoView||
this._initPopupInfoView();this.hide();K.show(this.popupNavigationBar.container);K.show(this.popupInfoView.container);0<=this.selectedIndex&&(this.selectedIndex+1+" of "+this.features.length,this.setContent(this.features[this.selectedIndex].getContent()))},_handleNavigationBar:function(a){switch(this.popupInfoView.animateTo(0),a.name){case "CloseButton":K.hide(this.popupNavigationBar.container);K.hide(this.popupInfoView.container);this.hide();break;case "ToggleButton":K.hide(this.popupNavigationBar.container);
K.hide(this.popupInfoView.container);this.show(this.location);break;case "PreviousButton":this.selectPrevious();this._updateUI();break;case "NextButton":this.selectNext(),this._updateUI()}},_initPopupNavigationBar:function(){var a={};a.items=[{name:"CloseButton",type:"img",src:this.xIcon,srcAlt:this.xIcon,position:"left"},{name:"Title",type:"span",text:"",position:"center"},{name:"ToggleButton",type:"img",src:this.dArrowIcon,srcAlt:this.dArrowIcon,position:"right",toggleGroup:"toggle"},{name:"PreviousButton",
type:"img",src:this.lArrowIcon,srcAlt:this.lArrowIcon,position:"right2",toggleGroup:"previous"},{name:"NextButton",type:"img",src:this.rArrowIcon,srcAlt:this.rArrowIcon,position:"right1",toggleGroup:"next"}];this.popupNavigationBar=new L(a,e.create("div",{},w.body()));x.connect(this.popupNavigationBar,"onCreate",this,function(a){this._prevFeatureButton=a[3]._node;this._nextFeatureButton=a[4]._node});x.connect(this.popupNavigationBar,"onSelect",this,this._handleNavigationBar);x.connect(this.popupNavigationBar,
"onUnSelect",this,this._handleNavigationBar);this.popupNavigationBar.startup();K.hide(this.popupNavigationBar.container)},_initPopupInfoView:function(){this.popupInfoView=new I({items:[{name:"Navigator",type:"div",text:""},{name:"content",type:"div",text:""},{name:"attachment",type:"div",text:""}]},e.create("div",{},w.body()));k.add(this.popupInfoView.container,"esriMobilePopupInfoView");this.popupInfoView.enableTouchScroll();x.connect(this.popupInfoView,"onCreate",this,function(a){this._contentPane=
a[1]._node;0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())});x.connect(this.popupInfoView,"onSwipeLeft",this,function(){});x.connect(this.popupInfoView,"onSwipeRight",this,function(){});this.popupInfoView.startup()},_updateUI:function(){var a="\x26nbsp;",e="\x26nbsp;",g=this.selectedIndex,p=this.features,n=this.deferreds,m=this._prevFeatureButton.parentNode,r=this._nextFeatureButton.parentNode,u=this._spinner,t=this._nls;p&&1<=p.length?(a=p[g].getTitle(),e=g+
1+" of "+p.length,k.remove(this._arrowButton,"hidden"),0===g?(k.add(m,"hidden"),k.add(this._prev,"hidden")):(k.remove(m,"hidden"),k.remove(this._prev,"hidden")),g===p.length-1?(k.add(r,"hidden"),k.add(this._next,"hidden")):(k.remove(r,"hidden"),k.remove(this._next,"hidden"))):(k.add(this._arrowButton,"hidden"),k.add(m,"hidden"),k.add(r,"hidden"),k.add(this._prev,"hidden"),k.add(this._next,"hidden"));this.setTitle(a,e);this.popupNavigationBar.getItems()[1]._node.innerHTML=e;n&&n.length?(k.remove(u,
"hidden"),this.setTitle(t.NLS_searching+"...","\x26nbsp;")):(k.add(u,"hidden"),p&&p.length||this.setTitle("No Information","\x26nbsp;"))}});return r("extend-esri")&&y.setObject("dijit.PopupMobile",B,P),B})},"esri/dijit/InfoView":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry ../kernel ./_TouchBase".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e){B=B(null,{declaredClass:"esri.dijit.InfoView",
_items:[],_top:null,_sections:[],_isDecelerate:!1,constructor:function(a,k){if(this.container=r.byId(k),this._touchBase=e(this.container,null),this._slideDiv=A.create("div",null,this.container,"first"),this.events=[],this._items=a.items,a.sections&&(this._sections=a.sections),n.add(this.container,"esriMobileInfoView"),0===this._sections.length)A.create("div",{},this._slideDiv);else for(a=0;a<this._sections.length;a++)k=A.create("div",{class:"esriMobileInfoViewSection"},this._slideDiv),A.create("div",
{innerHTML:this._sections[a].title},k);for(a=0;a<this._items.length;a++){var g;k=0;switch(this._items[a].section&&(k=this._items[a].section),this._items[a].type){case "div":g=A.create("div",{class:"esriMobileInfoViewItem",style:this._items[a].style},this._slideDiv.childNodes[k]),g=A.create("div",{innerHTML:this._items[a].text},g)}this._items[a].className&&n.add(g,this._items[a].className);g._index=a;g._item=this._items[a];this._items[a]._node=g}this.startTouchY=0},startup:function(){this.onCreate(this._items);
this._animateTo(0)},destroy:function(){y.forEach(this.events,x.disconnect);this._touchBase=null;g.query("img",this.container).forEach(function(a){a._index=null;a._item=null;A.destroy(a);a=null});this._items=null;A.destroy(this._slideDiv);A.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},setPreventDefault:function(a){this._touchBase.setPreventDefault(a)},enableTouchScroll:function(){this._touchBase.setPreventDefault(!0);this.events.push(x.connect(this._touchBase,
"onTouchStart",this,this._onTouchStartHandler));this.events.push(x.connect(this._touchBase,"onTouchMove",this,this._onTouchMoveHandler));this.events.push(x.connect(this._touchBase,"onTouchEnd",this,this._onTouchEndHandler));this._slideDiv.style.webkitTransform="translate3d(0,"+this._top+"px, 0)"},disableTouchScroll:function(){x.disconnect(this.events.pop());x.disconnect(this.events.pop());x.disconnect(this.events.pop());this._touchBase.setPreventDefault(!1);this._slideDiv.style.webkitTransform="translate3d(0, 0px, 0)"},
animateTo:function(){this._slideDiv.style.WebkitTransitionDuration="0s";this._animateTo(0)},onSelect:function(a){},onUnSelect:function(a){},onCreate:function(a){},onClick:function(a){},onSwipeLeft:function(){},onSwipeRight:function(){},_onTouchStartHandler:function(a){this._slideDiv.style.WebkitTransitionDuration="0s";this._moveDirection=null;this._startTime=new Date;this.startTouchY=a.touches[0].clientY;this.contentStartOffsetY=this.contentOffsetY},_onTouchMoveHandler:function(a){(this._moveDirection||
(Math.abs(a.curY)>Math.abs(a.curX)?this._moveDirection="vertical":this._moveDirection="horizontal"),"horizontal"!==this._moveDirection&&"vertical"===this._moveDirection)&&this._animateTo(a.touches[0].clientY-this.startTouchY+this.contentStartOffsetY)},_onTouchEndHandler:function(a){this._endTime=new Date;this._deltaMovement=a.curY;"vertical"===this._moveDirection?this._shouldStartMomentum()?this._doMomentum():this._snapToBounds():"horizontal"===this._moveDirection&&("left"===a.swipeDirection?this.onSwipeLeft():
"right"===a.swipeDirection&&this.onSwipeRight())},_shouldStartMomentum:function(){return this._diff=this._endTime-this._startTime,this._velocity=this._deltaMovement/this._diff,.2<Math.abs(this._velocity)&&200>this._diff},_doMomentum:function(){var e,k;e=a.getContentBox(this.container);var g=0>this._velocity?.001:-.001;k=-this._velocity*this._velocity/(2*g);var n=-this._velocity/g,g=3*.6-0,m=1-g,r=0,t=0;if(e.h>this._slideDiv.scrollHeight)this.contentOffsetY=0,t=300;else if(0<this.contentOffsetY+k){e=
0;for(k=Math.floor(n/20);e<k;e++)if(r=(20*m*e^3)+(20*g*e^2)+0*e+0,r=0>this._velocity?-r:r,0<this.contentOffsetY+r){t=20*e;break}0===t&&(t=300);this.contentOffsetY=0}else if(Math.abs(this.contentOffsetY+k)+e.h>this._slideDiv.scrollHeight)for(this.contentOffsetY=e.h-this._slideDiv.scrollHeight,e=0,k=Math.floor(n/20);e<k;e++){if(r=(20*m*e^3)+(20*g*e^2)+0*e+0,r=0>this._velocity?-r:r,Math.abs(this.contentOffsetY+r)>this._slideDiv.scrollHeight){t=20*e;break}}else t=n,this.contentOffsetY+=k;this._slideDiv.style.webkitTransition=
"-webkit-transform "+t+"ms cubic-bezier(0, 0.3, 0.6, 1)";this._animateTo(this.contentOffsetY)},_snapToBounds:function(){var e=a.getContentBox(this.container);e.h>this._slideDiv.scrollHeight?this.contentOffsetY=0:0<this.contentOffsetY?this.contentOffsetY=0:Math.abs(this.contentOffsetY)+e.h>this._slideDiv.scrollHeight&&(this.contentOffsetY=e.h-this._slideDiv.scrollHeight);this._slideDiv.style.WebkitTransitionDuration="0.5s";this._animateTo(this.contentOffsetY)},_animateTo:function(a){this.contentOffsetY=
a;this._slideDiv.style.webkitTransform="translate3d(0, "+a+"px, 0)"},_stopMomentum:function(){if(this._isDecelerating()){var a=document.defaultView.getComputedStyle(this._slideDiv,null),a=new WebKitCSSMatrix(a.webkitTransform);this._slideDiv.style.webkitTransition="";this.animateTo(a.m42)}},_isDecelerating:function(){return!!this.isDecelerate},_toggleNode:function(a,e){"ON"===e.toggleState?(e.toggleState="OFF",e.src&&(a.src=e.src.toString()),this.onUnSelect(e)):(e.toggleState="ON",e.srcAlt&&(a.src=
e.srcAlt),this.onSelect(e))}});return w("extend-esri")&&m.setObject("dijit.InfoView",B,k),B})},"esri/dijit/_TouchBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/dom dojo/has ../kernel".split(" "),function(B,m,y,x,g,w){B=B(null,{declaredClass:"esri.dijit._TouchBase",_preventDefault:!0,_swipeThreshold:20,constructor:function(g,m){this.domNode=x.byId(g);this.events=[y.connect(this.domNode,"touchstart",this,this._touchStartHandler),y.connect(this.domNode,"touchmove",
this,this._touchMoveHandler),y.connect(this.domNode,"touchend",this,this._touchEndHandler),y.connect(this.domNode,"onclick",this,this._clickHandler)]},setPreventDefault:function(g){this._preventDefault=g},disableOnClick:function(){y.disconnect(this.events.pop())},_clickHandler:function(g){this._moved?g.preventDefault():this.onclick(g)},_touchStartHandler:function(g){this._moved=!1;this.client_x=g.targetTouches[0].clientX;this.client_y=g.targetTouches[0].clientY;this.down_x=g.targetTouches[0].pageX;
this.down_y=g.targetTouches[0].pageY;g.downX=this.down_x;g.downY=this.down_y;this.onTouchStart(g)},_touchMoveHandler:function(g){this._preventDefault&&g.preventDefault();this._moved=!0;this.up_x=g.targetTouches[0].pageX;this.cur_x=g.targetTouches[0].pageX-this.down_x;this.cur_y=g.targetTouches[0].pageY-this.down_y;g.curX=this.cur_x;g.curY=this.cur_y;this.onTouchMove(g)},_touchEndHandler:function(g){this._moved?(g.curX=this.cur_x,g.curY=this.cur_y,this.down_x-this.up_x>this._swipeThreshold?g.swipeDirection=
"left":this.up_x-this.down_x>this._swipeThreshold&&(g.swipeDirection="right")):(g.clientX=this.client_x,g.clientY=this.client_y);this.onTouchEnd(g)},onTouchStart:function(g){},onTouchMove:function(g){},onTouchEnd:function(g){},onclick:function(g){}});return g("extend-esri")&&m.setObject("dijit._TouchBase",B,w),B})},"esri/dijit/NavigationBar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct ./_TouchBase ../kernel".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k){B=B(null,{declaredClass:"esri.dijit.NavigationBar",_items:[],constructor:function(e,k){this.container=r.byId(k);this._touchBase=a(this.container,null);this._slideDiv=A.create("div",{},this.container,"first");this.events=[y.connect(this._touchBase,"onclick",this,this._onClickHandler)];this._items=e.items;n.add(this.container,"esriMobileNavigationBar");k=A.create("div",{},this._slideDiv);for(e=0;e<this._items.length;e++){var g,p;switch(this._items[e].type){case "img":p=
A.create("div",{class:"esriMobileNavigationItem"},k);g=A.create("img",{src:this._items[e].src.toString(),style:{width:"100%",height:"100%"}},p);break;case "span":p=A.create("div",{class:"esriMobileNavigationItem"},k);g=A.create("span",{innerHTML:this._items[e].text},p);break;case "div":p=A.create("div",{class:"esriMobileNavigationInfoPanel"},k),g=A.create("div",{innerHTML:this._items[e].text},p)}n.add(p,this._items[e].position);this._items[e].className&&n.add(g,this._items[e].className);g._index=
e;g._item=this._items[e];this._items[e]._node=g}},startup:function(){this.onCreate(this._items)},destroy:function(){x.forEach(this.events,y.disconnect);this._touchBase=null;g.query("img",this.container).forEach(function(a){a._index=null;a._item=null;A.destroy(a);a=null});this._items=null;A.destroy(this._slideDiv);A.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},select:function(a){this._markSelected(a._node,a)},onSelect:function(a){},onUnSelect:function(a){},
onCreate:function(a){},_onClickHandler:function(a){if("img"===a.target.tagName.toLowerCase()){var e=a.target,k=(e._index,e._item);g.query("img",this.container).forEach(function(a){a!==e&&a._item.toggleGroup===k.toggleGroup&&this._markUnSelected(a,a._item)},this);this._toggleNode(e,k)}},_toggleNode:function(a,k){"ON"===k.toggleState?(k.toggleState="OFF",k.src&&(a.src=k.src.toString()),this.onUnSelect(k)):(k.toggleState="ON",k.srcAlt&&(a.src=k.srcAlt),this.onSelect(k))},_markSelected:function(a,k){k.toggleState=
"ON";k.srcAlt&&(a.src=k.srcAlt);this.onSelect(k)},_markUnSelected:function(a,k){"ON"===k.toggleState&&(k.toggleState="OFF",k.src&&(a.src=k.src.toString()),this.onUnSelect(k))}});return w("extend-esri")&&m.setObject("dijit.NavigationBar",B,k),B})},"jimu/dijit/AppStatePopup":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/on dojo/mouse dojo/_base/fx dojo/topic dojo/Evented".split(" "),function(B,m,y,x,g,w,t,r,n){var A=1E3,a=1E4;return B([m,n],{baseClass:"jimu-appstate-popup",
declaredClass:"jimu.dijit.AppStatePopup",currentState:0,timeoutHandler:void 0,constructor:function(k){this.inherited(arguments);"animationDuration"in k&&(A=k.animationDuration);"autoCloseInterval"in k&&(a=k.autoCloseInterval)},postCreate:function(){window.appInfo.isRunInMobile&&x.addClass(this.domNode,"mobile");var a=x.create("div",{"class":"appstate-header"});x.create("div",{"class":"appstate-title",innerHTML:this.nls.title},a);var e=x.create("div",{"class":"appstate-close"},a);x.place(a,this.domNode);
a=x.create("div",{"class":"appstate-tips",innerHTML:this.nls.restoreMap});x.place(a,this.domNode);this.own(g(a,"click",y.hitch(this,function(){this.emit("applyAppState");this.hide()})));this.own(g(e,"click",y.hitch(this,function(){this.hide()})));this.own(g(this.domNode,w.enter,y.hitch(this,function(){this._timerStop()})));this.own(g(this.domNode,w.leave,y.hitch(this,function(){this._timerStart()})))},show:function(){t.animateProperty({node:this.domNode,duration:A,properties:window.appInfo.isRunInMobile?
{top:{start:-120,end:0}}:{bottom:{start:-100,end:10}},onEnd:y.hitch(this,function(){this.currentState=1})}).play();r.subscribe("splashPopupShow",y.hitch(this,function(){this._timerStop()}));r.subscribe("splashPopupHide",y.hitch(this,function(){this._timerStart()}));this.timeoutHandler=setTimeout(y.hitch(this,this.hide),a)},hide:function(){0!==this.currentState&&t.animateProperty({node:this.domNode,duration:A,properties:window.appInfo.isRunInMobile?{top:{start:0,end:-120}}:{bottom:{start:10,end:-100}},
onEnd:y.hitch(this,function(){this.currentState=0;x.setStyle(this.domNode,"display","none")})}).play()},_timerStart:function(){1!==this.currentState||this.timeoutHandler||(this.timeoutHandler=setTimeout(y.hitch(this,this.hide),a))},_timerStop:function(){this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=void 0)}})})},"jimu/MapUrlParamsHandler":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/topic dojo/promise/all esri/geometry/Point esri/geometry/Extent esri/geometry/scaleUtils esri/SpatialReference esri/tasks/ProjectParameters esri/config esri/geometry/webMercatorUtils esri/symbols/jsonUtils esri/graphic esri/layers/GraphicsLayer esri/InfoTemplate esri/tasks/query ./utils ./LayerInfos/LayerInfos ./shareUtils".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P){function K(a,e){var f=a.center.split(";");1===f.length&&(f=a.center.split(","));if(2===f.length||3===f.length){a=parseFloat(f[0]);var k=parseFloat(f[1]);if(isNaN(a)||isNaN(k))a=parseFloat(f[0]),k=parseFloat(f[1]);if(!isNaN(a)&&!isNaN(k)){var g=4326;3!==f.length||isNaN(f[2])||(g=parseInt(f[2],10));f=new w(a,k,new n(g));W(f.spatialReference,e.spatialReference)?e.centerAt(f):X(f,e.spatialReference,function(a){e.centerAt(a[0])},function(){console.error("Project center point error.")})}}}
function N(a,e){var f=a.extent.split("wkt\x3d"),k=null;2===f.length?(k=f[1],f=f[0],f=f.split(",")):(f=a.extent.split(";"),1===f.length&&(f=a.extent.split(",")));if(4===f.length||5===f.length){a=parseFloat(f[0]);var g=parseFloat(f[1]),c=parseFloat(f[2]),b=parseFloat(f[3]);if(isNaN(a)||isNaN(a)||isNaN(a)||isNaN(a))a=parseFloat(f[0]),g=parseFloat(f[1]),c=parseFloat(f[2]),b=parseFloat(f[3]);if(isNaN(a)||isNaN(g)||isNaN(c)||isNaN(b))console.error("Wrong extent parameters.");else{var d=4326;5!==f.length||
isNaN(f[4])||(d=parseInt(f[4],10));f=null;f=k?new t(a,g,c,b,new n({wkt:k})):new t(a,g,c,b,new n({wkid:d}));W(e.spatialReference,f.spatialReference)?e.setExtent(f):X(f,e.spatialReference,function(b){e.setExtent(b[0])},function(){console.error("Project extent error.")})}}else console.error("Wrong extent parameters.")}function C(a,k){var f=null;if(a.markertemplate){f={title:"",content:"",isIncludeShareUrl:!1};try{var g=JSON.parse(decodeURIComponent(a.markertemplate));B.mixin(f,g)}catch(v){console.error("urlParams: \x26markertemplate JSON.parse error."+
v.stack)}}g=a.marker.split(";");1===g.length&&(g=a.marker.split(","));if(2<=g.length&&6>=g.length&&g[0].length&&!isNaN(g[0])&&g[1].length&&!isNaN(g[1])){var p=parseFloat(g[0]),c=parseFloat(g[1]),b=4326;3<=g.length&&g[2].length&&!isNaN(g[2])&&(b=parseInt(g[2],10));var d="";4<=g.length&&(d=g[3]);a=null;5<=g.length&&0===g[4].indexOf("http")&&(a=g[4]);var h=null;6===g.length&&(h=g[5]);var l=e.fromJson({type:"esriPMS",url:a,contentType:"image/png"}),m=null;h&&(m=e.fromJson({color:[0,0,0,255],type:"esriTS",
verticalAlignment:"baseline",horizontalAlignment:"left",angle:0,xoffset:0,yoffset:0,rotated:!1,kerning:!0,font:{size:12,style:"normal",weight:"bold",family:"Arial"},text:h}));O(l).then(function(){var a=new w(p,c,new n({wkid:b}));W(a.spatialReference,k.spatialReference)?J(a,l,m,d,f,k):X(a,k.spatialReference,function(b){J(b[0],l,m,d,f,k)},function(){console.error("Project center point error.")})})}}function J(a,e,f,k,g,c){k=new z("",k);if(g){var b=P.getXyContent(g);g.isIncludeShareUrl&&(g=P.getShareUrl(c,
g,!0),g=P.getShareUrlContent(g),b+=g);k.setContent(b)}b=new u({id:"marker-feature-action-layer"});c.addLayer(b);k=new p(a,e,null,k);b.add(k);f&&(f.xoffset=e.width/2,f.yoffset=e.height/2+e.yoffset,e=new p(new w(a.toJson()),f),b.add(e),k._textSymbol=e);c.centerAt(a)}function O(a){var e=new y;a.url?I.getImagesSize(a.url).then(function(f){a.width=f[0];a.height=f[1];e.resolve(a)},function(){a.url=require.toUrl("jimu")+"/images/EsriBluePinCircle26.png";a.width=26;a.height=26;a.setOffset(0,a.height/2);e.resolve(a)}):
(a.url=require.toUrl("jimu")+"/images/EsriBluePinCircle26.png",a.width=26,a.height=26,a.setOffset(0,a.height/2),e.resolve(a));return e}function R(a,e){var f=a.query.split(";");1===f.length&&(f=a.query.split(","));if(2!==f.length&&3!==f.length)console.error("query URL parameter is not correct.");else{var k=f[0];U("name",k,e).then(function(a){null===a?U("id",k,e).then(function(a){null===a?console.error("Invalid layer name or id."):Q(e,a,f)}):Q(e,a,f)})}}function Q(a,e,f){var k=new M,g="";k.outSpatialReference=
a.spatialReference;if(2===f.length)k.where=f[1];else if(3===f.length&&(e.layerObject.url&&I.isHostedService(e.layerObject.url)&&I.containsNonLatinCharacter(f[2])&&(g="N"),m.forEach(e.layerObject.fields,function(a){if(a.alias.toLowerCase()===f[1].toLowerCase()||a.name.toLowerCase()===f[1].toLowerCase())-1<["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeOID"].indexOf(a.type)?k.where=a.name+"\x3d"+f[2]:-1<["esriFieldTypeString"].indexOf(a.type)&&
(k.where=f[1]+"\x3d"+g+"'"+f[2].replace(/\'/g,"''")+"'")},this),!k.where)){console.error("Invalid field name or type in query URL parameter.");return}k.maxAllowableOffset=1E-5;e.layerObject.queryFeatures(k).then(function(c){c=c.features;if(0===c.length)console.log("No result from query URL parameter.");else{if("esriGeometryPoint"===e.layerObject.geometryType&&1===c.length)a.setExtent(r.getExtentForScale(a,1E3)),a.centerAt(c[0].geometry);else{var b=I.graphicsExtent(c);a.setExtent(b)}T(a,e,c)}},function(a){console.error(a)})}
function T(a,e,f){function k(b){m.forEach(f,function(a){a.setInfoTemplate(b)})}function g(){a.infoWindow.setFeatures(f);a.infoWindow.show(S(f[0]))}if(a.getLayer(e.layerInfo.id))g();else{var c=e.layerInfo.getInfoTemplate();c?(k(c),g()):e.layerInfo.loadInfoTemplate().then(function(b){k(b);g()})}}function S(a){a=a.geometry;if("point"!==a.type)if("multipoint"===a.type)a=a.getPoint(0);else if("polyline"===a.type)a=a.getExtent().getCenter();else if("polygon"===a.type)a=a.getExtent().getCenter();else if("extent"===
a.type)a=a.getCenter();else return console.error("Can not get layer geometry type, unknow error."),null;return a}function U(a,e,f){var k=new y,p=[];L.getInstance(f,f.itemInfo).then(function(c){c.traversal(function(b){if(k.isResolved())return!0;("id"===a&&b.id.toLowerCase()===e.toLowerCase()||"name"===a&&b.title.toLowerCase()===e.toLowerCase())&&p.push(g({layerType:b.getLayerType(),layerObject:b.getLayerObject()}).then(function(a){"FeatureLayer"===a.layerType&&k.resolve({layerInfo:b,layerObject:a.layerObject})},
function(b){console.error("Find layer error from query URL parameter",b);k.resolve(null)}))});g(p).then(function(){k.isResolved()||k.resolve(null)})});return k}function X(e,g,f,p){var n=[102113,102100,3857],c;4326===e.spatialReference.wkid&&V(n,g.wkid)?(e.ymin=Math.max(e.ymin,-89.99),e.ymax=Math.min(e.ymax,89.99),e=k.geographicToWebMercator(e),(p=e.spatialReference._getInfo())&&e.xmin>e.xmax&&(n=p.valid[1]-e.xmin,c=e.xmax-p.valid[0],n>c?e.xmax=p.valid[1]+c:e.xmin=p.valid[0]-n),e.spatialReference.wkid=
g.wkid,f([e],null)):V(n,e.spatialReference.wkid)&&4326===g.wkid?(e=k.webMercatorToGeographic(e),(p=e.spatialReference._getInfo())&&e.xmin>e.xmax&&(n=p.valid[1]-e.xmin,c=e.xmax-p.valid[0],n>c?e.xmax=p.valid[1]+c:e.xmin=p.valid[0]-n),f([e],null)):(n=new A,n.geometries=[e],n.outSR=g,a.defaults.geometryService.project(n,function(b){!(b&&0<b.length&&b[0]&&"extent"===b[0].type)||isNaN(b[0].xmin)||isNaN(b[0].ymin)||isNaN(b[0].xmax)||isNaN(b[0].ymax)?b&&0<b.length&&b[0]&&"point"===b[0].type&&!isNaN(b[0].x)&&
!isNaN(b[0].y)&&f(b,null):f(b,null)},p))}function W(a,e){var f=[102113,102100,3857];return a&&e&&a.wkt===e.wkt&&(a.wkid===e.wkid||a.latestWkid&&a.latestWkid===e.wkid||e.latestWkid&&a.wkid===e.latestWkid||a.latestWkid&&a.latestWkid===e.latestWkid)||a&&e&&a.wkid&&e.wkid&&V(f,a.wkid)&&V(f,e.wkid)?!0:!1}function V(a,e){for(var f=a.length;f--;)if(a[f]===e)return!0;return!1}return{postProcessUrlParams:function(a,e){if("extent"in a)return N(a,e);if("center"in a)return K(a,e);if("marker"in a)return C(a,e);
if("find"in a)x.publish("publishData","framework","framework",{searchString:a.find},!0);else if("query"in a)return R(a,e)}}})},"jimu/shareUtils":function(){define("dojo/_base/lang esri/request dojo/promise/all jimu/shared/basePortalUrlUtils dojo/Deferred esri/lang jimu/portalUtils jimu/Role jimu/utils esri/urlUtils".split(" "),function(B,m,y,x,g,w,t,r,n,A){var a={getBaseHrefUrl:function(a){var e="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer",k="";window.isXT?k=window.location.protocol+
"//"+window.location.host+window.appInfo.appPath:(k=n.urlToObject(window.location.href).query||{},k=k.appid?a+"apps/"+e+"/index.html?appid\x3d"+k.appid:k.id?a+"apps/"+e+"/index.html?id\x3d"+k.id:n.getAppHref());return k},addQueryParamToUrl:function(a,e,g,n){a=A.urlToObject(a);a.query||(a.query={});a.query[e]=g;e=a.path;for(var k in a.query)g=a.query[k],!0===n&&(g=encodeURIComponent(g)),e=e===a.path?e+"?"+k+"\x3d"+g:e+"\x26"+k+"\x3d"+g;return e},removeQueryParamFromUrl:function(a,e,g){a=A.urlToObject(a);
a.query&&delete a.query[e];e=a.path;for(var k in a.query){var n=a.query[k];!0===g&&(n=encodeURIComponent(n));e=e===a.path?e+"?"+k+"\x3d"+n:e+"\x26"+k+"\x3d"+n}return e},getShareUrlContent:function(a){return"\x3cdiv class\x3d'marker-feature-action-popup'\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title jimu-float-leading'\x3e"+window.jimuNls.common.url+"\x3c/span\x3e\x3cinput type\x3d'text' class\x3d'jimu-float-leading' readonly\x3d'readonly' value\x3d"+a+"\x3e\x3c/input\x3e\x3c/div\x3e\x3c/div\x3e"},
getShareUrl:function(k,e,g){var n=a.getBaseHrefUrl(window.portalUrl),p="",m,r,t,w,x;e&&(e.longitude&&e.latitude?(m=e.longitude,r=e.latitude,p=e.longitude+","+e.latitude+","):e.x&&e.y&&e.spatialReference&&e.spatialReference.wkid&&(t=e.x,w=e.y,x=e.spatialReference.wkid,p=e.x+","+e.y+","+e.spatialReference.wkid));n=a.addQueryParamToUrl(n,"marker",p,!0);n=a.addQueryParamToUrl(n+",,,","markertemplate",encodeURIComponent(JSON.stringify({title:e.title,x:t,y:w,wkid:x,longitude:m,latitude:r,isIncludeShareUrl:g})));
e=k.getLevel();return n="number"===typeof e&&-1!==e?a.addQueryParamToUrl(n,"level",k.getLevel(),!0):a.addQueryParamToUrl(n,"scale",k.getScale(),!0)},getXyContent:function(a){var e="\x3cdiv class\x3d'marker-feature-action-popup'\x3e";a.longitude&&a.latitude?e+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+window.jimuNls.common.longitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+n.localizeNumber(parseFloat(a.longitude).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+
window.jimuNls.common.latitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+n.localizeNumber(parseFloat(a.latitude).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e":a.x&&a.y&&(e+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3ex\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+n.localizeNumber(parseFloat(a.x).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title'\x3ey\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+n.localizeNumber(parseFloat(a.y).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e");
return e+"\x3c/div\x3e"},_isUserOwnTheApp:function(a){return a&&a.username&&a.username===window.appInfo.appOwner?!0:!1},getItemByUserAndItemId:function(a,e,n,r){var k=new g;r=x.getStandardPortalUrl(r);r=r+"/sharing/rest/content/users/"+(e?e.username?e.username:e.email:n.email);if(w.isDefined(a.folderId)&&"/"!==a.folderId||w.isDefined(a.ownerFolder)&&"/"!==a.ownerFolder)r+="/"+(a.folderId||a.ownerFolder);r+="/items/"+a.id;m({url:r,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(B.hitch(this,
function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},_getProfile:function(a,e){var k=new g;a=x.getUserUrl(e,a.owner);m({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(B.hitch(this,function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},_unshareItemById:function(a,e,n){var k=new g;n=x.getStandardPortalUrl(n);n+="/sharing/rest/content/items/"+e+"/unshare";e={f:"json"};e=B.mixin(e,a);m({url:n,
handleAs:"json",content:e,callbackParamName:"callback"},{usePost:!0}).then(B.hitch(this,function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},canSharePublic:function(a){return!a.selfUrl||!0!==a.canSharePublic&&!1!==a.canSharePublic?!0:a.canSharePublic},unshareItemsByUser:function(a,e,n){var k=new g;n=x.getStandardPortalUrl(n);n+="/sharing/rest/content/users/"+a+"/unshareItems";a={f:"json"};a=B.mixin(a,e);m({url:n,handleAs:"json",content:a,callbackParamName:"callback"},
{usePost:!0}).then(B.hitch(this,function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},unshareItems:function(a,e,n){var k=new g;n=x.getStandardPortalUrl(n);n+="/sharing/rest/content/users/"+(e.owner||a.email)+"/unshareItems";a={f:"json"};a=B.mixin(a,e);m({url:n,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(B.hitch(this,function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},shareItemsByUser:function(a,
e,n){var k=new g;n=x.getStandardPortalUrl(n);n+="/sharing/rest/content/users/"+a+"/shareItems";a={f:"json"};a=B.mixin(a,e);m({url:n,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(B.hitch(this,function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},shareItems:function(a,e,n){var k=new g;n=x.getStandardPortalUrl(n);n+="/sharing/rest/content/users/"+(e.owner||a.email)+"/shareItems";a={f:"json"};a=B.mixin(a,e);m({url:n,handleAs:"json",
content:a,callbackParamName:"callback"},{usePost:!0}).then(B.hitch(this,function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},getItemsGroups:function(a,e){var k=new g;e=x.getStandardPortalUrl(e);e+="/sharing/rest/content/items/"+a.id+"/groups";m({url:e,handleAs:"json",content:{f:"json"},callbackParamName:"callback"},{usePost:!0}).then(B.hitch(this,function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},isSharedToPublic:function(a){return window.isXT?
!1:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&"undefined"!==typeof a.item.access&&"public"===a.item.access?!0:!1},isShowSocialMediaLinks:function(a){return window.isXT?!0:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&"undefined"!==typeof a.item.access&&"private"===a.item.access?!1:!0},getItemShareInfo:function(a){var e=new g,k="";if(window.isXT)return e.resolve(null);k=n.urlToObject(n.getAppHref()).query||{};k=k.id||k.appid;if("undefined"===typeof k||""===
k)return e.resolve(null);t.getPortal(a).getItemById(k).then(B.hitch(this,function(a){var k={};k.item=a;k.item&&"undefined"===typeof k.item.sharing&&k.item.access&&(k.item.sharing={access:k.item.access});e.resolve(k)}),B.hitch(this,function(a){console.log(a);e.resolve(null)}));return e},getShareInfo:function(k){var e=t.getPortal(k),p=new g,m="";if(window.isXT)return p.resolve(null);m=n.urlToObject(n.getAppHref()).query||{};m=m.id||m.appid;if("undefined"===typeof m||""===m)return p.resolve(null);y({getUser:e.getUser(),
loadSelfInfo:e.loadSelfInfo(),getItem:e.getItemById(m)}).then(B.hitch(this,function(e){var g={};g.item=e.getItem;g.item&&g.item.ownerFolder&&g.item.ownerFolder.length&&"/"!==g.item.ownerFolder&&(g.item.folderId=g.item.ownerFolder);"undefined"===typeof g.item.sharing&&g.item.access&&(g.item.sharing={access:g.item.access});g.user=e.getUser;a._setUserRole(e.loadSelfInfo,g);g.currentUser=g.user;g.isAdmin=!1;g.userRole&&(g.userRole.isAdmin()||g.userRole.isCustom()&&g.userRole.canUpdateOrgItems())?(g.isAdmin=
!0,g.item.owner!==g.currentUser.name?a._getProfile(g.item,k).then(B.hitch(this,function(a){g.itemUser=a;g.itemUser.orgId!==g.currentUser.orgId&&(g.isAdmin=!1);p.resolve(g)})):(g.itemUser=g.currentUser,p.resolve(g))):(g.currentUser&&(g.itemUser=g.currentUser),p.resolve(g))}),B.hitch(this,function(a){console.log(a);p.resolve(null)}));return p},_setUserRole:function(a,e){e.userPortalUrl=a.urlKey?a.urlKey+"."+a.customBaseUrl:this.portalUrl;!a||a.code||a.message||(e.organization=a);if(a&&a.user)e.userRole=
new r({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role}),e._isCustomRole=e.userRole.isCustom(),e._roleCanShareToGroup=e._isCustomRole&&e.userRole.canShareItemToGroup(),e._roleCanShareToOrg=e._isCustomRole&&e.userRole.canShareItemToOrg(),e._roleCanSharePublic=e._isCustomRole&&e.userRole.canShareItemToPublic(),e._roleCanShare=e._roleCanShareToGroup||e._roleCanShareToOrg||e._roleCanShareToPublic,e._roleCanUpdateItems=e._isCustomRole&&e.userRole.canUpdateOrgItems(),e._roleCanShareOthersItemsToGroup=
e._isCustomRole&&e.userRole.canShareOthersItemsToGroup(),e._roleCanShareOthersItemsToOrg=e._isCustomRole&&e.userRole.canShareOthersItemsToOrg(),e._roleCanShareOthersItemsToPublic=e._isCustomRole&&e.userRole.canShareOthersItemsToPublic(),e._roleCanShareOthersItems=e._isCustomRole&&(e.userRole.canShareOthersItemsToGroup()||e.userRole.canShareOthersItemsToOrg()||e._roleCanShareOthersItemsToPublic),e._orgUserCanSharePublicOrOverride=e.organization&&(!0===e.organization.canSharePublic&&(!e._isCustomRole||
e._roleCanSharePublic||e._roleCanShareOthersItemsToPublic)||e.userRole.isAdmin());else return!1},getItemById:function(a,e){var k=new g;e=x.getStandardPortalUrl(e);e+="/sharing/rest/content/items/"+a.id;m({url:e,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(B.hitch(this,function(a){k.resolve(a)}),B.hitch(this,function(a){console.error(a);k.reject(a)}));return k},disableWebMapPopup:function(a){a&&a.setInfoWindowOnClick&&a.setInfoWindowOnClick(!1)},enableWebMapPopup:function(a){a&&
a.setInfoWindowOnClick&&a.setInfoWindowOnClick(!0)}};return a})},"jimu/PopupManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/on dojo/query ./FeatureActionManager ./utils ./dijit/FeatureActionPopupMenu ./RelatedRecordsPopupProjector".split(" "),function(B,m,y,x,g,w,t,r,n,A){var a=null,k=B(null,{mapManager:null,popupUnion:null,_relatedRecordsPopupProjector:null,constructor:function(a){m.mixin(this,a);this.popupMenu=n.getInstance();this.isInited=!1;this.featureActionManager=
t.getInstance();x.subscribe("mapLoaded",m.hitch(this,this.onMapLoadedOrChanged));x.subscribe("mapChanged",m.hitch(this,this.onMapLoadedOrChanged));x.subscribe("appConfigChanged",m.hitch(this,this._onAppConfigChanged));x.subscribe("widgetsActionsRegistered",m.hitch(this,this._onWidgetsActionsRegistered))},init:function(){this.popupUnion=this.mapManager.getMapInfoWindow();this.popupUnion.bigScreen&&this.popupUnion.mobile&&this.popupUnion.bigScreen.domNode&&this.popupUnion.mobile.domNode&&!this.isInited&&
(this._createPopupMenuButton(),this._bindSelectionChangeEvent(),this.isInited=!0)},_createPopupMenuButton:function(){this.popupMenuButtonDesktop&&y.destroy(this.popupMenuButtonDesktop);this.popupMenuButtonMobile&&y.destroy(this.popupMenuButtonMobile);this.popupMenuButtonDesktop=y.create("span",{"class":"popup-menu-button"},w(".actionList",this.popupUnion.bigScreen.domNode)[0]);var a=w("div.esriMobileInfoView.esriMobilePopupInfoView .esriMobileInfoViewItem").parent()[0],a=y.create("div",{"class":"esriMobileInfoViewItem"},
a);this.popupMenuButtonMobile=y.create("span",{"class":"popup-menu-button"},a);g(this.popupMenuButtonMobile,"click",m.hitch(this,this._onPopupMenuButtonClick));g(this.popupMenuButtonDesktop,"click",m.hitch(this,this._onPopupMenuButtonClick))},_onPopupMenuButtonClick:function(a){a=y.position(a.target);this.popupMenu.show(a)},_bindSelectionChangeEvent:function(){g(this.popupUnion.bigScreen,"selection-change",m.hitch(this,this._onSelectionChange));g(this.popupUnion.mobile,"selection-change",m.hitch(this,
this._onSelectionChange))},_onSelectionChange:function(a){(this.selectedFeature=a.target.getSelectedFeature())?(this.initPopupMenu([this.selectedFeature]),a=this.selectedFeature.getLayer(),(this.selectedFeature.infoTemplate||a&&a.infoTemplate)&&this._createRelatedRecordsPopupProjector(this.selectedFeature)):this._disablePopupMenu()},_disablePopupMenu:function(){y.addClass(this.popupMenuButtonDesktop,"disabled");y.addClass(this.popupMenuButtonMobile,"disabled")},_enablePopupMenu:function(){y.removeClass(this.popupMenuButtonDesktop,
"disabled");y.removeClass(this.popupMenuButtonMobile,"disabled")},initPopupMenu:function(a){if(a){var e=r.toFeatureSet(a);this.featureActionManager.getSupportedActions(e).then(m.hitch(this,function(a){var k="ZoomTo ShowPopup Flash ExportToCSV ExportToFeatureCollection ExportToGeoJSON ShowRelatedRecords SaveToMyContent CreateLayer".split(" ");a=a.filter(m.hitch(this,function(a){return 0>k.indexOf(a.name)}));0===a.length?this._disablePopupMenu():this._enablePopupMenu();a=a.map(m.hitch(this,function(a){a.data=
e;return a}));this.popupMenu.setActions(a)}))}else this._disablePopupMenu(),this.popupMenu.setActions([])},onMapLoadedOrChanged:function(){this.isInited=!1;this.init()},_onAppConfigChanged:function(){this.popupUnion&&(this.popupUnion.bigScreen&&this.popupUnion.bigScreen.hide&&(this.popupUnion.bigScreen.hide(),this.popupMenu.hide()),this.popupUnion.mobile&&this.popupUnion.mobile.hide&&(this.popupUnion.mobile.hide(),this.popupMenu.hide()))},_onWidgetsActionsRegistered:function(){this.init()},_createRelatedRecordsPopupProjector:function(a){try{this._relatedRecordsPopupProjector&&
this._relatedRecordsPopupProjector.domNode&&(this._relatedRecordsPopupProjector.destroy(),this._relatedRecordsPopupProjector=null),this._relatedRecordsPopupProjector=new A({originalFeature:a,popup:this.mapManager.map.infoWindow,popupManager:this})}catch(p){console.warn(p.message)}}});k.getInstance=function(e){null===a&&(a=new k({mapManager:e}));return a};return k})},"jimu/FeatureActionManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Deferred dojo/promise/all ./featureActions/main ./utils".split(" "),
function(B,m,y,x,g,w,t,r){var n=null,A=B(null,{constructor:function(){this._actions=[];window.isBuilder?(x.subscribe("app/mapLoaded",m.hitch(this,this._onMapLoaded)),x.subscribe("app/mapChanged",m.hitch(this,this._onMapChanged))):(x.subscribe("mapLoaded",m.hitch(this,this._onMapLoaded)),x.subscribe("mapChanged",m.hitch(this,this._onMapChanged)));window.isBuilder?(x.subscribe("app/appConfigLoaded",m.hitch(this,this._onAppConfigLoaded)),x.subscribe("app/appConfigChanged",m.hitch(this,this._onAppConfigChanged))):
(x.subscribe("appConfigLoaded",m.hitch(this,this._onAppConfigLoaded)),x.subscribe("appConfigChanged",m.hitch(this,this._onAppConfigChanged)));this._registerFrameworkActions()},getAllActions:function(){return this._actions},getSupportedActions:function(a){a=this._getFeatureSet(a);var k=[];y.forEach(this._actions,function(e){var g=this.testActionSupportFeature(e,a);g.action=e;k.push(g)},this);return w(k).then(m.hitch(this,function(a){return a.map(m.hitch(this,function(a,e){return{result:a,action:this._actions[e]}})).filter(function(a){return a.result}).map(function(a){return a.action})}))},
testActionSupportFeature:function(a,k){k=this._getFeatureSet(k);var e;k.features&&0<k.features.length&&(e=k.features[0].getLayer());a=a.isFeatureSupported(k,e);var n=new g;a&&"function"===typeof a.then?a.then(function(a){n.resolve(a)},function(a){console.error(a);n.resolve(!1)}):n.resolve(a);return n},registerAction:function(a){var k=new g;require([a.uri],m.hitch(this,function(e){var g=new e({map:this.map,appConfig:this.appConfig,label:a.label,name:a.name,widgetId:a.widgetId});y.some(this._actions,
function(a){return g.name===a.name&&g.widgetId===a.widgetId})?(console.warn("Feature/FeatureSet action has been registered.",g.name),k.reject("Feature/FeatureSet action has been registered.",g.name)):(this._actions.push(g),k.resolve(g))}));return k},removeActionsByWidgetId:function(a){this._actions=y.filter(this._actions,function(k){return k.widgetId!==a},this)},getActionsByWidgetId:function(a){return y.filter(this._actions,function(k){return k.widgetId===a},this)},getActionsByActionName:function(a){return y.filter(this._actions,
function(k){return k.name===a},this)},registerWidgetFeatureActions:function(a){var k=new g;if(!a.featureActions||!a.uri)return k.resolve(),k;var e=[];y.forEach(a.featureActions,function(k){e.push(this.registerAction({uri:a.isRemote?a.amdFolder+k.uri+".js":a.amdFolder+k.uri,widgetId:a.id,name:k.name,label:a.manifest["i18nLabels_featureAction_"+k.name][window.dojoConfig.locale]||a.manifest["i18nLabels_featureAction_"+k.name].defaultLabel}))},this);return w(e)},registerAllWidgetFeatureActions:function(a){var k=
[];a.visitElement(m.hitch(this,function(a){a.uri&&a.visible&&k.push(this.registerWidgetFeatureActions(a))}));return w(k).then(function(){x.publish("widgetsActionsRegistered")})},_reRegisterWidgetActions:function(a){var k=[];y.forEach(this.getAllActions(),function(e){var k=a.getConfigElementById(e.widgetId);"framework"===e.widgetId||k&&k.uri&&!1!==k.visible||this.removeActionsByWidgetId(e.widgetId)},this);a.visitElement(m.hitch(this,function(a){a.uri&&a.visible&&0===this.getActionsByWidgetId(a.id).length&&
k.push(this.registerWidgetFeatureActions(a))}));0<k.length&&w(k).then(function(){x.publish("widgetsActionsRegistered")})},_registerFrameworkActions:function(){y.forEach(t,function(a){this.registerAction({uri:a.uri,widgetId:"framework",label:window.jimuNls.featureActions[a.name],name:a.name})},this)},_getFeatureSet:function(a){return"[object Object]"===Object.prototype.toString.call(a)?a.features?a:r.toFeatureSet([a]):r.toFeatureSet(a)},_onAppConfigLoaded:function(a){this.appConfig=a=m.clone(a);this._setActionsAppConfig(a);
this.registerAllWidgetFeatureActions(this.appConfig)},_onAppConfigChanged:function(a){this.appConfig=a=m.clone(a);this._reRegisterWidgetActions(this.appConfig);this._setActionsAppConfig(a)},_onMapLoaded:function(a){this.map=a;this._setActionsMap(a)},_onMapChanged:function(a){this.map=a;this._setActionsMap(a)},_setActionsMap:function(a){y.forEach(this._actions,function(k){k.setMap(a)},this)},_setActionsAppConfig:function(a){y.forEach(this._actions,function(k){k.setAppConfig(a)},this)}});A.getInstance=
function(){null===n&&(n=new A,window._featureActionManager=n);return n};return A})},"jimu/featureActions/main":function(){define("./ZoomTo ./PanTo ./Flash ./ShowPopup ./ExportToCSV ./ExportToFeatureCollection ./ExportToGeoJSON ./ShowStatistics ./CreateLayer ./AddMarker ./RemoveMarker ./SaveToMyContent".split(" "),function(){return[{name:"ZoomTo",uri:"jimu/featureActions/ZoomTo"},{name:"PanTo",uri:"jimu/featureActions/PanTo"},{name:"Flash",uri:"jimu/featureActions/Flash"},{name:"ShowPopup",uri:"jimu/featureActions/ShowPopup"},
{name:"ExportToCSV",uri:"jimu/featureActions/ExportToCSV"},{name:"ExportToFeatureCollection",uri:"jimu/featureActions/ExportToFeatureCollection"},{name:"ExportToGeoJSON",uri:"jimu/featureActions/ExportToGeoJSON"},{name:"ShowStatistics",uri:"jimu/featureActions/ShowStatistics"},{name:"CreateLayer",uri:"jimu/featureActions/CreateLayer"},{name:"AddMarker",uri:"jimu/featureActions/AddMarker"},{name:"RemoveMarker",uri:"jimu/featureActions/RemoveMarker"},{name:"SaveToMyContent",uri:"jimu/featureActions/SaveToMyContent"}]})},
"jimu/featureActions/ZoomTo":function(){define(["dojo/_base/declare","../BaseFeatureAction","jimu/utils"],function(B,m,y){return B(m,{name:"ZoomTo",iconClass:"icon-zoomto",isFeatureSupported:function(m){return 0<m.features.length&&m.features[0].geometry},onExecute:function(m){y.featureAction.zoomTo(this.map,m.features)}})})},"jimu/BaseFeatureAction":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(B,m){return B(null,{name:void 0,label:void 0,iconFormat:"svg",iconClass:"",map:null,
appConfig:{},widgetId:null,constructor:function(y){m.mixin(this,y)},isFeatureSupported:function(m,x){return!0},onExecute:function(m,x){},setMap:function(m){this.map=m},setAppConfig:function(m){this.appConfig=m},getIcon:function(m){return"framework"===this.widgetId?require.toUrl("jimu")+"/images/feature_actions/"+this.name+"_"+m+"."+this.iconFormat:this.appConfig.getConfigElementById(this.widgetId).folderUrl+"images/"+this.name+"_"+m+"."+this.iconFormat}})})},"jimu/featureActions/PanTo":function(){define(["dojo/_base/declare",
"../BaseFeatureAction","jimu/utils"],function(B,m,y){return B(m,{name:"PanTo",iconClass:"icon-panto",isFeatureSupported:function(m){return 0<m.features.length&&m.geometryType},onExecute:function(m){y.featureAction.panTo(this.map,m.features)}})})},"jimu/featureActions/Flash":function(){define(["dojo/_base/declare","dojo/_base/lang","../BaseFeatureAction","jimu/utils"],function(B,m,y,x){return B([y],{name:"Flash",iconClass:"icon-flash",isFeatureSupported:function(g,w){if(1>g.features.length||!w)return!1;
g=g.features[0];var t=m.getObject("renderer.symbol",!1,w);return g&&g.geometry&&(g.symbol||t)&&this.map.getLayer(w.id)},onExecute:function(g,m){x.featureAction.flash(g&&g.features,m)}})})},"jimu/featureActions/ShowPopup":function(){define(["dojo/_base/declare","../BaseFeatureAction","jimu/utils"],function(B,m,y){return B([m],{name:"ShowPopup",iconClass:"icon-show-popup",isFeatureSupported:function(m,g){return m&&m.features&&1===m.features.length&&g&&g.infoTemplate},onExecute:function(m){y.featureAction.showPopup(this.map,
m.features)}})})},"jimu/featureActions/ExportToCSV":function(){define(["dojo/_base/declare","../BaseFeatureAction","../exportUtils"],function(B,m,y){return B(m,{name:"ExportToCSV",iconClass:"icon-export",isFeatureSupported:function(m){return 0<m.features.length},onExecute:function(m){m=y.createDataSource({type:y.TYPE_FEATURESET,filename:"features",data:m});m.setFormat(y.FORMAT_CSV);m.download()}})})},"jimu/exportUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/json dojo/Deferred esri/tasks/query esri/tasks/QueryTask esri/tasks/FeatureSet esri/graphic esri/SpatialReference esri/tasks/ProjectParameters esri/config esri/geometry/webMercatorUtils jimu/LayerInfos/LayerInfos ./utils ./GeojsonConverters".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z){function M(a,e){var k="",g=e.length,n=a.length,p="",m="",r;try{y.forEach(a,function(a){k="string"===typeof a?k+p+a:k+p+(a.alias||a.name);p=","});for(var k=k+"\r\n",t=0;t<g;t++){p="";r=e[t];for(var z=0;z<n;z++){var w=a[z];(m=r["string"===typeof w?w:w.name])||"number"===typeof m||(m="");m&&("esriFieldTypeDate"===w.type?m=u.localizeDateByFieldInfo(m,w.fieldInfo):!w.fieldInfo||"esriFieldTypeDouble"!==w.type&&"esriFieldTypeSingle"!==w.type&&"esriFieldTypeInteger"!==
w.type&&"esriFieldTypeSmallInteger"!==w.type||(m=u.localizeNumberByFieldInfo(m,w.fieldInfo)));m&&/[",\r\n]/g.test(m)&&(m='"'+m.replace(/(")/g,'""')+'"');k=k+p+m;p=","}k+="\r\n"}return k}catch(V){return""}}var I={createDataSource:function(a){return a.type===I.TYPE_TABLE?new K(a):a.type===I.TYPE_FEATURESET?new P(a):null},TYPE_TABLE:"table",TYPE_FEATURESET:"FeatureSet",FORMAT_CSV:"CSV",FORMAT_FEATURESET:"FeatureSet",FORMAT_GEOJSON:"GeoJSON"},L=B(null,{filename:void 0,suffix:".txt",format:void 0,nls:void 0,
constructor:function(){this.nls=window.jimuNls.exportTo},getExportString:function(){},getSupportExportFormats:function(){},setFormat:function(a){this.format=a},download:function(){this.getExportString().then(m.hitch(this,function(a){var e=this.filename+this.suffix;10>dojo.isIE?saveTextAs(a,e,"utf-8"):(a=new Blob([a],{type:"text/plain;charset\x3dutf-8"}),saveAs(a,e,!0))}))},exportToPortal:function(a,e){}}),P=B(L,{featureSet:null,constructor:function(a){this.inherited(arguments);this.featureSet=a.data;
this.url=a.url;this.filename=a.filename},getExportString:function(){if(this.format===I.FORMAT_CSV)return this.suffix=".csv",this._getAsCSVString();if(this.format===I.FORMAT_FEATURESET)return this.suffix=".json",this._getAsFeatureSetString();if(this.format===I.FORMAT_GEOJSON)return this.suffix=".geojson",this._getAsGeoJsonString();var a=new g;a.resolve("");return a},getSupportExportFormats:function(){return[{value:I.FORMAT_CSV,label:this.nls.toCSV},{value:I.FORMAT_FEATURESET,label:this.nls.toFeatureCollection},
{value:I.FORMAT_GEOJSON,label:this.nls.toGeoJSON}]},_getFeatureSet:function(){var a=new g;if(this.featureSet)a.resolve(this.featureSet);else if(this.url){var e=new w;e.returnGeometry=!0;e.outFields=["*"];this.queryTask=new t(this.url);this.queryTask.execute(e,m.hitch(this,function(e){a.resolve(e)}),m.hitch(this,function(){a.resolve(null)}))}else a.resolve(null);return a},_getSpatialReference:function(a){if(a.spatialReference)return a.spatialReference;var e;y.some(a.features,function(a){if(a.geometry&&
a.geometry.spatialReference)return e=a.geometry.spatialReference,!0});return e},_projectToWGS84:function(p){var m=new g,t=this._getSpatialReference(p);if(t)if(4326===parseInt(t.wkid,10))m.resolve(p);else if(t.isWebMercator()){var t=new r,z=[];y.forEach(p.features,function(a){var k=new n;k.attributes=a.attributes;k.geometry=e.webMercatorToGeographic(a.geometry);z.push(k)});t.features=z;m.resolve(t)}else{t=new a;t.geometries=y.map(p.features,function(a){return a.geometry});t.outSR=new A(4326);var w=
k&&k.defaults&&k.defaults.geometryService;w&&"esri.tasks.GeometryService"===w.declaredClass||(w=u.getArcGISDefaultGeometryService());w.project(t).then(function(a){var e=new r,k=[];y.forEach(p.features,function(e,g){var p=new n;p.attributes=e.attributes;p.geometry=a[g];k.push(p)});e.features=k;m.resolve(e)},function(a){console.error(a);m.resolve([])})}else m.resolve([]);return m},_getAsFeatureSetString:function(){return this._getFeatureSet().then(m.hitch(this,function(a){var e="";a&&(a=a.toJson())&&
(e=x.stringify(a));return e}))},_getAsGeoJsonString:function(){return this._getFeatureSet().then(m.hitch(this,function(a){return this._projectToWGS84(a)})).then(m.hitch(this,function(a){var e="";if(a&&a.features&&0<a.features.length){var k={type:"FeatureCollection",features:[]};y.forEach(a.features,function(a){k.features.push(z.arcgisToGeoJSON(a))});e=x.stringify(k)}return e}))},_getAsCSVString:function(){return this._getFeatureSet().then(m.hitch(this,function(a){var e="";a&&(e=this._createCSVFromFeatureSet(a));
return e}))},_createCSVFromFeatureSet:function(a){var e=this._generateFields(a),k=y.map(a.features,function(e){var k=m.clone(e.attributes);"esriGeometryPoint"!==a.geometryType&&"point"!==a.geometryType||!e.geometry||(k.x=e.geometry.x,k.y=e.geometry.y,e.geometry.spatialReference&&e.geometry.spatialReference.wkid&&(k.wkid=e.geometry.spatialReference.wkid));return k});return M(e,k)},_generateFields:function(a){var e=a.features[0],k,g,n;e._layer&&(k=e._layer.fields,n=e._layer.id);k=m.clone(k||a.fields);
if(!k||0===k.length)for(g in k=[],e=e.attributes,e)e.hasOwnProperty(g)&&k.push({name:g});if(g=p.getInstanceSync().getLayerInfoById(n)){var r=g.getPopupInfo();r||(r=g.layerObject.infoTemplate&&g.layerObject.infoTemplate.info);y.forEach(k,m.hitch(this,function(a){a.fieldInfo=this._findFieldInfo(r,a.name)}))}a.fieldAliases&&y.forEach(k,function(e){a.fieldAliases[e.name]&&(e.alias=a.fieldAliases[e.name])});if("esriGeometryPoint"===a.geometryType||"point"===a.geometryType)k.push({name:"x",type:"esriFieldTypeDouble",
alias:"x"}),k.push({name:"y",type:"esriFieldTypeDouble",alias:"y"}),k.push({name:"wkid",type:"esriFieldTypeInteger",alias:"wkid"});return k},_findFieldInfo:function(a,e){if(!a)return null;var k;y.some(a.fieldInfos,function(a){if(a.fieldName===e)return k=a,!0});return k}}),K=B(L,{table:null,constructor:function(a){this.inherited(arguments);this.table=a.data;this.url=a.url;this.filename=a.filename},getExportString:function(){if(this.format===I.FORMAT_CSV)return this.suffix=".csv",this._getAsCSVString();
var a=new g;a.resolve("");return a},getSupportExportFormats:function(){return[{value:I.FORMAT_CSV,label:this.nls.toCSV}]},_getTableData:function(){var a=new g;if(this.table)a.resolve(this.table);else if(this.url){var e=new w;e.outFields=["*"];this.queryTask=new t(this.url);this.queryTask.execute(e,m.hitch(this,function(e){var k={};k.fields=e.fields;k.datas=y.map(e.features,function(a){return a.attributes});a.resolve(k)}),m.hitch(this,function(){a.resolve(null)}))}else a.resolve(null);return a},_getAsCSVString:function(){return this._getTableData().then(m.hitch(this,
function(a){var e="";a&&(e="\ufeff"+M(a.fields,a.datas));return e}))}});return I})},"jimu/GeojsonConverters":function(){define([],function(){function B(g){var m;a:{m=g[0];for(var n=0;n<m.length;n++)if(m[n]!==g[g.length-1][n]){m=!1;break a}m=!0}m||g.push(g[0]);return g}function m(g){var m=0,n=0,t=g.length,a=g[n],k;for(n;n<t-1;n++)k=g[n+1],m+=(k[0]-a[0])*(k[1]+a[1]),a=k;return 0<=m}function y(g,m){for(var n=0;n<g.length-1;n++)for(var r=0;r<m.length-1;r++){var a;a:{var k=g[n],e=g[n+1],p=m[r],u=m[r+1],
t=(u[0]-p[0])*(k[1]-p[1])-(u[1]-p[1])*(k[0]-p[0]);a=(e[0]-k[0])*(k[1]-p[1])-(e[1]-k[1])*(k[0]-p[0]);k=(u[1]-p[1])*(e[0]-k[0])-(u[0]-p[0])*(e[1]-k[1]);if(0!==k&&(t/=k,a/=k,0<=t&&1>=t&&0<=a&&1>=a)){a=!0;break a}a=!1}if(a)return!0}return!1}function x(g){var r=[];g=g.slice(0);var n=B(g.shift().slice(0));if(4<=n.length)for(m(n)||n.reverse(),r.push(n),n=0;n<g.length;n++){var t=B(g[n].slice(0));4<=t.length&&(m(t)&&t.reverse(),r.push(t))}return r}function g(g){var m={},n;for(n in g)g.hasOwnProperty(n)&&(m[n]=
g[n]);return m}var w={arcgisToGeoJSON:function(t,r){var n={};"number"===typeof t.x&&"number"===typeof t.y&&(n.type="Point",n.coordinates=[t.x,t.y]);t.points&&(n.type="MultiPoint",n.coordinates=t.points.slice(0));t.paths&&(1===t.paths.length?(n.type="LineString",n.coordinates=t.paths[0].slice(0)):(n.type="MultiLineString",n.coordinates=t.paths.slice(0)));if(t.rings){var x=t.rings.slice(0),n=[],a=[],k,e;for(e=0;e<x.length;e++){var p=B(x[e].slice(0));4>p.length||(m(p)?n.push([p]):a.push(p))}for(p=[];a.length;){e=
a.pop();for(var u=!1,x=n.length-1;0<=x;x--){var z=k=n[x][0],M=e;k=y(z,M);for(var M=M[0],I=!1,L=-1,P=z.length,K=P-1;++L<P;K=L)(z[L][1]<=M[1]&&M[1]<z[K][1]||z[K][1]<=M[1]&&M[1]<z[L][1])&&M[0]<(z[K][0]-z[L][0])*(M[1]-z[L][1])/(z[K][1]-z[L][1])+z[L][0]&&(I=!I);z=I;if(!k&&z){n[x].push(e);u=!0;break}}u||p.push(e)}for(;p.length;){e=p.pop();a=!1;for(x=n.length-1;0<=x;x--)if(k=n[x][0],y(k,e)){n[x].push(e);a=!0;break}a||n.push([e.reverse()])}n=1===n.length?{type:"Polygon",coordinates:n[0]}:{type:"MultiPolygon",
coordinates:n}}if(t.geometry||t.attributes)n.type="Feature",n.geometry=t.geometry?w.arcgisToGeoJSON(t.geometry):null,n.properties=t.attributes?g(t.attributes):null,t.attributes&&(n.id=t.attributes[r]||t.attributes.OBJECTID||t.attributes.FID);return n},geojsonToArcGIS:function(m,r){r=r||"OBJECTID";var n={wkid:4326},t={};switch(m.type){case "Point":t.x=m.coordinates[0];t.y=m.coordinates[1];t.spatialReference=n;break;case "MultiPoint":t.points=m.coordinates.slice(0);t.spatialReference=n;break;case "LineString":t.paths=
[m.coordinates.slice(0)];t.spatialReference=n;break;case "MultiLineString":t.paths=m.coordinates.slice(0);t.spatialReference=n;break;case "Polygon":t.rings=x(m.coordinates.slice(0));t.spatialReference=n;break;case "MultiPolygon":r=t;m=m.coordinates.slice(0);for(var a=[],k=0;k<m.length;k++)for(var e=x(m[k]),p=e.length-1;0<=p;p--){var u=e[p].slice(0);a.push(u)}r.rings=a;t.spatialReference=n;break;case "Feature":m.geometry&&(t.geometry=w.geojsonToArcGIS(m.geometry,r));t.attributes=m.properties?g(m.properties):
{};m.id&&(t.attributes[r]=m.id);break;case "FeatureCollection":t=[];for(n=0;n<m.features.length;n++)t.push(w.geojsonToArcGIS(m.features[n],r));break;case "GeometryCollection":for(t=[],n=0;n<m.geometries.length;n++)t.push(w.geojsonToArcGIS(m.geometries[n],r))}return t}};return w})},"jimu/featureActions/ExportToFeatureCollection":function(){define(["dojo/_base/declare","../BaseFeatureAction","../exportUtils"],function(B,m,y){return B(m,{name:"ExportToFeatureCollection",iconClass:"icon-export",isFeatureSupported:function(m){return 0<
m.features.length&&m.features[0].geometry},onExecute:function(m){m=y.createDataSource({type:y.TYPE_FEATURESET,filename:"features",data:m});m.setFormat(y.FORMAT_FEATURESET);m.download()}})})},"jimu/featureActions/ExportToGeoJSON":function(){define(["dojo/_base/declare","../BaseFeatureAction","../exportUtils"],function(B,m,y){return B(m,{name:"ExportToGeoJSON",iconClass:"icon-export",isFeatureSupported:function(m){return 0<m.features.length&&m.features[0].geometry},onExecute:function(m){m=y.createDataSource({type:y.TYPE_FEATURESET,
filename:"features",data:m});m.setFormat(y.FORMAT_GEOJSON);m.download()}})})},"jimu/featureActions/ShowStatistics":function(){define(["dojo/_base/declare","../BaseFeatureAction","jimu/dijit/FieldStatistics"],function(B,m,y){return B(m,{iconClass:"icon-statistics",isFeatureSupported:function(m,g){return 1<m.features.length&&g&&"esri.layers.GraphicsLayer"!==g.declaredClass&&0<this.getNumbericFields(g).length},onExecute:function(m,g){var w=new y;m={featureSet:m,layer:g,fieldNames:this.getNumbericFields(g).map(function(g){return g.name})};
w.showContentAsPopup(m)},getNumbericFields:function(m){return m.fields.filter(function(g){return-1<["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(g.type)})}})})},"jimu/dijit/FieldStatistics":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/NodeList-manipulate dojo/when dijit/form/Select esri/lang jimu/dijit/Popup jimu/dijit/LoadingIndicator jimu/utils jimu/statisticsUtils".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u){return B([m],{statInfo:null,postMixInProperties:function(){this.nls=window.jimuNls.fieldStatistics;y.mixin(this.nls,window.jimuNls.common)},showContent:function(a){this.statInfo=a;0!==this.statInfo.fieldNames.length&&(a=x.create("div",{className:"stat-container"},this.domNode),this._createFieldDom(a),1===this.statInfo.fieldNames.length&&(this.statInfo.fieldName=this.statInfo.fieldNames[0],this._showOneFieldStatContent(this.statInfo,a)))},showContentAsPopup:function(a){this.statInfo=
a;this._statisticsPopup&&this._statisticsPopup.domNode&&this._statisticsPopup.close();this._statisticsPopup=null;this._statisticsPopup=new k({titleLabel:this.nls.statistics,content:this.domNode,width:270,height:265,buttons:[{label:this.nls.ok}]});this.showContent(a)},_showOneFieldStatContent:function(a,k){var g;u.isStatFromServer(this.statInfo)&&(g=new e,g.placeAt(k),g.show());u.getStatisticsResult(this.statInfo).then(y.hitch(this,function(a){g&&g.destroy();t(".esriAGOTableStatistics",k).remove();
a=this._createStatContent(a);x.place(a,k)}))},_getFieldAliaseFromStatInfo:function(a){var e=this.statInfo.featureSet;(e=e&&e.fieldAliases)&&"undefined"!==typeof e[a]?e=e[a]:this.statInfo.layer?(e=g.filter(this.statInfo.layer.fields,function(e){return e.name===a}),e=e[0]?e[0].alias:""):e=a;return e},_createFieldDom:function(a){var e;if(1<this.statInfo.fieldNames.length){e=x.create("div",{className:"header"},a);x.create("span",{innerHTML:this.nls.field+": "},e);var k=new A({options:this.statInfo.fieldNames.map(y.hitch(this,
function(a){return{value:a,label:this._getFieldAliaseFromStatInfo(a)}})),style:{width:"150px"}});this.own(w(k,"change",y.hitch(this,function(e){this.statInfo.fieldName=e;this._showOneFieldStatContent(this.statInfo,a)})));k.placeAt(e);this.statInfo.fieldName=this.statInfo.fieldNames[0];this._showOneFieldStatContent(this.statInfo,a)}else e=x.create("div",{className:"header",innerHTML:"\x3cspan\x3e"+this.nls.field+"\x3c/span\x3e: "+this._getFieldAliaseFromStatInfo(this.statInfo.fieldNames[0])},a);return e},
_createStatContent:function(a){var e={},k="count sum min max ave stddev".split(" "),n,p,m,r,u,t,z,w;n=x.create("div",{className:"esriAGOTableStatistics",innerHTML:""});x.create("div",{className:"hzLine",innerHTML:""},n);p=x.create("table",{className:"attrTable",innerHTML:"",style:{cellpadding:0,cellspacing:0}},n);for(u in a)a.hasOwnProperty(u)&&(e[u.toLowerCase()]=a[u]);u=e.countfield;w=e.sumfield||"";z=e.minfield||"";t=e.maxfield||"";a=e.avgfield||"";e=e.stddevfield||"";m=x.create("tbody",{},p);
var A=this;g.forEach([u,w,z,t,a,e],function(a,e){""!==a&&(r=x.create("tr",{valign:"top"},m),x.create("td",{"class":"attrName",innerHTML:A.nls[k[e]]},r),x.create("td",{"class":"attrValue",innerHTML:a},r))});x.create("div",{className:"break",innerHTML:""},n);return n}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L){function P(a){return function(e){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(r.hitch(this,a,e))}}var K=m("dijit.form._SelectMenu",e,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(n(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,e=this.parentWidget.value;
r.isArray(e)&&(e=e[e.length-1]);e&&B.forEach(this.parentWidget._getChildren(),function(k){k.option&&e===k.option.value&&(a=!0,this.focusChild(k,!1))},this);a||this.inherited(arguments)}});g=m("dijit.form.Select"+(A("dojo-bidi")?"_NoBidi":""),[a,k,M],{baseClass:"dijitSelect dijitValidationTextBox",templateString:L,_buttonInputDisabled:A("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new K({id:this.id+"_menu",parentWidget:this});x.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(a.value||a.label){var e=r.hitch(this,"_setValueAttr",a);a=new p({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,
onClick:e,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a}return new u({ownerDocument:this.ownerDocument})},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return this.dropDown?this.dropDown.getChildren():[]},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(N){}},focusChild:function(a){a&&this.set("value",
a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=I.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,e,k,g){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{B.forEach(this._getChildren(),function(a){a.destroyRecursive()});
var e=new p({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(e)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);y.set(this.valueNode,"value",this.get("value"));this._refreshState()},_setNameAttr:"valueNode",
_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var e=a?"":this._missingMsg;e&&this.focused&&this._hasBeenBlurred?z.show(e,this.domNode,this.tooltipPosition,!this.isLeftToRight()):z.hide(this.domNode);this._set("message",e);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);z.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=w.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(n(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[t.LEFT_ARROW];delete a[t.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
x.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);z.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){z.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
A("dojo-bidi")&&(g=m("dijit.form.Select",g,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));g._Menu=K;g.prototype._onContainerKeydown=P("_onContainerKeydown");g.prototype._onContainerKeypress=P("_onContainerKeypress");return g})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e){return g("dijit.form._FormSelectWidget",e,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var e=this.options||[];if(null==a)return e;if(n.isArrayLike(a))return B.map(a,"return this.getOptions(item);",this);n.isString(a)&&(a={value:a});n.isObject(a)&&(B.some(e,function(e,k){for(var g in a)if(!(g in e)||e[g]!=a[g])return!1;a=k;return!0})||(a=-1));return 0<=a&&a<e.length?e[a]:null},addOption:function(a){B.forEach(n.isArrayLike(a)?a:[a],function(a){a&&n.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(n.isArrayLike(a)?
a:[a]);B.forEach(a,function(a){a&&(this.options=B.filter(this.options,function(e){return e.value!==a.value||e.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){B.forEach(n.isArrayLike(a)?a:[a],function(a){var e=this.getOptions({value:a.value}),k;if(e)for(k in a)e[k]=a[k]},this);this._loadChildren()},setStore:function(a,e,k){r.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,e,k)},_deprecatedSetStore:function(e,g,r){var p=this.store;r=r||{};if(p!==e){for(var u;u=this._notifyConnections.pop();)u.remove();e.get||(n.mixin(e,{_oldAPI:!0,get:function(a){var e=new m;this.fetchItemByIdentity({identity:a,onItem:function(a){e.resolve(a)},onError:function(a){e.reject(a)}});return e.promise},query:function(a,e){var g=new m(function(){p.abort&&p.abort()});g.total=new m;var p=this.fetch(n.mixin({query:a,onBegin:function(a){g.total.resolve(a)},
onComplete:function(a){g.resolve(a)},onError:function(a){g.reject(a)}},e));return new k(g)}}),e.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[y.after(e,"onNew",n.hitch(this,"_onNewItem"),!0),y.after(e,"onDelete",n.hitch(this,"_onDeleteItem"),!0),y.after(e,"onSet",n.hitch(this,"_onSetItem"),!0)]));this._set("store",e)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);r.query&&this._set("query",r.query);r.queryOptions&&this._set("queryOptions",r.queryOptions);e&&e.query&&(this._loadingStore=!0,this.onLoadDeferred=new m,this._queryRes=e.query(this.query,this.queryOptions),a(this._queryRes,n.hitch(this,function(a){if(this.sortByLabel&&!r.sort&&a.length)if(e.getValue)a.sort(x.createSortFunction([{attribute:e.getLabelAttributes(a[0])[0]}],e));else{var k=this.labelAttr;a.sort(function(a,e){return a[k]>e[k]?1:e[k]>
a[k]?-1:0})}r.onFetch&&(a=r.onFetch.call(this,a,r));B.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(n.hitch(this,function(a,e,k){e==k?this._onSetItem(a):(-1!=e&&this._onDeleteItem(a),-1!=k&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:g);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),n.hitch(this,function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)})));return p},_setValueAttr:function(a,e){this._onChangeActive||(e=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=n.isArrayLike(a)?B.map(a,function(a){return n.isObject(a)?a:{value:a}}):n.isObject(a)?[a]:[{value:a}];a=B.filter(this.getOptions(a),function(a){return a&&a.value});var k=this.getOptions()||[];this.multiple||a[0]&&a[0].value||!k.length||(a[0]=
k[0]);B.forEach(k,function(e){e.selected=B.some(a,function(a){return a.value===e.value})});k=B.map(a,function(a){return a.value});if("undefined"!=typeof k&&"undefined"!=typeof k[0]){var g=B.map(a,function(a){return a.label});this._setDisplay(this.multiple?g:g[0]);this.inherited(arguments,[this.multiple?k:k[0],e]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=B.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?
a:a[0]},_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(B.forEach(this._getChildren(),function(a){a.destroyRecursive()}),B.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var e=this;B.forEach(this._getChildren(),function(k){var g=B.some(a,function(a){return k.option&&
a===k.option.value});g&&!e.multiple&&(e.focusedChild=k);t.toggle(k.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),g);k.domNode.setAttribute("aria-selected",g?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var e=B.filter(a,function(a){return a.selected})[0];if(e&&e.value)return e.value;a[0].selected=!0;return a[0].value}return this.multiple?B.map(B.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,e){e&&e.parent||this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var e=this.store,k=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:e.getLabel(a);return{value:k?e.getIdentity(a):null,label:k,item:a}},_addOptionForItem:function(a){var e=this.store;e.isItemLoaded&&!e.isItemLoaded(a)?e.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);w.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?A("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+r._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);y.after(this,"onChange",n.hitch(this,"_updateSelection"));var a=this.store;a&&(a.getIdentity||a.getFeatures()["dojo.data.api.Identity"])&&(this.store=null,this._deprecatedSetStore(a,this._oValue,
{query:this.query,queryOptions:this.queryOptions}));this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(B,m,y,x){return B("dijit.DropDownMenu",x,{templateString:y,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(g){this._moveToPopup(g);g.stopPropagation();g.preventDefault()},
_onLeftArrow:function(g){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else g.stopPropagation(),g.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u){return m("dijit._MenuBase",[k,
u,p,e],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){g.toggle(this.domNode,"dijitMenuActive",a);g.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(e){var k=a.byNode(e);return e.parentNode==this.containerNode&&
k&&k.focus},postCreate:function(){var e=this,k="string"==typeof this.childSelector?this.childSelector:w.hitch(this,"childSelector");this.own(r(this.containerNode,r.selector(k,t.enter),function(){e.onItemHover(a.byNode(this))}),r(this.containerNode,r.selector(k,t.leave),function(){e.onItemUnhover(a.byNode(this))}),r(this.containerNode,r.selector(k,A),function(k){e.onItemClick(a.byNode(this),k);k.stopPropagation()}),r(this.containerNode,r.selector(k,"focusin"),function(){e._onItemFocus(a.byNode(this))}));
this.inherited(arguments)},onKeyboardSearch:function(a,e,k,g){this.inherited(arguments);if(a&&(-1==g||a.popup&&1==g))this.onItemClick(a,e)},_keyboardSearchCompare:function(a,e){return a.shortcutKey?e==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},
_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),!a.popup||a.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,{type:"click"})},this.passivePopupDelay));this._hoveredChild=
a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&
(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,e){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;a.popup?(this.set("selected",a),this.set("activated",!0),e=/^key/.test(e._origType||e.type)||0==e.clientX&&0==e.clientY,this._openItemPopup(a,
e)):(this.onExecute(),a._onClick?a._onClick(e):a.onClick(e))},_openItemPopup:function(a,e){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var k=a.popup;k.parentMenu=this;this.own(this._mouseoverHandle=r.once(k.domNode,"mouseover",w.hitch(this,"_onPopupHover")));var g=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){e&&g.focusChild(a);g._cleanUp()},onExecute:w.hitch(this,
"_cleanUp",!0),onClose:function(){g._mouseoverHandle&&(g._mouseoverHandle.remove(),delete g._mouseoverHandle)}},e);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(x.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),
this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(B,m,y,x,g,w,t,r,n,A){return m("dijit._KeyNavContainer",[n,A,r],{connectKeyNavHandlers:function(a,k){var e=this._keyNavCodes={},n=w.hitch(this,"focusPrev"),m=w.hitch(this,"focusNext");B.forEach(a,function(a){e[a]=n});B.forEach(k,function(a){e[a]=m});e[g.HOME]=w.hitch(this,"focusFirstChild");e[g.END]=w.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){x.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);B.forEach(this.getChildren(),
w.hitch(this,"_startupChild"))},addChild:function(a,k){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=
t.byNode(a))&&a.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(B,m,y,x,g,w,t,r){return m("dijit._KeyNavMixin",r,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);y.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var n=this._keyNavCodes={};n[x.HOME]=g.hitch(this,"focusFirstChild");n[x.END]=g.hitch(this,
"focusLastChild");n[this.isLeftToRight()?x.LEFT_ARROW:x.RIGHT_ARROW]=g.hitch(this,"_onLeftArrow");n[this.isLeftToRight()?x.RIGHT_ARROW:x.LEFT_ARROW]=g.hitch(this,"_onRightArrow");n[x.UP_ARROW]=g.hitch(this,"_onUpArrow");n[x.DOWN_ARROW]=g.hitch(this,"_onDownArrow")}var m=this,n="string"==typeof this.childSelector?this.childSelector:g.hitch(this,"childSelector");this.own(w(this.domNode,"keypress",g.hitch(this,"_onContainerKeypress")),w(this.domNode,"keydown",g.hitch(this,"_onContainerKeydown")),w(this.domNode,
"focus",g.hitch(this,"_onContainerFocus")),w(this.containerNode,w.selector(n,"focusin"),function(a){m._onChildFocus(t.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(g,m){g&&(this.focusedChild&&g!==this.focusedChild&&this._onChildBlur(this.focusedChild),g.set("tabIndex",this.tabIndex),g.focus(m?"end":"start"))},_onContainerFocus:function(g){g.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){y.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(g){y.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(g){g&&g!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),g.set("tabIndex",this.tabIndex),this.lastFocused=g,this._set("focusedChild",g))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(g,m,a,k){g&&this.focusChild(g)},_keyboardSearchCompare:function(g,m){var a=g.domNode;g=(g.label||(a.focusNode?
a.focusNode.label:"")||a.innerText||a.textContent||"").replace(/^\s+/,"").substr(0,m.length).toLowerCase();return m.length&&g==m?-1:0},_onContainerKeydown:function(g){var n=this._keyNavCodes[g.keyCode];n?(n(g,this.focusedChild),g.stopPropagation(),g.preventDefault(),this._searchString=""):g.keyCode!=x.SPACE||!this._searchTimer||g.ctrlKey||g.altKey||g.metaKey||(g.stopImmediatePropagation(),g.preventDefault(),this._keyboardSearch(g," "))},_onContainerKeypress:function(g){g.charCode<=x.SPACE||g.ctrlKey||
g.altKey||g.metaKey||(g.preventDefault(),g.stopPropagation(),this._keyboardSearch(g,String.fromCharCode(g.charCode).toLowerCase()))},_keyboardSearch:function(n,m){var a=null,k,e=0;g.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=m;var g=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;k=this._searchString.substr(0,g);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var n=this.focusedChild||
null;if(1==g||!n)if(n=this._getNextFocusableChild(n,1),!n)return;g=n;do{var r=this._keyboardSearchCompare(n,k);r&&0==e++&&(a=n);if(-1==r){e=-1;break}n=this._getNextFocusableChild(n,1)}while(n&&n!=g)})();this.onKeyboardSearch(a,n,k,e)},_onChildBlur:function(){},_getNextFocusableChild:function(g,m){var a=g;do{if(g)g=this._getNext(g,m);else if(g=this[0<m?"_getFirst":"_getLast"](),!g)break;if(null!=g&&g!=a&&g.isFocusable())return g}while(g!=a);return null},_getFirst:function(){return null},_getLast:function(){return null},
_getNext:function(g,m){if(g)for(g=g.domNode;g;)if((g=g[0>m?"previousSibling":"nextSibling"])&&"getAttribute"in g){var a=t.byNode(g);if(a)return a}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k){t=B("dijit.MenuItem"+(w("dojo-bidi")?"_NoBidi":""),[r,n,A,a],
{templateString:k,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var e="",k;k=a.search(/{\S}/);if(0<=k){var e=a.charAt(k+1),g=a.substr(0,k);a=a.substr(k+3);k=g+e+a;a=g+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+e+"\x3c/span\x3e"+a}else k=a;this.domNode.setAttribute("aria-label",k+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",e)},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){!a||
"label"in this.params||this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);y.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&y.set(this.accelKeyNode,"id",this.id+"_accel");m.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==w("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(e){}},_setSelected:function(a){x.toggle(this.domNode,"dijitMenuItemSelected",a)},setLabel:function(a){g.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.",
"","2.0");this.set("label",a)},setDisabled:function(a){g.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=a?"":"none",this.accelKeyNode.innerHTML=a,y.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});w("dojo-bidi")&&
(t=B("dijit.MenuItem",t,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return t})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(B,m){return B("dijit._Contained",null,{_getSibling:function(m){var x=this.getParent();return x&&x._getSiblingOfChild&&x._getSiblingOfChild(this,"previous"==m?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},
getIndexInParent:function(){var m=this.getParent();return m&&m.getIndexOfChild?m.getIndexOfChild(this):-1}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(B,m,y,x,g,w){return B("dijit.MenuSeparator",[y,x,g],{templateString:w,buildRendering:function(){this.inherited(arguments);m.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(B,m,y,x){return B(m,{baseClass:"jimu-loading-indicator jimu-agol-loading",declaredClass:"jimu.dijit.LoadingIndicator",hidden:!1,postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&y.set(this.domNode,{display:"none"});y.set(this.domNode,{width:"100%",height:"100%"});x.place(' \x3cdiv class\x3d"loading-container"\x3e\x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"img-div"\x3e\x3c/div\x3e\x3c/div\x3e',
this.domNode)},show:function(){this.domNode&&this.hidden&&(y.set(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(y.set(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/statisticsUtils":function(){define("dojo/_base/array dojo/when esri/tasks/StatisticDefinition esri/tasks/QueryTask esri/tasks/query esri/lang jimu/utils jimu/LayerInfos/LayerInfos exports".split(" "),function(B,m,y,x,g,w,t,r,n){function A(a){var e;e=new g;e.outFields=[a.fieldName];
e.outStatistics=[];e.geometry=a.geometry;var n=k(a);B.forEach(n,function(k){var g=new y;g.statisticType=k;g.displayFeildName=a.fieldName;g.onStatisticField=a.fieldName;g.outStatisticFieldName=M[k];e.outStatistics.push(g)});e.where=a.filterExpression?a.filterExpression:a.layer.getDefinitionExpression()?a.layer.getDefinitionExpression():"1\x3d1";a.geometry&&(e.geometry=a.geometry);return(new x(a.layer.url)).execute(e).then(function(e){return e&&e.features&&0<e.features.length?(e=e.features[0].attributes,
u(a,e),e):[]})}function a(a){var g={countField:0,sumField:0},n=k(a),p=0,m=0;a.featureSet.features.forEach(function(e){var k=e.attributes[a.fieldName];null!==k&&"undefined"!==typeof k&&n.forEach(function(a){switch(a){case "count":g.countField++;break;case "sum":g.sumField+=k;break;case "min":g.minField="undefined"===typeof g.minField?k:Math.min(g.minField,k);break;case "max":g.maxField="undefined"===typeof g.maxField?k:Math.max(g.maxField,k);break;case "avg":p++,m+=k}})});g.avgField=0===p?0:0===p?
"":m/p;var r=a.featureSet.features.filter(function(e){e=e.attributes[a.fieldName];return null===e||"undefined"===typeof e?!1:!0}).map(function(e){return e.attributes[a.fieldName]});g.stddevField=e(r);u(a,g);return g}function k(a){return a.statisticTypes&&0<a.statisticTypes.length?z.filter(function(e){return-1<a.statisticTypes.indexOf(e)}):z}function e(a){var e=a.length;if(1>=e)return 0;var k=0;a.forEach(function(a){k+=a});var g=k/e,n=0;a.forEach(function(a){n+=Math.pow(a-g,2)});return Math.sqrt(1/
(e-1)*n)}function p(a){var e=r.getInstanceSync();return a.layer?e.getLayerOrTableInfoById(a.layer.id).loadInfoTemplate().then(function(a){var e={};a.info&&a.info.fieldInfos&&a.info.fieldInfos.forEach(function(a){e[a.fieldName]=a});return e}):m({})}function u(a,e){if(a.fieldInfos&&a.fieldInfos[a.fieldName])for(var k in e)"countField"!==k&&w.isDefined(e[k])&&(e[k]=null===e[k]||"undefined"===typeof e[k]?"":t.localizeNumberByFieldInfo(e[k],a.fieldInfos[a.fieldName]))}var z="count sum min max avg stddev".split(" "),
M={count:"countField",sum:"sumField",min:"minField",max:"maxField",avg:"avgField",stddev:"stddevField"};n.getStatisticsResult=function(e){return p(e).then(function(k){e.fieldInfos=k;if(e.featureSet)return m(a(e));if(e.layer){if(e.layer.url)return A(e);e.featureSet=t.toFeatureSet(e.layer.graphics);return m(a(e))}})};n.isStatFromServer=function(a){return a.layer&&a.layer.url};n.getStddevVal=e;n.getStatisticsResultFromClientSync=a})},"jimu/featureActions/CreateLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/json dojo/on esri/layers/FeatureLayer esri/renderers/jsonUtils esri/symbols/jsonUtils ../BaseFeatureAction jimu/dijit/Popup jimu/dijit/Search jimu/LayerInfos/LayerInfos jimu/utils".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e){return B(n,{name:"CreateLayer",iconClass:"icon-create-layer",isFeatureSupported:function(a,e){return 0<a.features.length&&a.features[0].geometry&&e&&e.geometryType&&e.fields&&e.objectIdField},onExecute:function(a,e){var k;a={layerDefinition:{geometryType:e.geometryType,fields:m.clone(e.fields),objectIdField:e.objectIdField},featureSet:a.toJson()};a=new w(a);(k=e._json?x.parse(e._json):null)&&k.drawingInfo&&k.drawingInfo.renderer?(k=k.drawingInfo.renderer,k=t.fromJson(k)):
k=t.fromJson(e.renderer.toJson());a.setRenderer(k);(e=e.getSelectionSymbol())&&a.setSelectionSymbol(r.fromJson(e.toJson()));this._popupAddLayer(a)},_popupAddLayer:function(k){var n,p=y.create("div",{style:"padding: 0 10px 0 10px;"}),r=(new a({placeholder:window.jimuNls.layerInfosMenu.labelLayer})).placeAt(p);y.setStyle(r.searchBtn,"display","none");var t=new A({content:p,titleLabel:window.jimuNls.featureActions.CreateLayer,width:525,height:180,buttons:[{label:window.jimuNls.common.ok,onClick:m.hitch(this,
function(){k.name=e.stripHTML(r.getValue());this._addLayerToMap(k);t.close();n&&n.remove&&n.remove()})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],onClick:m.hitch(this,function(){t.close();n&&n.remove&&n.remove()})}]});r.inputSearch.focus();t.disableButton(0);n=g(r.inputSearch,"keyup",function(){r.getValue()?t.enableButton(0):t.disableButton(0)})},_addLayerToMap:function(a){var e=k.getInstanceSync(),n=g(e,"layerInfosChanged",m.hitch(this,function(e){a.id===e.id&&(e.enablePopup(),
n.remove())}));this.map.addLayer(a)}})})},"jimu/dijit/Search":function(){define("dojo/_base/declare dojo/_base/html dojo/string dojo/keys dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(B,m,y,x,g,w){return B([g,w],{baseClass:"jimu-search",declaredClass:"jimu.dijit.Search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn jimu-icon jimu-icon-search" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',
placeholder:"",onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&m.setAttr(this.inputSearch,"placeholder",this.placeholder)},getValue:function(){return y.trim(this.inputSearch.value)},doSearch:function(){if(this.onSearch)this.onSearch(this.getValue())},_onKeyDown:function(g){this.doChange();(void 0!==g.keyCode?g.keyCode:g.which)===x.ENTER&&this.doSearch();g.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()},
doChange:function(){if(this.onChange)this.onChange(this.getValue())}})})},"jimu/featureActions/AddMarker":function(){define("dojo/_base/declare ../BaseFeatureAction esri/graphic esri/layers/GraphicsLayer esri/symbols/PictureMarkerSymbol esri/InfoTemplate jimu/shareUtils".split(" "),function(B,m,y,x,g,w,t){return B(m,{name:"AddMarker",iconClass:"icon-add",_markerLayer:null,isFeatureSupported:function(g){this._getMarkerLayer();return this._isSupportType(g)&&0<g.features.length&&g.features[0]&&g.features[0].geometry&&
!1===this._isFeatureInMarkerFeatureActionLayer(g)},onExecute:function(g,n){this._addMarker(g,n)},_getMarkerLayer:function(){if(this.map.getLayer("marker-feature-action-layer"))this._markerLayer=this.map.getLayer("marker-feature-action-layer");else if(this._markerLayer=new x({id:"marker-feature-action-layer"}),this.map.addLayer(this._markerLayer),this.map.snappingManager){var g=this.map.snappingManager.layerInfos;g.push({layer:this._markerLayer});this.map.snappingManager.setLayerInfos(g)}},_addMarker:function(m,
n){var r=m.features[0].geometry,a={};n=n.displayField||m.displayFieldName||n.objectIdField;a.title="";m.features[0].attributes&&n&&(a.title=m.features[0].attributes[n],a.title||(a.title=""));n={};if("point"===r.type)n=r;else if("polygon"===r.type||"polyline"===r.type||"multipoint"===r.type)n=this.map.infoWindow&&this.map.infoWindow.isShowing?this.map.infoWindow.location:r.getExtent().getCenter();n.getLongitude()&&n.getLatitude()?(a.longitude=n.getLongitude(),a.latitude=n.getLatitude()):n.x&&n.y&&
(a.x=n.x,a.y=n.y);var k="";r&&r.spatialReference&&r.spatialReference.wkid&&(k=r.spatialReference.wkid);a.spatialReference={wkid:k};r=t.getXyContent(a);a=t.getShareUrl(this.map,a,!0);a=t.getShareUrlContent(a);a=r+a;r=new g(require.toUrl("jimu")+"/images/EsriBluePinCircle26.png");r.width=26;r.height=26;r.setOffset(0,r.height/2);n=new y(n,r,null,null);n._markerFeatureactionGraphic=m.features[0];n.infoTemplate=this._setInfoTemplate(a);this._markerLayer.add(n);this._closePopupWindow()},_setInfoTemplate:function(g){var n=
new w;n.setContent(g);return n},_closePopupWindow:function(){this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_isFeatureInMarkerFeatureActionLayer:function(g){return g.features[0]&&g.features[0]._graphicsLayer&&g.features[0]._graphicsLayer.id&&"marker-feature-action-layer"===g.features[0]._graphicsLayer.id?!0:!1},_isSupportType:function(g){if(g&&g.geometryType){if(g.features&&g.features.length&&1<g.features.length)return!1;g=g.geometryType;return"point"===g||"polygon"===g||"polyline"===
g||"multipoint"===g}return!1}})})},"jimu/featureActions/RemoveMarker":function(){define(["dojo/_base/declare","../BaseFeatureAction","esri/layers/GraphicsLayer"],function(B,m,y){return B(m,{name:"RemoveMarker",iconClass:"icon-close",_markerLayer:null,isFeatureSupported:function(m){this._getMarkerLayer();return 0<m.features.length&&m.geometryType&&m.features[0]&&m.features[0].geometry&&!0===this._isFeatureInMarkerFeatureActionLayer(m)},onExecute:function(m){this._removeMarker(m)},_getMarkerLayer:function(){if(this.map.getLayer("marker-feature-action-layer"))this._markerLayer=
this.map.getLayer("marker-feature-action-layer");else if(this._markerLayer=new y({id:"marker-feature-action-layer"}),this.map.addLayer(this._markerLayer),this.map.snappingManager){var m=this.map.snappingManager.layerInfos;m.push({layer:this._markerLayer});this.map.snappingManager.setLayerInfos(m)}},_removeMarker:function(m){m=m.features[0];m._textSymbol&&this._markerLayer.remove(m._textSymbol);this._markerLayer.remove(m);this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_isFeatureInMarkerFeatureActionLayer:function(m){return m.features[0]&&
m.features[0]._graphicsLayer&&m.features[0]._graphicsLayer.id?"marker-feature-action-layer"===m.features[0]._graphicsLayer.id:!1}})})},"jimu/featureActions/SaveToMyContent":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/json dojo/Deferred esri/graphicsUtils esri/IdentityManager jimu/portalUtils jimu/portalUrlUtils jimu/Role jimu/dijit/Message ../BaseFeatureAction jimu/dijit/Popup jimu/dijit/AddItemForm".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p){return B(k,{name:"SaveToMyContent",
iconClass:"icon-save",isFeatureSupported:function(a){return 0>=a.features.length||!a.features[0].geometry?!1:!0},onExecute:function(g,k){this.checkPrivilege().then(m.hitch(this,function(n){if(n)var r=new p({appConfig:this.appConfig}),u=new e({content:r,titleLabel:window.jimuNls.featureActions.SaveToMyContent,width:525,height:220,buttons:[{label:window.jimuNls.common.ok,onClick:m.hitch(this,function(){r.showBusy();u.disableButton(0);r.validate().then(m.hitch(this,function(a){a.valid?this._addItem(g,
k,r):(r.hideBusy(),u.enableButton(0))}))})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],onClick:m.hitch(this,function(){u.close()})}]});else new a({message:window.jimuNls.noEditPrivileges})}))},checkPrivilege:function(){var a=n.getStandardPortalUrl(this.appConfig.portalUrl),e=r.getPortal(a);if(e){if(e.haveSignIn())return this._hasPrivilege(e);t.useSignInPage=!1;return e.signIn().then(m.hitch(this,function(){t.useSignInPage=!0;return this._hasPrivilege(e)}),m.hitch(this,function(){t.useSignInPage=
!0}))}a=new g;a.resolve(!1);return a},_hasPrivilege:function(a){return a.loadSelfInfo().then(m.hitch(this,function(a){if(a&&a.user){var e=new A({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role});a.user.privileges&&e.setPrivileges(a.user.privileges);return e.canCreateItem()&&e.canPublishFeatures()}return!1}),function(){return!1})},_addItem:function(e,g,k){var n=k.getName(),p=k.getFolderId(),r=k.popup;g=g||{};var u={name:g.name||g.id,type:g.type||"Feature Layer",displayField:g.displayField,
description:g.description,copyrightText:g.copyright,geometryType:g.geometryType||e.geometryType,fields:g.fields||e.fields,objectIdField:g.objectIdField};e.features[0].geometry&&(g=w.graphicsExtent(e.features),u.initialExtent=g,u.fullExtent=g,u.extent=g);!u.objectIdField&&u.fields&&y.some(u.fields,function(a){if("esriFieldTypeOID"===a.type)return u.objectIdField=a.name,!0});e={layers:[{layerDefinition:u,featureSet:e.toJson()}]};k.addItem({name:n,title:n,type:"Feature Collection",typeKeywords:"WAB_created",
text:x.stringify(e)},p).then(m.hitch(this,function(e){!0===e.success?r.close():(k.hideBusy(),r.enableButton(0),new a({message:e.error?e.error.message:""}))}),function(e){k.hideBusy();r.enableButton(0);new a({message:e.message})})}})})},"jimu/dijit/AddItemForm":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddItemForm.html jimu/portalUtils jimu/portalUrlUtils dojo/data/ItemFileWriteStore dijit/form/ValidationTextBox dijit/form/FilteringSelect jimu/dijit/LoadingShelter".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a){return B([g,w,t],{baseClass:"jimu-item-form",templateString:r,appConfig:null,folderStore:null,portalUser:null,postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);var a=A.getStandardPortalUrl(this.appConfig.portalUrl);n.getPortal(a).getUser().then(m.hitch(this,function(a){this.portalUser=a;return a.getContent()})).then(m.hitch(this,function(a){this.folderStore=this._createFolderStore(a.folders,this.portalUser.username);
this.itemFolder.set("store",this.folderStore);this.itemFolder.set("required",!0);this.itemFolder.set("searchAttr","name");this.itemFolder.set("displayedValue",this.portalUser.username)}))},getName:function(){return this.itemName.get("value")},getFolderId:function(){return this.itemFolder.item?this.folderStore.getValue(this.itemFolder.item,"id"):""},showBusy:function(){this.shelter.show()},hideBusy:function(){this.shelter.hide()},validate:function(){var a=new x;this.itemForm.validate()?a.resolve({valid:!0}):
a.resolve({valid:!1,message:"param requried"});return a},addItem:function(a,e){if(this.portalUser)return this.portalUser.addItem(a,e);a=new x;a.resolve({error:{message:"portalUser is null"}});return a},_createFolderStore:function(g,e){var k=new a({data:{identifier:"id",label:"name",items:[]}});k.newItem({name:e,id:""});y.forEach(g,function(a){k.newItem({name:a.title,id:a.id})});return k}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox",
"./ComboBoxMixin"],function(B,m,y,x,g){return B("dijit.form.FilteringSelect",[x,g],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(g,m,r,n){m&&m[this.searchAttr]!==this._lastQuery||!m&&g.length&&this.store.getIdentity(g[0])!=this._lastQuery||(g.length?this.set("item",g[0],n):this.set("value",
"",n||void 0===n&&!this.focused,this.textbox.value,null))},_openResultList:function(g,m,r){m[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(g,t,r,n){this._onChangeActive||(t=null);if(void 0===n){if(null===g||""===g)if(g="",!m.isString(r)){this._setDisplayedValueAttr(r||"",t);return}var w=this;this._lastQuery=g;y(this.store.get(g),
function(a){w._callbackSetLabel(a?[a]:[],void 0,void 0,t)})}else this.valueNode.value=g,this.inherited(arguments,[g,t,r,n])},_setItemAttr:function(g,m,r){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(g){return g.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(g,t){null==g&&(g="");if(!this._created){if(!("displayedValue"in this.params))return;t=!1}if(this.store){this.closeDropDown();var r=m.clone(this.query),n=this._getDisplayQueryString(g),
w;this.store._oldAPI?w=n:(w=this._patternToRegExp(n),w.toString=function(){return n});this._lastQuery=r[this.searchAttr]=w;this._lastDisplayedValue=this.textbox.value=g;this._set("displayedValue",g);var a=this,k={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};m.mixin(k,this.fetchProperties);this._fetchHandle=this.store.query(r,k);y(this._fetchHandle,function(e){a._fetchHandle=null;a._callbackSetLabel(e||[],r,k,t)},function(e){a._fetchHandle=null;a._cancelingQuery||console.error("dijit.form.FilteringSelect: "+
e.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(B,m,y,x){return B("dijit.form.MappedTextBox",x,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(g){return g.toString?g.toString():""},toString:function(){var g=this.filter(this.get("value"));return null!=
g?"string"==typeof g?g:this.serialize(g,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=y.place("\x3cinput type\x3d'hidden'"+(this.name&&!m("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(B,m,y,x,g,w,t,r,n){return B("dijit.form.ComboBoxMixin",[r,w],{dropDownClass:t,hasDownArrow:!0,templateString:n,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(g){this._set("hasDownArrow",g);this._buttonNode.style.display=g?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(n){n.get||x.mixin(n,{_oldAPI:!0,get:function(a){var g=new m;this.fetchItemByIdentity({identity:a,
onItem:function(a){g.resolve(a)},onError:function(a){g.reject(a)}});return g.promise},query:function(a,k){var e=new m(function(){n.abort&&n.abort()});e.total=new m;var n=this.fetch(x.mixin({query:a,onBegin:function(a){e.total.resolve(a)},onComplete:function(a){e.resolve(a)},onError:function(a){e.reject(a)}},k));return g(e)}});this._set("store",n)},postMixInProperties:function(){var g=this.params.store||this.store;g&&this._setStoreAttr(g);this.inherited(arguments);if(!this.params.store&&this.store&&
!this.store._oldAPI){var a=this.declaredClass;x.mixin(this.store,{getValue:function(g,e){y.deprecated(a+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return g[e]},getLabel:function(g){y.deprecated(a+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return g.name},fetch:function(g){y.deprecated(a+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],
x.hitch(this,function(a){(new a({objectStore:this})).fetch(g)}))}})}},buildRendering:function(){this.inherited(arguments);this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(B,m,y,x,g,w,t,r,n,A,a){m=m("dijit.form._AutoCompleterMixin",a,{item:null,
autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var e=0;if("number"==typeof a.selectionStart)e=a.selectionStart;else if(r("ie")){var g=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();g.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",g),e=String(a.text).replace(/\r/g,"").length}catch(u){}}return e},_setCaretPos:function(a,e){e=parseInt(e);A.selectInputText(a,e,e)},_setDisabledAttr:function(a){this.inherited(arguments);
this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=a.charCode)){var e=a.charCode||a.keyCode;if(e!=x.ALT&&e!=x.CTRL&&e!=x.META&&e!=x.SHIFT){var g=this.dropDown,k=null;this._abortQuery();this.inherited(arguments);if(!(a.altKey||a.ctrlKey||a.metaKey))switch(this._opened&&(k=g.getHighlightedOption()),e){case x.PAGE_DOWN:case x.DOWN_ARROW:case x.PAGE_UP:case x.UP_ARROW:this._opened&&this._announceOption(k);a.stopPropagation();a.preventDefault();break;case x.ENTER:if(k){if(k==
g.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(k==g.previousButton){this._nextSearch(-1);a.stopPropagation();a.preventDefault();break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case x.TAB:e=this.get("displayedValue");if(g&&(e==g._messages.previousMessage||e==g._messages.nextMessage))break;k&&this._selectOption(k);case x.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},
_autoCompleteText:function(a){var e=this.focusNode;A.selectInputText(e,e.value.length);var g=this.ignoreCase?"toLowerCase":"substr";0==a[g](0).indexOf(this.focusNode.value[g](0))?(g=this.autoComplete?this._getCaretPos(e):e.value.length,g+1>e.value.length&&(e.value=a,A.selectInputText(e,g))):(e.value=a,A.selectInputText(e))},_openResultList:function(a,e,n){var k=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();a.length||0!=n.start?(this._nextSearch=this.dropDown.onPage=g.hitch(this,
function(e){a.nextPage(-1!==e);this.focus()}),this.dropDown.createOptions(a,n,g.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in n?(n.direction?this.dropDown.highlightFirstOption():n.direction||this.dropDown.highlightLastOption(),k&&this._announceOption(this.dropDown.getHighlightedOption())):!this.autoComplete||this._prev_key_backspace||/^[*]+$/.test(e[this.searchAttr].toString())||this._announceOption(this.dropDown.containerNode.firstChild.nextSibling)):this.closeDropDown()},
_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),e=this.dropDown;!e||a!=e._messages.previousMessage&&a!=e._messages.nextMessage?"undefined"==typeof this.item?
(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState()):this._setValueAttr(this._lastValueReported,!0);this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,e,g){var k="";a&&(g||(g=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),k=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):g);this.set("value",k,e,g,a)},_announceOption:function(a){if(a){var e;
if(a==this.dropDown.nextButton||a==this.dropDown.previousButton)e=a.innerHTML,this.item=void 0,this.value="";else{var g=this.dropDown.items[a.getAttribute("item")];e=(this.store._oldAPI?this.store.getValue(g,this.searchAttr):g[this.searchAttr]).toString();this.set("item",g,!1,e)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",y.get(a,"id"));this._autoCompleteText(e)}},_selectOption:function(a){this.closeDropDown();a&&
this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var e=this.id+"_popup";this.dropDown=new (g.isString(this.dropDownClass)?g.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:g.hitch(this,
this._selectOption),id:e,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new n({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var e=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,e):a[e]}}},postCreate:function(){var a=w('label[for\x3d"'+
this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);B.after(this,"onSearch",g.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=this.labelFunc(a,this.store);var e=this.labelType;"none"!=this.highlightMatch&&"text"==this.labelType&&this._lastInput&&(a=this.doHighlight(a,this._lastInput),e="html");return{html:"html"==e,label:a}},doHighlight:function(a,e){var g=(this.ignoreCase?"i":"")+("all"==
this.highlightMatch?"g":""),k=this.queryExpr.indexOf("${0}");e=t.escapeString(e);return this._escapeHtml(a.replace(new RegExp((0==k?"^":"")+"("+e+")"+(k==this.queryExpr.length-4?"$":""),g),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},
labelFunc:function(a,e){return(e._oldAPI?e.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,e,g,n){this._set("item",n||null);null==a&&(a="");this.inherited(arguments)}});r("dojo-bidi")&&m.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return m})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),
function(B,m,y,x,g,w){function t(g){return{id:g.value,value:g.value,name:y.trim(g.innerText||g.textContent||"")}}return B("dijit.form.DataList",g,{constructor:function(g,n){this.domNode=m.byId(n);y.mixin(this,g);this.id&&w.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:x("option",this.domNode).map(t)}])},destroy:function(){w.remove(this.id)},fetchSelectedItem:function(){var g=x("\x3e option[selected]",this.domNode)[0]||x("\x3e option",this.domNode)[0];return g&&t(g)}})})},
"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(B,m,y,x,g,w,t){return B("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(g){this._set("list",g)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(g){return new RegExp("^"+g.replace(/(\\.)|(\*)|(\?)|\W/g,function(g,m,a,k){return a?".*":
k?".":m?m:"\\"+g})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(g){if(!this.disabled&&
!this.readOnly){g=g.charOrCode;this._prev_key_backspace=!1;if(g==m.DELETE||g==m.BACKSPACE)this._maskValidSubsetError=this._prev_key_backspace=!0;if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(m){this._abortQuery();var n=this,r=y.clone(this.query),a={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},k=g.substitute(this.queryExpr,
[m.replace(/([\\\*\?])/g,"\\$1")]),e,p=function(){var g=n._fetchHandle=n.store.query(r,a);n.disabled||n.readOnly||e!==n._lastQuery||w(g,function(k){n._fetchHandle=null;n.disabled||n.readOnly||e!==n._lastQuery||w(g.total,function(e){k.total=e;var g=n.pageSize;if(isNaN(g)||g>k.total)g=k.total;k.nextPage=function(e){a.direction=e=!1!==e;a.count=g;e?(a.start+=k.length,a.start>=k.total&&(a.count=0)):(a.start-=g,0>a.start&&(a.count=Math.max(g+a.start,0),a.start=0));0>=a.count?(k.length=0,n.onSearch(k,r,
a)):p()};n.onSearch(k,r,a)})},function(a){n._fetchHandle=null;n._cancelingQuery||console.error(n.declaredClass+" "+a.toString())})};y.mixin(a,this.fetchProperties);this.store._oldAPI?e=k:(e=this._patternToRegExp(k),e.toString=function(){return k});this._lastQuery=r[this.searchAttr]=e;this._queryDeferHandle=this.defer(p,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var g=this.list;g&&(this.store=t.byId(g))}this.inherited(arguments)}})})},
"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(B,m,y,x,g,w,t,r){return B("dijit.form._ComboBoxMenu",[g,w,r,t],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(m.add(this.previousButton,"dijitMenuItemRtl"),m.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var g=this.ownerDocument.createElement("div");g.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");g.setAttribute("role","option");return g},onHover:function(g){m.add(g,"dijitMenuItemHover")},onUnhover:function(g){m.remove(g,
"dijitMenuItemHover")},onSelect:function(g){m.add(g,"dijitMenuItemSelected")},onDeselect:function(g){m.remove(g,"dijitMenuItemSelected")},_page:function(g){var n=0,a=this.domNode.scrollTop,k=y.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();n<k;){var e=this.getHighlightedOption();if(g){if(!e.previousSibling||"none"==e.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!e.nextSibling||"none"==e.nextSibling.style.display)break;this.selectNextNode()}e=
this.domNode.scrollTop;n+=(e-a)*(g?-1:1);a=e}},handleKey:function(g){switch(g.keyCode){case x.DOWN_ARROW:return this.selectNextNode(),!1;case x.PAGE_DOWN:return this._page(!1),!1;case x.UP_ARROW:return this.selectPreviousNode(),!1;case x.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(B,m,y,x,g){var w=m("dijit.form._ComboBoxMenuMixin"+
(x("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=g.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(g){this._set("value",g);this.onChange(g)},onClick:function(g){if(g==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(g==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(g)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(g,m){var n=this._createMenuItem();g=m(g);g.html?n.innerHTML=g.label:n.appendChild(n.ownerDocument.createTextNode(g.label));""==n.innerHTML&&(n.innerHTML="\x26#160;");return n},createOptions:function(g,m,n){this.items=g;this.previousButton.style.display=0==m.start?"none":"";y.set(this.previousButton,"id",this.id+
"_prev");B.forEach(g,function(a,g){a=this._createOption(a,n);a.setAttribute("item",g);y.set(a,"id",this.id+g);this.nextButton.parentNode.insertBefore(a,this.nextButton)},this);var r=!1;g.total&&!g.total.then&&-1!=g.total?m.start+m.count<g.total?r=!0:m.start+m.count>g.total&&m.count==g.length&&(r=!0):m.count==g.length&&(r=!0);this.nextButton.style.display=r?"":"none";y.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var g=this.containerNode;2<g.childNodes.length;)g.removeChild(g.childNodes[g.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});x("dojo-bidi")&&(w=m("dijit.form._ComboBoxMenuMixin",
w,{_createOption:function(){var g=this.inherited(arguments);this.applyTextDir(g);return g}}));return w})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(B,m,y,x){return B("dijit.form._ListMouseMixin",x,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(g,m){this._setSelectedAttr(m,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(m)})},_onMouseDown:function(g,m){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(m,!1)},_onMouseUp:function(g,m){this._isDragging=!1;var t=this.selected,r=this._hoveredNode;t&&m==t?this.defer(function(){this._onClick(g,
t)}):r&&this.defer(function(){this._onClick(g,r)})},_onMouseOut:function(g,m){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(g,m){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=m;this.onHover(m);this._isDragging&&this._setSelectedAttr(m,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(B,m,y){return B("dijit.form._ListBase",null,{selected:null,_listConnect:function(x,g){var w=this;return w.own(m(w.containerNode,m.selector(function(g,m,n){return g.parentNode==n},x),function(m){w[g](m,this)}))},selectFirstNode:function(){for(var m=this.containerNode.firstChild;m&&"none"==m.style.display;)m=m.nextSibling;this._setSelectedAttr(m,!0)},selectLastNode:function(){for(var m=this.containerNode.lastChild;m&&"none"==m.style.display;)m=m.previousSibling;this._setSelectedAttr(m,
!0)},selectNextNode:function(){var m=this.selected;if(m){for(m=m.nextSibling;m&&"none"==m.style.display;)m=m.nextSibling;m?this._setSelectedAttr(m,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var m=this.selected;if(m){for(m=m.previousSibling;m&&"none"==m.style.display;)m=m.previousSibling;m?this._setSelectedAttr(m,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(m,g){if(this.selected!=m){var w=this.selected;if(w)this.onDeselect(w);
m&&(g&&y.scrollIntoView(m),this.onSelect(m));this._set("selected",m)}else if(m)this.onSelect(m)}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(B,m,y,x,g){return B([m,y],{baseClass:"jimu-loading-shelter jimu-agol-loading",declaredClass:"jimu.dijit.LoadingShelter",templateString:x,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=
window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&g.setStyle(this.domNode,"display","none");g.setStyle(this.domNode,{width:"100%",height:"100%"});this.showLoading||g.setStyle(this.loadingNode,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(m){this.domNode&&this.hidden&&("string"===typeof m&&(this.textNode.innerHTML=m),g.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&
!this.hidden&&(g.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/dijit/FeatureActionPopupMenu":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/dom-geometry dijit/_WidgetBase dijit/_TemplatedMixin jimu/FeatureActionManager ./FeatureActionPopupMenuItem".split(" "),function(B,m,y,x,g,w,t,r,n,A){var a=null,k=B([t,r],{baseClass:"popup-menu",templateString:'\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d"menuNode" class\x3d"menu-content"\x3e\x3cdiv class\x3d"menu-title" data-dojo-attach-point\x3d"titleNode"\x3e\x3cdiv class\x3d"label jimu-float-leading" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"feature-action icon-close close-btn jimu-float-trailing" data-dojo-attach-point\x3d"closeBtn"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"menu-items" data-dojo-attach-point\x3d"menuContent"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
postCreate:function(){this.inherited(arguments);this.hide();this.menuItems=[];this.own(g(this.domNode,"click",y.hitch(this,function(a){a=a.target||a.srcElement;a===this.menuNode||m.isDescendant(a,this.menuNode)||this.hide()})));this.own(g(this.closeBtn,"click",y.hitch(this,this.hide)))},setActions:function(a){this.clearActions();x.forEach(a,y.hitch(this,this._addMenuItem))},appendAction:function(a){this._addMenuItem(a)},clearActions:function(){this.menuItems=[];m.empty(this.menuContent)},_addMenuItem:function(a){a=
new A({action:a});m.place(a.domNode,this.menuContent);a.startup();this.menuItems.push(a);this.own(g(a,"click",y.hitch(this,this.hide)))},markAsSelected:function(a){x.forEach(this.menuItems,function(e){e.action.label===a.label?e.setSelected(!0):e.setSelected(!1)})},prepareActions:function(a,g){return n.getInstance().getSupportedActions(a).then(y.hitch(this,function(e){!1===g&&(e=x.filter(e,function(a){return 0!==a.name.indexOf("Export")&&"SaveToMyContent"!==a.name}));x.forEach(e,function(e){e.data=
a},this);this.setActions(e)}))},hide:function(){m.setStyle(this.domNode,"display","none")},show:function(a,g){if(0===this.menuItems.length)m.setStyle(this.domNode,"display","none");else{"string"===typeof g&&""!==g?(this.labelNode.innerHTML=g,m.setStyle(this.titleNode,"display","")):(this.labelNode.innerHTML="",m.setStyle(this.titleNode,"display","none"));g=a.y+a.h;var e;a=window.isRTL?a.x:a.x+a.w;m.setStyle(this.domNode,"display","");m.setStyle(this.menuNode,{left:"-1000px",top:"0px",display:"block"});
e=w.getMarginSize(this.menuNode);m.setStyle(this.menuNode,{left:(window.isRTL?a+e.w>window.innerWidth?window.innerWidth-e.w:0>a?0:a:0>a-e.w?0:a>window.innerWidth?window.innerWidth-e.w:a-e.w)+"px",top:(e.h>window.innerHeight?0:g+e.h>window.innerHeight?window.innerHeight-e.h:g+e.h+5<window.innerHeight?g+5:g)+"px"})}}});k.getInstance=function(){null===a&&(a=new k,m.place(a.domNode,document.body),a.startup());a.setActions([]);return a};return k})},"jimu/dijit/FeatureActionPopupMenuItem":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/event dojo/on dojo/mouse dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),
function(B,m,y,x,g,w,t,r,n){return B([r,n,t],{baseClass:"popup-menu-item",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"icon jimu-float-leading" data-dojo-attach-point\x3d"iconContainer"\x3e\x3cdiv class\x3d"feature-action" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"label" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\x3c/div\x3e',action:null,postCreate:function(){this.inherited(arguments);this.action&&(this.labelNode.innerHTML=this.action.label,this.labelNode.title=
this.action.label,this.action.iconClass?("no-icon"===this.action.iconClass&&m.addClass(this.iconContainer,"no-icon"),m.addClass(this.iconNode,this.action.iconClass)):m.setStyle(this.iconNode,"background-image","url("+this.action.getIcon("default")+")"),this.own(g(this.domNode,w.enter,y.hitch(this,this._useHoverIcon))),this.own(g(this.domNode,w.leave,y.hitch(this,this._useNormalIcon))));this.own(g(this.domNode,"click",y.hitch(this,this._clickHandler)))},setSelected:function(g){g?m.addClass(this.domNode,
"selected"):m.removeClass(this.domNode,"selected")},_useNormalIcon:function(){this.action.iconClass?m.removeClass(this.iconNode,"highlight"):m.setStyle(this.iconNode,"background-image","url("+this.action.getIcon("default")+")")},_useHoverIcon:function(){this.action.iconClass?m.addClass(this.iconNode,"highlight"):m.setStyle(this.iconNode,"background-image","url("+this.action.getIcon("hover")+")")},_clickHandler:function(g){x.stop(g);if(this.action){var a;this.action.data.features&&0<this.action.data.features.length&&
(a=this.action.data.features[0].getLayer());this.action.onExecute(this.action.data,a)}this.emit("click")}})})},"jimu/RelatedRecordsPopupProjector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/has dojo/query dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin esri/undoManager esri/OperationBase esri/tasks/RelationshipQuery esri/dijit/Popup esri/dijit/PopupMobile esri/graphicsUtils esri/dijit/PopupTemplate jimu/utils jimu/ConfigManager jimu/dijit/DropdownMenu jimu/LayerInfos/LayerInfos".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K){var N=B([n,A],{baseClass:"related-records-popup-projector",templateString:"\x3cdiv\x3e\x3cdiv class\x3d'operation-box' data-dojo-attach-point\x3d'operationBox' style\x3d'display: none'\x3e\x3cdiv class\x3d'previos-btn feature-action' data-dojo-attach-point\x3d'previouBtn'data-dojo-attach-event\x3d'click:_onPreviouBtnClick'\x3e\x3c/div\x3e\x3cdiv class\x3d'operation-title' data-dojo-attach-point\x3d'operationTitle'\x3eabc\x3c/div\x3e\x3cdiv class\x3d'add-new-btn' data-dojo-attach-point\x3d'addNewBtn'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'content-box' data-dojo-attach-point\x3d'contentBox'\x3e\x3c/div\x3e\x3c/div\x3e",
popup:null,popupManager:null,undoManager:null,originalFeature:null,originalJimuLayerInfo:null,_temporaryData:null,postCreate:function(){this.undoManager=new a;this.layerInfosObj=K.getInstanceSync();var e=m.getObject("_wabProperties.referToFeatureLayerId",!1,this.originalFeature)||this.originalFeature.getLayer().id;this.originalJimuLayerInfo=this.layerInfosObj.getLayerInfoById(e);this._temporaryData={eventHandles:[],dijits:[]};window.isRTL?x.addClass(this.previouBtn,"icon-arrow-forward"):x.addClass(this.previouBtn,
"icon-arrow-back");e=this._createOperation({feature:this.originalFeature,oriJimuLayerInfo:this.originalJimuLayerInfo});this.showRelatedTables(e);this.popupUIController="esri.dijit.Popup"===this.popup.declaredClass?new N.PopupUIController(this):new N.PopupMobileUIController(this);this.popupUIController.addDomNode(this.domNode)},destroy:function(){this._clearPage();this.undoManager.destroy();this.popupUIController.destroy();this.inherited(arguments)},_getRelatedTableInfoArray:function(a){a=a.data.oriJimuLayerInfo;
var e=new r;a.getRelatedTableInfoArray().then(m.hitch(this,function(a){e.resolve(a)}));return e},_getOriRelationshipByDestLayer:function(a){var e=null;y.some(a.oriJimuLayerInfo.layerObject.relationships,function(g){if(g.relatedTableId===a.destJimuLayerInfo.layerObject.layerId)return e=g,!0},this);return e},_getRelatedRecordsByRelatedQuery:function(a){return a.oriJimuLayerInfo.getRelatedRecords(a.feature,a.destJimuLayerInfo)},_ignoreCaseToGetFieldObject:function(a,e){var g=null;e&&a&&a.fields&&y.some(a.fields,
function(a){if(a.name.toLowerCase()===e.toLowerCase())return g=a,!0});return g},getLocaleDateTime:function(a){return I.localizeDate(new Date(a),{fullYear:!0,formatLength:"medium"})},_getDisplayTitleOfRelatedRecord:function(a,e,g){var k=a.getInfoTemplate();return(a="popupTitle"===g&&k?"function"===typeof k.title?k.title(e):k.title:this._getDisplayTitleFromPopup(a,e,g))?a:""},_getDisplayTitleFromPopup:function(a,e,g){(a=this._getPopupTemplateWithOnlyDisplayField(a,g))?(e.setInfoTemplate(a),g=this.popupUIController.getDisplayTitle(e),
e.setInfoTemplate(null)):g=e.attributes[g];return g},_getPopupTemplateWithOnlyDisplayField:function(a,e){a=a._getCustomPopupInfo(a.layerObject,[e]);return new M(a)},_canShowRelatedData:function(a){var e=!0;(a=a.getPopupInfo())&&a.relatedRecordsInfo&&(e=!1!==a.relatedRecordsInfo.showRelatedRecords);return e},setPopupContent:function(a){this._clearPage();a.data.destJimuLayerInfo?a.data.relatedFeature||this.showRelatedRecords(a):this.showFeature(a);this.undoManager.peekUndo()?this.popupUIController.changeRefDomNode():
this.popupUIController.revertRefDomNode()},showFeature:function(a){var e=a.data,g=e.oriJimuLayerInfo.layerObject,k=m.getObject("_wabProperties.originalLayerName",!1,g)||e.oriJimuLayerInfo.title,g=m.getObject("_wabProperties.popupInfo.displayFieldOfRelatedRecordList",!1,g),n=this._getDisplayTitleOfRelatedRecord(e.oriJimuLayerInfo,e.feature,g);"popupTitle"!==g&&(n=k+": "+n);this._setOperationTitle(n);m.setObject("_wabProperties.popupInfo.operationDataForListRelatedRecords",null,e.oriJimuLayerInfo.layerObject);
e.oriJimuLayerInfo.loadInfoTemplate().then(m.hitch(this,function(g){e.oriJimuLayerInfo.layerObject.infoTemplate||a.data.feature.setInfoTemplate(g);this.popupUIController.setFeature(a.data.feature);e.oriJimuLayerInfo.layerObject.infoTemplate||a.data.feature.setInfoTemplate(null)}));this.showRelatedTables(a);this.popupManager.initPopupMenu([a.data.feature]);this.popupUIController.updateZoomToBtn([a.data.feature])},showRelatedRecords:function(a){var e=a.data,k=m.getObject("_wabProperties.originalLayerName",
!1,e.destJimuLayerInfo.layerObject)||e.destJimuLayerInfo.title;this._setOperationTitle(k);this._clearPage();m.setObject("_wabProperties.popupInfo.operationDataForListRelatedRecords",e,e.destJimuLayerInfo.layerObject);m.setObject("_wabProperties.popupInfo.originalFeature",this.originalFeature,e.destJimuLayerInfo.layerObject);m.setObject("_wabProperties.popupInfo.layerForActionWithEmptyFeatures",e.destJimuLayerInfo.layerObject,this.popup);this._getRelatedRecordsByRelatedQuery(e).then(m.hitch(this,function(k){0<
k.length?this._setTitle(window.jimuNls.popup.relatedRecords):this._setTitle(window.jimuNls.popup.noRelatedRecotds,"font-normal");var n=this._showFieldSelector(e.destJimuLayerInfo);y.forEach(k,function(k,p){k._layer=e.destJimuLayerInfo.layerObject;var r=this._getDisplayTitleOfRelatedRecord(e.destJimuLayerInfo,k,n);p=x.create("div",{"class":"item record-item "+(0===p%2?"oddLine":"evenLine"),innerHTML:r},this.contentBox);p.relatedRecord=k;p=g(p,"click",m.hitch(this,function(){this._addOperation(a);var g=
this._createOperation({feature:k,oriJimuLayerInfo:e.destJimuLayerInfo});this.setPopupContent(g)}));this._temporaryData.eventHandles.push(p)},this);this.popupManager.initPopupMenu(k);this.popupUIController.updateZoomToBtn(k)}));this.popupUIController.setContent(this.domNode)},showRelatedTables:function(a){this._canShowRelatedData(a.data.oriJimuLayerInfo)&&this._getRelatedTableInfoArray(a).then(m.hitch(this,function(e){0<e.length&&this._setTitle(window.jimuNls.popup.relatedTables);y.forEach(e,function(e,
k){k=x.create("div",{"class":"item table-item "+(0===k%2?"oddLine":"evenLine"),innerHTML:e.title},this.contentBox);k=g(k,"click",m.hitch(this,function(){e.getLayerObject().then(m.hitch(this,function(){this._addOperation(a);var g=this._createOperation({feature:a.data.feature,oriJimuLayerInfo:a.data.oriJimuLayerInfo,destJimuLayerInfo:e});this.setPopupContent(g)}))}));this._temporaryData.eventHandles.push(k)},this)}))},_createOperation:function(a){return new N.Operation({feature:a.feature||null,oriJimuLayerInfo:a.oriJimuLayerInfo||
null,destJimuLayerInfo:a.destJimuLayerInfo||null,relatedFeature:a.relatedFeature||null},this)},_addOperation:function(a){this.undoManager.add(a)},_onPreviouBtnClick:function(){this.undoManager.undo()},_clearPage:function(){x.empty(this.contentBox);y.forEach(this._temporaryData.eventHandles,function(a){a&&a.remove&&a.remove()},this);this._temporaryData.eventHandles=[];y.forEach(this._temporaryData.dijits,function(a){a&&a.destroy&&a.destroy()},this);this._temporaryData.dijits=[]},_setTitle:function(a,
e){a&&x.create("div",{"class":"title-box "+(e?e:""),innerHTML:a},this.contentBox)},_setOperationTitle:function(a){x.setAttr(this.operationTitle,"innerHTML",a);x.setAttr(this.operationTitle,"title",a)},_showFieldSelector:function(a){var e="objecid",k=t(".title-box",this.contentBox)[0],n=a.layerObject,p=[];if(!k||!a)return e;var r=a.getPopupInfo();r&&r.title&&p.push({label:window.jimuNls.popup.saveAsPopupTitle,value:"popupTitle"});var u=[];r&&r.fieldInfos?y.forEach(r.fieldInfos,function(a){var e={};
a.visible&&(e.name=a.fieldName,e.alias=a.label,u.push(e))}):u=n.fields;y.forEach(u,function(a){"globalid"!==a.name.toLowerCase()&&"shape"!==a.name.toLowerCase()&&p.push({label:a.alias||a.name,value:a.name})});k=(new P({items:p})).placeAt(k);k.domNode.title=window.jimuNls.popup.chooseFieldTip;var z=m.getObject("_wabProperties.popupInfo.displayFieldOfRelatedRecordList",!1,n),w=this._ignoreCaseToGetFieldObject(a.layerObject,a.layerObject.displayField||a.layerObject.objectIdField),x=L.getInstance().getAppConfig();
z?e=z:"2.3"===x.configWabVersion&&w&&w.name?e=w.name:r&&r.title?e="popupTitle":w&&w.name?e=w.name:0<p.length&&(e=p[0].value);e&&(k.setHighlightValue(e),m.setObject("_wabProperties.popupInfo.displayFieldOfRelatedRecordList",e,n));this._temporaryData.dijits.push(k);a=g(k,"click-item",m.hitch(this,function(a,e){t(".item.record-item",this.contentBox).forEach(m.hitch(this,function(g){m.setObject("_wabProperties.popupInfo.displayFieldOfRelatedRecordList",e,n);var f=this._getDisplayTitleOfRelatedRecord(a,
g.relatedRecord,e);g.innerHTML=f}))},a));this._temporaryData.eventHandles.push(a);return e}});N.Operation=B([k],{constructor:function(a,e){this.data=a;this.relatedRecordsPopupProjector=e},performUndo:function(){this.relatedRecordsPopupProjector.setPopupContent(this)}});N.PopupUIController=B([],{constructor:function(a){this.rrPopupProjector=a;this.popup=a.popup;this.initTempPopup();this._initTempPopupForDisplayTitle();this._initZoomToBtn();this._setScrollable()},initTempPopup:function(){this._tempPopup=
new p({},x.create("div"))},_initTempPopupForDisplayTitle:function(){this._tempPopupForDisplayTitle=new p({},x.create("div"));this._tempPopupForDisplayTitle.show()},destroy:function(){this._tempPopup.destroy();this._tempPopupForDisplayTitle.destroy();this._zoomToBtnClickHandle&&this._zoomToBtnClickHandle.remove&&this._zoomToBtnClickHandle.remove();this._zoomToBtnANode&&x.destroy(this._zoomToBtnANode);this.toucemoveScrollHandle&&this.toucemoveScrollHandle.remove&&this.toucemoveScrollHandle.remove()},
addDomNode:function(a){setTimeout(m.hitch(this,function(){x.place(a,this._getRefDomNode(),"after")}),1)},setFeature:function(a){this._tempPopup.setFeatures([a]);if(a=t(".esriViewPopup",this._tempPopup.domNode)[0])this.setContent(a),x.place(this.rrPopupProjector.domNode,a,"after"),this._unsetScrollable()},setContent:function(a){var e=t(".related-records-popup-projector").parent()[0];e&&e.removeChild(this.rrPopupProjector.domNode);this.popup.setContent(a);this._unsetScrollable()},_setScrollable:function(){var a=
t(".contentPane",this.popup.domNode)[0];w("esri-touch")&&a&&(this.toucemoveScrollHandle=g(a,"touchmove",m.hitch(this,function(e){e.preventDefault();t(".esriViewPopup",this.popup.domNode)[0]&&(e=a.firstChild,e instanceof Text&&(e=a.childNodes[1]),this.rrPopupProjector.domNode&&x.setStyle(this.rrPopupProjector.contentBox,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+e._currentX+"px, "+e._currentY+"px)"}))})))},_unsetScrollable:function(){x.setStyle(this.rrPopupProjector.contentBox,
{"-webkit-transition-property":"none","-webkit-transform":"none"});x.setStyle(this.rrPopupProjector.domNode,{"-webkit-transition-property":"none","-webkit-transform":"none"})},getDisplayTitle:function(a){this._tempPopupForDisplayTitle.setFeatures([a]);return(a=t("td.attrValue",this._tempPopupForDisplayTitle.domNode)[0])&&a.innerHTML},_getRefDomNode:function(){return this._getViewPopupDomNode()},_getViewPopupDomNode:function(){return t(".esriViewPopup",this.popup.domNode)[0]},_setPopupTitleInBody:function(){this.rrPopupProjector.undoManager.peekUndo()?
this._tempPopup.set("titleInBody",!1):this._tempPopup.set("titleInBody",!0)},_initZoomToBtn:function(){var a=t(".actionList",this.popup.domNode)[0];this._oldZoomToBtnANdoe=t(".action",a)[0];this._zoomToBtnANode=x.create("a",{"class":"action",style:"display: none",href:"javascript:void(0)"},a);this._zoomToBtn=x.create("span",{innerHTML:window.jimuNls.common.zoomTo},this._zoomToBtnANode);this._showOldZoomToBtn()},_hideZoomToBtn:function(){this._zoomToBtnANode&&x.setStyle(this._zoomToBtnANode,"display",
"none")},_showZoomToBtn:function(){this._zoomToBtnANode&&x.setStyle(this._zoomToBtnANode,"display","inline-block")},_hideOldZoomToBtn:function(){this._oldZoomToBtnANdoe&&x.setStyle(this._oldZoomToBtnANdoe,"display","none")},_showOldZoomToBtn:function(){this._oldZoomToBtnANdoe&&x.setStyle(this._oldZoomToBtnANdoe,"display","inline-block")},updateZoomToBtn:function(a){this._hideOldZoomToBtn();!a||1>a.length||!a[0].geometry?this._hideZoomToBtn():(this._showZoomToBtn(),this._zoomToBtnClickHandle&&this._zoomToBtnClickHandle.remove&&
this._zoomToBtnClickHandle.remove(),this._zoomToBtnClickHandle=g(this._zoomToBtn,"click",m.hitch(this,function(){var e=null;try{e=z.graphicsExtent(a)}catch(O){console.error(O)}e&&(this.rrPopupProjector.popupManager.mapManager.map.setExtent(e),this.popup.hide())})))},changeRefDomNode:function(){x.setStyle(this.rrPopupProjector.operationBox,"display","block");x.addClass(this.rrPopupProjector.domNode,"second-page-mode");var a=this._getViewPopupDomNode();a&&x.addClass(a,"second-page-mode")},revertRefDomNode:function(){x.setStyle(this.rrPopupProjector.operationBox,
"display","none");x.removeClass(this.rrPopupProjector.domNode,"second-page-mode");this._hideZoomToBtn();this._showOldZoomToBtn()}});N.PopupMobileUIController=B([N.PopupUIController],{initTempPopup:function(){this._tempPopup=new u({},x.create("div"))},setFeature:function(a){this._tempPopup.setFeatures([a]);a=t(".esriMobileInfoView.esriMobilePopupInfoView",this._tempPopup.domNode)[0];if(a=t(".esriViewPopup",a)[0])this.setContent(a),x.place(this.rrPopupProjector.domNode,a,"after")},updateZoomToBtn:function(){},
_initZoomToBtn:function(){},_getRefDomNode:function(){return t(".esriMobilePopupInfoView .esriMobileInfoViewItem")[1]},_getViewPopupDomNode:function(){var a=t(".esriMobileInfoView.esriMobilePopupInfoView")[0];return t(".esriViewPopup",a)[0]}});return N})},"esri/undoManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/when ./kernel ./Evented require".split(" "),function(B,m,y,x,g,w){B=B([w],{declaredClass:"esri.UndoManager",maxOperations:10,canUndo:!1,canRedo:!1,position:0,
length:0,onUndo:function(){},onRedo:function(){},onUndoComplete:function(){},onRedoComplete:function(){},onAdd:function(){},onChange:function(){},constructor:function(g){g=g||{};g.maxOperations&&(this.maxOperations=g.maxOperations);this._historyStack=[]},add:function(g){if(0<this.maxOperations)for(;this._historyStack.length>=this.maxOperations;)this._historyStack.shift();this._historyStack.splice(this.position,0,g);this.position++;this.clearRedo();this.onAdd();this._checkAvailability()},undo:function(){if(0===
this.position)return null;var g=this.peekUndo();(this.position--,g)?(g=g.performUndo(),this.onUndo(),this._checkAvailability(),x(g).then(m.hitch(this,this.onUndoComplete))):(this.onUndo(),this._checkAvailability())},redo:function(){if(this.position===this._historyStack.length)return null;var g=this.peekRedo();(this.position++,g)?(g=g.performRedo(),this.onRedo(),this._checkAvailability(),x(g).then(m.hitch(this,this.onRedoComplete))):(this.onRedo(),this._checkAvailability())},_checkAvailability:function(){this.length=
this._historyStack.length;0===this.length?(this.canRedo=!1,this.canUndo=!1):0===this.position?(this.canRedo=!0,this.canUndo=!1):this.position===this.length?(this.canUndo=!0,this.canRedo=!1):(this.canUndo=!0,this.canRedo=!0);this.onChange()},clearUndo:function(){this._historyStack.splice(0,this.position);this.position=0;this._checkAvailability()},clearRedo:function(){this._historyStack.splice(this.position,this._historyStack.length-this.position);this.position=this._historyStack.length;this._checkAvailability()},
peekUndo:function(){if(0<this._historyStack.length&&0<this.position)return this.get(this.position-1)},peekRedo:function(){if(0<this._historyStack.length&&this.position<this._historyStack.length)return this.get(this.position)},get:function(g){return this._historyStack[g]},remove:function(g){0<this._historyStack.length&&(this._historyStack.splice(g,1),0<this.position&&g<this.position&&this.position--,this._checkAvailability())},destroy:function(){this._historyStack=null}});return y("extend-esri")&&
(g.UndoManager=B),B})},"esri/OperationBase":function(){define(["dojo/_base/declare","dojo/has","./kernel"],function(B,m,y){B=B(null,{declaredClass:"esri.OperationBase",type:"not implemented",label:"not implemented",constructor:function(m){m=m||{};m.label&&(this.label=m.label)},performUndo:function(){console.log("performUndo has not been implemented")},performRedo:function(){console.log("performRedo has not been implemented")}});return m("extend-esri")&&(y.OperationBase=B),B})},"jimu/dijit/DropdownMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/query dojo/Evented".split(" "),
function(B,m,y,x,g,w,t,r,n){return B([m,y,n],{baseClass:"jimu-dijit-dropdownmenu",declaredClass:"jimu.dijit.DropdownMenu",templateString:"\x3cdiv\x3e\x3c/div\x3e",itemHeight:24,iconSize:16,offsetY:5,shelter:null,paddingOffsetY:8,dropdownMenuClass:"",dropdownMenuItemClass:"dropdown-menu-item",items:null,highlightValue:"",highlightSelectedItemAfterClick:!0,menuLeadingIcon:!0,maxDisplayItems:10,postCreate:function(){this.inherited(arguments);this.items||(this.items=[]);this.shelter=w.toDom('\x3cdiv class\x3d"jimu-dijit-dropdownmenu-shelter"\x3e\x3c/div\x3e');
this.itemsContainer=w.toDom('\x3cdiv class\x3d"jimu-dijit-dropdownmenu-items-container '+this.dropdownMenuClass+'"\x3e\x3c/div\x3e');0>=this.maxDisplayItems&&(this.maxDisplayItems=20);this.itemsContainer.style.maxHeight=this.itemHeight*this.maxDisplayItems+2*this.paddingOffsetY+"px";g.forEach(this.items,x.hitch(this,function(g){var a=w.toDom('\x3cdiv class\x3d"'+this.dropdownMenuItemClass+' jimu-ellipsis"\x3e'+g.label+"\x3c/div\x3e");a.itemInfo=g;a.title=g.label;w.place(a,this.itemsContainer)}));
this.own(t(this.domNode,"click",x.hitch(this,this._onIconClick)));this.own(t(this.shelter,"click",x.hitch(this,this._onShelterClick)));this.own(t(this.itemsContainer,"click",x.hitch(this,this._onItemsContainerClick)));this.highlightValue&&this.setHighlightValue(this.highlightValue)},_onIconClick:function(g,a){g.stopPropagation();this.isShowing()?this.hideMenu():(g=w.position(a||g.target||g.srcElement),this.showMenu(g))},_onShelterClick:function(){this.hideMenu()},_onItemsContainerClick:function(g){g.stopPropagation();
g=g.target||g.srcElement;w.hasClass(g,this.dropdownMenuItemClass)&&(g=g.itemInfo.value,this.highlightSelectedItemAfterClick&&this.setHighlightValue(g),this.emit("click-item",g));this.hideMenu()},clearHighlightValue:function(){r("."+this.dropdownMenuItemClass,this.itemsContainer).removeClass("selected")},setHighlightValue:function(g){this.clearHighlightValue();r("."+this.dropdownMenuItemClass,this.itemsContainer).some(x.hitch(this,function(a){return a.itemInfo.value===g?(w.addClass(a,"selected"),!0):
!1}))},getHighlightValue:function(){var g=r("."+this.dropdownMenuItemClass+".selected",this.itemsContainer)[0];return g?g.itemInfo.value:null},getHighlightLabel:function(){var n=this.getHighlightValue(),a="";g.some(this.items,function(g){return g.value===n?(a=g.label,!0):!1},this);return a},isShowing:function(){return w.hasClass(this.domNode,"showing")},showMenu:function(g){this.itemsContainer.style.top=g.y+this.iconSize+this.offsetY+"px";this.menuLeadingIcon===window.isRTL?(this.itemsContainer.style.left=
g.x+"px",this.itemsContainer.style.right="auto"):(this.itemsContainer.style.right=window.innerWidth-(g.x+this.iconSize)+"px",this.itemsContainer.style.left="auto");w.place(this.shelter,document.body);w.place(this.itemsContainer,document.body);w.addClass(this.domNode,"showing")},hideMenu:function(){this.itemsContainer.parentNode&&this.itemsContainer.parentNode.removeChild(this.itemsContainer);this.shelter.parentNode&&this.shelter.parentNode.removeChild(this.shelter);w.removeClass(this.domNode,"showing")},
destroy:function(){this.hideMenu();w.destroy(this.itemsContainer);w.destroy(this.shelter);this.inherited(arguments)}})})},"jimu/FilterManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","esri/lang","./LayerInfos/LayerInfos"],function(B,m,y,x,g){var w=null,t=B(null,{_filters:null,layerInfos:null,constructor:function(){this._filters={};window.isBuilder?(y.subscribe("app/mapLoaded",m.hitch(this,this._onMapLoaded)),y.subscribe("app/mapChanged",m.hitch(this,this._onMapChanged))):
(y.subscribe("mapLoaded",m.hitch(this,this._onMapLoaded)),y.subscribe("mapChanged",m.hitch(this,this._onMapChanged)));y.subscribe("widgetDestroyed",m.hitch(this,this._onWidgetDestroyed))},getWidgetFilter:function(g,n){return m.getObject(g+".filterExprs."+n,!1,this._filters)},applyWidgetFilter:function(g,n,m,a,k,e){var p="object"===typeof g?g:null;p&&(g=p.layerId,n=p.widgetId,m=p.expression,a=p.enableMapFilter,k=p.useAND,e=p.zoomAfterFilter);this._setFilterExp(g,n,m,a,k);n=this.layerInfos.getLayerInfoById(g)||
this.layerInfos.getTableInfoById(g);g=this._getFilterExp(g);null!==g&&n&&n.setFilter(g,{zoomAfterFilter:e})},_onMapLoaded:function(){this.layerInfos=g.getInstanceSync();this._traversalFilter()},_onMapChanged:function(){this.layerInfos=g.getInstanceSync();this._traversalFilter()},_onWidgetDestroyed:function(g){for(var n in this._filters)if(this._filters[n]){var m=this._filters[n];if(m){var a=m.filterExprs,m=m.mapFilterControls;a&&delete a[g];m&&delete m[g]}}},_traversalFilter:function(){this.layerInfos.traversalAll(m.hitch(this,
function(g){this._filters[g.id]||(this._filters[g.id]={definitionExpression:g.getFilter(),filterExprs:{},mapFilterControls:{}})}))},_getPriorityOfMapFilter:function(g){g=m.getObject(g+".mapFilterControls",!1,this._filters);var n=0,r;for(r in g){var a=g[r];a.priority>n&&(n=a.priority)}return n},_getMapFilterControl:function(g){g=m.getObject(g+".mapFilterControls",!1,this._filters);var n=0,r=null,a;for(a in g){var k=g[a];k.priority>n&&(n=k.priority,r=k)}return r},_setFilterExp:function(g,n,t,a,k){var e=
g+".filterExprs."+n,p=g+".mapFilterControls."+n;t?(m.setObject(e,t,this._filters),x.isDefined(a)&&(g=this._getPriorityOfMapFilter(g),m.setObject(p,{enable:a,useAND:k,priority:g+1},this._filters))):(m.getObject(e,!1,this._filters)&&delete this._filters[g].filterExprs[n],m.getObject(p,!1,this._filters)&&delete this._filters[g].mapFilterControls[n])},_getFilterExp:function(g){if(!this._filters[g])return null;var n=[],m=this._filters[g].definitionExpression,a=this._filters[g].filterExprs;g=this._getMapFilterControl(g);
for(var k in a){var e=a[k];e&&n.push("("+e+")")}n=n.join(" AND ");return m&&g&&g.enable||m&&null===g?n?g&&!1===g.useAND?"("+m+") OR "+n:"("+m+") AND "+n:m:n}});t.getInstance=function(){if(null===w)w=new t,window._filterManager=w;else return w};return t})},"jimu/DataManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic"],function(B,m,y){var x=null,g;g=B(null,{constructor:function(g){y.subscribe("publishData",m.hitch(this,this.onDataPublished));y.subscribe("fetchData",m.hitch(this,
this.onFetchData));y.subscribe("clearAllData",m.hitch(this,this.onClearAllData));y.subscribe("removeData",m.hitch(this,this.onRemoveData));y.subscribe("clearDataHistory",m.hitch(this,this.onClearDataHistory));this.widgetManager=g},_dataStore:{},onDataPublished:function(g,m,r,n){"undefined"===typeof n&&(n=!1);this._dataStore[m]?(this._dataStore[m].current=r,n&&(this._dataStore[m].history?this._dataStore[m].history.push(r):this._dataStore[m].history=[r])):(this._dataStore[m]={current:r},n&&(this._dataStore[m].history=
[r]))},onFetchData:function(g){var m;if(g)"framework"===g?this._dataStore[g]?y.publish("dataFetched","framework","framework",this._dataStore[g].current,this._dataStore[g].history):y.publish("noData","framework","framework"):(m=this.widgetManager.getWidgetById(g))?this._dataStore[g]?y.publish("dataFetched",m.name,g,this._dataStore[g].current,this._dataStore[g].history):y.publish("noData",m.name,g):y.publish("noData",void 0,g);else{for(var r in this._dataStore)(m=this.widgetManager.getWidgetById(r))&&
y.publish("dataFetched",m.name,r,this._dataStore[r].current,this._dataStore[r].history);m||y.publish("noData",void 0,void 0)}},onClearAllData:function(){this._dataStore={};y.publish("allDataCleared")},onRemoveData:function(g){delete this._dataStore[g];y.publish("dataRemoved",g)},onClearDataHistory:function(g){this._dataStore[g]&&(this._dataStore[g].history=[]);y.publish("dataHistoryCleared",g)}});g.getInstance=function(m){null===x&&(x=new g(m));return x};return g})},"jimu/SelectionManager":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/topic esri/layers/FeatureLayer esri/layers/GraphicsLayer esri/geometry/geometryEngine esri/graphic esri/Color esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e){var p=null,u=B(null,{constructor:function(){window.isBuilder?(g.subscribe("app/mapLoaded",y.hitch(this,this._onMapLoaded)),g.subscribe("app/mapChanged",y.hitch(this,this._onMapChanged))):(g.subscribe("mapLoaded",y.hitch(this,this._onMapLoaded)),g.subscribe("mapChanged",y.hitch(this,this._onMapChanged)))},_displayLayers:{},setSelectionSymbol:function(g){var n=g.geometryType,m=new a(a.STYLE_CIRCLE,16,null,A.fromArray([0,255,255])),p=new k(k.STYLE_SOLID,A.fromArray([0,
255,255]),2),r=new e(e.STYLE_SOLID,p,A.fromArray([0,255,255,.3]));"esriGeometryPoint"===n?g.setSelectionSymbol(m):"esriGeometryPolyline"===n?g.setSelectionSymbol(p):"esriGeometryPolygon"===n&&g.setSelectionSymbol(r)},updateSelectionByFeatures:function(a,e,g){0<e.length&&(e=x.map(e,y.hitch(this,function(e){var g=null,g=0<=a.graphics.indexOf(e)?new n(e.toJson()):e;g.wabIsTemp=!0;return g})));a.getSelectionSymbol()||this.setSelectionSymbol(a);var k=new m;a._selectHandler({features:e},g,null,null,k);
this._isLayerNeedDisplayLayer(a)&&(this._displayLayers[a.id]||(this._displayLayers[a.id]=this._createDisplayLayer(a)),this._updateDisplayLayer(a));return k},getDisplayLayer:function(a){return this._displayLayers[a]},setSelection:function(a,e){return this.updateSelectionByFeatures(a,e,w.SELECTION_NEW)},addFeaturesToSelection:function(a,e){return this.updateSelectionByFeatures(a,e,w.SELECTION_ADD)},removeFeaturesFromSelection:function(a,e){return this.updateSelectionByFeatures(a,e,w.SELECTION_SUBTRACT)},
clearSelection:function(a){var e=new m;this.clearDisplayLayer(a);a.clearSelection();e.resolve();return e},clearDisplayLayer:function(a){(a=this._displayLayers[a.id])&&a.clear()},getClientFeaturesByGeometry:function(a,e,g){return x.filter(a.graphics,y.hitch(this,function(a){return g?r.contains(e,a.geometry):r.intersects(e,a.geometry)}))},getUnionGeometryBySelectedFeatures:function(a){var e=null;a=a.getSelectedFeatures();0<a.length&&(e=x.map(a,y.hitch(this,function(a){return a.geometry})),e=r.union(e));
return e},_createDisplayLayer:function(a){var e=new t;e.id="displayLayer_of_"+a.id;this.map.addLayer(e);return e},_updateDisplayLayer:function(a){var e=a.getSelectedFeatures(),g=this._displayLayers[a.id];this.clearDisplayLayer(a);var k=a.getSelectionSymbol();x.forEach(e,y.hitch(this,function(a){a.setSymbol(null);a=new n(a.toJson());a.setSymbol(k);g.add(a)}))},_isLayerNeedDisplayLayer:function(a){return!a.getMap()},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=a}});u.getInstance=
function(){p||(p=new u,window._selectionManager=p);return p};return u})},"jimu/BaseWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin jimu/utils ./PanelManager".split(" "),function(B,m,y,x,g,w,t,r,n){return B([w,t],{type:"widget",id:void 0,label:void 0,icon:void 0,uri:void 0,position:{},config:void 0,openAtStart:!1,map:null,appConfig:null,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",
baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",moveTopOnActive:!0,constructor:function(){this.listenWidgetNames=[];this.listenWidgetIds=[];this.own(g.subscribe("publishData",m.hitch(this,this._onReceiveData)));this.own(g.subscribe("dataFetched",m.hitch(this,this._onReceiveData)));this.own(g.subscribe("noData",m.hitch(this,this._onNoData)));this.own(g.subscribe("dataSourceDataUpdated",m.hitch(this,this.onDataSourceDataUpdate)))},startup:function(){this.inherited(arguments);this.started=!0},
onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onActive:function(){},onDeActive:function(){},onSignIn:function(g){},onSignOut:function(){},onPositionChange:function(g){this.setPosition(g)},setPosition:function(g,a){this.position=g;var k=r.getPositionStyle(this.position);k.position="absolute";a||(a="map"===g.relativeTo?this.map.id:window.jimuConfig.layoutId);x.place(this.domNode,a);x.setStyle(this.domNode,k);this.started&&this.resize()},
getPosition:function(){return this.position},getMarginBox:function(){return x.getMarginBox(this.domNode)},setMap:function(g){this.map=g},setState:function(g){this.state=g},setWindowState:function(g){this.windowState=g},resize:function(){},onConfigChanged:function(g){},onAppConfigChanged:function(g,a,k){},onAction:function(g,a){},getPanel:function(){if(!1===this.inPanel)return null;if("widgetOnScreen"===this.gid||"widgetPool"===this.gid)return n.getInstance().getPanelById(this.id+"_panel");var g=n.getInstance().getPanelById(this.gid+
"_panel");return g?g:n.getInstance().getPanelById(this.id+"_panel")},publishData:function(n,a){"undefined"===typeof a&&(a=!1);g.publish("publishData",this.name,this.id,n,a)},fetchData:function(n){n?g.publish("fetchData",n):0!==this.listenWidgetIds.length?y.forEach(this.listenWidgetIds,function(a){g.publish("fetchData",a)},this):g.publish("fetchData")},fetchDataByName:function(g){g=this.widgetManager.getWidgetsByName(g);y.forEach(g,function(a){this.fetchData(a.id)},this)},openWidgetById:function(g){return this.widgetManager.triggerWidgetOpen(g)},
_onReceiveData:function(g,a,k,e){if(a!==this.id&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(a)))this.onReceiveData(g,a,k,e)},onReceiveData:function(g,a,k,e){},updateDataSourceData:function(n,a){g.publish("updateDataSourceData","widget~"+this.id+"~"+n,a)},onDataSourceDataUpdate:function(g,a){},_onNoData:function(g,a){if(!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(a)))this.onNoData(g,a)},onNoData:function(g,a){}})})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/promise/all dojo/on dojo/topic dojo/when require ./utils ./WidgetManager".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e){var p,u=null;p=B(null,{constructor:function(){this.panels=[];this.widgetManager=e.getInstance();r(window,"resize",m.hitch(this,this.onWindowResize));this.activePanel=null;n.subscribe("/dnd/move/start",m.hitch(this,this._onMoveStart));n.subscribe("widgetActived",m.hitch(this,this._onWidgetActived))},showPanel:function(a){var e=new w,g=this.getPanelById(a.id+"_panel");g?("closed"===g.state&&this.openPanel(g),e.resolve(g)):t({Panel:this._loadPanelClass(a.panel.uri),
nls:this._loadThemeI18N(a.panel.uri)}).then(m.hitch(this,function(g){var n=a.id+"_panel",p=this.getPanelById(n),r={label:a.label,config:a,uri:a.panel.uri,position:a.panel.position,map:this.map,widgetManager:this.widgetManager,panelManager:this,id:n,gid:a.gid,nls:g.nls};m.mixin(r,a.panel.options);try{p=new g.Panel(r),console.log("panel ["+n+"] created.")}catch(C){console.log("create panel error: "+C+", panelId: "+n);e.reject(C);return}p.setPosition(a.panel.position);k.setVerticalCenter(p.domNode);
this.openPanel(p);p.domNode.addEventListener("click",m.hitch(this,this._onPanelClick,p),{capture:!0});e.resolve(p)}));return e},setMap:function(a){this.map=a;r(this.map,"resize",m.hitch(this,this.onMapResize))},closeOtherPanelsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;for(var e=0;e<this.panels.length;e++)this.panels[e].gid===a.gid&&this.panels[e].id!==a.id&&this.closePanel(this.panels[e])},closeAllPanelsInGroup:function(a){for(var e=0;e<this.panels.length;e++)this.panels[e].gid===
a&&this.closePanel(this.panels[e])},openPanel:function(a){var e=new w;if("string"===typeof a){if(a=this.getPanelById(a),!a)return e.reject(),e}else this.panels.some(function(e){return e.id===a.id})||this.panels.push(a);if(!a.started)try{a.started=!0,a.startup()}catch(I){console.error("fail to startup panel "+a.id+". "+I.stack)}if("opened"===a.state)return this._activePanel(a),e.resolve(a),e;a.setState("opened");return this.playOpenPanelAnimation(a).then(m.hitch(this,function(){x.setStyle(a.domNode,
"display","");a.onOpen();this._activePanel(a);return a}))},closePanel:function(a){var e=new w;return"string"===typeof a&&(a=this.getPanelById(a),!a)||"closed"===a.state?(e.resolve(),e):this.playClosePanelAnimation(a).then(m.hitch(this,function(){this.activePanel&&this.activePanel.id===a.id&&(this.activePanel.onDeActive(),this.activePanel=null);a.setState("closed");a.onClose();a.domNode&&x.setStyle(a.domNode,"display","none")}))},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),
!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(M){console.log(console.error("fail to minimize panel "+a.id+". "+M.stack))}},maximizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(M){console.log(console.error("fail to maximize panel "+a.id+". "+M.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),
!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(M){console.log(console.error("fail to noralize panel "+a.id+". "+M.stack))}},changeWindowStateTo:function(a,e){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"normal"===e?this.normalizePanel(a):"minimized"===e?this.minimizePanel(a):"maximized"===e?this.maximizePanel(a):console.log("error state: "+e)},getPanelById:function(a){for(var e=0;e<this.panels.length;e++)if(this.panels[e].id===
a)return this.panels[e]},onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"!==this.panels[a].position.relativeTo&&this.panels[a].resize()},onMapResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"===this.panels[a].position.relativeTo&&this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a);this._removePanel(a);
try{a.destroy()}catch(M){console.log(console.error("fail to destroy panel "+a.id+". "+M.stack))}}},destroyAllPanels:function(){var a=y.map(this.panels,function(a){return a.id});y.forEach(a,function(a){this.destroyPanel(a)},this);this.panels=[]},playOpenPanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a)||!a.openAnimation||0===a.animationDuration)return A();var e=new w;"string"===typeof a.openAnimation?"fadeIn"===a.openAnimation?(x.setStyle(a.domNode,{opacity:0,display:""}),
g.fadeIn({node:a.domNode,duration:a.animationDuration,onEnd:function(){e.resolve()}}).play()):e.resolve():e.resolve();return e},playClosePanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a)||!a.closeAnimation||0===a.animationDuration)return A();var e=new w;"string"===typeof a.closeAnimation&&("fadeOut"===a.closeAnimation?g.fadeOut({node:a.domNode,duration:a.animationDuration,onEnd:function(){e.resolve()}}).play():e.resolve());return e},getPositionOnMobile:function(a){if("string"===
typeof a&&(a=this.getPanelById(a),!a))return{};var e=x.getMarginBox(window.jimuConfig.layoutId),g=e.h/2;a.titleHeight||(a.titleHeight=35);return"maximized"===a.windowState?{left:0,right:0,top:0,bottom:0,width:"auto",height:"auto",contentHeight:e.h-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomLeftRadius:0,borderBottomRightRadius:0}}:"minimized"===a.windowState?(g=0,this.panels.filter(function(e){return"minimized"===e.windowState&&"closed"!==e.state&&e.id!==
a.id}).some(function(a){return 0===a._mobileBottom})&&(g=a.titleHeight),a._mobileBottom=g,e.h>e.w?{left:0,right:0,top:"auto",bottom:g,width:"auto",height:a.titleHeight,contentHeight:0,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:{left:e.w-e.w/2,right:0,top:"auto",bottom:g,width:e.w/2,height:a.titleHeight,contentHeight:e.h,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,
borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}):e.h>e.w?{left:0,right:0,top:g,bottom:0,width:"auto",height:"auto",contentHeight:e.h-g-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:{left:e.w-e.w/2,right:0,top:0,bottom:0,width:e.w/2,height:"auto",contentHeight:e.h-g-a.titleHeight,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,
borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}},_onPanelClick:function(a){this._activePanel(a)},activatePanel:function(a){"opened"===a.state&&this._activePanel(a)},_activePanel:function(a){if(this.activePanel){if(this.activePanel.id===a.id){this.activePanel.moveTopOnActive&&x.setStyle(this.activePanel.domNode,"zIndex",101);return}"active"===this.activePanel.state&&
(this.activePanel.setState("opened"),x.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive())}var e=this.widgetManager.activeWidget;e&&"active"===e.state&&e.getPanel()!==a&&(e.setState("opened"),!1===e.inPanel&&x.setStyle(e.domNode,"zIndex","undefined"!==typeof e.position.zIndex?e.position.zIndex:"auto"),e.onDeActive(),this.widgetManager.activeWidget=null);this.activePanel=a;"active"!==
this.activePanel.state&&(this.activePanel.setState("active"),this.activePanel.moveTopOnActive&&x.setStyle(this.activePanel.domNode,"zIndex",101),this.activePanel.onActive())},_removePanel:function(a){var e=this.panels.indexOf(a);-1<e&&this.panels.splice(e,1);this.activePanel&&this.activePanel.id===a.id&&(this.activePanel=null)},_onMoveStart:function(a){y.forEach(this.panels,function(e){e.domNode===a.node&&this._activePanel(e)},this)},_onWidgetActived:function(a){this.activePanel&&"active"===this.activePanel.state&&
a.getPanel()!==this.activePanel&&(this.activePanel.setState("opened"),x.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive(),this.activePanel=null)},_loadPanelClass:function(e){var g=new w;a([e],function(a){g.resolve(a)});return g},_loadThemeI18N:function(e){var g=new w;e.startWith("themes")?(e=e.split("/"),a(["dojo/i18n!"+(e[0]+"/"+e[1]+"/nls/strings")],function(a){g.resolve(a)})):g.resolve({});
return g}});p.getInstance=function(){null===u&&(u=new p,window._panelManager=u);return u};return p})},"jimu/BaseWidgetFrame":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dijit/_WidgetBase"],function(B,m,y,x){return B([x],{widget:null,baseClass:"jimu-widget-frame jimu-container",postCreate:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.widget&&this.setWidget(this.widget)},startup:function(){this.inherited(arguments);this.widget&&
this.widget.startup()},resize:function(){this.widget&&"closed"!==this.widget.state&&m.isFunction(this.widget.resize)&&this.widget.resize()},setLoading:function(g){this.loading=g;this.loading.placeAt(this.containerNode)},getWidget:function(){return this.widget},setWidget:function(g){this.widget=g;this.loading&&this.loading.destroy();y.place(g.domNode,this.containerNode);this.resize()},destroy:function(){if(this.widget&&this.widget.domNode)try{this.widget.destroy()}catch(g){console.error("destroy widget error. widget: ["+
this.widget.uri+"], "+g.stack)}this.loading&&this.loading.domNode&&this.loading.destroy()}})})},"jimu/BaseWidgetPanel":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_Container ./dijit/LoadingIndicator ./BaseWidgetFrame ./utils".split(" "),function(B,m,y,x,g,w,t,r,n){return B([g,w],{baseClass:"jimu-panel jimu-container",started:!1,state:"closed",windowState:"normal",moveTopOnActive:!0,openAnimation:null,closeAnimation:null,animationDuration:0,
startup:function(){this.inherited(arguments);this.loadAllWidgetsInOrder();this.started=!0},loadAllWidgetsInOrder:function(){var g=this.getAllWidgetConfigs(),g=Array.isArray(this.config.widgets)?this.config.widgets:[this.config];y.forEach(g,function(a){var g,e;!1!==a.visible&&(e=new t,g=this.createFrame(a),this.addChild(g),g.setLoading(e),this.widgetManager.loadWidget(a).then(m.hitch(this,function(a){g.setWidget(a);a.startup()})))},this)},getAllWidgetConfigs:function(){var g=[];return g=Array.isArray(this.config.widgets)?
this.config.widgets:[this.config]},getWidgetById:function(g){for(var a=this.getChildren(),k=0;k<a.length;k++)if(a[k].getWidget()&&a[k].getWidget().id===g)return a[k].getWidget()},getWidgets:function(){return this.getChildren().map(function(g){return g.getWidget()})},createFrame:function(g){return new r},setPosition:function(g,a){this.position=g;var k=n.getPositionStyle(this.position);k.position="absolute";a||(a="map"===g.relativeTo?this.map.id:window.jimuConfig.layoutId);this.started?this.resize():
this.openAnimation&&(k.display="none");x.place(this.domNode,a);x.setStyle(this.domNode,k)},getPosition:function(){return this.position},setState:function(g){this.state=g},setWindowState:function(g){this.windowState=g},resize:function(){this.getChildren().forEach(function(g){g.resize()})},onPositionChange:function(g){this.setPosition(g)},onOpen:function(){y.forEach(this.getChildren(),function(g){g.getWidget()&&this.widgetManager.openWidget(g.getWidget())},this)},onClose:function(){y.forEach(this.getChildren(),
function(g){g.getWidget()&&this.widgetManager.closeWidget(g.getWidget())},this)},onMaximize:function(){y.forEach(this.getChildren(),function(g){g.getWidget()&&this.widgetManager.maximizeWidget(g.getWidget())},this)},onMinimize:function(){y.forEach(this.getChildren(),function(g){g.getWidget()&&this.widgetManager.minimizeWidget(g.getWidget())},this)},onNormalize:function(){y.forEach(this.getChildren(),function(g){g.getWidget()&&this.widgetManager.normalizeWidget(g.getWidget())},this)},onActive:function(){},
onDeActive:function(){},updateConfig:function(g){this._updateConfig(g)},reloadWidget:function(g){this.isWidgetInPanel(g)&&(this._updateConfig(g),this.getChildren().forEach(function(a){a.getWidget()&&a.getWidget().id===g.id&&(a.getWidget().destroy(),a.setLoading(new t),this.widgetManager.loadWidget(g).then(m.hitch(this,function(g){a.setWidget(g);g.startup();"closed"===this.state&&this.widgetManager.closeWidget(g)})))},this))},isWidgetInPanel:function(g){return y.some(this.getAllWidgetConfigs(),function(a){if(g.id===
a.id)return!0})?!0:!1},_updateConfig:function(g){if(Array.isArray(this.config.widgets)){for(var a=-1,k=0;k<this.config.widgets.length;k++)this.config.widgets[k].id===g.id&&(a=k);0<a&&(this.config.widgets[a]=g)}else this.config=g},destroy:function(){this.getChildren().forEach(function(g){try{g.domNode&&g.destroy()}catch(a){console.error("destroy widget frame error."+a.stack)}});this.inherited(arguments)}})})},"jimu/WidgetPlaceholder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html",
"dijit/_WidgetBase","./utils"],function(B,m,y,x,g){return B(x,{"class":"jimu-widget-placeholder",postCreate:function(){this.inherited(arguments);this.indexNode=y.create("div",{"class":"inner",innerHTML:this.index},this.domNode);y.setAttr(this.domNode,"title",window.jimuNls.widgetPlaceholderTooltip)},moveTo:function(w){var t={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},t=m.mixin(t,g.getPositionStyle(w));delete t.width;delete t.height;y.setStyle(this.domNode,t)},setIndex:function(g){this.index=
g;this.indexNode.innerHTML=g}})})},"jimu/OnScreenWidgetIcon":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dijit/Tooltip dijit/_WidgetBase ./utils".split(" "),function(B,m,y,x,g,w,t,r,n){return B(r,{"class":"jimu-widget-onscreen-icon",postCreate:function(){this.inherited(arguments);this.iconNode=x.create("img",{src:this.widgetConfig.icon,alt:this.widgetConfig.label},this.domNode);window.isRTL&&this.widgetConfig.mirrorIconForRTL&&x.addClass(this.iconNode,
"jimu-flipx");x.setAttr(this.domNode,"title",this.widgetConfig.label);x.setAttr(this.domNode,"data-widget-name",this.widgetConfig.name);x.setAttr(this.domNode,"tabindex",this.widgetConfig.tabIndex?this.widgetConfig.tabIndex:this.widgetConfig.tabIndexJimu);x.setAttr(this.domNode,"role","application");this.own(g(this.domNode,"click",m.hitch(this,function(){this.onClick()})));this.own(g(this.domNode,"keydown",m.hitch(this,function(g){if(g.keyCode===w.ENTER)this.onClick();else g.keyCode===w.ESCAPE&&n.trapToNextFocusContainer(this.map.container)})));
n.addTooltipByDomNode(t,this.domNode,this.widgetConfig.label);this.position=m.clone(this.widgetConfig.position);"map"===this.widgetConfig.position.relativeTo&&this.own(g(this.map,"resize",m.hitch(this,function(){var g=m.clone(this.position);delete g.width;delete g.height;this.panel&&this.panel.setPosition(g)})));this.state="closed"},startup:function(){this.inherited(arguments)},onClick:function(){"closed"===this.state?this.switchToOpen():this.switchToClose()},moveTo:function(g){var a={left:"auto",
right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},a=m.mixin(a,n.getPositionStyle(g));delete a.width;delete a.height;x.setStyle(this.domNode,a);this.position=m.clone(g);this.widgetConfig&&this.widgetConfig.panel&&(this.widgetConfig.panel.position=m.clone(g),this.widgetConfig.position=m.clone(g));this.panel&&this.panel.setPosition(m.clone(g));this.widget&&this.widget.setPosition(this.getOffPanelWidgetPosition(this.widget))},destroy:function(){this.panel?this.panelManager.destroyPanel(this.panel):
this.widget&&this.widgetManager.destroyWidget(this.widget);this.inherited(arguments)},switchToOpen:function(){this.state="opened";this.panelManager.closeAllPanelsInGroup(this.widgetConfig.gid);y.forEach(this.widgetManager.getOnScreenOffPanelWidgets(),function(g){g.closeable&&this.widgetManager.closeWidget(g)},this);x.addClass(this.domNode,"jimu-state-selected");this._showLoading();!1===this.widgetConfig.inPanel?this.widgetManager.loadWidget(this.widgetConfig).then(m.hitch(this,function(n){this.widget=
n;n.setPosition(this.getOffPanelWidgetPosition(n));this.widgetManager.openWidget(n);this.own(g(n,"close",m.hitch(this,function(){this.switchToClose();this.iconNode.parentNode.focus()})));this._hideLoading()})):this.panelManager.showPanel(m.clone(this.widgetConfig)).then(m.hitch(this,function(n){this.panel=n;this.own(g(n,"close",m.hitch(this,function(){this.switchToClose();this.iconNode.parentNode.focus()})));this.own(g(n.closeNode,"keydown",m.hitch(this,function(a){a.keyCode===w.ESCAPE&&(a.stopPropagation(),
this.iconNode.parentNode.focus())})));this._hideLoading()}))},switchToClose:function(){this.state="closed";x.removeClass(this.domNode,"jimu-state-selected");!1===this.widgetConfig.inPanel?this.widgetManager.closeWidget(this.widget):this.panelManager.closePanel(this.panel)},getOffPanelWidgetPosition:function(g){var a={relativeTo:g.position.relativeTo},k=x.getMarginBox(this.domNode);g=this.widgetManager.getWidgetMarginBox(g);var e=x.getMarginBox("map"===a.relativeTo?this.map.id:jimuConfig.layoutId),
n=k.t+k.h+1;n+g.h>e.h?a.bottom=e.h-k.t+1:a.top=n;window.isRTL?a.right=0>k.l+k.w-g.w?0:k.l+k.w-g.w:k.l+g.w>e.w?a.right=0:a.left=k.l;return a},_showLoading:function(){x.setAttr(this.iconNode,"src",require.toUrl("jimu")+"/images/loading_circle.gif")},_hideLoading:function(){x.setAttr(this.iconNode,"src",this.widgetConfig.icon)}})})},"jimu/OnScreenWidgetPanel":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/dnd/move dijit/_TemplatedMixin jimu/BaseWidgetPanel jimu/utils dojox/layout/ResizeHandle dojo/touch".split(" "),
function(B,m,y,x,g,w,t,r,n,A){return B([r,t],{baseClass:"jimu-panel jimu-on-screen-widget-panel jimu-main-background",_positionInfoBox:null,_originalBox:null,widgetIcon:null,_resizeOnOpen:!0,templateString:'\x3cdiv data-dojo-attach-point\x3d"boxNode"\x3e\x3cdiv class\x3d"jimu-panel-title jimu-main-background" data-dojo-attach-point\x3d"titleNode"\x3e\x3cdiv class\x3d"title-label jimu-vcenter-text jimu-float-leading jimu-leading-padding1"data-dojo-attach-point\x3d"titleLabelNode"\x3e${label}\x3c/div\x3e\x3cdiv class\x3d"btns-container"\x3e\x3cdiv tabindex\x3d"0" class\x3d"foldable-btn jimu-vcenter" data-dojo-attach-point\x3d"foldableNode"data-dojo-attach-event\x3d"onclick:_onFoldableBtnClicked,onkeydown:_onFoldableBtnKeyDown"\x3e\x3c/div\x3e\x3cdiv tabindex\x3d"0" class\x3d"max-btn jimu-vcenter" data-dojo-attach-point\x3d"maxNode"data-dojo-attach-event\x3d"onclick:_onMaxBtnClicked,onkeydown:_onMaxBtnKeyDown"\x3e\x3c/div\x3e\x3cdiv tabindex\x3d"0" class\x3d"close-btn jimu-vcenter" data-dojo-attach-point\x3d"closeNode"data-dojo-attach-event\x3d"onclick:_onCloseBtnClicked,press:_onCloseBtnClicked,onkeydown:_onCloseBtnKey"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-panel-content" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e',
postCreate:function(){this._originalBox={w:400,h:410}},startup:function(){this.inherited(arguments);y.setAttr(this.domNode,"role","application");this._normalizePositionObj(this.position);this._makeOriginalBox();this.makePositionInfoBox();this.makeMoveable(this._positionInfoBox.w,.25*this._positionInfoBox.w);this.own(x(this.domNode,"keydown",m.hitch(this,function(a){y.hasClass(a.target,"close-btn")||a.keyCode!==g.ESCAPE||(a.stopPropagation(),this.closeNode.focus())})))},_onMaxBtnClicked:function(a){a.stopPropagation();
this._getPositionInfo().isRunInMobile&&("maximized"===this.windowState?this.panelManager.normalizePanel(this):this.panelManager.maximizePanel(this),this._setMobilePosition())},_onMaxBtnKeyDown:function(a){a.keyCode===g.ENTER&&this._onMaxBtnClicked(a)},_onFoldableBtnClicked:function(a){a&&a.stopPropagation();this._getPositionInfo().isRunInMobile&&("minimized"===this.windowState?(y.removeClass(this.foldableNode,"fold-up"),y.addClass(this.foldableNode,"fold-down"),this.panelManager.normalizePanel(this)):
(y.removeClass(this.foldableNode,"fold-down"),y.addClass(this.foldableNode,"fold-up"),this.panelManager.minimizePanel(this)),this._setMobilePosition())},_onFoldableBtnKeyDown:function(a){a.keyCode===g.ENTER?this._onFoldableBtnClicked(a):a.keyCode===g.TAB&&a.shiftKey&&a.preventDefault()},_onCloseBtnClicked:function(a){this.panelManager.closePanel(this);a.stopPropagation();"touchstart"===a.type&&a.preventDefault()},_onCloseBtnKey:function(a){a.keyCode===g.ENTER?this.panelManager.closePanel(this):a.keyCode===
g.TAB&&a.shiftKey&&(window.appInfo.isRunInMobile||a.preventDefault())},_normalizePositionObj:function(a){var g=this._getLayoutBox();a.left=isFinite(a.left)?a.left:g.w-a.right;a.top=isFinite(a.top)?a.top:g.h-a.bottom;delete a.right;delete a.bottom;this.position=m.mixin(m.clone(this.position),a)},makePositionInfoBox:function(){this._positionInfoBox={w:this.position.width||400,h:this.position.height||410,l:this.position.left||0,t:this.position.top||0}},_makeOriginalBox:function(){this._originalBox={w:this.position.width||
400,h:this.position.height||410,l:this.position.left||0,t:this.position.top||0}},makeResizable:function(){this.disableResizable();this.resizeHandle=(new A({targetId:this,minWidth:this._originalBox.w,minHeight:this._originalBox.h,activeResize:!1})).placeAt(this.domNode);this.resizeHandle.startup()},disableResizable:function(){this.resizeHandle&&(this.resizeHandle.destroy(),this.resizeHandle=null)},makeMoveable:function(a,g){this.disableMoveable();var e=y.getMarginBox(jimuConfig.layoutId);e.l=e.l-a+
g;e.w+=2*(a-g);this.moveable=new w.boxConstrainedMoveable(this.domNode,{box:e,handle:this.titleNode,within:!0});this.own(x(this.moveable,"Moving",m.hitch(this,this.onMoving)));this.own(x(this.moveable,"MoveStop",m.hitch(this,this.onMoveStop)))},disableMoveable:function(){this.moveable&&(this.moveable.destroy(),this.moveable=null)},createHandleNode:function(){return this.titleNode},onOpen:function(){this._resizeOnOpen&&(this.resize(),this._resizeOnOpen=!1);window.appInfo.isRunInMobile&&(this._setMobilePosition(),
n.isInNavMode()&&"minimized"===this.windowState&&this._onFoldableBtnClicked());this.inherited(arguments)},_switchToMobileUI:function(){y.removeClass(this.titleNode,"title-normal");y.addClass(this.titleNode,"title-full");y.setStyle(this.foldableNode,"display","block");y.setStyle(this.maxNode,"display","block");"normal"===this.windowState?(y.removeClass(this.foldableNode,"fold-up"),y.addClass(this.foldableNode,"fold-down")):(y.removeClass(this.foldableNode,"fold-down"),y.addClass(this.foldableNode,
"fold-up"))},_switchToDesktopUI:function(){y.removeClass(this.titleNode,"title-full");y.addClass(this.titleNode,"title-normal");y.setStyle(this.foldableNode,"display","none");y.setStyle(this.maxNode,"display","none")},resize:function(a){var g=this._getPositionInfo(),e={left:g.position.left,top:g.position.top,width:this._positionInfoBox.w,height:this._positionInfoBox.h};a&&(a.t=this.domNode.offsetTop,e.left=isFinite(a.l)?a.l:e.left,e.top=isFinite(a.t)?a.t:e.top,e.width=isFinite(a.w)?a.w:e.width,e.height=
isFinite(a.h)?a.h:e.height,this._normalizePositionObj(m.clone(e)),this.makePositionInfoBox(),e.width=this._positionInfoBox.w,e.height=this._positionInfoBox.h);g.position=e;this._onResponsible(g);this.inherited(arguments)},_onResponsible:function(a){a.isRunInMobile?(this._setMobilePosition(),this.disableMoveable(),this.disableResizable(),this._switchToMobileUI()):(this._setDesktopPosition(a.position),this.makeResizable(),this.makeMoveable(this._positionInfoBox.w,.25*this._positionInfoBox.w),this._switchToDesktopUI())},
setPosition:function(a){this._normalizePositionObj(a);this.makePositionInfoBox();a=this._getPositionInfo();this._onResponsible(a)},destroy:function(){this.widgetIcon=null;this.inherited(arguments)},_getLayoutBox:function(){var a=jimuConfig.layoutId,a="map"===this.position.relativeTo?jimuConfig.mapId:jimuConfig.layoutId;return y.getMarginBox(a)},_getPositionInfo:function(){var a={isRunInMobile:!1,position:{left:0,top:5}},g=this._getLayoutBox(),e=this._positionInfoBox.l;if(window.appInfo.isRunInMobile)return a.isRunInMobile=
!0,a;window.isRTL?(a.position.left=g.w-e,a.position.left+this._positionInfoBox.w>g.w&&(a.position.left-=this._positionInfoBox.w,0>a.position.left&&(a.position.left=g.w-this._positionInfoBox.w))):(a.position.left=e,a.position.left+this._positionInfoBox.w>g.w&&(a.position.left=g.w>this._positionInfoBox.w?g.w-this._positionInfoBox.w:0));e=this._positionInfoBox.t;g=g.h-e;e>=g?e>=this._positionInfoBox.h&&(a.position.top=this._positionInfoBox.t-this._positionInfoBox.h-40-3):g>=this._positionInfoBox.h&&
(a.position.top=this._positionInfoBox.t+40+3);return a},_setMobilePosition:function(){window.appInfo.isRunInMobile&&this.domNode&&this.domNode.parentNode!==y.byId(jimuConfig.layoutId)&&y.place(this.domNode,jimuConfig.layoutId);var a=this.panelManager.getPositionOnMobile(this);this.position.zIndex&&(a.zIndex=this.position.zIndex);var g=n.getPositionStyle(a);m.mixin(g,a.borderRadiusStyle);y.setStyle(this.domNode,g)},_setDesktopPosition:function(a){!window.appInfo.isRunInMobile&&this.domNode&&this.domNode.parentNode!==
y.byId(jimuConfig.mapId)&&y.place(this.domNode,jimuConfig.mapId);y.setStyle(this.domNode,{left:a.left+"px",right:"auto",top:a.top+"px",width:(a.width||this.position.width||this._originalBox.w)+"px",height:(a.height||this.position.height||this._originalBox.h)+"px"})},onMoving:function(a){y.setStyle(a.node,"opacity",.9)},onMoveStop:function(a){y.setStyle(a.node,"opacity",1);a=y.getMarginBox(a.node);this._normalizePositionObj(m.clone({left:a.l,top:a.t,width:a.w,height:a.h}));this.makePositionInfoBox()}})})},
"dojox/layout/ResizeHandle":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/event dojo/_base/fx dojo/_base/window dojo/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/declare dojo/touch dijit/_base/manager dijit/_Widget dijit/_TemplatedMixin".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M){B.experimental("dojox.layout.ResizeHandle");var I=e("dojox.layout._ResizeHelper",z,{show:function(){k.set(this.domNode,"display",
"")},hide:function(){k.set(this.domNode,"display","none")},resize:function(e){a.setMarginBox(this.domNode,e)}});return e("dojox.layout.ResizeHandle",[z,M],{targetId:"",targetContainer:null,resizeAxis:"xy",activeResize:!1,activeResizeClass:"dojoxResizeHandleClone",animateSizing:!0,animateMethod:"chain",animateDuration:225,minHeight:100,minWidth:100,constrainMax:!1,maxHeight:0,maxWidth:0,fixedAspect:!1,intermediateChanges:!1,startTopic:"/dojo/resize/start",endTopic:"/dojo/resize/stop",templateString:'\x3cdiv dojoAttachPoint\x3d"resizeHandle" class\x3d"dojoxResizeHandle"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/div\x3e',
postCreate:function(){this.connect(this.resizeHandle,p.press,"_beginSizing");this.activeResize?this.animateSizing=!1:(this._resizeHelper=u.byId("dojoxGlobalResizeHelper"),this._resizeHelper||(this._resizeHelper=(new I({id:"dojoxGlobalResizeHelper"})).placeAt(t.body()),A.add(this._resizeHelper.domNode,this.activeResizeClass)));this.minSize||(this.minSize={w:this.minWidth,h:this.minHeight});this.constrainMax&&(this.maxSize={w:this.maxWidth,h:this.maxHeight});this._resizeX=this._resizeY=!1;var a=m.partial(A.add,
this.resizeHandle);switch(this.resizeAxis.toLowerCase()){case "xy":this._resizeX=this._resizeY=!0;a("dojoxResizeNW");break;case "x":this._resizeX=!0;a("dojoxResizeW");break;case "y":this._resizeY=!0,a("dojoxResizeN")}},_beginSizing:function(e){if(!this._isSizing&&(y.publish(this.startTopic,[this]),this.targetDomNode=(this.targetWidget=u.byId(this.targetId))?this.targetWidget.domNode:n.byId(this.targetId),this.targetContainer&&(this.targetDomNode=this.targetContainer),this.targetDomNode)){if(!this.activeResize){var m=
a.position(this.targetDomNode,!0);this._resizeHelper.resize({l:m.x,t:m.y,w:m.w,h:m.h});this._resizeHelper.show();this.isLeftToRight()||(this._resizeHelper.startPosition={l:m.x,t:m.y})}this._isSizing=!0;this.startPoint={x:e.clientX,y:e.clientY};var m=k.getComputedStyle(this.targetDomNode),r="border-model"===a.boxModel?{w:0,h:0}:a.getPadBorderExtents(this.targetDomNode,m),w=a.getMarginExtents(this.targetDomNode,m);this.startSize={w:k.get(this.targetDomNode,"width",m),h:k.get(this.targetDomNode,"height",
m),pbw:r.w,pbh:r.h,mw:w.w,mh:w.h};this.isLeftToRight()||"absolute"!=k.get(this.targetDomNode,"position")||(m=a.position(this.targetDomNode,!0),this.startPosition={l:m.x,t:m.y});this._pconnects=[y.connect(t.doc,p.move,this,"_updateSizing"),y.connect(t.doc,p.release,this,"_endSizing")];g.stop(e)}},_updateSizing:function(a){if(this.activeResize)this._changeSizing(a);else{var e=this._getNewCoords(a,"border",this._resizeHelper.startPosition);if(!1===e)return;this._resizeHelper.resize(e)}a.preventDefault()},
_getNewCoords:function(a,e,g){try{if(!a.clientX||!a.clientY)return!1}catch(J){return!1}this._activeResizeLastEvent=a;var k=(this.isLeftToRight()?1:-1)*(this.startPoint.x-a.clientX),n=this.startPoint.y-a.clientY;a=this.startSize.w-(this._resizeX?k:0);n=this._checkConstraints(a,this.startSize.h-(this._resizeY?n:0));(g=g||this.startPosition)&&this._resizeX&&(n.l=g.l+k,n.w!=a&&(n.l+=a-n.w),n.t=g.t);switch(e){case "margin":n.w+=this.startSize.mw,n.h+=this.startSize.mh;case "border":n.w+=this.startSize.pbw,
n.h+=this.startSize.pbh}return n},_checkConstraints:function(a,e){if(this.minSize){var g=this.minSize;a<g.w&&(a=g.w);e<g.h&&(e=g.h)}this.constrainMax&&this.maxSize&&(g=this.maxSize,a>g.w&&(a=g.w),e>g.h&&(e=g.h));if(this.fixedAspect){var g=this.startSize.w,k=this.startSize.h,n=g*e-k*a;0>n?a=e*g/k:0<n&&(e=a*k/g)}return{w:a,h:e}},_changeSizing:function(a){var e=this.targetWidget&&m.isFunction(this.targetWidget.resize),g=this._getNewCoords(a,e&&"margin");if(!1!==g&&(e?this.targetWidget.resize(g):this.animateSizing?
r[this.animateMethod]([w.animateProperty({node:this.targetDomNode,properties:{width:{start:this.startSize.w,end:g.w}},duration:this.animateDuration}),w.animateProperty({node:this.targetDomNode,properties:{height:{start:this.startSize.h,end:g.h}},duration:this.animateDuration})]).play():k.set(this.targetDomNode,{width:g.w+"px",height:g.h+"px"}),this.intermediateChanges))this.onResize(a)},_endSizing:function(a){x.forEach(this._pconnects,y.disconnect);var e=m.partial(y.publish,this.endTopic,[this]);
this.activeResize?e():(this._resizeHelper.hide(),this._changeSizing(a),setTimeout(e,this.animateDuration+15));this._isSizing=!1;this.onResize(a)},onResize:function(a){}})})},"jimu/BaseWidgetSetting":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","dijit/_WidgetBase","dijit/_TemplatedMixin"],function(B,m,y,x,g){return B([x,g],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.own(y(window,"resize",m.hitch(this,this._onWindowResize)))},getConfig:function(){},getDataSources:function(){},
resize:function(){},_onWindowResize:function(){this.resize()}})})},"jimu/symbolUtils":function(){define("require dojo/_base/lang dojo/_base/html dojox/gfx esri/symbols/jsonUtils esri/symbols/PictureMarkerSymbol".split(" "),function(B,m,y,x,g,w){return{cloneSymbol:function(m){if(!m)return null;var r=null;try{var n=m.toJson(),r=g.fromJson(n)}catch(A){console.error(A)}return r},getDefaultMarkerSymbol:function(){return g.fromJson({style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,
0,128,255],width:1},type:"esriSMS",size:18})},getDefaultLineSymbol:function(){return g.fromJson({tags:["solid"],title:"Blue Thin",style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"})},getDefaultFillSymbol:function(){return g.fromJson({tags:["opaque"],title:"Blue",style:"esriSFSSolid",color:[79,129,189,255],name:"Blue 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}})},getHightlightMarkerSymbol:function(){return g.fromJson({color:[255,
255,255,128],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"}})},getHightlightLineSymbol:function(){return g.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"})},getHightlightFillSymbol:function(){return g.fromJson({color:[255,255,255,128],outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"})},getGreyPinMarkerSymbol:function(){var g=
B.toUrl("jimu/css/images/grey_pin.png"),g=new w(g,16,16);g.setOffset(0,8);return g},createSymbolNode:function(t,r){var n=32,w=32,a=y.create("div",{},document.body);y.setStyle(a,"display","inline-block");if(r)n=r.width,w=r.height;else if(n=80,w=30,this.isSimpleMarkerSymbol(t))w=n=Math.min(t.size+12,125);else if(this.isPictureMarkerSymbol(t)){if(!t.url||"http://"===t.url||-1===t.url.indexOf("http://")&&-1===t.url.indexOf("https://")&&-1===t.url.indexOf("data:"))return;w=n=Math.min(Math.max(t.width,
t.height),125)}else if(this.isSimpleLineSymbol(t)||this.isCartographicLineSymbol(t))n=190,w=20;var k=x.createSurface(a,n,w);if("vml"===x.renderer){var e=k.getEventSource();y.setStyle(e,"position","relative");y.setStyle(e.parentNode,"position","relative")}var e=null,e=r?g.getShapeDescriptors(t):this.isSimpleLineSymbol(t)||this.isCartographicLineSymbol(t)?this._getLineShapeDesc(t):g.getShapeDescriptors(t),p;try{p=k.createShape(e.defaultShape),e.fill&&p.setFill(e.fill),e.stroke&&p.setStroke(e.stroke)}catch(u){k.clear();
k.destroy();return}t=k.getDimensions();t={dx:t.width/2,dy:t.height/2};k=p.getBoundingBox();r=k.width;k=k.height;if(r>n||k>w)n=((n<w?n:w)-5)/(r>k?r:k),m.mixin(t,{xx:n,yy:n});p.applyTransform(t);a&&y.addClass(a,"symbol");return a},_getLineShapeDesc:function(g){var m=null;if(this.isSimpleLineSymbol(g)||this.isCartographicLineSymbol(g))m={defaultShape:{type:"path",path:"M -90,0 L 90,0 E"},fill:null,stroke:g.getStroke()};return m},isSimpleMarkerSymbol:function(g){return g&&"esri.symbol.SimpleMarkerSymbol"===
g.declaredClass},isPictureMarkerSymbol:function(g){return g&&"esri.symbol.PictureMarkerSymbol"===g.declaredClass},isSimpleLineSymbol:function(g){return g&&"esri.symbol.SimpleLineSymbol"===g.declaredClass},isCartographicLineSymbol:function(g){return g&&"esri.symbol.CartographicLineSymbol"===g.declaredClass},isSimpleFillSymbol:function(g){return g&&"esri.symbol.SimpleFillSymbol"===g.declaredClass},isPictureFillSymbol:function(g){return g&&"esri.symbol.PictureFillSymbol"===g.declaredClass},isTextSymbol:function(g){return g&&
"esri.symbol.TextSymbol"===g.declaredClass}}})},"jimu/PoolControllerMixin":function(){define(["dojo/_base/declare","dojo/_base/array","jimu/PanelManager"],function(B,m,y){return B(null,{constructor:function(){this.panelManager=y.getInstance()},postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups="all")},getOpenedIds:function(){},setOpenedIds:function(m){},getConfigById:function(m){for(var g=this.getAllConfigs(),w=0;w<g.length;w++)if(g[w].id===
m)return g[w]},getAllConfigs:function(){var x=[],x=x.concat(this.getWidgetConfigs(),this.getGroupConfigs()),x=m.filter(x,function(g){return g.visible});return x.sort(function(g,m){return g.index-m.index})},getAllConfigsIncludeInvisible:function(){var m=[],m=m.concat(this.getWidgetConfigs(),this.getGroupConfigs());return m.sort(function(g,m){return g.index-m.index})},isControlled:function(x){return m.some(this.getAllConfigsIncludeInvisible(),function(g){return g.id===x})},widgetIsControlled:function(x){return m.some(this.getAllConfigsIncludeInvisible(),
function(g){return g.id===x?!0:m.some(g.widgets,function(g){return g.id===x})})},getGroupConfigs:function(){var x=[];if(!this.appConfig.widgetPool)return x;this.appConfig.widgetPool.groups&&m.forEach(this.appConfig.widgetPool.groups,function(g){this.controlledGroups&&(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(g.id)&&x.push(g):"all"===this.controlledGroups&&x.push(g))},this);return x},getWidgetConfigs:function(){var x=[];if(!this.appConfig.widgetPool)return x;this.appConfig.widgetPool.widgets&&
m.forEach(this.appConfig.widgetPool.widgets,function(g){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(g.id)&&x.push(g):"all"===this.controlledWidgets&&x.push(g))},this);return x}})})},"jimu/SpatialReference/utils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all dojo/request esri/SpatialReference ./unitUtils".split(" "),function(B,m,y,x,g,w,t,r){var n=null,A=null,a=!1;B=B(null,function(){});var k=
require.toUrl("jimu"),e=w(k+"/SpatialReference/wkidDetails.json",{handleAs:"json"}),p=w(k+"/SpatialReference/transform.json",{handleAs:"json"});B.loadResource=function(){var k=new x;if(n&&A)return k.resolve(),k;g([e,p]).then(function(e){n=e[0];A=e[1];a=!0;k.resolve()},function(e){console.error(e);a=!1;k.reject(e)});return k};B.getAllCSUnits=function(){if(a){var e=[];y.forEach(n.wkids,m.hitch(this,function(a){a=this.getCSUnit(a);-1===y.indexOf(e,a)&&e.push(a)}));return e}};B.convertUnit=function(e,
g,k){if(a)return r.convertUnit(e,g,k)};B.getUnitRate=function(e,g){if(a)return r.getUnitRate(e,g)};B.isProjectUnit=function(e){if(a)return r.isProjectUnit(e)};B.isGeographicUnit=function(e){if(a)return r.isGeographicUnit(e)};B.getGeographicUnits=function(){if(a)return r.getGeographicUnits()};B.getProjectUnits=function(){if(a)return r.getProjectUnits()};B.getCSUnit=function(e){if(a){e=this.getCSStr(e);var g=0,k=0,g=e.lastIndexOf("UNIT"),k=e.indexOf(",",g);return e.slice(g+6,k-1)}};B.isSameSR=function(e,
g){if(a)return e=this.indexOfWkid(e),g=this.indexOfWkid(g),n.labels[e]===n.labels[g]};B.isValidWkid=function(e){if(a)return-1<this.indexOfWkid(e)};B.getSRLabel=function(e){if(a&&this.isValidWkid(e))return e=this.indexOfWkid(e),n.labels[e]};B.indexOfWkid=function(e){if(a)return y.indexOf(n.wkids,e)};B.isWebMercator=function(a){return t.prototype._isWebMercator?t.prototype._isWebMercator.apply({wkid:parseInt(a,10)},[]):(new t(parseInt(a,10))).isWebMercator()};B.standardizeWkid=function(a){return this.isWebMercator(a)?
3857:parseInt(a,10)};B.isValidTfWkid=function(e){if(a)return-1<this.indexOfTfWkid(e)};B.getTransformationLabel=function(e){if(a)return this.isValidTfWkid(e)?(e=this.indexOfTfWkid(e),A.labels[e]):""};B.indexOfTfWkid=function(e){if(a)return y.indexOf(A.tfWkids,e)};B.isGeographicCS=function(e){if(a)return this.isValidWkid(e)?n.details[this.indexOfWkid(e)].startWith("GEOGCS"):!1};B.isProjectedCS=function(e){if(a)return this.isValidWkid(e)?n.details[this.indexOfWkid(e)].startWith("PROJCS"):!1};B.getGeoCSByProj=
function(e){if(a&&this.isProjectedCS(e))return e=this.getSpheroidStr(e),e=y.indexOf(n.details,e),n.wkids[e]};B.getSpheroidStr=function(e){if(a){if(this.isGeographicCS(e))return n.details[this.indexOfWkid(e)];if(this.isProjectedCS(e)){e=n.details[this.indexOfWkid(e)];var g=e.indexOf("GEOGCS"),k=e.indexOf("PROJECTION")-1;return e.slice(g,k)}return null}};B.getCSStr=function(e){if(a)return n.details[this.indexOfWkid(e)]};B.isSameSpheroid=function(e,g){if(a)return e=this.getSpheroidStr(e),g=this.getSpheroidStr(g),
e&&g&&e===g?!0:!1};return B})},"jimu/SpatialReference/unitUtils":function(){define(["dojo/_base/declare","dojo/_base/array"],function(B,m){var y="INCHES FOOT FOOT_US YARDS MILES NAUTICAL_MILES MILLIMETERS CENTIMETERS METER KILOMETERS DECIMETERS LINK_CLARKE FOOT_GOLD_COAST FOOT_CLARKE CHAIN_SEARS_1992_TRUNCATED YARD_INDIAN CHAIN_BENOIT_1895_B YARD_SEARS CHAIN_SEARS FOOT_SEARS YARD_INDIAN_1937 50_KILOMETERS 150_KILOMETERS".split(" "),x="DECIMAL_DEGREES DEGREE_MINUTE_SECONDS DEGREE GRAD MGRS USNG".split(" "),
g={INCHES:.0254,FOOT:.3048,FOOT_US:.3048006096012192,YARDS:.9144,MILES:1609.344,NAUTICAL_MILES:1852,MILLIMETERS:.001,CENTIMETERS:.01,METER:1,KILOMETERS:1E3,DECIMETERS:.1,LINK_CLARKE:.2011661949,FOOT_GOLD_COAST:.3047997101815088,FOOT_CLARKE:.304797265,CHAIN_SEARS_1922_TRUNCATED:20.116756,YARD_INDIAN:.9143985307444408,CHAIN_BENOIT_1895_B:20.11678249437587,YARD_SEARS:.9143984146160287,CHAIN_SEARS:20.11676512155263,FOOT_SEARS:.3047994715386762,YARD_INDIAN_1937:.91439523,"50_KILOMETERS":5E4,"150_KILOMETERS":15E4,
DEGREE:.0174532925199433,DECIMAL_DEGREES:.0174532925199433,MGRS:.0174532925199433,USNG:.0174532925199433,DEGREE_MINUTE_SECONDS:.0174532925199433,GRAD:.01570796326794897};B=B(null,function(){});B.convertUnit=function(m,t,r){return g[m.toUpperCase()]/g[t.toUpperCase()]*r};B.getUnitRate=function(m,t){return g[m.toUpperCase()]/g[t.toUpperCase()]};B.isProjectUnit=function(g){return-1<m.indexOf(y,g.toUpperCase())};B.isGeographicUnit=function(g){return-1<m.indexOf(x,g.toUpperCase())};B.getGeographicUnits=
function(){return x};B.getProjectUnits=function(){return y};return B})},"jimu/dijit-all":function(){define([],1)},"jimu/dijit/RadioBtn":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/registry".split(" "),function(B,m,y,x,g,w,t,r){return B(m,{baseClass:"jimu-radio",declaredClass:"jimu.dijit.RadioBtn",checked:!1,group:null,constructor:function(){},postCreate:function(){t.create("div",{"class":"jimu-radio-inner"},
this.domNode);this.checked&&w.add(this.domNode,"jimu-radio-checked");this.own(g(this.domNode,"click",y.hitch(this,function(){this.checked||this.check()})))},check:function(g){void 0===g&&(g=!0);this.checked=!0;w.add(this.domNode,"jimu-radio-checked");g&&this._changeOthersState(!1);this.onStateChange()},uncheck:function(g){void 0===g&&(g=!0);this.checked=!1;w.remove(this.domNode,"jimu-radio-checked");g&&this._changeOthersState(!1);this.onStateChange()},_changeOthersState:function(g){null!==this.group&&
x.forEach(r.toArray(),function(n){n.id!==this.id&&n["class"]===this["class"]&&n.group===this.group&&(g?n.check(!1):n.uncheck(!1))},this)},onStateChange:function(){}})})},"jimu/dijit/CheckBox":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/dom-class dojo/on dojo/Evented dojo/keys".split(" "),function(B,m,y,x,g,w,t,r){return B([m,t],{baseClass:"jimu-checkbox",declaredClass:"jimu.dijit.CheckBox",checked:!1,status:!0,label:"",title:"",postCreate:function(){this.checkNode=
x.create("div",{"class":"checkbox jimu-float-leading jimu-icon jimu-icon-checkbox"},this.domNode);this.labelNode=x.create("div",{"class":"label jimu-float-leading",innerHTML:this.label||""},this.domNode);this.checked&&(x.addClass(this.checkNode,"checked"),x.addClass(this.checkNode,"jimu-icon-checked"));this.status||(x.addClass(this.domNode,"jimu-state-disabled"),x.addClass(this.checkNode,"jimu-state-disabled"));this.own(w(this.checkNode,"click",y.hitch(this,function(){this.status&&(this.checked?this.uncheck():
this.check())})));this.own(w(this.labelNode,"click",y.hitch(this,function(){this.checked&&this.status?this.uncheck():this.status&&this.check()})));this._udpateLabelClass();this._initSection508()},setLabel:function(g){this.label=g;this.labelNode.innerHTML=this.label;this.labelNode.title=this.label;this._udpateLabelClass()},_udpateLabelClass:function(){this.labelNode&&(this.labelNode.innerHTML?x.removeClass(this.labelNode,"not-visible"):x.addClass(this.labelNode,"not-visible"))},_initSection508:function(){x.setAttr(this.domNode,
"tabindex","0");""===this.label&&x.setAttr(this.domNode,"title",this.title);x.setAttr(this.domNode,"role","checkbox");this._changeAriaCheckedAttr();this.own(w(this.domNode,"focus",y.hitch(this,function(){x.addClass(this.checkNode,"dijitCheckBoxFocused")})));this.own(w(this.domNode,"blur",y.hitch(this,function(){x.removeClass(this.checkNode,"dijitCheckBoxFocused")})));this.own(w(this.domNode,"keydown",y.hitch(this,function(g){g=g.charCode||g.keyCode;!x.hasClass(this.checkNode,"dijitCheckBoxFocused")||
r.SPACE!==g&&r.ENTER!==g||this.status&&(this.checked?this.uncheck():this.check())})))},setValue:function(g){this.status&&(!0===g?this.check():this.uncheck())},getValue:function(){return this.checked},setStatus:function(n){n=!!n;var m=this.status!==n;(this.status=n)?(g.remove(this.domNode,"jimu-state-disabled"),x.removeClass(this.checkNode,"jimu-state-disabled")):(g.add(this.domNode,"jimu-state-disabled"),x.addClass(this.checkNode,"jimu-state-disabled"));m&&this.emit("status-change",n)},getStatus:function(){return this.status},
check:function(g){if(this.status&&(this.checked=!0,x.addClass(this.checkNode,"checked jimu-icon-checked"),x.removeClass(this.checkNode,"checked jimu-icon-checkbox"),!g))this.onStateChange()},uncheck:function(g){if(this.status&&(this.checked=!1,x.removeClass(this.checkNode,"checked"),x.removeClass(this.checkNode,"jimu-icon-checked"),x.addClass(this.checkNode,"jimu-icon-checkbox"),!g))this.onStateChange()},onStateChange:function(){if(this.onChange&&y.isFunction(this.onChange))this.onChange(this.checked);
this.emit("change",this.checked);this._changeAriaCheckedAttr()},_changeAriaCheckedAttr:function(){x.setAttr(this.domNode,"aria-checked",this.checked?"true":"false")},focus:function(){this.checkNode&&this.checkNode.focus&&this.checkNode.focus()}})})},"jimu/dijit/SymbolChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SymbolChooser.html dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/sniff dojo/query dojo/request/xhr dojo/Deferred dojox/gfx dojo/promise/all jimu/utils jimu/symbolUtils jimu/portalUrlUtils esri/symbols/jsonUtils esri/symbols/SimpleMarkerSymbol esri/symbols/PictureMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/symbols/TextSymbol esri/symbols/Font esri/arcgis/Portal esri/request jimu/dijit/ImageChooser jimu/dijit/ColorPicker jimu/dijit/_Transparency jimu/dijit/LoadingIndicator dijit/form/Select dijit/form/NumberSpinner".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C,J,O,R,Q,T,S){return B([m,y,x,w],{templateString:g,baseClass:"jimu-symbol-chooser",declaredClass:"jimu.dijit.SymbolChooser",nls:null,_pointEventsBinded:!1,_lineEventBinded:!1,_fillEventBinded:!1,_textEventBinded:!1,_invokeSymbolChangeEvent:!0,_customPictureMarkerSymbol:null,symbol:null,type:null,DEFAULT_PORTAL_URL:"//arcgis.com/",_portalLoadTimeoutInMs:3E3,_isOnline:!0,_localTypes:"basic A-Z arrows business cartographic nationalParkService outdoorRecreation peoplePlaces safetyHealth shapes transportation damage disasters emergencyManagement generalInfrastructure localGovernment numbers pointsOfInterest stateGovernment FireFly".split(" "),
cropImage:!1,postMixInProperties:function(){this.nls=window.jimuNls.symbolChooser;this._setTemplateNls()},postCreate:function(){this.inherited(arguments);this._initImageChooser();this.own(A(document.body,"click",t.hitch(this,this._onBodyClicked)));(this._isIE8=8===a("ie"))&&r.addClass(this.domNode,"ie8");this.symbol?this.showBySymbol(this.symbol):this.type&&this.showByType(this.type)},reset:function(){this.symbol=this.type=null;this._hideAllSections()},showBySymbol:function(a){this.reset();var e=
a&&a.declaredClass;e&&"string"===typeof e&&0<=e.indexOf("esri.symbol")&&(this.symbol=this._cloneSymbol(a),this.isSimpleMarkerSymbol(this.symbol)||this.isPictureMarkerSymbol(this.symbol)?(this.type="marker",this._initPointSection()):this.isSimpleLineSymbol(this.symbol)?(this.type="line",this._initLineSection()):this._isSimpleFillSymbol(this.symbol)?(this.type="fill",this._initFillSection()):this._isTextSymbol(this.symbol)&&(this.type="text",this._initTextSection()))},showByType:function(a){this.reset();
if("marker"===a||"line"===a||"fill"===a||"text"===a)this.type=a,"marker"===this.type?this._initPointSection():"line"===this.type?this._initLineSection():"fill"===this.type?this._initFillSection():"text"===this.type&&this._initTextSection()},getSymbol:function(){return this._getSymbol(!1)},getValidSymbol:function(){return this._getSymbol(!0)},_getSymbol:function(a){var e=null;"marker"===this.type?e=this._getPointSymbolBySetting(a):"line"===this.type?e=this._getLineSymbolBySetting(a):"fill"===this.type?
e=this._getFillSymbolBySetting(a):"text"===this.type&&(e=this._getTextSymbolBySetting(a));a=null;e&&(a=this._cloneSymbol(e));return a},hideColorPicker:function(){for(var a="pointColor pointOutlineColor lineColor fillColor fillOutlineColor textColor".split(" "),e=0,g=a.length;e<g;e++){var k=a[e];this[k]&&this[k].hideTooltipDialog()}},_onBodyClicked:function(a){a=a.target||a.srcElement;this._tryHideDropDownOfSelectDijit(a,this.pointSymClassSelect);this._tryHideDropDownOfSelectDijit(a,this.lineStylesSelect)},
_tryHideDropDownOfSelectDijit:function(a,e){var g=e.domNode,k=e.dropDown.domNode,g=a===g||r.isDescendant(a,g);a=a===k||r.isDescendant(a,k);if(!g&&!a)e.dropDown.onCancel()},_onChange:function(a){a=this._cloneSymbol(a);this.emit("change",a)},_hideAllSections:function(){k(".symbol-section",this.domNode).style("display","none")},_showSection:function(a){this._hideAllSections();k("."+a+"-symbol-section",this.domNode).style("display","block")},_getAncestor:function(a,e,g){return M.getAncestorDom(a,e,g)},
_getAbsoluteUrl:function(a){return window.location.protocol+"//"+window.location.host+require.toUrl(a)},_cloneSymbol:function(a){if(!a)return null;var e=a;try{var g=a.toJson(),e=P.fromJson(g)}catch(V){console.error(V)}return e},_createSymbolIconTable:function(a,e,g){var m=this.type+"-icon-table";a=r.toDom('\x3ctable class\x3d"'+("icon-table "+m+" "+(m+"-"+a))+'"\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e');for(var m=k("tbody",a)[0],p=Math.ceil(e.length/8),u=0;u<p;u++)r.create("tr",{},m);var f=k("tr",
a);n.forEach(e,t.hitch(this,function(a,e){var c=t.clone(a),b=P.fromJson(a);e=r.create("td",{},f[Math.floor(e/8)]);r.addClass(e,"symbol-td-item");b=this._createSymbolNode(b);r.addClass(b,"symbol-div-item");var d=b.firstChild;r.addClass(d,"svg-node");if(this._isIE8&&"point"===g)if(window.isRTL){if("Cross"===a.name||"X"===a.name)r.setStyle(d,"right","-20px"),r.setStyle(b,"marginTop","20px")}else"Cross"!==a.name&&"X"!==a.name||r.setStyle(b,"marginTop","20px");b.symbol=c;r.place(b,e)}));return a},_updatePreview:function(a){var e=
this._cloneSymbol(this.symbol);r.empty(a);(e=I.createSymbolNode(e))||(e=r.create("div"));r.place(e,a)},_createSymbolNode:function(a){(a=I.createSymbolNode(a,{width:36,height:36}))||(a=r.create("div"));r.setStyle(a,{width:"36px",height:"36px"});return a},_getLineShapeDesc:function(a){var e=null;if(this.isSimpleLineSymbol(a)||this.isCartographicLineSymbol(a))e={defaultShape:{type:"path",path:"M -90,0 L 90,0 E"},fill:null,stroke:a.getStroke()};return e},_initPointSection:function(){this._showSection("point");
this._pointEventsBinded||(this._pointEventsBinded=!0,this._bindPointEvents(),this._onPointSymClassSelectChange());this.isPictureMarkerSymbol(this.symbol)?this._showBuildInPictureMarkerSymSettings():(this.isSimpleMarkerSymbol(this.symbol)||(this.symbol=new K({style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18})),this._showSimpleMarkerSymSettings());this._initPointSettings(this.symbol);this._getPointSymbolBySetting()},_bindPointEvents:function(){this.own(A(this.pointIconTables,
".symbol-div-item:click",t.hitch(this,this._onPointSymIconItemClick)));this.own(A(this.pointSymClassSelect,"change",t.hitch(this,this._onPointSymClassSelectChange)));this.own(A(this.pointSize,"change",t.hitch(this,this._onPointSymbolChange)));this.own(A(this.pointColor,"change",t.hitch(this,this._onPointSymbolChange)));this.own(A(this.pointAlpha,"change",t.hitch(this,this._onPointSymbolChange)));this.own(A(this.pointOutlineColor,"change",t.hitch(this,this._onPointSymbolChange)));this.own(A(this.pointOutlineWidth,
"change",t.hitch(this,this._onPointSymbolChange)))},_onPointSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getPointSymbolBySetting(),this._onChange(this.symbol))},_initPointSettings:function(a){if(a){this._invokeSymbolChangeEvent=!1;if(this.isSimpleMarkerSymbol(a)){if(this.pointSize.set("value",a.size),this.pointColor.setColor(a.color),this.pointAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),a=a.outline)this.pointOutlineColor.setColor(a.color),this.pointOutlineWidth.set("value",parseFloat(a.width.toFixed(0)))}else this.isPictureMarkerSymbol(a)&&
this.pointSize.set("value",a.width);this._invokeSymbolChangeEvent=!0}},isSimpleMarkerSymbol:function(a){return a&&"esri.symbol.SimpleMarkerSymbol"===a.declaredClass},isPictureMarkerSymbol:function(a){return a&&"esri.symbol.PictureMarkerSymbol"===a.declaredClass},_isCustomImageOptionSelected:function(){return"custom"===this.pointSymClassSelect.get("value")},_onPointSymClassSelectChange:function(){if(this._isCustomImageOptionSelected())this._showCustomPictureMarkerSymSettings(),this._customPictureMarkerSymbol&&
(this.symbol=this._customPictureMarkerSymbol,this._onPointSymbolChange());else{this._showSimpleMarkerSymSettings();this._showSelectedPointSymIconTable();var a=this.pointSymClassSelect.get("value");this.pointSymClassSelect["def"+a]?(a=this.pointSymClassSelect.getOptions(a),this.pointSymClassSelect.domNode.title=a?a.label:""):this._requestPointSymJson(a)}},_hideAllPointSymIconTable:function(){k(".marker-icon-table",this.pointIconTables).style("display","none")},_showSelectedPointSymIconTable:function(){this._hideAllPointSymIconTable();
var a=this.pointSymClassSelect.get("value"),a=k(".marker-icon-table-"+a,this.pointIconTables);0<a.length&&a.style("display","table")},_getLocalSymbols:function(a){a=a||this.pointSymClassSelect.get("value");a=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+a+".json");return e(a,{handleAs:"json"})},_getPortalSymbolsByType:function(a){var e=new p;a?this._fetchSymbols(a).then(t.hitch(this,function(a){e.resolve(a)}),t.hitch(this,function(a){e.reject(a)})):e.reject(null);return e},_requestPointSymJson:function(a){this.pointSymClassSelect["def"+
a]||(this.loadingShelter.show(),!this._isOnline&&window.isXT?this._offLineGetSymbols(a):this._symbolTypes?this._handleGetPointSymbols(t.hitch(this,this._getPortalSymbolsByType),a):this._initPortal().then(t.hitch(this,this._fetchSymbolTypes)).then(t.hitch(this,function(e){this.domNode&&(this._clearOptions(),this._createOptions(e),this._handleGetPointSymbols(t.hitch(this,this._getPortalSymbolsByType),a))}),t.hitch(this,function(e){this.domNode&&(window.isXT?this._offLineGetSymbols(a):(this.loadingShelter.hide(),
console.error("Fetching symbols failed",e)))})))},_offLineGetSymbols:function(a){this._isOnline=!1;if(0===this.pointSymClassSelect.options.length){var e=[];n.forEach(this._localTypes,t.hitch(this,function(a,g){e.push({id:g,title:this.nls[a]||a})}));this._clearOptions();this._createOptions(e)}this._handleGetPointSymbols(t.hitch(this,this._getLocalSymbols),a)},_clearOptions:function(){this.pointSymClassSelect&&this.pointSymClassSelect.removeOption(this.pointSymClassSelect.options)},_createOptions:function(a){if(this.pointSymClassSelect){var e=
[],g="",k=!1;"[object Array]"===Object.prototype.toString.call(a)&&0<a.length&&n.forEach(a,t.hitch(this,function(a){g=a.title||a.name;k=g===this.nls.basic?!0:!1;g&&(a.id||0===a.id)&&e.push({label:g,value:a.id,selected:k})}));e.push({label:this.nls.customImage,value:"custom"});this.pointSymClassSelect.addOption(e)}},_initPortal:function(){var a=new p;if(this._portal)a.resolve();else{var e=L.getStandardPortalUrl(window.portalUrl),g=new Q.Portal(e?e:this.DEFAULT_PORTAL_URL);if(g.loaded)return this._portal=
g,a.resolve(),a.promise;this.own(g.on("load",t.hitch(this,function(){this._portal=g;a.resolve()})));setTimeout(function(){a.reject()},this._portalLoadTimeoutInMs)}return a},_handleGetPointSymbols:function(a,e){if(this.pointSymClassSelect){var g=e||this.pointSymClassSelect.get("value");e="def"+g;a=a(g);this.pointSymClassSelect[e]=a;a.then(t.hitch(this,function(a){this.domNode&&(this.loadingShelter.hide(),this._getPointSymbolsSucess(g,a))}),t.hitch(this,function(a){this.domNode&&(this.loadingShelter.hide(),
console.error("Fetching symbols failed",a))}))}},_getPointSymbolsSucess:function(a,e){if(this.domNode){var g=this.pointSymClassSelect.getOptions(a);this.pointSymClassSelect.domNode.title=g?g.label:"";a=this._createSymbolIconTable(a,e,"point");r.place(a,this.pointIconTables);this._showSelectedPointSymIconTable()}},_fetchSymbols:function(a){var e=[],g=new p,e=this._symbolTypes.filter(function(e){return e.id===a});this._getSymbolListData(e).then(t.hitch(this,function(a){g.resolve(a)}),t.hitch(this,function(a){console.warn("fetch symbols failed",
a);g.reject(a)}));return g},_getSymbolListData:function(a){a=n.filter(a,function(a){return a.dataUrl});a=n.map(a,function(a){return T({url:a.dataUrl}).promise});return z(a).then(function(a){return a[0]})},_fetchSymbolTypes:function(){var a=new p;this._symbolTypes?a.resolve(this._symbolTypes):this._getSymbolListGroupId().then(t.hitch(this,this._getSymbolListItems)).then(t.hitch(this,function(e){this._symbolTypes=e;a.resolve(e)}),t.hitch(this,function(e){console.warn("fetch symbol types failed",e);
a.reject(e)}));return a},_getSymbolListGroupId:function(){var a=new p;this._portal||a.reject("no portal");this._portal.queryGroups({q:this._portal.symbolSetsGroupQuery}).then(function(e){a.resolve(e.results[0].id)},t.hitch(this,function(e){console.warn("get symbol list group id failed",e);a.reject(e)}));return a},_getSymbolListItems:function(a){var e=new p,g=this._portal;a="group:"+a+' AND type:"Symbol Set"';var k=[];this._portal||e.reject("no portal");a="vml"===u.renderer?a+' AND -typekeywords:"by value"':
a+' AND (typekeywords:"by value" AND typekeywords:"marker")';g.queryItems({q:a,num:20,sortField:"title"}).then(t.hitch(this,function(a){var g,f,m,p;n.forEach(a.results,function(a){g=a.typeKeywords.join(" ");-1<g.indexOf("marker")&&(f=a.title,m={name:f,id:a.id,title:a.title,keywords:g,dataUrl:a.itemDataUrl},(p=-1<g.indexOf("default"))?(m.defaultType=!0,k.unshift(m)):k.push(m))},this);0<k.length?e.resolve(k):e.reject()}),function(){e.reject()});return e},_onPointSymIconItemClick:function(a){if(a=this._getAncestor(a.target||
a.srcElement,function(a){return r.hasClass(a,"symbol-div-item")},5))if(k(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),r.addClass(a,"selected-symbol-div-item"),a=a.symbol){this.symbol=P.fromJson(a);a=r.getStyle(this.pointColorTr,"display");this.isSimpleMarkerSymbol(this.symbol)?this._showSimpleMarkerSymSettings():this._showBuildInPictureMarkerSymSettings();this._onPointSymbolChange();var e=r.getStyle(this.pointColorTr,"display");a!==e&&this.emit("resize")}},
_showSimpleMarkerSymSettings:function(){r.addClass(this.pointCustomImageTr,"hidden");r.removeClass(this.pointIconTablesTr,"hidden");r.removeClass(this.pointColorTr,"hidden");r.removeClass(this.pointOpacityTr,"hidden");r.removeClass(this.pointOutlineColorTr,"hidden");r.removeClass(this.pointOulineWidthTr,"hidden")},_showBuildInPictureMarkerSymSettings:function(){r.addClass(this.pointCustomImageTr,"hidden");r.removeClass(this.pointIconTablesTr,"hidden");r.addClass(this.pointColorTr,"hidden");r.addClass(this.pointOpacityTr,
"hidden");r.addClass(this.pointOutlineColorTr,"hidden");r.addClass(this.pointOulineWidthTr,"hidden")},_showCustomPictureMarkerSymSettings:function(){r.removeClass(this.pointCustomImageTr,"hidden");r.addClass(this.pointIconTablesTr,"hidden");r.addClass(this.pointColorTr,"hidden");r.addClass(this.pointOpacityTr,"hidden");r.addClass(this.pointOutlineColorTr,"hidden");r.addClass(this.pointOulineWidthTr,"hidden")},_getPointSymbolBySetting:function(a){if(!this.symbol||a&&!this.pointSize.validate())return null;
var e=parseFloat(this.pointSize.get("value"));if(this.isSimpleMarkerSymbol(this.symbol)){if(a&&!this.pointOutlineWidth.validate())return null;this.symbol.setSize(e);a=this.pointColor.getColor();e=this.pointAlpha.getAlpha();a.a=e;this.symbol.setColor(a);a=this.pointOutlineColor.getColor();var e=parseFloat(this.pointOutlineWidth.get("value")),g=new C;g.setStyle(C.STYLE_SOLID);g.setColor(a);g.setWidth(e);this.symbol.setOutline(g)}else this.isPictureMarkerSymbol(this.symbol)&&(this.symbol.setWidth(e),
this.symbol.setHeight(e));this._updatePreview(this.pointSymPreview);return this.symbol},_initImageChooser:function(){this.imageChooser=new S({cropImage:this.cropImage,customZIndex:this.customZIndex,showSelfImg:!1,goldenWidth:16,goldenHeight:16,format:["image/gif","image/png","image/jpeg"],label:this.nls.chooseFile});r.addClass(this.imageChooser.domNode,"custom-image-chooser");this.own(A(this.imageChooser,"change",t.hitch(this,this._onImageChange)));this.imageChooser.placeAt(this.customImageTd,"first")},
_onImageChange:function(a,e){this.imageNameNode.innerHTML=e.fileName;a=a.replace(/^data:image\/.*;base64,/,"");e=parseFloat(this.pointSize.get("value"));this._customPictureMarkerSymbol=this.symbol=new N({type:"esriPMS",url:null,imageData:a,contentType:"image/png",color:null,width:e,height:e,angle:0,xoffset:0,yoffset:0});this._onPointSymbolChange()},_initLineSection:function(){this._showSection("line");this._lineEventBinded||(this._lineEventBinded=!0,this._bindLineEvents(),this._requestLineSymJson("line"));
this._initLineSettings(this.symbol);this._getLineSymbolBySetting()},_bindLineEvents:function(){this.own(A(this.lineIconTables,".symbol-div-item:click",t.hitch(this,this._onLineSymIconItemClick)));this.own(A(this.lineColor,"change",t.hitch(this,this._onLineSymbolChange)));this.own(A(this.lineStylesSelect,"change",t.hitch(this,this._onLineSymbolChange)));this.own(A(this.lineAlpha,"change",t.hitch(this,this._onLineSymbolChange)));this.own(A(this.lineWidth,"change",t.hitch(this,this._onLineSymbolChange)))},
_onLineSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getLineSymbolBySetting(),this._onChange(this.symbol))},_initLineSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.lineColor.setColor(a.color),this.lineAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),this.lineWidth.set("value",parseFloat(a.width.toFixed(0))),this.lineStylesSelect.set("value",a.style),this._invokeSymbolChangeEvent=!0)},isSimpleLineSymbol:function(a){return a&&"esri.symbol.SimpleLineSymbol"===a.declaredClass},
isCartographicLineSymbol:function(a){return a&&"esri.symbol.CartographicLineSymbol"===a.declaredClass},_requestLineSymJson:function(a){var g=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+a+".json");e(g,{handleAs:"json"}).then(t.hitch(this,function(e){this.domNode&&(e=this._createSymbolIconTable(a,e,"line"),r.place(e,this.lineIconTables))}),t.hitch(this,function(a){console.error("get line symbol failed",a)}))},_onLineSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return r.hasClass(a,
"symbol-div-item")},5))if(k(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),r.addClass(a,"selected-symbol-div-item"),a=a.symbol)a=P.fromJson(a),this._initLineSettings(a),this._onLineSymbolChange()},_getLineSymbolBySetting:function(a){if(a&&!this.lineWidth.validate())return null;this.symbol=new C;a=this.lineColor.getColor();var e=this.lineStylesSelect.get("value");a.a=this.lineAlpha.getAlpha();var g=parseFloat(this.lineWidth.get("value"));this.symbol.setStyle(e);
this.symbol.setColor(a);this.symbol.setWidth(g);this._updatePreview(this.lineSymPreview);return this.symbol},_initFillSection:function(){this._showSection("fill");this._fillEventBinded||(this._fillEventBinded=!0,this._bindFillEvents(),this._requestFillSymJson("fill"));this._initFillSettings(this.symbol);this._getFillSymbolBySetting()},_bindFillEvents:function(){this.own(A(this.fillIconTables,".symbol-div-item:click",t.hitch(this,this._onFillSymIconItemClick)));this.own(A(this.fillColor,"change",t.hitch(this,
this._onFillSymbolChange)));this.own(A(this.fillAlpha,"change",t.hitch(this,this._onFillSymbolChange)));this.own(A(this.fillOutlineColor,"change",t.hitch(this,this._onFillSymbolChange)));this.own(A(this.fillOutlineWidth,"change",t.hitch(this,this._onFillSymbolChange)))},_onFillSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getFillSymbolBySetting(),this._onChange(this.symbol))},_initFillSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.fillColor.setColor(a.color),this.fillAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),
a.outline&&(this.fillOutlineColor.setColor(a.outline.color),this.fillOutlineWidth.set("value",parseInt(a.outline.width,10))),this._invokeSymbolChangeEvent=!0)},_isSimpleFillSymbol:function(a){return a&&"esri.symbol.SimpleFillSymbol"===a.declaredClass},_requestFillSymJson:function(a){var g=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+a+".json");e(g,{handleAs:"json"}).then(t.hitch(this,function(e){this.domNode&&(e=this._createSymbolIconTable(a,e,"fill"),r.place(e,this.fillIconTables))}),t.hitch(this,
function(a){console.error("get fill symbol failed",a)}))},_onFillSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return r.hasClass(a,"symbol-div-item")},5))if(k(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),r.addClass(a,"selected-symbol-div-item"),a=a.symbol)a=P.fromJson(a),this._initFillSettings(a),this._onFillSymbolChange()},_getFillSymbolBySetting:function(a){if(a&&!this.fillOutlineWidth.validate())return null;
this.symbol=new J;var e=this.fillColor.getColor();e.a=this.fillAlpha.getAlpha();a=this.fillOutlineColor.getColor();var g=parseInt(this.fillOutlineWidth.get("value"),10);this.symbol.setColor(e);this.symbol.setStyle(J.STYLE_SOLID);e=new C;e.setStyle(C.STYLE_SOLID);e.setColor(a);e.setWidth(g);this.symbol.setOutline(e);this._updatePreview(this.fillSymPreview);return this.symbol},_initTextSection:function(){this._showSection("text");this._textEventBinded||(this._textEventBinded=!0,this._bindTextEvents());
this._initTextSettings();this._getTextSymbolBySetting()},_bindTextEvents:function(){this.own(A(this.inputText,"change",t.hitch(this,this._onTextSymbolChange)));this.own(A(this.textColor,"change",t.hitch(this,this._onTextSymbolChange)));this.own(A(this.textFontSize,"change",t.hitch(this,this._onTextSymbolChange)))},_onTextSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getTextSymbolBySetting(),this._onChange(this.symbol))},_initTextSettings:function(a){a&&(this._invokeSymbolChangeEvent=
!1,this.inputText.value=a.text,this.textColor.setColor(a.color),a=parseInt(a.font.size,10),this.textFontSize.set("value",a),this._invokeSymbolChangeEvent=!0)},_isTextSymbol:function(a){return a&&"esri.symbol.TextSymbol"===a.declaredClass},_updateTextPreview:function(a){var e=this.textColor.getColor().toHex(),g=parseInt(this.textFontSize.get("value"),10)+"px";r.setStyle(this.textPreview,{color:e,fontSize:g,fontFamily:a});this.textPreview.innerHTML=this.inputText.value},_getTextSymbolBySetting:function(a){if(a&&
!this.textFontSize.validate())return null;this.symbol=new O;a=this.inputText.value;var e=this.textColor.getColor(),g=parseInt(this.textFontSize.get("value"),10),k=new R;k.setSize(g);this.symbol.setText(a);this.symbol.setColor(e);this.symbol.setFont(k);this._updateTextPreview(k.family);return this.symbol},_setTemplateNls:function(){"undefined"===typeof this.nls.damage&&(this.nls.damage="Damage");"undefined"===typeof this.nls.disasters&&(this.nls.disasters="Disasters");"undefined"===typeof this.nls.emergencyManagement&&
(this.nls.emergencyManagement="Emergency Management");"undefined"===typeof this.nls.generalInfrastructure&&(this.nls.generalInfrastructure="General Infrastructure");"undefined"===typeof this.nls.localGovernment&&(this.nls.localGovernment="Local Government");"undefined"===typeof this.nls.numbers&&(this.nls.numbers="Numbers");"undefined"===typeof this.nls.pointsOfInterest&&(this.nls.pointsOfInterest="Points of Interest");"undefined"===typeof this.nls.stateGovernment&&(this.nls.stateGovernment="State Government")}})})},
"esri/arcgis/Portal":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/_base/array dojo/_base/sniff require ../kernel ../lang ../request ../urlUtils ../Evented ../IdentityManager".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k){var e={options:{disableIdentityLookup:!0},requestParams:{f:"json"}},p=function(a){function e(e){a[e]||(a[e]=function(){var k=arguments;return x.when(a,function(a){return Array.prototype.unshift.call(k,a.results||a),p(g[e].apply(g,
k))})})}return a?(a.then&&(a=m.delegate(a)),a.total||(a.total=x.when(a,function(a){return n.isDefined(a.total)?a.total:a.length||0})),e("forEach"),e("filter"),e("map"),e("some"),e("every"),a):a},u={useSSL:function(a,g){var k=e&&e.self||{};if(k&&!k.isPortal)return-1!==a.indexOf("https:")||k.allSSL?g.replace("http:","https:"):g;var n=u.getLocation(g);return-1<k.portalHostname.toLowerCase().indexOf(n.hostname.toLowerCase())&&n.port&&"80"!==n.port&&"443"!==n.port?(g=n.pathname,g=0===g.indexOf("/")?g:
"/"+g,k.allSSL||-1<a.indexOf("https:")?"https://"+n.hostname+(k.httpsPort&&"443"!==k.httpsPort?":"+k.httpsPort:"")+g+n.search:"http://"+n.hostname+(k.httpPort&&"80"!==k.httpPort?":"+k.httpPort:"")+g+n.search):-1!==a.indexOf("https:")||k.allSSL?g.replace("http:","https:"):g},formatUrl:function(a){var g=e.currentToken;return-1!==a.indexOf("null")?null:u.useSSL(window.location.protocol,g?a+(-1!==a.indexOf("?")?"\x26":"?")+"token\x3d"+g:a)},getLocation:function(a){var e=document.createElement("a");return e.href=
a,{protocol:e.protocol,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search,hash:e.hash,host:e.host}},resultsToTypedArray:function(a,e,k){return k=k?k.listings||k.notifications||k.userInvitations||k.tags||k.items||k.groups||k.comments||k.provisions||k.results||k:[],g.map(k,function(g){return g=m.mixin(g,e||{}),a?new a(g):g})},clearFieldsFromObject:function(a,e){var g,k=a.length;if(m.isArray(a))for(g=0;g<k;g++)delete e[a[g]];else for(g in a)delete e[g];return e},requestToTypedArray:function(a,
e,g,k,n){return p(u.request(a,e,g).then(m.partial(u.resultsToTypedArray,k,n)))},request:function(a,g,k){var n,p,r;return g&&g.portal&&delete g.portal,g&&g.form&&(n=g.form,delete g.form),p=m.mixin(m.mixin({},g||{}),e.requestParams),r=m.mixin(k||{},e.options),A({url:u.useSSL(window.location.protocol,a.url||a),content:p,callbackParamName:"callback",timeout:r&&r.timeout||0,form:n},r)},formatQueryParams:function(a,g,k){a=m.mixin(m.mixin({},a),m.isString(g)?{q:g}:g||{});return a.q=!k&&e.extraQuery?"("+
a.q+")"+e.extraQuery:a.q,a}},z=B([],{declaredClass:"esri.arcgis.PortalComment",constructor:function(a){m.mixin(this,a);this.url=this.item.itemUrl+"/comments/"+this.id;this.created=this.created?new Date(this.created):null}}),M=B([],{declaredClass:"esri.arcgis.PortalRating",constructor:function(a){m.mixin(this,a);this.url=this.item.itemUrl+"/rating";this.created=this.created?new Date(this.created):null}}),I=B([],{declaredClass:"esri.arcgis.PortalItem",constructor:function(a){m.mixin(this,a);this.folderId=
this.ownerFolder||this.folderId;this.itemUrl=(this.portal&&this.portal.portalUrl)+"content/items/"+this.id;this.userItemUrl=this.hasOwnProperty("ownerFolder")?this.itemUrl.replace("/content/","/content/users/"+this.owner+(this.folderId?"/"+this.folderId:"")+"/"):null;this.itemDataUrl=u.formatUrl(this.itemUrl+"/data");this.thumbnailUrl=u.formatUrl(this.itemUrl+"/info/"+this.thumbnail);this.displayName=this._getDisplayName();this.iconUrl=this._getIconUrl();this.isPremiumContent=this._getIsPremiumContent();
this.created=this.created?new Date(this.created):null;this.uploaded=this.uploaded?new Date(this.uploaded):null;this.modified=this.modified?new Date(this.modified):null},getTypeInfo:function(){var a,e=this.type;return a=-1<g.indexOf(this.typeKeywords||[],"ArcGIS Server")||"Feature Collection"===e?e:null,{source:a,displayName:this.displayName,iconUrl:this.iconUrl,isPremiumContent:this.isPremiumContent,premiumIconUrl:this._getPremiumIconUrl()}},addComment:function(a){var e=m.isString(a)?{comment:a}:
a;return u.request(this.itemUrl+"/addComment",e,{usePost:!0}).then(m.hitch(this,function(a){return new z(m.mixin(e,{id:a.commentId,item:this}))}))},updateComment:function(a){if(a&&a.url&&a.comment)return u.request(a.url+"/update",{comment:a.comment},{usePost:!0}).then(function(e){return a.id=e.commentId,a});throw Error();},getComments:function(){return u.requestToTypedArray(this.itemUrl+"/comments",null,null,z,{item:this})},deleteComment:function(a){if(a&&a.url)return u.request(a.url+"/delete",null,
{usePost:!0});throw Error();},addRating:function(a){var e=m.isObject(a)?a:{rating:parseFloat(a)};return u.request(this.itemUrl+"/addRating",e,{usePost:!0}).then(m.hitch(this,function(a){return new M(m.mixin(e,{id:a.ratingId,item:this}))}))},getRating:function(){return u.request(this.itemUrl+"/rating").then(m.hitch(this,function(a){return new M(m.mixin(a,{item:this}))}))},deleteRating:function(){return u.request(this.itemUrl+"/deleteRating",null,{usePost:!0})},_getDisplayName:function(){var a=this.type,
e=this.typeKeywords||[],k=a;return"Feature Service"===a||"Feature Collection"===a?k=-1<g.indexOf(e,"Table")?"Table":-1<g.indexOf(e,"Route Layer")?"Route Layer":-1<g.indexOf(e,"Markup")?"Markup":"Feature Layer":"Image Service"===a?k=-1<g.indexOf(e,"Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===a?k="Scene Layer":"Scene Package"===a?k="Scene Layer Package":"Stream Service"===a?k="Feature Layer":"Geoprocessing Service"===a&&this.portal&&this.portal.isPortal?k=-1<g.indexOf(e,
"Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===a?k="Locator":"Microsoft Powerpoint"===a?k="Microsoft PowerPoint":"GeoJson"===a?(k="GeoJSON",this.type="GeoJSON"):"Globe Service"===a?k="Globe Layer":"Vector Tile Service"===a?k="Tile Layer":"netCDF"===a?k="NetCDF":"Map Service"===a?k=-1===g.indexOf(e,"Spatiotemporal")&&(-1<g.indexOf(e,"Hosted Service")||-1<g.indexOf(e,"Tiled"))&&-1===g.indexOf(e,"Relational")?"Tile Layer":"Map Image Layer":a&&-1<a.toLowerCase().indexOf("add in")?k=
a.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===a?k="Big Data File Share":"Compact Tile Package"===a&&(k="Tile Package (tpkx)"),k},_getIconUrl:function(){var a,e=this.type&&this.type.toLowerCase()||"",k=this.typeKeywords||[],n=!1,m=!1,p=!1,r=!1,u=!1;return 0<e.indexOf("service")||"feature collection"===e||"kml"===e||"wms"===e||"wmts"===e||"wfs"===e?(n=-1<g.indexOf(k,"Hosted Service"),"feature service"===e||"feature collection"===e||"kml"===e||"wfs"===e?(r=-1<g.indexOf(k,"Table"),m=
-1<g.indexOf(k,"Route Layer"),p=-1<g.indexOf(k,"Markup"),u=-1!==g.indexOf(k,"Spatiotemporal"),a=u&&r?"spatiotemporaltable":r?"table":m?"routelayer":p?"markup":u?"spatiotemporal":n?"featureshosted":"features"):"map service"===e||"wms"===e||"wmts"===e?(u=-1!==g.indexOf(k,"Spatiotemporal"),a=n||-1<g.indexOf(k,"Tiled")||"wmts"===e?"maptiles":u?"spatiotemporal":"mapimages"):a="scene service"===e?-1<g.indexOf(k,"Line")?"sceneweblayerline":-1<g.indexOf(k,"3DObject")?"sceneweblayermultipatch":-1<g.indexOf(k,
"Point")?"sceneweblayerpoint":-1<g.indexOf(k,"IntegratedMesh")?"sceneweblayermesh":-1<g.indexOf(k,"PointCloud")?"sceneweblayerpointcloud":-1<g.indexOf(k,"Polygon")?"sceneweblayerpolygon":-1<g.indexOf(k,"Building")?"sceneweblayerbuilding":"sceneweblayer":"image service"===e?-1<g.indexOf(k,"Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===e?"streamlayer":"vector tile service"===e?"vectortile":"datastore catalog service"===e?"datastorecollection":"geocoding service"===e?"geocodeservice":
"geoprocessing service"===e&&-1<g.indexOf(k,"Web Tool")&&this.portal&&this.portal.isPortal?"tool":"layers"):a="web map"===e||"cityengine web scene"===e?"maps":"web scene"===e?-1<g.indexOf(k,"ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===e||"mobile application"===e||"application"===e||"operation view"===e||"desktop application"===e?"apps":"map document"===e||"map package"===e||"published map"===e||"scene document"===e||"globe document"===e||"basemap package"===e||
"mobile basemap package"===e||"mobile map package"===e||"project package"===e||"project template"===e||"pro map"===e||"layout"===e||"layer"===e&&-1<g.indexOf(k,"ArcGIS Pro")||"explorer map"===e&&g.indexOf(k,"Explorer Document")?"mapsgray":"service definition"===e||"csv"===e||"shapefile"===e||"cad drawing"===e||"geojson"===e||"360 vr experience"===e||"netcdf"===e?"datafiles":"explorer add in"===e||"desktop add in"===e||"windows viewer add in"===e||"windows viewer configuration"===e?"appsgray":"arcgis pro add in"===
e||"arcgis pro configuration"===e?"addindesktop":"rule package"===e||"file geodatabase"===e||"sqlite geodatabase"===e||"csv collection"===e||"kml collection"===e||"windows mobile package"===e||"map template"===e||"desktop application template"===e||"arcpad package"===e||"code sample"===e||"form"===e||"document link"===e||"operations dashboard add in"===e||"rules package"===e||"image"===e||"workflow manager package"===e||"explorer map"===e&&-1<g.indexOf(k,"Explorer Mapping Application")||-1<g.indexOf(k,
"Document")?"datafilesgray":"network analysis service"===e||"geoprocessing service"===e||"geodata service"===e||"geometry service"===e||"geoprocessing package"===e||"locator package"===e||"geoprocessing sample"===e||"workflow manager service"===e?"toolsgray":"layer"===e||"layer package"===e||"explorer layer"===e?"layersgray":"scene package"===e?"scenepackage":"mobile scene package"===e?"mobilescenepackage":"tile package"===e||"compact tile package"===e?"tilepackage":"task file"===e?"taskfile":"report template"===
e?"report-template":"statistical data collection"===e?"statisticaldatacollection":"insights workbook"===e?"workbook":"insights model"===e?"insightsmodel":"insights page"===e?"insightspage":"insights theme"===e?"insightstheme":"hub initiative"===e?"hubinitiative":"hub page"===e?"hubpage":"hub site application"===e?"hubsite":"relational database connection"===e?"relationaldatabaseconnection":"big data file share"===e?"datastorecollection":"image collection"===e?"imagecollection":"desktop style"===e?
"desktopstyle":"style"===e?"style":"dashboard"===e?"dashboard":"raster function template"===e?"rasterprocessingtemplate":"vector tile package"===e?"vectortilepackage":"ortho mapping project"===e?"orthomappingproject":"ortho mapping template"===e?"orthomappingtemplate":"solution"===e?"solutions":"geopackage"===e?"geopackage":"deep learning package"===e?"deeplearningpackage":"real time analytic"===e?"realtimeanalytics":"big data analytic"===e?"bigdataanalytics":"feed"===e?"feed":"excalibur imagery project"===
e?"excaliburimageryproject":"maps",a?t.toUrl("../css/images/item_type_icons/"+a+"16.png"):null},_getIsPremiumContent:function(){var a=this.typeKeywords,e=!1;return(-1<g.indexOf(a,"Requires Subscription")||-1<g.indexOf(a,"Requires Credits"))&&(e=!0),e},_getPremiumIconUrl:function(){var a,e=this.typeKeywords;return this.isPremiumContent&&(a=-1<g.indexOf(e,"Requires Credits")?"premiumcredits":"premiumitem"),a?t.toUrl("../css/images/item_type_icons/"+a+"16.png"):null},getThumbnailUrl:function(a){var e=
this.thumbnailUrl;return e&&a&&(e+=(-1===e.indexOf("?")?"?":"\x26")+"w\x3d"+a),e}}),L=B([],{declaredClass:"esri.arcgis.PortalListing",constructor:function(a){m.mixin(this,a);this.id=this.itemId;this.url=(this.portal&&this.portal.portalUrl)+"content/"+(this.userItemUrl?"items/":"listings/")+this.itemId;this.commentsUrl=this.url+"/comments";this.created=this.created?new Date(this.created):null;this.banner=this.banner?u.formatUrl(this.url+"/info/"+this.banner):"";this.thumbnail=this.thumbnail?u.formatUrl(this.url+
"/info/"+this.thumbnail):"";this.largeThumbnail=this.largeThumbnail?u.formatUrl(this.url+"/info/"+this.largeThumbnail):"";this.avgRating=this.avgRating||0;this.numRatings=this.numRatings||0;this.numComments=this.numComments||0;this.listingProperties=this.listingProperties||{priceDesc:"",creditsPerTransaction:0,licenseType:"free",trialSupported:!1,trialDuration:0,listingAccess:"private"};for(var e in this.listingProperties)this[e]&&(this.listingProperties[e]=this[e]);this.properties=this.properties||
{systemRequirements:"",termsAndConditions:"",version:"1.0"};this.screenshots=g.map(this.screenshots,m.hitch(this,function(a){return u.formatUrl(this.url+"/info/"+a)}));this.vendorName=this.vendor.name;this.vendor.thumbnail=this.vendor.thumbnail?this.userItemUrl?u.formatUrl(this.portal.portalUrl+"/portals/self/resources/"+this.vendor.thumbnail):u.formatUrl(this.url+"/vendorinfo/"+this.vendor.thumbnail):""},getComments:function(){return u.requestToTypedArray(this.commentsUrl,null,null,z,{item:this})},
getVendor:function(){return this.vendor}}),P=B([],{declaredClass:"esri.arcgis.PortalProvision",constructor:function(a){m.mixin(this,a);this.created=this.created?new Date(this.created):null;this.startDate=this.startDate?new Date(this.startDate):null;this.endDate=this.endDate&&-1!==this.endDate?new Date(this.endDate):null;this.listing=a.listing?new L(m.mixin(a.listing,{portal:this.portal})):null}}),K=B([],{declaredClass:"esri.arcgis.PortalGroup",constructor:function(a){m.mixin(this,a);this.url=(this.portal&&
this.portal.portalUrl)+"community/groups/"+this.id;this.thumbnailUrl=u.formatUrl(this.url+"/info/"+this.thumbnail);this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getMembers:function(){return u.request(this.url+"/users")},queryItems:function(a,e){return a=u.formatQueryParams({},a,e),a.q="group:"+this.id+(a.q?" "+a.q:""),this.portal.queryItems(a)},getThumbnailUrl:function(a){var e=this.thumbnailUrl;return e&&a&&(e+=(-1===e.indexOf("?")?
"?":"\x26")+"w\x3d"+a),e}}),N=B([],{declaredClass:"esri.arcgis.PortalFolder",constructor:function(a){m.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username+"/"+this.id;this.created=this.created?new Date(this.created):null},getItems:function(){return u.requestToTypedArray(this.url,null,null,I,{portal:this.portal,folderId:this.id})}}),C=B([],{declaredClass:"esri.arcgis.PortalUser",constructor:function(a){m.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+
"community/users/"+this.username;this.userContentUrl=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username;this.thumbnailUrl=this.thumbnail?u.formatUrl(this.url+"/info/"+this.thumbnail):null;this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getGroups:function(){return p(u.request(this.url).then(m.hitch(this,function(a){return u.resultsToTypedArray(K,{portal:this.portal},a.groups)})))},getNotifications:function(){return u.requestToTypedArray(this.url+
"/notifications",null,null,null,{portal:this.portal})},getGroupInvitations:function(){return u.requestToTypedArray(this.url+"/invitations",null,null,null,{portal:this.portal})},getTags:function(){return u.requestToTypedArray(this.url+"/tags",null,null,null,{portal:this.portal})},getFolders:function(){return p(this.getContent(null,{num:1}).then(function(a){return a.folders}))},getItems:function(a){return p(this.getContent(a).then(function(a){return a.items}))},getItem:function(a){return u.request(this.portal.portalUrl+
"content/items/"+a).then(m.hitch(this,function(a){return new I(m.mixin(a,{portal:this.portal}))}))},getContent:function(a,e){var g=this.url.replace("community","content")+(a?"/"+a:"");return u.request(g,e).then(m.hitch(this,function(e){return e.folders=u.resultsToTypedArray(N,{portal:this.portal},e.folders),e.items=u.resultsToTypedArray(I,{portal:this.portal,folderId:a},e.items),e}))},getThumbnailUrl:function(a){var e=this.thumbnailUrl;return e&&a&&(e+=(-1===e.indexOf("?")?"?":"\x26")+"w\x3d"+a),
e}});B={Portal:B([k],{declaredClass:"esri.arcgis.Portal",onLoad:function(){},onError:function(){},constructor:function(g){g=m.isObject(g)?g:{url:g};(this.registerConnectEvents(),e={options:{disableIdentityLookup:!0},requestParams:{f:"json"}},g.self)?(e.self=g.self,m.mixin(this,{url:g.url||a.getProtocolForWebResource()+"//"+(g.self.urlKey?g.self.urlKey+"."+g.self.customBaseUrl:g.self.portalHostname)}),this.portalUrl=-1!==this.url.indexOf("/sharing")?this.url+"/":this.url+"/sharing/rest/",g=g.self.user?
this.signIn():this.init(this.url)):(g.url&&m.mixin(this,{url:g.url}),g=this.init(this.url));g.then(m.hitch(this,function(){this.emit("ready",this);this.onLoad(this)}))},init:function(a,g){a=(a||this.portalUrl).replace(/\/+$/,"");return this.portalUrl=-1!==a.indexOf("/sharing")?a+"/":a+"/sharing/rest/",this._getSelf(this.portalUrl).then(m.hitch(this,function(a){e.self=m.mixin({},a);a=a.user;return a&&g&&(e.currentToken=g&&g.token,e.loggedInUser=new C(m.mixin(a,{portal:this,credential:g}))),e.self.id&&
!1===e.self.canSearchPublic&&(e.extraQuery=" AND orgid:"+e.self.id),m.mixin(this,e.self),this.thumbnailUrl=u.formatUrl(this.portalUrl+"portals/self/resources/"+this.thumbnail),this.isOrganization=!(!this.access||!this.access.length),this.created=this.created?new Date(this.created):null,this.modified=this.modified?new Date(this.modified):null,this}),m.hitch(this,function(a){throw this.onError(a),a;}))},signIn:function(){var a=new x,g=m.hitch(this,function(){this._onSignIn().then(m.hitch(this,function(){a.resolve(e.loggedInUser)}),
m.hitch(this,function(e){a.reject(e)}))});return e&&e.self?e&&e.loggedInUser?setTimeout(function(){a.resolve(e.loggedInUser)},0):g():this.on("load",m.hitch(this,function(){g()})),a},signOut:function(){return e.loggedInUser.credential&&e.loggedInUser.credential.destroy(),e.loggedInUser=null,e.options.disableIdentityLookup=!0,u.clearFieldsFromObject(e.self,this),e.self=null,this.init(this.url)},getPortalUser:function(){return e.loggedInUser},addResource:function(a,e){return u.request(this.portalUrl+
"portals/self/addResource",{key:a,text:e},{usePost:!0})},update:function(a){return u.request(this.portalUrl+"portals/self/update",a,{usePost:!0})},queryGroups:function(a,e){return this._queryPortal(this.portalUrl+"community/groups",u.formatQueryParams({},a,e),K)},queryItems:function(a,e){return this._queryPortal(this.portalUrl+"search",u.formatQueryParams({},a,e),I)},queryListings:function(a){a=u.formatQueryParams({},a,!0);var e="";return a.q&&-1<a.q.toLowerCase().indexOf("mylistings:true")?(a.q=
a.q.toLowerCase().replace("mylistings:true",""),e="?mylistings\x3dtrue"):a.q||(a.q='""'),this._queryPortal(this.portalUrl+"content/listings"+e,a,L)},queryCustomerList:function(a,e){a=u.formatQueryParams({},a,!0);return this._queryPortal(this.portalUrl+"portals/self/customersList",a)},getProvisions:function(){return this.getCustomers().then(m.hitch(this,function(a){return a.purchases}))},getInterests:function(){return this.getCustomers().then(m.hitch(this,function(a){return a.interests}))},getTrials:function(){return this.getCustomers().then(m.hitch(this,
function(a){return a.trials}))},getCustomers:function(a){return u.request(this.portalUrl+"portals/self/customers",{status:a||"all"})},getMyPurchases:function(){return this.getPurchases().then(function(a){return a.purchases})},getMyInterests:function(){return this.getPurchases().then(function(a){return a.interests})},getPurchases:function(){return u.request(this.portalUrl+"portals/self/purchases").then(m.hitch(this,function(a){return a.interests=g.map(a.interests,function(a){return m.mixin(a.provision,
{listing:a.listing})}),a.purchases=g.map(a.purchases,function(a){return m.mixin(a.provision,{listing:a.listing})}),a.trials=g.map(a.trials,function(a){return m.mixin(a.provision,{listing:a.listing})}),a.interests=u.resultsToTypedArray(P,{portal:this},a.interests),a.trials=u.resultsToTypedArray(P,{portal:this},a.trials),a.purchases=u.resultsToTypedArray(P,{portal:this},a.purchases),a}))},queryUsers:function(a,e){return this._queryPortal(this.portalUrl+"community/users",u.formatQueryParams({sortField:"username"},
a,e),C)},_onSignIn:function(){return e.options.disableIdentityLookup=!1,e.self=null,r.id.getCredential(this.portalUrl).then(m.hitch(this,"init",this.url)).then(function(){return e.loggedInUser},m.hitch(this,function(a){throw e.options.disableIdentityLookup=!0,this.onError(a),a;}))},_getSelf:function(a){var g;a+="portals/self";return e.self?(g=new x,setTimeout(function(){g.resolve(e.self)},0)):g=u.request(a,{culture:y.locale}),g},_queryPortal:function(a,e,g){var k=m.mixin({num:10,start:0,sortField:"title",
sortOrder:"asc"},e),n=["start","query","num","nextStart"];a=u.request(a,k).then(m.hitch(this,function(a){return a.results=u.resultsToTypedArray(g,{portal:this},a),a.queryParams=m.mixin({},k),a.nextQueryParams=m.mixin(k,{start:a.nextStart}),u.clearFieldsFromObject(n,a)}));return a=m.delegate(a),a.queryParams=m.mixin({},k),a.nextQueryParams=x.when(a,function(a){return a.nextQueryParams}),p(a)}}),PortalFolder:N,PortalGroup:K,PortalItem:I,PortalUser:C,PortalComment:z,PortalRating:M,PortalUtil:u,PortalResult:p,
PortalListing:L};return w("extend-esri")&&m.mixin(m.getObject("arcgis",!0,r),B),B})},"jimu/dijit/ImageChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff esri/lang ../utils ./_CropImage jimu/dijit/Popup jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u){var z=0;B=m([y,x,B],{templateString:r,declaredClass:"jimu.dijit.ImageChooser",
cropImage:!0,displayImg:null,stretchImg:!0,defaultSelfSrc:null,showSelfImg:!1,label:null,showTip:!0,goldenWidth:400,goldenHeight:400,maxSize:1024,format:null,customZIndex:null,imageData:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.imageChooser;this.nls.common=window.jimuNls.common;this.nls.readError=this.nls.readError||"Failed to read the file."},postCreate:function(){this._initial();a.file.supportHTML5()||n("safari")||!a.file.isEnabledFlash()||a.file.loadFileAPI().then(g.hitch(this,
function(){w.setStyle(this.mask,"zIndex",1)}))},setImageSize:function(a){this.goldenWidth=a.width;this.goldenHeight=a.height},disableChooseImage:function(){w.setStyle(this.fileForm,"display","none");this.label&&"string"===typeof this.label&&w.addClass(this.displayText,"disable-label");w.removeAttr(this.domNode,"title")},enableChooseImage:function(){w.setStyle(this.fileForm,"display","block");this.label&&"string"===typeof this.label&&w.removeClass(this.displayText,"disable-label");this._addTip()},
setDefaultSelfSrc:function(a){this.defaultSelfSrc=a;this.imageData=this.selfImg.src=a},getImageData:function(){return this.imageData},_initial:function(){this._initFileForm();this._processProperties();this._addTip()},_processProperties:function(){this.fileProperty={};this.label&&"string"===typeof this.label&&(this.displayText.innerHTML=this.label,w.setStyle(this.hintText,"display","block"));this.showSelfImg&&w.setStyle(this.hintImage,"display","block");!1===this.stretchImg?w.addClass(this.selfImg,
"no-stretch-img"):w.removeClass(this.selfImg,"no-stretch-img");this.defaultSelfSrc&&(this.imageData=this.selfImg.src=this.defaultSelfSrc);if(this.format){var e="image/*";"string"===typeof this.format&&/^image\/./.test(this.format)?e=this.format:"[object Array]"===Object.prototype.toString.call(this.format)&&0<this.format.length&&(e=this.format.join(","));w.setAttr(this.fileInput,"accept",e)}a.file.supportHTML5()||n("safari")||!a.file.isEnabledFlash()||w.setStyle(this.fileInput,{width:"100%",height:"100%",
position:"absolute",left:0,top:0,opacity:0,zIndex:9})},_newMessage:function(a){this.msgPopupOpen=!0;this.msgPopup=new p({customZIndex:this.customZIndex,message:a})},_porcessMaskClick:function(){w.setAttr(this.fileInput,"id","imageChooser_"+z);w.setAttr(this.mask,"for","imageChooser_"+z);z++;t.once(this.mask,"click",g.hitch(this,function(e){e.stopPropagation();if(n("safari")&&7>n("safari"))this._newMessage(this.nls.unsupportReaderAPI),e.preventDefault();else{if(!a.file.supportHTML5()){if(!a.file.isEnabledFlash()){var k=
w.create("a",{href:"http://helpx.adobe.com/flash-player.html",innerHTML:this.nls.enableFlash,target:"_blank"});this._newMessage(k);e.preventDefault();return}if(!a.file.supportFileAPI()){this._newMessage(this.nls.unsupportReaderAPI);e.preventDefault();return}}w.setStyle(this.fileInput,"display","none");setTimeout(g.hitch(this,function(){w.setStyle(this.fileInput,"display","block")}),200)}}))},_addTip:function(){if(this.showTip){var a=A.substitute({width:this.goldenWidth||40,height:this.goldenHeight||
40},this.nls.toolTip);w.setAttr(this.domNode,"title",a)}else w.setAttr(this.domNode,"title","")},_onFileInputChange:function(e){var k=e.target.files&&e.target.files[0]||e.files&&e.files[0];if(this.format&&-1===this.format.indexOf(k.type))this._newMessage(this.nls.invalidType),this._initFileForm();else{var n=1024*this.maxSize;a.file.readFile(e,"image/*",n,g.hitch(this,function(a,e,g){a?(e=this.nls[a.errCode],"exceed"===a.errCode&&(e=e.replace("1024",n/1024)),this._newMessage(e)):(this.fileProperty.fileName=
e,this.cropImage&&"image/gif"!==k.type?this._cropImageByUser(g,k.type):this._readFileData(g));this._initFileForm()}))}},_initFileForm:function(){this.mask&&w.destroy(this.mask);this.fileInput&&w.destroy(this.fileInput);this.fileForm&&w.destroy(this.fileForm);this.fileForm=w.create("form",{"data-dojo-attach-point":"fileForm"},this.domNode);this.mask=w.create("label",{"data-dojo-attach-point":"mask"},this.fileForm);this.fileInput=w.create("input",{type:"file","data-dojo-attach-point":"fileInput"},this.fileForm);
this._porcessMaskClick();t.once(this.fileInput,"change",g.hitch(this,this._onFileInputChange))},_readFileData:function(a){this.onImageChange(a,this.fileProperty);this.displayImg&&w.setAttr(this.displayImg,"src",a);this.showSelfImg&&(this.selfImg?w.setAttr(this.selfImg,"src",a):this.selfImg.src=a,(a=w.getMarginBox(this.hintImage))&&a.w&&a.h&&(w.style(this.selfImg,"maxWidth",a.w+"px"),w.style(this.selfImg,"maxHeight",a.h+"px")))},_cropImageByUser:function(a,n){var m=new k({imageSrc:a,type:n,nls:g.clone(this.nls),
goldenWidth:this.goldenWidth,goldenHeight:this.goldenHeight}),p=new u({hidden:!0});this.cropPopupOpen=!0;this.cropPopup=new e({titleLabel:this.nls.cropImage,content:m,customZIndex:this.customZIndex,width:500,height:480,buttons:[{label:this.nls.common.ok,onClick:g.hitch(this,function(){p.show();var a=m.getData();a&&this._readFileData(a);this.cropPopup.close();m.destroy();p.hide()})}]});p.placeAt(this.cropPopup.domNode);m.startup();w.addClass(this.cropPopup.domNode,"image-chooser-crop-popup")},onImageChange:function(a){this.imageData=
a;this.emit("imageChange",this.imageData,this.fileProperty);this.emit("change",this.imageData,this.fileProperty)}});B.GIF="image/gif";B.JPEG="image/jpeg";B.PNG="image/png";return B})},"jimu/dijit/_CropImage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_CropImage.html jimu/dijit/Message dojo/NodeList-dom".split(" "),function(B,m,y,x,g,w,t,r){var n=window.Cropper;return B([g,w],{templateString:t,imageSrc:null,
type:null,goldenWidth:4,goldenHeight:3,_haveShowReadErrMsg:!1,postCreate:function(){this.type||(this.type="image/jpeg");this.setImageSrc(this.imageSrc);this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";this._checkImgError();this.own(x(this.baseImage,"load",y.hitch(this,function(){m.setStyle(this.loadingImg,"display","none");this._initCropper()})))},_initCropper:function(){this.cropper&&this.cropper.destroy&&this.cropper.destroy();this.cropper=new n(this.baseImage,{aspectRatio:this.goldenWidth/
this.goldenHeight,preview:".img-preview"})},setImageSrc:function(g){m.setAttr(this.baseImage,"src",g)},getData:function(){try{var g=this.cropper.getCroppedCanvas();this.cropper.getCroppedCanvas();return g.toDataURL(this.type||"image/jpeg")}catch(a){return this._readError(),null}},destroy:function(){this.cropper&&this.cropper.destroy&&this.cropper.destroy();this.inherited(arguments)},_checkImgError:function(){setTimeout(y.hitch(this,function(){"none"!==m.getStyle(this.loadingImg,"display")&&this._readError()}),
5E3)},_readError:function(){this._haveShowReadErrMsg||(new r({message:this.nls.readError}),this._haveShowReadErrMsg=!0)}})})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorSelector jimu/utils".split(" "),function(B,m,y,x,g,w,t,r,n,A,a){return B([m,y],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",
_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,showLabel:!1,postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof t||(this.color=new t(this.color)):this.color=new t("#ccc");g.setStyle(this.domNode,"backgroundColor",this.color.toHex());this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},destroy:function(){n.close(this.tooltipDialog);
this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var e=this.tooltipDialog.domNode;return a===e||g.isDescendant(a,e)},hideTooltipDialog:function(){this._hideTooltipDialog()},_showTooltipDialog:function(){n.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){this._isTooltipDialogOpened=!1;this.onClose();n.close(this.tooltipDialog)},_createTooltipDialog:function(){var a=
g.create("div");this.tooltipDialog=new r({content:a});g.addClass(this.tooltipDialog.domNode,"jimu-color-picker-dialog");var e=new A({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:x.hitch(this,function(a){this.ensureMode||(a=new t(a),this.setColor(a))})});e.placeAt(a);e.startup();if(this.ensureMode){var n=g.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing",title:this.nls.cancel,innerHTML:this.nls.cancel},a);this.own(w(n,"click",
x.hitch(this,function(){this._hideTooltipDialog()})));"undefined"===typeof this.showOk&&(n=g.create("div",{"class":"jimu-btn jimu-float-trailing ok",title:this.nls.ok,innerHTML:this.nls.ok},a),this.own(w(n,"click",x.hitch(this,function(){var a=this.picker.get("value");this.setColor(new t(a));this._hideTooltipDialog()}))));a=g.create("div",{"class":"jimu-btn jimu-float-trailing",title:this.nls.apply,innerHTML:this.nls.apply},a);this.own(w(a,"click",x.hitch(this,function(){var a=this.picker.get("value");
this.setColor(new t(a))})))}this.own(w(this.domNode,"click",x.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(w(document.body,"click",x.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})));this.picker=e},setColor:function(a,e){if(a instanceof t){var k=this.color,n="";k&&(n=k.toHex());k=a.toHex();this.color=a;g.setStyle(this.domNode,"backgroundColor",
k);if(n!==k&&(this.picker.set("value",k),!1!==e))this.onChange(new t(k))}},getColor:function(){return this.color},_changeLabel:function(k){g.empty(this.domNode);g.create("span",{innerHTML:k.toHex(),className:"color-label",style:{color:a.invertColor(k.toHex())}},this.domNode)},onChange:function(a){this.showLabel&&this._changeLabel(a)},onClose:function(){},getPopup:function(){return this.tooltipDialog||null},setLabel:function(a){g.empty(this.domNode);g.create("span",{innerHTML:a||"",className:"text-label"},
this.domNode)},isTooltipDialogOpened:function(){return this._isTooltipDialogOpened}})})},"jimu/dijit/ColorSelector":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dojox/widget/ColorPicker dijit/_base/focus dojo/fx dojo/_base/lang dojo/_base/html dojo/sniff".split(" "),function(B,m,y,x,g,w,t,r,n){return m([y,x,B],{baseClass:"jimu-color-selector",declaredClass:"jimu.dijit.ColorSelector",_setPoint:function(m){m&&g.focus(m.target);if(!this._CURSOR_WIDTH||!this._CURSOR_HEIGHT){var a=
r.getMarginBox(this.cursorNode);a.w&&a.h&&(this._CURSOR_WIDTH=a.w/2,this._CURSOR_HEIGHT=a.h/2)}this._BORDER_WIDTH&&this._BORDER_HEIGHT||(a=r.getBorderExtents(m.target||m.srcElement),a.w&&a.h&&(this._BORDER_WIDTH=a.w,this._BORDER_HEIGHT=a.h));var k=a=0;n("ff")||n("ie")||n("MSIE")?(a=m.offsetX,k=m.offsetY):m.offsetX&&m.offsetY&&(a=m.offsetX+this._BORDER_WIDTH,k=m.offsetY+this._BORDER_HEIGHT);m=k-this._CURSOR_HEIGHT;a-=this._CURSOR_WIDTH;this.animatePoint?w.slideTo({node:this.cursorNode,duration:this.slideDuration,
top:m,left:a,onEnd:t.hitch(this,function(){this._updateColor(!0);g.focus(this.cursorNode)})}).play():(r.style(this.cursorNode,{left:a+"px",top:m+"px"}),this._updateColor(!0))},_setHuePoint:function(n){n=n.offsetY-this.PICKER_HUE_SELECTOR_H/2;this.animatePoint?w.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:n,left:0,onEnd:t.hitch(this,function(){this._updateColor(!0);g.focus(this.hueCursorNode)})}).play():(r.style(this.hueCursorNode,"top",n+"px"),this._updateColor(!0))}})})},"dojox/widget/ColorPicker":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/connect dojo/_base/sniff dojo/_base/window dojo/_base/event dojo/dom dojo/dom-class dojo/keys dojo/fx dojo/dnd/move dijit/registry dijit/_base/focus dijit/form/_FormWidget dijit/typematic dojox/color dojo/i18n dojo/i18n!./nls/ColorPicker dojo/i18n!dojo/cldr/nls/number dojo/text!./ColorPicker/ColorPicker.html".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C){B.experimental("dojox.widget.ColorPicker");return m("dojox.widget.ColorPicker",M,{showRgb:!0,showHsv:!0,showHex:!0,webSafe:!0,animatePoint:!0,slideDuration:250,liveUpdate:!1,PICKER_HUE_H:150,PICKER_SAT_VAL_H:150,PICKER_SAT_VAL_W:150,PICKER_HUE_SELECTOR_H:8,PICKER_SAT_SELECTOR_H:10,PICKER_SAT_SELECTOR_W:10,value:"#ffffff",_underlay:require.toUrl("dojox/widget/ColorPicker/images/underlay.png"),_hueUnderlay:require.toUrl("dojox/widget/ColorPicker/images/hue.png"),
_pickerPointer:require.toUrl("dojox/widget/ColorPicker/images/pickerPointer.png"),_huePickerPointer:require.toUrl("dojox/widget/ColorPicker/images/hueHandle.png"),_huePickerPointerAlly:require.toUrl("dojox/widget/ColorPicker/images/hueHandleA11y.png"),templateString:C,postMixInProperties:function(){a.contains(r.body(),"dijit_a11y")&&(this._huePickerPointer=this._huePickerPointerAlly);this._uId=u.getUniqueId(this.id);y.mixin(this,P.getLocalization("dojox.widget","ColorPicker"));y.mixin(this,P.getLocalization("dojo.cldr",
"number"));this.inherited(arguments)},postCreate:function(){this.inherited(arguments);7>t("ie")&&(this.colorUnderlay.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this._underlay+"', sizingMethod\x3d'scale')",this.colorUnderlay.src=this._blankGif.toString());this.showRgb||(this.rgbNode.style.visibility="hidden");this.showHsv||(this.hsvNode.style.visibility="hidden");this.showHex||(this.hexNode.style.visibility="hidden");this.webSafe||(this.safePreviewNode.style.visibility=
"hidden")},startup:function(){this._started||(this._started=!0,this.set("value",this.value),this._mover=new p.boxConstrainedMoveable(this.cursorNode,{box:{t:-(this.PICKER_SAT_SELECTOR_H/2),l:-(this.PICKER_SAT_SELECTOR_W/2),w:this.PICKER_SAT_VAL_W,h:this.PICKER_SAT_VAL_H}}),this._hueMover=new p.boxConstrainedMoveable(this.hueCursorNode,{box:{t:-(this.PICKER_HUE_SELECTOR_H/2),l:0,w:0,h:this.PICKER_HUE_H}}),this._subs=[],this._subs.push(w.subscribe("/dnd/move/stop",y.hitch(this,"_clearTimer"))),this._subs.push(w.subscribe("/dnd/move/start",
y.hitch(this,"_setTimer"))),this._keyListeners=[],this._connects.push(I.addKeyListener(this.hueCursorNode,{charOrCode:k.UP_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,y.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(I.addKeyListener(this.hueCursorNode,{charOrCode:k.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,y.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(I.addKeyListener(this.cursorNode,{charOrCode:k.UP_ARROW,shiftKey:!1,metaKey:!1,
ctrlKey:!1,altKey:!1},this,y.hitch(this,this._updateCursorNode),25,25)),this._connects.push(I.addKeyListener(this.cursorNode,{charOrCode:k.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,y.hitch(this,this._updateCursorNode),25,25)),this._connects.push(I.addKeyListener(this.cursorNode,{charOrCode:k.LEFT_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,y.hitch(this,this._updateCursorNode),25,25)),this._connects.push(I.addKeyListener(this.cursorNode,{charOrCode:k.RIGHT_ARROW,shiftKey:!1,
metaKey:!1,ctrlKey:!1,altKey:!1},this,y.hitch(this,this._updateCursorNode),25,25)))},_setValueAttr:function(a,e){this._started&&this.setColor(a,e)},setColor:function(a,e){a=L.fromString(a);this._updatePickerLocations(a);this._updateColorInputs(a);this._updateValue(a,e)},_setTimer:function(a){if(a.node==this.cursorNode||a.node==this.hueCursorNode)z.focus(a.node),A.setSelectable(this.domNode,!1),this._timer=setInterval(y.hitch(this,"_updateColor"),45)},_clearTimer:function(a){this._timer&&(clearInterval(this._timer),
this._timer=null,this.onChange(this.value),A.setSelectable(this.domNode,!0))},_setHue:function(a){g.style(this.colorUnderlay,"backgroundColor",L.fromHsv(a,100,100).toHex())},_updateHueCursorNode:function(a,e,n){if(-1!==a){a=g.style(this.hueCursorNode,"top");e=this.PICKER_HUE_SELECTOR_H/2;a+=e;var m=!1;n.charOrCode==k.UP_ARROW?0<a&&(--a,m=!0):n.charOrCode==k.DOWN_ARROW&&a<this.PICKER_HUE_H&&(a+=1,m=!0);m&&g.style(this.hueCursorNode,"top",a-e+"px")}else this._updateColor(!0)},_updateCursorNode:function(a,
e,n){e=this.PICKER_SAT_SELECTOR_H/2;var m=this.PICKER_SAT_SELECTOR_W/2;if(-1!==a){a=g.style(this.cursorNode,"top");var p=g.style(this.cursorNode,"left");a+=e;var p=p+m,r=!1;n.charOrCode==k.UP_ARROW?0<a&&(--a,r=!0):n.charOrCode==k.DOWN_ARROW?a<this.PICKER_SAT_VAL_H&&(a+=1,r=!0):n.charOrCode==k.LEFT_ARROW?0<p&&(--p,r=!0):n.charOrCode==k.RIGHT_ARROW&&p<this.PICKER_SAT_VAL_W&&(p+=1,r=!0);r&&(p-=m,g.style(this.cursorNode,"top",a-e+"px"),g.style(this.cursorNode,"left",p+"px"))}else this._updateColor(!0)},
_updateColor:function(a){var e=this.PICKER_HUE_SELECTOR_H/2,k=this.PICKER_SAT_SELECTOR_H/2,n=this.PICKER_SAT_SELECTOR_W/2,e=g.style(this.hueCursorNode,"top")+e,k=g.style(this.cursorNode,"top")+k,n=g.style(this.cursorNode,"left")+n,e=Math.round(360-e/this.PICKER_HUE_H*360),n=L.fromHsv(e,n/this.PICKER_SAT_VAL_W*100,100-k/this.PICKER_SAT_VAL_H*100);this._updateColorInputs(n);this._updateValue(n,a);e!=this._hue&&this._setHue(e)},_colorInputChange:function(a){var e,g=!1;switch(a.target){case this.hexCode:e=
L.fromString(a.target.value);g=!0;break;case this.Rval:case this.Gval:case this.Bval:e=L.fromArray([this.Rval.value,this.Gval.value,this.Bval.value]);g=!0;break;case this.Hval:case this.Sval:case this.Vval:e=L.fromHsv(this.Hval.value,this.Sval.value,this.Vval.value),g=!0}g&&(this._updatePickerLocations(e),this._updateColorInputs(e),this._updateValue(e,!0))},_updateValue:function(a,e){a=a.toHex();this.value=this.valueNode.value=a;if(e&&(!this._timer||this.liveUpdate))this.onChange(a)},_updatePickerLocations:function(a){var k=
this.PICKER_HUE_SELECTOR_H/2,n=this.PICKER_SAT_SELECTOR_H/2,m=this.PICKER_SAT_SELECTOR_W/2;a=a.toHsv();k=Math.round(this.PICKER_HUE_H-a.h/360*this.PICKER_HUE_H)-k;m=Math.round(a.s/100*this.PICKER_SAT_VAL_W)-m;n=Math.round(this.PICKER_SAT_VAL_H-a.v/100*this.PICKER_SAT_VAL_H)-n;this.animatePoint?(e.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:k,left:0}).play(),e.slideTo({node:this.cursorNode,duration:this.slideDuration,top:n,left:m}).play()):(g.style(this.hueCursorNode,"top",k+"px"),
g.style(this.cursorNode,{left:m+"px",top:n+"px"}));a.h!=this._hue&&this._setHue(a.h)},_updateColorInputs:function(a){var e=a.toHex();this.showRgb&&(this.Rval.value=a.r,this.Gval.value=a.g,this.Bval.value=a.b);this.showHsv&&(a=a.toHsv(),this.Hval.value=Math.round(a.h),this.Sval.value=Math.round(a.s),this.Vval.value=Math.round(a.v));this.showHex&&(this.hexCode.value=e);this.previewNode.style.backgroundColor=e;this.webSafe&&(this.safePreviewNode.style.backgroundColor=e)},_setHuePoint:function(a){var k=
this.PICKER_HUE_SELECTOR_H/2;a=a.layerY||a.y-a.target.getBoundingClientRect().top;a-=k;this.animatePoint?e.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:a,left:0,onEnd:y.hitch(this,function(){this._updateColor(!0);z.focus(this.hueCursorNode)})}).play():(g.style(this.hueCursorNode,"top",a+"px"),this._updateColor(!0))},_setPoint:function(a){var k=this.PICKER_SAT_SELECTOR_H/2,n=this.PICKER_SAT_SELECTOR_W/2,m=a.layerY||a.y-a.target.getBoundingClientRect().top,m=m-k,k=a.layerX||a.x-
a.target.getBoundingClientRect().left,k=k-n;a&&z.focus(a.target);this.animatePoint?e.slideTo({node:this.cursorNode,duration:this.slideDuration,top:m,left:k,onEnd:y.hitch(this,function(){this._updateColor(!0);z.focus(this.cursorNode)})}).play():(g.style(this.cursorNode,{left:k+"px",top:m+"px"}),this._updateColor(!0))},_handleKey:function(a){},focus:function(){this.focused||z.focus(this.focusNode)},_stopDrag:function(a){n.stop(a)},destroy:function(){this.inherited(arguments);x.forEach(this._subs,function(a){w.unsubscribe(a)});
delete this._subs}})})},"dojox/color":function(){define(["./color/_base"],function(B){return B})},"dojox/color/_base":function(){define(["../main","dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(B,m,y,x){B=m.getObject("color",!0,B);B.Color=y;B.blend=y.blendColors;B.fromRgb=y.fromRgb;B.fromHex=y.fromHex;B.fromArray=y.fromArray;B.fromString=y.fromString;B.greyscale=x.makeGrey;m.mixin(B,{fromCmy:function(g,w,t){m.isArray(g)?(w=g[1],t=g[2],g=g[0]):m.isObject(g)&&(w=g.m,t=g.y,g=g.c);return new y({r:Math.round(255*
(1-g/100)),g:Math.round(255*(1-w/100)),b:Math.round(255*(1-t/100))})},fromCmyk:function(g,w,t,r){m.isArray(g)?(w=g[1],t=g[2],r=g[3],g=g[0]):m.isObject(g)&&(w=g.m,t=g.y,r=g.b,g=g.c);r/=100;return new y({r:Math.round(255*(1-Math.min(1,g/100*(1-r)+r))),g:Math.round(255*(1-Math.min(1,w/100*(1-r)+r))),b:Math.round(255*(1-Math.min(1,t/100*(1-r)+r)))})},fromHsl:function(g,w,t){m.isArray(g)?(w=g[1],t=g[2],g=g[0]):m.isObject(g)&&(w=g.s,t=g.l,g=g.h);w/=100;for(t/=100;0>g;)g+=360;for(;360<=g;)g-=360;var r,n;
120>g?(r=(120-g)/60,n=g/60,g=0):240>g?(r=0,n=(240-g)/60,g=(g-120)/60):(r=(g-240)/60,n=0,g=(360-g)/60);r=2*w*Math.min(r,1)+(1-w);n=2*w*Math.min(n,1)+(1-w);g=2*w*Math.min(g,1)+(1-w);.5>t?(r*=t,n*=t,g*=t):(r=(1-t)*r+2*t-1,n=(1-t)*n+2*t-1,g=(1-t)*g+2*t-1);return new y({r:Math.round(255*r),g:Math.round(255*n),b:Math.round(255*g)})}});B.fromHsv=function(g,w,t){m.isArray(g)?(w=g[1],t=g[2],g=g[0]):m.isObject(g)&&(w=g.s,t=g.v,g=g.h);360==g&&(g=0);w/=100;t/=100;var r,n,x;if(0==w)n=x=r=t;else{var a=g/60;g=Math.floor(a);
var k=a-g,a=t*(1-w),e=t*(1-w*k);w=t*(1-w*(1-k));switch(g){case 0:r=t;n=w;x=a;break;case 1:r=e;n=t;x=a;break;case 2:r=a;n=t;x=w;break;case 3:r=a;n=e;x=t;break;case 4:r=w;n=a;x=t;break;case 5:r=t,n=a,x=e}}return new y({r:Math.round(255*r),g:Math.round(255*n),b:Math.round(255*x)})};m.extend(y,{toCmy:function(){return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*(1-this.g/255)),y:Math.round(100*(1-this.b/255))}},toCmyk:function(){var g,m=this.r/255,t=this.g/255,r=this.b/255;g=Math.min(1-m,1-t,1-
r);return{c:Math.round((1-m-g)/(1-g)*100),m:Math.round((1-t-g)/(1-g)*100),y:Math.round((1-r-g)/(1-g)*100),b:Math.round(100*g)}},toHsl:function(){var g=this.r/255,m=this.g/255,t=this.b/255,r=Math.min(g,t,m),n=Math.max(g,m,t),x=n-r,a=0,k=0,r=(r+n)/2;0<r&&1>r&&(k=x/(.5>r?2*r:2-2*r));0<x&&(n==g&&n!=m&&(a+=(m-t)/x),n==m&&n!=t&&(a+=2+(t-g)/x),n==t&&n!=g&&(a+=4+(g-m)/x),a*=60);return{h:a,s:Math.round(100*k),l:Math.round(100*r)}},toHsv:function(){var g=this.r/255,m=this.g/255,t=this.b/255,r=Math.max(g,m,
t),n=r-Math.min(g,t,m),x=null,a=0==r?0:n/r;0==a?x=0:(x=g==r?60*(m-t)/n:m==r?120+60*(t-g)/n:240+60*(g-m)/n,0>x&&(x+=360));return{h:x,s:Math.round(100*a),v:Math.round(100*r)}}});return B})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(B,m,y,x){var g={};m.setObject("dojo.colors",g);var w=function(g,n,m){0>m&&++m;1<m&&--m;var a=6*m;return 1>a?g+(n-g)*a:1>2*m?n:2>3*m?g+(n-g)*(2/3-m)*6:g};B.colorFromRgb=y.fromRgb=function(g,n){var m=g.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);
if(m){g=m[2].split(/\s*,\s*/);var a=g.length,m=m[1];if("rgb"==m&&3==a||"rgba"==m&&4==a)return m=g[0],"%"==m.charAt(m.length-1)?(m=x.map(g,function(a){return 2.56*parseFloat(a)}),4==a&&(m[3]=g[3]),y.fromArray(m,n)):y.fromArray(g,n);if("hsl"==m&&3==a||"hsla"==m&&4==a){var m=(parseFloat(g[0])%360+360)%360/360,k=parseFloat(g[1])/100,e=parseFloat(g[2])/100,k=.5>=e?e*(k+1):e+k-e*k,e=2*e-k,m=[256*w(e,k,m+1/3),256*w(e,k,m),256*w(e,k,m-1/3),1];4==a&&(m[3]=g[3]);return y.fromArray(m,n)}}return null};var t=
function(g,n,m){g=Number(g);return isNaN(g)?m:g<n?n:g>m?m:g};y.prototype.sanitize=function(){this.r=Math.round(t(this.r,0,255));this.g=Math.round(t(this.g,0,255));this.b=Math.round(t(this.b,0,255));this.a=t(this.a,0,1);return this};g.makeGrey=y.makeGrey=function(g,n){return y.fromArray([g,g,g,n])};m.mixin(y.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,
226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,
150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],
hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,
136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],
navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,
87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return y})},"jimu/dijit/_Transparency":function(){define("dojo/_base/declare dojo/_base/config dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./templates/_Transparency.html dojo/_base/lang dojo/_base/html dojo/on dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dijit/form/HorizontalRule".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e){return B([y,x,g,w],{baseClass:"jimu-transparency",declaredClass:"jimu.dijit.Transparency",templateString:t,nls:null,_nls0:"0%",_nls50:"50%",_nls100:"100%",alpha:1,postMixInProperties:function(){this.nls=window.jimuNls.transparency;var a=m.locale||"",a=a.toLowerCase();"ar"===a?(this._nls0="\u066a0",this._nls50="\u066a50",this._nls100="\u066a100"):"tr"===a&&(this._nls0="%0",this._nls50="%50",this._nls100="%100")},postCreate:function(){this.inherited(arguments);"number"===
typeof this.alpha&&this.setAlpha(this.alpha)},setAlpha:function(a){this.opacitySlider.set("value",Math.round(100-100*a))},getAlpha:function(){return Math.round(100-this.opacitySlider.get("value"))/100},_onAlphaChanged:function(){var a=this.getAlpha();this.emit("change",a)}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K){var N=m("dijit.form._SliderMover",a,{onMouseMove:function(a){var e=this.widget,k=e._abspos;k||(k=e._abspos=g.position(e.sliderBarContainer,!0),e._setPixelValue_=r.hitch(e,"_setPixelValue"),e._isReversed_=e._isReversed());a=a[e._mousePixelCoord]-k[e._startingPixelCoord];e._setPixelValue_(e._isReversed_?k[e._pixelCount]-a:a,k[e._pixelCount],!1)},destroy:function(e){a.prototype.destroy.apply(this,arguments);var g=this.widget;g._abspos=null;g._setValueAttr(g.value,
!0)}});y=m("dijit.form.HorizontalSlider",[L,P],{templateString:K,value:0,showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:u.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",
_onKeyUp:function(a){this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey||this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey)){switch(a.keyCode){case t.HOME:this._setValueAttr(this.minimum,!1);break;case t.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?t.RIGHT_ARROW:t.LEFT_ARROW:case !1===this._descending?t.DOWN_ARROW:t.UP_ARROW:case !1===this._descending?t.PAGE_DOWN:t.PAGE_UP:this.increment(a);
break;case this._descending||this.isLeftToRight()?t.LEFT_ARROW:t.RIGHT_ARROW:case !1===this._descending?t.UP_ARROW:t.DOWN_ARROW:case !1===this._descending?t.PAGE_UP:t.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){this.disabled||this.readOnly||(n("ie")||z.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&
this.clickSelect){z.focus(this.sliderHandle);a.stopPropagation();a.preventDefault();var e=g.position(this.sliderBarContainer,!0),k=a[this._mousePixelCoord]-e[this._startingPixelCoord];this._setPixelValue(this._isReversed()?e[this._pixelCount]-k:k,e[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,e,g){if(!this.disabled&&!this.readOnly){var k=this.discreteValues;if(1>=k||Infinity==k)k=e;k--;this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*Math.round(a/
(e/k))/k+this.minimum,this.maximum),this.minimum),g)}},_setValueAttr:function(a,e){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var g=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,k=!1===this._descending?this.remainingBar:this.progressBar,n=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(e&&0<this.slideDuration&&
k.style[this._progressPixelSize]){var m=this,p={},r=parseFloat(k.style[this._progressPixelSize]),u=this.slideDuration*(g-r/100);0!=u&&(0>u&&(u=0-u),p[this._progressPixelSize]={start:r,end:100*g,units:"%"},this._inProgressAnim=x.animateProperty({node:k,duration:u,onAnimate:function(a){n.style[m._progressPixelSize]=100-parseFloat(a[m._progressPixelSize])+"%"},onEnd:function(){delete m._inProgressAnim},properties:p}),this._inProgressAnim.play())}else k.style[this._progressPixelSize]=100*g+"%",n.style[this._progressPixelSize]=
100*(1-g)+"%"},_bumpValue:function(a,e){if(!(this.disabled||this.readOnly||this.maximum<=this.minimum)){var k=w.getComputedStyle(this.sliderBarContainer),n=g.getContentBox(this.sliderBarContainer,k),k=this.discreteValues;if(1>=k||Infinity==k)k=n[this._pixelCount];k--;a=Math.round((this.value-this.minimum)*k/(this.maximum-this.minimum))+a;0>a&&(a=0);a>k&&(a=k);a=a*(this.maximum-this.minimum)/k+this.minimum;this._setValueAttr(a,e)}},_onClkBumper:function(a){this.disabled||this.readOnly||!this.clickSelect||
this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==t.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==t.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){this.focused&&(a.stopPropagation(),a.preventDefault(),this._bumpValue(0>a.wheelDelta?-1:1,!0))},
startup:function(){this._started||(B.forEach(this.getChildren(),function(a){this[a.container]!=this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,e,g){if(-1==a)this._setValueAttr(this.value,!0);else this[e==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](g)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display=
"");var a=k('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.focusNode.setAttribute("aria-labelledby",a[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(M.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),M.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(p(this.domNode,
e.wheel,r.hitch(this,"_mouseWheeled")));var a=m(N,{widget:this});this._movable=new A(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});y._Mover=N;return y})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(B,m,y,x,g,w){B=B("dijit.form.HorizontalRuleLabels",
w,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(g){return g},_genHTML:function(g,m){m=
this.labels[m];return this._positionPrefix+this._calcPosition(g)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(m)+this._labelPrefix+m+this._suffix},_genDirectionHTML:function(g){return""},getLabels:function(){var g=this.labels;!g.length&&this.srcNodeRef&&(g=x("\x3e li",this.srcNodeRef).map(function(a){return String(a.innerHTML)}));if(!g.length&&1<this.count)for(var g=[],m=this.minimum,n=(this.maximum-m)/(this.count-1),w=0;w<this.count;w++)g.push(w<this.numericMargin||w>=this.count-this.numericMargin?
"":y.format(m,this.constraints)),m+=n;return g},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length}});m("dojo-bidi")&&B.extend({_setTextDirAttr:function(m){this.textDir!=m&&(this._set("textDir",m),x(".dijitRuleLabelContainer",this.domNode).forEach(g.hitch(this,function(g){g.style.direction=this.getTextDir(g.innerText||g.textContent||"")})))},_genDirectionHTML:function(g){return this.textDir?"direction:"+this.getTextDir(g)+";":""}});
return B})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(B,m,y){return B("dijit.form.HorizontalRule",[m,y],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(m){return this._positionPrefix+m+this._positionSuffix+
this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var m;if(1==this.count)m=this._genHTML(50,0);else{var g,w=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){m=this._genHTML(0,0);for(g=1;g<this.count-1;g++)m+=this._genHTML(w*g,g);m+=this._genHTML(100,this.count-1)}else{m=this._genHTML(100,0);for(g=1;g<this.count-1;g++)m+=this._genHTML(100-w*g,g);m+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=m}})})},"dijit/form/NumberSpinner":function(){define(["dojo/_base/declare",
"dojo/keys","./_Spinner","./NumberTextBox"],function(B,m,y,x){return B("dijit.form.NumberSpinner",[y,x.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(g,m){var t=this.constraints,r=isNaN(g),n=!isNaN(t.max),w=!isNaN(t.min);r&&0!=m&&(g=0<m?w?t.min:n?t.max:0:n?this.constraints.max:w?t.min:0);m=g+m;if(r||isNaN(m))return g;n&&m>t.max&&(m=t.max);w&&m<t.min&&(m=t.min);return m},_onKeyDown:function(g){if(!(this.disabled||this.readOnly||g.keyCode!=m.HOME&&g.keyCode!=m.END||
g.ctrlKey||g.altKey||g.metaKey||"undefined"==typeof this.get("value"))){var w=this.constraints[g.keyCode==m.HOME?"min":"max"];"number"==typeof w&&this._setValueAttr(w,!1);g.stopPropagation();g.preventDefault()}}})})},"dijit/form/_Spinner":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),function(B,m,y,x,g,w,t,r,n,A){return B("dijit.form._Spinner",r,{defaultTimeout:500,
minimumTimeout:10,timeoutChangeRate:.9,smallDelta:1,largeDelta:10,templateString:n,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{upArrowNode:"dijitUpArrowButton",downArrowNode:"dijitDownArrowButton"},adjust:function(a){return a},_arrowPressed:function(a,g,e){this.disabled||this.readOnly||(this._setValueAttr(this.adjust(this.get("value"),g*e),!1),A.selectInputText(this.textbox,this.textbox.value.length))},_arrowReleased:function(){this._wheelTimer=null},_typematicCallback:function(a,g,e){var k=
this.smallDelta;g==this.textbox&&(g=e.keyCode,k=g==m.PAGE_UP||g==m.PAGE_DOWN?this.largeDelta:this.smallDelta,g=g==m.UP_ARROW||g==m.PAGE_UP?this.upArrowNode:this.downArrowNode);-1==a?this._arrowReleased(g):this._arrowPressed(g,g==this.upArrowNode?1:-1,k)},_wheelTimer:null,_mouseWheeled:function(a){if(this.focused){a.stopPropagation();a.preventDefault();var g=a.wheelDelta/120;Math.floor(g)!=g&&(g=0<a.wheelDelta?1:-1);a=a.detail?-1*a.detail:g;if(0!==a){var e=this[0<a?"upArrowNode":"downArrowNode"];this._arrowPressed(e,
a,this.smallDelta);this._wheelTimer&&this._wheelTimer.remove();this._wheelTimer=this.defer(function(){this._arrowReleased(e)},50)}}},_setConstraintsAttr:function(a){this.inherited(arguments);this.focusNode&&(void 0!==this.constraints.min?this.focusNode.setAttribute("aria-valuemin",this.constraints.min):this.focusNode.removeAttribute("aria-valuemin"),void 0!==this.constraints.max?this.focusNode.setAttribute("aria-valuemax",this.constraints.max):this.focusNode.removeAttribute("aria-valuemax"))},_setValueAttr:function(a,
g){this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(w(this.domNode,g.wheel,y.hitch(this,"_mouseWheeled")),t.addListener(this.upArrowNode,this.textbox,{keyCode:m.UP_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),t.addListener(this.downArrowNode,this.textbox,{keyCode:m.DOWN_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,
"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),t.addListener(this.upArrowNode,this.textbox,{keyCode:m.PAGE_UP,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),t.addListener(this.downArrowNode,this.textbox,{keyCode:m.PAGE_DOWN,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout))}})})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare",
"dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(B,m,y){return B("dijit.form.RangeBoundTextBox",y,{rangeMessage:"",rangeCheck:function(m,g){return("min"in g?0<=this.compare(m,g.min):!0)&&("max"in g?0>=this.compare(m,g.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var m=this.get("value");if(null==m)return!1;var g=!1;"min"in this.constraints&&(g=this.constraints.min,g=0>this.compare(m,"number"==typeof g&&
0<=g&&0!=m?0:g));!g&&"max"in this.constraints&&(g=this.constraints.max,g=0<this.compare(m,"number"!=typeof g||0<g?g:0));return g},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(m){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(m))},getErrorMessage:function(m){var g=this.get("value");return null==g||""===g||"number"==typeof g&&isNaN(g)||this.isInRange(m)?this.inherited(arguments):this.rangeMessage},
postMixInProperties:function(){this.inherited(arguments);this.rangeMessage||(this.messages=m.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),function(B,m,y,x,g,w){var t=function(g){g=g||{};var n=y.getLocalization("dojo.cldr","number",y.normalizeLocale(g.locale)),a=g.pattern?g.pattern:n[(g.type||"decimal")+
"Format"];g="number"==typeof g.places?g.places:"string"===typeof g.places&&0<g.places.length?g.places.replace(/.*,/,""):-1!=a.indexOf(".")?a.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:n.decimal,places:g}},r=B("dijit.form.NumberTextBoxMixin",null,{pattern:function(g){return"("+(this.focused&&this.editOptions?this._regExpGenerator(m.delegate(g,this.editOptions))+"|":"")+this._regExpGenerator(g)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:g.format,_regExpGenerator:g.regexp,
_decimalInfo:t(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(g){var n="number"==typeof g.places?g.places:0;n&&n++;"number"!=typeof g.max&&(g.max=9*Math.pow(10,15-n));"number"!=typeof g.min&&(g.min=-9*Math.pow(10,15-n));this.inherited(arguments,[g]);this.focusNode&&this.focusNode.value&&!isNaN(this.value)&&this.set("value",this.value);this._decimalInfo=t(g)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var g=this.get("value");
"number"!=typeof g||isNaN(g)||(g=this.format(g,this.constraints),void 0!==g&&(this.textbox.value=g));this.inherited(arguments)}},format:function(g,r){var a=String(g);if("number"!=typeof g)return a;if(isNaN(g))return"";if(!("rangeCheck"in this&&this.rangeCheck(g,r))&&!1!==r.exponent&&/\de[-+]?\d/i.test(a))return a;this.editOptions&&this.focused&&(r=m.mixin({},r,this.editOptions));return this._formatter(g,r)},_parser:g.parse,parse:function(g,r){var a=m.mixin({},r,this.editOptions&&this.focused?this.editOptions:
{});if(this.focused&&null!=a.places){var k=a.places,k="number"===typeof k?k:Number(k.split(",").pop());a.places="0,"+k}a=this._parser(g,a);this.editOptions&&this.focused&&isNaN(a)&&(a=this._parser(g,r));return a},_getDisplayedValueAttr:function(){var g=this.inherited(arguments);return isNaN(g)?this.textbox.value:g},filter:function(n){if(null==n||"string"==typeof n&&""==n)return NaN;"number"!=typeof n||isNaN(n)||0==n||(n=g.round(n,this._decimalInfo.places));return this.inherited(arguments,[n])},serialize:function(g,
m){return"number"!=typeof g||isNaN(g)?"":this.inherited(arguments)},_setBlurValue:function(){var g=m.hitch(m.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(g,!0)},_setValueAttr:function(g,m,a){if(void 0!==g&&void 0===a)if(a=String(g),"number"==typeof g)if(isNaN(g))a="";else{if("rangeCheck"in this&&this.rangeCheck(g,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(a))a=void 0}else g?g=void 0:(a="",g=NaN);this.inherited(arguments,[g,m,a])},_getValueAttr:function(){var n=
this.inherited(arguments);if(isNaN(n)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+g._realNumberRegexp(m.delegate(this.constraints))+"$")).test(this.textbox.value))return n=Number(this.textbox.value),isNaN(n)?void 0:n}else return n},isValid:function(g){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var n=this.get("value");return!isNaN(n)&&this.rangeCheck(n,this.constraints)?!1!==this.constraints.exponent&&
/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var g="number"==typeof this.constraints.min,m="number"==typeof this.constraints.max,a=this.get("value");if(isNaN(a)||!g&&!m)return this.inherited(arguments);var k=a|0,e=0>a,p=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),r=(this.maxLength||20)-this.textbox.value.length,t=p?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",k=p?k+"."+t:k+"",r=x.rep("9",r),p=a;e?p=Number(k+
r):a=Number(k+r);return!(g&&a<this.constraints.min||m&&p>this.constraints.max)}});B=B("dijit.form.NumberTextBox",[w,r],{baseClass:"dijitTextBox dijitNumberTextBox"});B.Mixin=r;return B})},"jimu/dijit/ServiceURLInput":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Deferred dojo/aspect esri/request dijit/form/ValidationTextBox".split(" "),function(B,m,y,x,g,w,t,r){return B([r],{_validatingNode:null,_validNode:null,_inValidNode:null,_fetchHandle:null,_fetchErrHandle:null,
declaredClass:"jimu.dijit.ServiceURLInput",verify:!0,_status:null,postCreate:function(){this.inherited(arguments);this._validatingNode=m.create("div",{"class":"jimu-service-validating"},this.domNode);this._validNode=m.create("div",{"class":"jimu-service-valid"},this.domNode);this._inValidNode=m.create("div",{"class":"jimu-service-invalid jimu-icon jimu-icon-error"},this.domNode);m.addClass(this.domNode,"jimu-serviceurl-input");this.verify&&this.own(x(this,"Change",y.hitch(this,"_onServiceUrlChange")))},
setProcessFunction:function(g,m){this._fetchHandle&&this._fetchErrHandle&&this._removeProcessFunction();"function"===typeof g&&(this._fetchHandle=w.after(this,"onFetch",g),this.own(this._fetchHandle));"function"===typeof m&&(this._fetchErrHandle=w.after(this,"onFetchError",m),this.own(this._fetchErrHandle))},_removeProcessFunction:function(){this._fetchHandle&&this._fetchHandle.remove&&(this._fetchHandle.remove(),this._fetchHandle=null);this._fetchErrHandle&&this._fetchErrHandle.remove&&(this._fetchErrHandle.remove(),
this._fetchErrHandle=null)},onFetch:function(g){return g},onFetchError:function(g){},getStatus:function(){return this._status},_onServiceUrlChange:function(n){var m=new g;m.then(y.hitch(this,function(){this._valid()}),y.hitch(this,function(){this._inValid();this.onFetchError()}));this._validating();n?t({url:y.trim(n||""),handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(y.hitch(this,function(a){this.onFetch({url:this.getValue(),data:a})?m.resolve("success"):m.reject("error")}),
y.hitch(this,function(a){m.reject(a)})):m.reject("error")},_validating:function(){this._status="validating";m.removeClass(this.domNode,"jimu-serviceurl-input-invalid");m.removeClass(this.domNode,"jimu-serviceurl-input-valid");m.addClass(this.domNode,"jimu-serviceurl-input-validating")},_valid:function(){this._status="valid";m.removeClass(this.domNode,"jimu-serviceurl-input-invalid");m.removeClass(this.domNode,"jimu-serviceurl-input-validating");m.addClass(this.domNode,"jimu-serviceurl-input-valid")},
_inValid:function(){this._status="invalid";m.removeClass(this.domNode,"jimu-serviceurl-input-validating");m.removeClass(this.domNode,"jimu-serviceurl-input-valid");m.addClass(this.domNode,"jimu-serviceurl-input-invalid")}})})},"jimu/dijit/SimpleTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dijit/registry jimu/utils jimu/dijit/CheckBox dijit/form/Select".split(" "),function(B,m,y,
x,g,w,t,r,n,A,a,k,e){return B([m,y,x],{baseClass:"jimu-simple-table",declaredClass:"jimu.dijit.SimpleTable",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"headDiv"\x3e\x3cdiv class\x3d"table-div" data-dojo-attach-point\x3d"headTableDiv"\x3e\x3ctable class\x3d"table" cellspacing\x3d"0" data-dojo-attach-point\x3d"tableInHeadSection"\x3e\x3ccolgroup data-dojo-attach-point\x3d"headColgroup"\x3e\x3c/colgroup\x3e\x3cthead class\x3d"simple-table-thead simple-table-title"  data-dojo-attach-point\x3d"thead"\x3e\x3c/thead\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"body-section" data-dojo-attach-point\x3d"bodyDiv"\x3e\x3cdiv class\x3d"table-div" data-dojo-attach-point\x3d"bodyTableDiv"\x3e\x3ctable class\x3d"table" cellspacing\x3d"0"data-dojo-attach-point\x3d"tableInBodySection"\x3e\x3ccolgroup data-dojo-attach-point\x3d"bodyColgroup"\x3e\x3c/colgroup\x3e\x3ctbody class\x3d"simple-table-tbody" data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
_name:null,_rowIndex:0,_rowHeight:30,_headHeight:36,REPEATING_ERROR:"REPEATING_ERROR",_classSimpleTableRow:"simple-table-row",_classFirstSimpleTableRow:"first-simple-table-row",_classLastSimpleTableRow:"last-simple-table-row",_classJimuStateDisabled:"jimu-state-disabled",_classRowUpDiv:"row-up-div",_classRowDownDiv:"row-down-div",_classVerticalScroll:"vertical-scroll",autoHeight:!0,selectable:!1,fields:null,singleClickEdit:!1,postMixInProperties:function(){this.nls=window.jimuNls.simpleTable},postCreate:function(){this.inherited(arguments);
this._initSelf()},startup:function(){this.inherited(arguments);this.updateUI()},_initSelf:function(){this.own(a.bindClickAndDblclickEvents(this.tableInBodySection,g.hitch(this,function(e){if(e=a.getAncestorDom(e.target||e.srcElement,function(a){return w.hasClass(a,"simple-table-row")&&w.hasClass(a,"not-empty")},this.tbody))this.selectRow(e),this._onClickRow(e)}),g.hitch(this,function(e){if(e=a.getAncestorDom(e.target||e.srcElement,function(a){return w.hasClass(a,"simple-table-row")&&w.hasClass(a,
"not-empty")},this.tbody))this.selectRow(e),this._onDblClickRow(e)})));var e=Math.random().toString();this._name="jimu_table_"+e.slice(2,e.length);if(this.fields&&0<this.fields.length){var m=w.create("tr",{},this.thead);t.forEach(this.fields,g.hitch(this,function(a){var e="auto";"actions"===a.type&&(a.name="actions");a.hidden?e=1:void 0!==a.width&&null!==a.width?e=a.width:"actions"!==a.type||a.name||(a.width=this._calculateActionsWidth(a)+20,e=a.width);w.create("col",{width:e},this.headColgroup);
w.create("col",{width:e},this.bodyColgroup);e=w.create("th",{innerHTML:a.title,title:a.title},m);if("checkbox"===a.type){e.innerHTML="";var p=new k({label:a.title}),u=n(".checkbox",p.domNode)[0];u&&(u.style.marginTop="10px");this.own(r(p.domNode,"click",g.hitch(this,function(){p.getValue()?this._checkAllTdCheckBoxes(a.name):this._uncheckAllTdCheckBoxes(a.name)})));p.placeAt(e)}w.addClass(e,"simple-table-field");a.hidden&&w.addClass(e,"hidden-column");a["class"]&&w.addClass(e,a["class"]);w.addClass(e,
a.name)}))}else this.fields=null},_getThCheckBox:function(a){var e=null;a=n(".simple-table-field."+a+" .jimu-checkbox",this.thead)[0];return e=A.byNode(a)},_getAllEnabledTdCheckBoxes:function(a){a=n(".simple-table-cell."+a+" .jimu-checkbox",this.tbody);a=t.map(a,function(a){return A.byNode(a)});return a=t.filter(a,function(a){return a.getStatus()})},_checkAllTdCheckBoxes:function(a){a=this._getAllEnabledTdCheckBoxes(a);t.forEach(a,function(a){a.getValue()||a.setValue(!0)})},_uncheckAllTdCheckBoxes:function(a){a=
this._getAllEnabledTdCheckBoxes(a);t.forEach(a,function(a){a.getValue()&&a.setValue(!1)})},_delaySyncThCheckBoxStatusWithAllTdCheckBoxes:function(a){setTimeout(g.hitch(this,function(){this._syncThCheckBoxStatusWithAllTdCheckBoxes(a)}),100)},_syncThCheckBoxStatusWithAllTdCheckBoxes:function(a){var e=this._getAllEnabledTdCheckBoxes(a),e=t.filter(e,g.hitch(this,function(a){return a.getStatus()}));0!==e.length&&(a=this._getThCheckBox(a),t.every(e,function(a){return a.getValue()})?a.getValue()||a.setValue(!0):
a.getValue()&&a.setValue(!1))},clear:function(){var a=this._getNotEmptyRows(),e=t.map(a,g.hitch(this,function(a){return this.getRowData(a)}));w.empty(this.tbody);t.forEach(a,g.hitch(this,function(a,g){this._onDeleteRow(a,e[g])}));this.updateUI();this._rowIndex=0;this._onClearRows(a)},addRows:function(a){var e=[];this.fields&&a&&0<a.length&&t.forEach(a,g.hitch(this,function(a){e.push(this.addRow(a,-1,!0))}));this.updateUI();return e},addRow:function(a,e,k){this._rowIndex++;var n={success:!1,tr:null,
errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof a)return n;var m=t.filter(this.fields,g.hitch(this,function(a){return"text"===a.type&&!0===a.unique})),m=t.filter(m,g.hitch(this,function(e){return 0<this.getRowDataArrayByFieldValue(e.name,a[e.name]).length}));if(0<m.length)return n.errorCode=this.REPEATING_ERROR,n.errorMessage="repeating data",n.repeatFields=m,n;var p=w.create("tr",{"class":"simple-table-row not-empty"},this.tbody);w.setAttr(p,"rowId","row"+this._rowIndex);
t.forEach(this.fields,g.hitch(this,function(e){var g=a[e.name],k=e.type,n=null;"actions"===k?n=this._createActionsTd(p,e):("text"===k?n=this._createTextTd(p,e,g):"radio"===k?n=this._createRadioTd(p,e,g):"checkbox"===k?n=this._createCheckboxTd(p,e,g):"empty"===k?n=this._createEmptyTd(p,e):"extension"===k?n=this._createExtensionTd(p,e,g):"dropdown"===k&&(n=this._createDropdownTd(p,e,g)),e.hidden&&w.addClass(n,"hidden-column"))}));k||(this.updateUI(),k=this.getRows(),"number"===typeof e&&0<=e&&e<k.length&&
w.place(p,k[e],"before"));n.success=!0;n.tr=p;n.errorMessage=null;this._onAddRow(p);return n},deleteRow:function(a){if(a){var e=this.getRowData(a);w.destroy(a);this.updateUI();this._onDeleteRow(a,e)}},selectRow:function(a){this.selectable&&(n(".simple-table-row",this.tbody).removeClass("jimu-state-active"),w.addClass(a,"jimu-state-active"),this._onSelectRow(a))},updateUI:function(){this._updateRowClassName();this._updateHeight();w.removeClass(this.domNode,this._classVerticalScroll);0<this.bodyDiv.clientHeight&&
this.bodyDiv.clientHeight<this.bodyDiv.scrollHeight&&w.addClass(this.domNode,this._classVerticalScroll);t.forEach(this.fields,g.hitch(this,function(a){"checkbox"===a.type&&this._delaySyncThCheckBoxStatusWithAllTdCheckBoxes(a.name)}))},_updateHeadTableWidth:function(){if(this.domNode){var a=w.getContentBox(this.tableInBodySection).w,e="100%";"number"===typeof a&&0<a&&(e=a+"px");w.setStyle(this.tableInHeadSection,"width",e)}},_updateHeight:function(){var a=this.getRows();this.autoHeight&&w.setStyle(this.domNode,
"height",this._headHeight+this._rowHeight*(0<a.length?a.length:1)+1+"px");a&&0<a.length&&this.bodyTableDiv&&(a=w.getMarginSize(a[0]))&&a.h&&w.setStyle(this.bodyTableDiv,"backgroundSize","1px "+a.h+"px")},_updateRowClassName:function(){var a=n("."+this._classFirstSimpleTableRow,this.tbody)[0];a&&(a=n("."+this._classRowUpDiv,a)[0])&&w.removeClass(a,this._classJimuStateDisabled);(a=n("."+this._classLastSimpleTableRow,this.tbody)[0])&&(a=n("."+this._classRowDownDiv,a)[0])&&w.removeClass(a,this._classJimuStateDisabled);
a=n("."+this._classSimpleTableRow,this.tbody);a.removeClass("odd");a.removeClass("even");a.removeClass(this._classFirstSimpleTableRow);a.removeClass(this._classLastSimpleTableRow);t.forEach(a,g.hitch(this,function(a,e){0===e%2?w.addClass(a,"odd"):w.addClass(a,"even")}));if(0<a.length){var e=a[0];w.addClass(e,this._classFirstSimpleTableRow);(e=n("."+this._classRowUpDiv,e)[0])&&w.addClass(e,this._classJimuStateDisabled);a=a[a.length-1];w.addClass(a,this._classLastSimpleTableRow);(a=n("."+this._classRowDownDiv,
a)[0])&&w.addClass(a,this._classJimuStateDisabled)}},_createTextTd:function(a,e,g){var k=null;return k=e.editable?this._createEditableTextTd(a,e,g):this._createNormalTextTd(a,e,g)},_createNormalTextTd:function(a,e,g){var k=w.toDom('\x3ctd class\x3d"simple-table-cell normal-text-td"\x3e\x3cdiv class\x3d"normal-text-div"\x3e\x3c/div\x3e\x3c/td\x3e');w.addClass(k,e.name);var m=n("div",k)[0];m.innerHTML=g||"";m.title=g||"";e["class"]&&w.addClass(k,e["class"]);w.place(k,a);return k},_createEditableTextTd:function(a,
e,k){var m=w.toDom('\x3ctd class\x3d"editable-text-td '+e.name+'"\x3e\x3cdiv class\x3d"editable-div"\x3e\x3c/div\x3e\x3cinput class\x3d"editable-input" type\x3d"text" style\x3d"display:none;" /\x3e\x3c/td\x3e');w.addClass(m,"simple-table-cell");w.place(m,a);e["class"]&&w.addClass(m,e["class"]);var p=n("div",m)[0],t=n("input",m)[0];p.innerHTML=k||"";""!==p.innerHTML&&(p.title=p.innerText||p.innerHTML);t.value=p.innerHTML;this.own(r(p,this.singleClickEdit?"click":"dblclick",g.hitch(this,function(a){this.singleClickEdit||
a.stopPropagation();t.value=p.innerText||p.innerHTML;w.setStyle(p,"display","none");w.setStyle(t,"display","inline");t.focus();t.select&&t.select()})));this.own(r(t,"blur",g.hitch(this,function(){t.value=g.trim(t.value);var k=p.innerText||p.innerHTML,n=t.value;""!==n?e.unique?0<this.getRowDataArrayByFieldValue(e.name,n,a).length?t.value=k:p.innerHTML=n:p.innerHTML=n:t.value=k;w.setStyle(t,"display","none");w.setStyle(p,"display","block")})));return m},_createRadioTd:function(a,e,g){var k=w.toDom('\x3ctd class\x3d"radio-td '+
e.name+'"\x3e\x3cinput class\x3d"jimu-radio-btn" type\x3d"radio" /\x3e\x3c/td\x3e');w.addClass(k,"simple-table-cell");w.place(k,a);e["class"]&&w.addClass(k,e["class"]);a=n("input",k)[0];a.name=e.radio&&"row"===e.radio?this._name+this._rowIndex:this._name+e.name;a.checked=!0===g;return k},_createCheckboxTd:function(a,e,n){var m=w.toDom('\x3ctd class\x3d"checkbox-td '+e.name+'"\x3e\x3c/td\x3e');w.addClass(m,"simple-table-cell");w.place(m,a);e["class"]&&w.addClass(m,e["class"]);var p=new k({onChange:g.hitch(this,
function(){this._delaySyncThCheckBoxStatusWithAllTdCheckBoxes(e.name);"function"===typeof e.onChange&&setTimeout(g.hitch(this,function(){e.onChange(a,p)}),200)})});this.own(r(p,"status-change",g.hitch(this,function(){this._delaySyncThCheckBoxStatusWithAllTdCheckBoxes(e.name)})));this._setValueForCheckBox(p,n);p.placeAt(m);return m},_createActionsTd:function(a,e){var k=w.toDom('\x3ctd class\x3d"actions-td"\x3e\x3cdiv class\x3d"action-item-parent jimu-float-leading"\x3e\x3c/div\x3e\x3c/td\x3e');w.addClass(k,
"simple-table-cell");var m=n(".action-item-parent",k)[0];w.place(k,a);e["class"]&&w.addClass(k,e["class"]);t.forEach(e.actions,g.hitch(this,function(e){"up"===e?(e=w.create("div",{"class":"action-item jimu-float-leading row-up-div jimu-icon jimu-icon-up"},m),e.title=this.nls.moveUp,this.own(r(e,"click",g.hitch(this,function(e){e.stopPropagation();if(this.onBeforeRowUp(a)){e=n(".simple-table-row",this.tbody);var g=t.indexOf(e,a);0<g&&(e=e[g-1])&&(w.place(a,e,"before"),this.updateUI(),this.emit("row-up",
a))}})))):"down"===e?(e=w.create("div",{"class":"action-item jimu-float-leading row-down-div jimu-icon jimu-icon-down"},m),e.title=this.nls.moveDown,this.own(r(e,"click",g.hitch(this,function(e){e.stopPropagation();if(this.onBeforeRowDown(a)){e=n(".simple-table-row",this.tbody);var g=t.indexOf(e,a);g<e.length-1&&(e=e[g+1])&&(w.place(a,e,"after"),this.updateUI(),this.emit("row-down",a))}})))):"edit"===e?(e=w.create("div",{"class":"action-item jimu-float-leading row-edit-div jimu-icon jimu-icon-edit"},
m),e.title=this.nls.edit,this.own(r(e,"click",g.hitch(this,function(e){e.stopPropagation();this.onBeforeRowEdit(a)&&this._onActionsEdit(a)})))):"delete"===e&&(e=w.create("div",{"class":"action-item jimu-float-leading row-delete-div jimu-icon jimu-icon-delete"},m),e.title=this.nls.deleteRow,this.own(r(e,"click",g.hitch(this,function(e){e.stopPropagation();this.onBeforeRowDelete(a)&&this.deleteRow(a)}))))}));e=this._calculateActionsWidth(e)+"px";w.setStyle(m,"width",e);return k},_calculateActionsWidth:function(a){return 20*
t.map(a.actions,function(a){return"up"===a||"down"===a||"edit"===a||"delete"===a}).length},_createEmptyTd:function(a,e){a=w.create("td",{"class":e.name},a);w.addClass(a,"simple-table-cell");w.addClass(a,"empty-text-td");e["class"]&&w.addClass(a,e["class"]);return a},_createExtensionTd:function(a,e,g){a=w.create("td",{"class":e.name},a);w.addClass(a,"simple-table-cell");w.addClass(a,"extension-td");e["class"]&&w.addClass(a,e["class"]);e.create&&"function"===typeof e.create&&e.create(a);e.setValue&&
"function"===typeof e.setValue&&e.setValue(a,g);return a},_createDropdownTd:function(a,g,k){a=w.create("td",{"class":g.name},a);w.addClass(a,"simple-table-cell");w.addClass(a,"dropdown-td");g["class"]&&w.addClass(a,g["class"]);(new e({options:k})).placeAt(a);return a},editRow:function(a,e){var k={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof e||!w.isDescendant(a,this.tbody))return k;var m=g.mixin([],this.fields),m=t.filter(m,g.hitch(this,
function(a){return"text"===a.type&&!0===a.unique})),m=t.filter(m,g.hitch(this,function(g){return 0<this.getRowDataArrayByFieldValue(g.name,e[g.name],a).length}));if(0<m.length)return k.errorCode=this.REPEATING_ERROR,k.errorMessage="repeating data",k.repeatFields=m,k;var p=n(".simple-table-cell",a);t.forEach(this.fields,g.hitch(this,function(a,g){if(e.hasOwnProperty(a.name)){g=p[g];var k=e[a.name],n=a.type;"text"===n?a.editable?this._editEditableText(g,a,k):this._editNormalText(g,a,k):"radio"===n?
this._editRadio(g,a,k):"checkbox"===n?this._editCheckbox(g,a,k):"extension"===n?this._editExtension(g,a,k):"dropdown"===n&&this._editDropdown(g,a,k)}}));k.success=!0;k.tr=a;k.errorMessage=null;this._onEditRow(a);return k},_editNormalText:function(a,e,g){a=n("div",a)[0];a.innerHTML=g||"";a.title=a.innerHTML},_editEditableText:function(a,e,g){e=n("div",a)[0];e.innerHTML=g||"";n("input",a)[0].value=e.innerHTML},_editRadio:function(a,e,g){n("input",a)[0].checked=!0===g},_editCheckbox:function(a,e,g){a=
n(".jimu-checkbox",a)[0];a=A.byNode(a);this._setValueForCheckBox(a,g)},_setValueForCheckBox:function(a,e){null===e?a.setStatus(!1):(a.setStatus(!0),e!==a.getValue()&&a.setValue(e))},_editExtension:function(a,e,g){e.setValue&&"function"===typeof e.setValue&&e.setValue(a,g)},_editDropdown:function(a,e,g){a=n(".dijitSelect",a)[0];A.byNode(a).set("value",g)},_getAllRows:function(){return n(".simple-table-row",this.tbody)},_getNotEmptyRows:function(){var a=this._getAllRows();return t.filter(a,g.hitch(this,
function(a){return!w.hasClass(a,"empty")}))},_getEmptyRows:function(){var a=this._getAllRows();return t.filter(a,g.hitch(this,function(a){return w.hasClass(a,"empty")}))},getRows:function(){return this._getNotEmptyRows()},getSelectedRow:function(){var a=null,e=n(".simple-table-row",this.tbody),e=t.filter(e,g.hitch(this,function(a){return!w.hasClass(a,"empty")&&w.hasClass(a,"jimu-state-active")}));0<e.length&&(a=e[0]);return a},getSelectedRowData:function(){var a=null,e=this.getSelectedRow();e&&(a=
this._getRowDataByTr(e));return a},getData:function(a){var e=this._getNotEmptyRows();a&&(e=t.filter(e,g.hitch(this,function(e){return e!==a})));return t.map(e,g.hitch(this,function(a){return this._getRowDataByTr(a)}))},getRowData:function(a){return this._getRowDataByTr(a)},_getRowDataByTr:function(a){var e=null;if(a)e={};else return null;t.forEach(this.fields,g.hitch(this,function(g){var k=g.type;if("actions"!==k){var m=g.name;e[m]=null;var p=n(".simple-table-cell."+m,a)[0];p&&("text"===k?(g=n("div",
p)[0],e[m]=g.innerText||g.innerHTML):"radio"===k?(g=n("input",p)[0],e[m]=g.checked):"checkbox"===k?(g=n(".jimu-checkbox",p)[0],g=A.byNode(g),g.getStatus()?e[m]=g.getValue():e[m]=null):"extension"===k?g.getValue&&"function"===typeof g.getValue&&(e[m]=g.getValue(p,g)):"dropdown"===k&&(g=n(".dijitSelect",p)[0],g=A.byNode(g),e[m]=g.get("value")))}}));return e},getRowDataArrayByFieldValue:function(a,e,k){var n=[];if(!this.fields||!t.some(this.fields,g.hitch(this,function(e){return e.name===a})))return[];
k=this.getData(k);return n=t.filter(k,g.hitch(this,function(g){return g[a]==e}))},moveToTop:function(a){a&&a.parentNode===this.tbody&&w.place(a,this.tbody,"first")},_onClickRow:function(a){this.emit("row-click",a)},_onDblClickRow:function(a){this.emit("row-dblclick",a)},_onSelectRow:function(a){this.emit("row-select",a)},_onAddRow:function(a){this.emit("row-add",a)},_onEditRow:function(a){this.emit("row-edit",a)},_onDeleteRow:function(a,e){this.emit("row-delete",a,e)},_onEnterRow:function(a){this.emit("row-enter",
a)},_onClearRows:function(a){this.emit("rows-clear",a)},_onActionsEdit:function(a){this.emit("actions-edit",a)},onBeforeRowUp:function(a){return!0},onBeforeRowDown:function(a){return!0},onBeforeRowEdit:function(a){return!0},onBeforeRowDelete:function(a){return!0}})})},"jimu/dijit/TabContainer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin ./ViewStack ../utils".split(" "),function(B,m,y,x,g,w,t,r,
n,A){return B([t,r,w],{baseClass:"jimu-tab",declaredClass:"jimu.dijit.TabContainer",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"control" data-dojo-attach-point\x3d"controlNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e',postCreate:function(){this.inherited(arguments);if(0!==this.tabs.length){this.controlNodes=[];this.viewStack=new n(null,this.containerNode);var a=1/this.tabs.length*100;this.isNested&&x.addClass(this.domNode,
"nested");y.forEach(this.tabs,function(g){this._createTab(g,a)},this)}},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title);A.setVerticalCenter(this.domNode)},_createTab:function(a,k){k=x.create("div",{innerHTML:a.title,"class":"tab jimu-vcenter-text",style:{width:this.isNested?"auto":k+"%"},label:a.title},this.controlNode);this.viewStack.viewType=a.content.domNode?"dijit":"dom";a.content.label=a.title;this.viewStack.addView(a.content);
this.own(g(k,"click",m.hitch(this,this.onSelect,a.title)));k.label=a.title;this.controlNodes.push(k)},onSelect:function(a){this.selectTab(a)},selectTab:function(a){this._selectControl(a);this.viewStack.switchView(a);this.emit("tabChanged",a)},_selectControl:function(a){y.forEach(this.controlNodes,function(g){x.removeClass(g,"jimu-state-selected");g.label===a&&x.addClass(g,"jimu-state-selected")})}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html",
"dojo/_base/array","dijit/_WidgetBase"],function(B,m,y,x,g){return B(g,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);x.forEach(this.views,m.hitch(this,function(g){1===g.nodeType?(y.place(g,this.domNode),y.addClass(g,"view"),y.setStyle(g,"display","none")):g.domNode&&(y.place(g.domNode,this.domNode),y.addClass(g.domNode,"view"),y.setStyle(g.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);
0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var g="",m=this.getSelectedView();m&&(g=m.label);return g},getViewByLabel:function(g){for(var m=0;m<this.views.length;m++)if(g===this.views[m].label)return this.views[m];return null},addView:function(g){this.views.push(g);1===g.nodeType?(y.place(g,this.domNode),y.addClass(g,"view")):g.domNode&&(y.place(g.domNode,this.domNode),y.addClass(g.domNode,"view"))},removeView:function(g){var m=
this.views.length;this.views=x.filter(this.views,function(m){return g!==m});m!==this.views.length&&(1===g.nodeType?y.destroy(g):g.domNode&&g.destroyRecursive())},switchView:function(g){var t,r;t="number"===typeof g?this.views[g]:"string"===typeof g?this.getViewByLabel(g):g;this.views.forEach(m.hitch(this,function(g){if(g)if(1===g.nodeType?r=g:g.domNode&&(r=g.domNode),g===t){if(y.setStyle(r,"display","block"),g.domNode)if(!g._started)g.startup(),g._started=!0;else if("function"===typeof g.onShown)g.onShown()}else if(y.setStyle(r,
"display","none"),g.domNode&&"function"===typeof g.onHidden)g.onHidden()}));this._currentView=t;this.onViewSwitch(t)},onViewSwitch:function(){}})})},"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(B,m,y,x,g,w,t,r,n,A,a){return B([r,n,w],{templateString:A,baseClass:"jimu-tab3",declaredClass:"jimu.dijit.TabContainer3",
_currentIndex:-1,selected:"",tabs:null,average:!0,postCreate:function(){this.inherited(arguments);this._initSelf();this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(a){var e=t("td",this.tabTr);y.forEach(e,m.hitch(this,function(e,g){x.removeClass(e,"jimu-state-active");e.label===a&&(x.addClass(e,"jimu-state-active"),this._currentIndex=g)}));this.controlNode.removeChild(this.controlTable);x.place(this.controlTable,this.controlNode);
this.viewStack.switchView(a);this.emit("tabChanged",a)},addTab:function(a){if(!this.average){var e=t("td:last-child",this.tabTr);0<e.length&&x.destroy(e[0])}0<y.filter(this.tabs,function(e){return e.title===a.title}).length?console.error("tab title conflict: "+a.title):(this.tabs.push(a),this._createTab(a),this.average||(e=x.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'),x.place(e,this.tabTr)))},
removeTab:function(a){var e=-1;if(y.some(this.tabs,function(g,k){if(g.title===a)return e=k,!0})){var g=this.tabs.splice(e,1)[0],k=t("td",this.tabTr),n;y.some(k,function(e){if(e.label===a)return n=e,!0})&&x.destroy(n);this.viewStack.removeView(g.content)}},showShelter:function(){x.setStyle(this.shelter,"display","block")},hideShelter:function(){x.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},
_initSelf:function(){this.viewStack=new a(null,this.containerNode);y.forEach(this.tabs,function(a){this._createTab(a)},this);if(this.average)this.controlTable.style.tableLayout="fixed",x.addClass(this.domNode,"average");else{var g=x.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');x.place(g,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(a){var e=x.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');
e.label=a.title||"";e.title=a.title;x.place(e,this.tabTr);var k=t(".tab-item-div",e)[0];k.innerHTML=e.label;k.label=e.label;a.content.label=e.label;this.viewStack.addView(a.content);this.own(g(e,"click",m.hitch(this,this._onSelect,a.title)))},_onSelect:function(a){this.selectTab(a)}})})},"jimu/dijit/TileLayoutContainer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dijit/_WidgetBase"],function(B,m,y,x){return B([x],{baseClass:"jimu-tile-container",declaredClass:"jimu.dijit.TileLayoutContainer",
constructor:function(){this.items=[];this.vmargin=this.hmargin=15},startup:function(){this.inherited(arguments);this.items.forEach(m.hitch(this,function(g){this._placeItem(g)}));this.resize()},_placeItem:function(g){g.domNode?y.place(g.domNode,this.domNode):y.place(g,this.domNode)},addItem:function(g){this.items.push(g);this._placeItem(g);this.resize()},addItems:function(g){this.items=this.items.concat(g);this.items.forEach(m.hitch(this,function(g){this._placeItem(g)}));this.resize()},removeItem:function(g){var m;
for(m=0;m<this.items.length;m++)if(this.items[m].label===g){this.items[m].domNode?this.items[m].destroy():y.destroy(this.items[m]);this.items.splice(m,1);this.resize();break}},empty:function(){var g;for(g=0;g<this.items.length;g++)this.items[g].domNode?this.items[g].destroy():y.destroy(this.items[g]);this.items=[]},resize:function(){var g,w,t;g=y.getMarginBox(this.domNode);w=this.getItemSize(g);t=Math.floor((g.w+this.hmargin)/(w.width+this.hmargin));this.items.forEach(m.hitch(this,function(g,m){this.setItemPosition(g,
m,w,t)}))},getItemSize:function(g){var m={},t;if("fixWidth"===this.strategy)m.width=this.itemSize.width,m.height=this.itemSize.height;else if("breakWidth"===this.strategy)for(t=0;t<this.itemSize.length;t++){if(g.w<=this.itemSize[t].screenWidth){m.width=this.itemSize[t].width;m.height=this.itemSize[t].height;break}}else"fixCols"===this.strategy&&(m.width=(g.w-this.hmargin*(this.maxCols-1))/this.maxCols,m.height="number"===typeof this.itemSize.height?this.itemSize.height:m.width*parseFloat(this.itemSize.height.substring(0,
this.itemSize.height.length-1))/100);return m},setItemPosition:function(g,m,t,r){m++;var n=m%r;m=Math.ceil(m/r);0===n&&(n=r);r={position:"absolute",top:(this.vmargin+t.height)*(m-1)+"px"};r[window.isRTL?"right":"left"]=(this.hmargin+t.width)*(n-1)+"px";0<=t.width&&(r.width=t.width+"px");0<=t.height&&(r.height=t.height+"px");y.setStyle(g.domNode?g.domNode:g,r)}})})},"jimu/dijit/DrawBox":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DrawBox.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Evented esri/graphic esri/layers/GraphicsLayer esri/toolbars/draw esri/symbols/jsonUtils esri/geometry/Polygon".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z){var M={};return B([m,y,x,a],{templateString:g,baseClass:"jimu-draw-box",declaredClass:"jimu.dijit.DrawBox",nls:null,drawLayer:null,drawLayerId:null,drawToolBar:null,_isDisabled:!1,_shiftKey:!1,_ctrlKey:!1,_metaKey:!1,types:null,geoTypes:null,map:null,pointSymbol:null,polylineSymbol:null,polygonSymbol:null,textSymbol:null,showClear:!1,keepOneGraphic:!1,deactivateAfterDrawing:!0,postMixInProperties:function(){this.nls=window.jimuNls.drawBox},postCreate:function(){this.inherited(arguments);
var a={};this.drawLayerId&&(a.id=this.drawLayerId);this.drawLayer=new e(a);this._initDefaultSymbols();this._initTypes();a=A(".draw-item",this.domNode);this.own(a.on("click",w.hitch(this,this._onItemClick)));this.own(n(this.btnClear,"click",w.hitch(this,this._onClickClear)));this.own(n(document.body,"keydown",w.hitch(this,function(a){this._shiftKey=!!a.shiftKey;this._ctrlKey=!!a.ctrlKey;this._metaKey=!!a.metaKey})));this.own(n(document.body,"keyup",w.hitch(this,function(a){this._shiftKey=!!a.shiftKey;
this._ctrlKey=!!a.ctrlKey;this._metaKey=!!a.metaKey})));this.map&&this.setMap(this.map);t.setStyle(this.btnClear,"display",!0===this.showClear?"block":"none");this.enable();M[this.id]=this},enable:function(){this._isDisabled=!1;t.addClass(this.domNode,"enabled");t.removeClass(this.domNode,"disabled")},disable:function(){this._isDisabled=!0;t.addClass(this.domNode,"disabled");t.removeClass(this.domNode,"enabled");this.deactivate()},hideLayer:function(){this.drawLayer&&this.drawLayer.hide()},showLayer:function(){this.drawLayer&&
this.drawLayer.show()},isEnabled:function(){return!this._isDisabled},isActive:function(){var a=A(".draw-item.jimu-state-active",this.domNode);return a&&0<a.length},disableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!1)},enableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!0)},destroy:function(){this.deactivate();this.drawLayer&&this.map&&this.map.removeLayer(this.drawLayer);this.drawLayer=this.map=this.drawToolBar=null;delete M[this.id];this.inherited(arguments)},
setMap:function(a){a&&(this.map=a,this.map.addLayer(this.drawLayer),this.drawToolBar=new p(this.map),this.drawToolBar.setMarkerSymbol(this.pointSymbol),this.drawToolBar.setLineSymbol(this.polylineSymbol),this.drawToolBar.setFillSymbol(this.polygonSymbol),this.own(n(this.drawToolBar,"draw-end",w.hitch(this,this._onDrawEnd))))},setPointSymbol:function(a){this.pointSymbol=a;this.drawToolBar.setMarkerSymbol(this.pointSymbol)},setLineSymbol:function(a){this.polylineSymbol=a;this.drawToolBar.setLineSymbol(a)},
setPolygonSymbol:function(a){this.polygonSymbol=a;this.drawToolBar.setFillSymbol(a)},setTextSymbol:function(a){this.textSymbol=a},reset:function(){this.deactivate();this.clear()},clear:function(){this.drawLayer.clear();this.onClear()},deactivate:function(){this.enableWebMapPopup();A(".draw-item",this.domNode).removeClass("jimu-state-active");this.drawToolBar&&(this.drawToolBar.deactivate(),this.emit("draw-deactivate"))},activate:function(a){var e=null,g=A(".draw-item",this.domNode);"TEXT"===a?(a=
"POINT",e=this.textIcon):(g=g.filter(function(e){return e.getAttribute("data-geotype")===a}),0<g.length&&(e=g[0]));e&&this._activate(e)},onIconSelected:function(a,e,g){this.emit("icon-selected",a,e,g)},onDrawEnd:function(a,e,g,k,m,n){this.emit("draw-end",a,e,g,k,m,n)},onClear:function(){this.emit("clear")},addGraphic:function(a){this.keepOneGraphic&&this.drawLayer.clear();this.drawLayer.add(a)},removeGraphic:function(a){this.drawLayer.remove(a)},getFirstGraphic:function(){var a=null;this.drawLayer&&
0<this.drawLayer.graphics.length&&(a=this.drawLayer.graphics[0]);return a},show:function(){t.removeClass(this.domNode,"hidden")},hide:function(){t.addClass(this.domNode,"hidden")},getDrawItemIcons:function(){return A(".draw-item",this.domNode)},_onClickClear:function(){this._isDisabled||(this.clear(),this.emit("user-clear"))},_initDefaultSymbols:function(){var a={style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18},e={style:"esriSLSSolid",
color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"},g={style:"esriSFSSolid",color:[79,129,189,128],type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}};this.pointSymbol||(this.pointSymbol=u.fromJson(a));this.polylineSymbol||(this.polylineSymbol=u.fromJson(e));this.polygonSymbol||(this.polygonSymbol=u.fromJson(g))},_initTypes:function(){this.geoTypes&&0<this.geoTypes.length?this.types=null:(this.geoTypes=[],this.types&&0<this.types.length||(this.types=
["point","polyline","polygon"]),0<=this.types.indexOf("point")&&(this.geoTypes=this.geoTypes.concat(["POINT"])),0<=this.types.indexOf("polyline")&&(this.geoTypes=this.geoTypes.concat(["LINE","POLYLINE","FREEHAND_POLYLINE"])),0<=this.types.indexOf("polygon")&&(this.geoTypes=this.geoTypes.concat("TRIANGLE EXTENT CIRCLE ELLIPSE POLYGON FREEHAND_POLYGON".split(" "))),0<=this.types.indexOf("text")&&(this.geoTypes=this.geoTypes.concat(["TEXT"])));var a=A(".draw-item",this.domNode);a.style("display","none");
r.forEach(a,w.hitch(this,function(a){var e=a.getAttribute("data-geotype"),e=0<=r.indexOf(this.geoTypes,e);t.setStyle(a,"display",e?"block":"none")}))},_onItemClick:function(a){this._isDisabled||(a=a.target||a.srcElement,t.hasClass(a,"draw-item")&&(t.hasClass(a,"jimu-state-active")?this.deactivate():this._activate(a)))},_activate:function(a){this._deactiveAllDrawBoxes();A(".draw-item",this.domNode).removeClass("jimu-state-active");t.addClass(a,"jimu-state-active");var e=a.getAttribute("data-geotype"),
g=a.getAttribute("data-commontype"),k=p[e];"TEXT"===e&&(k=p.POINT);this.disableWebMapPopup();this.drawToolBar.activate(k);this.emit("draw-activate",k);this.onIconSelected(a,e,g)},_onDrawEnd:function(a){var e=A(".draw-item.jimu-state-active",this.domNode)[0],g=e.getAttribute("data-geotype"),e=e.getAttribute("data-commontype"),m=null,m="extent"===a.geometry.type?z.fromExtent(a.geometry):a.geometry;m.geoType=g;m.commonType=e;a=m.type;var n=null,n="point"===a||"multipoint"===a?t.hasClass(this.textIcon,
"jimu-state-active")?this.textSymbol:this.pointSymbol:"line"===a||"polyline"===a?this.polylineSymbol:this.polygonSymbol,m=new k(m,n,null,null);this.keepOneGraphic&&this.drawLayer.clear();this.drawLayer.add(m);this.deactivateAfterDrawing&&this.deactivate();this.onDrawEnd(m,g,e,this._shiftKey,this._ctrlKey,this._metaKey)},_deactiveAllDrawBoxes:function(){var a;r.forEach(Object.keys(M),w.hitch(this,function(e){(a=M[e])&&a.drawToolBar&&e!==this.id&&a.deactivate()}))}})})},"esri/toolbars/draw":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/window dojo/has dojo/sniff dojo/keys dojo/dom-construct dojo/dom-style dojo/dom-geometry ../kernel ../sniff ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../geometry/jsonUtils ../geometry/webMercatorUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/Rect dojo/i18n!../nls/jsapi".split(" "),
function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,P,K,N,C,J,O,R){var Q=B(u,{declaredClass:"esri.toolbars.Draw",_eventMap:{"draw-complete":!0,"draw-end":["geometry"]},constructor:function(a,e){this.markerSymbol=new z(z.STYLE_SOLID,10,new M(M.STYLE_SOLID,new g([255,0,0]),2),new g([0,0,0,.25]));this.lineSymbol=new M(M.STYLE_SOLID,new g([255,0,0]),2);this.fillSymbol=new I(I.STYLE_SOLID,new M(M.STYLE_SOLID,new g([255,0,0]),2),new g([0,0,0,.25]));this._points=[];this._mouse=!t("esri-touch")&&!t("esri-pointer");
this._defaultOptions={showTooltips:!0,drawTime:75,tolerance:8,tooltipOffset:15};this._options=m.mixin(m.mixin({},this._defaultOptions),e||{});(r("ios")||r("android"))&&(this._options.showTooltips=!1);this._onKeyDownHandler=m.hitch(this,this._onKeyDownHandler);this._onMouseDownHandler=m.hitch(this,this._onMouseDownHandler);this._onMouseUpHandler=m.hitch(this,this._onMouseUpHandler);this._onClickHandler=m.hitch(this,this._onClickHandler);this._onMouseMoveHandler=m.hitch(this,this._onMouseMoveHandler);
this._onMouseDragHandler=m.hitch(this,this._onMouseDragHandler);this._onDblClickHandler=m.hitch(this,this._onDblClickHandler);this._updateTooltip=m.hitch(this,this._updateTooltip);this._hideTooltip=m.hitch(this,this._hideTooltip);this._redrawGraphic=m.hitch(this,this._redrawGraphic)},_geometryType:null,respectDrawingVertexOrder:!1,setRespectDrawingVertexOrder:function(a){this.respectDrawingVertexOrder=a},setMarkerSymbol:function(a){this.markerSymbol=a},setLineSymbol:function(a){this.lineSymbol=a},
setFillSymbol:function(a){this.fillSymbol=a},activate:function(a,e){this._geometryType&&this.deactivate();var g=this.map,k=x.connect,n=Q;switch(this._options=m.mixin(m.mixin({},this._options),e||{}),g.navigationManager.setImmediateClick(!1),a){case n.ARROW:case n.LEFT_ARROW:case n.RIGHT_ARROW:case n.UP_ARROW:case n.DOWN_ARROW:case n.TRIANGLE:case n.CIRCLE:case n.ELLIPSE:case n.RECTANGLE:this._deactivateMapTools(!0,!1,!1,!0);this._onClickHandler_connect=k(g,"onClick",this._onClickHandler);this._mouse?
(this._onMouseDownHandler_connect=k(g,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler_connect=k(g,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=k(g,"onMouseUp",this._onMouseUpHandler)):(this._onMouseDownHandler2_connect=k(g,"onMouseDragStart",this._onMouseDownHandler),this._onMouseDragHandler2_connect=k(g,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=k(g,"onMouseDragEnd",this._onMouseUpHandler));t("esri-touch")&&!t("esri-pointer")&&
(this._onMouseDownHandler2_connect=k(g,"onSwipeStart",this._onMouseDownHandler),this._onMouseDragHandler2_connect=k(g,"onSwipeMove",this._onMouseDragHandler),this._onMouseUpHandler2_connect=k(g,"onSwipeEnd",this._onMouseUpHandler));break;case n.POINT:this._onClickHandler_connect=k(g,"onClick",this._onClickHandler);break;case n.LINE:case n.EXTENT:case n.FREEHAND_POLYLINE:case n.FREEHAND_POLYGON:this._deactivateMapTools(!0,!1,!1,!0);this._mouse?(this._onMouseDownHandler_connect=k(g,"onMouseDown",this._onMouseDownHandler),
this._onMouseDragHandler_connect=k(g,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=k(g,"onMouseUp",this._onMouseUpHandler)):(this._onMouseDownHandler_connect=k(g,"onMouseDragStart",this._onMouseDownHandler),this._onMouseDragHandler_connect=k(g,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=k(g,"onMouseDragEnd",this._onMouseUpHandler));t("esri-touch")&&!t("esri-pointer")&&(this._onMouseDownHandler2_connect=k(g,"onSwipeStart",this._onMouseDownHandler),
this._onMouseDragHandler2_connect=k(g,"onSwipeMove",this._onMouseDragHandler),this._onMouseUpHandler2_connect=k(g,"onSwipeEnd",this._onMouseUpHandler));break;case n.POLYLINE:case n.POLYGON:case n.MULTI_POINT:g.navigationManager.setImmediateClick(!0);this._onClickHandler_connect=k(g,"onClick",this._onClickHandler);this._onDblClickHandler_connect=k(g,"onDblClick",this._onDblClickHandler);this._dblClickZoom=g.isDoubleClickZoom;g.disableDoubleClickZoom();break;default:return void console.error("Unsupported geometry type: "+
a)}this._onKeyDown_connect=k(g,"onKeyDown",this._onKeyDownHandler);this._redrawConnect=k(g,"onExtentChange",this._redrawGraphic);this._geometryType=a;this._toggleTooltip(!0);g.snappingManager&&"freehandpolyline"!==this._geometryType&&"freehandpolygon"!==this._geometryType&&(g.snappingManager._startSelectionLayerQuery(),g.snappingManager._setUpSnapping());this.onActivate(this._geometryType)},deactivate:function(){var a=this.map;this._clear();var e=x.disconnect;switch(e(this._onMouseMoveHandler_connect),
e(this._onMouseDownHandler_connect),e(this._onMouseDragHandler_connect),e(this._onMouseUpHandler_connect),e(this._onMouseDownHandler2_connect),e(this._onMouseDragHandler2_connect),e(this._onMouseUpHandler2_connect),e(this._onClickHandler_connect),e(this._onDblClickHandler_connect),e(this._onKeyDown_connect),e(this._redrawConnect),this._onMouseDownHandler_connect=this._onMouseMoveHandler_connect=this._onMouseDragHandler_connect=this._onMouseUpHandler_connect=this._onMouseDownHandler2_connect=this._onMouseDragHandler2_connect=
this._onMouseUpHandler2_connect=this._onClickHandler_connect=this._onDblClickHandler_connect=this._onKeyDown_connect=this._redrawConnect=null,a.snappingManager&&(a.snappingManager._stopSelectionLayerQuery(),a.snappingManager._killOffSnapping()),this._geometryType){case Q.CIRCLE:case Q.ELLIPSE:case Q.TRIANGLE:case Q.ARROW:case Q.LEFT_ARROW:case Q.RIGHT_ARROW:case Q.UP_ARROW:case Q.DOWN_ARROW:case Q.RECTANGLE:case Q.LINE:case Q.EXTENT:case Q.FREEHAND_POLYLINE:case Q.FREEHAND_POLYGON:this._activateMapTools(!0,
!1,!1,!0);break;case Q.POLYLINE:case Q.POLYGON:case Q.MULTI_POINT:this._dblClickZoom&&a.enableDoubleClickZoom()}e=this._geometryType;this._geometryType=null;a.navigationManager.setImmediateClick(!1);this._toggleTooltip(!1);this.onDeactivate(e)},_clear:function(){this._graphic&&this.map.graphics.remove(this._graphic,!0);this._tGraphic&&this.map.graphics.remove(this._tGraphic,!0);this._graphic=this._tGraphic=null;this.map.snappingManager&&this.map.snappingManager._setGraphic(null);this._points=[]},
finishDrawing:function(){var a,e=this._points,g=this.map.spatialReference,k=Q;switch(e=e.slice(0,e.length),this._geometryType){case k.POLYLINE:if(!this._graphic||2>e.length)return;a=new N(g);a.addPath([].concat(e));break;case k.POLYGON:if(!this._graphic||3>e.length)return;a=new C(g);e=[].concat(e,[e[0].offset(0,0)]);C.prototype.isClockwise(e)||this.respectDrawingVertexOrder||(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),e.reverse());
a.addRing(e);break;case k.MULTI_POINT:a=new J(g),y.forEach(e,function(e){a.addPoint(e)})}x.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(a)},_drawEnd:function(a){if(a){var e,g=this.map.spatialReference;this.onDrawEnd(a);g&&(g.isWebMercator()?e=K.webMercatorToGeographic(a,!0):4326===g.wkid&&(e=P.fromJson(a.toJson())));this.onDrawComplete({geometry:a,geographicGeometry:e})}},_normalizeRect:function(a,e,g){var k=a.x;a=a.y;var m=e.x;e=e.y;return{x:Math.min(k,
m),y:Math.max(a,e),width:Math.abs(k-m),height:Math.abs(a-e),spatialReference:g}},_onMouseDownHandler:function(a){this._dragged=!1;var e;this.map.snappingManager&&(e=this.map.snappingManager._snappingPoint);var g=e||a.mapPoint,k=Q;e=this.map;var m=e.spatialReference;switch(this._points.push(g.offset(0,0)),this._geometryType){case k.LINE:this._graphic=e.graphics.add(new L(new N({paths:[[[g.x,g.y],[g.x,g.y]]],spatialReference:m}),this.lineSymbol),!0);e.snappingManager&&e.snappingManager._setGraphic(this._graphic);
break;case k.FREEHAND_POLYLINE:this._oldPoint=a.screenPoint;g=new N(m);g.addPath(this._points);this._graphic=e.graphics.add(new L(g,this.lineSymbol),!0);e.snappingManager&&e.snappingManager._setGraphic(this._graphic);break;case k.CIRCLE:case k.ELLIPSE:case k.TRIANGLE:case k.ARROW:case k.LEFT_ARROW:case k.RIGHT_ARROW:case k.UP_ARROW:case k.DOWN_ARROW:case k.RECTANGLE:case k.FREEHAND_POLYGON:this._oldPoint=a.screenPoint,g=new C(m),g.addRing(this._points),this._graphic=e.graphics.add(new L(g,this.fillSymbol),
!0),e.snappingManager&&e.snappingManager._setGraphic(this._graphic)}t("esri-touch")&&a.preventDefault();1===this._points.length&&this.onDrawStart()},_onMouseMoveHandler:function(a){var e;this.map.snappingManager&&(e=this.map.snappingManager._snappingPoint);var g=this._points[this._points.length-1];a=e||a.mapPoint;e=this._tGraphic;var k=e.geometry;switch(this._geometryType){case Q.POLYLINE:case Q.POLYGON:k.setPoint(0,0,{x:g.x,y:g.y}),k.setPoint(0,1,{x:a.x,y:a.y}),e.setGeometry(k)}},_onMouseDragHandler:function(a){if(this._graphic||
this._points.length){if(t("esri-touch")&&!this._points.length)return void a.preventDefault();this._dragged=!0;var e;this.map.snappingManager&&(e=this.map.snappingManager._snappingPoint);var g=this._points[0],k=e||a.mapPoint,n=this.map,p=n.spatialReference;e=this._graphic;var r=Q,u=n.toScreen(g),f=n.toScreen(k),w=[],w=f.x-u.x,f=f.y-u.y,x=Math.sqrt(w*w+f*f);switch(this._geometryType){case r.CIRCLE:this._hideTooltip();e.geometry=C.createCircle({center:u,r:x,numberOfPoints:60,map:n});e.setGeometry(e.geometry);
break;case r.ELLIPSE:this._hideTooltip();e.geometry=C.createEllipse({center:u,longAxis:w,shortAxis:f,numberOfPoints:60,map:n});e.setGeometry(e.geometry);break;case r.TRIANGLE:this._hideTooltip();w=[[0,-x],[.8660254037844386*x,.5*x],[-.8660254037844386*x,.5*x],[0,-x]];e.geometry=this._toPolygon(w,u.x,u.y);e.setGeometry(e.geometry);break;case r.ARROW:this._hideTooltip();g=f/x;n=w/x;k=.25*n*x;p=.25*x/(f/w);x*=.25*g;w=[[w,f],[w-k*(1+24/p),f+24*n-x],[w-k*(1+12/p),f+12*n-x],[-12*g,12*n],[12*g,-12*n],[w-
k*(1-12/p),f-12*n-x],[w-k*(1-24/p),f-24*n-x],[w,f]];e.geometry=this._toPolygon(w,u.x,u.y);e.setGeometry(e.geometry);break;case r.LEFT_ARROW:this._hideTooltip();w=0>=w?[[w,0],[.75*w,f],[.75*w,.5*f],[0,.5*f],[0,-.5*f],[.75*w,-.5*f],[.75*w,-f],[w,0]]:[[0,0],[.25*w,f],[.25*w,.5*f],[w,.5*f],[w,-.5*f],[.25*w,-.5*f],[.25*w,-f],[0,0]];e.geometry=this._toPolygon(w,u.x,u.y);e.setGeometry(e.geometry);break;case r.RIGHT_ARROW:this._hideTooltip();w=0<=w?[[w,0],[.75*w,f],[.75*w,.5*f],[0,.5*f],[0,-.5*f],[.75*w,
-.5*f],[.75*w,-f],[w,0]]:[[0,0],[.25*w,f],[.25*w,.5*f],[w,.5*f],[w,-.5*f],[.25*w,-.5*f],[.25*w,-f],[0,0]];e.geometry=this._toPolygon(w,u.x,u.y);e.setGeometry(e.geometry);break;case r.UP_ARROW:this._hideTooltip();w=0>=f?[[0,f],[-w,.75*f],[-.5*w,.75*f],[-.5*w,0],[.5*w,0],[.5*w,.75*f],[w,.75*f],[0,f]]:[[0,0],[-w,.25*f],[-.5*w,.25*f],[-.5*w,f],[.5*w,f],[.5*w,.25*f],[w,.25*f],[0,0]];e.geometry=this._toPolygon(w,u.x,u.y);e.setGeometry(e.geometry);break;case r.DOWN_ARROW:this._hideTooltip();w=0<=f?[[0,f],
[-w,.75*f],[-.5*w,.75*f],[-.5*w,0],[.5*w,0],[.5*w,.75*f],[w,.75*f],[0,f]]:[[0,0],[-w,.25*f],[-.5*w,.25*f],[-.5*w,f],[.5*w,f],[.5*w,.25*f],[w,.25*f],[0,0]];e.geometry=this._toPolygon(w,u.x,u.y);e.setGeometry(e.geometry);break;case r.RECTANGLE:this._hideTooltip();w=[[0,0],[w,0],[w,f],[0,f],[0,0]];e.geometry=this._toPolygon(w,u.x,u.y);e.setGeometry(e.geometry);break;case r.LINE:e.setGeometry(m.mixin(e.geometry,{paths:[[[g.x,g.y],[k.x,k.y]]]}));break;case r.EXTENT:e&&n.graphics.remove(e,!0);e=new O(this._normalizeRect(g,
k,p));e._originOnly=!0;this._graphic=n.graphics.add(new L(e,this.fillSymbol),!0);n.snappingManager&&n.snappingManager._setGraphic(this._graphic);break;case r.FREEHAND_POLYLINE:case r.FREEHAND_POLYGON:if(this._hideTooltip(),!1===this._canDrawFreehandPoint(a))return void(t("esri-touch")&&a.preventDefault());this._points.push(a.mapPoint.offset(0,0));e.geometry._insertPoints([k.offset(0,0)],0);e.setGeometry(e.geometry)}t("esri-touch")&&a.preventDefault()}},_canDrawFreehandPoint:function(a){if(!this._oldPoint)return!1;
var e=this._oldPoint.x-a.screenPoint.x,g=this._oldPoint.y-a.screenPoint.y,k=this._options.tolerance;if((0>e?-1*e:e)<k&&(0>g?-1*g:g)<k)return!1;e=new Date;return!(e-this._startTime<this._options.drawTime)&&(this._startTime=e,this._oldPoint=a.screenPoint,!0)},_onMouseUpHandler:function(a){if(!this._dragged||!this._graphic)return void this._clear();0===this._points.length&&this._points.push(a.mapPoint.offset(0,0));var e;this.map.snappingManager&&(e=this.map.snappingManager._snappingPoint);var g,k=this._points[0];
e=e||a.mapPoint;var n=this.map.spatialReference,m=Q;switch(this._geometryType){case m.CIRCLE:case m.ELLIPSE:case m.TRIANGLE:case m.ARROW:case m.LEFT_ARROW:case m.RIGHT_ARROW:case m.UP_ARROW:case m.DOWN_ARROW:case m.RECTANGLE:g=this._graphic.geometry;break;case m.LINE:g=new N({paths:[[[k.x,k.y],[e.x,e.y]]],spatialReference:n});break;case m.EXTENT:g=(new O(this._normalizeRect(k,e,n))).getExtent();break;case m.FREEHAND_POLYLINE:g=new N(n);g.addPath([].concat(this._points,[e.offset(0,0)]));break;case m.FREEHAND_POLYGON:g=
new C(n),k=[].concat(this._points,[e.offset(0,0),this._points[0].offset(0,0)]),C.prototype.isClockwise(k)||this.respectDrawingVertexOrder||(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),k.reverse()),g.addRing(k)}t("esri-touch")&&a.preventDefault();this._clear();this._drawEnd(g)},_onClickHandler:function(a){var e;this.map.snappingManager&&(e=this.map.snappingManager._snappingPoint);var g,k,m;e=e||a.mapPoint;a=this.map;var n=a.toScreen(e),
p=Q;switch(this._points.push(e.offset(0,0)),this._geometryType){case p.POINT:this.onDrawStart();this._drawEnd(e.offset(0,0));this._setTooltipMessage(0);break;case p.POLYLINE:1===this._points.length?(g=new N(a.spatialReference),g.addPath(this._points),this._graphic=a.graphics.add(new L(g,this.lineSymbol),!0),a.snappingManager&&a.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=x.connect(a,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=a.graphics.add(new L(new N({paths:[[[e.x,
e.y],[e.x,e.y]]],spatialReference:a.spatialReference}),this.lineSymbol),!0),this.onDrawStart()):(this._graphic.geometry._insertPoints([e.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol),g=this._tGraphic,k=g.geometry,k.setPoint(0,0,e.offset(0,0)),k.setPoint(0,1,e.offset(0,0)),g.setGeometry(k));break;case p.POLYGON:1===this._points.length?(m=new C(a.spatialReference),m.addRing(this._points),this._graphic=a.graphics.add(new L(m,this.fillSymbol),!0),a.snappingManager&&
a.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=x.connect(a,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=a.graphics.add(new L(new N({paths:[[[e.x,e.y],[e.x,e.y]]],spatialReference:a.spatialReference}),this.fillSymbol),!0),this.onDrawStart()):(this._graphic.geometry._insertPoints([e.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol),g=this._tGraphic,k=g.geometry,k.setPoint(0,0,e.offset(0,0)),k.setPoint(0,1,e.offset(0,
0)),g.setGeometry(k));break;case p.MULTI_POINT:g=this._points;1===g.length?(k=new J(a.spatialReference),k.addPoint(g[g.length-1]),this._graphic=a.graphics.add(new L(k,this.markerSymbol),!0),a.snappingManager&&a.snappingManager._setGraphic(this._graphic),this.onDrawStart()):(this._graphic.geometry.addPoint(g[g.length-1]),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol));break;case p.ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,
0]],n.x,n.y);break;case p.LEFT_ARROW:this._addShape([[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]],n.x,n.y);break;case p.RIGHT_ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],n.x,n.y);break;case p.UP_ARROW:this._addShape([[0,0],[-24,24],[-12,24],[-12,96],[12,96],[12,24],[24,24],[0,0]],n.x,n.y);break;case p.DOWN_ARROW:this._addShape([[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],[12,-24],[24,-24],[0,0]],n.x,n.y);break;case p.TRIANGLE:this._addShape([[0,
-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]],n.x,n.y);break;case p.RECTANGLE:this._addShape([[0,-96],[96,-96],[96,0],[0,0],[0,-96]],n.x-48,n.y+48);break;case p.CIRCLE:this._clear();this.onDrawStart();this._drawEnd(C.createCircle({center:n,r:48,numberOfPoints:60,map:a}));break;case p.ELLIPSE:this._clear(),this.onDrawStart(),this._drawEnd(C.createEllipse({center:n,longAxis:48,shortAxis:24,numberOfPoints:60,map:a}))}this._setTooltipMessage(this._points.length)},_addShape:function(a,e,
g){this._setTooltipMessage(0);this._clear();this.onDrawStart();this._drawEnd(this._toPolygon(a,e,g))},_toPolygon:function(a,e,g){var k=this.map,n=new C(k.spatialReference);return n.addRing(y.map(a,function(a){return k.toMap({x:a[0]+e,y:a[1]+g})})),n},_onDblClickHandler:function(a){var e,g=this._points,k=this.map.spatialReference,n=Q;t("esri-touch")&&g.push(a.mapPoint);var m=g[g.length-1],p=g[g.length-2];switch(g=m&&p&&m.x===p.x&&m.y===p.y?g.slice(0,g.length-1):g.slice(0,g.length),this._geometryType){case n.POLYLINE:if(!this._graphic||
2>g.length)return x.disconnect(this._onMouseMoveHandler_connect),this._clear(),void this._onClickHandler(a);e=new N(k);e.addPath([].concat(g));break;case n.POLYGON:if(!this._graphic||2>g.length)return x.disconnect(this._onMouseMoveHandler_connect),this._clear(),void this._onClickHandler(a);e=new C(k);a=[].concat(g,[g[0].offset(0,0)]);C.prototype.isClockwise(a)||this.respectDrawingVertexOrder||(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),
a.reverse());e.addRing(a);break;case n.MULTI_POINT:e=new J(k),y.forEach(g,function(a){e.addPoint(a)})}x.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(e)},_onKeyDownHandler:function(a){a.keyCode===n.ESCAPE&&(x.disconnect(this._onMouseMoveHandler_connect),this._clear(),this._setTooltipMessage(0))},_toggleTooltip:function(e){this._options.showTooltips&&(e?this._tooltip||(this._tooltip=A.create("div",{class:"esriMapTooltip"},this.map.container),k.isBodyLtr()||
a.set(this._tooltip,"direction","rtl"),this._tooltip.style.display="none",this._tooltip.style.position="fixed",this._setTooltipMessage(0),this._onTooltipMouseEnterHandler_connect=x.connect(this.map,"onMouseOver",this._updateTooltip),this._onTooltipMouseLeaveHandler_connect=x.connect(this.map,"onMouseOut",this._hideTooltip),this._onTooltipMouseMoveHandler_connect=x.connect(this.map,"onMouseMove",this._updateTooltip)):this._tooltip&&(x.disconnect(this._onTooltipMouseEnterHandler_connect),x.disconnect(this._onTooltipMouseLeaveHandler_connect),
x.disconnect(this._onTooltipMouseMoveHandler_connect),A.destroy(this._tooltip),this._tooltip=null))},_hideTooltip:function(){var a=this._tooltip;a&&(a.style.display="none")},_setTooltipMessage:function(a){var e=this._tooltip;if(e){var g="";switch(this._geometryType){case Q.POINT:g=R.toolbars.draw.addPoint;break;case Q.ARROW:case Q.LEFT_ARROW:case Q.RIGHT_ARROW:case Q.UP_ARROW:case Q.DOWN_ARROW:case Q.TRIANGLE:case Q.RECTANGLE:case Q.CIRCLE:case Q.ELLIPSE:g=R.toolbars.draw.addShape;break;case Q.LINE:case Q.EXTENT:case Q.FREEHAND_POLYLINE:case Q.FREEHAND_POLYGON:g=
R.toolbars.draw.freehand;break;case Q.POLYLINE:case Q.POLYGON:g=R.toolbars.draw.start;1===a?g=R.toolbars.draw.resume:2<=a&&(g=R.toolbars.draw.complete);break;case Q.MULTI_POINT:g=R.toolbars.draw.addMultipoint,1<=a&&(g=R.toolbars.draw.finish)}e.innerHTML=g}},_updateTooltip:function(e){var g=this._tooltip;if(g){var k,n;e.clientX||e.pageY?(k=e.clientX,n=e.clientY):(k=e.clientX+w.body().scrollLeft-w.body().clientLeft,n=e.clientY+w.body().scrollTop-w.body().clientTop);g.style.display="none";a.set(g,{left:k+
this._options.tooltipOffset+"px",top:n+"px"});g.style.display=""}},_redrawGraphic:function(a,e,g,k){if(g||this.map.wrapAround180)(a=this._graphic)&&a.setGeometry(a.geometry),(a=this._tGraphic)&&a.setGeometry(a.geometry)},onActivate:function(){},onDeactivate:function(){},onDrawComplete:function(){},onDrawStart:function(){},onDrawEnd:function(){}});return m.mixin(Q,{POINT:"point",MULTI_POINT:"multipoint",LINE:"line",EXTENT:"extent",POLYLINE:"polyline",POLYGON:"polygon",FREEHAND_POLYLINE:"freehandpolyline",
FREEHAND_POLYGON:"freehandpolygon",ARROW:"arrow",LEFT_ARROW:"leftarrow",RIGHT_ARROW:"rightarrow",UP_ARROW:"uparrow",DOWN_ARROW:"downarrow",TRIANGLE:"triangle",CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"}),t("extend-esri")&&m.setObject("toolbars.Draw",Q,e),Q})},"esri/toolbars/_toolbar":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../Evented"],function(B,m,y,x,g){B=B([g],{declaredClass:"esri.toolbars._Toolbar",constructor:function(g){this.map=g},_cursors:{move:"pointer",
"move-v":"pointer","move-gv":"pointer",box0:"nw-resize",box1:"n-resize",box2:"ne-resize",box3:"e-resize",box4:"se-resize",box5:"s-resize",box6:"sw-resize",box7:"w-resize",box8:"pointer"},_deactivateMapTools:function(g,m,r,n){var t=this.map;g&&(this._mapNavState={isDoubleClickZoom:t.isDoubleClickZoom,isClickRecenter:t.isClickRecenter,isPan:t.isPan,isRubberBandZoom:t.isRubberBandZoom,isKeyboardNavigation:t.isKeyboardNavigation,isScrollWheelZoom:t.isScrollWheelZoom},t.disableDoubleClickZoom(),t.disableClickRecenter(),
t.disablePan(),t.disableRubberBandZoom(),t.disableKeyboardNavigation());m&&t.hideZoomSlider();r&&t.hidePanArrows();n&&t.graphics.disableMouseEvents()},_activateMapTools:function(g,m,r,n){var t=this.map,a=this._mapNavState;g&&a&&(a.isDoubleClickZoom&&t.enableDoubleClickZoom(),a.isClickRecenter&&t.enableClickRecenter(),a.isPan&&t.enablePan(),a.isRubberBandZoom&&t.enableRubberBandZoom(),a.isKeyboardNavigation&&t.enableKeyboardNavigation(),a.isScrollWheelZoom&&t.enableScrollWheelZoom());m&&t.showZoomSlider();
r&&t.showPanArrows();n&&t.graphics.enableMouseEvents()},_deactivateScrollWheel:function(){var g=this.map;this._scrollWheelState={isScrollWheelZoom:g.isScrollWheelZoom,isScrollWheelPan:g.isScrollWheelPan};g.disableScrollWheelZoom();g.disableScrollWheelPan()},_activateScrollWheel:function(){var g=this.map,m=this._scrollWheelState;m&&(m.isScrollWheelZoom&&g.enableScrollWheelZoom(),m.isScrollWheelPan&&g.enableScrollWheelPan())}});return y("extend-esri")&&m.setObject("toolbars._Toolbar",B,x),B})},"jimu/dijit/URLInput":function(){define(["dojo/_base/declare",
"dojo/_base/html","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(B,m,y,x){return B([y],{declaredClass:"jimu.dijit.URLInput",required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allowLocal:!0,postMixInProperties:function(){this.inherited(arguments);this.invalidMessage=(this.nls=window.jimuNls.urlInput)?this.nls.invalidUrl:"Invalid Url"},postCreate:function(){this.inherited(arguments);m.addClass(this.domNode,"jimu-url-input")},validator:function(g){if(!1===this.required&&
""===g)return!0;if(isFinite(g))return!1;var m="^"+x.url({allowNamed:this.allowNamed,allowLocal:this.allowLocal}),m=new RegExp(m,"g");m.lastIndex=0;m=m.test(g);return this.rest?(g=/\/rest\/services/gi.test(g),m&&g):m}})})},"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(B,m,y){var x=B.getObject("validate.regexp",!0,y);return x=y.validate.regexp={ipAddress:function(g){g="object"==typeof g?g:{};"boolean"!=typeof g.allowDottedDecimal&&(g.allowDottedDecimal=
!0);"boolean"!=typeof g.allowDottedHex&&(g.allowDottedHex=!0);"boolean"!=typeof g.allowDottedOctal&&(g.allowDottedOctal=!0);"boolean"!=typeof g.allowDecimal&&(g.allowDecimal=!0);"boolean"!=typeof g.allowHex&&(g.allowHex=!0);"boolean"!=typeof g.allowIPv6&&(g.allowIPv6=!0);"boolean"!=typeof g.allowHybrid&&(g.allowHybrid=!0);var m=[];g.allowDottedDecimal&&m.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");g.allowDottedHex&&m.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");
g.allowDottedOctal&&m.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");g.allowDecimal&&m.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");g.allowHex&&m.push("0[xX]0*[\\da-fA-F]{1,8}");g.allowIPv6&&m.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");g.allowHybrid&&m.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");
g="";0<m.length&&(g="("+m.join("|")+")");return g},host:function(g){g="object"==typeof g?g:{};"boolean"!=typeof g.allowIP&&(g.allowIP=!0);"boolean"!=typeof g.allowLocal&&(g.allowLocal=!1);"boolean"!=typeof g.allowPort&&(g.allowPort=!0);"boolean"!=typeof g.allowNamed&&(g.allowNamed=!1);var m=g.allowPort?"(\\:\\d+)?":"",t="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)";g.allowIP&&(t+="|"+x.ipAddress(g));g.allowLocal&&(t+="|localhost");
g.allowNamed&&(t+="|^[^-][a-zA-Z0-9_-]*");return"("+t+")"+m},url:function(g){g="object"==typeof g?g:{};"scheme"in g||(g.scheme=[!0,!1]);return m.buildGroupRE(g.scheme,function(g){return g?"(https?|ftps?)\\://":""})+x.host(g)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},emailAddress:function(g){g="object"==typeof g?g:{};"boolean"!=typeof g.allowCruft&&(g.allowCruft=!1);g.allowPort=!1;var m="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+x.host(g);
g.allowCruft&&(m="\x3c?(mailto\\:)?"+m+"\x3e?");return m},emailAddressList:function(g){g="object"==typeof g?g:{};"string"!=typeof g.listSeparator&&(g.listSeparator="\\s;,");var m=x.emailAddress(g);return"("+m+"\\s*["+g.listSeparator+"]\\s*)*"+m+"\\s*["+g.listSeparator+"]?\\s*"},numberFormat:function(g){g="object"==typeof g?g:{};"undefined"==typeof g.format&&(g.format="###-###-####");return m.buildGroupRE(g.format,function(g){return m.escapeString(g,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},
ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(g){g="object"==typeof g?g:{};"boolean"!=typeof g.allowTerritories&&(g.allowTerritories=!0);"boolean"!=typeof g.allowMilitary&&(g.allowMilitary=!0);var m="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";g.allowTerritories&&(m+="|AS|FM|GU|MH|MP|PW|PR|VI");
g.allowMilitary&&(m+="|AA|AE|AP");return"("+m+")"}}}})},"jimu/dijit/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dojo/dom-geometry dojo/dom-class dojo/Evented dojo/debounce".split(" "),function(B,m,y,x,g,w,t,r){return B([x,t],{baseClass:"jimu-dijit-gridlayout",declaredClass:"jimu.dijit.GridLayout",container:null,layoutDefinition:null,components:null,editable:!1,_layout:null,_coordinates:null,_isCreatingLayout:null,postCreate:function(){this.inherited(arguments);
this._isCreatingLayout=!1;this._createLayout(this.layoutDefinition)},restoreLayout:function(g){g=g||this.layoutDefinition;this._createLayout(g)},destroy:function(){y.forEach(this.components,function(g){g.dijit.destroy()});this._layout.destroy();this.inherited(arguments)},getLayoutDefinition:function(){return this._layout.toConfig().content},resize:function(){var m=g.getMarginBox(this.container);this._layout.updateSize(m.w,m.h)},getComponentSize:function(g){return(g=this._layout.root.contentItems[0].getItemsById(g))&&
0<g.length?(g=g[0].container,{w:g.width,h:g.height}):{w:0,h:0}},getSize:function(){return{w:this._layout.width,h:this._layout.height}},setVisible:function(g,m){var a=this._layout.root.contentItems[0].getItemsById(g);a&&0<a.length&&!1===m?this._hideComponent(a[0]):a&&0!==a.length||!0!==m||this._showComponent(g)},highlightItem:function(g){(g=this._layout.root.contentItems[0].getItemsById(g))&&0<g.length&&g[0].highlight()},unhighlightItem:function(g){(g=this._layout.root.contentItems[0].getItemsById(g))&&
0<g.length&&g[0].unhighlight()},_createLayout:function(g){if(!this._isCreatingLayout){this._coordinates={};this._isCreatingLayout=!0;var n={settings:{hasHeaders:!1,resizeEnabled:this.editable,reorderEnabled:this.editable,selectionEnabled:this.editable,highlightEnabled:this.editable},dimensions:{borderWidth:1,dragProxyWidth:0,dragProxyHeight:0},content:g},a=this._layout;require(["libs/goldenlayout/goldenlayout"],m.hitch(this,function(g){this._layout=new g(n,this.container);this._layout.registerComponent("jimu grid",
m.hitch(this,function(a,g){var e;a.parent.config.id=g.id;y.some(this.components,function(k){if(k.id===g.id)return e=k.dijit,a.getElement().html(k.dijit.domNode),!0},this);a.on("resize",r(m.hitch(this,function(){0<a.width&&0<a.height&&e&&"function"===typeof e.resize&&e.resize(a.width,a.height)}),200));a.on("select",m.hitch(this,function(){this.editable&&a.parent.select();this.emit("mask-click",a.parent.config.id)}))}));this._layout.on("initialised",m.hitch(this,function(){this._resetCoordinate();this.emit("initialised");
this._isCreatingLayout=!1;a&&a.destroy()}));this._layout.on("stateChanged",m.hitch(this,function(){this._resetCoordinate()}));this._layout.init();this.editable||w.add(this._layout.root.childElementContainer[0],"viewonly");w.add(this._layout.root.childElementContainer[0],"jimu-dijit-gridlayout");setTimeout(m.hitch(this,this.resize),100)}))}},_hideComponent:function(g){g.parent&&g.parent.removeChild(g,!0)},_showComponent:function(g){var m,a,k,e,n,r,t;y.some(this.components,function(a){if(a.id===g)return m=
a,!0},this);m&&(e={id:g,type:"component",componentName:"jimu grid",componentState:{id:g}},a=this._coordinates[g],n=this._layout.root,a?(a[0].type!==n.contentItems[0].type&&(r=n.contentItems[0],n.replaceChild(r,{type:a[0].type,content:[]}),n.contentItems[0].addChild(r)),k=n,y.forEach(a,function(a){t=a.index<=k.contentItems.length?a.index:k.contentItems.length;"component"===a.type?k.addChild(e,t):("stack"!==a.type&&k.contentItems[a.index].type===a.type||k.addChild({type:a.type,content:[]},t),k=k.contentItems[t])},
this)):("stack"===n.contentItems[0].type&&(r=n.contentItems[0],n.replaceChild(r,{type:"column",content:[]}),n.contentItems[0].addChild(r)),n.contentItems[0].addChild(e)))},_resetCoordinate:function(){var g=this._layout.root.getItemsByType("component"),m=function(a,g){var e=a.parent;e&&(y.some(e.contentItems,function(e,k){if(e===a)return g.push({type:e.type,index:k}),!0}),m(e,g))};y.forEach(g,function(a){var g=[];m(a,g);this._coordinates[a.config.id]=g.reverse()},this)}})})},"jimu/LayerInfos/LayerInfoForGroup":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred esri/request ./LayerInfo".split(" "),
function(B,m,y,x,g,w){return B(w,{constructor:function(g,m,n,w){this.noLegend=w},_initVisible:function(){var g=!1,m=this.originOperLayer.mapService;this.originOperLayer.mapService&&m.layerInfo._subLayerVisible[m.subId]&&(g=!0);this._visible=g},_setTopLayerVisible:function(g){var m;if(this.originOperLayer.mapService&&(m=this.originOperLayer.mapService,0<this.originOperLayer.subLayers.length)){m.layerInfo._subLayerVisible[m.subId]=g?!0:!1;this._visible=g;var n={};this.traversal(function(g){0===g.getSubLayers().length&&
(n[g.originOperLayer.mapService.subId]=g.isVisbleOrInvisilbe())});m.layerInfo._setSubLayerVisible(n)}},setLayerVisiblefromTopLayer:function(){},_visibleChanged:function(g){},_sevVisible:function(g){this.visible=g},obtainNewSubLayers:function(){var g=[];m.forEach(this.originOperLayer.subLayers,function(m){m.parentLayerInfo=this;m=this._layerInfoFactory.create(m);g.push(m);m.init()},this);return g},getOpacity:function(){},setOpacity:function(g){},getLayerObject:function(){var m=new x;this.layerObject.empty?
g({url:this.layerObject.url,handleAs:"json",callbackParamName:"callback",timeout:1E5,content:{f:"json"}}).then(y.hitch(this,function(g){var n=this.layerObject.url;this.layerObject=g;this.layerObject.url=n;this.layerObject.id=this.id;m.resolve(this.layerObject)}),function(g){m.reject(g)}):m.resolve(this.layerObject);return m},getLayerType:function(){var g=new x;g.resolve("GroupLayer");return g},_getShowLegendOfWebmap:function(){return this.originOperLayer.mapService.layerInfo._getSublayerShowLegendOfWebmap(this.originOperLayer.mapService.subId)},
getScaleRange:function(){var g=this.originOperLayer.mapService;return(g=g.layerInfo._getJsapiLayerInfoById(g.subId))&&0<=g.minScale&&0<=g.maxScale?{minScale:g.minScale,maxScale:g.maxScale}:{minScale:0,maxScale:0}}})})},"url:jimu/dijit/templates/AGOLLoading.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imgDiv" class\x3d"img-div"\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/InfoWindow.html":'\x3cdiv id\x3d"${id}.infowindow" class\x3d"infowindow" dojoAttachPoint\x3d"_infowindow"\n  \x3e\x3cdiv style\x3d"position:relative;"\n    \x3e\x3cdiv class\x3d"window" dojoAttachPoint\x3d"_window"\n      \x3e\x3cdiv class\x3d"top"\n        \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_topleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\n    \t\t\x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_topright"\n    \t\t\t\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\n    \t\t\t\x3e\x3cdiv class\x3d"user" dojoAttachPoint\x3d"_user"\n    \t\t\t  \x3e\x3cdiv class\x3d"titlebar" dojoAttachPoint\x3d"_titlebar"\n    \t\t\t    \x3e\x3ca class\x3d"hide" dojoAttachPoint\x3d"_hide" dojoAttachEvent\x3d"onclick:hide"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/a\n              \x3e\x3cdiv class\x3d"title" dojoAttachPoint\x3d"_title"\x3e${title}\x3c/div\n    \t\t\t  \x3e\x3c/div\n            \x3e\x3cdiv class\x3d"border" dojoAttachPoint\x3d"_border"\x3e\x3c/div\n    \t\t\t  \x3e\x3cdiv class\x3d"layout content" dojoAttachPoint\x3d"_content, containerNode"\n    \t\t\t  \x3e\x3c/div\n    \t\t\t\x3e\x3c/div\n    \t\t\x3e\x3c/div\n        \x3e\x3cdiv class\x3d"bottom"\n          \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_bottomleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\n\t\t      \x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_bottomright"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\n        \x3e\x3c/div\n      \x3e\x3c/div\n    \x3e\x3c/div\n    \x3e\x3cdiv class\x3d"pointer" dojoAttachPoint\x3d"_pointer"\x3e\x3cdiv dojoAttachPoint\x3d"_sprite" class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\n  \x3e\x3c/div\n\x3e\x3c/div\x3e',
"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\n\t   cellspacing\x3d"0"\x3e\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\n\x3c/table\x3e\n',"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\n\t\t\x3c/span\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\n\t\x3c/td\x3e\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\n\trole\x3d"listbox" aria-haspopup\x3d"true"\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t/\x3e\x3c/div\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\n\t\t/\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t${_buttonInputDisabled}\n\t\t/\x3e\x3c/td\n\t\x3e\x3c/tr\x3e\x3c/tbody\n\x3e\x3c/table\x3e\n',
"url:jimu/dijit/templates/AddItemForm.html":'\x3cdiv style\x3d"width: 100%" class\x3d"jimu-item-form"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"itemForm" encType\x3d"multipart/form-data" action\x3d"" method\x3d""\x3e\r\n    \x3cdiv class\x3d"line"\x3e\r\n      \x3cdiv class\x3d"input-label"\x3e${nls.title}\x3c/div\x3e\r\n      \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"itemName"\r\n      required\x3d"true" class\x3d"input-item"/\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"line line-margin"\x3e\r\n      \x3cdiv class\x3d"input-label"\x3e${nls.folder}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"itemFolder" data-dojo-type\x3d"dijit/form/FilteringSelect" trim\x3d"true" class\x3d"input-item"\x3e\x3c/input\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}"\n\trole\x3d"combobox"\n\taria-haspopup\x3d"true"\n\tdata-dojo-attach-point\x3d"_popupStateNode"\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\n\t\t\t${_buttonInputDisabled}\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"img-div"\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/SymbolChooser.html":'\x3cdiv class\x3d"symbol-chooser" style\x3d"width:320px;"\x3e\r\n\t\x3cdiv class\x3d"symbol-section point-symbol-section" data-dojo-attach-point\x3d"pointSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"point-sym-class-select-tr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cselect class\x3d"restrict-select-width" data-dojo-attach-point\x3d"pointSymClassSelect" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:100%;height:30px;"\x3e\r\n\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointCustomImageTr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2" data-dojo-attach-point\x3d"customImageTd" class\x3d"custom-image-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"image-file-tip jimu-ellipsis jimu-leading-margin1" data-dojo-attach-point\x3d"imageNameNode"\x3e${nls.noFileChoosen}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"point-icon-tables-tr" data-dojo-attach-point\x3d"pointIconTablesTr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2" style\x3d"position:relative"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"loadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"pointIconTables"\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.symbolSize}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointSize" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" data-dojo-props\x3d\'value:18,smallDelta:1,largeDelta:10,constraints:{min:1,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointColorTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.color}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,128]\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOpacityTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.transparency}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:0.5\' style\x3d"width:100%;font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOutlineColorTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.outlineColor}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,255]\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOulineWidthTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.outlineWidth}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" data-dojo-props\x3d\'value:1,smallDelta:1,constraints:{min:0,max:5},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section line-symbol-section" data-dojo-attach-point\x3d"lineSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineSymPreview" style\x3d"width:100%;overflow:hidden;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"lineIconTables"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.color}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.style}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cselect class\x3d"restrict-select-width" data-dojo-attach-point\x3d"lineStylesSelect" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"solid"\x3e${nls.solid}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dash"\x3e${nls.dash}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dot"\x3e${nls.dot}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dashdot"\x3e${nls.dashDot}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"longdashdotdot"\x3e${nls.dashDotDot}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.transparency}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:1\' style\x3d"width:100%;font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.width}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"lineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;"\r\n\t\t\t\t\t\tdata-dojo-props\x3d\'value:3,smallDelta:1,constraints:{min:1,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section fill-symbol-section" data-dojo-attach-point\x3d"fillSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"fillIconTables"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.color}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.transparency}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:0.5\' style\x3d"width:100%;font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.outlineColor}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#738c3d"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.outlineWidth}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"fillOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;"\r\n\t\t\t\t\t\tdata-dojo-props\x3d\'value:2,smallDelta:1,constraints:{min:0,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section text-symbol-section" data-dojo-attach-point\x3d"textSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"textPreview"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.text}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput class\x3d"text-input" data-dojo-attach-point\x3d"inputText" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.fontColor}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"textColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#000"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.fontSize}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"textFontSize" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" data-dojo-props\x3d\'value:20,smallDelta:1,constraints:{min:1,max:100},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintText"\x3e\r\n\t\t\x3cspan class\x3d"display-text" data-dojo-attach-point\x3d"displayText"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintImage"\x3e\r\n\t\t\x3cimg class\x3d"display-image" data-dojo-attach-point\x3d"selfImg"\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--\r\n  \x3cform data-dojo-attach-point\x3d"fileForm"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"mask"\x3e\x3c/label\x3e\r\n    \x3cinput type\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n  \x3c/form\x3e\r\n  \x3cimg class\x3d"tmp-image" style\x3d"display:none" data-dojo-attach-point\x3d"tmpImg"\x3e--\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_CropImage.html":'\x3cdiv class\x3d"jimu-crop-image"\x3e\r\n\t\x3cimg class\x3d"loading-image" data-dojo-attach-point\x3d"loadingImg" src\x3d""\x3e\r\n\r\n\t\x3cimg class\x3d"base-image hide-status" data-dojo-attach-point\x3d"baseImage" width\x3d"100%" height\x3d"100%" style\x3d"display:none;width:100%;height:100%"\x3e\r\n\x3c/div\x3e\r\n',"url:dojox/widget/ColorPicker/ColorPicker.html":'\x3ctable class\x3d"dojoxColorPicker" dojoAttachEvent\x3d"onkeypress: _handleKey" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\n\t\x3ctr\x3e\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\n\t\t\t\x3cdiv class\x3d"dojoxColorPickerBox"\x3e\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\n\t\t\t\t\x3cimg title\x3d"${saturationPickerTitle}" alt\x3d"${saturationPickerTitle}" class\x3d"dojoxColorPickerPoint" src\x3d"${_pickerPointer}" tabIndex\x3d"0" dojoAttachPoint\x3d"cursorNode" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\n\t\t\t\t\x3cimg role\x3d"presentation" alt\x3d"" dojoAttachPoint\x3d"colorUnderlay" dojoAttachEvent\x3d"onclick: _setPoint, onmousedown: _stopDrag" class\x3d"dojoxColorPickerUnderlay" src\x3d"${_underlay}" ondragstart\x3d"return false"\x3e\n\t\t\t\x3c/div\x3e\n\t\t\x3c/td\x3e\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\n\t\t\t\x3cdiv class\x3d"dojoxHuePicker"\x3e\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\n\t\t\t\t\x3cimg dojoAttachPoint\x3d"hueCursorNode" tabIndex\x3d"0" class\x3d"dojoxHuePickerPoint" title\x3d"${huePickerTitle}" alt\x3d"${huePickerTitle}" src\x3d"${_huePickerPointer}" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\n\t\t\t\t\x3cdiv class\x3d"dojoxHuePickerUnderlay" dojoAttachPoint\x3d"hueNode"\x3e\n\t\t\t\t    \x3cimg role\x3d"presentation" alt\x3d"" dojoAttachEvent\x3d"onclick: _setHuePoint, onmousedown: _stopDrag" src\x3d"${_hueUnderlay}"\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\x3c/td\x3e\n\t\t\x3ctd valign\x3d"top"\x3e\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\n\t\t\t\t\x3ctr\x3e\n\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerPreviewContainer"\x3e\n\t\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\n\t\t\t\t\t\t\t\x3ctr\x3e\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"previewNode" class\x3d"dojoxColorPickerPreview"\x3e\x3c/div\x3e\n\t\t\t\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top"\x3e\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"safePreviewNode" class\x3d"dojoxColorPickerWebSafePreview"\x3e\x3c/div\x3e\n\t\t\t\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\t\t\x3c/table\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\x3ctr\x3e\n\t\t\t\t\t\x3ctd valign\x3d"bottom"\x3e\n\t\t\t\t\t\t\x3ctable class\x3d"dojoxColorPickerOptional" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\n\t\t\t\t\t\t\t\x3ctr\x3e\n\t\t\t\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerRgb" dojoAttachPoint\x3d"rgbNode"\x3e\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_r"\x3e${redLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_r" dojoAttachPoint\x3d"Rval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_g"\x3e${greenLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_g" dojoAttachPoint\x3d"Gval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_b"\x3e${blueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_b" dojoAttachPoint\x3d"Bval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerHsv" dojoAttachPoint\x3d"hsvNode"\x3e\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_h"\x3e${hueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_h" dojoAttachPoint\x3d"Hval"size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${degLabel}\x3c/td\x3e\x3c/tr\x3e\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_s"\x3e${saturationLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_s" dojoAttachPoint\x3d"Sval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_v"\x3e${valueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_v" dojoAttachPoint\x3d"Vval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\t\t\t\x3ctr\x3e\n\t\t\t\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxColorPickerHex" dojoAttachPoint\x3d"hexNode" aria-live\x3d"polite"\x3e\t\n\t\t\t\t\t\t\t\t\t\t\x3clabel for\x3d"${_uId}_hex"\x3e\x26nbsp;${hexLabel}\x26nbsp;\x3c/label\x3e\x3cinput id\x3d"${_uId}_hex" dojoAttachPoint\x3d"hexCode, focusNode, valueNode" size\x3d"6" class\x3d"dojoxColorPickerHexCode" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\t\t\x3c/table\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\x3c/table\x3e\n\t\t\x3c/td\x3e\n\t\x3c/tr\x3e\n\x3c/table\x3e\n\n',
"url:jimu/dijit/templates/_Transparency.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"opacitySlider" data-dojo-type\x3d"dijit/form/HorizontalSlider" showbuttons\x3d"true" value\x3d"0" minimum\x3d"0" maximum\x3d"100" discretevalues\x3d"101" intermediatechanges\x3d"true" style\x3d"width:100%;" data-dojo-attach-event\x3d"change: _onAlphaChanged"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"topDecoration" labels\x3d"${nls.opaque},${nls.transparent}" style\x3d"height: 1.5em; font-size: 0.8em; color: #666"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRule" container\x3d"bottomDecoration" count\x3d"5" style\x3d"height: 5px;"\x3e\r\n    \x3c/div\x3e\r\n    \x3col data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"bottomDecoration" style\x3d"height: 1em; font-size: 0.75em; color: darkblue;"\x3e\r\n      \x3cli\x3e${_nls0}\x3c/li\x3e\r\n      \x3cli\x3e${_nls50}\x3c/li\x3e\r\n      \x3cli\x3e${_nls100}\x3c/li\x3e\r\n    \x3c/ol\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\n\trole\x3d"presentation"\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\x3e\x3c/tr\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\n\t\t\t\t\t\x3e\x3c/div\n\t\t\t\t\x3e\x3c/div\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\n\t\t\t\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\x3e\x3c/tr\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\x3e\x3c/tr\n\x3e\x3c/table\x3e\n',
"url:dijit/form/templates/Spinner.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/DrawBox.html":'\x3cdiv style\x3d"position:relative;width:100%;"\x3e\r\n\t\x3cdiv class\x3d"draw-items"\x3e\r\n\t\t\x3cdiv title\x3d"${nls.point}" data-geotype\x3d"POINT" data-commontype\x3d"point" class\x3d"draw-item point-icon" data-dojo-attach-point\x3d"pointIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.line}" data-geotype\x3d"LINE" data-commontype\x3d"polyline" class\x3d"draw-item line-icon" data-dojo-attach-point\x3d"lineIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.polyline}" data-geotype\x3d"POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item polyline-icon" data-dojo-attach-point\x3d"polylineIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.freehandPolyline}" data-geotype\x3d"FREEHAND_POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item freehand-polyline-icon" data-dojo-attach-point\x3d"freehandPolylineIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.triangle}" data-geotype\x3d"TRIANGLE" data-commontype\x3d"polygon" class\x3d"draw-item triangle-icon" data-dojo-attach-point\x3d"triangleIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.extent}" data-geotype\x3d"EXTENT" data-commontype\x3d"polygon" class\x3d"draw-item extent-icon" data-dojo-attach-point\x3d"extentIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.circle}" data-geotype\x3d"CIRCLE" data-commontype\x3d"polygon" class\x3d"draw-item circle-icon" data-dojo-attach-point\x3d"circleIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.ellipse}" data-geotype\x3d"ELLIPSE" data-commontype\x3d"polygon" class\x3d"draw-item ellipse-icon" data-dojo-attach-point\x3d"ellipseIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.polygon}" data-geotype\x3d"POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item polygon-icon" data-dojo-attach-point\x3d"polygonIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.freehandPolygon}" data-geotype\x3d"FREEHAND_POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item freehand-polygon-icon" data-dojo-attach-point\x3d"freehandPolygonIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.text}" data-geotype\x3d"TEXT" data-commontype\x3d"text" class\x3d"draw-item text-icon" data-dojo-attach-point\x3d"textIcon" data-dojo-attach-point\x3d"textIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"drawings-clear" data-dojo-attach-point\x3d"btnClear" title\x3d"${nls.clear}"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"*now":function(B){B(['dojo/i18n!*preload*jimu/nls/main*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","ROOT"]'])}}});
define("./ConfigManager ./LayoutManager ./DataManager ./WidgetManager ./FeatureActionManager ./SelectionManager ./DataSourceManager ./FilterManager dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/mouse dojo/topic dojo/cookie dojo/Deferred dojo/promise/all dojo/io-query esri/config esri/request esri/urlUtils esri/IdentityManager jimu/portalUrlUtils ./utils require dojo/i18n dojo/i18n!./nls/main esri/main dojo/ready".split(" "),function(B,m,y,x,g,w,t,r,n,A,a,k,e,p,u,z,M,I,L,
P,K,N,C,J,O,R,Q,T,S,U){function X(){var a=window.location.search,e={query:!0};if(""===a)return{};var a=L.queryToObject(a.substr(1)),g;for(g in a)e[g]||(a[g]=O.sanitizeHTML(a[g]));return a}function W(a,e){V=a;"loadingPageChange"!==e&&(n.setStyle(jimuConfig.loadingId,"display","none"),n.setStyle(jimuConfig.mainPageId,"display","block"))}M={};var V;window.topic=u;P.defaults.io.timeout=18E4;"function"!==typeof z.getAll&&(z.getAll=function(a){var e=[];(a=z(a))&&e.push(a);return e});window.jimuNls=T;window.apiNls=
S.bundle;C.setProtocolErrorHandler(function(){return!0});C=O.getAncestorWindow();var Y=!1,Z=/^http(s?):\/\//gi;try{Y=0===C.location.href.indexOf("https://")}catch(f){}K.setRequestPreCallback(function(e){e.content&&e.content.printFlag&&(e.timeout=3E5);Y&&(e.url=e.url.replace(Z,"//"));if(-1!==e.url.indexOf("/queryRelatedRecords?")){var f=e.url,g=P.defaults.io.proxyUrl;g&&0===e.url.indexOf(g+"?")&&(f=e.url.replace(g+"?",""));O.isHostedService(f)||(e.url=e.url.replace("FeatureServer","MapServer"))}/GPServer\/.+\/jobs/.test(e.url)&&
(e.preventCache=(new Date).getTime());window.isBuilder||!V||V.mode||(V.appProxies&&0<V.appProxies.length&&a.some(V.appProxies,function(a){var b=a.sourceUrl;a=a.proxyUrl;Y&&(b=b.replace(Z,"//"),a=a.replace(Z,"//"));if(0<=e.url.indexOf(b))return e.url=e.url.replace(b,a),!0}),V.map.appProxy&&a.some(V.map.appProxy.proxyItems,function(a){if(!a.useProxy||!a.proxyUrl)return!1;var b=a.sourceUrl;a=a.proxyUrl;Y&&(b=b.replace(Z,"//"),a=a.replace(Z,"//"));if(0<=e.url.indexOf(b))return e.url=e.url.replace(b,a),
!0}));return e});k(window,"mousedown",function(a){O.isInNavMode()&&n.removeClass(document.body,"jimu-nav-mode");if(p.isMiddle(a))return a.preventDefault(),a.stopPropagation(),a.returnValue=!1});k(window,"keydown",function(a){a.keyCode!==e.TAB||O.isInNavMode()||n.addClass(document.body,"jimu-nav-mode")});String.prototype.startWith=function(a){return this.substr(0,a.length)===a?!0:!1};String.prototype.endWith=function(a){return this.substr(this.length-a.length,a.length)===a?!0:!1};Number.isNaN=Number.isNaN||
function(a){return a!==a};"undefined"===typeof jimuConfig&&(jimuConfig={});jimuConfig=A.mixin({loadingId:"main-loading",loadingImageId:"app-loading",loadingGifId:"loading-gif",layoutId:"jimu-layout-manager",mapId:"map",mainPageId:"main-page",timeout:5E3,breakPoints:[600,1280]},jimuConfig);window.wabVersion="2.11";window.productVersion="Web AppBuilder for ArcGIS (Developer Edition) 2.11";window.isBuilder?(u.subscribe("app/appConfigLoaded",W),u.subscribe("app/appConfigChanged",W)):(u.subscribe("appConfigLoaded",
W),u.subscribe("appConfigChanged",W));A=O.has("ie");9<A?n.addClass(document.body,"ie-nav-mode"):n.addClass(document.body,"ie-low-nav-mode");10<A&&n.addClass(document.body,"ie-gte-10");M.initApp=function(){var a,e;console.log("jimu.js init...");a=X();if(a.mobileBreakPoint)try{e=parseInt(a.mobileBreakPoint,10),jimuConfig.breakPoints[0]=e}catch(E){console.error("mobileBreakPoint URL parameter must be a number.",E)}a.mode&&(n.setStyle(jimuConfig.loadingId,"display","none"),n.setStyle(jimuConfig.mainPageId,
"display","block"));y.getInstance(x.getInstance());g.getInstance();w.getInstance();t.getInstance();r.getInstance();e=m.getInstance({mapId:jimuConfig.mapId,urlParams:a},jimuConfig.layoutId);a=B.getInstance(a);e.startup();a.loadConfig();R(["dynamic-modules/preload"]);U(function(){setTimeout(function(){n.removeClass(document.body,"dj_a11y")},50)})};return M});