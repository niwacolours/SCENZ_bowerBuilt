//>>built
define(["./common","./mat3","./vec3","./vec4"],function(v,w,k,g){var d={};return d.create=function(){var a=new v.ARRAY_TYPE(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},d.rotationTo=function(){var a=k.create(),b=k.fromValues(1,0,0),c=k.fromValues(0,1,0);return function(e,l,f){var h=k.dot(l,f);return-.999999>h?(k.cross(a,b,l),1E-6>k.length(a)&&k.cross(a,c,l),k.normalize(a,a),d.setAxisAngle(e,a,Math.PI),e):.999999<h?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(k.cross(a,l,f),e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=1+h,
d.normalize(e,e))}}(),d.setAxes=function(){var a=w.create();return function(b,c,e,l){return a[0]=e[0],a[3]=e[1],a[6]=e[2],a[1]=l[0],a[4]=l[1],a[7]=l[2],a[2]=-c[0],a[5]=-c[1],a[8]=-c[2],d.normalize(b,d.fromMat3(b,a))}}(),d.clone=g.clone,d.fromValues=g.fromValues,d.copy=g.copy,d.set=g.set,d.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},d.setAxisAngle=function(a,b,c){c*=.5;var e=Math.sin(c);return a[0]=e*b[0],a[1]=e*b[1],a[2]=e*b[2],a[3]=Math.cos(c),a},d.getAxisAngle=function(a,b){var c=
2*Math.acos(b[3]),e=Math.sin(c/2);return 0!=e?(a[0]=b[0]/e,a[1]=b[1]/e,a[2]=b[2]/e):(a[0]=1,a[1]=0,a[2]=0),c},d.add=g.add,d.multiply=function(a,b,c){var e=b[0],d=b[1],f=b[2];b=b[3];var h=c[0],m=c[1],g=c[2];c=c[3];return a[0]=e*c+b*h+d*g-f*m,a[1]=d*c+b*m+f*h-e*g,a[2]=f*c+b*g+e*m-d*h,a[3]=b*c-e*h-d*m-f*g,a},d.mul=d.multiply,d.scale=g.scale,d.rotateX=function(a,b,c){c*=.5;var e=b[0],d=b[1],f=b[2];b=b[3];var h=Math.sin(c);c=Math.cos(c);return a[0]=e*c+b*h,a[1]=d*c+f*h,a[2]=f*c-d*h,a[3]=b*c-e*h,a},d.rotateY=
function(a,b,c){c*=.5;var e=b[0],d=b[1],f=b[2];b=b[3];var h=Math.sin(c);c=Math.cos(c);return a[0]=e*c-f*h,a[1]=d*c+b*h,a[2]=f*c+e*h,a[3]=b*c-d*h,a},d.rotateZ=function(a,b,c){c*=.5;var e=b[0],d=b[1],f=b[2];b=b[3];var h=Math.sin(c);c=Math.cos(c);return a[0]=e*c+d*h,a[1]=d*c-e*h,a[2]=f*c+b*h,a[3]=b*c-f*h,a},d.calculateW=function(a,b){var c=b[0],e=b[1];b=b[2];return a[0]=c,a[1]=e,a[2]=b,a[3]=Math.sqrt(Math.abs(1-c*c-e*e-b*b)),a},d.dot=g.dot,d.lerp=g.lerp,d.slerp=function(a,b,c,e){var d,f,h,g,k,r=b[0],
t=b[1],u=b[2];b=b[3];var n=c[0],p=c[1],q=c[2];c=c[3];return f=r*n+t*p+u*q+b*c,0>f&&(f=-f,n=-n,p=-p,q=-q,c=-c),1E-6<1-f?(d=Math.acos(f),h=Math.sin(d),g=Math.sin((1-e)*d)/h,k=Math.sin(e*d)/h):(g=1-e,k=e),a[0]=g*r+k*n,a[1]=g*t+k*p,a[2]=g*u+k*q,a[3]=g*b+k*c,a},d.sqlerp=function(){var a=d.create(),b=d.create();return function(c,e,g,f,h,k){return d.slerp(a,e,h,k),d.slerp(b,g,f,k),d.slerp(c,a,b,2*k*(1-k)),c}}(),d.invert=function(a,b){var c=b[0],e=b[1],d=b[2];b=b[3];var f=c*c+e*e+d*d+b*b,f=f?1/f:0;return a[0]=
-c*f,a[1]=-e*f,a[2]=-d*f,a[3]=b*f,a},d.conjugate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=b[3],a},d.length=g.length,d.len=d.length,d.squaredLength=g.squaredLength,d.sqrLen=d.squaredLength,d.normalize=g.normalize,d.fromMat3=function(a,b){var c;c=b[0]+b[4]+b[8];if(0<c)c=Math.sqrt(c+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var d=0;b[4]>b[0]&&(d=1);b[8]>b[3*d+d]&&(d=2);var g=(d+1)%3,f=(d+2)%3;c=Math.sqrt(b[3*d+d]-b[3*g+g]-b[3*f+f]+1);a[d]=.5*
c;c=.5/c;a[3]=(b[3*g+f]-b[3*f+g])*c;a[g]=(b[3*g+d]+b[3*d+g])*c;a[f]=(b[3*f+d]+b[3*d+f])*c}return a},d.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},d.exactEquals=g.exactEquals,d.equals=g.equals,d});