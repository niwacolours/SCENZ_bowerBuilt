//>>built
define("require exports ../object ./ensureType ./extensions ./metadata ./utils ./decorators/cast".split(" "),function(y,n,r,m,p,h,q,t){Object.defineProperty(n,"__esModule",{value:!0});var u=Object.prototype.hasOwnProperty,v=/^_([a-zA-Z0-9]+)(Getter|Setter|Reader|Writer|Caster)$/,w={Getter:"get",Setter:"set",Reader:"json.read.reader",Writer:"json.write.writer",Caster:"cast"},x=/^_(set|get)([a-zA-Z0-9]+)Attr$/;n.processPrototype=function(c){for(var k=c.declaredClass,e=c.properties||{},f=0,g=Object.getOwnPropertyNames(e);f<
g.length;f++){var b=g[f],a=e[b],d=typeof a;null==a?h.setPropertyMetadata(c,b,{value:a}):Array.isArray(a)?h.setPropertyMetadata(c,b,{type:[a[0]],value:null}):"object"===d?q.getProperties(a)||a instanceof Date?h.setPropertyMetadata(c,b,{type:a.constructor,value:a}):h.setPropertyMetadata(c,b,a):"boolean"===d?h.setPropertyMetadata(c,b,{type:Boolean,value:a}):"string"===d?h.setPropertyMetadata(c,b,{type:String,value:a}):"number"===d?h.setPropertyMetadata(c,b,{type:Number,value:a}):"function"===d&&h.setPropertyMetadata(c,
b,{type:a,value:null})}f=0;for(g=Object.getOwnPropertyNames(c);f<g.length;f++){var d=g[f],a=c[d],e=b=void 0,l=v.exec(d);if(l?(b=l[1],e=w[l[2]]):(l=x.exec(d))&&(b=l[2][0].toLowerCase()+l[2].substr(1),e=l[1].toLowerCase()),b&&e)b=h.getPropertyMetadata(c,b),r.setDeepValue(e,a,b)}f=0;for(g=Object.getOwnPropertyNames(h.getPropertiesMetadata(c));f<g.length;f++)if(b=g[f],a=h.getPropertyMetadata(c,b),e=a.type,d=a.types,void 0===a.value&&u.call(c,b)&&(a.value=c[b]),!a.cast&&e){b=a;a=0;for(d=e;Array.isArray(d);)d=
d[0],a++;e=1===a?m.ensureArray(d):1<a?m.ensureNArray(d,a):m.ensureType(e);b.cast=e}else!a.cast&&d&&(Array.isArray(d)?a.cast=m.ensureArrayTyped(m.ensureOneOfType(d[0])):a.cast=m.ensureOneOfType(d));return p.processPrototypeMetadatas(h.getPropertiesMetadata(c),k),h.getPropertiesMetadata(c)};n.processClass=function(c){for(var k=c.prototype,e=k.declaredClass,f=c._meta.bases,g={},b=f.length-1;0<=b;b--)q.merge(g,h.getMetadata(f[b].prototype));var a=g.properties;p.processClassMetadatas(a,e);Object.defineProperty(c,
"__accessorMetadata__",{value:{properties:a,autoDestroy:!!g.autoDestroy}});for(var d={},e=0,f=Object.getOwnPropertyNames(a);e<f.length;e++)!function(b){var c=a[b];d[b]={enumerable:!0,configurable:!0,get:function(){return this.__accessor__?this.__accessor__.get(b):c.value},set:function(a){var d=this.__accessor__;if(!d)return void Object.defineProperty(this,b,{enumerable:!0,configurable:!0,writable:!0,value:a});if(!Object.isFrozen(this)){if(d.initialized&&c.readOnly)throw new TypeError("[accessor] cannot assign to read-only property '"+
b+"' of "+this.declaredClass);if(2===d.lifecycle&&c.constructOnly)throw new TypeError("[accessor] cannot assign to construct-only property '"+b+"' of "+this.declaredClass);d.set(b,a)}}}}(f[e]);if(Object.defineProperties(c.prototype,d),g.parameters)for(c=0,e=Object.getOwnPropertyNames(g.parameters);c<e.length;c++)f=e[c],b=Object.getOwnPropertyDescriptor(k,f)||{value:k[f]},(b=t.autocastMethod(k,f,b))&&Object.defineProperty(k,f,b);return g}});